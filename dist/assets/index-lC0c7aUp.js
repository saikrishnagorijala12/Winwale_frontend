(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Cm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ib={exports:{}},ih={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NC;function T7(){if(NC)return ih;NC=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,s,a){var i=null;if(a!==void 0&&(i=""+a),s.key!==void 0&&(i=""+s.key),"key"in s){a={};for(var o in s)o!=="key"&&(a[o]=s[o])}else a=s;return s=a.ref,{$$typeof:e,type:n,key:i,ref:s!==void 0?s:null,props:a}}return ih.Fragment=t,ih.jsx=r,ih.jsxs=r,ih}var TC;function k7(){return TC||(TC=1,ib.exports=T7()),ib.exports}var d=k7(),ob={exports:{}},Nt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kC;function A7(){if(kC)return Nt;kC=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),x=Symbol.iterator;function g(K){return K===null||typeof K!="object"?null:(K=x&&K[x]||K["@@iterator"],typeof K=="function"?K:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,w={};function _(K,D,q){this.props=K,this.context=D,this.refs=w,this.updater=q||v}_.prototype.isReactComponent={},_.prototype.setState=function(K,D){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,D,"setState")},_.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function S(){}S.prototype=_.prototype;function E(K,D,q){this.props=K,this.context=D,this.refs=w,this.updater=q||v}var N=E.prototype=new S;N.constructor=E,y(N,_.prototype),N.isPureReactComponent=!0;var k=Array.isArray;function O(){}var R={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function I(K,D,q){var W=q.ref;return{$$typeof:e,type:K,key:D,ref:W!==void 0?W:null,props:q}}function Z(K,D){return I(K.type,D,K.props)}function ce(K){return typeof K=="object"&&K!==null&&K.$$typeof===e}function F(K){var D={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(q){return D[q]})}var X=/\/+/g;function P(K,D){return typeof K=="object"&&K!==null&&K.key!=null?F(""+K.key):D.toString(36)}function ie(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(O,O):(K.status="pending",K.then(function(D){K.status==="pending"&&(K.status="fulfilled",K.value=D)},function(D){K.status==="pending"&&(K.status="rejected",K.reason=D)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function te(K,D,q,W,J){var re=typeof K;(re==="undefined"||re==="boolean")&&(K=null);var U=!1;if(K===null)U=!0;else switch(re){case"bigint":case"string":case"number":U=!0;break;case"object":switch(K.$$typeof){case e:case t:U=!0;break;case h:return U=K._init,te(U(K._payload),D,q,W,J)}}if(U)return J=J(K),U=W===""?"."+P(K,0):W,k(J)?(q="",U!=null&&(q=U.replace(X,"$&/")+"/"),te(J,D,q,"",function(Q){return Q})):J!=null&&(ce(J)&&(J=Z(J,q+(J.key==null||K&&K.key===J.key?"":(""+J.key).replace(X,"$&/")+"/")+U)),D.push(J)),1;U=0;var L=W===""?".":W+":";if(k(K))for(var se=0;se<K.length;se++)W=K[se],re=L+P(W,se),U+=te(W,D,q,re,J);else if(se=g(K),typeof se=="function")for(K=se.call(K),se=0;!(W=K.next()).done;)W=W.value,re=L+P(W,se++),U+=te(W,D,q,re,J);else if(re==="object"){if(typeof K.then=="function")return te(ie(K),D,q,W,J);throw D=String(K),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.")}return U}function Y(K,D,q){if(K==null)return K;var W=[],J=0;return te(K,W,"","",function(re){return D.call(q,re,J++)}),W}function ve(K){if(K._status===-1){var D=K._result;D=D(),D.then(function(q){(K._status===0||K._status===-1)&&(K._status=1,K._result=q)},function(q){(K._status===0||K._status===-1)&&(K._status=2,K._result=q)}),K._status===-1&&(K._status=0,K._result=D)}if(K._status===1)return K._result.default;throw K._result}var oe=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var D=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(D))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)},Ee={map:Y,forEach:function(K,D,q){Y(K,function(){D.apply(this,arguments)},q)},count:function(K){var D=0;return Y(K,function(){D++}),D},toArray:function(K){return Y(K,function(D){return D})||[]},only:function(K){if(!ce(K))throw Error("React.Children.only expected to receive a single React element child.");return K}};return Nt.Activity=p,Nt.Children=Ee,Nt.Component=_,Nt.Fragment=r,Nt.Profiler=s,Nt.PureComponent=E,Nt.StrictMode=n,Nt.Suspense=c,Nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Nt.__COMPILER_RUNTIME={__proto__:null,c:function(K){return R.H.useMemoCache(K)}},Nt.cache=function(K){return function(){return K.apply(null,arguments)}},Nt.cacheSignal=function(){return null},Nt.cloneElement=function(K,D,q){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var W=y({},K.props),J=K.key;if(D!=null)for(re in D.key!==void 0&&(J=""+D.key),D)!V.call(D,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&D.ref===void 0||(W[re]=D[re]);var re=arguments.length-2;if(re===1)W.children=q;else if(1<re){for(var U=Array(re),L=0;L<re;L++)U[L]=arguments[L+2];W.children=U}return I(K.type,J,W)},Nt.createContext=function(K){return K={$$typeof:i,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:a,_context:K},K},Nt.createElement=function(K,D,q){var W,J={},re=null;if(D!=null)for(W in D.key!==void 0&&(re=""+D.key),D)V.call(D,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(J[W]=D[W]);var U=arguments.length-2;if(U===1)J.children=q;else if(1<U){for(var L=Array(U),se=0;se<U;se++)L[se]=arguments[se+2];J.children=L}if(K&&K.defaultProps)for(W in U=K.defaultProps,U)J[W]===void 0&&(J[W]=U[W]);return I(K,re,J)},Nt.createRef=function(){return{current:null}},Nt.forwardRef=function(K){return{$$typeof:o,render:K}},Nt.isValidElement=ce,Nt.lazy=function(K){return{$$typeof:h,_payload:{_status:-1,_result:K},_init:ve}},Nt.memo=function(K,D){return{$$typeof:f,type:K,compare:D===void 0?null:D}},Nt.startTransition=function(K){var D=R.T,q={};R.T=q;try{var W=K(),J=R.S;J!==null&&J(q,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(O,oe)}catch(re){oe(re)}finally{D!==null&&q.types!==null&&(D.types=q.types),R.T=D}},Nt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Nt.use=function(K){return R.H.use(K)},Nt.useActionState=function(K,D,q){return R.H.useActionState(K,D,q)},Nt.useCallback=function(K,D){return R.H.useCallback(K,D)},Nt.useContext=function(K){return R.H.useContext(K)},Nt.useDebugValue=function(){},Nt.useDeferredValue=function(K,D){return R.H.useDeferredValue(K,D)},Nt.useEffect=function(K,D){return R.H.useEffect(K,D)},Nt.useEffectEvent=function(K){return R.H.useEffectEvent(K)},Nt.useId=function(){return R.H.useId()},Nt.useImperativeHandle=function(K,D,q){return R.H.useImperativeHandle(K,D,q)},Nt.useInsertionEffect=function(K,D){return R.H.useInsertionEffect(K,D)},Nt.useLayoutEffect=function(K,D){return R.H.useLayoutEffect(K,D)},Nt.useMemo=function(K,D){return R.H.useMemo(K,D)},Nt.useOptimistic=function(K,D){return R.H.useOptimistic(K,D)},Nt.useReducer=function(K,D,q){return R.H.useReducer(K,D,q)},Nt.useRef=function(K){return R.H.useRef(K)},Nt.useState=function(K){return R.H.useState(K)},Nt.useSyncExternalStore=function(K,D,q){return R.H.useSyncExternalStore(K,D,q)},Nt.useTransition=function(){return R.H.useTransition()},Nt.version="19.2.4",Nt}var AC;function I0(){return AC||(AC=1,ob.exports=A7()),ob.exports}var ne=I0();const We=bE(ne);var lb={exports:{}},oh={},cb={exports:{}},ub={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CC;function C7(){return CC||(CC=1,(function(e){function t(te,Y){var ve=te.length;te.push(Y);e:for(;0<ve;){var oe=ve-1>>>1,Ee=te[oe];if(0<s(Ee,Y))te[oe]=Y,te[ve]=Ee,ve=oe;else break e}}function r(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var Y=te[0],ve=te.pop();if(ve!==Y){te[0]=ve;e:for(var oe=0,Ee=te.length,K=Ee>>>1;oe<K;){var D=2*(oe+1)-1,q=te[D],W=D+1,J=te[W];if(0>s(q,ve))W<Ee&&0>s(J,q)?(te[oe]=J,te[W]=ve,oe=W):(te[oe]=q,te[D]=ve,oe=D);else if(W<Ee&&0>s(J,ve))te[oe]=J,te[W]=ve,oe=W;else break e}}return Y}function s(te,Y){var ve=te.sortIndex-Y.sortIndex;return ve!==0?ve:te.id-Y.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],f=[],h=1,p=null,x=3,g=!1,v=!1,y=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function N(te){for(var Y=r(f);Y!==null;){if(Y.callback===null)n(f);else if(Y.startTime<=te)n(f),Y.sortIndex=Y.expirationTime,t(c,Y);else break;Y=r(f)}}function k(te){if(y=!1,N(te),!v)if(r(c)!==null)v=!0,O||(O=!0,F());else{var Y=r(f);Y!==null&&ie(k,Y.startTime-te)}}var O=!1,R=-1,V=5,I=-1;function Z(){return w?!0:!(e.unstable_now()-I<V)}function ce(){if(w=!1,O){var te=e.unstable_now();I=te;var Y=!0;try{e:{v=!1,y&&(y=!1,S(R),R=-1),g=!0;var ve=x;try{t:{for(N(te),p=r(c);p!==null&&!(p.expirationTime>te&&Z());){var oe=p.callback;if(typeof oe=="function"){p.callback=null,x=p.priorityLevel;var Ee=oe(p.expirationTime<=te);if(te=e.unstable_now(),typeof Ee=="function"){p.callback=Ee,N(te),Y=!0;break t}p===r(c)&&n(c),N(te)}else n(c);p=r(c)}if(p!==null)Y=!0;else{var K=r(f);K!==null&&ie(k,K.startTime-te),Y=!1}}break e}finally{p=null,x=ve,g=!1}Y=void 0}}finally{Y?F():O=!1}}}var F;if(typeof E=="function")F=function(){E(ce)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,P=X.port2;X.port1.onmessage=ce,F=function(){P.postMessage(null)}}else F=function(){_(ce,0)};function ie(te,Y){R=_(function(){te(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_next=function(te){switch(x){case 1:case 2:case 3:var Y=3;break;default:Y=x}var ve=x;x=Y;try{return te()}finally{x=ve}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(te,Y){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ve=x;x=te;try{return Y()}finally{x=ve}},e.unstable_scheduleCallback=function(te,Y,ve){var oe=e.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?oe+ve:oe):ve=oe,te){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=ve+Ee,te={id:h++,callback:Y,priorityLevel:te,startTime:ve,expirationTime:Ee,sortIndex:-1},ve>oe?(te.sortIndex=ve,t(f,te),r(c)===null&&te===r(f)&&(y?(S(R),R=-1):y=!0,ie(k,ve-oe))):(te.sortIndex=Ee,t(c,te),v||g||(v=!0,O||(O=!0,F()))),te},e.unstable_shouldYield=Z,e.unstable_wrapCallback=function(te){var Y=x;return function(){var ve=x;x=Y;try{return te.apply(this,arguments)}finally{x=ve}}}})(ub)),ub}var RC;function R7(){return RC||(RC=1,cb.exports=C7()),cb.exports}var fb={exports:{}},ts={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jC;function j7(){if(jC)return ts;jC=1;var e=I0();function t(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(c,f,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:p==null?null:""+p,children:c,containerInfo:f,implementation:h}}var i=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return ts.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ts.createPortal=function(c,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(c,f,null,h)},ts.flushSync=function(c){var f=i.T,h=n.p;try{if(i.T=null,n.p=2,c)return c()}finally{i.T=f,n.p=h,n.d.f()}},ts.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(c,f))},ts.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},ts.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var h=f.as,p=o(h,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?n.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:x,fetchPriority:g}):h==="script"&&n.d.X(c,{crossOrigin:p,integrity:x,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},ts.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=o(f.as,f.crossOrigin);n.d.M(c,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(c)},ts.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,p=o(h,f.crossOrigin);n.d.L(c,h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},ts.preloadModule=function(c,f){if(typeof c=="string")if(f){var h=o(f.as,f.crossOrigin);n.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(c)},ts.requestFormReset=function(c){n.d.r(c)},ts.unstable_batchedUpdates=function(c,f){return c(f)},ts.useFormState=function(c,f,h){return i.H.useFormState(c,f,h)},ts.useFormStatus=function(){return i.H.useHostTransitionStatus()},ts.version="19.2.4",ts}var OC;function AO(){if(OC)return fb.exports;OC=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),fb.exports=j7(),fb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DC;function O7(){if(DC)return oh;DC=1;var e=R7(),t=I0(),r=AO();function n(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function a(l){var u=l,m=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(m=u.return),l=u.return;while(l)}return u.tag===3?m:null}function i(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function o(l){if(l.tag===31){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function c(l){if(a(l)!==l)throw Error(n(188))}function f(l){var u=l.alternate;if(!u){if(u=a(l),u===null)throw Error(n(188));return u!==l?null:l}for(var m=l,b=u;;){var T=m.return;if(T===null)break;var C=T.alternate;if(C===null){if(b=T.return,b!==null){m=b;continue}break}if(T.child===C.child){for(C=T.child;C;){if(C===m)return c(T),l;if(C===b)return c(T),u;C=C.sibling}throw Error(n(188))}if(m.return!==b.return)m=T,b=C;else{for(var G=!1,le=T.child;le;){if(le===m){G=!0,m=T,b=C;break}if(le===b){G=!0,b=T,m=C;break}le=le.sibling}if(!G){for(le=C.child;le;){if(le===m){G=!0,m=C,b=T;break}if(le===b){G=!0,b=C,m=T;break}le=le.sibling}if(!G)throw Error(n(189))}}if(m.alternate!==b)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?l:u}function h(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(u=h(l),u!==null)return u;l=l.sibling}return null}var p=Object.assign,x=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),S=Symbol.for("react.consumer"),E=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),ce=Symbol.iterator;function F(l){return l===null||typeof l!="object"?null:(l=ce&&l[ce]||l["@@iterator"],typeof l=="function"?l:null)}var X=Symbol.for("react.client.reference");function P(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===X?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case y:return"Fragment";case _:return"Profiler";case w:return"StrictMode";case k:return"Suspense";case O:return"SuspenseList";case I:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case v:return"Portal";case E:return l.displayName||"Context";case S:return(l._context.displayName||"Context")+".Consumer";case N:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case R:return u=l.displayName||null,u!==null?u:P(l.type)||"Memo";case V:u=l._payload,l=l._init;try{return P(l(u))}catch{}}return null}var ie=Array.isArray,te=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},oe=[],Ee=-1;function K(l){return{current:l}}function D(l){0>Ee||(l.current=oe[Ee],oe[Ee]=null,Ee--)}function q(l,u){Ee++,oe[Ee]=l.current,l.current=u}var W=K(null),J=K(null),re=K(null),U=K(null);function L(l,u){switch(q(re,u),q(J,l),q(W,null),u.nodeType){case 9:case 11:l=(l=u.documentElement)&&(l=l.namespaceURI)?KA(l):0;break;default:if(l=u.tagName,u=u.namespaceURI)u=KA(u),l=XA(u,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}D(W),q(W,l)}function se(){D(W),D(J),D(re)}function Q(l){l.memoizedState!==null&&q(U,l);var u=W.current,m=XA(u,l.type);u!==m&&(q(J,l),q(W,m))}function ee(l){J.current===l&&(D(W),D(J)),U.current===l&&(D(U),rh._currentValue=ve)}var B,be;function z(l){if(B===void 0)try{throw Error()}catch(m){var u=m.stack.trim().match(/\n( *(at )?)/);B=u&&u[1]||"",be=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+B+l+be}var he=!1;function M(l,u){if(!l||he)return"";he=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(u){var Ve=function(){throw Error()};if(Object.defineProperty(Ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ve,[])}catch(Ie){var je=Ie}Reflect.construct(l,[],Ve)}else{try{Ve.call()}catch(Ie){je=Ie}l.call(Ve.prototype)}}else{try{throw Error()}catch(Ie){je=Ie}(Ve=l())&&typeof Ve.catch=="function"&&Ve.catch(function(){})}}catch(Ie){if(Ie&&je&&typeof Ie.stack=="string")return[Ie.stack,je.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var T=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");T&&T.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=b.DetermineComponentFrameRoot(),G=C[0],le=C[1];if(G&&le){var we=G.split(`
`),ke=le.split(`
`);for(T=b=0;b<we.length&&!we[b].includes("DetermineComponentFrameRoot");)b++;for(;T<ke.length&&!ke[T].includes("DetermineComponentFrameRoot");)T++;if(b===we.length||T===ke.length)for(b=we.length-1,T=ke.length-1;1<=b&&0<=T&&we[b]!==ke[T];)T--;for(;1<=b&&0<=T;b--,T--)if(we[b]!==ke[T]){if(b!==1||T!==1)do if(b--,T--,0>T||we[b]!==ke[T]){var Ue=`
`+we[b].replace(" at new "," at ");return l.displayName&&Ue.includes("<anonymous>")&&(Ue=Ue.replace("<anonymous>",l.displayName)),Ue}while(1<=b&&0<=T);break}}}finally{he=!1,Error.prepareStackTrace=m}return(m=l?l.displayName||l.name:"")?z(m):""}function A(l,u){switch(l.tag){case 26:case 27:case 5:return z(l.type);case 16:return z("Lazy");case 13:return l.child!==u&&u!==null?z("Suspense Fallback"):z("Suspense");case 19:return z("SuspenseList");case 0:case 15:return M(l.type,!1);case 11:return M(l.type.render,!1);case 1:return M(l.type,!0);case 31:return z("Activity");default:return""}}function j(l){try{var u="",m=null;do u+=A(l,m),m=l,l=l.return;while(l);return u}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}var H=Object.prototype.hasOwnProperty,ue=e.unstable_scheduleCallback,ye=e.unstable_cancelCallback,pe=e.unstable_shouldYield,Ne=e.unstable_requestPaint,De=e.unstable_now,Fe=e.unstable_getCurrentPriorityLevel,Ke=e.unstable_ImmediatePriority,st=e.unstable_UserBlockingPriority,at=e.unstable_NormalPriority,Gt=e.unstable_LowPriority,dt=e.unstable_IdlePriority,Lt=e.log,pr=e.unstable_setDisableYieldValue,vt=null,or=null;function Tn(l){if(typeof Lt=="function"&&pr(l),or&&typeof or.setStrictMode=="function")try{or.setStrictMode(vt,l)}catch{}}var lr=Math.clz32?Math.clz32:xs,qo=Math.log,mi=Math.LN2;function xs(l){return l>>>=0,l===0?32:31-(qo(l)/mi|0)|0}var Ya=256,Ja=262144,gs=4194304;function nn(l){var u=l&42;if(u!==0)return u;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function wt(l,u,m){var b=l.pendingLanes;if(b===0)return 0;var T=0,C=l.suspendedLanes,G=l.pingedLanes;l=l.warmLanes;var le=b&134217727;return le!==0?(b=le&~C,b!==0?T=nn(b):(G&=le,G!==0?T=nn(G):m||(m=le&~l,m!==0&&(T=nn(m))))):(le=b&~C,le!==0?T=nn(le):G!==0?T=nn(G):m||(m=b&~l,m!==0&&(T=nn(m)))),T===0?0:u!==0&&u!==T&&(u&C)===0&&(C=T&-T,m=u&-u,C>=m||C===32&&(m&4194048)!==0)?u:T}function gr(l,u){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&u)===0}function sn(l,u){switch(l){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kn(){var l=gs;return gs<<=1,(gs&62914560)===0&&(gs=4194304),l}function xi(l){for(var u=[],m=0;31>m;m++)u.push(l);return u}function br(l,u){l.pendingLanes|=u,u!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function Qn(l,u,m,b,T,C){var G=l.pendingLanes;l.pendingLanes=m,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=m,l.entangledLanes&=m,l.errorRecoveryDisabledLanes&=m,l.shellSuspendCounter=0;var le=l.entanglements,we=l.expirationTimes,ke=l.hiddenUpdates;for(m=G&~m;0<m;){var Ue=31-lr(m),Ve=1<<Ue;le[Ue]=0,we[Ue]=-1;var je=ke[Ue];if(je!==null)for(ke[Ue]=null,Ue=0;Ue<je.length;Ue++){var Ie=je[Ue];Ie!==null&&(Ie.lane&=-536870913)}m&=~Ve}b!==0&&Gi(l,b,0),C!==0&&T===0&&l.tag!==0&&(l.suspendedLanes|=C&~(G&~u))}function Gi(l,u,m){l.pendingLanes|=u,l.suspendedLanes&=~u;var b=31-lr(u);l.entangledLanes|=u,l.entanglements[b]=l.entanglements[b]|1073741824|m&261930}function An(l,u){var m=l.entangledLanes|=u;for(l=l.entanglements;m;){var b=31-lr(m),T=1<<b;T&u|l[b]&u&&(l[b]|=u),m&=~T}}function es(l,u){var m=u&-u;return m=(m&42)!==0?1:Wo(m),(m&(l.suspendedLanes|u))!==0?0:m}function Wo(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function $s(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function ae(){var l=Y.p;return l!==0?l:(l=window.event,l===void 0?32:yC(l.type))}function xe(l,u){var m=Y.p;try{return Y.p=l,u()}finally{Y.p=m}}var fe=Math.random().toString(36).slice(2),de="__reactFiber$"+fe,me="__reactProps$"+fe,ge="__reactContainer$"+fe,Ae="__reactEvents$"+fe,ze="__reactListeners$"+fe,Ce="__reactHandles$"+fe,Re="__reactResources$"+fe,Oe="__reactMarker$"+fe;function Xe(l){delete l[de],delete l[me],delete l[Ae],delete l[ze],delete l[Ce]}function Ze(l){var u=l[de];if(u)return u;for(var m=l.parentNode;m;){if(u=m[ge]||m[de]){if(m=u.alternate,u.child!==null||m!==null&&m.child!==null)for(l=rC(l);l!==null;){if(m=l[de])return m;l=rC(l)}return u}l=m,m=l.parentNode}return null}function nt(l){if(l=l[de]||l[ge]){var u=l.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return l}return null}function Ye(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l.stateNode;throw Error(n(33))}function tt(l){var u=l[Re];return u||(u=l[Re]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function ct(l){l[Oe]=!0}var yr=new Set,vr={};function Ar(l,u){ha(l,u),ha(l+"Capture",u)}function ha(l,u){for(vr[l]=u,l=0;l<u.length;l++)yr.add(u[l])}var ec=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$o={},gi={};function yd(l){return H.call(gi,l)?!0:H.call($o,l)?!1:ec.test(l)?gi[l]=!0:($o[l]=!0,!1)}function As(l,u,m){if(yd(u))if(m===null)l.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":l.removeAttribute(u);return;case"boolean":var b=u.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){l.removeAttribute(u);return}}l.setAttribute(u,""+m)}}function yp(l,u,m){if(m===null)l.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(u);return}l.setAttribute(u,""+m)}}function Ki(l,u,m,b){if(b===null)l.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(m);return}l.setAttributeNS(u,m,""+b)}}function pa(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function UN(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function vB(l,u,m){var b=Object.getOwnPropertyDescriptor(l.constructor.prototype,u);if(!l.hasOwnProperty(u)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var T=b.get,C=b.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return T.call(this)},set:function(G){m=""+G,C.call(this,G)}}),Object.defineProperty(l,u,{enumerable:b.enumerable}),{getValue:function(){return m},setValue:function(G){m=""+G},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function Q1(l){if(!l._valueTracker){var u=UN(l)?"checked":"value";l._valueTracker=vB(l,u,""+l[u])}}function zN(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var m=u.getValue(),b="";return l&&(b=UN(l)?l.checked?"true":"false":l.value),l=b,l!==m?(u.setValue(l),!0):!1}function vp(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var bB=/[\n"\\]/g;function ma(l){return l.replace(bB,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function ey(l,u,m,b,T,C,G,le){l.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?l.type=G:l.removeAttribute("type"),u!=null?G==="number"?(u===0&&l.value===""||l.value!=u)&&(l.value=""+pa(u)):l.value!==""+pa(u)&&(l.value=""+pa(u)):G!=="submit"&&G!=="reset"||l.removeAttribute("value"),u!=null?ty(l,G,pa(u)):m!=null?ty(l,G,pa(m)):b!=null&&l.removeAttribute("value"),T==null&&C!=null&&(l.defaultChecked=!!C),T!=null&&(l.checked=T&&typeof T!="function"&&typeof T!="symbol"),le!=null&&typeof le!="function"&&typeof le!="symbol"&&typeof le!="boolean"?l.name=""+pa(le):l.removeAttribute("name")}function HN(l,u,m,b,T,C,G,le){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(l.type=C),u!=null||m!=null){if(!(C!=="submit"&&C!=="reset"||u!=null)){Q1(l);return}m=m!=null?""+pa(m):"",u=u!=null?""+pa(u):m,le||u===l.value||(l.value=u),l.defaultValue=u}b=b??T,b=typeof b!="function"&&typeof b!="symbol"&&!!b,l.checked=le?l.checked:!!b,l.defaultChecked=!!b,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(l.name=G),Q1(l)}function ty(l,u,m){u==="number"&&vp(l.ownerDocument)===l||l.defaultValue===""+m||(l.defaultValue=""+m)}function bu(l,u,m,b){if(l=l.options,u){u={};for(var T=0;T<m.length;T++)u["$"+m[T]]=!0;for(m=0;m<l.length;m++)T=u.hasOwnProperty("$"+l[m].value),l[m].selected!==T&&(l[m].selected=T),T&&b&&(l[m].defaultSelected=!0)}else{for(m=""+pa(m),u=null,T=0;T<l.length;T++){if(l[T].value===m){l[T].selected=!0,b&&(l[T].defaultSelected=!0);return}u!==null||l[T].disabled||(u=l[T])}u!==null&&(u.selected=!0)}}function VN(l,u,m){if(u!=null&&(u=""+pa(u),u!==l.value&&(l.value=u),m==null)){l.defaultValue!==u&&(l.defaultValue=u);return}l.defaultValue=m!=null?""+pa(m):""}function qN(l,u,m,b){if(u==null){if(b!=null){if(m!=null)throw Error(n(92));if(ie(b)){if(1<b.length)throw Error(n(93));b=b[0]}m=b}m==null&&(m=""),u=m}m=pa(u),l.defaultValue=m,b=l.textContent,b===m&&b!==""&&b!==null&&(l.value=b),Q1(l)}function wu(l,u){if(u){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=u;return}}l.textContent=u}var wB=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function WN(l,u,m){var b=u.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?b?l.setProperty(u,""):u==="float"?l.cssFloat="":l[u]="":b?l.setProperty(u,m):typeof m!="number"||m===0||wB.has(u)?u==="float"?l.cssFloat=m:l[u]=(""+m).trim():l[u]=m+"px"}function $N(l,u,m){if(u!=null&&typeof u!="object")throw Error(n(62));if(l=l.style,m!=null){for(var b in m)!m.hasOwnProperty(b)||u!=null&&u.hasOwnProperty(b)||(b.indexOf("--")===0?l.setProperty(b,""):b==="float"?l.cssFloat="":l[b]="");for(var T in u)b=u[T],u.hasOwnProperty(T)&&m[T]!==b&&WN(l,T,b)}else for(var C in u)u.hasOwnProperty(C)&&WN(l,C,u[C])}function ry(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _B=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),EB=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bp(l){return EB.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}function Xi(){}var ny=null;function sy(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var _u=null,Eu=null;function GN(l){var u=nt(l);if(u&&(l=u.stateNode)){var m=l[me]||null;e:switch(l=u.stateNode,u.type){case"input":if(ey(l,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),u=m.name,m.type==="radio"&&u!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+ma(""+u)+'"][type="radio"]'),u=0;u<m.length;u++){var b=m[u];if(b!==l&&b.form===l.form){var T=b[me]||null;if(!T)throw Error(n(90));ey(b,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name)}}for(u=0;u<m.length;u++)b=m[u],b.form===l.form&&zN(b)}break e;case"textarea":VN(l,m.value,m.defaultValue);break e;case"select":u=m.value,u!=null&&bu(l,!!m.multiple,u,!1)}}}var ay=!1;function KN(l,u,m){if(ay)return l(u,m);ay=!0;try{var b=l(u);return b}finally{if(ay=!1,(_u!==null||Eu!==null)&&(om(),_u&&(u=_u,l=Eu,Eu=_u=null,GN(u),l)))for(u=0;u<l.length;u++)GN(l[u])}}function vd(l,u){var m=l.stateNode;if(m===null)return null;var b=m[me]||null;if(b===null)return null;m=b[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(l=l.type,b=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!b;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(n(231,u,typeof m));return m}var Yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),iy=!1;if(Yi)try{var bd={};Object.defineProperty(bd,"passive",{get:function(){iy=!0}}),window.addEventListener("test",bd,bd),window.removeEventListener("test",bd,bd)}catch{iy=!1}var Go=null,oy=null,wp=null;function XN(){if(wp)return wp;var l,u=oy,m=u.length,b,T="value"in Go?Go.value:Go.textContent,C=T.length;for(l=0;l<m&&u[l]===T[l];l++);var G=m-l;for(b=1;b<=G&&u[m-b]===T[C-b];b++);return wp=T.slice(l,1<b?1-b:void 0)}function _p(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function Ep(){return!0}function YN(){return!1}function Cs(l){function u(m,b,T,C,G){this._reactName=m,this._targetInst=T,this.type=b,this.nativeEvent=C,this.target=G,this.currentTarget=null;for(var le in l)l.hasOwnProperty(le)&&(m=l[le],this[le]=m?m(C):C[le]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Ep:YN,this.isPropagationStopped=YN,this}return p(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Ep)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Ep)},persist:function(){},isPersistent:Ep}),u}var tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sp=Cs(tc),wd=p({},tc,{view:0,detail:0}),SB=Cs(wd),ly,cy,_d,Np=p({},wd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fy,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==_d&&(_d&&l.type==="mousemove"?(ly=l.screenX-_d.screenX,cy=l.screenY-_d.screenY):cy=ly=0,_d=l),ly)},movementY:function(l){return"movementY"in l?l.movementY:cy}}),JN=Cs(Np),NB=p({},Np,{dataTransfer:0}),TB=Cs(NB),kB=p({},wd,{relatedTarget:0}),uy=Cs(kB),AB=p({},tc,{animationName:0,elapsedTime:0,pseudoElement:0}),CB=Cs(AB),RB=p({},tc,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),jB=Cs(RB),OB=p({},tc,{data:0}),ZN=Cs(OB),DB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},IB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FB(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=MB[l])?!!u[l]:!1}function fy(){return FB}var PB=p({},wd,{key:function(l){if(l.key){var u=DB[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=_p(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?IB[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fy,charCode:function(l){return l.type==="keypress"?_p(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?_p(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),LB=Cs(PB),BB=p({},Np,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),QN=Cs(BB),UB=p({},wd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fy}),zB=Cs(UB),HB=p({},tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),VB=Cs(HB),qB=p({},Np,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),WB=Cs(qB),$B=p({},tc,{newState:0,oldState:0}),GB=Cs($B),KB=[9,13,27,32],dy=Yi&&"CompositionEvent"in window,Ed=null;Yi&&"documentMode"in document&&(Ed=document.documentMode);var XB=Yi&&"TextEvent"in window&&!Ed,eT=Yi&&(!dy||Ed&&8<Ed&&11>=Ed),tT=" ",rT=!1;function nT(l,u){switch(l){case"keyup":return KB.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sT(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Su=!1;function YB(l,u){switch(l){case"compositionend":return sT(u);case"keypress":return u.which!==32?null:(rT=!0,tT);case"textInput":return l=u.data,l===tT&&rT?null:l;default:return null}}function JB(l,u){if(Su)return l==="compositionend"||!dy&&nT(l,u)?(l=XN(),wp=oy=Go=null,Su=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return eT&&u.locale!=="ko"?null:u.data;default:return null}}var ZB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function aT(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!ZB[l.type]:u==="textarea"}function iT(l,u,m,b){_u?Eu?Eu.push(b):Eu=[b]:_u=b,u=pm(u,"onChange"),0<u.length&&(m=new Sp("onChange","change",null,m,b),l.push({event:m,listeners:u}))}var Sd=null,Nd=null;function QB(l){HA(l,0)}function Tp(l){var u=Ye(l);if(zN(u))return l}function oT(l,u){if(l==="change")return u}var lT=!1;if(Yi){var hy;if(Yi){var py="oninput"in document;if(!py){var cT=document.createElement("div");cT.setAttribute("oninput","return;"),py=typeof cT.oninput=="function"}hy=py}else hy=!1;lT=hy&&(!document.documentMode||9<document.documentMode)}function uT(){Sd&&(Sd.detachEvent("onpropertychange",fT),Nd=Sd=null)}function fT(l){if(l.propertyName==="value"&&Tp(Nd)){var u=[];iT(u,Nd,l,sy(l)),KN(QB,u)}}function e9(l,u,m){l==="focusin"?(uT(),Sd=u,Nd=m,Sd.attachEvent("onpropertychange",fT)):l==="focusout"&&uT()}function t9(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Tp(Nd)}function r9(l,u){if(l==="click")return Tp(u)}function n9(l,u){if(l==="input"||l==="change")return Tp(u)}function s9(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var Gs=typeof Object.is=="function"?Object.is:s9;function Td(l,u){if(Gs(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var m=Object.keys(l),b=Object.keys(u);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var T=m[b];if(!H.call(u,T)||!Gs(l[T],u[T]))return!1}return!0}function dT(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function hT(l,u){var m=dT(l);l=0;for(var b;m;){if(m.nodeType===3){if(b=l+m.textContent.length,l<=u&&b>=u)return{node:m,offset:u-l};l=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=dT(m)}}function pT(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?pT(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function mT(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var u=vp(l.document);u instanceof l.HTMLIFrameElement;){try{var m=typeof u.contentWindow.location.href=="string"}catch{m=!1}if(m)l=u.contentWindow;else break;u=vp(l.document)}return u}function my(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}var a9=Yi&&"documentMode"in document&&11>=document.documentMode,Nu=null,xy=null,kd=null,gy=!1;function xT(l,u,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;gy||Nu==null||Nu!==vp(b)||(b=Nu,"selectionStart"in b&&my(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),kd&&Td(kd,b)||(kd=b,b=pm(xy,"onSelect"),0<b.length&&(u=new Sp("onSelect","select",null,u,m),l.push({event:u,listeners:b}),u.target=Nu)))}function rc(l,u){var m={};return m[l.toLowerCase()]=u.toLowerCase(),m["Webkit"+l]="webkit"+u,m["Moz"+l]="moz"+u,m}var Tu={animationend:rc("Animation","AnimationEnd"),animationiteration:rc("Animation","AnimationIteration"),animationstart:rc("Animation","AnimationStart"),transitionrun:rc("Transition","TransitionRun"),transitionstart:rc("Transition","TransitionStart"),transitioncancel:rc("Transition","TransitionCancel"),transitionend:rc("Transition","TransitionEnd")},yy={},gT={};Yi&&(gT=document.createElement("div").style,"AnimationEvent"in window||(delete Tu.animationend.animation,delete Tu.animationiteration.animation,delete Tu.animationstart.animation),"TransitionEvent"in window||delete Tu.transitionend.transition);function nc(l){if(yy[l])return yy[l];if(!Tu[l])return l;var u=Tu[l],m;for(m in u)if(u.hasOwnProperty(m)&&m in gT)return yy[l]=u[m];return l}var yT=nc("animationend"),vT=nc("animationiteration"),bT=nc("animationstart"),i9=nc("transitionrun"),o9=nc("transitionstart"),l9=nc("transitioncancel"),wT=nc("transitionend"),_T=new Map,vy="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");vy.push("scrollEnd");function Za(l,u){_T.set(l,u),Ar(u,[l])}var kp=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},xa=[],ku=0,by=0;function Ap(){for(var l=ku,u=by=ku=0;u<l;){var m=xa[u];xa[u++]=null;var b=xa[u];xa[u++]=null;var T=xa[u];xa[u++]=null;var C=xa[u];if(xa[u++]=null,b!==null&&T!==null){var G=b.pending;G===null?T.next=T:(T.next=G.next,G.next=T),b.pending=T}C!==0&&ET(m,T,C)}}function Cp(l,u,m,b){xa[ku++]=l,xa[ku++]=u,xa[ku++]=m,xa[ku++]=b,by|=b,l.lanes|=b,l=l.alternate,l!==null&&(l.lanes|=b)}function wy(l,u,m,b){return Cp(l,u,m,b),Rp(l)}function sc(l,u){return Cp(l,null,null,u),Rp(l)}function ET(l,u,m){l.lanes|=m;var b=l.alternate;b!==null&&(b.lanes|=m);for(var T=!1,C=l.return;C!==null;)C.childLanes|=m,b=C.alternate,b!==null&&(b.childLanes|=m),C.tag===22&&(l=C.stateNode,l===null||l._visibility&1||(T=!0)),l=C,C=C.return;return l.tag===3?(C=l.stateNode,T&&u!==null&&(T=31-lr(m),l=C.hiddenUpdates,b=l[T],b===null?l[T]=[u]:b.push(u),u.lane=m|536870912),C):null}function Rp(l){if(50<Xd)throw Xd=0,Rv=null,Error(n(185));for(var u=l.return;u!==null;)l=u,u=l.return;return l.tag===3?l.stateNode:null}var Au={};function c9(l,u,m,b){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ks(l,u,m,b){return new c9(l,u,m,b)}function _y(l){return l=l.prototype,!(!l||!l.isReactComponent)}function Ji(l,u){var m=l.alternate;return m===null?(m=Ks(l.tag,u,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=u,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&65011712,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,u=l.dependencies,m.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m.refCleanup=l.refCleanup,m}function ST(l,u){l.flags&=65011714;var m=l.alternate;return m===null?(l.childLanes=0,l.lanes=u,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=m.childLanes,l.lanes=m.lanes,l.child=m.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=m.memoizedProps,l.memoizedState=m.memoizedState,l.updateQueue=m.updateQueue,l.type=m.type,u=m.dependencies,l.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),l}function jp(l,u,m,b,T,C){var G=0;if(b=l,typeof l=="function")_y(l)&&(G=1);else if(typeof l=="string")G=p7(l,m,W.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case I:return l=Ks(31,m,u,T),l.elementType=I,l.lanes=C,l;case y:return ac(m.children,T,C,u);case w:G=8,T|=24;break;case _:return l=Ks(12,m,u,T|2),l.elementType=_,l.lanes=C,l;case k:return l=Ks(13,m,u,T),l.elementType=k,l.lanes=C,l;case O:return l=Ks(19,m,u,T),l.elementType=O,l.lanes=C,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case E:G=10;break e;case S:G=9;break e;case N:G=11;break e;case R:G=14;break e;case V:G=16,b=null;break e}G=29,m=Error(n(130,l===null?"null":typeof l,"")),b=null}return u=Ks(G,m,u,T),u.elementType=l,u.type=b,u.lanes=C,u}function ac(l,u,m,b){return l=Ks(7,l,b,u),l.lanes=m,l}function Ey(l,u,m){return l=Ks(6,l,null,u),l.lanes=m,l}function NT(l){var u=Ks(18,null,null,0);return u.stateNode=l,u}function Sy(l,u,m){return u=Ks(4,l.children!==null?l.children:[],l.key,u),u.lanes=m,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}var TT=new WeakMap;function ga(l,u){if(typeof l=="object"&&l!==null){var m=TT.get(l);return m!==void 0?m:(u={value:l,source:u,stack:j(u)},TT.set(l,u),u)}return{value:l,source:u,stack:j(u)}}var Cu=[],Ru=0,Op=null,Ad=0,ya=[],va=0,Ko=null,yi=1,vi="";function Zi(l,u){Cu[Ru++]=Ad,Cu[Ru++]=Op,Op=l,Ad=u}function kT(l,u,m){ya[va++]=yi,ya[va++]=vi,ya[va++]=Ko,Ko=l;var b=yi;l=vi;var T=32-lr(b)-1;b&=~(1<<T),m+=1;var C=32-lr(u)+T;if(30<C){var G=T-T%5;C=(b&(1<<G)-1).toString(32),b>>=G,T-=G,yi=1<<32-lr(u)+T|m<<T|b,vi=C+l}else yi=1<<C|m<<T|b,vi=l}function Ny(l){l.return!==null&&(Zi(l,1),kT(l,1,0))}function Ty(l){for(;l===Op;)Op=Cu[--Ru],Cu[Ru]=null,Ad=Cu[--Ru],Cu[Ru]=null;for(;l===Ko;)Ko=ya[--va],ya[va]=null,vi=ya[--va],ya[va]=null,yi=ya[--va],ya[va]=null}function AT(l,u){ya[va++]=yi,ya[va++]=vi,ya[va++]=Ko,yi=u.id,vi=u.overflow,Ko=l}var Bn=null,wr=null,qt=!1,Xo=null,ba=!1,ky=Error(n(519));function Yo(l){var u=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Cd(ga(u,l)),ky}function CT(l){var u=l.stateNode,m=l.type,b=l.memoizedProps;switch(u[de]=l,u[me]=b,m){case"dialog":Ut("cancel",u),Ut("close",u);break;case"iframe":case"object":case"embed":Ut("load",u);break;case"video":case"audio":for(m=0;m<Jd.length;m++)Ut(Jd[m],u);break;case"source":Ut("error",u);break;case"img":case"image":case"link":Ut("error",u),Ut("load",u);break;case"details":Ut("toggle",u);break;case"input":Ut("invalid",u),HN(u,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0);break;case"select":Ut("invalid",u);break;case"textarea":Ut("invalid",u),qN(u,b.value,b.defaultValue,b.children)}m=b.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||u.textContent===""+m||b.suppressHydrationWarning===!0||$A(u.textContent,m)?(b.popover!=null&&(Ut("beforetoggle",u),Ut("toggle",u)),b.onScroll!=null&&Ut("scroll",u),b.onScrollEnd!=null&&Ut("scrollend",u),b.onClick!=null&&(u.onclick=Xi),u=!0):u=!1,u||Yo(l,!0)}function RT(l){for(Bn=l.return;Bn;)switch(Bn.tag){case 5:case 31:case 13:ba=!1;return;case 27:case 3:ba=!0;return;default:Bn=Bn.return}}function ju(l){if(l!==Bn)return!1;if(!qt)return RT(l),qt=!0,!1;var u=l.tag,m;if((m=u!==3&&u!==27)&&((m=u===5)&&(m=l.type,m=!(m!=="form"&&m!=="button")||Wv(l.type,l.memoizedProps)),m=!m),m&&wr&&Yo(l),RT(l),u===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));wr=tC(l)}else if(u===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));wr=tC(l)}else u===27?(u=wr,ul(l.type)?(l=Yv,Yv=null,wr=l):wr=u):wr=Bn?_a(l.stateNode.nextSibling):null;return!0}function ic(){wr=Bn=null,qt=!1}function Ay(){var l=Xo;return l!==null&&(Ds===null?Ds=l:Ds.push.apply(Ds,l),Xo=null),l}function Cd(l){Xo===null?Xo=[l]:Xo.push(l)}var Cy=K(null),oc=null,Qi=null;function Jo(l,u,m){q(Cy,u._currentValue),u._currentValue=m}function eo(l){l._currentValue=Cy.current,D(Cy)}function Ry(l,u,m){for(;l!==null;){var b=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,b!==null&&(b.childLanes|=u)):b!==null&&(b.childLanes&u)!==u&&(b.childLanes|=u),l===m)break;l=l.return}}function jy(l,u,m,b){var T=l.child;for(T!==null&&(T.return=l);T!==null;){var C=T.dependencies;if(C!==null){var G=T.child;C=C.firstContext;e:for(;C!==null;){var le=C;C=T;for(var we=0;we<u.length;we++)if(le.context===u[we]){C.lanes|=m,le=C.alternate,le!==null&&(le.lanes|=m),Ry(C.return,m,l),b||(G=null);break e}C=le.next}}else if(T.tag===18){if(G=T.return,G===null)throw Error(n(341));G.lanes|=m,C=G.alternate,C!==null&&(C.lanes|=m),Ry(G,m,l),G=null}else G=T.child;if(G!==null)G.return=T;else for(G=T;G!==null;){if(G===l){G=null;break}if(T=G.sibling,T!==null){T.return=G.return,G=T;break}G=G.return}T=G}}function Ou(l,u,m,b){l=null;for(var T=u,C=!1;T!==null;){if(!C){if((T.flags&524288)!==0)C=!0;else if((T.flags&262144)!==0)break}if(T.tag===10){var G=T.alternate;if(G===null)throw Error(n(387));if(G=G.memoizedProps,G!==null){var le=T.type;Gs(T.pendingProps.value,G.value)||(l!==null?l.push(le):l=[le])}}else if(T===U.current){if(G=T.alternate,G===null)throw Error(n(387));G.memoizedState.memoizedState!==T.memoizedState.memoizedState&&(l!==null?l.push(rh):l=[rh])}T=T.return}l!==null&&jy(u,l,m,b),u.flags|=262144}function Dp(l){for(l=l.firstContext;l!==null;){if(!Gs(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function lc(l){oc=l,Qi=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Un(l){return jT(oc,l)}function Ip(l,u){return oc===null&&lc(l),jT(l,u)}function jT(l,u){var m=u._currentValue;if(u={context:u,memoizedValue:m,next:null},Qi===null){if(l===null)throw Error(n(308));Qi=u,l.dependencies={lanes:0,firstContext:u},l.flags|=524288}else Qi=Qi.next=u;return m}var u9=typeof AbortController<"u"?AbortController:function(){var l=[],u=this.signal={aborted:!1,addEventListener:function(m,b){l.push(b)}};this.abort=function(){u.aborted=!0,l.forEach(function(m){return m()})}},f9=e.unstable_scheduleCallback,d9=e.unstable_NormalPriority,an={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Oy(){return{controller:new u9,data:new Map,refCount:0}}function Rd(l){l.refCount--,l.refCount===0&&f9(d9,function(){l.controller.abort()})}var jd=null,Dy=0,Du=0,Iu=null;function h9(l,u){if(jd===null){var m=jd=[];Dy=0,Du=Fv(),Iu={status:"pending",value:void 0,then:function(b){m.push(b)}}}return Dy++,u.then(OT,OT),u}function OT(){if(--Dy===0&&jd!==null){Iu!==null&&(Iu.status="fulfilled");var l=jd;jd=null,Du=0,Iu=null;for(var u=0;u<l.length;u++)(0,l[u])()}}function p9(l,u){var m=[],b={status:"pending",value:null,reason:null,then:function(T){m.push(T)}};return l.then(function(){b.status="fulfilled",b.value=u;for(var T=0;T<m.length;T++)(0,m[T])(u)},function(T){for(b.status="rejected",b.reason=T,T=0;T<m.length;T++)(0,m[T])(void 0)}),b}var DT=te.S;te.S=function(l,u){xA=De(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&h9(l,u),DT!==null&&DT(l,u)};var cc=K(null);function Iy(){var l=cc.current;return l!==null?l:mr.pooledCache}function Mp(l,u){u===null?q(cc,cc.current):q(cc,u.pool)}function IT(){var l=Iy();return l===null?null:{parent:an._currentValue,pool:l}}var Mu=Error(n(460)),My=Error(n(474)),Fp=Error(n(542)),Pp={then:function(){}};function MT(l){return l=l.status,l==="fulfilled"||l==="rejected"}function FT(l,u,m){switch(m=l[m],m===void 0?l.push(u):m!==u&&(u.then(Xi,Xi),u=m),u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,LT(l),l;default:if(typeof u.status=="string")u.then(Xi,Xi);else{if(l=mr,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=u,l.status="pending",l.then(function(b){if(u.status==="pending"){var T=u;T.status="fulfilled",T.value=b}},function(b){if(u.status==="pending"){var T=u;T.status="rejected",T.reason=b}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,LT(l),l}throw fc=u,Mu}}function uc(l){try{var u=l._init;return u(l._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(fc=m,Mu):m}}var fc=null;function PT(){if(fc===null)throw Error(n(459));var l=fc;return fc=null,l}function LT(l){if(l===Mu||l===Fp)throw Error(n(483))}var Fu=null,Od=0;function Lp(l){var u=Od;return Od+=1,Fu===null&&(Fu=[]),FT(Fu,l,u)}function Dd(l,u){u=u.props.ref,l.ref=u!==void 0?u:null}function Bp(l,u){throw u.$$typeof===x?Error(n(525)):(l=Object.prototype.toString.call(u),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l)))}function BT(l){function u(Se,_e){if(l){var Te=Se.deletions;Te===null?(Se.deletions=[_e],Se.flags|=16):Te.push(_e)}}function m(Se,_e){if(!l)return null;for(;_e!==null;)u(Se,_e),_e=_e.sibling;return null}function b(Se){for(var _e=new Map;Se!==null;)Se.key!==null?_e.set(Se.key,Se):_e.set(Se.index,Se),Se=Se.sibling;return _e}function T(Se,_e){return Se=Ji(Se,_e),Se.index=0,Se.sibling=null,Se}function C(Se,_e,Te){return Se.index=Te,l?(Te=Se.alternate,Te!==null?(Te=Te.index,Te<_e?(Se.flags|=67108866,_e):Te):(Se.flags|=67108866,_e)):(Se.flags|=1048576,_e)}function G(Se){return l&&Se.alternate===null&&(Se.flags|=67108866),Se}function le(Se,_e,Te,He){return _e===null||_e.tag!==6?(_e=Ey(Te,Se.mode,He),_e.return=Se,_e):(_e=T(_e,Te),_e.return=Se,_e)}function we(Se,_e,Te,He){var pt=Te.type;return pt===y?Ue(Se,_e,Te.props.children,He,Te.key):_e!==null&&(_e.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===V&&uc(pt)===_e.type)?(_e=T(_e,Te.props),Dd(_e,Te),_e.return=Se,_e):(_e=jp(Te.type,Te.key,Te.props,null,Se.mode,He),Dd(_e,Te),_e.return=Se,_e)}function ke(Se,_e,Te,He){return _e===null||_e.tag!==4||_e.stateNode.containerInfo!==Te.containerInfo||_e.stateNode.implementation!==Te.implementation?(_e=Sy(Te,Se.mode,He),_e.return=Se,_e):(_e=T(_e,Te.children||[]),_e.return=Se,_e)}function Ue(Se,_e,Te,He,pt){return _e===null||_e.tag!==7?(_e=ac(Te,Se.mode,He,pt),_e.return=Se,_e):(_e=T(_e,Te),_e.return=Se,_e)}function Ve(Se,_e,Te){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return _e=Ey(""+_e,Se.mode,Te),_e.return=Se,_e;if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case g:return Te=jp(_e.type,_e.key,_e.props,null,Se.mode,Te),Dd(Te,_e),Te.return=Se,Te;case v:return _e=Sy(_e,Se.mode,Te),_e.return=Se,_e;case V:return _e=uc(_e),Ve(Se,_e,Te)}if(ie(_e)||F(_e))return _e=ac(_e,Se.mode,Te,null),_e.return=Se,_e;if(typeof _e.then=="function")return Ve(Se,Lp(_e),Te);if(_e.$$typeof===E)return Ve(Se,Ip(Se,_e),Te);Bp(Se,_e)}return null}function je(Se,_e,Te,He){var pt=_e!==null?_e.key:null;if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return pt!==null?null:le(Se,_e,""+Te,He);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case g:return Te.key===pt?we(Se,_e,Te,He):null;case v:return Te.key===pt?ke(Se,_e,Te,He):null;case V:return Te=uc(Te),je(Se,_e,Te,He)}if(ie(Te)||F(Te))return pt!==null?null:Ue(Se,_e,Te,He,null);if(typeof Te.then=="function")return je(Se,_e,Lp(Te),He);if(Te.$$typeof===E)return je(Se,_e,Ip(Se,Te),He);Bp(Se,Te)}return null}function Ie(Se,_e,Te,He,pt){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return Se=Se.get(Te)||null,le(_e,Se,""+He,pt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case g:return Se=Se.get(He.key===null?Te:He.key)||null,we(_e,Se,He,pt);case v:return Se=Se.get(He.key===null?Te:He.key)||null,ke(_e,Se,He,pt);case V:return He=uc(He),Ie(Se,_e,Te,He,pt)}if(ie(He)||F(He))return Se=Se.get(Te)||null,Ue(_e,Se,He,pt,null);if(typeof He.then=="function")return Ie(Se,_e,Te,Lp(He),pt);if(He.$$typeof===E)return Ie(Se,_e,Te,Ip(_e,He),pt);Bp(_e,He)}return null}function ot(Se,_e,Te,He){for(var pt=null,Kt=null,ft=_e,Rt=_e=0,Vt=null;ft!==null&&Rt<Te.length;Rt++){ft.index>Rt?(Vt=ft,ft=null):Vt=ft.sibling;var Xt=je(Se,ft,Te[Rt],He);if(Xt===null){ft===null&&(ft=Vt);break}l&&ft&&Xt.alternate===null&&u(Se,ft),_e=C(Xt,_e,Rt),Kt===null?pt=Xt:Kt.sibling=Xt,Kt=Xt,ft=Vt}if(Rt===Te.length)return m(Se,ft),qt&&Zi(Se,Rt),pt;if(ft===null){for(;Rt<Te.length;Rt++)ft=Ve(Se,Te[Rt],He),ft!==null&&(_e=C(ft,_e,Rt),Kt===null?pt=ft:Kt.sibling=ft,Kt=ft);return qt&&Zi(Se,Rt),pt}for(ft=b(ft);Rt<Te.length;Rt++)Vt=Ie(ft,Se,Rt,Te[Rt],He),Vt!==null&&(l&&Vt.alternate!==null&&ft.delete(Vt.key===null?Rt:Vt.key),_e=C(Vt,_e,Rt),Kt===null?pt=Vt:Kt.sibling=Vt,Kt=Vt);return l&&ft.forEach(function(ml){return u(Se,ml)}),qt&&Zi(Se,Rt),pt}function gt(Se,_e,Te,He){if(Te==null)throw Error(n(151));for(var pt=null,Kt=null,ft=_e,Rt=_e=0,Vt=null,Xt=Te.next();ft!==null&&!Xt.done;Rt++,Xt=Te.next()){ft.index>Rt?(Vt=ft,ft=null):Vt=ft.sibling;var ml=je(Se,ft,Xt.value,He);if(ml===null){ft===null&&(ft=Vt);break}l&&ft&&ml.alternate===null&&u(Se,ft),_e=C(ml,_e,Rt),Kt===null?pt=ml:Kt.sibling=ml,Kt=ml,ft=Vt}if(Xt.done)return m(Se,ft),qt&&Zi(Se,Rt),pt;if(ft===null){for(;!Xt.done;Rt++,Xt=Te.next())Xt=Ve(Se,Xt.value,He),Xt!==null&&(_e=C(Xt,_e,Rt),Kt===null?pt=Xt:Kt.sibling=Xt,Kt=Xt);return qt&&Zi(Se,Rt),pt}for(ft=b(ft);!Xt.done;Rt++,Xt=Te.next())Xt=Ie(ft,Se,Rt,Xt.value,He),Xt!==null&&(l&&Xt.alternate!==null&&ft.delete(Xt.key===null?Rt:Xt.key),_e=C(Xt,_e,Rt),Kt===null?pt=Xt:Kt.sibling=Xt,Kt=Xt);return l&&ft.forEach(function(N7){return u(Se,N7)}),qt&&Zi(Se,Rt),pt}function fr(Se,_e,Te,He){if(typeof Te=="object"&&Te!==null&&Te.type===y&&Te.key===null&&(Te=Te.props.children),typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case g:e:{for(var pt=Te.key;_e!==null;){if(_e.key===pt){if(pt=Te.type,pt===y){if(_e.tag===7){m(Se,_e.sibling),He=T(_e,Te.props.children),He.return=Se,Se=He;break e}}else if(_e.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===V&&uc(pt)===_e.type){m(Se,_e.sibling),He=T(_e,Te.props),Dd(He,Te),He.return=Se,Se=He;break e}m(Se,_e);break}else u(Se,_e);_e=_e.sibling}Te.type===y?(He=ac(Te.props.children,Se.mode,He,Te.key),He.return=Se,Se=He):(He=jp(Te.type,Te.key,Te.props,null,Se.mode,He),Dd(He,Te),He.return=Se,Se=He)}return G(Se);case v:e:{for(pt=Te.key;_e!==null;){if(_e.key===pt)if(_e.tag===4&&_e.stateNode.containerInfo===Te.containerInfo&&_e.stateNode.implementation===Te.implementation){m(Se,_e.sibling),He=T(_e,Te.children||[]),He.return=Se,Se=He;break e}else{m(Se,_e);break}else u(Se,_e);_e=_e.sibling}He=Sy(Te,Se.mode,He),He.return=Se,Se=He}return G(Se);case V:return Te=uc(Te),fr(Se,_e,Te,He)}if(ie(Te))return ot(Se,_e,Te,He);if(F(Te)){if(pt=F(Te),typeof pt!="function")throw Error(n(150));return Te=pt.call(Te),gt(Se,_e,Te,He)}if(typeof Te.then=="function")return fr(Se,_e,Lp(Te),He);if(Te.$$typeof===E)return fr(Se,_e,Ip(Se,Te),He);Bp(Se,Te)}return typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint"?(Te=""+Te,_e!==null&&_e.tag===6?(m(Se,_e.sibling),He=T(_e,Te),He.return=Se,Se=He):(m(Se,_e),He=Ey(Te,Se.mode,He),He.return=Se,Se=He),G(Se)):m(Se,_e)}return function(Se,_e,Te,He){try{Od=0;var pt=fr(Se,_e,Te,He);return Fu=null,pt}catch(ft){if(ft===Mu||ft===Fp)throw ft;var Kt=Ks(29,ft,null,Se.mode);return Kt.lanes=He,Kt.return=Se,Kt}finally{}}}var dc=BT(!0),UT=BT(!1),Zo=!1;function Fy(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Py(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function Qo(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function el(l,u,m){var b=l.updateQueue;if(b===null)return null;if(b=b.shared,(Jt&2)!==0){var T=b.pending;return T===null?u.next=u:(u.next=T.next,T.next=u),b.pending=u,u=Rp(l),ET(l,null,m),u}return Cp(l,b,u,m),Rp(l)}function Id(l,u,m){if(u=u.updateQueue,u!==null&&(u=u.shared,(m&4194048)!==0)){var b=u.lanes;b&=l.pendingLanes,m|=b,u.lanes=m,An(l,m)}}function Ly(l,u){var m=l.updateQueue,b=l.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var T=null,C=null;if(m=m.firstBaseUpdate,m!==null){do{var G={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};C===null?T=C=G:C=C.next=G,m=m.next}while(m!==null);C===null?T=C=u:C=C.next=u}else T=C=u;m={baseState:b.baseState,firstBaseUpdate:T,lastBaseUpdate:C,shared:b.shared,callbacks:b.callbacks},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=u:l.next=u,m.lastBaseUpdate=u}var By=!1;function Md(){if(By){var l=Iu;if(l!==null)throw l}}function Fd(l,u,m,b){By=!1;var T=l.updateQueue;Zo=!1;var C=T.firstBaseUpdate,G=T.lastBaseUpdate,le=T.shared.pending;if(le!==null){T.shared.pending=null;var we=le,ke=we.next;we.next=null,G===null?C=ke:G.next=ke,G=we;var Ue=l.alternate;Ue!==null&&(Ue=Ue.updateQueue,le=Ue.lastBaseUpdate,le!==G&&(le===null?Ue.firstBaseUpdate=ke:le.next=ke,Ue.lastBaseUpdate=we))}if(C!==null){var Ve=T.baseState;G=0,Ue=ke=we=null,le=C;do{var je=le.lane&-536870913,Ie=je!==le.lane;if(Ie?(Ht&je)===je:(b&je)===je){je!==0&&je===Du&&(By=!0),Ue!==null&&(Ue=Ue.next={lane:0,tag:le.tag,payload:le.payload,callback:null,next:null});e:{var ot=l,gt=le;je=u;var fr=m;switch(gt.tag){case 1:if(ot=gt.payload,typeof ot=="function"){Ve=ot.call(fr,Ve,je);break e}Ve=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=gt.payload,je=typeof ot=="function"?ot.call(fr,Ve,je):ot,je==null)break e;Ve=p({},Ve,je);break e;case 2:Zo=!0}}je=le.callback,je!==null&&(l.flags|=64,Ie&&(l.flags|=8192),Ie=T.callbacks,Ie===null?T.callbacks=[je]:Ie.push(je))}else Ie={lane:je,tag:le.tag,payload:le.payload,callback:le.callback,next:null},Ue===null?(ke=Ue=Ie,we=Ve):Ue=Ue.next=Ie,G|=je;if(le=le.next,le===null){if(le=T.shared.pending,le===null)break;Ie=le,le=Ie.next,Ie.next=null,T.lastBaseUpdate=Ie,T.shared.pending=null}}while(!0);Ue===null&&(we=Ve),T.baseState=we,T.firstBaseUpdate=ke,T.lastBaseUpdate=Ue,C===null&&(T.shared.lanes=0),al|=G,l.lanes=G,l.memoizedState=Ve}}function zT(l,u){if(typeof l!="function")throw Error(n(191,l));l.call(u)}function HT(l,u){var m=l.callbacks;if(m!==null)for(l.callbacks=null,l=0;l<m.length;l++)zT(m[l],u)}var Pu=K(null),Up=K(0);function VT(l,u){l=co,q(Up,l),q(Pu,u),co=l|u.baseLanes}function Uy(){q(Up,co),q(Pu,Pu.current)}function zy(){co=Up.current,D(Pu),D(Up)}var Xs=K(null),wa=null;function tl(l){var u=l.alternate;q($r,$r.current&1),q(Xs,l),wa===null&&(u===null||Pu.current!==null||u.memoizedState!==null)&&(wa=l)}function Hy(l){q($r,$r.current),q(Xs,l),wa===null&&(wa=l)}function qT(l){l.tag===22?(q($r,$r.current),q(Xs,l),wa===null&&(wa=l)):rl()}function rl(){q($r,$r.current),q(Xs,Xs.current)}function Ys(l){D(Xs),wa===l&&(wa=null),D($r)}var $r=K(0);function zp(l){for(var u=l;u!==null;){if(u.tag===13){var m=u.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||Kv(m)||Xv(m)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var to=0,kt=null,cr=null,on=null,Hp=!1,Lu=!1,hc=!1,Vp=0,Pd=0,Bu=null,m9=0;function Pr(){throw Error(n(321))}function Vy(l,u){if(u===null)return!1;for(var m=0;m<u.length&&m<l.length;m++)if(!Gs(l[m],u[m]))return!1;return!0}function qy(l,u,m,b,T,C){return to=C,kt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,te.H=l===null||l.memoizedState===null?kk:av,hc=!1,C=m(b,T),hc=!1,Lu&&(C=$T(u,m,b,T)),WT(l),C}function WT(l){te.H=Ud;var u=cr!==null&&cr.next!==null;if(to=0,on=cr=kt=null,Hp=!1,Pd=0,Bu=null,u)throw Error(n(300));l===null||ln||(l=l.dependencies,l!==null&&Dp(l)&&(ln=!0))}function $T(l,u,m,b){kt=l;var T=0;do{if(Lu&&(Bu=null),Pd=0,Lu=!1,25<=T)throw Error(n(301));if(T+=1,on=cr=null,l.updateQueue!=null){var C=l.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}te.H=Ak,C=u(m,b)}while(Lu);return C}function x9(){var l=te.H,u=l.useState()[0];return u=typeof u.then=="function"?Ld(u):u,l=l.useState()[0],(cr!==null?cr.memoizedState:null)!==l&&(kt.flags|=1024),u}function Wy(){var l=Vp!==0;return Vp=0,l}function $y(l,u,m){u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~m}function Gy(l){if(Hp){for(l=l.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}Hp=!1}to=0,on=cr=kt=null,Lu=!1,Pd=Vp=0,Bu=null}function ys(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?kt.memoizedState=on=l:on=on.next=l,on}function Gr(){if(cr===null){var l=kt.alternate;l=l!==null?l.memoizedState:null}else l=cr.next;var u=on===null?kt.memoizedState:on.next;if(u!==null)on=u,cr=l;else{if(l===null)throw kt.alternate===null?Error(n(467)):Error(n(310));cr=l,l={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},on===null?kt.memoizedState=on=l:on=on.next=l}return on}function qp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ld(l){var u=Pd;return Pd+=1,Bu===null&&(Bu=[]),l=FT(Bu,l,u),u=kt,(on===null?u.memoizedState:on.next)===null&&(u=u.alternate,te.H=u===null||u.memoizedState===null?kk:av),l}function Wp(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Ld(l);if(l.$$typeof===E)return Un(l)}throw Error(n(438,String(l)))}function Ky(l){var u=null,m=kt.updateQueue;if(m!==null&&(u=m.memoCache),u==null){var b=kt.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(u={data:b.data.map(function(T){return T.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),m===null&&(m=qp(),kt.updateQueue=m),m.memoCache=u,m=u.data[u.index],m===void 0)for(m=u.data[u.index]=Array(l),b=0;b<l;b++)m[b]=Z;return u.index++,m}function ro(l,u){return typeof u=="function"?u(l):u}function $p(l){var u=Gr();return Xy(u,cr,l)}function Xy(l,u,m){var b=l.queue;if(b===null)throw Error(n(311));b.lastRenderedReducer=m;var T=l.baseQueue,C=b.pending;if(C!==null){if(T!==null){var G=T.next;T.next=C.next,C.next=G}u.baseQueue=T=C,b.pending=null}if(C=l.baseState,T===null)l.memoizedState=C;else{u=T.next;var le=G=null,we=null,ke=u,Ue=!1;do{var Ve=ke.lane&-536870913;if(Ve!==ke.lane?(Ht&Ve)===Ve:(to&Ve)===Ve){var je=ke.revertLane;if(je===0)we!==null&&(we=we.next={lane:0,revertLane:0,gesture:null,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),Ve===Du&&(Ue=!0);else if((to&je)===je){ke=ke.next,je===Du&&(Ue=!0);continue}else Ve={lane:0,revertLane:ke.revertLane,gesture:null,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null},we===null?(le=we=Ve,G=C):we=we.next=Ve,kt.lanes|=je,al|=je;Ve=ke.action,hc&&m(C,Ve),C=ke.hasEagerState?ke.eagerState:m(C,Ve)}else je={lane:Ve,revertLane:ke.revertLane,gesture:ke.gesture,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null},we===null?(le=we=je,G=C):we=we.next=je,kt.lanes|=Ve,al|=Ve;ke=ke.next}while(ke!==null&&ke!==u);if(we===null?G=C:we.next=le,!Gs(C,l.memoizedState)&&(ln=!0,Ue&&(m=Iu,m!==null)))throw m;l.memoizedState=C,l.baseState=G,l.baseQueue=we,b.lastRenderedState=C}return T===null&&(b.lanes=0),[l.memoizedState,b.dispatch]}function Yy(l){var u=Gr(),m=u.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=l;var b=m.dispatch,T=m.pending,C=u.memoizedState;if(T!==null){m.pending=null;var G=T=T.next;do C=l(C,G.action),G=G.next;while(G!==T);Gs(C,u.memoizedState)||(ln=!0),u.memoizedState=C,u.baseQueue===null&&(u.baseState=C),m.lastRenderedState=C}return[C,b]}function GT(l,u,m){var b=kt,T=Gr(),C=qt;if(C){if(m===void 0)throw Error(n(407));m=m()}else m=u();var G=!Gs((cr||T).memoizedState,m);if(G&&(T.memoizedState=m,ln=!0),T=T.queue,Qy(YT.bind(null,b,T,l),[l]),T.getSnapshot!==u||G||on!==null&&on.memoizedState.tag&1){if(b.flags|=2048,Uu(9,{destroy:void 0},XT.bind(null,b,T,m,u),null),mr===null)throw Error(n(349));C||(to&127)!==0||KT(b,u,m)}return m}function KT(l,u,m){l.flags|=16384,l={getSnapshot:u,value:m},u=kt.updateQueue,u===null?(u=qp(),kt.updateQueue=u,u.stores=[l]):(m=u.stores,m===null?u.stores=[l]:m.push(l))}function XT(l,u,m,b){u.value=m,u.getSnapshot=b,JT(u)&&ZT(l)}function YT(l,u,m){return m(function(){JT(u)&&ZT(l)})}function JT(l){var u=l.getSnapshot;l=l.value;try{var m=u();return!Gs(l,m)}catch{return!0}}function ZT(l){var u=sc(l,2);u!==null&&Is(u,l,2)}function Jy(l){var u=ys();if(typeof l=="function"){var m=l;if(l=m(),hc){Tn(!0);try{m()}finally{Tn(!1)}}}return u.memoizedState=u.baseState=l,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ro,lastRenderedState:l},u}function QT(l,u,m,b){return l.baseState=m,Xy(l,cr,typeof b=="function"?b:ro)}function g9(l,u,m,b,T){if(Xp(l))throw Error(n(485));if(l=u.action,l!==null){var C={payload:T,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){C.listeners.push(G)}};te.T!==null?m(!0):C.isTransition=!1,b(C),m=u.pending,m===null?(C.next=u.pending=C,ek(u,C)):(C.next=m.next,u.pending=m.next=C)}}function ek(l,u){var m=u.action,b=u.payload,T=l.state;if(u.isTransition){var C=te.T,G={};te.T=G;try{var le=m(T,b),we=te.S;we!==null&&we(G,le),tk(l,u,le)}catch(ke){Zy(l,u,ke)}finally{C!==null&&G.types!==null&&(C.types=G.types),te.T=C}}else try{C=m(T,b),tk(l,u,C)}catch(ke){Zy(l,u,ke)}}function tk(l,u,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(b){rk(l,u,b)},function(b){return Zy(l,u,b)}):rk(l,u,m)}function rk(l,u,m){u.status="fulfilled",u.value=m,nk(u),l.state=m,u=l.pending,u!==null&&(m=u.next,m===u?l.pending=null:(m=m.next,u.next=m,ek(l,m)))}function Zy(l,u,m){var b=l.pending;if(l.pending=null,b!==null){b=b.next;do u.status="rejected",u.reason=m,nk(u),u=u.next;while(u!==b)}l.action=null}function nk(l){l=l.listeners;for(var u=0;u<l.length;u++)(0,l[u])()}function sk(l,u){return u}function ak(l,u){if(qt){var m=mr.formState;if(m!==null){e:{var b=kt;if(qt){if(wr){t:{for(var T=wr,C=ba;T.nodeType!==8;){if(!C){T=null;break t}if(T=_a(T.nextSibling),T===null){T=null;break t}}C=T.data,T=C==="F!"||C==="F"?T:null}if(T){wr=_a(T.nextSibling),b=T.data==="F!";break e}}Yo(b)}b=!1}b&&(u=m[0])}}return m=ys(),m.memoizedState=m.baseState=u,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sk,lastRenderedState:u},m.queue=b,m=Sk.bind(null,kt,b),b.dispatch=m,b=Jy(!1),C=sv.bind(null,kt,!1,b.queue),b=ys(),T={state:u,dispatch:null,action:l,pending:null},b.queue=T,m=g9.bind(null,kt,T,C,m),T.dispatch=m,b.memoizedState=l,[u,m,!1]}function ik(l){var u=Gr();return ok(u,cr,l)}function ok(l,u,m){if(u=Xy(l,u,sk)[0],l=$p(ro)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var b=Ld(u)}catch(G){throw G===Mu?Fp:G}else b=u;u=Gr();var T=u.queue,C=T.dispatch;return m!==u.memoizedState&&(kt.flags|=2048,Uu(9,{destroy:void 0},y9.bind(null,T,m),null)),[b,C,l]}function y9(l,u){l.action=u}function lk(l){var u=Gr(),m=cr;if(m!==null)return ok(u,m,l);Gr(),u=u.memoizedState,m=Gr();var b=m.queue.dispatch;return m.memoizedState=l,[u,b,!1]}function Uu(l,u,m,b){return l={tag:l,create:m,deps:b,inst:u,next:null},u=kt.updateQueue,u===null&&(u=qp(),kt.updateQueue=u),m=u.lastEffect,m===null?u.lastEffect=l.next=l:(b=m.next,m.next=l,l.next=b,u.lastEffect=l),l}function ck(){return Gr().memoizedState}function Gp(l,u,m,b){var T=ys();kt.flags|=l,T.memoizedState=Uu(1|u,{destroy:void 0},m,b===void 0?null:b)}function Kp(l,u,m,b){var T=Gr();b=b===void 0?null:b;var C=T.memoizedState.inst;cr!==null&&b!==null&&Vy(b,cr.memoizedState.deps)?T.memoizedState=Uu(u,C,m,b):(kt.flags|=l,T.memoizedState=Uu(1|u,C,m,b))}function uk(l,u){Gp(8390656,8,l,u)}function Qy(l,u){Kp(2048,8,l,u)}function v9(l){kt.flags|=4;var u=kt.updateQueue;if(u===null)u=qp(),kt.updateQueue=u,u.events=[l];else{var m=u.events;m===null?u.events=[l]:m.push(l)}}function fk(l){var u=Gr().memoizedState;return v9({ref:u,nextImpl:l}),function(){if((Jt&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}function dk(l,u){return Kp(4,2,l,u)}function hk(l,u){return Kp(4,4,l,u)}function pk(l,u){if(typeof u=="function"){l=l();var m=u(l);return function(){typeof m=="function"?m():u(null)}}if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function mk(l,u,m){m=m!=null?m.concat([l]):null,Kp(4,4,pk.bind(null,u,l),m)}function ev(){}function xk(l,u){var m=Gr();u=u===void 0?null:u;var b=m.memoizedState;return u!==null&&Vy(u,b[1])?b[0]:(m.memoizedState=[l,u],l)}function gk(l,u){var m=Gr();u=u===void 0?null:u;var b=m.memoizedState;if(u!==null&&Vy(u,b[1]))return b[0];if(b=l(),hc){Tn(!0);try{l()}finally{Tn(!1)}}return m.memoizedState=[b,u],b}function tv(l,u,m){return m===void 0||(to&1073741824)!==0&&(Ht&261930)===0?l.memoizedState=u:(l.memoizedState=m,l=yA(),kt.lanes|=l,al|=l,m)}function yk(l,u,m,b){return Gs(m,u)?m:Pu.current!==null?(l=tv(l,m,b),Gs(l,u)||(ln=!0),l):(to&42)===0||(to&1073741824)!==0&&(Ht&261930)===0?(ln=!0,l.memoizedState=m):(l=yA(),kt.lanes|=l,al|=l,u)}function vk(l,u,m,b,T){var C=Y.p;Y.p=C!==0&&8>C?C:8;var G=te.T,le={};te.T=le,sv(l,!1,u,m);try{var we=T(),ke=te.S;if(ke!==null&&ke(le,we),we!==null&&typeof we=="object"&&typeof we.then=="function"){var Ue=p9(we,b);Bd(l,u,Ue,Qs(l))}else Bd(l,u,b,Qs(l))}catch(Ve){Bd(l,u,{then:function(){},status:"rejected",reason:Ve},Qs())}finally{Y.p=C,G!==null&&le.types!==null&&(G.types=le.types),te.T=G}}function b9(){}function rv(l,u,m,b){if(l.tag!==5)throw Error(n(476));var T=bk(l).queue;vk(l,T,u,ve,m===null?b9:function(){return wk(l),m(b)})}function bk(l){var u=l.memoizedState;if(u!==null)return u;u={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ro,lastRenderedState:ve},next:null};var m={};return u.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ro,lastRenderedState:m},next:null},l.memoizedState=u,l=l.alternate,l!==null&&(l.memoizedState=u),u}function wk(l){var u=bk(l);u.next===null&&(u=l.alternate.memoizedState),Bd(l,u.next.queue,{},Qs())}function nv(){return Un(rh)}function _k(){return Gr().memoizedState}function Ek(){return Gr().memoizedState}function w9(l){for(var u=l.return;u!==null;){switch(u.tag){case 24:case 3:var m=Qs();l=Qo(m);var b=el(u,l,m);b!==null&&(Is(b,u,m),Id(b,u,m)),u={cache:Oy()},l.payload=u;return}u=u.return}}function _9(l,u,m){var b=Qs();m={lane:b,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Xp(l)?Nk(u,m):(m=wy(l,u,m,b),m!==null&&(Is(m,l,b),Tk(m,u,b)))}function Sk(l,u,m){var b=Qs();Bd(l,u,m,b)}function Bd(l,u,m,b){var T={lane:b,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(Xp(l))Nk(u,T);else{var C=l.alternate;if(l.lanes===0&&(C===null||C.lanes===0)&&(C=u.lastRenderedReducer,C!==null))try{var G=u.lastRenderedState,le=C(G,m);if(T.hasEagerState=!0,T.eagerState=le,Gs(le,G))return Cp(l,u,T,0),mr===null&&Ap(),!1}catch{}finally{}if(m=wy(l,u,T,b),m!==null)return Is(m,l,b),Tk(m,u,b),!0}return!1}function sv(l,u,m,b){if(b={lane:2,revertLane:Fv(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},Xp(l)){if(u)throw Error(n(479))}else u=wy(l,m,b,2),u!==null&&Is(u,l,2)}function Xp(l){var u=l.alternate;return l===kt||u!==null&&u===kt}function Nk(l,u){Lu=Hp=!0;var m=l.pending;m===null?u.next=u:(u.next=m.next,m.next=u),l.pending=u}function Tk(l,u,m){if((m&4194048)!==0){var b=u.lanes;b&=l.pendingLanes,m|=b,u.lanes=m,An(l,m)}}var Ud={readContext:Un,use:Wp,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useLayoutEffect:Pr,useInsertionEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useSyncExternalStore:Pr,useId:Pr,useHostTransitionStatus:Pr,useFormState:Pr,useActionState:Pr,useOptimistic:Pr,useMemoCache:Pr,useCacheRefresh:Pr};Ud.useEffectEvent=Pr;var kk={readContext:Un,use:Wp,useCallback:function(l,u){return ys().memoizedState=[l,u===void 0?null:u],l},useContext:Un,useEffect:uk,useImperativeHandle:function(l,u,m){m=m!=null?m.concat([l]):null,Gp(4194308,4,pk.bind(null,u,l),m)},useLayoutEffect:function(l,u){return Gp(4194308,4,l,u)},useInsertionEffect:function(l,u){Gp(4,2,l,u)},useMemo:function(l,u){var m=ys();u=u===void 0?null:u;var b=l();if(hc){Tn(!0);try{l()}finally{Tn(!1)}}return m.memoizedState=[b,u],b},useReducer:function(l,u,m){var b=ys();if(m!==void 0){var T=m(u);if(hc){Tn(!0);try{m(u)}finally{Tn(!1)}}}else T=u;return b.memoizedState=b.baseState=T,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:T},b.queue=l,l=l.dispatch=_9.bind(null,kt,l),[b.memoizedState,l]},useRef:function(l){var u=ys();return l={current:l},u.memoizedState=l},useState:function(l){l=Jy(l);var u=l.queue,m=Sk.bind(null,kt,u);return u.dispatch=m,[l.memoizedState,m]},useDebugValue:ev,useDeferredValue:function(l,u){var m=ys();return tv(m,l,u)},useTransition:function(){var l=Jy(!1);return l=vk.bind(null,kt,l.queue,!0,!1),ys().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,u,m){var b=kt,T=ys();if(qt){if(m===void 0)throw Error(n(407));m=m()}else{if(m=u(),mr===null)throw Error(n(349));(Ht&127)!==0||KT(b,u,m)}T.memoizedState=m;var C={value:m,getSnapshot:u};return T.queue=C,uk(YT.bind(null,b,C,l),[l]),b.flags|=2048,Uu(9,{destroy:void 0},XT.bind(null,b,C,m,u),null),m},useId:function(){var l=ys(),u=mr.identifierPrefix;if(qt){var m=vi,b=yi;m=(b&~(1<<32-lr(b)-1)).toString(32)+m,u="_"+u+"R_"+m,m=Vp++,0<m&&(u+="H"+m.toString(32)),u+="_"}else m=m9++,u="_"+u+"r_"+m.toString(32)+"_";return l.memoizedState=u},useHostTransitionStatus:nv,useFormState:ak,useActionState:ak,useOptimistic:function(l){var u=ys();u.memoizedState=u.baseState=l;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=m,u=sv.bind(null,kt,!0,m),m.dispatch=u,[l,u]},useMemoCache:Ky,useCacheRefresh:function(){return ys().memoizedState=w9.bind(null,kt)},useEffectEvent:function(l){var u=ys(),m={impl:l};return u.memoizedState=m,function(){if((Jt&2)!==0)throw Error(n(440));return m.impl.apply(void 0,arguments)}}},av={readContext:Un,use:Wp,useCallback:xk,useContext:Un,useEffect:Qy,useImperativeHandle:mk,useInsertionEffect:dk,useLayoutEffect:hk,useMemo:gk,useReducer:$p,useRef:ck,useState:function(){return $p(ro)},useDebugValue:ev,useDeferredValue:function(l,u){var m=Gr();return yk(m,cr.memoizedState,l,u)},useTransition:function(){var l=$p(ro)[0],u=Gr().memoizedState;return[typeof l=="boolean"?l:Ld(l),u]},useSyncExternalStore:GT,useId:_k,useHostTransitionStatus:nv,useFormState:ik,useActionState:ik,useOptimistic:function(l,u){var m=Gr();return QT(m,cr,l,u)},useMemoCache:Ky,useCacheRefresh:Ek};av.useEffectEvent=fk;var Ak={readContext:Un,use:Wp,useCallback:xk,useContext:Un,useEffect:Qy,useImperativeHandle:mk,useInsertionEffect:dk,useLayoutEffect:hk,useMemo:gk,useReducer:Yy,useRef:ck,useState:function(){return Yy(ro)},useDebugValue:ev,useDeferredValue:function(l,u){var m=Gr();return cr===null?tv(m,l,u):yk(m,cr.memoizedState,l,u)},useTransition:function(){var l=Yy(ro)[0],u=Gr().memoizedState;return[typeof l=="boolean"?l:Ld(l),u]},useSyncExternalStore:GT,useId:_k,useHostTransitionStatus:nv,useFormState:lk,useActionState:lk,useOptimistic:function(l,u){var m=Gr();return cr!==null?QT(m,cr,l,u):(m.baseState=l,[l,m.queue.dispatch])},useMemoCache:Ky,useCacheRefresh:Ek};Ak.useEffectEvent=fk;function iv(l,u,m,b){u=l.memoizedState,m=m(b,u),m=m==null?u:p({},u,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var ov={enqueueSetState:function(l,u,m){l=l._reactInternals;var b=Qs(),T=Qo(b);T.payload=u,m!=null&&(T.callback=m),u=el(l,T,b),u!==null&&(Is(u,l,b),Id(u,l,b))},enqueueReplaceState:function(l,u,m){l=l._reactInternals;var b=Qs(),T=Qo(b);T.tag=1,T.payload=u,m!=null&&(T.callback=m),u=el(l,T,b),u!==null&&(Is(u,l,b),Id(u,l,b))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var m=Qs(),b=Qo(m);b.tag=2,u!=null&&(b.callback=u),u=el(l,b,m),u!==null&&(Is(u,l,m),Id(u,l,m))}};function Ck(l,u,m,b,T,C,G){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(b,C,G):u.prototype&&u.prototype.isPureReactComponent?!Td(m,b)||!Td(T,C):!0}function Rk(l,u,m,b){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(m,b),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(m,b),u.state!==l&&ov.enqueueReplaceState(u,u.state,null)}function pc(l,u){var m=u;if("ref"in u){m={};for(var b in u)b!=="ref"&&(m[b]=u[b])}if(l=l.defaultProps){m===u&&(m=p({},m));for(var T in l)m[T]===void 0&&(m[T]=l[T])}return m}function jk(l){kp(l)}function Ok(l){console.error(l)}function Dk(l){kp(l)}function Yp(l,u){try{var m=l.onUncaughtError;m(u.value,{componentStack:u.stack})}catch(b){setTimeout(function(){throw b})}}function Ik(l,u,m){try{var b=l.onCaughtError;b(m.value,{componentStack:m.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(T){setTimeout(function(){throw T})}}function lv(l,u,m){return m=Qo(m),m.tag=3,m.payload={element:null},m.callback=function(){Yp(l,u)},m}function Mk(l){return l=Qo(l),l.tag=3,l}function Fk(l,u,m,b){var T=m.type.getDerivedStateFromError;if(typeof T=="function"){var C=b.value;l.payload=function(){return T(C)},l.callback=function(){Ik(u,m,b)}}var G=m.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(l.callback=function(){Ik(u,m,b),typeof T!="function"&&(il===null?il=new Set([this]):il.add(this));var le=b.stack;this.componentDidCatch(b.value,{componentStack:le!==null?le:""})})}function E9(l,u,m,b,T){if(m.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(u=m.alternate,u!==null&&Ou(u,m,T,!0),m=Xs.current,m!==null){switch(m.tag){case 31:case 13:return wa===null?lm():m.alternate===null&&Lr===0&&(Lr=3),m.flags&=-257,m.flags|=65536,m.lanes=T,b===Pp?m.flags|=16384:(u=m.updateQueue,u===null?m.updateQueue=new Set([b]):u.add(b),Dv(l,b,T)),!1;case 22:return m.flags|=65536,b===Pp?m.flags|=16384:(u=m.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([b])},m.updateQueue=u):(m=u.retryQueue,m===null?u.retryQueue=new Set([b]):m.add(b)),Dv(l,b,T)),!1}throw Error(n(435,m.tag))}return Dv(l,b,T),lm(),!1}if(qt)return u=Xs.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=T,b!==ky&&(l=Error(n(422),{cause:b}),Cd(ga(l,m)))):(b!==ky&&(u=Error(n(423),{cause:b}),Cd(ga(u,m))),l=l.current.alternate,l.flags|=65536,T&=-T,l.lanes|=T,b=ga(b,m),T=lv(l.stateNode,b,T),Ly(l,T),Lr!==4&&(Lr=2)),!1;var C=Error(n(520),{cause:b});if(C=ga(C,m),Kd===null?Kd=[C]:Kd.push(C),Lr!==4&&(Lr=2),u===null)return!0;b=ga(b,m),m=u;do{switch(m.tag){case 3:return m.flags|=65536,l=T&-T,m.lanes|=l,l=lv(m.stateNode,b,l),Ly(m,l),!1;case 1:if(u=m.type,C=m.stateNode,(m.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(il===null||!il.has(C))))return m.flags|=65536,T&=-T,m.lanes|=T,T=Mk(T),Fk(T,l,m,b),Ly(m,T),!1}m=m.return}while(m!==null);return!1}var cv=Error(n(461)),ln=!1;function zn(l,u,m,b){u.child=l===null?UT(u,null,m,b):dc(u,l.child,m,b)}function Pk(l,u,m,b,T){m=m.render;var C=u.ref;if("ref"in b){var G={};for(var le in b)le!=="ref"&&(G[le]=b[le])}else G=b;return lc(u),b=qy(l,u,m,G,C,T),le=Wy(),l!==null&&!ln?($y(l,u,T),no(l,u,T)):(qt&&le&&Ny(u),u.flags|=1,zn(l,u,b,T),u.child)}function Lk(l,u,m,b,T){if(l===null){var C=m.type;return typeof C=="function"&&!_y(C)&&C.defaultProps===void 0&&m.compare===null?(u.tag=15,u.type=C,Bk(l,u,C,b,T)):(l=jp(m.type,null,b,u,u.mode,T),l.ref=u.ref,l.return=u,u.child=l)}if(C=l.child,!gv(l,T)){var G=C.memoizedProps;if(m=m.compare,m=m!==null?m:Td,m(G,b)&&l.ref===u.ref)return no(l,u,T)}return u.flags|=1,l=Ji(C,b),l.ref=u.ref,l.return=u,u.child=l}function Bk(l,u,m,b,T){if(l!==null){var C=l.memoizedProps;if(Td(C,b)&&l.ref===u.ref)if(ln=!1,u.pendingProps=b=C,gv(l,T))(l.flags&131072)!==0&&(ln=!0);else return u.lanes=l.lanes,no(l,u,T)}return uv(l,u,m,b,T)}function Uk(l,u,m,b){var T=b.children,C=l!==null?l.memoizedState:null;if(l===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((u.flags&128)!==0){if(C=C!==null?C.baseLanes|m:m,l!==null){for(b=u.child=l.child,T=0;b!==null;)T=T|b.lanes|b.childLanes,b=b.sibling;b=T&~C}else b=0,u.child=null;return zk(l,u,C,m,b)}if((m&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},l!==null&&Mp(u,C!==null?C.cachePool:null),C!==null?VT(u,C):Uy(),qT(u);else return b=u.lanes=536870912,zk(l,u,C!==null?C.baseLanes|m:m,m,b)}else C!==null?(Mp(u,C.cachePool),VT(u,C),rl(),u.memoizedState=null):(l!==null&&Mp(u,null),Uy(),rl());return zn(l,u,T,m),u.child}function zd(l,u){return l!==null&&l.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function zk(l,u,m,b,T){var C=Iy();return C=C===null?null:{parent:an._currentValue,pool:C},u.memoizedState={baseLanes:m,cachePool:C},l!==null&&Mp(u,null),Uy(),qT(u),l!==null&&Ou(l,u,b,!0),u.childLanes=T,null}function Jp(l,u){return u=Qp({mode:u.mode,children:u.children},l.mode),u.ref=l.ref,l.child=u,u.return=l,u}function Hk(l,u,m){return dc(u,l.child,null,m),l=Jp(u,u.pendingProps),l.flags|=2,Ys(u),u.memoizedState=null,l}function S9(l,u,m){var b=u.pendingProps,T=(u.flags&128)!==0;if(u.flags&=-129,l===null){if(qt){if(b.mode==="hidden")return l=Jp(u,b),u.lanes=536870912,zd(null,l);if(Hy(u),(l=wr)?(l=eC(l,ba),l=l!==null&&l.data==="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:Ko!==null?{id:yi,overflow:vi}:null,retryLane:536870912,hydrationErrors:null},m=NT(l),m.return=u,u.child=m,Bn=u,wr=null)):l=null,l===null)throw Yo(u);return u.lanes=536870912,null}return Jp(u,b)}var C=l.memoizedState;if(C!==null){var G=C.dehydrated;if(Hy(u),T)if(u.flags&256)u.flags&=-257,u=Hk(l,u,m);else if(u.memoizedState!==null)u.child=l.child,u.flags|=128,u=null;else throw Error(n(558));else if(ln||Ou(l,u,m,!1),T=(m&l.childLanes)!==0,ln||T){if(b=mr,b!==null&&(G=es(b,m),G!==0&&G!==C.retryLane))throw C.retryLane=G,sc(l,G),Is(b,l,G),cv;lm(),u=Hk(l,u,m)}else l=C.treeContext,wr=_a(G.nextSibling),Bn=u,qt=!0,Xo=null,ba=!1,l!==null&&AT(u,l),u=Jp(u,b),u.flags|=4096;return u}return l=Ji(l.child,{mode:b.mode,children:b.children}),l.ref=u.ref,u.child=l,l.return=u,l}function Zp(l,u){var m=u.ref;if(m===null)l!==null&&l.ref!==null&&(u.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(n(284));(l===null||l.ref!==m)&&(u.flags|=4194816)}}function uv(l,u,m,b,T){return lc(u),m=qy(l,u,m,b,void 0,T),b=Wy(),l!==null&&!ln?($y(l,u,T),no(l,u,T)):(qt&&b&&Ny(u),u.flags|=1,zn(l,u,m,T),u.child)}function Vk(l,u,m,b,T,C){return lc(u),u.updateQueue=null,m=$T(u,b,m,T),WT(l),b=Wy(),l!==null&&!ln?($y(l,u,C),no(l,u,C)):(qt&&b&&Ny(u),u.flags|=1,zn(l,u,m,C),u.child)}function qk(l,u,m,b,T){if(lc(u),u.stateNode===null){var C=Au,G=m.contextType;typeof G=="object"&&G!==null&&(C=Un(G)),C=new m(b,C),u.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=ov,u.stateNode=C,C._reactInternals=u,C=u.stateNode,C.props=b,C.state=u.memoizedState,C.refs={},Fy(u),G=m.contextType,C.context=typeof G=="object"&&G!==null?Un(G):Au,C.state=u.memoizedState,G=m.getDerivedStateFromProps,typeof G=="function"&&(iv(u,m,G,b),C.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(G=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),G!==C.state&&ov.enqueueReplaceState(C,C.state,null),Fd(u,b,C,T),Md(),C.state=u.memoizedState),typeof C.componentDidMount=="function"&&(u.flags|=4194308),b=!0}else if(l===null){C=u.stateNode;var le=u.memoizedProps,we=pc(m,le);C.props=we;var ke=C.context,Ue=m.contextType;G=Au,typeof Ue=="object"&&Ue!==null&&(G=Un(Ue));var Ve=m.getDerivedStateFromProps;Ue=typeof Ve=="function"||typeof C.getSnapshotBeforeUpdate=="function",le=u.pendingProps!==le,Ue||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(le||ke!==G)&&Rk(u,C,b,G),Zo=!1;var je=u.memoizedState;C.state=je,Fd(u,b,C,T),Md(),ke=u.memoizedState,le||je!==ke||Zo?(typeof Ve=="function"&&(iv(u,m,Ve,b),ke=u.memoizedState),(we=Zo||Ck(u,m,we,b,je,ke,G))?(Ue||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(u.flags|=4194308)):(typeof C.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=b,u.memoizedState=ke),C.props=b,C.state=ke,C.context=G,b=we):(typeof C.componentDidMount=="function"&&(u.flags|=4194308),b=!1)}else{C=u.stateNode,Py(l,u),G=u.memoizedProps,Ue=pc(m,G),C.props=Ue,Ve=u.pendingProps,je=C.context,ke=m.contextType,we=Au,typeof ke=="object"&&ke!==null&&(we=Un(ke)),le=m.getDerivedStateFromProps,(ke=typeof le=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(G!==Ve||je!==we)&&Rk(u,C,b,we),Zo=!1,je=u.memoizedState,C.state=je,Fd(u,b,C,T),Md();var Ie=u.memoizedState;G!==Ve||je!==Ie||Zo||l!==null&&l.dependencies!==null&&Dp(l.dependencies)?(typeof le=="function"&&(iv(u,m,le,b),Ie=u.memoizedState),(Ue=Zo||Ck(u,m,Ue,b,je,Ie,we)||l!==null&&l.dependencies!==null&&Dp(l.dependencies))?(ke||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(b,Ie,we),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(b,Ie,we)),typeof C.componentDidUpdate=="function"&&(u.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof C.componentDidUpdate!="function"||G===l.memoizedProps&&je===l.memoizedState||(u.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&je===l.memoizedState||(u.flags|=1024),u.memoizedProps=b,u.memoizedState=Ie),C.props=b,C.state=Ie,C.context=we,b=Ue):(typeof C.componentDidUpdate!="function"||G===l.memoizedProps&&je===l.memoizedState||(u.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||G===l.memoizedProps&&je===l.memoizedState||(u.flags|=1024),b=!1)}return C=b,Zp(l,u),b=(u.flags&128)!==0,C||b?(C=u.stateNode,m=b&&typeof m.getDerivedStateFromError!="function"?null:C.render(),u.flags|=1,l!==null&&b?(u.child=dc(u,l.child,null,T),u.child=dc(u,null,m,T)):zn(l,u,m,T),u.memoizedState=C.state,l=u.child):l=no(l,u,T),l}function Wk(l,u,m,b){return ic(),u.flags|=256,zn(l,u,m,b),u.child}var fv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function dv(l){return{baseLanes:l,cachePool:IT()}}function hv(l,u,m){return l=l!==null?l.childLanes&~m:0,u&&(l|=Zs),l}function $k(l,u,m){var b=u.pendingProps,T=!1,C=(u.flags&128)!==0,G;if((G=C)||(G=l!==null&&l.memoizedState===null?!1:($r.current&2)!==0),G&&(T=!0,u.flags&=-129),G=(u.flags&32)!==0,u.flags&=-33,l===null){if(qt){if(T?tl(u):rl(),(l=wr)?(l=eC(l,ba),l=l!==null&&l.data!=="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:Ko!==null?{id:yi,overflow:vi}:null,retryLane:536870912,hydrationErrors:null},m=NT(l),m.return=u,u.child=m,Bn=u,wr=null)):l=null,l===null)throw Yo(u);return Xv(l)?u.lanes=32:u.lanes=536870912,null}var le=b.children;return b=b.fallback,T?(rl(),T=u.mode,le=Qp({mode:"hidden",children:le},T),b=ac(b,T,m,null),le.return=u,b.return=u,le.sibling=b,u.child=le,b=u.child,b.memoizedState=dv(m),b.childLanes=hv(l,G,m),u.memoizedState=fv,zd(null,b)):(tl(u),pv(u,le))}var we=l.memoizedState;if(we!==null&&(le=we.dehydrated,le!==null)){if(C)u.flags&256?(tl(u),u.flags&=-257,u=mv(l,u,m)):u.memoizedState!==null?(rl(),u.child=l.child,u.flags|=128,u=null):(rl(),le=b.fallback,T=u.mode,b=Qp({mode:"visible",children:b.children},T),le=ac(le,T,m,null),le.flags|=2,b.return=u,le.return=u,b.sibling=le,u.child=b,dc(u,l.child,null,m),b=u.child,b.memoizedState=dv(m),b.childLanes=hv(l,G,m),u.memoizedState=fv,u=zd(null,b));else if(tl(u),Xv(le)){if(G=le.nextSibling&&le.nextSibling.dataset,G)var ke=G.dgst;G=ke,b=Error(n(419)),b.stack="",b.digest=G,Cd({value:b,source:null,stack:null}),u=mv(l,u,m)}else if(ln||Ou(l,u,m,!1),G=(m&l.childLanes)!==0,ln||G){if(G=mr,G!==null&&(b=es(G,m),b!==0&&b!==we.retryLane))throw we.retryLane=b,sc(l,b),Is(G,l,b),cv;Kv(le)||lm(),u=mv(l,u,m)}else Kv(le)?(u.flags|=192,u.child=l.child,u=null):(l=we.treeContext,wr=_a(le.nextSibling),Bn=u,qt=!0,Xo=null,ba=!1,l!==null&&AT(u,l),u=pv(u,b.children),u.flags|=4096);return u}return T?(rl(),le=b.fallback,T=u.mode,we=l.child,ke=we.sibling,b=Ji(we,{mode:"hidden",children:b.children}),b.subtreeFlags=we.subtreeFlags&65011712,ke!==null?le=Ji(ke,le):(le=ac(le,T,m,null),le.flags|=2),le.return=u,b.return=u,b.sibling=le,u.child=b,zd(null,b),b=u.child,le=l.child.memoizedState,le===null?le=dv(m):(T=le.cachePool,T!==null?(we=an._currentValue,T=T.parent!==we?{parent:we,pool:we}:T):T=IT(),le={baseLanes:le.baseLanes|m,cachePool:T}),b.memoizedState=le,b.childLanes=hv(l,G,m),u.memoizedState=fv,zd(l.child,b)):(tl(u),m=l.child,l=m.sibling,m=Ji(m,{mode:"visible",children:b.children}),m.return=u,m.sibling=null,l!==null&&(G=u.deletions,G===null?(u.deletions=[l],u.flags|=16):G.push(l)),u.child=m,u.memoizedState=null,m)}function pv(l,u){return u=Qp({mode:"visible",children:u},l.mode),u.return=l,l.child=u}function Qp(l,u){return l=Ks(22,l,null,u),l.lanes=0,l}function mv(l,u,m){return dc(u,l.child,null,m),l=pv(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function Gk(l,u,m){l.lanes|=u;var b=l.alternate;b!==null&&(b.lanes|=u),Ry(l.return,u,m)}function xv(l,u,m,b,T,C){var G=l.memoizedState;G===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:T,treeForkCount:C}:(G.isBackwards=u,G.rendering=null,G.renderingStartTime=0,G.last=b,G.tail=m,G.tailMode=T,G.treeForkCount=C)}function Kk(l,u,m){var b=u.pendingProps,T=b.revealOrder,C=b.tail;b=b.children;var G=$r.current,le=(G&2)!==0;if(le?(G=G&1|2,u.flags|=128):G&=1,q($r,G),zn(l,u,b,m),b=qt?Ad:0,!le&&l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Gk(l,m,u);else if(l.tag===19)Gk(l,m,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(T){case"forwards":for(m=u.child,T=null;m!==null;)l=m.alternate,l!==null&&zp(l)===null&&(T=m),m=m.sibling;m=T,m===null?(T=u.child,u.child=null):(T=m.sibling,m.sibling=null),xv(u,!1,T,m,C,b);break;case"backwards":case"unstable_legacy-backwards":for(m=null,T=u.child,u.child=null;T!==null;){if(l=T.alternate,l!==null&&zp(l)===null){u.child=T;break}l=T.sibling,T.sibling=m,m=T,T=l}xv(u,!0,m,null,C,b);break;case"together":xv(u,!1,null,null,void 0,b);break;default:u.memoizedState=null}return u.child}function no(l,u,m){if(l!==null&&(u.dependencies=l.dependencies),al|=u.lanes,(m&u.childLanes)===0)if(l!==null){if(Ou(l,u,m,!1),(m&u.childLanes)===0)return null}else return null;if(l!==null&&u.child!==l.child)throw Error(n(153));if(u.child!==null){for(l=u.child,m=Ji(l,l.pendingProps),u.child=m,m.return=u;l.sibling!==null;)l=l.sibling,m=m.sibling=Ji(l,l.pendingProps),m.return=u;m.sibling=null}return u.child}function gv(l,u){return(l.lanes&u)!==0?!0:(l=l.dependencies,!!(l!==null&&Dp(l)))}function N9(l,u,m){switch(u.tag){case 3:L(u,u.stateNode.containerInfo),Jo(u,an,l.memoizedState.cache),ic();break;case 27:case 5:Q(u);break;case 4:L(u,u.stateNode.containerInfo);break;case 10:Jo(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,Hy(u),null;break;case 13:var b=u.memoizedState;if(b!==null)return b.dehydrated!==null?(tl(u),u.flags|=128,null):(m&u.child.childLanes)!==0?$k(l,u,m):(tl(u),l=no(l,u,m),l!==null?l.sibling:null);tl(u);break;case 19:var T=(l.flags&128)!==0;if(b=(m&u.childLanes)!==0,b||(Ou(l,u,m,!1),b=(m&u.childLanes)!==0),T){if(b)return Kk(l,u,m);u.flags|=128}if(T=u.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),q($r,$r.current),b)break;return null;case 22:return u.lanes=0,Uk(l,u,m,u.pendingProps);case 24:Jo(u,an,l.memoizedState.cache)}return no(l,u,m)}function Xk(l,u,m){if(l!==null)if(l.memoizedProps!==u.pendingProps)ln=!0;else{if(!gv(l,m)&&(u.flags&128)===0)return ln=!1,N9(l,u,m);ln=(l.flags&131072)!==0}else ln=!1,qt&&(u.flags&1048576)!==0&&kT(u,Ad,u.index);switch(u.lanes=0,u.tag){case 16:e:{var b=u.pendingProps;if(l=uc(u.elementType),u.type=l,typeof l=="function")_y(l)?(b=pc(l,b),u.tag=1,u=qk(null,u,l,b,m)):(u.tag=0,u=uv(null,u,l,b,m));else{if(l!=null){var T=l.$$typeof;if(T===N){u.tag=11,u=Pk(null,u,l,b,m);break e}else if(T===R){u.tag=14,u=Lk(null,u,l,b,m);break e}}throw u=P(l)||l,Error(n(306,u,""))}}return u;case 0:return uv(l,u,u.type,u.pendingProps,m);case 1:return b=u.type,T=pc(b,u.pendingProps),qk(l,u,b,T,m);case 3:e:{if(L(u,u.stateNode.containerInfo),l===null)throw Error(n(387));b=u.pendingProps;var C=u.memoizedState;T=C.element,Py(l,u),Fd(u,b,null,m);var G=u.memoizedState;if(b=G.cache,Jo(u,an,b),b!==C.cache&&jy(u,[an],m,!0),Md(),b=G.element,C.isDehydrated)if(C={element:b,isDehydrated:!1,cache:G.cache},u.updateQueue.baseState=C,u.memoizedState=C,u.flags&256){u=Wk(l,u,b,m);break e}else if(b!==T){T=ga(Error(n(424)),u),Cd(T),u=Wk(l,u,b,m);break e}else{switch(l=u.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(wr=_a(l.firstChild),Bn=u,qt=!0,Xo=null,ba=!0,m=UT(u,null,b,m),u.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(ic(),b===T){u=no(l,u,m);break e}zn(l,u,b,m)}u=u.child}return u;case 26:return Zp(l,u),l===null?(m=iC(u.type,null,u.pendingProps,null))?u.memoizedState=m:qt||(m=u.type,l=u.pendingProps,b=mm(re.current).createElement(m),b[de]=u,b[me]=l,Hn(b,m,l),ct(b),u.stateNode=b):u.memoizedState=iC(u.type,l.memoizedProps,u.pendingProps,l.memoizedState),null;case 27:return Q(u),l===null&&qt&&(b=u.stateNode=nC(u.type,u.pendingProps,re.current),Bn=u,ba=!0,T=wr,ul(u.type)?(Yv=T,wr=_a(b.firstChild)):wr=T),zn(l,u,u.pendingProps.children,m),Zp(l,u),l===null&&(u.flags|=4194304),u.child;case 5:return l===null&&qt&&((T=b=wr)&&(b=t7(b,u.type,u.pendingProps,ba),b!==null?(u.stateNode=b,Bn=u,wr=_a(b.firstChild),ba=!1,T=!0):T=!1),T||Yo(u)),Q(u),T=u.type,C=u.pendingProps,G=l!==null?l.memoizedProps:null,b=C.children,Wv(T,C)?b=null:G!==null&&Wv(T,G)&&(u.flags|=32),u.memoizedState!==null&&(T=qy(l,u,x9,null,null,m),rh._currentValue=T),Zp(l,u),zn(l,u,b,m),u.child;case 6:return l===null&&qt&&((l=m=wr)&&(m=r7(m,u.pendingProps,ba),m!==null?(u.stateNode=m,Bn=u,wr=null,l=!0):l=!1),l||Yo(u)),null;case 13:return $k(l,u,m);case 4:return L(u,u.stateNode.containerInfo),b=u.pendingProps,l===null?u.child=dc(u,null,b,m):zn(l,u,b,m),u.child;case 11:return Pk(l,u,u.type,u.pendingProps,m);case 7:return zn(l,u,u.pendingProps,m),u.child;case 8:return zn(l,u,u.pendingProps.children,m),u.child;case 12:return zn(l,u,u.pendingProps.children,m),u.child;case 10:return b=u.pendingProps,Jo(u,u.type,b.value),zn(l,u,b.children,m),u.child;case 9:return T=u.type._context,b=u.pendingProps.children,lc(u),T=Un(T),b=b(T),u.flags|=1,zn(l,u,b,m),u.child;case 14:return Lk(l,u,u.type,u.pendingProps,m);case 15:return Bk(l,u,u.type,u.pendingProps,m);case 19:return Kk(l,u,m);case 31:return S9(l,u,m);case 22:return Uk(l,u,m,u.pendingProps);case 24:return lc(u),b=Un(an),l===null?(T=Iy(),T===null&&(T=mr,C=Oy(),T.pooledCache=C,C.refCount++,C!==null&&(T.pooledCacheLanes|=m),T=C),u.memoizedState={parent:b,cache:T},Fy(u),Jo(u,an,T)):((l.lanes&m)!==0&&(Py(l,u),Fd(u,null,null,m),Md()),T=l.memoizedState,C=u.memoizedState,T.parent!==b?(T={parent:b,cache:b},u.memoizedState=T,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=T),Jo(u,an,b)):(b=C.cache,Jo(u,an,b),b!==T.cache&&jy(u,[an],m,!0))),zn(l,u,u.pendingProps.children,m),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function so(l){l.flags|=4}function yv(l,u,m,b,T){if((u=(l.mode&32)!==0)&&(u=!1),u){if(l.flags|=16777216,(T&335544128)===T)if(l.stateNode.complete)l.flags|=8192;else if(_A())l.flags|=8192;else throw fc=Pp,My}else l.flags&=-16777217}function Yk(l,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!fC(u))if(_A())l.flags|=8192;else throw fc=Pp,My}function em(l,u){u!==null&&(l.flags|=4),l.flags&16384&&(u=l.tag!==22?kn():536870912,l.lanes|=u,qu|=u)}function Hd(l,u){if(!qt)switch(l.tailMode){case"hidden":u=l.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:b.sibling=null}}function _r(l){var u=l.alternate!==null&&l.alternate.child===l.child,m=0,b=0;if(u)for(var T=l.child;T!==null;)m|=T.lanes|T.childLanes,b|=T.subtreeFlags&65011712,b|=T.flags&65011712,T.return=l,T=T.sibling;else for(T=l.child;T!==null;)m|=T.lanes|T.childLanes,b|=T.subtreeFlags,b|=T.flags,T.return=l,T=T.sibling;return l.subtreeFlags|=b,l.childLanes=m,u}function T9(l,u,m){var b=u.pendingProps;switch(Ty(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _r(u),null;case 1:return _r(u),null;case 3:return m=u.stateNode,b=null,l!==null&&(b=l.memoizedState.cache),u.memoizedState.cache!==b&&(u.flags|=2048),eo(an),se(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(l===null||l.child===null)&&(ju(u)?so(u):l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Ay())),_r(u),null;case 26:var T=u.type,C=u.memoizedState;return l===null?(so(u),C!==null?(_r(u),Yk(u,C)):(_r(u),yv(u,T,null,b,m))):C?C!==l.memoizedState?(so(u),_r(u),Yk(u,C)):(_r(u),u.flags&=-16777217):(l=l.memoizedProps,l!==b&&so(u),_r(u),yv(u,T,l,b,m)),null;case 27:if(ee(u),m=re.current,T=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==b&&so(u);else{if(!b){if(u.stateNode===null)throw Error(n(166));return _r(u),null}l=W.current,ju(u)?CT(u):(l=nC(T,b,m),u.stateNode=l,so(u))}return _r(u),null;case 5:if(ee(u),T=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==b&&so(u);else{if(!b){if(u.stateNode===null)throw Error(n(166));return _r(u),null}if(C=W.current,ju(u))CT(u);else{var G=mm(re.current);switch(C){case 1:C=G.createElementNS("http://www.w3.org/2000/svg",T);break;case 2:C=G.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;default:switch(T){case"svg":C=G.createElementNS("http://www.w3.org/2000/svg",T);break;case"math":C=G.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;case"script":C=G.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof b.is=="string"?G.createElement("select",{is:b.is}):G.createElement("select"),b.multiple?C.multiple=!0:b.size&&(C.size=b.size);break;default:C=typeof b.is=="string"?G.createElement(T,{is:b.is}):G.createElement(T)}}C[de]=u,C[me]=b;e:for(G=u.child;G!==null;){if(G.tag===5||G.tag===6)C.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===u)break e;for(;G.sibling===null;){if(G.return===null||G.return===u)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}u.stateNode=C;e:switch(Hn(C,T,b),T){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}b&&so(u)}}return _r(u),yv(u,u.type,l===null?null:l.memoizedProps,u.pendingProps,m),null;case 6:if(l&&u.stateNode!=null)l.memoizedProps!==b&&so(u);else{if(typeof b!="string"&&u.stateNode===null)throw Error(n(166));if(l=re.current,ju(u)){if(l=u.stateNode,m=u.memoizedProps,b=null,T=Bn,T!==null)switch(T.tag){case 27:case 5:b=T.memoizedProps}l[de]=u,l=!!(l.nodeValue===m||b!==null&&b.suppressHydrationWarning===!0||$A(l.nodeValue,m)),l||Yo(u,!0)}else l=mm(l).createTextNode(b),l[de]=u,u.stateNode=l}return _r(u),null;case 31:if(m=u.memoizedState,l===null||l.memoizedState!==null){if(b=ju(u),m!==null){if(l===null){if(!b)throw Error(n(318));if(l=u.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(557));l[de]=u}else ic(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;_r(u),l=!1}else m=Ay(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=m),l=!0;if(!l)return u.flags&256?(Ys(u),u):(Ys(u),null);if((u.flags&128)!==0)throw Error(n(558))}return _r(u),null;case 13:if(b=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(T=ju(u),b!==null&&b.dehydrated!==null){if(l===null){if(!T)throw Error(n(318));if(T=u.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(n(317));T[de]=u}else ic(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;_r(u),T=!1}else T=Ay(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=T),T=!0;if(!T)return u.flags&256?(Ys(u),u):(Ys(u),null)}return Ys(u),(u.flags&128)!==0?(u.lanes=m,u):(m=b!==null,l=l!==null&&l.memoizedState!==null,m&&(b=u.child,T=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(T=b.alternate.memoizedState.cachePool.pool),C=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(C=b.memoizedState.cachePool.pool),C!==T&&(b.flags|=2048)),m!==l&&m&&(u.child.flags|=8192),em(u,u.updateQueue),_r(u),null);case 4:return se(),l===null&&Uv(u.stateNode.containerInfo),_r(u),null;case 10:return eo(u.type),_r(u),null;case 19:if(D($r),b=u.memoizedState,b===null)return _r(u),null;if(T=(u.flags&128)!==0,C=b.rendering,C===null)if(T)Hd(b,!1);else{if(Lr!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(C=zp(l),C!==null){for(u.flags|=128,Hd(b,!1),l=C.updateQueue,u.updateQueue=l,em(u,l),u.subtreeFlags=0,l=m,m=u.child;m!==null;)ST(m,l),m=m.sibling;return q($r,$r.current&1|2),qt&&Zi(u,b.treeForkCount),u.child}l=l.sibling}b.tail!==null&&De()>am&&(u.flags|=128,T=!0,Hd(b,!1),u.lanes=4194304)}else{if(!T)if(l=zp(C),l!==null){if(u.flags|=128,T=!0,l=l.updateQueue,u.updateQueue=l,em(u,l),Hd(b,!0),b.tail===null&&b.tailMode==="hidden"&&!C.alternate&&!qt)return _r(u),null}else 2*De()-b.renderingStartTime>am&&m!==536870912&&(u.flags|=128,T=!0,Hd(b,!1),u.lanes=4194304);b.isBackwards?(C.sibling=u.child,u.child=C):(l=b.last,l!==null?l.sibling=C:u.child=C,b.last=C)}return b.tail!==null?(l=b.tail,b.rendering=l,b.tail=l.sibling,b.renderingStartTime=De(),l.sibling=null,m=$r.current,q($r,T?m&1|2:m&1),qt&&Zi(u,b.treeForkCount),l):(_r(u),null);case 22:case 23:return Ys(u),zy(),b=u.memoizedState!==null,l!==null?l.memoizedState!==null!==b&&(u.flags|=8192):b&&(u.flags|=8192),b?(m&536870912)!==0&&(u.flags&128)===0&&(_r(u),u.subtreeFlags&6&&(u.flags|=8192)):_r(u),m=u.updateQueue,m!==null&&em(u,m.retryQueue),m=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),b=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),b!==m&&(u.flags|=2048),l!==null&&D(cc),null;case 24:return m=null,l!==null&&(m=l.memoizedState.cache),u.memoizedState.cache!==m&&(u.flags|=2048),eo(an),_r(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function k9(l,u){switch(Ty(u),u.tag){case 1:return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return eo(an),se(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 26:case 27:case 5:return ee(u),null;case 31:if(u.memoizedState!==null){if(Ys(u),u.alternate===null)throw Error(n(340));ic()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 13:if(Ys(u),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(n(340));ic()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return D($r),null;case 4:return se(),null;case 10:return eo(u.type),null;case 22:case 23:return Ys(u),zy(),l!==null&&D(cc),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 24:return eo(an),null;case 25:return null;default:return null}}function Jk(l,u){switch(Ty(u),u.tag){case 3:eo(an),se();break;case 26:case 27:case 5:ee(u);break;case 4:se();break;case 31:u.memoizedState!==null&&Ys(u);break;case 13:Ys(u);break;case 19:D($r);break;case 10:eo(u.type);break;case 22:case 23:Ys(u),zy(),l!==null&&D(cc);break;case 24:eo(an)}}function Vd(l,u){try{var m=u.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var T=b.next;m=T;do{if((m.tag&l)===l){b=void 0;var C=m.create,G=m.inst;b=C(),G.destroy=b}m=m.next}while(m!==T)}}catch(le){er(u,u.return,le)}}function nl(l,u,m){try{var b=u.updateQueue,T=b!==null?b.lastEffect:null;if(T!==null){var C=T.next;b=C;do{if((b.tag&l)===l){var G=b.inst,le=G.destroy;if(le!==void 0){G.destroy=void 0,T=u;var we=m,ke=le;try{ke()}catch(Ue){er(T,we,Ue)}}}b=b.next}while(b!==C)}}catch(Ue){er(u,u.return,Ue)}}function Zk(l){var u=l.updateQueue;if(u!==null){var m=l.stateNode;try{HT(u,m)}catch(b){er(l,l.return,b)}}}function Qk(l,u,m){m.props=pc(l.type,l.memoizedProps),m.state=l.memoizedState;try{m.componentWillUnmount()}catch(b){er(l,u,b)}}function qd(l,u){try{var m=l.ref;if(m!==null){switch(l.tag){case 26:case 27:case 5:var b=l.stateNode;break;case 30:b=l.stateNode;break;default:b=l.stateNode}typeof m=="function"?l.refCleanup=m(b):m.current=b}}catch(T){er(l,u,T)}}function bi(l,u){var m=l.ref,b=l.refCleanup;if(m!==null)if(typeof b=="function")try{b()}catch(T){er(l,u,T)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(T){er(l,u,T)}else m.current=null}function eA(l){var u=l.type,m=l.memoizedProps,b=l.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":m.autoFocus&&b.focus();break e;case"img":m.src?b.src=m.src:m.srcSet&&(b.srcset=m.srcSet)}}catch(T){er(l,l.return,T)}}function vv(l,u,m){try{var b=l.stateNode;X9(b,l.type,m,u),b[me]=u}catch(T){er(l,l.return,T)}}function tA(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&ul(l.type)||l.tag===4}function bv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||tA(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&ul(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function wv(l,u,m){var b=l.tag;if(b===5||b===6)l=l.stateNode,u?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(l,u):(u=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,u.appendChild(l),m=m._reactRootContainer,m!=null||u.onclick!==null||(u.onclick=Xi));else if(b!==4&&(b===27&&ul(l.type)&&(m=l.stateNode,u=null),l=l.child,l!==null))for(wv(l,u,m),l=l.sibling;l!==null;)wv(l,u,m),l=l.sibling}function tm(l,u,m){var b=l.tag;if(b===5||b===6)l=l.stateNode,u?m.insertBefore(l,u):m.appendChild(l);else if(b!==4&&(b===27&&ul(l.type)&&(m=l.stateNode),l=l.child,l!==null))for(tm(l,u,m),l=l.sibling;l!==null;)tm(l,u,m),l=l.sibling}function rA(l){var u=l.stateNode,m=l.memoizedProps;try{for(var b=l.type,T=u.attributes;T.length;)u.removeAttributeNode(T[0]);Hn(u,b,m),u[de]=l,u[me]=m}catch(C){er(l,l.return,C)}}var ao=!1,cn=!1,_v=!1,nA=typeof WeakSet=="function"?WeakSet:Set,Cn=null;function A9(l,u){if(l=l.containerInfo,Vv=_m,l=mT(l),my(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var T=b.anchorOffset,C=b.focusNode;b=b.focusOffset;try{m.nodeType,C.nodeType}catch{m=null;break e}var G=0,le=-1,we=-1,ke=0,Ue=0,Ve=l,je=null;t:for(;;){for(var Ie;Ve!==m||T!==0&&Ve.nodeType!==3||(le=G+T),Ve!==C||b!==0&&Ve.nodeType!==3||(we=G+b),Ve.nodeType===3&&(G+=Ve.nodeValue.length),(Ie=Ve.firstChild)!==null;)je=Ve,Ve=Ie;for(;;){if(Ve===l)break t;if(je===m&&++ke===T&&(le=G),je===C&&++Ue===b&&(we=G),(Ie=Ve.nextSibling)!==null)break;Ve=je,je=Ve.parentNode}Ve=Ie}m=le===-1||we===-1?null:{start:le,end:we}}else m=null}m=m||{start:0,end:0}}else m=null;for(qv={focusedElem:l,selectionRange:m},_m=!1,Cn=u;Cn!==null;)if(u=Cn,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,Cn=l;else for(;Cn!==null;){switch(u=Cn,C=u.alternate,l=u.flags,u.tag){case 0:if((l&4)!==0&&(l=u.updateQueue,l=l!==null?l.events:null,l!==null))for(m=0;m<l.length;m++)T=l[m],T.ref.impl=T.nextImpl;break;case 11:case 15:break;case 1:if((l&1024)!==0&&C!==null){l=void 0,m=u,T=C.memoizedProps,C=C.memoizedState,b=m.stateNode;try{var ot=pc(m.type,T);l=b.getSnapshotBeforeUpdate(ot,C),b.__reactInternalSnapshotBeforeUpdate=l}catch(gt){er(m,m.return,gt)}}break;case 3:if((l&1024)!==0){if(l=u.stateNode.containerInfo,m=l.nodeType,m===9)Gv(l);else if(m===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":Gv(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=u.sibling,l!==null){l.return=u.return,Cn=l;break}Cn=u.return}}function sA(l,u,m){var b=m.flags;switch(m.tag){case 0:case 11:case 15:oo(l,m),b&4&&Vd(5,m);break;case 1:if(oo(l,m),b&4)if(l=m.stateNode,u===null)try{l.componentDidMount()}catch(G){er(m,m.return,G)}else{var T=pc(m.type,u.memoizedProps);u=u.memoizedState;try{l.componentDidUpdate(T,u,l.__reactInternalSnapshotBeforeUpdate)}catch(G){er(m,m.return,G)}}b&64&&Zk(m),b&512&&qd(m,m.return);break;case 3:if(oo(l,m),b&64&&(l=m.updateQueue,l!==null)){if(u=null,m.child!==null)switch(m.child.tag){case 27:case 5:u=m.child.stateNode;break;case 1:u=m.child.stateNode}try{HT(l,u)}catch(G){er(m,m.return,G)}}break;case 27:u===null&&b&4&&rA(m);case 26:case 5:oo(l,m),u===null&&b&4&&eA(m),b&512&&qd(m,m.return);break;case 12:oo(l,m);break;case 31:oo(l,m),b&4&&oA(l,m);break;case 13:oo(l,m),b&4&&lA(l,m),b&64&&(l=m.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(m=P9.bind(null,m),n7(l,m))));break;case 22:if(b=m.memoizedState!==null||ao,!b){u=u!==null&&u.memoizedState!==null||cn,T=ao;var C=cn;ao=b,(cn=u)&&!C?lo(l,m,(m.subtreeFlags&8772)!==0):oo(l,m),ao=T,cn=C}break;case 30:break;default:oo(l,m)}}function aA(l){var u=l.alternate;u!==null&&(l.alternate=null,aA(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&Xe(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var Cr=null,Rs=!1;function io(l,u,m){for(m=m.child;m!==null;)iA(l,u,m),m=m.sibling}function iA(l,u,m){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(vt,m)}catch{}switch(m.tag){case 26:cn||bi(m,u),io(l,u,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:cn||bi(m,u);var b=Cr,T=Rs;ul(m.type)&&(Cr=m.stateNode,Rs=!1),io(l,u,m),Qd(m.stateNode),Cr=b,Rs=T;break;case 5:cn||bi(m,u);case 6:if(b=Cr,T=Rs,Cr=null,io(l,u,m),Cr=b,Rs=T,Cr!==null)if(Rs)try{(Cr.nodeType===9?Cr.body:Cr.nodeName==="HTML"?Cr.ownerDocument.body:Cr).removeChild(m.stateNode)}catch(C){er(m,u,C)}else try{Cr.removeChild(m.stateNode)}catch(C){er(m,u,C)}break;case 18:Cr!==null&&(Rs?(l=Cr,ZA(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,m.stateNode),Zu(l)):ZA(Cr,m.stateNode));break;case 4:b=Cr,T=Rs,Cr=m.stateNode.containerInfo,Rs=!0,io(l,u,m),Cr=b,Rs=T;break;case 0:case 11:case 14:case 15:nl(2,m,u),cn||nl(4,m,u),io(l,u,m);break;case 1:cn||(bi(m,u),b=m.stateNode,typeof b.componentWillUnmount=="function"&&Qk(m,u,b)),io(l,u,m);break;case 21:io(l,u,m);break;case 22:cn=(b=cn)||m.memoizedState!==null,io(l,u,m),cn=b;break;default:io(l,u,m)}}function oA(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{Zu(l)}catch(m){er(u,u.return,m)}}}function lA(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{Zu(l)}catch(m){er(u,u.return,m)}}function C9(l){switch(l.tag){case 31:case 13:case 19:var u=l.stateNode;return u===null&&(u=l.stateNode=new nA),u;case 22:return l=l.stateNode,u=l._retryCache,u===null&&(u=l._retryCache=new nA),u;default:throw Error(n(435,l.tag))}}function rm(l,u){var m=C9(l);u.forEach(function(b){if(!m.has(b)){m.add(b);var T=L9.bind(null,l,b);b.then(T,T)}})}function js(l,u){var m=u.deletions;if(m!==null)for(var b=0;b<m.length;b++){var T=m[b],C=l,G=u,le=G;e:for(;le!==null;){switch(le.tag){case 27:if(ul(le.type)){Cr=le.stateNode,Rs=!1;break e}break;case 5:Cr=le.stateNode,Rs=!1;break e;case 3:case 4:Cr=le.stateNode.containerInfo,Rs=!0;break e}le=le.return}if(Cr===null)throw Error(n(160));iA(C,G,T),Cr=null,Rs=!1,C=T.alternate,C!==null&&(C.return=null),T.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)cA(u,l),u=u.sibling}var Qa=null;function cA(l,u){var m=l.alternate,b=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:js(u,l),Os(l),b&4&&(nl(3,l,l.return),Vd(3,l),nl(5,l,l.return));break;case 1:js(u,l),Os(l),b&512&&(cn||m===null||bi(m,m.return)),b&64&&ao&&(l=l.updateQueue,l!==null&&(b=l.callbacks,b!==null&&(m=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=m===null?b:m.concat(b))));break;case 26:var T=Qa;if(js(u,l),Os(l),b&512&&(cn||m===null||bi(m,m.return)),b&4){var C=m!==null?m.memoizedState:null;if(b=l.memoizedState,m===null)if(b===null)if(l.stateNode===null){e:{b=l.type,m=l.memoizedProps,T=T.ownerDocument||T;t:switch(b){case"title":C=T.getElementsByTagName("title")[0],(!C||C[Oe]||C[de]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=T.createElement(b),T.head.insertBefore(C,T.querySelector("head > title"))),Hn(C,b,m),C[de]=l,ct(C),b=C;break e;case"link":var G=cC("link","href",T).get(b+(m.href||""));if(G){for(var le=0;le<G.length;le++)if(C=G[le],C.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&C.getAttribute("rel")===(m.rel==null?null:m.rel)&&C.getAttribute("title")===(m.title==null?null:m.title)&&C.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){G.splice(le,1);break t}}C=T.createElement(b),Hn(C,b,m),T.head.appendChild(C);break;case"meta":if(G=cC("meta","content",T).get(b+(m.content||""))){for(le=0;le<G.length;le++)if(C=G[le],C.getAttribute("content")===(m.content==null?null:""+m.content)&&C.getAttribute("name")===(m.name==null?null:m.name)&&C.getAttribute("property")===(m.property==null?null:m.property)&&C.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&C.getAttribute("charset")===(m.charSet==null?null:m.charSet)){G.splice(le,1);break t}}C=T.createElement(b),Hn(C,b,m),T.head.appendChild(C);break;default:throw Error(n(468,b))}C[de]=l,ct(C),b=C}l.stateNode=b}else uC(T,l.type,l.stateNode);else l.stateNode=lC(T,b,l.memoizedProps);else C!==b?(C===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):C.count--,b===null?uC(T,l.type,l.stateNode):lC(T,b,l.memoizedProps)):b===null&&l.stateNode!==null&&vv(l,l.memoizedProps,m.memoizedProps)}break;case 27:js(u,l),Os(l),b&512&&(cn||m===null||bi(m,m.return)),m!==null&&b&4&&vv(l,l.memoizedProps,m.memoizedProps);break;case 5:if(js(u,l),Os(l),b&512&&(cn||m===null||bi(m,m.return)),l.flags&32){T=l.stateNode;try{wu(T,"")}catch(ot){er(l,l.return,ot)}}b&4&&l.stateNode!=null&&(T=l.memoizedProps,vv(l,T,m!==null?m.memoizedProps:T)),b&1024&&(_v=!0);break;case 6:if(js(u,l),Os(l),b&4){if(l.stateNode===null)throw Error(n(162));b=l.memoizedProps,m=l.stateNode;try{m.nodeValue=b}catch(ot){er(l,l.return,ot)}}break;case 3:if(ym=null,T=Qa,Qa=xm(u.containerInfo),js(u,l),Qa=T,Os(l),b&4&&m!==null&&m.memoizedState.isDehydrated)try{Zu(u.containerInfo)}catch(ot){er(l,l.return,ot)}_v&&(_v=!1,uA(l));break;case 4:b=Qa,Qa=xm(l.stateNode.containerInfo),js(u,l),Os(l),Qa=b;break;case 12:js(u,l),Os(l);break;case 31:js(u,l),Os(l),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,rm(l,b)));break;case 13:js(u,l),Os(l),l.child.flags&8192&&l.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(sm=De()),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,rm(l,b)));break;case 22:T=l.memoizedState!==null;var we=m!==null&&m.memoizedState!==null,ke=ao,Ue=cn;if(ao=ke||T,cn=Ue||we,js(u,l),cn=Ue,ao=ke,Os(l),b&8192)e:for(u=l.stateNode,u._visibility=T?u._visibility&-2:u._visibility|1,T&&(m===null||we||ao||cn||mc(l)),m=null,u=l;;){if(u.tag===5||u.tag===26){if(m===null){we=m=u;try{if(C=we.stateNode,T)G=C.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{le=we.stateNode;var Ve=we.memoizedProps.style,je=Ve!=null&&Ve.hasOwnProperty("display")?Ve.display:null;le.style.display=je==null||typeof je=="boolean"?"":(""+je).trim()}}catch(ot){er(we,we.return,ot)}}}else if(u.tag===6){if(m===null){we=u;try{we.stateNode.nodeValue=T?"":we.memoizedProps}catch(ot){er(we,we.return,ot)}}}else if(u.tag===18){if(m===null){we=u;try{var Ie=we.stateNode;T?QA(Ie,!0):QA(we.stateNode,!1)}catch(ot){er(we,we.return,ot)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===l)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;m===u&&(m=null),u=u.return}m===u&&(m=null),u.sibling.return=u.return,u=u.sibling}b&4&&(b=l.updateQueue,b!==null&&(m=b.retryQueue,m!==null&&(b.retryQueue=null,rm(l,m))));break;case 19:js(u,l),Os(l),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,rm(l,b)));break;case 30:break;case 21:break;default:js(u,l),Os(l)}}function Os(l){var u=l.flags;if(u&2){try{for(var m,b=l.return;b!==null;){if(tA(b)){m=b;break}b=b.return}if(m==null)throw Error(n(160));switch(m.tag){case 27:var T=m.stateNode,C=bv(l);tm(l,C,T);break;case 5:var G=m.stateNode;m.flags&32&&(wu(G,""),m.flags&=-33);var le=bv(l);tm(l,le,G);break;case 3:case 4:var we=m.stateNode.containerInfo,ke=bv(l);wv(l,ke,we);break;default:throw Error(n(161))}}catch(Ue){er(l,l.return,Ue)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function uA(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var u=l;uA(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),l=l.sibling}}function oo(l,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)sA(l,u.alternate,u),u=u.sibling}function mc(l){for(l=l.child;l!==null;){var u=l;switch(u.tag){case 0:case 11:case 14:case 15:nl(4,u,u.return),mc(u);break;case 1:bi(u,u.return);var m=u.stateNode;typeof m.componentWillUnmount=="function"&&Qk(u,u.return,m),mc(u);break;case 27:Qd(u.stateNode);case 26:case 5:bi(u,u.return),mc(u);break;case 22:u.memoizedState===null&&mc(u);break;case 30:mc(u);break;default:mc(u)}l=l.sibling}}function lo(l,u,m){for(m=m&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var b=u.alternate,T=l,C=u,G=C.flags;switch(C.tag){case 0:case 11:case 15:lo(T,C,m),Vd(4,C);break;case 1:if(lo(T,C,m),b=C,T=b.stateNode,typeof T.componentDidMount=="function")try{T.componentDidMount()}catch(ke){er(b,b.return,ke)}if(b=C,T=b.updateQueue,T!==null){var le=b.stateNode;try{var we=T.shared.hiddenCallbacks;if(we!==null)for(T.shared.hiddenCallbacks=null,T=0;T<we.length;T++)zT(we[T],le)}catch(ke){er(b,b.return,ke)}}m&&G&64&&Zk(C),qd(C,C.return);break;case 27:rA(C);case 26:case 5:lo(T,C,m),m&&b===null&&G&4&&eA(C),qd(C,C.return);break;case 12:lo(T,C,m);break;case 31:lo(T,C,m),m&&G&4&&oA(T,C);break;case 13:lo(T,C,m),m&&G&4&&lA(T,C);break;case 22:C.memoizedState===null&&lo(T,C,m),qd(C,C.return);break;case 30:break;default:lo(T,C,m)}u=u.sibling}}function Ev(l,u){var m=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),l=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(l=u.memoizedState.cachePool.pool),l!==m&&(l!=null&&l.refCount++,m!=null&&Rd(m))}function Sv(l,u){l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&Rd(l))}function ei(l,u,m,b){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)fA(l,u,m,b),u=u.sibling}function fA(l,u,m,b){var T=u.flags;switch(u.tag){case 0:case 11:case 15:ei(l,u,m,b),T&2048&&Vd(9,u);break;case 1:ei(l,u,m,b);break;case 3:ei(l,u,m,b),T&2048&&(l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&Rd(l)));break;case 12:if(T&2048){ei(l,u,m,b),l=u.stateNode;try{var C=u.memoizedProps,G=C.id,le=C.onPostCommit;typeof le=="function"&&le(G,u.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(we){er(u,u.return,we)}}else ei(l,u,m,b);break;case 31:ei(l,u,m,b);break;case 13:ei(l,u,m,b);break;case 23:break;case 22:C=u.stateNode,G=u.alternate,u.memoizedState!==null?C._visibility&2?ei(l,u,m,b):Wd(l,u):C._visibility&2?ei(l,u,m,b):(C._visibility|=2,zu(l,u,m,b,(u.subtreeFlags&10256)!==0||!1)),T&2048&&Ev(G,u);break;case 24:ei(l,u,m,b),T&2048&&Sv(u.alternate,u);break;default:ei(l,u,m,b)}}function zu(l,u,m,b,T){for(T=T&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var C=l,G=u,le=m,we=b,ke=G.flags;switch(G.tag){case 0:case 11:case 15:zu(C,G,le,we,T),Vd(8,G);break;case 23:break;case 22:var Ue=G.stateNode;G.memoizedState!==null?Ue._visibility&2?zu(C,G,le,we,T):Wd(C,G):(Ue._visibility|=2,zu(C,G,le,we,T)),T&&ke&2048&&Ev(G.alternate,G);break;case 24:zu(C,G,le,we,T),T&&ke&2048&&Sv(G.alternate,G);break;default:zu(C,G,le,we,T)}u=u.sibling}}function Wd(l,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var m=l,b=u,T=b.flags;switch(b.tag){case 22:Wd(m,b),T&2048&&Ev(b.alternate,b);break;case 24:Wd(m,b),T&2048&&Sv(b.alternate,b);break;default:Wd(m,b)}u=u.sibling}}var $d=8192;function Hu(l,u,m){if(l.subtreeFlags&$d)for(l=l.child;l!==null;)dA(l,u,m),l=l.sibling}function dA(l,u,m){switch(l.tag){case 26:Hu(l,u,m),l.flags&$d&&l.memoizedState!==null&&m7(m,Qa,l.memoizedState,l.memoizedProps);break;case 5:Hu(l,u,m);break;case 3:case 4:var b=Qa;Qa=xm(l.stateNode.containerInfo),Hu(l,u,m),Qa=b;break;case 22:l.memoizedState===null&&(b=l.alternate,b!==null&&b.memoizedState!==null?(b=$d,$d=16777216,Hu(l,u,m),$d=b):Hu(l,u,m));break;default:Hu(l,u,m)}}function hA(l){var u=l.alternate;if(u!==null&&(l=u.child,l!==null)){u.child=null;do u=l.sibling,l.sibling=null,l=u;while(l!==null)}}function Gd(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var b=u[m];Cn=b,mA(b,l)}hA(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)pA(l),l=l.sibling}function pA(l){switch(l.tag){case 0:case 11:case 15:Gd(l),l.flags&2048&&nl(9,l,l.return);break;case 3:Gd(l);break;case 12:Gd(l);break;case 22:var u=l.stateNode;l.memoizedState!==null&&u._visibility&2&&(l.return===null||l.return.tag!==13)?(u._visibility&=-3,nm(l)):Gd(l);break;default:Gd(l)}}function nm(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var b=u[m];Cn=b,mA(b,l)}hA(l)}for(l=l.child;l!==null;){switch(u=l,u.tag){case 0:case 11:case 15:nl(8,u,u.return),nm(u);break;case 22:m=u.stateNode,m._visibility&2&&(m._visibility&=-3,nm(u));break;default:nm(u)}l=l.sibling}}function mA(l,u){for(;Cn!==null;){var m=Cn;switch(m.tag){case 0:case 11:case 15:nl(8,m,u);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var b=m.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:Rd(m.memoizedState.cache)}if(b=m.child,b!==null)b.return=m,Cn=b;else e:for(m=l;Cn!==null;){b=Cn;var T=b.sibling,C=b.return;if(aA(b),b===m){Cn=null;break e}if(T!==null){T.return=C,Cn=T;break e}Cn=C}}}var R9={getCacheForType:function(l){var u=Un(an),m=u.data.get(l);return m===void 0&&(m=l(),u.data.set(l,m)),m},cacheSignal:function(){return Un(an).controller.signal}},j9=typeof WeakMap=="function"?WeakMap:Map,Jt=0,mr=null,Bt=null,Ht=0,Qt=0,Js=null,sl=!1,Vu=!1,Nv=!1,co=0,Lr=0,al=0,xc=0,Tv=0,Zs=0,qu=0,Kd=null,Ds=null,kv=!1,sm=0,xA=0,am=1/0,im=null,il=null,vn=0,ol=null,Wu=null,uo=0,Av=0,Cv=null,gA=null,Xd=0,Rv=null;function Qs(){return(Jt&2)!==0&&Ht!==0?Ht&-Ht:te.T!==null?Fv():ae()}function yA(){if(Zs===0)if((Ht&536870912)===0||qt){var l=Ja;Ja<<=1,(Ja&3932160)===0&&(Ja=262144),Zs=l}else Zs=536870912;return l=Xs.current,l!==null&&(l.flags|=32),Zs}function Is(l,u,m){(l===mr&&(Qt===2||Qt===9)||l.cancelPendingCommit!==null)&&($u(l,0),ll(l,Ht,Zs,!1)),br(l,m),((Jt&2)===0||l!==mr)&&(l===mr&&((Jt&2)===0&&(xc|=m),Lr===4&&ll(l,Ht,Zs,!1)),wi(l))}function vA(l,u,m){if((Jt&6)!==0)throw Error(n(327));var b=!m&&(u&127)===0&&(u&l.expiredLanes)===0||gr(l,u),T=b?I9(l,u):Ov(l,u,!0),C=b;do{if(T===0){Vu&&!b&&ll(l,u,0,!1);break}else{if(m=l.current.alternate,C&&!O9(m)){T=Ov(l,u,!1),C=!1;continue}if(T===2){if(C=u,l.errorRecoveryDisabledLanes&C)var G=0;else G=l.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){u=G;e:{var le=l;T=Kd;var we=le.current.memoizedState.isDehydrated;if(we&&($u(le,G).flags|=256),G=Ov(le,G,!1),G!==2){if(Nv&&!we){le.errorRecoveryDisabledLanes|=C,xc|=C,T=4;break e}C=Ds,Ds=T,C!==null&&(Ds===null?Ds=C:Ds.push.apply(Ds,C))}T=G}if(C=!1,T!==2)continue}}if(T===1){$u(l,0),ll(l,u,0,!0);break}e:{switch(b=l,C=T,C){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:ll(b,u,Zs,!sl);break e;case 2:Ds=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(T=sm+300-De(),10<T)){if(ll(b,u,Zs,!sl),wt(b,0,!0)!==0)break e;uo=u,b.timeoutHandle=YA(bA.bind(null,b,m,Ds,im,kv,u,Zs,xc,qu,sl,C,"Throttled",-0,0),T);break e}bA(b,m,Ds,im,kv,u,Zs,xc,qu,sl,C,null,-0,0)}}break}while(!0);wi(l)}function bA(l,u,m,b,T,C,G,le,we,ke,Ue,Ve,je,Ie){if(l.timeoutHandle=-1,Ve=u.subtreeFlags,Ve&8192||(Ve&16785408)===16785408){Ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Xi},dA(u,C,Ve);var ot=(C&62914560)===C?sm-De():(C&4194048)===C?xA-De():0;if(ot=x7(Ve,ot),ot!==null){uo=C,l.cancelPendingCommit=ot(AA.bind(null,l,u,C,m,b,T,G,le,we,Ue,Ve,null,je,Ie)),ll(l,C,G,!ke);return}}AA(l,u,C,m,b,T,G,le,we)}function O9(l){for(var u=l;;){var m=u.tag;if((m===0||m===11||m===15)&&u.flags&16384&&(m=u.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var b=0;b<m.length;b++){var T=m[b],C=T.getSnapshot;T=T.value;try{if(!Gs(C(),T))return!1}catch{return!1}}if(m=u.child,u.subtreeFlags&16384&&m!==null)m.return=u,u=m;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function ll(l,u,m,b){u&=~Tv,u&=~xc,l.suspendedLanes|=u,l.pingedLanes&=~u,b&&(l.warmLanes|=u),b=l.expirationTimes;for(var T=u;0<T;){var C=31-lr(T),G=1<<C;b[C]=-1,T&=~G}m!==0&&Gi(l,m,u)}function om(){return(Jt&6)===0?(Yd(0),!1):!0}function jv(){if(Bt!==null){if(Qt===0)var l=Bt.return;else l=Bt,Qi=oc=null,Gy(l),Fu=null,Od=0,l=Bt;for(;l!==null;)Jk(l.alternate,l),l=l.return;Bt=null}}function $u(l,u){var m=l.timeoutHandle;m!==-1&&(l.timeoutHandle=-1,Z9(m)),m=l.cancelPendingCommit,m!==null&&(l.cancelPendingCommit=null,m()),uo=0,jv(),mr=l,Bt=m=Ji(l.current,null),Ht=u,Qt=0,Js=null,sl=!1,Vu=gr(l,u),Nv=!1,qu=Zs=Tv=xc=al=Lr=0,Ds=Kd=null,kv=!1,(u&8)!==0&&(u|=u&32);var b=l.entangledLanes;if(b!==0)for(l=l.entanglements,b&=u;0<b;){var T=31-lr(b),C=1<<T;u|=l[T],b&=~C}return co=u,Ap(),m}function wA(l,u){kt=null,te.H=Ud,u===Mu||u===Fp?(u=PT(),Qt=3):u===My?(u=PT(),Qt=4):Qt=u===cv?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Js=u,Bt===null&&(Lr=1,Yp(l,ga(u,l.current)))}function _A(){var l=Xs.current;return l===null?!0:(Ht&4194048)===Ht?wa===null:(Ht&62914560)===Ht||(Ht&536870912)!==0?l===wa:!1}function EA(){var l=te.H;return te.H=Ud,l===null?Ud:l}function SA(){var l=te.A;return te.A=R9,l}function lm(){Lr=4,sl||(Ht&4194048)!==Ht&&Xs.current!==null||(Vu=!0),(al&134217727)===0&&(xc&134217727)===0||mr===null||ll(mr,Ht,Zs,!1)}function Ov(l,u,m){var b=Jt;Jt|=2;var T=EA(),C=SA();(mr!==l||Ht!==u)&&(im=null,$u(l,u)),u=!1;var G=Lr;e:do try{if(Qt!==0&&Bt!==null){var le=Bt,we=Js;switch(Qt){case 8:jv(),G=6;break e;case 3:case 2:case 9:case 6:Xs.current===null&&(u=!0);var ke=Qt;if(Qt=0,Js=null,Gu(l,le,we,ke),m&&Vu){G=0;break e}break;default:ke=Qt,Qt=0,Js=null,Gu(l,le,we,ke)}}D9(),G=Lr;break}catch(Ue){wA(l,Ue)}while(!0);return u&&l.shellSuspendCounter++,Qi=oc=null,Jt=b,te.H=T,te.A=C,Bt===null&&(mr=null,Ht=0,Ap()),G}function D9(){for(;Bt!==null;)NA(Bt)}function I9(l,u){var m=Jt;Jt|=2;var b=EA(),T=SA();mr!==l||Ht!==u?(im=null,am=De()+500,$u(l,u)):Vu=gr(l,u);e:do try{if(Qt!==0&&Bt!==null){u=Bt;var C=Js;t:switch(Qt){case 1:Qt=0,Js=null,Gu(l,u,C,1);break;case 2:case 9:if(MT(C)){Qt=0,Js=null,TA(u);break}u=function(){Qt!==2&&Qt!==9||mr!==l||(Qt=7),wi(l)},C.then(u,u);break e;case 3:Qt=7;break e;case 4:Qt=5;break e;case 7:MT(C)?(Qt=0,Js=null,TA(u)):(Qt=0,Js=null,Gu(l,u,C,7));break;case 5:var G=null;switch(Bt.tag){case 26:G=Bt.memoizedState;case 5:case 27:var le=Bt;if(G?fC(G):le.stateNode.complete){Qt=0,Js=null;var we=le.sibling;if(we!==null)Bt=we;else{var ke=le.return;ke!==null?(Bt=ke,cm(ke)):Bt=null}break t}}Qt=0,Js=null,Gu(l,u,C,5);break;case 6:Qt=0,Js=null,Gu(l,u,C,6);break;case 8:jv(),Lr=6;break e;default:throw Error(n(462))}}M9();break}catch(Ue){wA(l,Ue)}while(!0);return Qi=oc=null,te.H=b,te.A=T,Jt=m,Bt!==null?0:(mr=null,Ht=0,Ap(),Lr)}function M9(){for(;Bt!==null&&!pe();)NA(Bt)}function NA(l){var u=Xk(l.alternate,l,co);l.memoizedProps=l.pendingProps,u===null?cm(l):Bt=u}function TA(l){var u=l,m=u.alternate;switch(u.tag){case 15:case 0:u=Vk(m,u,u.pendingProps,u.type,void 0,Ht);break;case 11:u=Vk(m,u,u.pendingProps,u.type.render,u.ref,Ht);break;case 5:Gy(u);default:Jk(m,u),u=Bt=ST(u,co),u=Xk(m,u,co)}l.memoizedProps=l.pendingProps,u===null?cm(l):Bt=u}function Gu(l,u,m,b){Qi=oc=null,Gy(u),Fu=null,Od=0;var T=u.return;try{if(E9(l,T,u,m,Ht)){Lr=1,Yp(l,ga(m,l.current)),Bt=null;return}}catch(C){if(T!==null)throw Bt=T,C;Lr=1,Yp(l,ga(m,l.current)),Bt=null;return}u.flags&32768?(qt||b===1?l=!0:Vu||(Ht&536870912)!==0?l=!1:(sl=l=!0,(b===2||b===9||b===3||b===6)&&(b=Xs.current,b!==null&&b.tag===13&&(b.flags|=16384))),kA(u,l)):cm(u)}function cm(l){var u=l;do{if((u.flags&32768)!==0){kA(u,sl);return}l=u.return;var m=T9(u.alternate,u,co);if(m!==null){Bt=m;return}if(u=u.sibling,u!==null){Bt=u;return}Bt=u=l}while(u!==null);Lr===0&&(Lr=5)}function kA(l,u){do{var m=k9(l.alternate,l);if(m!==null){m.flags&=32767,Bt=m;return}if(m=l.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!u&&(l=l.sibling,l!==null)){Bt=l;return}Bt=l=m}while(l!==null);Lr=6,Bt=null}function AA(l,u,m,b,T,C,G,le,we){l.cancelPendingCommit=null;do um();while(vn!==0);if((Jt&6)!==0)throw Error(n(327));if(u!==null){if(u===l.current)throw Error(n(177));if(C=u.lanes|u.childLanes,C|=by,Qn(l,m,C,G,le,we),l===mr&&(Bt=mr=null,Ht=0),Wu=u,ol=l,uo=m,Av=C,Cv=T,gA=b,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,B9(at,function(){return DA(),null})):(l.callbackNode=null,l.callbackPriority=0),b=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||b){b=te.T,te.T=null,T=Y.p,Y.p=2,G=Jt,Jt|=4;try{A9(l,u,m)}finally{Jt=G,Y.p=T,te.T=b}}vn=1,CA(),RA(),jA()}}function CA(){if(vn===1){vn=0;var l=ol,u=Wu,m=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||m){m=te.T,te.T=null;var b=Y.p;Y.p=2;var T=Jt;Jt|=4;try{cA(u,l);var C=qv,G=mT(l.containerInfo),le=C.focusedElem,we=C.selectionRange;if(G!==le&&le&&le.ownerDocument&&pT(le.ownerDocument.documentElement,le)){if(we!==null&&my(le)){var ke=we.start,Ue=we.end;if(Ue===void 0&&(Ue=ke),"selectionStart"in le)le.selectionStart=ke,le.selectionEnd=Math.min(Ue,le.value.length);else{var Ve=le.ownerDocument||document,je=Ve&&Ve.defaultView||window;if(je.getSelection){var Ie=je.getSelection(),ot=le.textContent.length,gt=Math.min(we.start,ot),fr=we.end===void 0?gt:Math.min(we.end,ot);!Ie.extend&&gt>fr&&(G=fr,fr=gt,gt=G);var Se=hT(le,gt),_e=hT(le,fr);if(Se&&_e&&(Ie.rangeCount!==1||Ie.anchorNode!==Se.node||Ie.anchorOffset!==Se.offset||Ie.focusNode!==_e.node||Ie.focusOffset!==_e.offset)){var Te=Ve.createRange();Te.setStart(Se.node,Se.offset),Ie.removeAllRanges(),gt>fr?(Ie.addRange(Te),Ie.extend(_e.node,_e.offset)):(Te.setEnd(_e.node,_e.offset),Ie.addRange(Te))}}}}for(Ve=[],Ie=le;Ie=Ie.parentNode;)Ie.nodeType===1&&Ve.push({element:Ie,left:Ie.scrollLeft,top:Ie.scrollTop});for(typeof le.focus=="function"&&le.focus(),le=0;le<Ve.length;le++){var He=Ve[le];He.element.scrollLeft=He.left,He.element.scrollTop=He.top}}_m=!!Vv,qv=Vv=null}finally{Jt=T,Y.p=b,te.T=m}}l.current=u,vn=2}}function RA(){if(vn===2){vn=0;var l=ol,u=Wu,m=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||m){m=te.T,te.T=null;var b=Y.p;Y.p=2;var T=Jt;Jt|=4;try{sA(l,u.alternate,u)}finally{Jt=T,Y.p=b,te.T=m}}vn=3}}function jA(){if(vn===4||vn===3){vn=0,Ne();var l=ol,u=Wu,m=uo,b=gA;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?vn=5:(vn=0,Wu=ol=null,OA(l,l.pendingLanes));var T=l.pendingLanes;if(T===0&&(il=null),$s(m),u=u.stateNode,or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(vt,u,void 0,(u.current.flags&128)===128)}catch{}if(b!==null){u=te.T,T=Y.p,Y.p=2,te.T=null;try{for(var C=l.onRecoverableError,G=0;G<b.length;G++){var le=b[G];C(le.value,{componentStack:le.stack})}}finally{te.T=u,Y.p=T}}(uo&3)!==0&&um(),wi(l),T=l.pendingLanes,(m&261930)!==0&&(T&42)!==0?l===Rv?Xd++:(Xd=0,Rv=l):Xd=0,Yd(0)}}function OA(l,u){(l.pooledCacheLanes&=u)===0&&(u=l.pooledCache,u!=null&&(l.pooledCache=null,Rd(u)))}function um(){return CA(),RA(),jA(),DA()}function DA(){if(vn!==5)return!1;var l=ol,u=Av;Av=0;var m=$s(uo),b=te.T,T=Y.p;try{Y.p=32>m?32:m,te.T=null,m=Cv,Cv=null;var C=ol,G=uo;if(vn=0,Wu=ol=null,uo=0,(Jt&6)!==0)throw Error(n(331));var le=Jt;if(Jt|=4,pA(C.current),fA(C,C.current,G,m),Jt=le,Yd(0,!1),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(vt,C)}catch{}return!0}finally{Y.p=T,te.T=b,OA(l,u)}}function IA(l,u,m){u=ga(m,u),u=lv(l.stateNode,u,2),l=el(l,u,2),l!==null&&(br(l,2),wi(l))}function er(l,u,m){if(l.tag===3)IA(l,l,m);else for(;u!==null;){if(u.tag===3){IA(u,l,m);break}else if(u.tag===1){var b=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(il===null||!il.has(b))){l=ga(m,l),m=Mk(2),b=el(u,m,2),b!==null&&(Fk(m,b,u,l),br(b,2),wi(b));break}}u=u.return}}function Dv(l,u,m){var b=l.pingCache;if(b===null){b=l.pingCache=new j9;var T=new Set;b.set(u,T)}else T=b.get(u),T===void 0&&(T=new Set,b.set(u,T));T.has(m)||(Nv=!0,T.add(m),l=F9.bind(null,l,u,m),u.then(l,l))}function F9(l,u,m){var b=l.pingCache;b!==null&&b.delete(u),l.pingedLanes|=l.suspendedLanes&m,l.warmLanes&=~m,mr===l&&(Ht&m)===m&&(Lr===4||Lr===3&&(Ht&62914560)===Ht&&300>De()-sm?(Jt&2)===0&&$u(l,0):Tv|=m,qu===Ht&&(qu=0)),wi(l)}function MA(l,u){u===0&&(u=kn()),l=sc(l,u),l!==null&&(br(l,u),wi(l))}function P9(l){var u=l.memoizedState,m=0;u!==null&&(m=u.retryLane),MA(l,m)}function L9(l,u){var m=0;switch(l.tag){case 31:case 13:var b=l.stateNode,T=l.memoizedState;T!==null&&(m=T.retryLane);break;case 19:b=l.stateNode;break;case 22:b=l.stateNode._retryCache;break;default:throw Error(n(314))}b!==null&&b.delete(u),MA(l,m)}function B9(l,u){return ue(l,u)}var fm=null,Ku=null,Iv=!1,dm=!1,Mv=!1,cl=0;function wi(l){l!==Ku&&l.next===null&&(Ku===null?fm=Ku=l:Ku=Ku.next=l),dm=!0,Iv||(Iv=!0,z9())}function Yd(l,u){if(!Mv&&dm){Mv=!0;do for(var m=!1,b=fm;b!==null;){if(l!==0){var T=b.pendingLanes;if(T===0)var C=0;else{var G=b.suspendedLanes,le=b.pingedLanes;C=(1<<31-lr(42|l)+1)-1,C&=T&~(G&~le),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(m=!0,BA(b,C))}else C=Ht,C=wt(b,b===mr?C:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(C&3)===0||gr(b,C)||(m=!0,BA(b,C));b=b.next}while(m);Mv=!1}}function U9(){FA()}function FA(){dm=Iv=!1;var l=0;cl!==0&&J9()&&(l=cl);for(var u=De(),m=null,b=fm;b!==null;){var T=b.next,C=PA(b,u);C===0?(b.next=null,m===null?fm=T:m.next=T,T===null&&(Ku=m)):(m=b,(l!==0||(C&3)!==0)&&(dm=!0)),b=T}vn!==0&&vn!==5||Yd(l),cl!==0&&(cl=0)}function PA(l,u){for(var m=l.suspendedLanes,b=l.pingedLanes,T=l.expirationTimes,C=l.pendingLanes&-62914561;0<C;){var G=31-lr(C),le=1<<G,we=T[G];we===-1?((le&m)===0||(le&b)!==0)&&(T[G]=sn(le,u)):we<=u&&(l.expiredLanes|=le),C&=~le}if(u=mr,m=Ht,m=wt(l,l===u?m:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),b=l.callbackNode,m===0||l===u&&(Qt===2||Qt===9)||l.cancelPendingCommit!==null)return b!==null&&b!==null&&ye(b),l.callbackNode=null,l.callbackPriority=0;if((m&3)===0||gr(l,m)){if(u=m&-m,u===l.callbackPriority)return u;switch(b!==null&&ye(b),$s(m)){case 2:case 8:m=st;break;case 32:m=at;break;case 268435456:m=dt;break;default:m=at}return b=LA.bind(null,l),m=ue(m,b),l.callbackPriority=u,l.callbackNode=m,u}return b!==null&&b!==null&&ye(b),l.callbackPriority=2,l.callbackNode=null,2}function LA(l,u){if(vn!==0&&vn!==5)return l.callbackNode=null,l.callbackPriority=0,null;var m=l.callbackNode;if(um()&&l.callbackNode!==m)return null;var b=Ht;return b=wt(l,l===mr?b:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),b===0?null:(vA(l,b,u),PA(l,De()),l.callbackNode!=null&&l.callbackNode===m?LA.bind(null,l):null)}function BA(l,u){if(um())return null;vA(l,u,!0)}function z9(){Q9(function(){(Jt&6)!==0?ue(Ke,U9):FA()})}function Fv(){if(cl===0){var l=Du;l===0&&(l=Ya,Ya<<=1,(Ya&261888)===0&&(Ya=256)),cl=l}return cl}function UA(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:bp(""+l)}function zA(l,u){var m=u.ownerDocument.createElement("input");return m.name=u.name,m.value=u.value,l.id&&m.setAttribute("form",l.id),u.parentNode.insertBefore(m,u),l=new FormData(l),m.parentNode.removeChild(m),l}function H9(l,u,m,b,T){if(u==="submit"&&m&&m.stateNode===T){var C=UA((T[me]||null).action),G=b.submitter;G&&(u=(u=G[me]||null)?UA(u.formAction):G.getAttribute("formAction"),u!==null&&(C=u,G=null));var le=new Sp("action","action",null,b,T);l.push({event:le,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(cl!==0){var we=G?zA(T,G):new FormData(T);rv(m,{pending:!0,data:we,method:T.method,action:C},null,we)}}else typeof C=="function"&&(le.preventDefault(),we=G?zA(T,G):new FormData(T),rv(m,{pending:!0,data:we,method:T.method,action:C},C,we))},currentTarget:T}]})}}for(var Pv=0;Pv<vy.length;Pv++){var Lv=vy[Pv],V9=Lv.toLowerCase(),q9=Lv[0].toUpperCase()+Lv.slice(1);Za(V9,"on"+q9)}Za(yT,"onAnimationEnd"),Za(vT,"onAnimationIteration"),Za(bT,"onAnimationStart"),Za("dblclick","onDoubleClick"),Za("focusin","onFocus"),Za("focusout","onBlur"),Za(i9,"onTransitionRun"),Za(o9,"onTransitionStart"),Za(l9,"onTransitionCancel"),Za(wT,"onTransitionEnd"),ha("onMouseEnter",["mouseout","mouseover"]),ha("onMouseLeave",["mouseout","mouseover"]),ha("onPointerEnter",["pointerout","pointerover"]),ha("onPointerLeave",["pointerout","pointerover"]),Ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ar("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),W9=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jd));function HA(l,u){u=(u&4)!==0;for(var m=0;m<l.length;m++){var b=l[m],T=b.event;b=b.listeners;e:{var C=void 0;if(u)for(var G=b.length-1;0<=G;G--){var le=b[G],we=le.instance,ke=le.currentTarget;if(le=le.listener,we!==C&&T.isPropagationStopped())break e;C=le,T.currentTarget=ke;try{C(T)}catch(Ue){kp(Ue)}T.currentTarget=null,C=we}else for(G=0;G<b.length;G++){if(le=b[G],we=le.instance,ke=le.currentTarget,le=le.listener,we!==C&&T.isPropagationStopped())break e;C=le,T.currentTarget=ke;try{C(T)}catch(Ue){kp(Ue)}T.currentTarget=null,C=we}}}}function Ut(l,u){var m=u[Ae];m===void 0&&(m=u[Ae]=new Set);var b=l+"__bubble";m.has(b)||(VA(u,l,2,!1),m.add(b))}function Bv(l,u,m){var b=0;u&&(b|=4),VA(m,l,b,u)}var hm="_reactListening"+Math.random().toString(36).slice(2);function Uv(l){if(!l[hm]){l[hm]=!0,yr.forEach(function(m){m!=="selectionchange"&&(W9.has(m)||Bv(m,!1,l),Bv(m,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[hm]||(u[hm]=!0,Bv("selectionchange",!1,u))}}function VA(l,u,m,b){switch(yC(u)){case 2:var T=v7;break;case 8:T=b7;break;default:T=tb}m=T.bind(null,u,m,l),T=void 0,!iy||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(T=!0),b?T!==void 0?l.addEventListener(u,m,{capture:!0,passive:T}):l.addEventListener(u,m,!0):T!==void 0?l.addEventListener(u,m,{passive:T}):l.addEventListener(u,m,!1)}function zv(l,u,m,b,T){var C=b;if((u&1)===0&&(u&2)===0&&b!==null)e:for(;;){if(b===null)return;var G=b.tag;if(G===3||G===4){var le=b.stateNode.containerInfo;if(le===T)break;if(G===4)for(G=b.return;G!==null;){var we=G.tag;if((we===3||we===4)&&G.stateNode.containerInfo===T)return;G=G.return}for(;le!==null;){if(G=Ze(le),G===null)return;if(we=G.tag,we===5||we===6||we===26||we===27){b=C=G;continue e}le=le.parentNode}}b=b.return}KN(function(){var ke=C,Ue=sy(m),Ve=[];e:{var je=_T.get(l);if(je!==void 0){var Ie=Sp,ot=l;switch(l){case"keypress":if(_p(m)===0)break e;case"keydown":case"keyup":Ie=LB;break;case"focusin":ot="focus",Ie=uy;break;case"focusout":ot="blur",Ie=uy;break;case"beforeblur":case"afterblur":Ie=uy;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ie=JN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ie=TB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ie=zB;break;case yT:case vT:case bT:Ie=CB;break;case wT:Ie=VB;break;case"scroll":case"scrollend":Ie=SB;break;case"wheel":Ie=WB;break;case"copy":case"cut":case"paste":Ie=jB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ie=QN;break;case"toggle":case"beforetoggle":Ie=GB}var gt=(u&4)!==0,fr=!gt&&(l==="scroll"||l==="scrollend"),Se=gt?je!==null?je+"Capture":null:je;gt=[];for(var _e=ke,Te;_e!==null;){var He=_e;if(Te=He.stateNode,He=He.tag,He!==5&&He!==26&&He!==27||Te===null||Se===null||(He=vd(_e,Se),He!=null&&gt.push(Zd(_e,He,Te))),fr)break;_e=_e.return}0<gt.length&&(je=new Ie(je,ot,null,m,Ue),Ve.push({event:je,listeners:gt}))}}if((u&7)===0){e:{if(je=l==="mouseover"||l==="pointerover",Ie=l==="mouseout"||l==="pointerout",je&&m!==ny&&(ot=m.relatedTarget||m.fromElement)&&(Ze(ot)||ot[ge]))break e;if((Ie||je)&&(je=Ue.window===Ue?Ue:(je=Ue.ownerDocument)?je.defaultView||je.parentWindow:window,Ie?(ot=m.relatedTarget||m.toElement,Ie=ke,ot=ot?Ze(ot):null,ot!==null&&(fr=a(ot),gt=ot.tag,ot!==fr||gt!==5&&gt!==27&&gt!==6)&&(ot=null)):(Ie=null,ot=ke),Ie!==ot)){if(gt=JN,He="onMouseLeave",Se="onMouseEnter",_e="mouse",(l==="pointerout"||l==="pointerover")&&(gt=QN,He="onPointerLeave",Se="onPointerEnter",_e="pointer"),fr=Ie==null?je:Ye(Ie),Te=ot==null?je:Ye(ot),je=new gt(He,_e+"leave",Ie,m,Ue),je.target=fr,je.relatedTarget=Te,He=null,Ze(Ue)===ke&&(gt=new gt(Se,_e+"enter",ot,m,Ue),gt.target=Te,gt.relatedTarget=fr,He=gt),fr=He,Ie&&ot)t:{for(gt=$9,Se=Ie,_e=ot,Te=0,He=Se;He;He=gt(He))Te++;He=0;for(var pt=_e;pt;pt=gt(pt))He++;for(;0<Te-He;)Se=gt(Se),Te--;for(;0<He-Te;)_e=gt(_e),He--;for(;Te--;){if(Se===_e||_e!==null&&Se===_e.alternate){gt=Se;break t}Se=gt(Se),_e=gt(_e)}gt=null}else gt=null;Ie!==null&&qA(Ve,je,Ie,gt,!1),ot!==null&&fr!==null&&qA(Ve,fr,ot,gt,!0)}}e:{if(je=ke?Ye(ke):window,Ie=je.nodeName&&je.nodeName.toLowerCase(),Ie==="select"||Ie==="input"&&je.type==="file")var Kt=oT;else if(aT(je))if(lT)Kt=n9;else{Kt=t9;var ft=e9}else Ie=je.nodeName,!Ie||Ie.toLowerCase()!=="input"||je.type!=="checkbox"&&je.type!=="radio"?ke&&ry(ke.elementType)&&(Kt=oT):Kt=r9;if(Kt&&(Kt=Kt(l,ke))){iT(Ve,Kt,m,Ue);break e}ft&&ft(l,je,ke),l==="focusout"&&ke&&je.type==="number"&&ke.memoizedProps.value!=null&&ty(je,"number",je.value)}switch(ft=ke?Ye(ke):window,l){case"focusin":(aT(ft)||ft.contentEditable==="true")&&(Nu=ft,xy=ke,kd=null);break;case"focusout":kd=xy=Nu=null;break;case"mousedown":gy=!0;break;case"contextmenu":case"mouseup":case"dragend":gy=!1,xT(Ve,m,Ue);break;case"selectionchange":if(a9)break;case"keydown":case"keyup":xT(Ve,m,Ue)}var Rt;if(dy)e:{switch(l){case"compositionstart":var Vt="onCompositionStart";break e;case"compositionend":Vt="onCompositionEnd";break e;case"compositionupdate":Vt="onCompositionUpdate";break e}Vt=void 0}else Su?nT(l,m)&&(Vt="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(Vt="onCompositionStart");Vt&&(eT&&m.locale!=="ko"&&(Su||Vt!=="onCompositionStart"?Vt==="onCompositionEnd"&&Su&&(Rt=XN()):(Go=Ue,oy="value"in Go?Go.value:Go.textContent,Su=!0)),ft=pm(ke,Vt),0<ft.length&&(Vt=new ZN(Vt,l,null,m,Ue),Ve.push({event:Vt,listeners:ft}),Rt?Vt.data=Rt:(Rt=sT(m),Rt!==null&&(Vt.data=Rt)))),(Rt=XB?YB(l,m):JB(l,m))&&(Vt=pm(ke,"onBeforeInput"),0<Vt.length&&(ft=new ZN("onBeforeInput","beforeinput",null,m,Ue),Ve.push({event:ft,listeners:Vt}),ft.data=Rt)),H9(Ve,l,ke,m,Ue)}HA(Ve,u)})}function Zd(l,u,m){return{instance:l,listener:u,currentTarget:m}}function pm(l,u){for(var m=u+"Capture",b=[];l!==null;){var T=l,C=T.stateNode;if(T=T.tag,T!==5&&T!==26&&T!==27||C===null||(T=vd(l,m),T!=null&&b.unshift(Zd(l,T,C)),T=vd(l,u),T!=null&&b.push(Zd(l,T,C))),l.tag===3)return b;l=l.return}return[]}function $9(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function qA(l,u,m,b,T){for(var C=u._reactName,G=[];m!==null&&m!==b;){var le=m,we=le.alternate,ke=le.stateNode;if(le=le.tag,we!==null&&we===b)break;le!==5&&le!==26&&le!==27||ke===null||(we=ke,T?(ke=vd(m,C),ke!=null&&G.unshift(Zd(m,ke,we))):T||(ke=vd(m,C),ke!=null&&G.push(Zd(m,ke,we)))),m=m.return}G.length!==0&&l.push({event:u,listeners:G})}var G9=/\r\n?/g,K9=/\u0000|\uFFFD/g;function WA(l){return(typeof l=="string"?l:""+l).replace(G9,`
`).replace(K9,"")}function $A(l,u){return u=WA(u),WA(l)===u}function ur(l,u,m,b,T,C){switch(m){case"children":typeof b=="string"?u==="body"||u==="textarea"&&b===""||wu(l,b):(typeof b=="number"||typeof b=="bigint")&&u!=="body"&&wu(l,""+b);break;case"className":yp(l,"class",b);break;case"tabIndex":yp(l,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":yp(l,m,b);break;case"style":$N(l,b,C);break;case"data":if(u!=="object"){yp(l,"data",b);break}case"src":case"href":if(b===""&&(u!=="a"||m!=="href")){l.removeAttribute(m);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){l.removeAttribute(m);break}b=bp(""+b),l.setAttribute(m,b);break;case"action":case"formAction":if(typeof b=="function"){l.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(m==="formAction"?(u!=="input"&&ur(l,u,"name",T.name,T,null),ur(l,u,"formEncType",T.formEncType,T,null),ur(l,u,"formMethod",T.formMethod,T,null),ur(l,u,"formTarget",T.formTarget,T,null)):(ur(l,u,"encType",T.encType,T,null),ur(l,u,"method",T.method,T,null),ur(l,u,"target",T.target,T,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){l.removeAttribute(m);break}b=bp(""+b),l.setAttribute(m,b);break;case"onClick":b!=null&&(l.onclick=Xi);break;case"onScroll":b!=null&&Ut("scroll",l);break;case"onScrollEnd":b!=null&&Ut("scrollend",l);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(n(61));if(m=b.__html,m!=null){if(T.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"multiple":l.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":l.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){l.removeAttribute("xlink:href");break}m=bp(""+b),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?l.setAttribute(m,""+b):l.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?l.setAttribute(m,""):l.removeAttribute(m);break;case"capture":case"download":b===!0?l.setAttribute(m,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?l.setAttribute(m,b):l.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?l.setAttribute(m,b):l.removeAttribute(m);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?l.removeAttribute(m):l.setAttribute(m,b);break;case"popover":Ut("beforetoggle",l),Ut("toggle",l),As(l,"popover",b);break;case"xlinkActuate":Ki(l,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":Ki(l,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":Ki(l,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":Ki(l,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":Ki(l,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":Ki(l,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":Ki(l,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":Ki(l,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":Ki(l,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":As(l,"is",b);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=_B.get(m)||m,As(l,m,b))}}function Hv(l,u,m,b,T,C){switch(m){case"style":$N(l,b,C);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(n(61));if(m=b.__html,m!=null){if(T.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"children":typeof b=="string"?wu(l,b):(typeof b=="number"||typeof b=="bigint")&&wu(l,""+b);break;case"onScroll":b!=null&&Ut("scroll",l);break;case"onScrollEnd":b!=null&&Ut("scrollend",l);break;case"onClick":b!=null&&(l.onclick=Xi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!vr.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(T=m.endsWith("Capture"),u=m.slice(2,T?m.length-7:void 0),C=l[me]||null,C=C!=null?C[m]:null,typeof C=="function"&&l.removeEventListener(u,C,T),typeof b=="function")){typeof C!="function"&&C!==null&&(m in l?l[m]=null:l.hasAttribute(m)&&l.removeAttribute(m)),l.addEventListener(u,b,T);break e}m in l?l[m]=b:b===!0?l.setAttribute(m,""):As(l,m,b)}}}function Hn(l,u,m){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ut("error",l),Ut("load",l);var b=!1,T=!1,C;for(C in m)if(m.hasOwnProperty(C)){var G=m[C];if(G!=null)switch(C){case"src":b=!0;break;case"srcSet":T=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:ur(l,u,C,G,m,null)}}T&&ur(l,u,"srcSet",m.srcSet,m,null),b&&ur(l,u,"src",m.src,m,null);return;case"input":Ut("invalid",l);var le=C=G=T=null,we=null,ke=null;for(b in m)if(m.hasOwnProperty(b)){var Ue=m[b];if(Ue!=null)switch(b){case"name":T=Ue;break;case"type":G=Ue;break;case"checked":we=Ue;break;case"defaultChecked":ke=Ue;break;case"value":C=Ue;break;case"defaultValue":le=Ue;break;case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(n(137,u));break;default:ur(l,u,b,Ue,m,null)}}HN(l,C,le,we,ke,G,T,!1);return;case"select":Ut("invalid",l),b=G=C=null;for(T in m)if(m.hasOwnProperty(T)&&(le=m[T],le!=null))switch(T){case"value":C=le;break;case"defaultValue":G=le;break;case"multiple":b=le;default:ur(l,u,T,le,m,null)}u=C,m=G,l.multiple=!!b,u!=null?bu(l,!!b,u,!1):m!=null&&bu(l,!!b,m,!0);return;case"textarea":Ut("invalid",l),C=T=b=null;for(G in m)if(m.hasOwnProperty(G)&&(le=m[G],le!=null))switch(G){case"value":b=le;break;case"defaultValue":T=le;break;case"children":C=le;break;case"dangerouslySetInnerHTML":if(le!=null)throw Error(n(91));break;default:ur(l,u,G,le,m,null)}qN(l,b,T,C);return;case"option":for(we in m)if(m.hasOwnProperty(we)&&(b=m[we],b!=null))switch(we){case"selected":l.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:ur(l,u,we,b,m,null)}return;case"dialog":Ut("beforetoggle",l),Ut("toggle",l),Ut("cancel",l),Ut("close",l);break;case"iframe":case"object":Ut("load",l);break;case"video":case"audio":for(b=0;b<Jd.length;b++)Ut(Jd[b],l);break;case"image":Ut("error",l),Ut("load",l);break;case"details":Ut("toggle",l);break;case"embed":case"source":case"link":Ut("error",l),Ut("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ke in m)if(m.hasOwnProperty(ke)&&(b=m[ke],b!=null))switch(ke){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:ur(l,u,ke,b,m,null)}return;default:if(ry(u)){for(Ue in m)m.hasOwnProperty(Ue)&&(b=m[Ue],b!==void 0&&Hv(l,u,Ue,b,m,void 0));return}}for(le in m)m.hasOwnProperty(le)&&(b=m[le],b!=null&&ur(l,u,le,b,m,null))}function X9(l,u,m,b){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var T=null,C=null,G=null,le=null,we=null,ke=null,Ue=null;for(Ie in m){var Ve=m[Ie];if(m.hasOwnProperty(Ie)&&Ve!=null)switch(Ie){case"checked":break;case"value":break;case"defaultValue":we=Ve;default:b.hasOwnProperty(Ie)||ur(l,u,Ie,null,b,Ve)}}for(var je in b){var Ie=b[je];if(Ve=m[je],b.hasOwnProperty(je)&&(Ie!=null||Ve!=null))switch(je){case"type":C=Ie;break;case"name":T=Ie;break;case"checked":ke=Ie;break;case"defaultChecked":Ue=Ie;break;case"value":G=Ie;break;case"defaultValue":le=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(n(137,u));break;default:Ie!==Ve&&ur(l,u,je,Ie,b,Ve)}}ey(l,G,le,we,ke,Ue,C,T);return;case"select":Ie=G=le=je=null;for(C in m)if(we=m[C],m.hasOwnProperty(C)&&we!=null)switch(C){case"value":break;case"multiple":Ie=we;default:b.hasOwnProperty(C)||ur(l,u,C,null,b,we)}for(T in b)if(C=b[T],we=m[T],b.hasOwnProperty(T)&&(C!=null||we!=null))switch(T){case"value":je=C;break;case"defaultValue":le=C;break;case"multiple":G=C;default:C!==we&&ur(l,u,T,C,b,we)}u=le,m=G,b=Ie,je!=null?bu(l,!!m,je,!1):!!b!=!!m&&(u!=null?bu(l,!!m,u,!0):bu(l,!!m,m?[]:"",!1));return;case"textarea":Ie=je=null;for(le in m)if(T=m[le],m.hasOwnProperty(le)&&T!=null&&!b.hasOwnProperty(le))switch(le){case"value":break;case"children":break;default:ur(l,u,le,null,b,T)}for(G in b)if(T=b[G],C=m[G],b.hasOwnProperty(G)&&(T!=null||C!=null))switch(G){case"value":je=T;break;case"defaultValue":Ie=T;break;case"children":break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(n(91));break;default:T!==C&&ur(l,u,G,T,b,C)}VN(l,je,Ie);return;case"option":for(var ot in m)if(je=m[ot],m.hasOwnProperty(ot)&&je!=null&&!b.hasOwnProperty(ot))switch(ot){case"selected":l.selected=!1;break;default:ur(l,u,ot,null,b,je)}for(we in b)if(je=b[we],Ie=m[we],b.hasOwnProperty(we)&&je!==Ie&&(je!=null||Ie!=null))switch(we){case"selected":l.selected=je&&typeof je!="function"&&typeof je!="symbol";break;default:ur(l,u,we,je,b,Ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var gt in m)je=m[gt],m.hasOwnProperty(gt)&&je!=null&&!b.hasOwnProperty(gt)&&ur(l,u,gt,null,b,je);for(ke in b)if(je=b[ke],Ie=m[ke],b.hasOwnProperty(ke)&&je!==Ie&&(je!=null||Ie!=null))switch(ke){case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(n(137,u));break;default:ur(l,u,ke,je,b,Ie)}return;default:if(ry(u)){for(var fr in m)je=m[fr],m.hasOwnProperty(fr)&&je!==void 0&&!b.hasOwnProperty(fr)&&Hv(l,u,fr,void 0,b,je);for(Ue in b)je=b[Ue],Ie=m[Ue],!b.hasOwnProperty(Ue)||je===Ie||je===void 0&&Ie===void 0||Hv(l,u,Ue,je,b,Ie);return}}for(var Se in m)je=m[Se],m.hasOwnProperty(Se)&&je!=null&&!b.hasOwnProperty(Se)&&ur(l,u,Se,null,b,je);for(Ve in b)je=b[Ve],Ie=m[Ve],!b.hasOwnProperty(Ve)||je===Ie||je==null&&Ie==null||ur(l,u,Ve,je,b,Ie)}function GA(l){switch(l){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Y9(){if(typeof performance.getEntriesByType=="function"){for(var l=0,u=0,m=performance.getEntriesByType("resource"),b=0;b<m.length;b++){var T=m[b],C=T.transferSize,G=T.initiatorType,le=T.duration;if(C&&le&&GA(G)){for(G=0,le=T.responseEnd,b+=1;b<m.length;b++){var we=m[b],ke=we.startTime;if(ke>le)break;var Ue=we.transferSize,Ve=we.initiatorType;Ue&&GA(Ve)&&(we=we.responseEnd,G+=Ue*(we<le?1:(le-ke)/(we-ke)))}if(--b,u+=8*(C+G)/(T.duration/1e3),l++,10<l)break}}if(0<l)return u/l/1e6}return navigator.connection&&(l=navigator.connection.downlink,typeof l=="number")?l:5}var Vv=null,qv=null;function mm(l){return l.nodeType===9?l:l.ownerDocument}function KA(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function XA(l,u){if(l===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&u==="foreignObject"?0:l}function Wv(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var $v=null;function J9(){var l=window.event;return l&&l.type==="popstate"?l===$v?!1:($v=l,!0):($v=null,!1)}var YA=typeof setTimeout=="function"?setTimeout:void 0,Z9=typeof clearTimeout=="function"?clearTimeout:void 0,JA=typeof Promise=="function"?Promise:void 0,Q9=typeof queueMicrotask=="function"?queueMicrotask:typeof JA<"u"?function(l){return JA.resolve(null).then(l).catch(e7)}:YA;function e7(l){setTimeout(function(){throw l})}function ul(l){return l==="head"}function ZA(l,u){var m=u,b=0;do{var T=m.nextSibling;if(l.removeChild(m),T&&T.nodeType===8)if(m=T.data,m==="/$"||m==="/&"){if(b===0){l.removeChild(T),Zu(u);return}b--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")b++;else if(m==="html")Qd(l.ownerDocument.documentElement);else if(m==="head"){m=l.ownerDocument.head,Qd(m);for(var C=m.firstChild;C;){var G=C.nextSibling,le=C.nodeName;C[Oe]||le==="SCRIPT"||le==="STYLE"||le==="LINK"&&C.rel.toLowerCase()==="stylesheet"||m.removeChild(C),C=G}}else m==="body"&&Qd(l.ownerDocument.body);m=T}while(m);Zu(u)}function QA(l,u){var m=l;l=0;do{var b=m.nextSibling;if(m.nodeType===1?u?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(u?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),b&&b.nodeType===8)if(m=b.data,m==="/$"){if(l===0)break;l--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||l++;m=b}while(m)}function Gv(l){var u=l.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var m=u;switch(u=u.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Gv(m),Xe(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}l.removeChild(m)}}function t7(l,u,m,b){for(;l.nodeType===1;){var T=m;if(l.nodeName.toLowerCase()!==u.toLowerCase()){if(!b&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(b){if(!l[Oe])switch(u){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(C=l.getAttribute("rel"),C==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(C!==T.rel||l.getAttribute("href")!==(T.href==null||T.href===""?null:T.href)||l.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin)||l.getAttribute("title")!==(T.title==null?null:T.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(C=l.getAttribute("src"),(C!==(T.src==null?null:T.src)||l.getAttribute("type")!==(T.type==null?null:T.type)||l.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin))&&C&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(u==="input"&&l.type==="hidden"){var C=T.name==null?null:""+T.name;if(T.type==="hidden"&&l.getAttribute("name")===C)return l}else return l;if(l=_a(l.nextSibling),l===null)break}return null}function r7(l,u,m){if(u==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!m||(l=_a(l.nextSibling),l===null))return null;return l}function eC(l,u){for(;l.nodeType!==8;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!u||(l=_a(l.nextSibling),l===null))return null;return l}function Kv(l){return l.data==="$?"||l.data==="$~"}function Xv(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState!=="loading"}function n7(l,u){var m=l.ownerDocument;if(l.data==="$~")l._reactRetry=u;else if(l.data!=="$?"||m.readyState!=="loading")u();else{var b=function(){u(),m.removeEventListener("DOMContentLoaded",b)};m.addEventListener("DOMContentLoaded",b),l._reactRetry=b}}function _a(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return l}var Yv=null;function tC(l){l=l.nextSibling;for(var u=0;l;){if(l.nodeType===8){var m=l.data;if(m==="/$"||m==="/&"){if(u===0)return _a(l.nextSibling);u--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||u++}l=l.nextSibling}return null}function rC(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(u===0)return l;u--}else m!=="/$"&&m!=="/&"||u++}l=l.previousSibling}return null}function nC(l,u,m){switch(u=mm(m),l){case"html":if(l=u.documentElement,!l)throw Error(n(452));return l;case"head":if(l=u.head,!l)throw Error(n(453));return l;case"body":if(l=u.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function Qd(l){for(var u=l.attributes;u.length;)l.removeAttributeNode(u[0]);Xe(l)}var Ea=new Map,sC=new Set;function xm(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var fo=Y.d;Y.d={f:s7,r:a7,D:i7,C:o7,L:l7,m:c7,X:f7,S:u7,M:d7};function s7(){var l=fo.f(),u=om();return l||u}function a7(l){var u=nt(l);u!==null&&u.tag===5&&u.type==="form"?wk(u):fo.r(l)}var Xu=typeof document>"u"?null:document;function aC(l,u,m){var b=Xu;if(b&&typeof u=="string"&&u){var T=ma(u);T='link[rel="'+l+'"][href="'+T+'"]',typeof m=="string"&&(T+='[crossorigin="'+m+'"]'),sC.has(T)||(sC.add(T),l={rel:l,crossOrigin:m,href:u},b.querySelector(T)===null&&(u=b.createElement("link"),Hn(u,"link",l),ct(u),b.head.appendChild(u)))}}function i7(l){fo.D(l),aC("dns-prefetch",l,null)}function o7(l,u){fo.C(l,u),aC("preconnect",l,u)}function l7(l,u,m){fo.L(l,u,m);var b=Xu;if(b&&l&&u){var T='link[rel="preload"][as="'+ma(u)+'"]';u==="image"&&m&&m.imageSrcSet?(T+='[imagesrcset="'+ma(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(T+='[imagesizes="'+ma(m.imageSizes)+'"]')):T+='[href="'+ma(l)+'"]';var C=T;switch(u){case"style":C=Yu(l);break;case"script":C=Ju(l)}Ea.has(C)||(l=p({rel:"preload",href:u==="image"&&m&&m.imageSrcSet?void 0:l,as:u},m),Ea.set(C,l),b.querySelector(T)!==null||u==="style"&&b.querySelector(eh(C))||u==="script"&&b.querySelector(th(C))||(u=b.createElement("link"),Hn(u,"link",l),ct(u),b.head.appendChild(u)))}}function c7(l,u){fo.m(l,u);var m=Xu;if(m&&l){var b=u&&typeof u.as=="string"?u.as:"script",T='link[rel="modulepreload"][as="'+ma(b)+'"][href="'+ma(l)+'"]',C=T;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Ju(l)}if(!Ea.has(C)&&(l=p({rel:"modulepreload",href:l},u),Ea.set(C,l),m.querySelector(T)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(th(C)))return}b=m.createElement("link"),Hn(b,"link",l),ct(b),m.head.appendChild(b)}}}function u7(l,u,m){fo.S(l,u,m);var b=Xu;if(b&&l){var T=tt(b).hoistableStyles,C=Yu(l);u=u||"default";var G=T.get(C);if(!G){var le={loading:0,preload:null};if(G=b.querySelector(eh(C)))le.loading=5;else{l=p({rel:"stylesheet",href:l,"data-precedence":u},m),(m=Ea.get(C))&&Jv(l,m);var we=G=b.createElement("link");ct(we),Hn(we,"link",l),we._p=new Promise(function(ke,Ue){we.onload=ke,we.onerror=Ue}),we.addEventListener("load",function(){le.loading|=1}),we.addEventListener("error",function(){le.loading|=2}),le.loading|=4,gm(G,u,b)}G={type:"stylesheet",instance:G,count:1,state:le},T.set(C,G)}}}function f7(l,u){fo.X(l,u);var m=Xu;if(m&&l){var b=tt(m).hoistableScripts,T=Ju(l),C=b.get(T);C||(C=m.querySelector(th(T)),C||(l=p({src:l,async:!0},u),(u=Ea.get(T))&&Zv(l,u),C=m.createElement("script"),ct(C),Hn(C,"link",l),m.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},b.set(T,C))}}function d7(l,u){fo.M(l,u);var m=Xu;if(m&&l){var b=tt(m).hoistableScripts,T=Ju(l),C=b.get(T);C||(C=m.querySelector(th(T)),C||(l=p({src:l,async:!0,type:"module"},u),(u=Ea.get(T))&&Zv(l,u),C=m.createElement("script"),ct(C),Hn(C,"link",l),m.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},b.set(T,C))}}function iC(l,u,m,b){var T=(T=re.current)?xm(T):null;if(!T)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(u=Yu(m.href),m=tt(T).hoistableStyles,b=m.get(u),b||(b={type:"style",instance:null,count:0,state:null},m.set(u,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){l=Yu(m.href);var C=tt(T).hoistableStyles,G=C.get(l);if(G||(T=T.ownerDocument||T,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(l,G),(C=T.querySelector(eh(l)))&&!C._p&&(G.instance=C,G.state.loading=5),Ea.has(l)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Ea.set(l,m),C||h7(T,l,m,G.state))),u&&b===null)throw Error(n(528,""));return G}if(u&&b!==null)throw Error(n(529,""));return null;case"script":return u=m.async,m=m.src,typeof m=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Ju(m),m=tt(T).hoistableScripts,b=m.get(u),b||(b={type:"script",instance:null,count:0,state:null},m.set(u,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function Yu(l){return'href="'+ma(l)+'"'}function eh(l){return'link[rel="stylesheet"]['+l+"]"}function oC(l){return p({},l,{"data-precedence":l.precedence,precedence:null})}function h7(l,u,m,b){l.querySelector('link[rel="preload"][as="style"]['+u+"]")?b.loading=1:(u=l.createElement("link"),b.preload=u,u.addEventListener("load",function(){return b.loading|=1}),u.addEventListener("error",function(){return b.loading|=2}),Hn(u,"link",m),ct(u),l.head.appendChild(u))}function Ju(l){return'[src="'+ma(l)+'"]'}function th(l){return"script[async]"+l}function lC(l,u,m){if(u.count++,u.instance===null)switch(u.type){case"style":var b=l.querySelector('style[data-href~="'+ma(m.href)+'"]');if(b)return u.instance=b,ct(b),b;var T=p({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return b=(l.ownerDocument||l).createElement("style"),ct(b),Hn(b,"style",T),gm(b,m.precedence,l),u.instance=b;case"stylesheet":T=Yu(m.href);var C=l.querySelector(eh(T));if(C)return u.state.loading|=4,u.instance=C,ct(C),C;b=oC(m),(T=Ea.get(T))&&Jv(b,T),C=(l.ownerDocument||l).createElement("link"),ct(C);var G=C;return G._p=new Promise(function(le,we){G.onload=le,G.onerror=we}),Hn(C,"link",b),u.state.loading|=4,gm(C,m.precedence,l),u.instance=C;case"script":return C=Ju(m.src),(T=l.querySelector(th(C)))?(u.instance=T,ct(T),T):(b=m,(T=Ea.get(C))&&(b=p({},m),Zv(b,T)),l=l.ownerDocument||l,T=l.createElement("script"),ct(T),Hn(T,"link",b),l.head.appendChild(T),u.instance=T);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(b=u.instance,u.state.loading|=4,gm(b,m.precedence,l));return u.instance}function gm(l,u,m){for(var b=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),T=b.length?b[b.length-1]:null,C=T,G=0;G<b.length;G++){var le=b[G];if(le.dataset.precedence===u)C=le;else if(C!==T)break}C?C.parentNode.insertBefore(l,C.nextSibling):(u=m.nodeType===9?m.head:m,u.insertBefore(l,u.firstChild))}function Jv(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.title==null&&(l.title=u.title)}function Zv(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.integrity==null&&(l.integrity=u.integrity)}var ym=null;function cC(l,u,m){if(ym===null){var b=new Map,T=ym=new Map;T.set(m,b)}else T=ym,b=T.get(m),b||(b=new Map,T.set(m,b));if(b.has(l))return b;for(b.set(l,null),m=m.getElementsByTagName(l),T=0;T<m.length;T++){var C=m[T];if(!(C[Oe]||C[de]||l==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var G=C.getAttribute(u)||"";G=l+G;var le=b.get(G);le?le.push(C):b.set(G,[C])}}return b}function uC(l,u,m){l=l.ownerDocument||l,l.head.insertBefore(m,u==="title"?l.querySelector("head > title"):null)}function p7(l,u,m){if(m===1||u.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return l=u.disabled,typeof u.precedence=="string"&&l==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function fC(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}function m7(l,u,m,b){if(m.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var T=Yu(b.href),C=u.querySelector(eh(T));if(C){u=C._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(l.count++,l=vm.bind(l),u.then(l,l)),m.state.loading|=4,m.instance=C,ct(C);return}C=u.ownerDocument||u,b=oC(b),(T=Ea.get(T))&&Jv(b,T),C=C.createElement("link"),ct(C);var G=C;G._p=new Promise(function(le,we){G.onload=le,G.onerror=we}),Hn(C,"link",b),m.instance=C}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(m,u),(u=m.state.preload)&&(m.state.loading&3)===0&&(l.count++,m=vm.bind(l),u.addEventListener("load",m),u.addEventListener("error",m))}}var Qv=0;function x7(l,u){return l.stylesheets&&l.count===0&&wm(l,l.stylesheets),0<l.count||0<l.imgCount?function(m){var b=setTimeout(function(){if(l.stylesheets&&wm(l,l.stylesheets),l.unsuspend){var C=l.unsuspend;l.unsuspend=null,C()}},6e4+u);0<l.imgBytes&&Qv===0&&(Qv=62500*Y9());var T=setTimeout(function(){if(l.waitingForImages=!1,l.count===0&&(l.stylesheets&&wm(l,l.stylesheets),l.unsuspend)){var C=l.unsuspend;l.unsuspend=null,C()}},(l.imgBytes>Qv?50:800)+u);return l.unsuspend=m,function(){l.unsuspend=null,clearTimeout(b),clearTimeout(T)}}:null}function vm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)wm(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var bm=null;function wm(l,u){l.stylesheets=null,l.unsuspend!==null&&(l.count++,bm=new Map,u.forEach(g7,l),bm=null,vm.call(l))}function g7(l,u){if(!(u.state.loading&4)){var m=bm.get(l);if(m)var b=m.get(null);else{m=new Map,bm.set(l,m);for(var T=l.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<T.length;C++){var G=T[C];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(m.set(G.dataset.precedence,G),b=G)}b&&m.set(null,b)}T=u.instance,G=T.getAttribute("data-precedence"),C=m.get(G)||b,C===b&&m.set(null,T),m.set(G,T),this.count++,b=vm.bind(this),T.addEventListener("load",b),T.addEventListener("error",b),C?C.parentNode.insertBefore(T,C.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(T,l.firstChild)),u.state.loading|=4}}var rh={$$typeof:E,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function y7(l,u,m,b,T,C,G,le,we){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xi(0),this.hiddenUpdates=xi(null),this.identifierPrefix=b,this.onUncaughtError=T,this.onCaughtError=C,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=we,this.incompleteTransitions=new Map}function dC(l,u,m,b,T,C,G,le,we,ke,Ue,Ve){return l=new y7(l,u,m,G,we,ke,Ue,Ve,le),u=1,C===!0&&(u|=24),C=Ks(3,null,null,u),l.current=C,C.stateNode=l,u=Oy(),u.refCount++,l.pooledCache=u,u.refCount++,C.memoizedState={element:b,isDehydrated:m,cache:u},Fy(C),l}function hC(l){return l?(l=Au,l):Au}function pC(l,u,m,b,T,C){T=hC(T),b.context===null?b.context=T:b.pendingContext=T,b=Qo(u),b.payload={element:m},C=C===void 0?null:C,C!==null&&(b.callback=C),m=el(l,b,u),m!==null&&(Is(m,l,u),Id(m,l,u))}function mC(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<u?m:u}}function eb(l,u){mC(l,u),(l=l.alternate)&&mC(l,u)}function xC(l){if(l.tag===13||l.tag===31){var u=sc(l,67108864);u!==null&&Is(u,l,67108864),eb(l,67108864)}}function gC(l){if(l.tag===13||l.tag===31){var u=Qs();u=Wo(u);var m=sc(l,u);m!==null&&Is(m,l,u),eb(l,u)}}var _m=!0;function v7(l,u,m,b){var T=te.T;te.T=null;var C=Y.p;try{Y.p=2,tb(l,u,m,b)}finally{Y.p=C,te.T=T}}function b7(l,u,m,b){var T=te.T;te.T=null;var C=Y.p;try{Y.p=8,tb(l,u,m,b)}finally{Y.p=C,te.T=T}}function tb(l,u,m,b){if(_m){var T=rb(b);if(T===null)zv(l,u,b,Em,m),vC(l,b);else if(_7(T,l,u,m,b))b.stopPropagation();else if(vC(l,b),u&4&&-1<w7.indexOf(l)){for(;T!==null;){var C=nt(T);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var G=nn(C.pendingLanes);if(G!==0){var le=C;for(le.pendingLanes|=2,le.entangledLanes|=2;G;){var we=1<<31-lr(G);le.entanglements[1]|=we,G&=~we}wi(C),(Jt&6)===0&&(am=De()+500,Yd(0))}}break;case 31:case 13:le=sc(C,2),le!==null&&Is(le,C,2),om(),eb(C,2)}if(C=rb(b),C===null&&zv(l,u,b,Em,m),C===T)break;T=C}T!==null&&b.stopPropagation()}else zv(l,u,b,null,m)}}function rb(l){return l=sy(l),nb(l)}var Em=null;function nb(l){if(Em=null,l=Ze(l),l!==null){var u=a(l);if(u===null)l=null;else{var m=u.tag;if(m===13){if(l=i(u),l!==null)return l;l=null}else if(m===31){if(l=o(u),l!==null)return l;l=null}else if(m===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null)}}return Em=l,null}function yC(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fe()){case Ke:return 2;case st:return 8;case at:case Gt:return 32;case dt:return 268435456;default:return 32}default:return 32}}var sb=!1,fl=null,dl=null,hl=null,nh=new Map,sh=new Map,pl=[],w7="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vC(l,u){switch(l){case"focusin":case"focusout":fl=null;break;case"dragenter":case"dragleave":dl=null;break;case"mouseover":case"mouseout":hl=null;break;case"pointerover":case"pointerout":nh.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":sh.delete(u.pointerId)}}function ah(l,u,m,b,T,C){return l===null||l.nativeEvent!==C?(l={blockedOn:u,domEventName:m,eventSystemFlags:b,nativeEvent:C,targetContainers:[T]},u!==null&&(u=nt(u),u!==null&&xC(u)),l):(l.eventSystemFlags|=b,u=l.targetContainers,T!==null&&u.indexOf(T)===-1&&u.push(T),l)}function _7(l,u,m,b,T){switch(u){case"focusin":return fl=ah(fl,l,u,m,b,T),!0;case"dragenter":return dl=ah(dl,l,u,m,b,T),!0;case"mouseover":return hl=ah(hl,l,u,m,b,T),!0;case"pointerover":var C=T.pointerId;return nh.set(C,ah(nh.get(C)||null,l,u,m,b,T)),!0;case"gotpointercapture":return C=T.pointerId,sh.set(C,ah(sh.get(C)||null,l,u,m,b,T)),!0}return!1}function bC(l){var u=Ze(l.target);if(u!==null){var m=a(u);if(m!==null){if(u=m.tag,u===13){if(u=i(m),u!==null){l.blockedOn=u,xe(l.priority,function(){gC(m)});return}}else if(u===31){if(u=o(m),u!==null){l.blockedOn=u,xe(l.priority,function(){gC(m)});return}}else if(u===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Sm(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var m=rb(l.nativeEvent);if(m===null){m=l.nativeEvent;var b=new m.constructor(m.type,m);ny=b,m.target.dispatchEvent(b),ny=null}else return u=nt(m),u!==null&&xC(u),l.blockedOn=m,!1;u.shift()}return!0}function wC(l,u,m){Sm(l)&&m.delete(u)}function E7(){sb=!1,fl!==null&&Sm(fl)&&(fl=null),dl!==null&&Sm(dl)&&(dl=null),hl!==null&&Sm(hl)&&(hl=null),nh.forEach(wC),sh.forEach(wC)}function Nm(l,u){l.blockedOn===u&&(l.blockedOn=null,sb||(sb=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,E7)))}var Tm=null;function _C(l){Tm!==l&&(Tm=l,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Tm===l&&(Tm=null);for(var u=0;u<l.length;u+=3){var m=l[u],b=l[u+1],T=l[u+2];if(typeof b!="function"){if(nb(b||m)===null)continue;break}var C=nt(m);C!==null&&(l.splice(u,3),u-=3,rv(C,{pending:!0,data:T,method:m.method,action:b},b,T))}}))}function Zu(l){function u(we){return Nm(we,l)}fl!==null&&Nm(fl,l),dl!==null&&Nm(dl,l),hl!==null&&Nm(hl,l),nh.forEach(u),sh.forEach(u);for(var m=0;m<pl.length;m++){var b=pl[m];b.blockedOn===l&&(b.blockedOn=null)}for(;0<pl.length&&(m=pl[0],m.blockedOn===null);)bC(m),m.blockedOn===null&&pl.shift();if(m=(l.ownerDocument||l).$$reactFormReplay,m!=null)for(b=0;b<m.length;b+=3){var T=m[b],C=m[b+1],G=T[me]||null;if(typeof C=="function")G||_C(m);else if(G){var le=null;if(C&&C.hasAttribute("formAction")){if(T=C,G=C[me]||null)le=G.formAction;else if(nb(T)!==null)continue}else le=G.action;typeof le=="function"?m[b+1]=le:(m.splice(b,3),b-=3),_C(m)}}}function EC(){function l(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(G){return T=G})},focusReset:"manual",scroll:"manual"})}function u(){T!==null&&(T(),T=null),b||setTimeout(m,20)}function m(){if(!b&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var b=!1,T=null;return navigation.addEventListener("navigate",l),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(m,100),function(){b=!0,navigation.removeEventListener("navigate",l),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),T!==null&&(T(),T=null)}}}function ab(l){this._internalRoot=l}km.prototype.render=ab.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(n(409));var m=u.current,b=Qs();pC(m,b,l,u,null,null)},km.prototype.unmount=ab.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;pC(l.current,2,null,l,null,null),om(),u[ge]=null}};function km(l){this._internalRoot=l}km.prototype.unstable_scheduleHydration=function(l){if(l){var u=ae();l={blockedOn:null,target:l,priority:u};for(var m=0;m<pl.length&&u!==0&&u<pl[m].priority;m++);pl.splice(m,0,l),m===0&&bC(l)}};var SC=t.version;if(SC!=="19.2.4")throw Error(n(527,SC,"19.2.4"));Y.findDOMNode=function(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=f(u),l=l!==null?h(l):null,l=l===null?null:l.stateNode,l};var S7={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Am=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Am.isDisabled&&Am.supportsFiber)try{vt=Am.inject(S7),or=Am}catch{}}return oh.createRoot=function(l,u){if(!s(l))throw Error(n(299));var m=!1,b="",T=jk,C=Ok,G=Dk;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onUncaughtError!==void 0&&(T=u.onUncaughtError),u.onCaughtError!==void 0&&(C=u.onCaughtError),u.onRecoverableError!==void 0&&(G=u.onRecoverableError)),u=dC(l,1,!1,null,null,m,b,null,T,C,G,EC),l[ge]=u.current,Uv(l),new ab(u)},oh.hydrateRoot=function(l,u,m){if(!s(l))throw Error(n(299));var b=!1,T="",C=jk,G=Ok,le=Dk,we=null;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(T=m.identifierPrefix),m.onUncaughtError!==void 0&&(C=m.onUncaughtError),m.onCaughtError!==void 0&&(G=m.onCaughtError),m.onRecoverableError!==void 0&&(le=m.onRecoverableError),m.formState!==void 0&&(we=m.formState)),u=dC(l,1,!0,u,m??null,b,T,we,C,G,le,EC),u.context=hC(null),m=u.current,b=Qs(),b=Wo(b),T=Qo(b),T.callback=null,el(m,T,b),m=b,u.current.lanes=m,br(u,m),wi(u),l[ge]=u.current,Uv(l),new km(u)},oh.version="19.2.4",oh}var IC;function D7(){if(IC)return lb.exports;IC=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),lb.exports=O7(),lb.exports}var I7=D7();const M7=bE(I7),F7="Logging",P7="NoHubcallbackProvidedException";var ta;(function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"})(ta||(ta={}));const MC={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class oa{constructor(t,r=ta.WARN){this.name=t,this.level=r,this._pluggables=[]}_padding(t){return t<10?"0"+t:""+t}_ts(){const t=new Date;return[this._padding(t.getMinutes()),this._padding(t.getSeconds())].join(":")+"."+t.getMilliseconds()}configure(t){return t?(this._config=t,this._config):this._config}_log(t,...r){let n=this.level;oa.LOG_LEVEL&&(n=oa.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(n=window.LOG_LEVEL);const s=MC[n];if(!(MC[t]>=s))return;let i=console.log.bind(console);t===ta.ERROR&&console.error&&(i=console.error.bind(console)),t===ta.WARN&&console.warn&&(i=console.warn.bind(console)),oa.BIND_ALL_LOG_LEVELS&&(t===ta.INFO&&console.info&&(i=console.info.bind(console)),t===ta.DEBUG&&console.debug&&(i=console.debug.bind(console)));const o=`[${t}] ${this._ts()} ${this.name}`;let c="";if(r.length===1&&typeof r[0]=="string")c=`${o} - ${r[0]}`,i(c);else if(r.length===1)c=`${o} ${r[0]}`,i(o,r[0]);else if(typeof r[0]=="string"){let f=r.slice(1);f.length===1&&(f=f[0]),c=`${o} - ${r[0]} ${f}`,i(`${o} - ${r[0]}`,f)}else c=`${o} ${r}`,i(o,r);for(const f of this._pluggables){const h={message:c,timestamp:Date.now()};f.pushLogs([h])}}log(...t){this._log(ta.INFO,...t)}info(...t){this._log(ta.INFO,...t)}warn(...t){this._log(ta.WARN,...t)}error(...t){this._log(ta.ERROR,...t)}debug(...t){this._log(ta.DEBUG,...t)}verbose(...t){this._log(ta.VERBOSE,...t)}addPluggable(t){t&&t.getCategoryName()===F7&&(this._pluggables.push(t),t.configure(this._config))}listPluggables(){return this._pluggables}}oa.LOG_LEVEL=null;oa.BIND_ALL_LOG_LEVELS=!1;class Hs extends Error{constructor({message:t,name:r,recoverySuggestion:n,underlyingError:s,metadata:a}){if(super(t),this.name=r,this.underlyingError=s,this.recoverySuggestion=n,a){const{extendedRequestId:i,httpStatusCode:o,requestId:c}=a;this.metadata={extendedRequestId:i,httpStatusCode:o,requestId:c}}this.constructor=Hs,Object.setPrototypeOf(this,Hs.prototype)}}var qc;(function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"})(qc||(qc={}));const wE=(e,t=Hs)=>(r,n,s)=>{const{message:a,recoverySuggestion:i}=e[n];if(!r)throw new t({name:n,message:s?`${a} ${s}`:a,recoverySuggestion:i})},Wc=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",lh=new oa("Hub");class CO{constructor(t){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}_remove(t,r){const n=this.listeners.get(t);if(!n){lh.warn(`No listeners for ${t}`);return}this.listeners.set(t,[...n.filter(({callback:s})=>s!==r)])}dispatch(t,r,n,s){typeof t=="string"&&this.protectedChannels.indexOf(t)>-1&&(s===Wc||lh.warn(`WARNING: ${t} is protected and dispatching on it can have unintended consequences`));const a={channel:t,payload:{...r},source:n,patternInfo:[]};try{this._toListeners(a)}catch(i){lh.error(i)}}listen(t,r,n="noname"){let s;if(typeof r!="function")throw new Hs({name:P7,message:"No callback supplied to Hub"});s=r;let a=this.listeners.get(t);return a||(a=[],this.listeners.set(t,a)),a.push({name:n,callback:s}),()=>{this._remove(t,s)}}_toListeners(t){const{channel:r,payload:n}=t,s=this.listeners.get(r);s&&s.forEach(a=>{lh.debug(`Dispatching to ${r} with `,n);try{a.callback(t)}catch(i){lh.error(i)}})}}const Sf=new CO("__default__"),Ux=new CO("internal-hub"),L7=()=>{if(typeof window=="object"&&typeof window.crypto=="object")return window.crypto;if(typeof crypto=="object")return crypto;throw new Hs({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},B7=()=>{if(typeof window<"u"&&typeof window.btoa=="function")return window.btoa;if(typeof btoa=="function")return btoa;throw new Hs({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})},U7=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new Hs({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},_E={convert(e,t){let r=e;return t!=null&&t.urlSafe&&(r=r.replace(/-/g,"+").replace(/_/g,"/")),U7()(r)}};var Mi;(function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"})(Mi||(Mi={}));const z7={[Mi.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[Mi.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[Mi.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[Mi.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[Mi.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},EE=wE(z7);function Zt(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,EE(t,Mi.AuthUserPoolException)}function RO(e){var r,n,s,a,i,o,c,f;const t=!!((n=(r=e==null?void 0:e.loginWith)==null?void 0:r.oauth)!=null&&n.domain)&&!!((a=(s=e==null?void 0:e.loginWith)==null?void 0:s.oauth)!=null&&a.redirectSignOut)&&!!((o=(i=e==null?void 0:e.loginWith)==null?void 0:i.oauth)!=null&&o.redirectSignIn)&&!!((f=(c=e==null?void 0:e.loginWith)==null?void 0:c.oauth)!=null&&f.responseType);EE(t,Mi.OAuthNotConfigureException)}function wx(e){const t=!!(e!=null&&e.identityPoolId);EE(t,Mi.InvalidIdentityPoolIdException)}function $c(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(_E.convert(n).split("").map(i=>`%${`00${i.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),a=JSON.parse(s);return{toString:()=>e,payload:a}}catch{throw new Error("Invalid token payload")}}const jO=e=>{const t=Reflect.ownKeys(e);for(const r of t){const n=e[r];(n&&typeof n=="object"||typeof n=="function")&&jO(n)}return Object.freeze(e)},H7=new oa("parseAWSExports"),V7={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},q7=(e={})=>{var W,J,re,U,L,se;if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new Hs({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:r,aws_appsync_graphqlEndpoint:n,aws_appsync_region:s,aws_bots_config:a,aws_cognito_identity_pool_id:i,aws_cognito_sign_up_verification_method:o,aws_cognito_mfa_configuration:c,aws_cognito_mfa_types:f,aws_cognito_password_protection_settings:h,aws_cognito_verification_mechanisms:p,aws_cognito_signup_attributes:x,aws_cognito_social_providers:g,aws_cognito_username_attributes:v,aws_mandatory_sign_in:y,aws_mobile_analytics_app_id:w,aws_mobile_analytics_app_region:_,aws_user_files_s3_bucket:S,aws_user_files_s3_bucket_region:E,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:N,aws_user_pools_id:k,aws_user_pools_web_client_id:O,geo:R,oauth:V,predictions:I,aws_cloud_logic_custom:Z,Notifications:ce,modelIntrospection:F}=e,X={};w&&(X.Analytics={Pinpoint:{appId:w,region:_}});const{InAppMessaging:P,Push:ie}=ce??{};if(P!=null&&P.AWSPinpoint||ie!=null&&ie.AWSPinpoint){if(P!=null&&P.AWSPinpoint){const{appId:Q,region:ee}=P.AWSPinpoint;X.Notifications={InAppMessaging:{Pinpoint:{appId:Q,region:ee}}}}if(ie!=null&&ie.AWSPinpoint){const{appId:Q,region:ee}=ie.AWSPinpoint;X.Notifications={...X.Notifications,PushNotification:{Pinpoint:{appId:Q,region:ee}}}}}if(Array.isArray(a)&&(X.Interactions={LexV1:Object.fromEntries(a.map(Q=>[Q.name,Q]))}),n){const Q=V7[r];Q||H7.debug(`Invalid authentication type ${r}. Falling back to IAM.`),X.API={GraphQL:{endpoint:n,apiKey:t,region:s,defaultAuthMode:Q??"iam"}},F&&(X.API.GraphQL.modelIntrospection=F)}const te=c?{status:c&&c.toLowerCase(),totpEnabled:(f==null?void 0:f.includes("TOTP"))??!1,smsEnabled:(f==null?void 0:f.includes("SMS"))??!1}:void 0,Y=h?{minLength:h.passwordPolicyMinLength,requireLowercase:((W=h.passwordPolicyCharacters)==null?void 0:W.includes("REQUIRES_LOWERCASE"))??!1,requireUppercase:((J=h.passwordPolicyCharacters)==null?void 0:J.includes("REQUIRES_UPPERCASE"))??!1,requireNumbers:((re=h.passwordPolicyCharacters)==null?void 0:re.includes("REQUIRES_NUMBERS"))??!1,requireSpecialCharacters:((U=h.passwordPolicyCharacters)==null?void 0:U.includes("REQUIRES_SYMBOLS"))??!1}:void 0,oe=Array.from(new Set([...p??[],...x??[]])).reduce((Q,ee)=>({...Q,[ee.toLowerCase()]:{required:!0}}),{}),Ee=(v==null?void 0:v.includes("EMAIL"))??!1,K=(v==null?void 0:v.includes("PHONE_NUMBER"))??!1;(i||k)&&(X.Auth={Cognito:{identityPoolId:i,allowGuestAccess:y!=="enable",signUpVerificationMethod:o,userAttributes:oe,userPoolClientId:O,userPoolId:k,mfa:te,passwordFormat:Y,loginWith:{username:!(Ee||K),email:Ee,phone:K}}});const D=V?Object.keys(V).length>0:!1,q=g?g.length>0:!1;if(X.Auth&&D&&(X.Auth.Cognito.loginWith={...X.Auth.Cognito.loginWith,oauth:{...W7(V),...q&&{providers:$7(g)}}}),S&&(X.Storage={S3:{bucket:S,region:E,dangerouslyConnectToHttpEndpointForTesting:N}}),R){const{amazon_location_service:Q}=R;X.Geo={LocationService:{maps:Q.maps,geofenceCollections:Q.geofenceCollections,searchIndices:Q.search_indices,region:Q.region}}}if(Z&&(X.API={...X.API,REST:Z.reduce((Q,ee)=>{const{name:B,endpoint:be,region:z,service:he}=ee;return{...Q,[B]:{endpoint:be,...he?{service:he}:void 0,...z?{region:z}:void 0}}},{})}),I){const{VoiceId:Q}=((se=(L=I==null?void 0:I.convert)==null?void 0:L.speechGenerator)==null?void 0:se.defaults)??{};X.Predictions=Q?{...I,convert:{...I.convert,speechGenerator:{...I.convert.speechGenerator,defaults:{voiceId:Q}}}}:I}return X},FC=e=>(e==null?void 0:e.split(","))??[],W7=({domain:e,scope:t,redirectSignIn:r,redirectSignOut:n,responseType:s})=>({domain:e,scopes:t,redirectSignIn:FC(r),redirectSignOut:FC(n),responseType:s}),$7=e=>e.map(t=>{const r=t.toLowerCase();return r.charAt(0).toUpperCase()+r.slice(1)}),G7=Symbol("oauth-listener"),Vn=[];for(let e=0;e<256;++e)Vn.push((e+256).toString(16).slice(1));function K7(e,t=0){return(Vn[e[t+0]]+Vn[e[t+1]]+Vn[e[t+2]]+Vn[e[t+3]]+"-"+Vn[e[t+4]]+Vn[e[t+5]]+"-"+Vn[e[t+6]]+Vn[e[t+7]]+"-"+Vn[e[t+8]]+Vn[e[t+9]]+"-"+Vn[e[t+10]]+Vn[e[t+11]]+Vn[e[t+12]]+Vn[e[t+13]]+Vn[e[t+14]]+Vn[e[t+15]]).toLowerCase()}let db;const X7=new Uint8Array(16);function Y7(){if(!db){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");db=crypto.getRandomValues.bind(crypto)}return db(X7)}const J7=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),PC={randomUUID:J7};function Z7(e,t,r){var s;if(PC.randomUUID&&!t&&!e)return PC.randomUUID();e=e||{};const n=e.random??((s=e.rng)==null?void 0:s.call(e))??Y7();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){if(r=r||0,r<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let a=0;a<16;++a)t[r+a]=n[a];return t}return K7(n)}function Q7(e){const{version:t}=e;return t?t.startsWith("1"):!1}function eU(e){if(!e)return;const{bucket_name:t,aws_region:r,buckets:n}=e;return{S3:{bucket:t,region:r,buckets:n&&fU(n)}}}function tU(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:r,identity_pool_id:n,password_policy:s,mfa_configuration:a,mfa_methods:i,unauthenticated_identities_enabled:o,oauth:c,username_attributes:f,standard_required_attributes:h,groups:p,passwordless_options:x}=e,g={Cognito:{userPoolId:t,userPoolClientId:r,groups:p}};return n&&(g.Cognito={...g.Cognito,identityPoolId:n}),s&&(g.Cognito.passwordFormat={requireLowercase:s.require_lowercase,requireNumbers:s.require_numbers,requireUppercase:s.require_uppercase,requireSpecialCharacters:s.require_symbols,minLength:s.min_length??6}),a&&(g.Cognito.mfa={status:uU(a),smsEnabled:i==null?void 0:i.includes("SMS"),totpEnabled:i==null?void 0:i.includes("TOTP")}),o&&(g.Cognito.allowGuestAccess=o),c&&(g.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:c.response_type==="token"?"token":"code",scopes:c.scopes,providers:cU(c.identity_providers)}}),f&&(g.Cognito.loginWith={...g.Cognito.loginWith,email:f.includes("email"),phone:f.includes("phone_number"),username:f.includes("username")}),h&&(g.Cognito.userAttributes=h.reduce((v,y)=>({...v,[y]:{required:!0}}),{})),x&&(g.Cognito.passwordless={emailOtpEnabled:x.email_otp_enabled,smsOtpEnabled:x.sms_otp_enabled,webAuthn:x.web_authn?{relyingPartyId:x.web_authn.relying_party_id,userVerification:x.web_authn.user_verification}:void 0,preferredChallenge:x.preferred_challenge}),g}function rU(e){if(!(e!=null&&e.amazon_pinpoint))return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}function nU(e){if(!e)return;const{aws_region:t,geofence_collections:r,maps:n,search_indices:s}=e;return{LocationService:{region:t,searchIndices:s,geofenceCollections:r,maps:n}}}function sU(e){if(!e)return;const{aws_region:t,default_authorization_type:r,url:n,api_key:s,model_introspection:a}=e;return{GraphQL:{endpoint:n,defaultAuthMode:OO(r),region:t,apiKey:s,modelIntrospection:a}}}function aU(e){if(!(e!=null&&e.events))return;const{url:t,aws_region:r,api_key:n,default_authorization_type:s}=e.events;return{Events:{endpoint:t,defaultAuthMode:OO(s),region:r,apiKey:n}}}function iU(e){if(!e)return;const{aws_region:t,channels:r,amazon_pinpoint_app_id:n}=e,s=r.includes("IN_APP_MESSAGING"),a=r.includes("APNS")||r.includes("FCM");if(!(s||a))return;const i={};return s&&(i.InAppMessaging={Pinpoint:{appId:n,region:t}}),a&&(i.PushNotification={Pinpoint:{appId:n,region:t}}),i}function oU(e){const t={};if(e.storage&&(t.Storage=eU(e.storage)),e.auth&&(t.Auth=tU(e.auth)),e.analytics&&(t.Analytics=rU(e.analytics)),e.geo&&(t.Geo=nU(e.geo)),e.data&&(t.API=sU(e.data)),e.custom){const r=aU(e.custom);r&&"Events"in r&&(t.API={...t.API,...r})}return e.notifications&&(t.Notifications=iU(e.notifications)),t}const lU={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function OO(e){return lU[e]}const LC={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function cU(e=[]){return e.reduce((t,r)=>(LC[r]!==void 0&&t.push(LC[r]),t),[])}function uU(e){return e==="OPTIONAL"?"optional":e==="REQUIRED"?"on":"off"}function fU(e){const t={};return e.forEach(({name:r,bucket_name:n,aws_region:s,paths:a})=>{if(r in t)throw new Error(`Duplicate friendly name found: ${r}. Name must be unique.`);const i=a?Object.entries(a).reduce((o,[c,f])=>(f!==void 0&&(o[c]=f),o),{}):void 0;t[r]={bucketName:n,region:s,paths:i}}),t}const DO=e=>Object.keys(e).some(t=>t.startsWith("aws_"))?q7(e):Q7(e)?oU(e):e;function dU(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(h){try{f(n.next(h))}catch(p){i(p)}}function c(h){try{f(n.throw(h))}catch(p){i(p)}}function f(h){h.done?a(h.value):s(h.value).then(o,c)}f((n=n.apply(e,t||[])).next())})}function hU(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(f){return function(h){return c([f,h])}}function c(f){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,f[0]&&(r=0)),r;)try{if(n=1,s&&(a=f[0]&2?s.return:f[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,f[1])).done)return a;switch(s=0,a&&(f=[f[0]&2,a.value]),f[0]){case 0:case 1:a=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,s=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!a||f[1]>a[0]&&f[1]<a[3])){r.label=f[1];break}if(f[0]===6&&r.label<a[1]){r.label=a[1],a=f;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(f);break}a[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],s=0}finally{n=a=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var Da=64,pU=32,mU=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xU=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],gU=Math.pow(2,53)-1,_x=(function(){function e(){this.state=Int32Array.from(xU),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var r=0,n=t.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>gU)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=t[r++],n--,this.bufferLength===Da&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(r.setUint8(this.bufferLength++,128),n%Da>=Da-8){for(var s=this.bufferLength;s<Da;s++)r.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<Da-8;s++)r.setUint8(s,0);r.setUint32(Da-8,Math.floor(t/4294967296),!0),r.setUint32(Da-4,t),this.hashBuffer(),this.finished=!0}for(var a=new Uint8Array(pU),s=0;s<8;s++)a[s*4]=this.state[s]>>>24&255,a[s*4+1]=this.state[s]>>>16&255,a[s*4+2]=this.state[s]>>>8&255,a[s*4+3]=this.state[s]>>>0&255;return a},e.prototype.hashBuffer=function(){for(var t=this,r=t.buffer,n=t.state,s=n[0],a=n[1],i=n[2],o=n[3],c=n[4],f=n[5],h=n[6],p=n[7],x=0;x<Da;x++){if(x<16)this.temp[x]=(r[x*4]&255)<<24|(r[x*4+1]&255)<<16|(r[x*4+2]&255)<<8|r[x*4+3]&255;else{var g=this.temp[x-2],v=(g>>>17|g<<15)^(g>>>19|g<<13)^g>>>10;g=this.temp[x-15];var y=(g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3;this.temp[x]=(v+this.temp[x-7]|0)+(y+this.temp[x-16]|0)}var w=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&f^~c&h)|0)+(p+(mU[x]+this.temp[x]|0)|0)|0,_=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&a^s&i^a&i)|0;p=h,h=f,f=c,c=o+w|0,o=i,i=a,a=s,s=w+_|0}n[0]+=s,n[1]+=a,n[2]+=i,n[3]+=o,n[4]+=c,n[5]+=f,n[6]+=h,n[7]+=p},e})();const yU=e=>new TextEncoder().encode(e);var vU=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:yU;function IO(e){return e instanceof Uint8Array?e:typeof e=="string"?vU(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function bU(e){return typeof e=="string"?e.length===0:e.byteLength===0}var zx=(function(){function e(t){this.secret=t,this.hash=new _x,this.reset()}return e.prototype.update=function(t){if(!(bU(t)||this.error))try{this.hash.update(IO(t))}catch(r){this.error=r}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return dU(this,void 0,void 0,function(){return hU(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new _x,this.secret){this.outer=new _x;var t=wU(this.secret),r=new Uint8Array(Da);r.set(t);for(var n=0;n<Da;n++)t[n]^=54,r[n]^=92;this.hash.update(t),this.outer.update(r);for(var n=0;n<t.byteLength;n++)t[n]=0}},e})();function wU(e){var t=IO(e);if(t.byteLength>Da){var r=new _x;r.update(t),t=r.digest()}var n=new Uint8Array(Da);return n.set(t),n}for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`)}var hn;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(hn||(hn={}));var s_;(function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(s_||(s_={}));var BC;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"})(BC||(BC={}));var UC;(function(e){e.Record="1",e.IdentifyUser="2"})(UC||(UC={}));var zC;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(zC||(zC={}));var Ns;(function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"})(Ns||(Ns={}));var HC;(function(e){e.Subscribe="1",e.GraphQl="2"})(HC||(HC={}));var VC;(function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"})(VC||(VC={}));var qC;(function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"})(qC||(qC={}));var WC;(function(e){e.None="0"})(WC||(WC={}));var $C;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})($C||($C={}));var GC;(function(e){e.Subscribe="1"})(GC||(GC={}));var KC;(function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"})(KC||(KC={}));var XC;(function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"})(XC||(XC={}));const _U="6.16.0",t1=()=>typeof global<"u",Yf=()=>typeof window<"u",MO=()=>typeof document<"u",SE=()=>typeof process<"u",r0=(e,t)=>!!Object.keys(e).find(r=>r.startsWith(t));var YC={};function EU(){const e=n=>n.startsWith("_react")||n.startsWith("__react"),t=n=>Object.keys(n).find(e),r=()=>Array.from(document.querySelectorAll("[id]"));return MO()&&r().some(t)}function SU(){return SE()&&typeof YC<"u"&&!!Object.keys(YC).find(e=>e.includes("react"))}function NU(){return Yf()&&r0(window,"__VUE")}function TU(){return t1()&&r0(global,"__VUE")}var JC={};function kU(){return Yf()&&r0(window,"__SVELTE")}function AU(){return SE()&&typeof JC<"u"&&!!Object.keys(JC).find(e=>e.includes("svelte"))}function CU(){return Yf()&&window.next&&typeof window.next=="object"}function RU(){return t1()&&(r0(global,"__next")||r0(global,"__NEXT"))}function jU(){return Yf()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function OU(){return t1()&&typeof global.__NUXT_PATHS__<"u"}var ZC={};function DU(){const e=!!(MO()&&document.querySelector("[ng-version]")),t=!!(Yf()&&typeof window.ng<"u");return e||t}function IU(){var e;return SE()&&typeof ZC=="object"&&((e=ZC.npm_lifecycle_script)==null?void 0:e.startsWith("ng "))||!1}function MU(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function FU(){return t1()&&typeof global.expo<"u"}function PU(){return Yf()}const LU=[{platform:hn.Expo,detectionMethod:FU},{platform:hn.ReactNative,detectionMethod:MU},{platform:hn.NextJs,detectionMethod:CU},{platform:hn.Nuxt,detectionMethod:jU},{platform:hn.Angular,detectionMethod:DU},{platform:hn.React,detectionMethod:EU},{platform:hn.VueJs,detectionMethod:NU},{platform:hn.Svelte,detectionMethod:kU},{platform:hn.WebUnknown,detectionMethod:PU},{platform:hn.NextJsSSR,detectionMethod:RU},{platform:hn.NuxtSSR,detectionMethod:OU},{platform:hn.ReactSSR,detectionMethod:SU},{platform:hn.VueJsSSR,detectionMethod:TU},{platform:hn.AngularSSR,detectionMethod:IU},{platform:hn.SvelteSSR,detectionMethod:AU}];function BU(){var e;return((e=LU.find(t=>t.detectionMethod()))==null?void 0:e.platform)||hn.ServerSideUnknown}let Ih;const hb=[];let a_=!1;const UU=10,zU=10,HU=1e3,FO=()=>{var e;if(!Ih){if(Ih=BU(),a_)for(;hb.length;)(e=hb.pop())==null||e();else hb.forEach(t=>{t()});QC(hn.ServerSideUnknown,UU),QC(hn.WebUnknown,zU)}return Ih};function VU(){Ih=void 0}function QC(e,t){Ih===e&&!a_&&setTimeout(()=>{VU(),a_=!0,setTimeout(FO,HU)},t)}const qU={},WU=(e,t)=>{var r,n;return(n=(r=qU[e])==null?void 0:r[t])==null?void 0:n.additionalDetails},$U="aws-amplify",GU=e=>e.replace(/\+.*/,""),KU=({category:e,action:t}={})=>{const r=[[$U,GU(_U)]];if(e&&r.push([e,t]),r.push(["framework",FO()]),e&&t){const n=WU(e,t);n&&n.forEach(s=>{r.push(s)})}return r},r1=e=>KU(e).map(([n,s])=>n&&s?`${n}/${s}`:n).join(" "),PO=()=>typeof window<"u"&&typeof window.document<"u",e4=new oa("Auth");class XU{configure(t,r){var n,s;this.authConfig=t,this.authOptions=r,t&&((n=t.Cognito)!=null&&n.userPoolEndpoint)&&e4.warn(t4("Amazon Cognito User Pool")),t&&((s=t.Cognito)!=null&&s.identityPoolEndpoint)&&e4.warn(t4("Amazon Cognito Identity Pool"))}async fetchAuthSession(t={}){var a,i,o,c,f,h;let r,n;const s=await this.getTokens(t);return s?(n=(i=(a=s.accessToken)==null?void 0:a.payload)==null?void 0:i.sub,r=await((c=(o=this.authOptions)==null?void 0:o.credentialsProvider)==null?void 0:c.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:s,authenticated:!0,forceRefresh:t.forceRefresh}))):r=await((h=(f=this.authOptions)==null?void 0:f.credentialsProvider)==null?void 0:h.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:t.forceRefresh})),{tokens:s,credentials:r==null?void 0:r.credentials,identityId:r==null?void 0:r.identityId,userSub:n}}async clearCredentials(){var t,r;await((r=(t=this.authOptions)==null?void 0:t.credentialsProvider)==null?void 0:r.clearCredentialsAndIdentityId())}async getTokens(t){var r,n;return await((n=(r=this.authOptions)==null?void 0:r.tokenProvider)==null?void 0:n.getTokens(t))??void 0}}const t4=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;class YU{constructor(){this.oAuthListener=void 0,this.isConfigured=!1,this.resourcesConfig={},this.libraryOptions={},this.Auth=new XU}configure(t,r){var s,a,i,o,c;const n=DO(t);this.resourcesConfig=n,r&&(this.libraryOptions=r),this.resourcesConfig=jO(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),((s=this.resourcesConfig.Analytics)!=null&&s.Pinpoint||(i=(a=this.resourcesConfig.Notifications)==null?void 0:a.InAppMessaging)!=null&&i.Pinpoint||(c=(o=this.resourcesConfig.Notifications)==null?void 0:o.PushNotification)!=null&&c.Pinpoint)&&console.warn("AWS will end support for Amazon Pinpoint on October 30, 2026. The guidance is to use AWS End User Messaging for push notifications and SMS, Amazon Simple Email Service for sending emails, Amazon Connect for campaigns, journeys, endpoints, and engagement analytics. Pinpoint recommends Amazon Kinesis for event collection and mobile analytics."),Sf.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",Wc),this.notifyOAuthListener(),this.isConfigured=!0}getConfig(){return this.isConfigured||console.warn("Amplify has not been configured. Please call Amplify.configure() before using this service."),this.resourcesConfig}[G7](t){var r,n,s;(n=(r=this.resourcesConfig.Auth)==null?void 0:r.Cognito.loginWith)!=null&&n.oauth?t((s=this.resourcesConfig.Auth)==null?void 0:s.Cognito):this.oAuthListener=t}notifyOAuthListener(){var t,r,n;!((r=(t=this.resourcesConfig.Auth)==null?void 0:t.Cognito.loginWith)!=null&&r.oauth)||!this.oAuthListener||(this.oAuthListener((n=this.resourcesConfig.Auth)==null?void 0:n.Cognito),this.oAuthListener=void 0)}}const Sr=new YU,JU=(e,t)=>e.Auth.fetchAuthSession(t),n1=e=>JU(Sr,e);function LO(){return Sr.Auth.clearCredentials()}const s1=e=>{const{headers:t,statusCode:r}=e;return{...ZU(e)?e.$metadata:{},httpStatusCode:r,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},ZU=e=>typeof(e==null?void 0:e.$metadata)=="object",Jf=async e=>{if(!e||e.statusCode<300)return;const t=await M0(e),n=(i=>{const[o]=i.toString().split(/[,:]+/);return o.includes("#")?o.split("#")[1]:o})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),s=t.message??t.Message??"Unknown error",a=new Error(s);return Object.assign(a,{name:n,$metadata:s1(e)})},M0=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:s1(e)})},Ws=(e,t,r,n)=>async(s,a)=>{const i={...n,...s},o=await i.endpointResolver(i,a),c=await t(a,o),f=await e(c,{...i});return r(f)},QU=300*1e3;function ez(e=QU){return n=>{const s=2**n*100+100*Math.random();return s>e?!1:s}}const BO=3,r4="amz-sdk-invocation-id",tz="amz-sdk-request",n4=300*1e3,UO=e=>{const r=ez(n4)(e);return r===!1?n4:r},rz=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],nz=e=>!!e&&rz.includes(e),zO=e=>async(t,r)=>{const n=r??await e(t)??void 0,s=(n==null?void 0:n.code)||(n==null?void 0:n.name),a=t==null?void 0:t.statusCode;return{retryable:oz(r)||iz(a,s)||nz(s)||lz(a,s)}},sz=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],az=["TimeoutError","RequestTimeout","RequestTimeoutException"],iz=(e,t)=>e===429||!!t&&sz.includes(t),oz=e=>[qc.NetworkError,"ERR_NETWORK"].includes(e==null?void 0:e.name),lz=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&az.includes(t),HO="cognito-identity",VO={service:HO,retryDecider:zO(Jf),computeDelay:UO,cache:"no-store"},cz=({maxAttempts:e=BO,retryDecider:t,computeDelay:r,abortSignal:n})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(s,a)=>async function(o){let c,f=a.attemptsCount??0,h;const p=()=>{if(h)return s4(h,f),h;throw s4(c,f),c};for(;!(n!=null&&n.aborted)&&f<e;){try{h=await s(o),c=void 0}catch(v){c=v,h=void 0}f=(a.attemptsCount??0)>f?a.attemptsCount??0:f+1,a.attemptsCount=f;const{isCredentialsExpiredError:x,retryable:g}=await t(h,c,a);if(g){if(a.isCredentialsExpired=!!x,!(n!=null&&n.aborted)&&f<e){const v=r(f);await uz(v,n)}continue}else return p()}if(n!=null&&n.aborted)throw new Error("Request aborted.");return p()}},uz=(e,t)=>{if(t!=null&&t.aborted)return Promise.resolve();let r,n;const s=new Promise(a=>{n=a,r=setTimeout(a,e)});return t==null||t.addEventListener("abort",function a(i){clearTimeout(r),t==null||t.removeEventListener("abort",a),n()}),s},s4=(e,t)=>{Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata={...e.$metadata??{},attempts:t})},fz=Z7,dz=()=>e=>async function(r){return r.headers[r4]||(r.headers[r4]=fz()),e(r)},hz=({maxAttempts:e=BO})=>(t,r)=>async function(s){const a=r.attemptsCount??0;return s.headers[tz]=`attempt=${a+1}; max=${e}`,t(s)},pz=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>r=>async function(s){if(t.trim().length===0)return await r(s);{const a=e.toLowerCase();return s.headers[a]=s.headers[a]?`${s.headers[a]} ${t}`:t,await r(s)}},NE=(e,t)=>(r,n)=>{const s={};let a=i=>e(i,n);for(let i=t.length-1;i>=0;i--){const o=t[i];a=o(n)(a,s)}return a(r)},pb=e=>{let t;return()=>(t||(t=e()),t)},mz=e=>!["HEAD","GET"].includes(e.toUpperCase()),xz=async({url:e,method:t,headers:r,body:n},{abortSignal:s,cache:a,withCrossDomainCredentials:i})=>{var p;let o;try{o=await fetch(e,{method:t,headers:r,body:mz(t)?n:void 0,signal:s,cache:a,credentials:i?"include":"same-origin"})}catch(x){throw x instanceof TypeError?new Hs({name:qc.NetworkError,message:"A network error has occurred.",underlyingError:x}):x}const c={};(p=o.headers)==null||p.forEach((x,g)=>{c[g.toLowerCase()]=x});const f={statusCode:o.status,headers:c,body:null},h=Object.assign(o.body??{},{text:pb(()=>o.text()),blob:pb(()=>o.blob()),json:pb(()=>o.json())});return{...f,body:h}},qO=NE(xz,[pz,dz,cz,hz]),gz=()=>e=>async function(r){return r.headers["cache-control"]="no-store",e(r)},WO=NE(qO,[gz]),$O=e=>(t,r)=>{const n=yz(e),s=JSON.stringify(t);return vz(r,n,s)},yz=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),vz=({url:e},t,r)=>({headers:t,url:e,body:r,method:"POST"}),a4=e=>Ws(WO,$O("GetCredentialsForIdentity"),bz,{...VO,...e,userAgentValue:r1()}),bz=async e=>{if(e.statusCode>=300)throw await Jf(e);const t=await M0(e);return{IdentityId:t.IdentityId,Credentials:wz(t.Credentials),$metadata:s1(e)}},wz=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(e*1e3)}),_z=e=>Ws(WO,$O("GetId"),Ez,{...VO,...e,userAgentValue:r1()}),Ez=async e=>{if(e.statusCode>=300)throw await Jf(e);return{IdentityId:(await M0(e)).IdentityId,$metadata:s1(e)}},GO={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Sz={partitions:[GO,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},KO=e=>{const{partitions:t}=Sz;for(const{regions:r,outputs:n,regionRegex:s}of t){const a=new RegExp(s);if(r.includes(e)||a.test(e))return n.dnsSuffix}return GO.outputs.dnsSuffix},F0=URL,Nz=({region:e})=>({url:new F0(`https://${HO}.${e}.${KO(e)}`)});class Sh extends Hs{constructor(){super({name:qc.PlatformNotSupported,message:"Function not supported on current platform"})}}class XO{constructor(t){this.storage=t}async setItem(t,r){if(!this.storage)throw new Sh;this.storage.setItem(t,r)}async getItem(t){if(!this.storage)throw new Sh;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new Sh;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new Sh;this.storage.clear()}}class YO{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,r){this.storage.set(t,r)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}const JO=new oa("CoreStorageUtils"),Tz=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{JO.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new YO},ZO=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return JO.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new YO}};class kz extends XO{constructor(){super(Tz())}}class Az extends XO{constructor(){super(ZO())}}class Cz{constructor(t){this._storage=t}get storage(){if(!this._storage)throw new Sh;return this._storage}setItem(t,r){this.storage.setItem(t,r)}getItem(t){return this.storage.getItem(t)}removeItem(t){this.storage.removeItem(t)}clear(){this.storage.clear()}}class Rz extends Cz{constructor(){super(ZO())}}/*! js-cookie v3.0.5 | MIT */function Rm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var jz={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function i_(e,t){function r(s,a,i){if(!(typeof document>"u")){i=Rm({},t,i),typeof i.expires=="number"&&(i.expires=new Date(Date.now()+i.expires*864e5)),i.expires&&(i.expires=i.expires.toUTCString()),s=encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var c in i)i[c]&&(o+="; "+c,i[c]!==!0&&(o+="="+i[c].split(";")[0]));return document.cookie=s+"="+e.write(a,s)+o}}function n(s){if(!(typeof document>"u"||arguments.length&&!s)){for(var a=document.cookie?document.cookie.split("; "):[],i={},o=0;o<a.length;o++){var c=a[o].split("="),f=c.slice(1).join("=");try{var h=decodeURIComponent(c[0]);if(i[h]=e.read(f,h),s===h)break}catch{}}return s?i[s]:i}}return Object.create({set:r,get:n,remove:function(s,a){r(s,"",Rm({},a,{expires:-1}))},withAttributes:function(s){return i_(this.converter,Rm({},this.attributes,s))},withConverter:function(s){return i_(Rm({},this.converter,s),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var jm=i_(jz,{path:"/"});class Oz{constructor(t={}){const{path:r,domain:n,expires:s,sameSite:a,secure:i}=t;if(this.domain=n,this.path=r||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?s:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?i:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!a||!["strict","lax","none"].includes(a))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(a==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=a}}async setItem(t,r){jm.set(t,r,this.getData())}async getItem(t){return jm.get(t)??null}async removeItem(t){jm.remove(t,this.getData())}async clear(){const t=jm.get(),r=Object.keys(t).map(n=>this.removeItem(n));await Promise.all(r)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const P0=new kz;new Az;const wo=new Rz,Dz=e=>{let t;return async(...r)=>t||(t=new Promise((n,s)=>{e(...r).then(a=>{n(a)}).catch(a=>{s(a)}).finally(()=>{t=void 0})}),t)};function i4({expiresAt:e,clockDrift:t,tolerance:r=5e3}){return Date.now()+t+r>e}const Iz=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:r="",model:n="",architecture:s="",fullVersionList:a=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]),i=a.map(c=>`${c.brand}/${c.version}`).join(";");return[t,r,s,n,t,i].filter(c=>c).join(" ")||navigator.userAgent};function Mz(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}const n0={convert(e,t={urlSafe:!1,skipPadding:!1}){const r=typeof e=="string"?e:Mz(e);let n=B7()(r);return t.urlSafe&&(n=n.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(n=n.replace(/=/g,"")),n}};function Fz(){return L7().getRandomValues(new Uint32Array(1))[0]}function Pz(e){const{words:t}=e,{sigBytes:r}=e,n=[];for(let s=0;s<r;s++){const a=t[s>>>2]>>>24-s%4*8&255;n.push((a>>>4).toString(16)),n.push((a&15).toString(16))}return n.join("")}class TE{constructor(t,r){this.words=[];let n=t;n=this.words=n||[],r!==void 0?this.sigBytes=r:this.sigBytes=n.length*4}random(t){const r=[];for(let n=0;n<t;n+=4)r.push(Fz());return new TE(r,t)}toString(){return Pz(this)}}var At;(function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword",e.InvalidPreferredChallenge="InvalidPreferredChallenge"})(At||(At={}));const QO={[At.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[At.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[At.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[At.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[At.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[At.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[At.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[At.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[At.EmptySignInPassword]:{message:"password is required to signIn"},[At.EmptySignInUsername]:{message:"username is required to signIn"},[At.EmptySignUpPassword]:{message:"password is required to signUp"},[At.EmptySignUpUsername]:{message:"username is required to signUp"},[At.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[At.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[At.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[At.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[At.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"},[At.InvalidPreferredChallenge]:{message:"The preferred challenge is not enabled in your backend configuration",recoverySuggestion:"Ensure the authentication method is enabled in your Amplify backend configuration"}};var o4;(function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"})(o4||(o4={}));var Nf;(function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"})(Nf||(Nf={}));class Tt extends Hs{constructor(t){super(t),this.constructor=Tt,Object.setPrototypeOf(this,Tt.prototype)}}function Yr(e,t){const{message:r,recoverySuggestion:n}=QO[t];if(!e)throw new Tt({name:t,message:r,recoverySuggestion:n})}function En(e){const t=e==null?void 0:e.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new Tt({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function o_(e){if(!e||!e.includes(":"))throw new Tt({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}function l_(e){return Object.entries(e).map(([t,r])=>({Name:t,Value:r}))}var l4;(function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"})(l4||(l4={}));var c4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(c4||(c4={}));var u4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(u4||(u4={}));var f4;(function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(f4||(f4={}));var d4;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(d4||(d4={}));var h4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(h4||(h4={}));var p4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(p4||(p4={}));var m4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(m4||(m4={}));var x4;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(x4||(x4={}));var g4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(g4||(g4={}));var y4;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(y4||(y4={}));var v4;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(v4||(v4={}));var b4;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(b4||(b4={}));var w4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"})(w4||(w4={}));var Hx;(function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Hx||(Hx={}));var _4;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(_4||(_4={}));var E4;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(E4||(E4={}));var S4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(S4||(S4={}));var c_;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"})(c_||(c_={}));var N4;(function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(N4||(N4={}));var T4;(function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(T4||(T4={}));var k4;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(k4||(k4={}));var A4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(A4||(A4={}));var C4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(C4||(C4={}));const a1="UserUnAuthenticatedException",Lz="UserAlreadyAuthenticatedException",Bz="DeviceMetadataNotFoundException",Uz="InvalidRedirectException",zz="InvalidAppSchemeException",Hz="InvalidPreferredRedirectUrlException",Vz=new Tt({name:Uz,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."});new Tt({name:zz,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."});new Tt({name:Hz,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});const qz="InvalidOriginException",Wz=new Tt({name:qz,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."}),$z="OAuthSignOutException",Gz="TokenRefreshException",Kz="UnexpectedSignInInterruptionException";function kE(e){if(!e||!e.accessToken)throw new Tt({name:a1,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}function Xz(e){if(!e||!e.idToken)throw new Tt({name:a1,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const Yz=new Tt({name:Gz,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),Jz=new Tt({name:a1,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function e8(e){if(eH(e))throw Yz;if(!Qz(e))throw Jz}function t8(e){if(!e||!e.deviceKey||!e.deviceGroupKey||!e.randomPassword)throw new Tt({name:Bz,message:"Either deviceKey, deviceGroupKey or secretPassword were not found during the sign-in process.",recoverySuggestion:"Make sure to not clear storage after calling the signIn API."})}const Zz={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function r8(e){return(e==null?void 0:e.accessToken)||(e==null?void 0:e.idToken)}function Qz(e){return r8(e)&&(e==null?void 0:e.refreshToken)}function eH(e){return r8(e)&&!(e!=null&&e.refreshToken)}const tH=async e=>{var o,c;const t=(o=e.getConfig().Auth)==null?void 0:o.Cognito;Zt(t);const r=await e.Auth.getTokens({forceRefresh:!1});kE(r);const{"cognito:username":n,sub:s}=((c=r.idToken)==null?void 0:c.payload)??{},a={username:n,userId:s},i=rH(r);return i&&(a.signInDetails=i),a};function rH(e){return e==null?void 0:e.signInDetails}const n8=async()=>tH(Sr),ua=(e,t)=>r1({category:s_.Auth,action:e,...t}),Wa=e=>(t,r)=>{const n=nH(e),s=JSON.stringify(t);return sH(r,n,s)},nH=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),sH=({url:e},t,r)=>({headers:t,url:e,body:r,method:"POST"});function fi(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new Tt({name:qc.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const di=()=>async e=>{if(e.statusCode>=300){const t=await Jf(e);throw fi(t),new Tt({name:t.name,message:t.message,metadata:t.$metadata})}return M0(e)},aH=()=>(e,t)=>async function(n){return n.headers["cache-control"]="no-store",e(n)},$a=NE(qO,[aH]),s8="cognito-idp",Ga={service:s8,retryDecider:zO(Jf),computeDelay:UO,get userAgentValue(){return r1()},cache:"no-store"},L0=e=>Ws($a,Wa("InitiateAuth"),di(),{...Ga,...e}),i1=e=>Ws($a,Wa("RespondToAuthChallenge"),di(),{...Ga,...e}),iH=e=>Ws($a,Wa("AssociateSoftwareToken"),di(),{...Ga,...e}),oH=({region:e})=>({url:new F0(`https://${s8}.${e}.${KO(e)}`)}),Sn=({endpointOverride:e})=>t=>e?{url:new F0(e)}:oH(t),lH=e=>Ws($a,Wa("GetTokensFromRefreshToken"),di(),{...Ga,...e}),cH=async({tokens:e,authConfig:t,username:r,clientMetadata:n})=>{var v;Zt(t==null?void 0:t.Cognito);const{userPoolId:s,userPoolClientId:a,userPoolEndpoint:i}=t.Cognito,o=En(s);e8(e);const c=lH({endpointResolver:Sn({endpointOverride:i})}),{AuthenticationResult:f}=await c({region:o},{ClientId:a,RefreshToken:e.refreshToken,DeviceKey:(v=e.deviceMetadata)==null?void 0:v.deviceKey,ClientMetadata:n}),h=$c((f==null?void 0:f.AccessToken)??""),p=f!=null&&f.IdToken?$c(f.IdToken):void 0,{iat:x}=h.payload;if(!x)throw new Tt({name:"iatNotFoundException",message:"iat not found in access token"});const g=x*1e3-new Date().getTime();return{accessToken:h,idToken:p,clockDrift:g,refreshToken:(f==null?void 0:f.RefreshToken)??e.refreshToken,username:r}},uH=Dz(cH),fH={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var Vx;(function(e){e.InvalidAuthTokens="InvalidAuthTokens"})(Vx||(Vx={}));const dH={[Vx.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},hH=wE(dH),R4="CognitoIdentityServiceProvider";class pH{getKeyValueStorage(){if(!this.keyValueStorage)throw new Tt({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{const t=await this.getAuthKeys(),r=await this.getKeyValueStorage().getItem(t.accessToken);if(!r)throw new Tt({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const n=$c(r),s=await this.getKeyValueStorage().getItem(t.idToken),a=s?$c(s):void 0,i=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,o=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",c=Number.parseInt(o),f=await this.getKeyValueStorage().getItem(t.signInDetails),h={accessToken:n,idToken:a,refreshToken:i,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:c,username:await this.getLastAuthUser()};return f&&(h.signInDetails=JSON.parse(f)),h}catch{return null}}async storeTokens(t){hH(t!==void 0,Vx.InvalidAuthTokens);const r=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),r);const n=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n.accessToken,t.accessToken.toString()),t.idToken?await this.getKeyValueStorage().setItem(n.idToken,t.idToken.toString()):await this.getKeyValueStorage().removeItem(n.idToken),t.refreshToken?await this.getKeyValueStorage().setItem(n.refreshToken,t.refreshToken):await this.getKeyValueStorage().removeItem(n.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(n.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(n.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(n.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails?await this.getKeyValueStorage().setItem(n.signInDetails,JSON.stringify(t.signInDetails)):await this.getKeyValueStorage().removeItem(n.signInDetails),await this.getKeyValueStorage().setItem(n.clockDrift,`${t.clockDrift}`)}async clearTokens(){const t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(t.oauthMetadata)])}async getDeviceMetadata(t){const r=await this.getAuthKeys(t),n=await this.getKeyValueStorage().getItem(r.deviceKey),s=await this.getKeyValueStorage().getItem(r.deviceGroupKey),a=await this.getKeyValueStorage().getItem(r.randomPasswordKey);return a&&s&&n?{deviceKey:n,deviceGroupKey:s,randomPassword:a}:null}async clearDeviceMetadata(t){const r=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(r.deviceKey),this.getKeyValueStorage().removeItem(r.deviceGroupKey),this.getKeyValueStorage().removeItem(r.randomPasswordKey)])}async getAuthKeys(t){var n;Zt((n=this.authConfig)==null?void 0:n.Cognito);const r=t??await this.getLastAuthUser();return mH(R4,`${this.authConfig.Cognito.userPoolClientId}.${r}`)}getLastAuthUserKey(){var r;Zt((r=this.authConfig)==null?void 0:r.Cognito);const t=this.authConfig.Cognito.userPoolClientId;return`${R4}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(t){const{oauthMetadata:r}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(r,JSON.stringify(t))}async getOAuthMetadata(){const{oauthMetadata:t}=await this.getAuthKeys(),r=await this.getKeyValueStorage().getItem(t);return r&&JSON.parse(r)}}const mH=(e,t)=>AE(fH)(`${e}`,t);function AE(e){const t=Object.values({...e});return(r,n)=>t.reduce((s,a)=>({...s,[a]:`${r}.${n}.${a}`}),{})}const j4="amplify-signin-with-hostedUI",_i="CognitoIdentityServiceProvider";class a8{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){Zt(this.cognitoConfig);const t=Ei(_i,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){Zt(this.cognitoConfig);const t=Ei(_i,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(j4),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){Zt(this.cognitoConfig);const t=Ei(_i,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){Zt(this.cognitoConfig);const r=Ei(_i,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(r.oauthState,t)}loadPKCE(){Zt(this.cognitoConfig);const t=Ei(_i,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){Zt(this.cognitoConfig);const r=Ei(_i,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(r.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){Zt(this.cognitoConfig);const t=Ei(_i,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){Zt(this.cognitoConfig);const r=Ei(_i,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(r.inflightOAuth,`${t}`)}async loadOAuthSignIn(){var a;Zt(this.cognitoConfig);const t=Ei(_i,this.cognitoConfig.userPoolClientId),r=await this.keyValueStorage.getItem(j4),[n,s]=((a=await this.keyValueStorage.getItem(t.oauthSignIn))==null?void 0:a.split(","))??[];return{isOAuthSignIn:n==="true"||r==="true",preferPrivateSession:s==="true"}}async storeOAuthSignIn(t,r=!1){Zt(this.cognitoConfig);const n=Ei(_i,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.oauthSignIn,`${t},${r}`)}}const Ei=(e,t)=>AE(Zz)(e,t),O4=new a8(P0);class xH{constructor(){this.waitForInflightOAuth=PO()?async()=>{if(await O4.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,r)=>{}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){O4.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new Tt({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new Tt({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}setClientMetadataProvider(t){this.clientMetadataProvider=t}async getTokens(t){var i,o,c,f,h,p;let r;try{Zt((i=this.authConfig)==null?void 0:i.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,r=await this.getTokenStore().loadTokens();const n=await this.getTokenStore().getLastAuthUser();if(r===null)return null;const s=!!(r!=null&&r.idToken)&&i4({expiresAt:(((c=(o=r.idToken)==null?void 0:o.payload)==null?void 0:c.exp)??0)*1e3,clockDrift:r.clockDrift??0}),a=i4({expiresAt:(((h=(f=r.accessToken)==null?void 0:f.payload)==null?void 0:h.exp)??0)*1e3,clockDrift:r.clockDrift??0});return(t!=null&&t.forceRefresh||s||a)&&(r=await this.refreshTokens({tokens:r,username:n,clientMetadata:(t==null?void 0:t.clientMetadata)??await((p=this.clientMetadataProvider)==null?void 0:p.call(this))}),r===null)?null:{accessToken:r==null?void 0:r.accessToken,idToken:r==null?void 0:r.idToken,signInDetails:r==null?void 0:r.signInDetails}}async refreshTokens({tokens:t,username:r,clientMetadata:n}){try{const{signInDetails:s}=t,a=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:r,clientMetadata:n});return a.signInDetails=s,await this.setTokens({tokens:a}),Sf.dispatch("auth",{event:"tokenRefresh"},"Auth",Wc),a}catch(s){return this.handleErrors(s)}}handleErrors(t){if(fi(t),this.isAuthenticationError(t)&&this.clearTokens(),Sf.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",Wc),t.name.startsWith("NotAuthorizedException"))return null;throw t}isAuthenticationError(t){return["NotAuthorizedException","TokenRevokedException","UserNotFoundException","PasswordResetRequiredException","UserNotConfirmedException","RefreshTokenReuseException"].some(n=>{var s,a;return(a=(s=t==null?void 0:t.name)==null?void 0:s.startsWith)==null?void 0:a.call(s,n)})}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}setOAuthMetadata(t){return this.getTokenStore().setOAuthMetadata(t)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}class gH{constructor(){this.authTokenStore=new pH,this.authTokenStore.setKeyValueStorage(P0),this.tokenOrchestrator=new xH,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(uH)}getTokens(t={}){return this.tokenOrchestrator.getTokens(t)}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setClientMetadataProvider(t){this.tokenOrchestrator.setClientMetadataProvider(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}}const Nh=new gH,{tokenOrchestrator:Ha}=Nh;async function Zf(e){if(e.AccessToken){const t=$c(e.AccessToken),r=(t.payload.iat||0)*1e3,n=new Date().getTime(),s=r>0?r-n:0;let a,i,o;e.RefreshToken&&(i=e.RefreshToken),e.IdToken&&(a=$c(e.IdToken)),e!=null&&e.NewDeviceMetadata&&(o=e.NewDeviceMetadata);const c={accessToken:t,idToken:a,refreshToken:i,clockDrift:s,deviceMetadata:o,username:e.username};e!=null&&e.signInDetails&&(c.signInDetails=e.signInDetails),await Ha.setTokens({tokens:c})}else throw new Hs({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}const yH="Unable to get user session following successful sign-in.",Qf=async()=>{try{Sf.dispatch("auth",{event:"signedIn",data:await n8()},"Auth",Wc)}catch(e){throw e.name===a1?new Tt({name:Kz,message:yH,recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."}):e}};function i8(){return{active:!1}}const vH=(e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return i8();default:return e}},bH=e=>{let t=e(i8(),{type:"RESET"});return{getState:()=>t,dispatch:r=>{t=e(t,r)}}},Tl=bH(vH),wH=180*1e3,Om="CognitoSignInState",_o={username:`${Om}.username`,challengeName:`${Om}.challengeName`,signInSession:`${Om}.signInSession`,expiry:`${Om}.expiry`},_H=(e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return Dm({signInSession:t.value}),{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return Dm(t.value),{...t.value};case"SET_CHALLENGE_NAME":return Dm({challengeName:t.value}),{...e,challengeName:t.value};case"SET_USERNAME":return Dm({username:t.value}),{...e,username:t.value};case"SET_INITIAL_STATE":return SH();case"RESET_STATE":return o8(),CE();default:return e}},EH=e=>{const t=Number(e),r=Date.now();return t<=r},Li=()=>{Pl.dispatch({type:"RESET_STATE"})},o8=()=>{for(const e of Object.values(_o))wo.removeItem(e)},CE=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),SH=()=>{const e=wo.getItem(_o.expiry);if(!e||EH(e))return o8(),CE();const t=wo.getItem(_o.username)??void 0,r=wo.getItem(_o.challengeName)??void 0,n=wo.getItem(_o.signInSession)??void 0;return{username:t,challengeName:r,signInSession:n}},NH=e=>{let t=e(CE(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:r=>{t=e(t,r)}}},Pl=NH(_H);function ed(e){Pl.dispatch({type:"SET_SIGN_IN_STATE",value:e})}const Dm=({challengeName:e,signInSession:t,username:r})=>{r&&wo.setItem(_o.username,r),e&&wo.setItem(_o.challengeName,e),t&&(wo.setItem(_o.signInSession,t),wo.setItem(_o.expiry,String(Date.now()+wH)))},D4="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.";class ko extends Hs{constructor(t){super(t),this.constructor=ko,Object.setPrototypeOf(this,ko.prototype)}}var Xr;(function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"})(Xr||(Xr={}));const mb="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",I4="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",qx={[Xr.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:D4},[Xr.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:I4},[Xr.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:I4},[Xr.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:D4},[Xr.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[Xr.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[Xr.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:mb},[Xr.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:mb},[Xr.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:mb},[Xr.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},RE=wE(qx,ko),TH=e=>{if(e instanceof Error){if(e.name==="AbortError"){const{message:t,recoverySuggestion:r}=qx[Xr.PasskeyOperationAborted];return new ko({name:Xr.PasskeyOperationAborted,message:t,recoverySuggestion:r,underlyingError:e})}if(e.name==="SecurityError"){const{message:t,recoverySuggestion:r}=qx[Xr.RelyingPartyMismatch];return new ko({name:Xr.RelyingPartyMismatch,message:t,recoverySuggestion:r,underlyingError:e})}}return new ko({name:qc.Unknown,message:"An unknown error has occurred.",underlyingError:e})},kH=e=>{if(e instanceof ko)return e;if(e instanceof Error&&e.name==="NotAllowedError"){const{message:t,recoverySuggestion:r}=qx[Xr.PasskeyAuthenticationCanceled];return new ko({name:Xr.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:r,underlyingError:e})}return TH(e)},AH=()=>PO()&&window.isSecureContext&&"credentials"in navigator&&typeof window.PublicKeyCredential=="function",ch=e=>n0.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0}),M4=e=>Uint8Array.from(_E.convert(e,{urlSafe:!0}),t=>t.charCodeAt(0)).buffer,CH=e=>{const t=M4(e.challenge),r=(e.allowCredentials||[]).map(n=>({...n,id:M4(n.id)}));return{...e,challenge:t,allowCredentials:r}},RH=e=>{const t={clientDataJSON:ch(e.response.clientDataJSON),authenticatorData:ch(e.response.authenticatorData),signature:ch(e.response.signature)};e.response.userHandle&&(t.userHandle=ch(e.response.userHandle));const r={id:e.id,rawId:ch(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(r.authenticatorAttachment=e.authenticatorAttachment),r};function jH(e){RE(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,Xr.PasskeyRetrievalFailed)}const OH=async e=>{try{const t=AH();RE(t,Xr.PasskeyNotSupported);const r=CH(e),n=await navigator.credentials.get({publicKey:r});return jH(n),RH(n)}catch(t){throw kH(t)}},DH=e=>Ws($a,Wa("ConfirmDevice"),di(),{...Ga,...e}),Ex={convert(e){return new TextEncoder().encode(e)}};function lt(e,t){e!=null&&this.fromString(e,t)}function _s(){return new lt(null,null)}let Ol;const IH=0xdeadbeefcafe,F4=(IH&16777215)===15715070;function MH(e,t,r,n,s,a){for(;--a>=0;){const i=t*this[e++]+r[n]+s;s=Math.floor(i/67108864),r[n++]=i&67108863}return s}function FH(e,t,r,n,s,a){const i=t&32767,o=t>>15;for(;--a>=0;){let c=this[e]&32767;const f=this[e++]>>15,h=o*c+f*i;c=i*c+((h&32767)<<15)+r[n]+(s&1073741823),s=(c>>>30)+(h>>>15)+o*f+(s>>>30),r[n++]=c&1073741823}return s}function PH(e,t,r,n,s,a){const i=t&16383,o=t>>14;for(;--a>=0;){let c=this[e]&16383;const f=this[e++]>>14,h=o*c+f*i;c=i*c+((h&16383)<<14)+r[n]+s,s=(c>>28)+(h>>14)+o*f,r[n++]=c&268435455}return s}const P4=typeof navigator<"u";P4&&F4&&navigator.appName==="Microsoft Internet Explorer"?(lt.prototype.am=FH,Ol=30):P4&&F4&&navigator.appName!=="Netscape"?(lt.prototype.am=MH,Ol=26):(lt.prototype.am=PH,Ol=28);lt.prototype.DB=Ol;lt.prototype.DM=(1<<Ol)-1;lt.prototype.DV=1<<Ol;const jE=52;lt.prototype.FV=Math.pow(2,jE);lt.prototype.F1=jE-Ol;lt.prototype.F2=2*Ol-jE;const LH="0123456789abcdefghijklmnopqrstuvwxyz",o1=[];let td,Pa;td=48;for(Pa=0;Pa<=9;++Pa)o1[td++]=Pa;td=97;for(Pa=10;Pa<36;++Pa)o1[td++]=Pa;td=65;for(Pa=10;Pa<36;++Pa)o1[td++]=Pa;function L4(e){return LH.charAt(e)}function BH(e,t){const r=o1[e.charCodeAt(t)];return r??-1}function UH(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function zH(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function OE(e){const t=_s();return t.fromInt(e),t}function HH(e,t){let r;if(t===16)r=4;else if(t===8)r=3;else if(t===2)r=1;else if(t===32)r=5;else if(t===4)r=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let n=e.length,s=!1,a=0;for(;--n>=0;){const i=BH(e,n);if(i<0){e.charAt(n)==="-"&&(s=!0);continue}s=!1,a===0?this[this.t++]=i:a+r>this.DB?(this[this.t-1]|=(i&(1<<this.DB-a)-1)<<a,this[this.t++]=i>>this.DB-a):this[this.t-1]|=i<<a,a+=r,a>=this.DB&&(a-=this.DB)}this.clamp(),s&&lt.ZERO.subTo(this,this)}function VH(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t}function qH(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(e==16)t=4;else if(e===8)t=3;else if(e===2)t=1;else if(e===32)t=5;else if(e===4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");const r=(1<<t)-1;let n,s=!1,a="",i=this.t,o=this.DB-i*this.DB%t;if(i-- >0)for(o<this.DB&&(n=this[i]>>o)>0&&(s=!0,a=L4(n));i>=0;)o<t?(n=(this[i]&(1<<o)-1)<<t-o,n|=this[--i]>>(o+=this.DB-t)):(n=this[i]>>(o-=t)&r,o<=0&&(o+=this.DB,--i)),n>0&&(s=!0),s&&(a+=L4(n));return s?a:"0"}function WH(){const e=_s();return lt.ZERO.subTo(this,e),e}function $H(){return this.s<0?this.negate():this}function GH(e){let t=this.s-e.s;if(t!=0)return t;let r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this[r]-e[r])!=0)return t;return 0}function DE(e){let t=1,r;return(r=e>>>16)!==0&&(e=r,t+=16),(r=e>>8)!==0&&(e=r,t+=8),(r=e>>4)!==0&&(e=r,t+=4),(r=e>>2)!==0&&(e=r,t+=2),(r=e>>1)!==0&&(e=r,t+=1),t}function KH(){return this.t<=0?0:this.DB*(this.t-1)+DE(this[this.t-1]^this.s&this.DM)}function XH(e,t){let r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}function YH(e,t){for(let r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}function JH(e,t){const r=e%this.DB,n=this.DB-r,s=(1<<n)-1,a=Math.floor(e/this.DB);let i=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t[o+a+1]=this[o]>>n|i,i=(this[o]&s)<<r;for(o=a-1;o>=0;--o)t[o]=0;t[a]=i,t.t=this.t+a+1,t.s=this.s,t.clamp()}function ZH(e,t){t.s=this.s;const r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}const n=e%this.DB,s=this.DB-n,a=(1<<n)-1;t[0]=this[r]>>n;for(let i=r+1;i<this.t;++i)t[i-r-1]|=(this[i]&a)<<s,t[i-r]=this[i]>>n;n>0&&(t[this.t-r-1]|=(this.s&a)<<s),t.t=this.t-r,t.clamp()}function QH(e,t){let r=0,n=0;const s=Math.min(e.t,this.t);for(;r<s;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()}function eV(e,t){const r=this.abs(),n=e.abs();let s=r.t;for(t.t=s+n.t;--s>=0;)t[s]=0;for(s=0;s<n.t;++s)t[s+r.t]=r.am(0,n[s],t,s,0,r.t);t.s=0,t.clamp(),this.s!==e.s&&lt.ZERO.subTo(t,t)}function tV(e){const t=this.abs();let r=e.t=2*t.t;for(;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){const n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}function rV(e,t,r){const n=e.abs();if(n.t<=0)return;const s=this.abs();if(s.t<n.t){t!=null&&t.fromInt(0),r!=null&&this.copyTo(r);return}r===null&&(r=_s());const a=_s(),i=this.s,o=e.s,c=this.DB-DE(n[n.t-1]);c>0?(n.lShiftTo(c,a),s.lShiftTo(c,r)):(n.copyTo(a),s.copyTo(r));const f=a.t,h=a[f-1];if(h===0)return;const p=h*(1<<this.F1)+(f>1?a[f-2]>>this.F2:0),x=this.FV/p,g=(1<<this.F1)/p,v=1<<this.F2;let y=r.t,w=y-f;const _=t===null?_s():t;for(a.dlShiftTo(w,_),r.compareTo(_)>=0&&(r[r.t++]=1,r.subTo(_,r)),lt.ONE.dlShiftTo(f,_),_.subTo(a,a);a.t<f;)a[a.t++]=0;for(;--w>=0;){let S=r[--y]===h?this.DM:Math.floor(r[y]*x+(r[y-1]+v)*g);if((r[y]+=a.am(0,S,r,w,0,f))<S)for(a.dlShiftTo(w,_),r.subTo(_,r);r[y]<--S;)r.subTo(_,r)}t!==null&&(r.drShiftTo(f,t),i!==o&&lt.ZERO.subTo(t,t)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),i<0&&lt.ZERO.subTo(r,r)}function nV(e){const t=_s();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(lt.ZERO)>0&&e.subTo(t,t),t}function sV(){if(this.t<1)return 0;const e=this[0];if((e&1)===0)return 0;let t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function aV(e){return this.compareTo(e)===0}function iV(e,t){let r=0,n=0;const s=Math.min(e.t,this.t);for(;r<s;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()}function oV(e){const t=_s();return this.addTo(e,t),t}function lV(e){const t=_s();return this.subTo(e,t),t}function cV(e){const t=_s();return this.multiplyTo(e,t),t}function uV(e){const t=_s();return this.divRemTo(e,t,null),t}function rd(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function fV(e){const t=_s();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(lt.ZERO)>0&&this.m.subTo(t,t),t}function dV(e){const t=_s();return e.copyTo(t),this.reduce(t),t}function hV(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let r=e[t]&32767;const n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function pV(e,t){e.squareTo(t),this.reduce(t)}function mV(e,t,r){e.multiplyTo(t,r),this.reduce(r)}rd.prototype.convert=fV;rd.prototype.revert=dV;rd.prototype.reduce=hV;rd.prototype.mulTo=mV;rd.prototype.sqrTo=pV;function xV(e,t,r){let n=e.bitLength(),s,a=OE(1);const i=new rd(t);if(n<=0)return a;n<18?s=1:n<48?s=3:n<144?s=4:n<768?s=5:s=6;const o=[];let c=3;const f=s-1,h=(1<<s)-1;if(o[1]=i.convert(this),s>1){const _=_s();for(i.sqrTo(o[1],_);c<=h;)o[c]=_s(),i.mulTo(_,o[c-2],o[c]),c+=2}let p=e.t-1,x,g=!0,v=_s(),y;for(n=DE(e[p])-1;p>=0;){for(n>=f?x=e[p]>>n-f&h:(x=(e[p]&(1<<n+1)-1)<<f-n,p>0&&(x|=e[p-1]>>this.DB+n-f)),c=s;(x&1)===0;)x>>=1,--c;if((n-=c)<0&&(n+=this.DB,--p),g)o[x].copyTo(a),g=!1;else{for(;c>1;)i.sqrTo(a,v),i.sqrTo(v,a),c-=2;c>0?i.sqrTo(a,v):(y=a,a=v,v=y),i.mulTo(v,o[x],a)}for(;p>=0&&(e[p]&1<<n)===0;)i.sqrTo(a,v),y=a,a=v,v=y,--n<0&&(n=this.DB-1,--p)}const w=i.revert(a);return r(null,w),w}lt.prototype.copyTo=UH;lt.prototype.fromInt=zH;lt.prototype.fromString=HH;lt.prototype.clamp=VH;lt.prototype.dlShiftTo=XH;lt.prototype.drShiftTo=YH;lt.prototype.lShiftTo=JH;lt.prototype.rShiftTo=ZH;lt.prototype.subTo=QH;lt.prototype.multiplyTo=eV;lt.prototype.squareTo=tV;lt.prototype.divRemTo=rV;lt.prototype.invDigit=sV;lt.prototype.addTo=iV;lt.prototype.toString=qH;lt.prototype.negate=WH;lt.prototype.abs=$H;lt.prototype.compareTo=GH;lt.prototype.bitLength=KH;lt.prototype.mod=nV;lt.prototype.equals=aV;lt.prototype.add=oV;lt.prototype.subtract=lV;lt.prototype.multiply=cV;lt.prototype.divide=uV;lt.prototype.modPow=xV;lt.ZERO=OE(0);lt.ONE=OE(1);const gV=async({a:e,g:t,k:r,x:n,B:s,N:a,U:i})=>new Promise((o,c)=>{t.modPow(n,a,(f,h)=>{if(f){c(f);return}s.subtract(r.multiply(h)).modPow(e.add(i.multiply(n)),a,(p,x)=>{if(p){c(p);return}o(x.mod(a))})})}),yV="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",l8={},u_={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),l8[e]=t,u_[t]=e}const Tf=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2){const n=e.slice(r,r+2).toLowerCase();if(n in u_)t[r/2]=u_[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return t},IE=e=>{let t="";for(let r=0;r<e.byteLength;r++)t+=l8[e[r]];return t},f_=e=>{const t=new zx;t.update(e);const r=t.digestSync(),n=IE(r);return new Array(64-n.length).join("0")+n},Sx=e=>f_(Tf(e)),vV=/^[89a-f]/i,vo=e=>{if(!(e instanceof lt))throw new Error("Not a BigInteger");const t=e.compareTo(lt.ZERO)<0;let r=e.abs().toString(16);if(r=r.length%2!==0?`0${r}`:r,r=vV.test(r)?`00${r}`:r,t){const n=r.split("").map(a=>{const i=~parseInt(a,16)&15;return"0123456789ABCDEF".charAt(i)}).join("");r=new lt(n,16).add(lt.ONE).toString(16),r.toUpperCase().startsWith("FF8")&&(r=r.substring(2))}return r},bV=({A:e,B:t})=>{const r=new lt(Sx(vo(e)+vo(t)),16);if(r.equals(lt.ZERO))throw new Error("U cannot be zero.");return r},wV=(e,t,r)=>{const n=new zx(t);n.update(e);const s=n.digestSync(),a=new zx(s);return a.update(r),a.digestSync().slice(0,16)},ME=e=>{const t=new TE().random(e).toString();return Tf(t)},_V=()=>n0.convert(ME(40));class EV{constructor({userPoolName:t,a:r,g:n,A:s,N:a}){this.encoder=Ex,this.userPoolName=t,this.a=r,this.g=n,this.A=s,this.N=a,this.k=new lt(Sx(`${vo(a)}${vo(n)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new Tt({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new Tt({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new Tt({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(t,r){this.randomPassword=_V();const n=`${t}${r}:${this.randomPassword}`,s=f_(n),a=IE(ME(16));return this.saltToHashDevices=vo(new lt(a,16)),new Promise((i,o)=>{this.g.modPow(new lt(Sx(this.saltToHashDevices+s),16),this.N,(c,f)=>{if(c){o(c);return}this.verifierDevices=vo(f),i()})})}async getPasswordAuthenticationKey({username:t,password:r,serverBValue:n,salt:s}){if(n.mod(this.N).equals(lt.ZERO))throw new Error("B cannot be zero.");const a=bV({A:this.A,B:n}),i=`${this.userPoolName}${t}:${r}`,o=f_(i),c=new lt(Sx(vo(s)+o),16),f=await gV({a:this.a,g:this.g,k:this.k,x:c,B:n,N:this.N,U:a}),h=this.encoder.convert("Caldera Derived Key"),p=this.encoder.convert(""),x=new Uint8Array(h.byteLength+p.byteLength);return x.set(h,0),x.set(p,h.byteLength),wV(Tf(vo(f)),Tf(vo(a)),x)}}const SV=async({a:e,g:t,N:r})=>new Promise((n,s)=>{t.modPow(e,r,(a,i)=>{if(a){s(a);return}if(i.mod(r).equals(lt.ZERO)){s(new Error("Illegal parameter. A mod N cannot be 0."));return}n(i)})}),l1=async e=>{const t=new lt(yV,16),r=new lt("2",16),n=NV(),s=await SV({a:n,g:r,N:t});return new EV({userPoolName:e,a:n,g:r,A:s,N:t})},NV=()=>{const e=IE(ME(128));return new lt(e,16)};async function nd({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:r,accessToken:n}){if(!r)return;const s=e.split("_")[1]||"",a=await l1(s),i=r==null?void 0:r.DeviceKey,o=r==null?void 0:r.DeviceGroupKey;try{await a.generateHashDevice(o??"",i??"")}catch{return}const c={Salt:n0.convert(Tf(a.getSaltToHashDevices())),PasswordVerifier:n0.convert(Tf(a.getVerifierDevices()))},f=a.getRandomPassword();try{return await DH({endpointResolver:Sn({endpointOverride:t})})({region:En(e)},{AccessToken:n,DeviceName:await Iz(),DeviceKey:r==null?void 0:r.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:i,deviceGroupKey:o,randomPassword:f}}catch{return}}async function TV(e){var g;const t=(g=Sr.getConfig().Auth)==null?void 0:g.Cognito;Zt(t);const{username:r,signInSession:n,signInDetails:s,challengeName:a}=Pl.getState();if(a!=="WEB_AUTHN"||!r)throw new Tt({name:Nf.SignInException,message:"Unable to proceed due to invalid sign in state."});const{CREDENTIAL_REQUEST_OPTIONS:i}=e;RE(!!i,Xr.InvalidPasskeyAuthenticationOptions);const o=await OH(JSON.parse(i)),c=i1({endpointResolver:Sn({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:f,ChallengeParameters:h,AuthenticationResult:p,Session:x}=await c({region:En(t.userPoolId),userAgentValue:ua(Ns.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:r,CREDENTIAL:JSON.stringify(o)},ClientId:t.userPoolClientId,Session:n});if(ed({signInSession:x,username:r,challengeName:f,signInDetails:s}),p)return await Zf({...p,username:r,NewDeviceMetadata:await nd({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:p.NewDeviceMetadata,accessToken:p.AccessToken}),signInDetails:s}),Pl.dispatch({type:"RESET_STATE"}),await Qf(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if(f==="WEB_AUTHN")throw new Tt({name:Nf.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:f,challengeParameters:h}}function hi({username:e,userPoolId:t,userPoolClientId:r}){if(typeof window>"u")return;const n=window.AmazonCognitoAdvancedSecurityData;if(typeof n>"u")return;const s=n.getData(e,t,r);return s?{EncodedData:s}:{}}const kV=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],AV=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],c8=()=>{const e=new Date,t=AV[e.getUTCDay()],r=kV[e.getUTCMonth()],n=e.getUTCDate();let s=e.getUTCHours();s<10&&(s=`0${s}`);let a=e.getUTCMinutes();a<10&&(a=`0${a}`);let i=e.getUTCSeconds();i<10&&(i=`0${i}`);const o=e.getUTCFullYear();return`${t} ${r} ${n} ${s}:${a}:${i} UTC ${o}`},u8=({userPoolName:e,username:t,challengeParameters:r,dateNow:n,hkdf:s})=>{const a=Ex.convert(e),i=Ex.convert(t),o=CV(r.SECRET_BLOCK),c=Ex.convert(n),f=new Uint8Array(a.byteLength+i.byteLength+o.byteLength+c.byteLength);f.set(a,0),f.set(i,a.byteLength),f.set(o,a.byteLength+i.byteLength),f.set(c,a.byteLength+i.byteLength+o.byteLength);const h=new zx(s);h.update(f);const p=h.digestSync();return n0.convert(p)},CV=e=>{const t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/-/g,"+").replace(/_/g,"/"),n=_E.convert(r),s=new Uint8Array(n.length);for(let a=0;a<n.length;++a)s[a]=n.charCodeAt(a);return s};async function FE({username:e,config:t,clientMetadata:r,session:n,tokenOrchestrator:s}){const{userPoolId:a,userPoolEndpoint:i}=t,o=t.userPoolClientId,c=await(s==null?void 0:s.getDeviceMetadata(e));t8(c);const f=await l1(c.deviceGroupKey),h={USERNAME:e,SRP_A:f.A.toString(16),DEVICE_KEY:c.deviceKey},p={ChallengeName:"DEVICE_SRP_AUTH",ClientId:o,ChallengeResponses:h,ClientMetadata:r,Session:n},x=i1({endpointResolver:Sn({endpointOverride:i})}),{ChallengeParameters:g,Session:v}=await x({region:En(a)},p);return RV(e,g,r,v,f,t,s)}async function RV(e,t,r,n,s,{userPoolId:a,userPoolClientId:i,userPoolEndpoint:o},c){const f=await(c==null?void 0:c.getDeviceMetadata(e));t8(f);const h=new lt(t==null?void 0:t.SRP_B,16),p=new lt(t==null?void 0:t.SALT,16),{deviceKey:x}=f,{deviceGroupKey:g}=f,v=await s.getPasswordAuthenticationKey({username:f.deviceKey,password:f.randomPassword,serverBValue:h,salt:p}),y=c8(),w={USERNAME:(t==null?void 0:t.USERNAME)??e,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:y,PASSWORD_CLAIM_SIGNATURE:u8({username:x,userPoolName:g,challengeParameters:t,dateNow:y,hkdf:v}),DEVICE_KEY:x},_=hi({username:e,userPoolId:a,userPoolClientId:i}),S={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:i,ChallengeResponses:w,Session:n,ClientMetadata:r,UserContextData:_};return i1({endpointResolver:Sn({endpointOverride:o})})({region:En(a)},S)}async function f8(e,t,r,n,s,a,i){const{userPoolId:o,userPoolClientId:c,userPoolEndpoint:f}=a,h=(o==null?void 0:o.split("_")[1])||"",p=new lt(t==null?void 0:t.SRP_B,16),x=new lt(t==null?void 0:t.SALT,16),g=t==null?void 0:t.USER_ID_FOR_SRP;if(!g)throw new Tt({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const v=await s.getPasswordAuthenticationKey({username:g,password:e,serverBValue:p,salt:x}),y=c8(),w={USERNAME:g,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:y,PASSWORD_CLAIM_SIGNATURE:u8({username:g,userPoolName:h,challengeParameters:t,dateNow:y,hkdf:v})},_=await i.getDeviceMetadata(g);_&&_.deviceKey&&(w.DEVICE_KEY=_.deviceKey);const S=hi({username:g,userPoolId:o,userPoolClientId:c}),E={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:w,ClientMetadata:r,Session:n,ClientId:c,UserContextData:S},k=await i1({endpointResolver:Sn({endpointOverride:f})})({region:En(o)},E);return k.ChallengeName==="DEVICE_SRP_AUTH"?FE({username:g,config:a,clientMetadata:r,session:k.Session,tokenOrchestrator:i}):k}async function c1(e,t,r,n){try{return await e(...t)}catch(s){if(s instanceof Tt&&s.name==="ResourceNotFoundException"&&s.message.includes("Device does not exist."))return await n.clearDeviceMetadata(r),e(...t);throw s}}function B0(e){const{dispatch:t}=Pl;t({type:"SET_USERNAME",value:e})}async function d8({username:e,password:t,clientMetadata:r,config:n,tokenOrchestrator:s,authFlow:a,preferredChallenge:i}){const{userPoolId:o,userPoolClientId:c,userPoolEndpoint:f}=n,h=(o==null?void 0:o.split("_")[1])||"",p=await l1(h),x={USERNAME:e,SRP_A:p.A.toString(16)};a==="USER_AUTH"&&i&&(x.PREFERRED_CHALLENGE=i);const g=hi({username:e,userPoolId:o,userPoolClientId:c}),v={AuthFlow:a,AuthParameters:x,ClientMetadata:r,ClientId:c,UserContextData:g},w=await L0({endpointResolver:Sn({endpointOverride:f})})({region:En(o),userAgentValue:ua(Ns.SignIn)},v),{ChallengeParameters:_,Session:S}=w,E=(_==null?void 0:_.USERNAME)??e;return B0(E),w.ChallengeName==="PASSWORD_VERIFIER"?c1(f8,[t,_,r,S,p,n,s],E,s):w}const B4="userAttributes.";function jV(e){return"isSignedIn"in e&&"nextStep"in e}async function OV(e,t,r,n,s){var y,w;const{userPoolClientId:a,userPoolId:i,userPoolEndpoint:o}=n,c={USERNAME:e,PASSWORD:t},f=await s.getDeviceMetadata(e);f&&f.deviceKey&&(c.DEVICE_KEY=f.deviceKey);const h=hi({username:e,userPoolId:i,userPoolClientId:a}),p={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:c,ClientMetadata:r,ClientId:a,UserContextData:h},g=await L0({endpointResolver:Sn({endpointOverride:o})})({region:En(i),userAgentValue:ua(Ns.SignIn)},p),v=((y=g.ChallengeParameters)==null?void 0:y.USERNAME)??((w=g.ChallengeParameters)==null?void 0:w.USER_ID_FOR_SRP)??e;return B0(v),g.ChallengeName==="DEVICE_SRP_AUTH"?FE({username:v,config:n,clientMetadata:r,session:g.Session,tokenOrchestrator:s}):g}async function DV(e,t,r,n,s){return d8({username:e,password:t,clientMetadata:r,config:n,tokenOrchestrator:s,authFlow:"USER_SRP_AUTH"})}async function IV(e,t,r,n){var v;const{userPoolClientId:s,userPoolId:a,userPoolEndpoint:i}=r,o={USERNAME:e},c=await n.getDeviceMetadata(e);c&&c.deviceKey&&(o.DEVICE_KEY=c.deviceKey);const f=hi({username:e,userPoolId:a,userPoolClientId:s}),h={AuthFlow:"CUSTOM_AUTH",AuthParameters:o,ClientMetadata:t,ClientId:s,UserContextData:f},x=await L0({endpointResolver:Sn({endpointOverride:i})})({region:En(a),userAgentValue:ua(Ns.SignIn)},h),g=((v=x.ChallengeParameters)==null?void 0:v.USERNAME)??e;return B0(g),x.ChallengeName==="DEVICE_SRP_AUTH"?FE({username:g,config:r,clientMetadata:t,session:x.Session,tokenOrchestrator:n}):x}async function MV(e,t,r,n,s){Zt(n);const{userPoolId:a,userPoolClientId:i,userPoolEndpoint:o}=n,c=(a==null?void 0:a.split("_")[1])||"",f=await l1(c),h={USERNAME:e,SRP_A:f.A.toString(16),CHALLENGE_NAME:"SRP_A"},p=hi({username:e,userPoolId:a,userPoolClientId:i}),x={AuthFlow:"CUSTOM_AUTH",AuthParameters:h,ClientMetadata:r,ClientId:i,UserContextData:p},g=L0({endpointResolver:Sn({endpointOverride:o})}),{ChallengeParameters:v,Session:y}=await g({region:En(a),userAgentValue:ua(Ns.SignIn)},x),w=(v==null?void 0:v.USERNAME)??e;return B0(w),c1(f8,[t,v,r,y,f,n,s],w,s)}async function sd(e){var a;const{challengeName:t,challengeParameters:r,availableChallenges:n}=e,s=(a=Sr.getConfig().Auth)==null?void 0:a.Cognito;switch(Zt(s),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:r}};case"MFA_SETUP":{const{signInSession:i,username:o}=Pl.getState(),c=U4(z4(r.MFAS_CAN_SETUP))||[],f=BV(c),h=f.includes("TOTP"),p=f.includes("EMAIL");if(h&&p)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:f}};if(p)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(h){const x=iH({endpointResolver:Sn({endpointOverride:s.userPoolEndpoint})}),{Session:g,SecretCode:v}=await x({region:En(s.userPoolId)},{Session:i});return Pl.dispatch({type:"SET_SIGN_IN_SESSION",value:g}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:FV(v,o)}}}throw new Tt({name:Nf.SignInException,message:`Cannot initiate MFA setup from available types: ${c}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:PV(r.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:U4(z4(r.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:r.CODE_DELIVERY_DELIVERY_MEDIUM,destination:r.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:r.CODE_DELIVERY_DELIVERY_MEDIUM,destination:r.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{const i=await TV(r);return jV(i)?i:sd(i)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:n}}}throw new Tt({name:Nf.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function FV(e,t){return{sharedSecret:e,getSetupUri:(r,n)=>{const s=`otpauth://totp/${r}:${n??t}?secret=${e}&issuer=${r}`;return new F0(s)}}}function U0(e){if(e===Hx.PasswordResetRequiredException)return{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}};if(e===Hx.UserNotConfirmedException)return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}}function PV(e){return e?JSON.parse(e).map(r=>r.includes(B4)?r.replace(B4,""):r):[]}function LV(e){if(e==="SMS_MFA")return"SMS";if(e==="SOFTWARE_TOKEN_MFA")return"TOTP";if(e==="EMAIL_OTP")return"EMAIL"}function U4(e){if(e)return e.map(LV).filter(Boolean)}function z4(e){return e?JSON.parse(e):[]}function BV(e){return e.filter(t=>t==="EMAIL"||t==="TOTP")}async function UV(){let e;try{e=await n8()}catch{}if(e&&e.userId&&e.username)throw new Tt({name:Lz,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}function z0(e){return Pl.getState().username??e}async function zV(e){var o;const t=(o=Sr.getConfig().Auth)==null?void 0:o.Cognito;Zt(t);const{username:r,password:n,options:s}=e,a={loginId:r,authFlowType:"CUSTOM_WITHOUT_SRP"},i=s==null?void 0:s.clientMetadata;Yr(!!r,At.EmptySignInUsername),Yr(!n,At.CustomAuthSignInPassword);try{const{ChallengeName:c,ChallengeParameters:f,AuthenticationResult:h,Session:p}=await c1(IV,[r,i,t,Ha],r,Ha),x=z0(r);return ed({signInSession:p,username:x,challengeName:c,signInDetails:a}),h?(await Zf({username:x,...h,NewDeviceMetadata:await nd({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:h.NewDeviceMetadata,accessToken:h.AccessToken}),signInDetails:a}),Li(),await Qf(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:c,challengeParameters:f})}catch(c){Li(),fi(c);const f=U0(c.name);if(f)return f;throw c}}async function HV(e){var o;const{username:t,password:r,options:n}=e,s={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},a=(o=Sr.getConfig().Auth)==null?void 0:o.Cognito;Zt(a);const i=n==null?void 0:n.clientMetadata;Yr(!!t,At.EmptySignInUsername),Yr(!!r,At.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:f,AuthenticationResult:h,Session:p}=await MV(t,r,i,a,Ha),x=z0(t);return ed({signInSession:p,username:x,challengeName:c,signInDetails:s}),h?(await Zf({username:x,...h,NewDeviceMetadata:await nd({userPoolId:a.userPoolId,userPoolEndpoint:a.userPoolEndpoint,newDeviceMetadata:h.NewDeviceMetadata,accessToken:h.AccessToken}),signInDetails:s}),Li(),await Qf(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:c,challengeParameters:f})}catch(c){Li(),fi(c);const f=U0(c.name);if(f)return f;throw c}}function Mo(e=!0){Tl.dispatch({type:"RESET"})}async function H4(e){var i,o;const{username:t,password:r}=e,n=(i=Sr.getConfig().Auth)==null?void 0:i.Cognito,s={loginId:t,authFlowType:"USER_SRP_AUTH"};Zt(n);const a=(o=e.options)==null?void 0:o.clientMetadata;Yr(!!t,At.EmptySignInUsername),Yr(!!r,At.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:f,AuthenticationResult:h,Session:p}=await DV(t,r,a,n,Ha),x=z0(t);return ed({signInSession:p,username:x,challengeName:c,signInDetails:s}),h?(await Zf({username:x,...h,NewDeviceMetadata:await nd({userPoolId:n.userPoolId,userPoolEndpoint:n.userPoolEndpoint,newDeviceMetadata:h.NewDeviceMetadata,accessToken:h.AccessToken}),signInDetails:s}),Li(),await Qf(),Mo(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:c,challengeParameters:f})}catch(c){Li(),Mo(),fi(c);const f=U0(c.name);if(f)return f;throw c}}async function VV(e){var o;const{username:t,password:r,options:n}=e,s=(o=Sr.getConfig().Auth)==null?void 0:o.Cognito,a={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};Zt(s);const i=n==null?void 0:n.clientMetadata;Yr(!!t,At.EmptySignInUsername),Yr(!!r,At.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:f,AuthenticationResult:h,Session:p}=await c1(OV,[t,r,i,s,Ha],t,Ha),x=z0(t);return ed({signInSession:p,username:x,challengeName:c,signInDetails:a}),h?(await Zf({...h,username:x,NewDeviceMetadata:await nd({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:h.NewDeviceMetadata,accessToken:h.AccessToken}),signInDetails:a}),Li(),await Qf(),Mo(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:c,challengeParameters:f})}catch(c){Li(),Mo(),fi(c);const f=U0(c.name);if(f)return f;throw c}}async function qV({username:e,clientMetadata:t,config:r,tokenOrchestrator:n,preferredChallenge:s,password:a,session:i}){const{userPoolId:o,userPoolClientId:c,userPoolEndpoint:f}=r,h=hi({username:e,userPoolId:o,userPoolClientId:c}),p={USERNAME:e};if(s){if(r.passwordless&&(s==="EMAIL_OTP"&&!r.passwordless.emailOtpEnabled||s==="SMS_OTP"&&!r.passwordless.smsOtpEnabled||s==="WEB_AUTHN"&&!r.passwordless.webAuthn)&&Yr(!1,At.InvalidPreferredChallenge),s==="PASSWORD_SRP")return Yr(!!a,At.EmptySignInPassword),d8({username:e,password:a,clientMetadata:t,config:r,tokenOrchestrator:n,authFlow:"USER_AUTH",preferredChallenge:s});s==="PASSWORD"&&(Yr(!!a,At.EmptySignInPassword),p.PASSWORD=a),p.PREFERRED_CHALLENGE=s}const x={AuthFlow:"USER_AUTH",AuthParameters:p,ClientMetadata:t,ClientId:c,UserContextData:h};i&&(x.Session=i);const v=await L0({endpointResolver:Sn({endpointOverride:f})})({region:En(o),userAgentValue:ua(Ns.SignIn)},x);return B0(e),v}async function WV(e){var c,f;const{username:t,password:r,options:n}=e,s=(c=Sr.getConfig().Auth)==null?void 0:c.Cognito,a={loginId:t,authFlowType:"USER_AUTH"};Zt(s);const i=n==null?void 0:n.clientMetadata,o=(n==null?void 0:n.preferredChallenge)??((f=s==null?void 0:s.passwordless)==null?void 0:f.preferredChallenge);Yr(!!t,At.EmptySignInUsername);try{const h={username:t,config:s,tokenOrchestrator:Ha,clientMetadata:i,preferredChallenge:o,password:r},p=Tl.getState();p.active&&p.username===t&&(h.session=p.session);const x=await qV(h),g=z0(t);return ed({signInSession:x.Session,username:g,challengeName:x.ChallengeName,signInDetails:a}),x.AuthenticationResult?(await Zf({username:g,...x.AuthenticationResult,NewDeviceMetadata:await nd({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:x.AuthenticationResult.NewDeviceMetadata,accessToken:x.AuthenticationResult.AccessToken}),signInDetails:a}),Li(),await Qf(),Mo(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:x.ChallengeName,challengeParameters:x.ChallengeParameters,availableChallenges:"AvailableChallenges"in x?x.AvailableChallenges:void 0})}catch(h){Li(),Mo(),fi(h);const p=U0(h.name);if(p)return p;throw h}}async function $V(e){var r;Mo(!1);const t=(r=e.options)==null?void 0:r.authFlowType;switch(await UV(),t){case"USER_SRP_AUTH":return H4(e);case"USER_PASSWORD_AUTH":return VV(e);case"CUSTOM_WITHOUT_SRP":return zV(e);case"CUSTOM_WITH_SRP":return HV(e);case"USER_AUTH":return WV(e);default:return H4(e)}}const GV=180*1e3;function KV(e){const t=Ux.listen("auth-internal",async({payload:n})=>{switch(n.event){case"confirmSignUp":{const s=n.data;s!=null&&s.isSignUpComplete&&(Ux.dispatch("auth-internal",{event:"autoSignIn"}),t())}}}),r=setTimeout(()=>{t(),clearTimeout(r),Mo()},GV)}const XV=()=>async e=>{if(e.statusCode>=300){const t=await Jf(e);if(fi(t),t.name===c_.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){const r=At.EmptySignUpPassword,{message:n,recoverySuggestion:s}=QO[r];throw new Tt({name:r,message:n,recoverySuggestion:s})}throw new Tt({name:t.name,message:t.message})}return M0(e)},YV=e=>Ws($a,Wa("SignUp"),XV(),{...Ga,...e});async function JV(e){var O;const{username:t,password:r,options:n}=e,s=(O=Sr.getConfig().Auth)==null?void 0:O.Cognito,a=(s==null?void 0:s.signUpVerificationMethod)??"code",{clientMetadata:i,validationData:o,autoSignIn:c}=e.options??{};Zt(s),Yr(!!t,At.EmptySignUpUsername);const f=typeof c!="boolean"?c:void 0;f==null||f.authFlowType;const{userPoolId:h,userPoolClientId:p,userPoolEndpoint:x}=s,g=YV({endpointResolver:Sn({endpointOverride:x})}),v={Username:t,Password:void 0,UserAttributes:(n==null?void 0:n.userAttributes)&&l_(n==null?void 0:n.userAttributes),ClientMetadata:i,ValidationData:o&&l_(o),ClientId:p,UserContextData:hi({username:t,userPoolId:h,userPoolClientId:p})};r&&(v.Password=r);const{UserSub:y,CodeDeliveryDetails:w,UserConfirmed:_,Session:S}=await g({region:En(h),userAgentValue:ua(Ns.SignUp)},v);(f||c===!0)&&(Tl.dispatch({type:"START"}),Tl.dispatch({type:"SET_USERNAME",value:t}),Tl.dispatch({type:"SET_SESSION",value:S}));const E={destination:w==null?void 0:w.Destination,deliveryMedium:w==null?void 0:w.DeliveryMedium,attributeName:w==null?void 0:w.AttributeName},N=!!_,k=Tl.getState().active;if(N)return k?{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:y}:{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:y};if(k){if(a==="link")return{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:E},userId:y};KV()}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:E},userId:y}}const ZV=e=>Ws($a,Wa("ForgotPassword"),di(),{...Ga,...e});async function QV(e){var p,x;const{username:t}=e;Yr(!!t,At.EmptyResetPasswordUsername);const r=(p=Sr.getConfig().Auth)==null?void 0:p.Cognito;Zt(r);const{userPoolClientId:n,userPoolId:s,userPoolEndpoint:a}=r,i=(x=e.options)==null?void 0:x.clientMetadata,o=hi({username:t,userPoolId:s,userPoolClientId:n}),h=(await ZV({endpointResolver:Sn({endpointOverride:a})})({region:En(s),userAgentValue:ua(Ns.ResetPassword)},{Username:t,ClientMetadata:i,ClientId:n,UserContextData:o})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:h==null?void 0:h.DeliveryMedium,destination:h==null?void 0:h.Destination,attributeName:h==null?void 0:h.AttributeName}}}}const eq=e=>Ws($a,Wa("ConfirmForgotPassword"),di(),{...Ga,...e});async function tq(e){var p,x;const t=(p=Sr.getConfig().Auth)==null?void 0:p.Cognito;Zt(t);const{userPoolClientId:r,userPoolId:n,userPoolEndpoint:s}=t,{username:a,newPassword:i}=e;Yr(!!a,At.EmptyConfirmResetPasswordUsername),Yr(!!i,At.EmptyConfirmResetPasswordNewPassword);const o=e.confirmationCode;Yr(!!o,At.EmptyConfirmResetPasswordConfirmationCode);const c=(x=e.options)==null?void 0:x.clientMetadata,f=hi({username:a,userPoolId:n,userPoolClientId:r});await eq({endpointResolver:Sn({endpointOverride:s})})({region:En(t.userPoolId),userAgentValue:ua(Ns.ConfirmResetPassword)},{Username:a,ConfirmationCode:o,Password:i,ClientMetadata:c,ClientId:t.userPoolClientId,UserContextData:f})}const rq=e=>Ws($a,Wa("ConfirmSignUp"),di(),{...Ga,...e});async function nq(e){var x;const{username:t,confirmationCode:r,options:n}=e,s=(x=Sr.getConfig().Auth)==null?void 0:x.Cognito;Zt(s);const{userPoolId:a,userPoolClientId:i,userPoolEndpoint:o}=s,c=n==null?void 0:n.clientMetadata;Yr(!!t,At.EmptyConfirmSignUpUsername),Yr(!!r,At.EmptyConfirmSignUpCode);const f=hi({username:t,userPoolId:a,userPoolClientId:i}),h=rq({endpointResolver:Sn({endpointOverride:o})}),{Session:p}=await h({region:En(s.userPoolId),userAgentValue:ua(Ns.ConfirmSignUp)},{Username:t,ConfirmationCode:r,ClientMetadata:c,ForceAliasCreation:n==null?void 0:n.forceAliasCreation,ClientId:s.userPoolClientId,UserContextData:f});return new Promise((g,v)=>{try{const y={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},w=Tl.getState();if(!w.active||w.username!==t){g(y),Mo();return}Tl.dispatch({type:"SET_SESSION",value:p});const _=Ux.listen("auth-internal",({payload:S})=>{switch(S.event){case"autoSignIn":g({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),_()}});Ux.dispatch("auth-internal",{event:"confirmSignUp",data:y})}catch(y){v(y)}})}const sq=e=>Ws($a,Wa("ChangePassword"),di(),{...Ga,...e});async function aq(e){var c;const t=(c=Sr.getConfig().Auth)==null?void 0:c.Cognito;Zt(t);const{userPoolEndpoint:r,userPoolId:n}=t,{oldPassword:s,newPassword:a}=e;Yr(!!s,At.EmptyUpdatePassword),Yr(!!a,At.EmptyUpdatePassword);const{tokens:i}=await n1({forceRefresh:!1});kE(i),await sq({endpointResolver:Sn({endpointOverride:r})})({region:En(n),userAgentValue:ua(Ns.UpdatePassword)},{AccessToken:i.accessToken.toString(),PreviousPassword:s,ProposedPassword:a})}const iq=e=>Ws($a,Wa("UpdateUserAttributes"),di(),{...Ga,...e}),oq=async e=>{var h;const{userAttributes:t,options:r}=e,n=(h=Sr.getConfig().Auth)==null?void 0:h.Cognito,s=r==null?void 0:r.clientMetadata;Zt(n);const{userPoolEndpoint:a,userPoolId:i}=n,{tokens:o}=await n1({forceRefresh:!1});kE(o);const c=iq({endpointResolver:Sn({endpointOverride:a})}),{CodeDeliveryDetailsList:f}=await c({region:En(i),userAgentValue:ua(Ns.UpdateUserAttributes)},{AccessToken:o.accessToken.toString(),ClientMetadata:s,UserAttributes:l_(t)});return{...lq(t),...cq(f)}};function lq(e){var r;const t={};return(r=Object.keys(e))==null||r.forEach(n=>{t[n]={isUpdated:!0,nextStep:{updateAttributeStep:"DONE"}}}),t}function cq(e){const t={};return e==null||e.forEach(r=>{const{AttributeName:n,DeliveryMedium:s,Destination:a}=r;n&&(t[n]={isUpdated:!1,nextStep:{updateAttributeStep:"CONFIRM_ATTRIBUTE_WITH_CODE",codeDeliveryDetails:{attributeName:n,deliveryMedium:s,destination:a}}})}),t}function uq(e,t){{const r=(e==null?void 0:e.find(fq))??(e==null?void 0:e.find(dq)),n=(e==null?void 0:e.find(pq))??(e==null?void 0:e.find(hq));if(r)return r;throw n?Wz:Vz}}const fq=e=>e.startsWith(String(window.location.origin+(window.location.pathname||"/"))),dq=e=>e.includes(String(window.location.hostname)),hq=e=>e.startsWith("http://"),pq=e=>e.startsWith("https://"),mq=async e=>{window!=null&&window.location&&(window.location.href=e.replace("http://","https://"))},xq=async e=>{await e.clearOAuthData(),Ha.clearTokens(),await LO(),Sf.dispatch("auth",{event:"signedOut"},"Auth",Wc)},gq=async(e,t=!1,r)=>{RO(e);const{loginWith:n,userPoolClientId:s}=e,{domain:a,redirectSignOut:i}=n.oauth,o=uq(i),c=`https://${a}/logout?${Object.entries({client_id:s,logout_uri:encodeURIComponent(o)}).map(([f,h])=>`${f}=${h}`).join("&")}`;return mq(c)},yq=async(e,t,r,n)=>{const{isOAuthSignIn:s}=await t.loadOAuthSignIn(),a=await r.getOAuthMetadata();if(await xq(t),s||a!=null&&a.oauthSignIn)return gq(e,!1)},vq=e=>Ws($a,Wa("RevokeToken"),di(),{...Ga,...e}),bq=new oa("Auth");async function V4(e){var n;const t=(n=Sr.getConfig().Auth)==null?void 0:n.Cognito;Zt(t),await wq(t);let r;try{RO(t),r=!0}catch{r=!1}if(r){const s=new a8(P0);s.setAuthConfig(t);const{type:a}=await yq(t,s,Ha)??{};if(a==="error")throw new Tt({name:$z,message:"An error occurred when attempting to log out from OAuth provider."})}else Ha.clearTokens(),await LO(),Sf.dispatch("auth",{event:"signedOut"},"Auth",Wc)}async function wq(e){try{const{userPoolEndpoint:t,userPoolId:r,userPoolClientId:n}=e,s=await Ha.getTokenStore().loadTokens();e8(s),_q(s.accessToken)&&await vq({endpointResolver:Sn({endpointOverride:t})})({region:En(r),userAgentValue:ua(Ns.SignOut)},{ClientId:n,Token:s.refreshToken})}catch{bq.debug("Client signOut error caught but will proceed with token removal")}}const _q=e=>{var t;return!!((t=e==null?void 0:e.payload)!=null&&t.origin_jti)},Eq={identityId:"identityId"},Sq=new oa("DefaultIdentityIdStore");class h8{setAuthConfig(t){wx(t.Cognito),this.authConfig=t,this._authKeys=Nq("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=t}async loadIdentityId(){var t;wx((t=this.authConfig)==null?void 0:t.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const r=await this.keyValueStorage.getItem(this._authKeys.identityId);return r?(this._hasGuestIdentityId=!0,{id:r,type:"guest"}):null}}catch(r){return Sq.log("Error getting stored IdentityId.",r),null}}async storeIdentityId(t){var r;wx((r=this.authConfig)==null?void 0:r.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=t.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const Nq=(e,t)=>AE(Eq)(`com.amplify.${e}`,t),d_=({endpointOverride:e})=>t=>e?{url:new F0(e)}:Nz(t);function p8(e){const t=$c(e).payload.iss,r={};if(!t)throw new Tt({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const n=t.replace(/(^\w+:|^)\/\//,"");return r[n]=e,r}async function Tq({tokens:e,authConfig:t,identityIdStore:r}){r.setAuthConfig({Cognito:t});const n=await r.loadIdentityId();if(n)return n.id;const s=e!=null&&e.idToken?p8(e.idToken.toString()):{},a=await kq(s,t);return r.storeIdentityId({id:a,type:e?"primary":"guest"}),a}async function kq(e,t){const r=t==null?void 0:t.identityPoolId,n=o_(r),s=_z({endpointResolver:d_({endpointOverride:t.identityPoolEndpoint})});let a;try{a=(await s({region:n},{IdentityPoolId:r,Logins:e})).IdentityId}catch(i){throw fi(i),new Tt(i)}if(!a)throw new Tt({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return a}const Im=new oa("CognitoCredentialsProvider"),q4=3e3*1e3;class m8{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){Im.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){Im.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){const r=t.authenticated,{tokens:n}=t,{authConfig:s}=t;try{wx(s==null?void 0:s.Cognito)}catch{return}if(!r&&!s.Cognito.allowGuestAccess)return;const{forceRefresh:a}=t,i=this.hasTokenChanged(n),o=await Tq({tokens:n,authConfig:s.Cognito,identityIdStore:this._identityIdStore});return(a||i)&&this.clearCredentials(),r?(Xz(n),this.credsForOIDCTokens(s.Cognito,n,o)):this.getGuestCredentials(o,s.Cognito)}async getGuestCredentials(t,r){var i,o;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return Im.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const n=o_(r.identityPoolId),s=a4({endpointResolver:d_({endpointOverride:r.identityPoolEndpoint})});let a;try{a=await s({region:n},{IdentityId:t})}catch(c){throw fi(c),new Tt(c)}if((i=a==null?void 0:a.Credentials)!=null&&i.AccessKeyId&&((o=a==null?void 0:a.Credentials)!=null&&o.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+q4;const c={credentials:{accessKeyId:a.Credentials.AccessKeyId,secretAccessKey:a.Credentials.SecretKey,sessionToken:a.Credentials.SessionToken,expiration:a.Credentials.Expiration},identityId:t};return a.IdentityId&&(c.identityId=a.IdentityId,this._identityIdStore.storeIdentityId({id:a.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...c,isAuthenticatedCreds:!1},c}else throw new Tt({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,r,n){var c,f,h;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return Im.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const s=r.idToken?p8(r.idToken.toString()):{},a=o_(t.identityPoolId),i=a4({endpointResolver:d_({endpointOverride:t.identityPoolEndpoint})});let o;try{o=await i({region:a},{IdentityId:n,Logins:s})}catch(p){throw fi(p),new Tt(p)}if((c=o==null?void 0:o.Credentials)!=null&&c.AccessKeyId&&((f=o==null?void 0:o.Credentials)!=null&&f.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+q4;const p={credentials:{accessKeyId:o.Credentials.AccessKeyId,secretAccessKey:o.Credentials.SecretKey,sessionToken:o.Credentials.SessionToken,expiration:o.Credentials.Expiration},identityId:n};return o.IdentityId&&(p.identityId=o.IdentityId,this._identityIdStore.storeIdentityId({id:o.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...p,isAuthenticatedCreds:!0,associatedIdToken:(h=r.idToken)==null?void 0:h.toString()},p}else throw new Tt({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){var r,n;return!!t&&!!((r=this._credentialsAndIdentityId)!=null&&r.associatedIdToken)&&((n=t.idToken)==null?void 0:n.toString())!==this._credentialsAndIdentityId.associatedIdToken}}function x8(e,t){return function(){return e.apply(t,arguments)}}const{toString:Aq}=Object.prototype,{getPrototypeOf:PE}=Object,{iterator:u1,toStringTag:g8}=Symbol,f1=(e=>t=>{const r=Aq.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),pi=e=>(e=e.toLowerCase(),t=>f1(t)===e),d1=e=>t=>typeof t===e,{isArray:ad}=Array,kf=d1("undefined");function H0(e){return e!==null&&!kf(e)&&e.constructor!==null&&!kf(e.constructor)&&Ls(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const y8=pi("ArrayBuffer");function Cq(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&y8(e.buffer),t}const Rq=d1("string"),Ls=d1("function"),v8=d1("number"),V0=e=>e!==null&&typeof e=="object",jq=e=>e===!0||e===!1,Nx=e=>{if(f1(e)!=="object")return!1;const t=PE(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(g8 in e)&&!(u1 in e)},Oq=e=>{if(!V0(e)||H0(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Dq=pi("Date"),Iq=pi("File"),Mq=pi("Blob"),Fq=pi("FileList"),Pq=e=>V0(e)&&Ls(e.pipe),Lq=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ls(e.append)&&((t=f1(e))==="formdata"||t==="object"&&Ls(e.toString)&&e.toString()==="[object FormData]"))},Bq=pi("URLSearchParams"),[Uq,zq,Hq,Vq]=["ReadableStream","Request","Response","Headers"].map(pi),qq=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function q0(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),ad(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(H0(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let o;for(n=0;n<i;n++)o=a[n],t.call(null,e[o],o,e)}}function b8(e,t){if(H0(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const Sc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,w8=e=>!kf(e)&&e!==Sc;function h_(){const{caseless:e,skipUndefined:t}=w8(this)&&this||{},r={},n=(s,a)=>{const i=e&&b8(r,a)||a;Nx(r[i])&&Nx(s)?r[i]=h_(r[i],s):Nx(s)?r[i]=h_({},s):ad(s)?r[i]=s.slice():(!t||!kf(s))&&(r[i]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&q0(arguments[s],n);return r}const Wq=(e,t,r,{allOwnKeys:n}={})=>(q0(t,(s,a)=>{r&&Ls(s)?Object.defineProperty(e,a,{value:x8(s,r),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(e,a,{value:s,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:n}),e),$q=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Gq=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Kq=(e,t,r,n)=>{let s,a,i;const o={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)i=s[a],(!n||n(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=r!==!1&&PE(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Xq=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},Yq=e=>{if(!e)return null;if(ad(e))return e;let t=e.length;if(!v8(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},Jq=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&PE(Uint8Array)),Zq=(e,t)=>{const n=(e&&e[u1]).call(e);let s;for(;(s=n.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},Qq=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},eW=pi("HTMLFormElement"),tW=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),W4=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),rW=pi("RegExp"),_8=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};q0(r,(s,a)=>{let i;(i=t(s,a,e))!==!1&&(n[a]=i||s)}),Object.defineProperties(e,n)},nW=e=>{_8(e,(t,r)=>{if(Ls(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Ls(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},sW=(e,t)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return ad(e)?n(e):n(String(e).split(t)),r},aW=()=>{},iW=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function oW(e){return!!(e&&Ls(e.append)&&e[g8]==="FormData"&&e[u1])}const lW=e=>{const t=new Array(10),r=(n,s)=>{if(V0(n)){if(t.indexOf(n)>=0)return;if(H0(n))return n;if(!("toJSON"in n)){t[s]=n;const a=ad(n)?[]:{};return q0(n,(i,o)=>{const c=r(i,s+1);!kf(c)&&(a[o]=c)}),t[s]=void 0,a}}return n};return r(e,0)},cW=pi("AsyncFunction"),uW=e=>e&&(V0(e)||Ls(e))&&Ls(e.then)&&Ls(e.catch),E8=((e,t)=>e?setImmediate:t?((r,n)=>(Sc.addEventListener("message",({source:s,data:a})=>{s===Sc&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),Sc.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ls(Sc.postMessage)),fW=typeof queueMicrotask<"u"?queueMicrotask.bind(Sc):typeof process<"u"&&process.nextTick||E8,dW=e=>e!=null&&Ls(e[u1]),Me={isArray:ad,isArrayBuffer:y8,isBuffer:H0,isFormData:Lq,isArrayBufferView:Cq,isString:Rq,isNumber:v8,isBoolean:jq,isObject:V0,isPlainObject:Nx,isEmptyObject:Oq,isReadableStream:Uq,isRequest:zq,isResponse:Hq,isHeaders:Vq,isUndefined:kf,isDate:Dq,isFile:Iq,isBlob:Mq,isRegExp:rW,isFunction:Ls,isStream:Pq,isURLSearchParams:Bq,isTypedArray:Jq,isFileList:Fq,forEach:q0,merge:h_,extend:Wq,trim:qq,stripBOM:$q,inherits:Gq,toFlatObject:Kq,kindOf:f1,kindOfTest:pi,endsWith:Xq,toArray:Yq,forEachEntry:Zq,matchAll:Qq,isHTMLForm:eW,hasOwnProperty:W4,hasOwnProp:W4,reduceDescriptors:_8,freezeMethods:nW,toObjectSet:sW,toCamelCase:tW,noop:aW,toFiniteNumber:iW,findKey:b8,global:Sc,isContextDefined:w8,isSpecCompliantForm:oW,toJSONObject:lW,isAsyncFn:cW,isThenable:uW,setImmediate:E8,asap:fW,isIterable:dW};let Et=class S8 extends Error{static from(t,r,n,s,a,i){const o=new S8(t.message,r||t.code,n,s,a);return o.cause=t,o.name=t.name,i&&Object.assign(o,i),o}constructor(t,r,n,s,a){super(t),this.name="AxiosError",this.isAxiosError=!0,r&&(this.code=r),n&&(this.config=n),s&&(this.request=s),a&&(this.response=a,this.status=a.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Me.toJSONObject(this.config),code:this.code,status:this.status}}};Et.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";Et.ERR_BAD_OPTION="ERR_BAD_OPTION";Et.ECONNABORTED="ECONNABORTED";Et.ETIMEDOUT="ETIMEDOUT";Et.ERR_NETWORK="ERR_NETWORK";Et.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";Et.ERR_DEPRECATED="ERR_DEPRECATED";Et.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";Et.ERR_BAD_REQUEST="ERR_BAD_REQUEST";Et.ERR_CANCELED="ERR_CANCELED";Et.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";Et.ERR_INVALID_URL="ERR_INVALID_URL";const hW=null;function p_(e){return Me.isPlainObject(e)||Me.isArray(e)}function N8(e){return Me.endsWith(e,"[]")?e.slice(0,-2):e}function $4(e,t,r){return e?e.concat(t).map(function(s,a){return s=N8(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}function pW(e){return Me.isArray(e)&&!e.some(p_)}const mW=Me.toFlatObject(Me,{},null,function(t){return/^is[A-Z]/.test(t)});function h1(e,t,r){if(!Me.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Me.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,w){return!Me.isUndefined(w[y])});const n=r.metaTokens,s=r.visitor||h,a=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Me.isSpecCompliantForm(t);if(!Me.isFunction(s))throw new TypeError("visitor must be a function");function f(v){if(v===null)return"";if(Me.isDate(v))return v.toISOString();if(Me.isBoolean(v))return v.toString();if(!c&&Me.isBlob(v))throw new Et("Blob is not supported. Use a Buffer instead.");return Me.isArrayBuffer(v)||Me.isTypedArray(v)?c&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function h(v,y,w){let _=v;if(v&&!w&&typeof v=="object"){if(Me.endsWith(y,"{}"))y=n?y:y.slice(0,-2),v=JSON.stringify(v);else if(Me.isArray(v)&&pW(v)||(Me.isFileList(v)||Me.endsWith(y,"[]"))&&(_=Me.toArray(v)))return y=N8(y),_.forEach(function(E,N){!(Me.isUndefined(E)||E===null)&&t.append(i===!0?$4([y],N,a):i===null?y:y+"[]",f(E))}),!1}return p_(v)?!0:(t.append($4(w,y,a),f(v)),!1)}const p=[],x=Object.assign(mW,{defaultVisitor:h,convertValue:f,isVisitable:p_});function g(v,y){if(!Me.isUndefined(v)){if(p.indexOf(v)!==-1)throw Error("Circular reference detected in "+y.join("."));p.push(v),Me.forEach(v,function(_,S){(!(Me.isUndefined(_)||_===null)&&s.call(t,_,Me.isString(S)?S.trim():S,y,x))===!0&&g(_,y?y.concat(S):[S])}),p.pop()}}if(!Me.isObject(e))throw new TypeError("data must be an object");return g(e),t}function G4(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function LE(e,t){this._pairs=[],e&&h1(e,this,t)}const T8=LE.prototype;T8.append=function(t,r){this._pairs.push([t,r])};T8.toString=function(t){const r=t?function(n){return t.call(this,n,G4)}:G4;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function xW(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function k8(e,t,r){if(!t)return e;const n=r&&r.encode||xW,s=Me.isFunction(r)?{serialize:r}:r,a=s&&s.serialize;let i;if(a?i=a(t,s):i=Me.isURLSearchParams(t)?t.toString():new LE(t,s).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class K4{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Me.forEach(this.handlers,function(n){n!==null&&t(n)})}}const A8={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gW=typeof URLSearchParams<"u"?URLSearchParams:LE,yW=typeof FormData<"u"?FormData:null,vW=typeof Blob<"u"?Blob:null,bW={isBrowser:!0,classes:{URLSearchParams:gW,FormData:yW,Blob:vW},protocols:["http","https","file","blob","url","data"]},BE=typeof window<"u"&&typeof document<"u",m_=typeof navigator=="object"&&navigator||void 0,wW=BE&&(!m_||["ReactNative","NativeScript","NS"].indexOf(m_.product)<0),_W=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",EW=BE&&window.location.href||"http://localhost",SW=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:BE,hasStandardBrowserEnv:wW,hasStandardBrowserWebWorkerEnv:_W,navigator:m_,origin:EW},Symbol.toStringTag,{value:"Module"})),ls={...SW,...bW};function NW(e,t){return h1(e,new ls.classes.URLSearchParams,{visitor:function(r,n,s,a){return ls.isNode&&Me.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function TW(e){return Me.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function kW(e){const t={},r=Object.keys(e);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],t[a]=e[a];return t}function C8(e){function t(r,n,s,a){let i=r[a++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),c=a>=r.length;return i=!i&&Me.isArray(s)?s.length:i,c?(Me.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!o):((!s[i]||!Me.isObject(s[i]))&&(s[i]=[]),t(r,n,s[i],a)&&Me.isArray(s[i])&&(s[i]=kW(s[i])),!o)}if(Me.isFormData(e)&&Me.isFunction(e.entries)){const r={};return Me.forEachEntry(e,(n,s)=>{t(TW(n),s,r,0)}),r}return null}function AW(e,t,r){if(Me.isString(e))try{return(t||JSON.parse)(e),Me.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const W0={transitional:A8,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=Me.isObject(t);if(a&&Me.isHTMLForm(t)&&(t=new FormData(t)),Me.isFormData(t))return s?JSON.stringify(C8(t)):t;if(Me.isArrayBuffer(t)||Me.isBuffer(t)||Me.isStream(t)||Me.isFile(t)||Me.isBlob(t)||Me.isReadableStream(t))return t;if(Me.isArrayBufferView(t))return t.buffer;if(Me.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return NW(t,this.formSerializer).toString();if((o=Me.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return h1(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),AW(t)):t}],transformResponse:[function(t){const r=this.transitional||W0.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Me.isResponse(t)||Me.isReadableStream(t))return t;if(t&&Me.isString(t)&&(n&&!this.responseType||s)){const i=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(o){if(i)throw o.name==="SyntaxError"?Et.from(o,Et.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ls.classes.FormData,Blob:ls.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Me.forEach(["delete","get","head","post","put","patch"],e=>{W0.headers[e]={}});const CW=Me.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),RW=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(i){s=i.indexOf(":"),r=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!r||t[r]&&CW[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},X4=Symbol("internals");function uh(e){return e&&String(e).trim().toLowerCase()}function Tx(e){return e===!1||e==null?e:Me.isArray(e)?e.map(Tx):String(e)}function jW(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const OW=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function xb(e,t,r,n,s){if(Me.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!Me.isString(t)){if(Me.isString(n))return t.indexOf(n)!==-1;if(Me.isRegExp(n))return n.test(t)}}function DW(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function IW(e,t){const r=Me.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,a,i){return this[n].call(this,t,s,a,i)},configurable:!0})})}let Bs=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function a(o,c,f){const h=uh(c);if(!h)throw new Error("header name must be a non-empty string");const p=Me.findKey(s,h);(!p||s[p]===void 0||f===!0||f===void 0&&s[p]!==!1)&&(s[p||c]=Tx(o))}const i=(o,c)=>Me.forEach(o,(f,h)=>a(f,h,c));if(Me.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(Me.isString(t)&&(t=t.trim())&&!OW(t))i(RW(t),r);else if(Me.isObject(t)&&Me.isIterable(t)){let o={},c,f;for(const h of t){if(!Me.isArray(h))throw TypeError("Object iterator must return a key-value pair");o[f=h[0]]=(c=o[f])?Me.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}i(o,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=uh(t),t){const n=Me.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return jW(s);if(Me.isFunction(r))return r.call(this,s,n);if(Me.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=uh(t),t){const n=Me.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||xb(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function a(i){if(i=uh(i),i){const o=Me.findKey(n,i);o&&(!r||xb(n,n[o],o,r))&&(delete n[o],s=!0)}}return Me.isArray(t)?t.forEach(a):a(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!t||xb(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const r=this,n={};return Me.forEach(this,(s,a)=>{const i=Me.findKey(n,a);if(i){r[i]=Tx(s),delete r[a];return}const o=t?DW(a):String(a).trim();o!==a&&delete r[a],r[o]=Tx(s),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Me.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&Me.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[X4]=this[X4]={accessors:{}}).accessors,s=this.prototype;function a(i){const o=uh(i);n[o]||(IW(s,i),n[o]=!0)}return Me.isArray(t)?t.forEach(a):a(t),this}};Bs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Me.reduceDescriptors(Bs.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Me.freezeMethods(Bs);function gb(e,t){const r=this||W0,n=t||r,s=Bs.from(n.headers);let a=n.data;return Me.forEach(e,function(o){a=o.call(r,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function R8(e){return!!(e&&e.__CANCEL__)}let $0=class extends Et{constructor(t,r,n){super(t??"canceled",Et.ERR_CANCELED,r,n),this.name="CanceledError",this.__CANCEL__=!0}};function j8(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Et("Request failed with status code "+r.status,[Et.ERR_BAD_REQUEST,Et.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function MW(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function FW(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,a=0,i;return t=t!==void 0?t:1e3,function(c){const f=Date.now(),h=n[a];i||(i=f),r[s]=c,n[s]=f;let p=a,x=0;for(;p!==s;)x+=r[p++],p=p%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),f-i<t)return;const g=h&&f-h;return g?Math.round(x*1e3/g):void 0}}function PW(e,t){let r=0,n=1e3/t,s,a;const i=(f,h=Date.now())=>{r=h,s=null,a&&(clearTimeout(a),a=null),e(...f)};return[(...f)=>{const h=Date.now(),p=h-r;p>=n?i(f,h):(s=f,a||(a=setTimeout(()=>{a=null,i(s)},n-p)))},()=>s&&i(s)]}const Wx=(e,t,r=3)=>{let n=0;const s=FW(50,250);return PW(a=>{const i=a.loaded,o=a.lengthComputable?a.total:void 0,c=i-n,f=s(c),h=i<=o;n=i;const p={loaded:i,total:o,progress:o?i/o:void 0,bytes:c,rate:f||void 0,estimated:f&&o&&h?(o-i)/f:void 0,event:a,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(p)},r)},Y4=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},J4=e=>(...t)=>Me.asap(()=>e(...t)),LW=ls.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ls.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ls.origin),ls.navigator&&/(msie|trident)/i.test(ls.navigator.userAgent)):()=>!0,BW=ls.hasStandardBrowserEnv?{write(e,t,r,n,s,a,i){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];Me.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),Me.isString(n)&&o.push(`path=${n}`),Me.isString(s)&&o.push(`domain=${s}`),a===!0&&o.push("secure"),Me.isString(i)&&o.push(`SameSite=${i}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function UW(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function zW(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function O8(e,t,r){let n=!UW(t);return e&&(n||r==!1)?zW(e,t):t}const Z4=e=>e instanceof Bs?{...e}:e;function Gc(e,t){t=t||{};const r={};function n(f,h,p,x){return Me.isPlainObject(f)&&Me.isPlainObject(h)?Me.merge.call({caseless:x},f,h):Me.isPlainObject(h)?Me.merge({},h):Me.isArray(h)?h.slice():h}function s(f,h,p,x){if(Me.isUndefined(h)){if(!Me.isUndefined(f))return n(void 0,f,p,x)}else return n(f,h,p,x)}function a(f,h){if(!Me.isUndefined(h))return n(void 0,h)}function i(f,h){if(Me.isUndefined(h)){if(!Me.isUndefined(f))return n(void 0,f)}else return n(void 0,h)}function o(f,h,p){if(p in t)return n(f,h);if(p in e)return n(void 0,f)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(f,h,p)=>s(Z4(f),Z4(h),p,!0)};return Me.forEach(Object.keys({...e,...t}),function(h){const p=c[h]||s,x=p(e[h],t[h],h);Me.isUndefined(x)&&p!==o||(r[h]=x)}),r}const D8=e=>{const t=Gc({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:i,auth:o}=t;if(t.headers=i=Bs.from(i),t.url=k8(O8(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Me.isFormData(r)){if(ls.hasStandardBrowserEnv||ls.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Me.isFunction(r.getHeaders)){const c=r.getHeaders(),f=["content-type","content-length"];Object.entries(c).forEach(([h,p])=>{f.includes(h.toLowerCase())&&i.set(h,p)})}}if(ls.hasStandardBrowserEnv&&(n&&Me.isFunction(n)&&(n=n(t)),n||n!==!1&&LW(t.url))){const c=s&&a&&BW.read(a);c&&i.set(s,c)}return t},HW=typeof XMLHttpRequest<"u",VW=HW&&function(e){return new Promise(function(r,n){const s=D8(e);let a=s.data;const i=Bs.from(s.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:f}=s,h,p,x,g,v;function y(){g&&g(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(h),s.signal&&s.signal.removeEventListener("abort",h)}let w=new XMLHttpRequest;w.open(s.method.toUpperCase(),s.url,!0),w.timeout=s.timeout;function _(){if(!w)return;const E=Bs.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),k={data:!o||o==="text"||o==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:E,config:e,request:w};j8(function(R){r(R),y()},function(R){n(R),y()},k),w=null}"onloadend"in w?w.onloadend=_:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(_)},w.onabort=function(){w&&(n(new Et("Request aborted",Et.ECONNABORTED,e,w)),w=null)},w.onerror=function(N){const k=N&&N.message?N.message:"Network Error",O=new Et(k,Et.ERR_NETWORK,e,w);O.event=N||null,n(O),w=null},w.ontimeout=function(){let N=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const k=s.transitional||A8;s.timeoutErrorMessage&&(N=s.timeoutErrorMessage),n(new Et(N,k.clarifyTimeoutError?Et.ETIMEDOUT:Et.ECONNABORTED,e,w)),w=null},a===void 0&&i.setContentType(null),"setRequestHeader"in w&&Me.forEach(i.toJSON(),function(N,k){w.setRequestHeader(k,N)}),Me.isUndefined(s.withCredentials)||(w.withCredentials=!!s.withCredentials),o&&o!=="json"&&(w.responseType=s.responseType),f&&([x,v]=Wx(f,!0),w.addEventListener("progress",x)),c&&w.upload&&([p,g]=Wx(c),w.upload.addEventListener("progress",p),w.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(h=E=>{w&&(n(!E||E.type?new $0(null,e,w):E),w.abort(),w=null)},s.cancelToken&&s.cancelToken.subscribe(h),s.signal&&(s.signal.aborted?h():s.signal.addEventListener("abort",h)));const S=MW(s.url);if(S&&ls.protocols.indexOf(S)===-1){n(new Et("Unsupported protocol "+S+":",Et.ERR_BAD_REQUEST,e));return}w.send(a||null)})},qW=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const a=function(f){if(!s){s=!0,o();const h=f instanceof Error?f:this.reason;n.abort(h instanceof Et?h:new $0(h instanceof Error?h.message:h))}};let i=t&&setTimeout(()=>{i=null,a(new Et(`timeout of ${t}ms exceeded`,Et.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),e=null)};e.forEach(f=>f.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>Me.asap(o),c}},WW=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},$W=async function*(e,t){for await(const r of GW(e))yield*WW(r,t)},GW=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Q4=(e,t,r,n)=>{const s=$W(e,t);let a=0,i,o=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:f,value:h}=await s.next();if(f){o(),c.close();return}let p=h.byteLength;if(r){let x=a+=p;r(x)}c.enqueue(new Uint8Array(h))}catch(f){throw o(f),f}},cancel(c){return o(c),s.return()}},{highWaterMark:2})},e3=64*1024,{isFunction:Mm}=Me,KW=(({Request:e,Response:t})=>({Request:e,Response:t}))(Me.global),{ReadableStream:t3,TextEncoder:r3}=Me.global,n3=(e,...t)=>{try{return!!e(...t)}catch{return!1}},XW=e=>{e=Me.merge.call({skipUndefined:!0},KW,e);const{fetch:t,Request:r,Response:n}=e,s=t?Mm(t):typeof fetch=="function",a=Mm(r),i=Mm(n);if(!s)return!1;const o=s&&Mm(t3),c=s&&(typeof r3=="function"?(v=>y=>v.encode(y))(new r3):async v=>new Uint8Array(await new r(v).arrayBuffer())),f=a&&o&&n3(()=>{let v=!1;const y=new r(ls.origin,{body:new t3,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!y}),h=i&&o&&n3(()=>Me.isReadableStream(new n("").body)),p={stream:h&&(v=>v.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!p[v]&&(p[v]=(y,w)=>{let _=y&&y[v];if(_)return _.call(y);throw new Et(`Response type '${v}' is not supported`,Et.ERR_NOT_SUPPORT,w)})});const x=async v=>{if(v==null)return 0;if(Me.isBlob(v))return v.size;if(Me.isSpecCompliantForm(v))return(await new r(ls.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(Me.isArrayBufferView(v)||Me.isArrayBuffer(v))return v.byteLength;if(Me.isURLSearchParams(v)&&(v=v+""),Me.isString(v))return(await c(v)).byteLength},g=async(v,y)=>{const w=Me.toFiniteNumber(v.getContentLength());return w??x(y)};return async v=>{let{url:y,method:w,data:_,signal:S,cancelToken:E,timeout:N,onDownloadProgress:k,onUploadProgress:O,responseType:R,headers:V,withCredentials:I="same-origin",fetchOptions:Z}=D8(v),ce=t||fetch;R=R?(R+"").toLowerCase():"text";let F=qW([S,E&&E.toAbortSignal()],N),X=null;const P=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let ie;try{if(O&&f&&w!=="get"&&w!=="head"&&(ie=await g(V,_))!==0){let K=new r(y,{method:"POST",body:_,duplex:"half"}),D;if(Me.isFormData(_)&&(D=K.headers.get("content-type"))&&V.setContentType(D),K.body){const[q,W]=Y4(ie,Wx(J4(O)));_=Q4(K.body,e3,q,W)}}Me.isString(I)||(I=I?"include":"omit");const te=a&&"credentials"in r.prototype,Y={...Z,signal:F,method:w.toUpperCase(),headers:V.normalize().toJSON(),body:_,duplex:"half",credentials:te?I:void 0};X=a&&new r(y,Y);let ve=await(a?ce(X,Z):ce(y,Y));const oe=h&&(R==="stream"||R==="response");if(h&&(k||oe&&P)){const K={};["status","statusText","headers"].forEach(J=>{K[J]=ve[J]});const D=Me.toFiniteNumber(ve.headers.get("content-length")),[q,W]=k&&Y4(D,Wx(J4(k),!0))||[];ve=new n(Q4(ve.body,e3,q,()=>{W&&W(),P&&P()}),K)}R=R||"text";let Ee=await p[Me.findKey(p,R)||"text"](ve,v);return!oe&&P&&P(),await new Promise((K,D)=>{j8(K,D,{data:Ee,headers:Bs.from(ve.headers),status:ve.status,statusText:ve.statusText,config:v,request:X})})}catch(te){throw P&&P(),te&&te.name==="TypeError"&&/Load failed|fetch/i.test(te.message)?Object.assign(new Et("Network Error",Et.ERR_NETWORK,v,X),{cause:te.cause||te}):Et.from(te,te&&te.code,v,X)}}},YW=new Map,I8=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:s}=t,a=[n,s,r];let i=a.length,o=i,c,f,h=YW;for(;o--;)c=a[o],f=h.get(c),f===void 0&&h.set(c,f=o?new Map:XW(t)),h=f;return f};I8();const UE={http:hW,xhr:VW,fetch:{get:I8}};Me.forEach(UE,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const s3=e=>`- ${e}`,JW=e=>Me.isFunction(e)||e===null||e===!1;function ZW(e,t){e=Me.isArray(e)?e:[e];const{length:r}=e;let n,s;const a={};for(let i=0;i<r;i++){n=e[i];let o;if(s=n,!JW(n)&&(s=UE[(o=String(n)).toLowerCase()],s===void 0))throw new Et(`Unknown adapter '${o}'`);if(s&&(Me.isFunction(s)||(s=s.get(t))))break;a[o||"#"+i]=s}if(!s){const i=Object.entries(a).map(([c,f])=>`adapter ${c} `+(f===!1?"is not supported by the environment":"is not available in the build"));let o=r?i.length>1?`since :
`+i.map(s3).join(`
`):" "+s3(i[0]):"as no adapter specified";throw new Et("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s}const M8={getAdapter:ZW,adapters:UE};function yb(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new $0(null,e)}function a3(e){return yb(e),e.headers=Bs.from(e.headers),e.data=gb.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),M8.getAdapter(e.adapter||W0.adapter,e)(e).then(function(n){return yb(e),n.data=gb.call(e,e.transformResponse,n),n.headers=Bs.from(n.headers),n},function(n){return R8(n)||(yb(e),n&&n.response&&(n.response.data=gb.call(e,e.transformResponse,n.response),n.response.headers=Bs.from(n.response.headers))),Promise.reject(n)})}const F8="1.13.4",p1={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{p1[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const i3={};p1.transitional=function(t,r,n){function s(a,i){return"[Axios v"+F8+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,o)=>{if(t===!1)throw new Et(s(i," has been removed"+(r?" in "+r:"")),Et.ERR_DEPRECATED);return r&&!i3[i]&&(i3[i]=!0,console.warn(s(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,o):!0}};p1.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function QW(e,t,r){if(typeof e!="object")throw new Et("options must be an object",Et.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const a=n[s],i=t[a];if(i){const o=e[a],c=o===void 0||i(o,a,e);if(c!==!0)throw new Et("option "+a+" must be "+c,Et.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Et("Unknown option "+a,Et.ERR_BAD_OPTION)}}const kx={assertOptions:QW,validators:p1},Si=kx.validators;let Dc=class{constructor(t){this.defaults=t||{},this.interceptors={request:new K4,response:new K4}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Gc(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&kx.assertOptions(n,{silentJSONParsing:Si.transitional(Si.boolean),forcedJSONParsing:Si.transitional(Si.boolean),clarifyTimeoutError:Si.transitional(Si.boolean)},!1),s!=null&&(Me.isFunction(s)?r.paramsSerializer={serialize:s}:kx.assertOptions(s,{encode:Si.function,serialize:Si.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),kx.assertOptions(r,{baseUrl:Si.spelling("baseURL"),withXsrfToken:Si.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&Me.merge(a.common,a[r.method]);a&&Me.forEach(["delete","get","head","post","put","patch","common"],v=>{delete a[v]}),r.headers=Bs.concat(i,a);const o=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(c=c&&y.synchronous,o.unshift(y.fulfilled,y.rejected))});const f=[];this.interceptors.response.forEach(function(y){f.push(y.fulfilled,y.rejected)});let h,p=0,x;if(!c){const v=[a3.bind(this),void 0];for(v.unshift(...o),v.push(...f),x=v.length,h=Promise.resolve(r);p<x;)h=h.then(v[p++],v[p++]);return h}x=o.length;let g=r;for(;p<x;){const v=o[p++],y=o[p++];try{g=v(g)}catch(w){y.call(this,w);break}}try{h=a3.call(this,g)}catch(v){return Promise.reject(v)}for(p=0,x=f.length;p<x;)h=h.then(f[p++],f[p++]);return h}getUri(t){t=Gc(this.defaults,t);const r=O8(t.baseURL,t.url,t.allowAbsoluteUrls);return k8(r,t.params,t.paramsSerializer)}};Me.forEach(["delete","get","head","options"],function(t){Dc.prototype[t]=function(r,n){return this.request(Gc(n||{},{method:t,url:r,data:(n||{}).data}))}});Me.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,o){return this.request(Gc(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}Dc.prototype[t]=r(),Dc.prototype[t+"Form"]=r(!0)});let e$=class P8{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const i=new Promise(o=>{n.subscribe(o),a=o}).then(s);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,o){n.reason||(n.reason=new $0(a,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new P8(function(s){t=s}),cancel:t}}};function t$(e){return function(r){return e.apply(null,r)}}function r$(e){return Me.isObject(e)&&e.isAxiosError===!0}const x_={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(x_).forEach(([e,t])=>{x_[t]=e});function L8(e){const t=new Dc(e),r=x8(Dc.prototype.request,t);return Me.extend(r,Dc.prototype,t,{allOwnKeys:!0}),Me.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return L8(Gc(e,s))},r}const Zr=L8(W0);Zr.Axios=Dc;Zr.CanceledError=$0;Zr.CancelToken=e$;Zr.isCancel=R8;Zr.VERSION=F8;Zr.toFormData=h1;Zr.AxiosError=Et;Zr.Cancel=Zr.CanceledError;Zr.all=function(t){return Promise.all(t)};Zr.spread=t$;Zr.isAxiosError=r$;Zr.mergeConfig=Gc;Zr.AxiosHeaders=Bs;Zr.formToJSON=e=>C8(Me.isHTMLForm(e)?new FormData(e):e);Zr.getAdapter=M8.getAdapter;Zr.HttpStatusCode=x_;Zr.default=Zr;const{Axios:$we,AxiosError:Gwe,CanceledError:Kwe,isCancel:Xwe,CancelToken:Ywe,VERSION:Jwe,all:Zwe,Cancel:Qwe,isAxiosError:e2e,spread:t2e,toFormData:r2e,AxiosHeaders:n2e,HttpStatusCode:s2e,formToJSON:a2e,getAdapter:i2e,mergeConfig:o2e}=Zr;var n$=AO();const B8=bE(n$);function s$(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const a$=e=>{switch(e){case"success":return l$;case"info":return u$;case"warning":return c$;case"error":return f$;default:return null}},i$=Array(12).fill(0),o$=({visible:e,className:t})=>We.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},We.createElement("div",{className:"sonner-spinner"},i$.map((r,n)=>We.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),l$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),c$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),u$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),f$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),d$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},We.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),We.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),h$=()=>{const[e,t]=We.useState(document.hidden);return We.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let g_=1;class p${constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:n,...s}=t,a=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:g_++,i=this.toasts.find(c=>c.id===a),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...t,id:a,title:n}),{...c,...t,id:a,dismissible:o,title:n}):c):this.addToast({title:n,...s,dismissible:o,id:a}),a},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let a=n!==void 0,i;const o=s.then(async f=>{if(i=["resolve",f],We.isValidElement(f))a=!1,this.create({id:n,type:"default",message:f});else if(x$(f)&&!f.ok){a=!1;const p=typeof r.error=="function"?await r.error(`HTTP error! status: ${f.status}`):r.error,x=typeof r.description=="function"?await r.description(`HTTP error! status: ${f.status}`):r.description,v=typeof p=="object"&&!We.isValidElement(p)?p:{message:p};this.create({id:n,type:"error",description:x,...v})}else if(f instanceof Error){a=!1;const p=typeof r.error=="function"?await r.error(f):r.error,x=typeof r.description=="function"?await r.description(f):r.description,v=typeof p=="object"&&!We.isValidElement(p)?p:{message:p};this.create({id:n,type:"error",description:x,...v})}else if(r.success!==void 0){a=!1;const p=typeof r.success=="function"?await r.success(f):r.success,x=typeof r.description=="function"?await r.description(f):r.description,v=typeof p=="object"&&!We.isValidElement(p)?p:{message:p};this.create({id:n,type:"success",description:x,...v})}}).catch(async f=>{if(i=["reject",f],r.error!==void 0){a=!1;const h=typeof r.error=="function"?await r.error(f):r.error,p=typeof r.description=="function"?await r.description(f):r.description,g=typeof h=="object"&&!We.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:p,...g})}}).finally(()=>{a&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),c=()=>new Promise((f,h)=>o.then(()=>i[0]==="reject"?h(i[1]):f(i[1])).catch(h));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(t,r)=>{const n=(r==null?void 0:r.id)||g_++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Ms=new p$,m$=(e,t)=>{const r=(t==null?void 0:t.id)||g_++;return Ms.addToast({title:e,...t,id:r}),r},x$=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",g$=m$,y$=()=>Ms.toasts,v$=()=>Ms.getActiveToasts(),wn=Object.assign(g$,{success:Ms.success,info:Ms.info,warning:Ms.warning,error:Ms.error,custom:Ms.custom,message:Ms.message,promise:Ms.promise,dismiss:Ms.dismiss,loading:Ms.loading},{getHistory:y$,getToasts:v$});s$("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Fm(e){return e.label!==void 0}const b$=3,w$="24px",_$="16px",o3=4e3,E$=356,S$=14,N$=45,T$=200;function Ni(...e){return e.filter(Boolean).join(" ")}function k$(e){const[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}const A$=e=>{var t,r,n,s,a,i,o,c,f;const{invert:h,toast:p,unstyled:x,interacting:g,setHeights:v,visibleToasts:y,heights:w,index:_,toasts:S,expanded:E,removeToast:N,defaultRichColors:k,closeButton:O,style:R,cancelButtonStyle:V,actionButtonStyle:I,className:Z="",descriptionClassName:ce="",duration:F,position:X,gap:P,expandByDefault:ie,classNames:te,icons:Y,closeButtonAriaLabel:ve="Close toast"}=e,[oe,Ee]=We.useState(null),[K,D]=We.useState(null),[q,W]=We.useState(!1),[J,re]=We.useState(!1),[U,L]=We.useState(!1),[se,Q]=We.useState(!1),[ee,B]=We.useState(!1),[be,z]=We.useState(0),[he,M]=We.useState(0),A=We.useRef(p.duration||F||o3),j=We.useRef(null),H=We.useRef(null),ue=_===0,ye=_+1<=y,pe=p.type,Ne=p.dismissible!==!1,De=p.className||"",Fe=p.descriptionClassName||"",Ke=We.useMemo(()=>w.findIndex(wt=>wt.toastId===p.id)||0,[w,p.id]),st=We.useMemo(()=>{var wt;return(wt=p.closeButton)!=null?wt:O},[p.closeButton,O]),at=We.useMemo(()=>p.duration||F||o3,[p.duration,F]),Gt=We.useRef(0),dt=We.useRef(0),Lt=We.useRef(0),pr=We.useRef(null),[vt,or]=X.split("-"),Tn=We.useMemo(()=>w.reduce((wt,gr,sn)=>sn>=Ke?wt:wt+gr.height,0),[w,Ke]),lr=h$(),qo=p.invert||h,mi=pe==="loading";dt.current=We.useMemo(()=>Ke*P+Tn,[Ke,Tn]),We.useEffect(()=>{A.current=at},[at]),We.useEffect(()=>{W(!0)},[]),We.useEffect(()=>{const wt=H.current;if(wt){const gr=wt.getBoundingClientRect().height;return M(gr),v(sn=>[{toastId:p.id,height:gr,position:p.position},...sn]),()=>v(sn=>sn.filter(kn=>kn.toastId!==p.id))}},[v,p.id]),We.useLayoutEffect(()=>{if(!q)return;const wt=H.current,gr=wt.style.height;wt.style.height="auto";const sn=wt.getBoundingClientRect().height;wt.style.height=gr,M(sn),v(kn=>kn.find(br=>br.toastId===p.id)?kn.map(br=>br.toastId===p.id?{...br,height:sn}:br):[{toastId:p.id,height:sn,position:p.position},...kn])},[q,p.title,p.description,v,p.id,p.jsx,p.action,p.cancel]);const xs=We.useCallback(()=>{re(!0),z(dt.current),v(wt=>wt.filter(gr=>gr.toastId!==p.id)),setTimeout(()=>{N(p)},T$)},[p,N,v,dt]);We.useEffect(()=>{if(p.promise&&pe==="loading"||p.duration===1/0||p.type==="loading")return;let wt;return E||g||lr?(()=>{if(Lt.current<Gt.current){const kn=new Date().getTime()-Gt.current;A.current=A.current-kn}Lt.current=new Date().getTime()})():(()=>{A.current!==1/0&&(Gt.current=new Date().getTime(),wt=setTimeout(()=>{p.onAutoClose==null||p.onAutoClose.call(p,p),xs()},A.current))})(),()=>clearTimeout(wt)},[E,g,p,pe,lr,xs]),We.useEffect(()=>{p.delete&&(xs(),p.onDismiss==null||p.onDismiss.call(p,p))},[xs,p.delete]);function Ya(){var wt;if(Y!=null&&Y.loading){var gr;return We.createElement("div",{className:Ni(te==null?void 0:te.loader,p==null||(gr=p.classNames)==null?void 0:gr.loader,"sonner-loader"),"data-visible":pe==="loading"},Y.loading)}return We.createElement(o$,{className:Ni(te==null?void 0:te.loader,p==null||(wt=p.classNames)==null?void 0:wt.loader),visible:pe==="loading"})}const Ja=p.icon||(Y==null?void 0:Y[pe])||a$(pe);var gs,nn;return We.createElement("li",{tabIndex:0,ref:H,className:Ni(Z,De,te==null?void 0:te.toast,p==null||(t=p.classNames)==null?void 0:t.toast,te==null?void 0:te.default,te==null?void 0:te[pe],p==null||(r=p.classNames)==null?void 0:r[pe]),"data-sonner-toast":"","data-rich-colors":(gs=p.richColors)!=null?gs:k,"data-styled":!(p.jsx||p.unstyled||x),"data-mounted":q,"data-promise":!!p.promise,"data-swiped":ee,"data-removed":J,"data-visible":ye,"data-y-position":vt,"data-x-position":or,"data-index":_,"data-front":ue,"data-swiping":U,"data-dismissible":Ne,"data-type":pe,"data-invert":qo,"data-swipe-out":se,"data-swipe-direction":K,"data-expanded":!!(E||ie&&q),"data-testid":p.testId,style:{"--index":_,"--toasts-before":_,"--z-index":S.length-_,"--offset":`${J?be:dt.current}px`,"--initial-height":ie?"auto":`${he}px`,...R,...p.style},onDragEnd:()=>{L(!1),Ee(null),pr.current=null},onPointerDown:wt=>{wt.button!==2&&(mi||!Ne||(j.current=new Date,z(dt.current),wt.target.setPointerCapture(wt.pointerId),wt.target.tagName!=="BUTTON"&&(L(!0),pr.current={x:wt.clientX,y:wt.clientY})))},onPointerUp:()=>{var wt,gr,sn;if(se||!Ne)return;pr.current=null;const kn=Number(((wt=H.current)==null?void 0:wt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),xi=Number(((gr=H.current)==null?void 0:gr.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),br=new Date().getTime()-((sn=j.current)==null?void 0:sn.getTime()),Qn=oe==="x"?kn:xi,Gi=Math.abs(Qn)/br;if(Math.abs(Qn)>=N$||Gi>.11){z(dt.current),p.onDismiss==null||p.onDismiss.call(p,p),D(oe==="x"?kn>0?"right":"left":xi>0?"down":"up"),xs(),Q(!0);return}else{var An,es;(An=H.current)==null||An.style.setProperty("--swipe-amount-x","0px"),(es=H.current)==null||es.style.setProperty("--swipe-amount-y","0px")}B(!1),L(!1),Ee(null)},onPointerMove:wt=>{var gr,sn,kn;if(!pr.current||!Ne||((gr=window.getSelection())==null?void 0:gr.toString().length)>0)return;const br=wt.clientY-pr.current.y,Qn=wt.clientX-pr.current.x;var Gi;const An=(Gi=e.swipeDirections)!=null?Gi:k$(X);!oe&&(Math.abs(Qn)>1||Math.abs(br)>1)&&Ee(Math.abs(Qn)>Math.abs(br)?"x":"y");let es={x:0,y:0};const Wo=$s=>1/(1.5+Math.abs($s)/20);if(oe==="y"){if(An.includes("top")||An.includes("bottom"))if(An.includes("top")&&br<0||An.includes("bottom")&&br>0)es.y=br;else{const $s=br*Wo(br);es.y=Math.abs($s)<Math.abs(br)?$s:br}}else if(oe==="x"&&(An.includes("left")||An.includes("right")))if(An.includes("left")&&Qn<0||An.includes("right")&&Qn>0)es.x=Qn;else{const $s=Qn*Wo(Qn);es.x=Math.abs($s)<Math.abs(Qn)?$s:Qn}(Math.abs(es.x)>0||Math.abs(es.y)>0)&&B(!0),(sn=H.current)==null||sn.style.setProperty("--swipe-amount-x",`${es.x}px`),(kn=H.current)==null||kn.style.setProperty("--swipe-amount-y",`${es.y}px`)}},st&&!p.jsx&&pe!=="loading"?We.createElement("button",{"aria-label":ve,"data-disabled":mi,"data-close-button":!0,onClick:mi||!Ne?()=>{}:()=>{xs(),p.onDismiss==null||p.onDismiss.call(p,p)},className:Ni(te==null?void 0:te.closeButton,p==null||(n=p.classNames)==null?void 0:n.closeButton)},(nn=Y==null?void 0:Y.close)!=null?nn:d$):null,(pe||p.icon||p.promise)&&p.icon!==null&&((Y==null?void 0:Y[pe])!==null||p.icon)?We.createElement("div",{"data-icon":"",className:Ni(te==null?void 0:te.icon,p==null||(s=p.classNames)==null?void 0:s.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||Ya():null,p.type!=="loading"?Ja:null):null,We.createElement("div",{"data-content":"",className:Ni(te==null?void 0:te.content,p==null||(a=p.classNames)==null?void 0:a.content)},We.createElement("div",{"data-title":"",className:Ni(te==null?void 0:te.title,p==null||(i=p.classNames)==null?void 0:i.title)},p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title),p.description?We.createElement("div",{"data-description":"",className:Ni(ce,Fe,te==null?void 0:te.description,p==null||(o=p.classNames)==null?void 0:o.description)},typeof p.description=="function"?p.description():p.description):null),We.isValidElement(p.cancel)?p.cancel:p.cancel&&Fm(p.cancel)?We.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||V,onClick:wt=>{Fm(p.cancel)&&Ne&&(p.cancel.onClick==null||p.cancel.onClick.call(p.cancel,wt),xs())},className:Ni(te==null?void 0:te.cancelButton,p==null||(c=p.classNames)==null?void 0:c.cancelButton)},p.cancel.label):null,We.isValidElement(p.action)?p.action:p.action&&Fm(p.action)?We.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||I,onClick:wt=>{Fm(p.action)&&(p.action.onClick==null||p.action.onClick.call(p.action,wt),!wt.defaultPrevented&&xs())},className:Ni(te==null?void 0:te.actionButton,p==null||(f=p.classNames)==null?void 0:f.actionButton)},p.action.label):null)};function l3(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function C$(e,t){const r={};return[e,t].forEach((n,s)=>{const a=s===1,i=a?"--mobile-offset":"--offset",o=a?_$:w$;function c(f){["top","right","bottom","left"].forEach(h=>{r[`${i}-${h}`]=typeof f=="number"?`${f}px`:f})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(f=>{n[f]===void 0?r[`${i}-${f}`]=o:r[`${i}-${f}`]=typeof n[f]=="number"?`${n[f]}px`:n[f]}):c(o)}),r}const R$=We.forwardRef(function(t,r){const{id:n,invert:s,position:a="bottom-right",hotkey:i=["altKey","KeyT"],expand:o,closeButton:c,className:f,offset:h,mobileOffset:p,theme:x="light",richColors:g,duration:v,style:y,visibleToasts:w=b$,toastOptions:_,dir:S=l3(),gap:E=S$,icons:N,containerAriaLabel:k="Notifications"}=t,[O,R]=We.useState([]),V=We.useMemo(()=>n?O.filter(q=>q.toasterId===n):O.filter(q=>!q.toasterId),[O,n]),I=We.useMemo(()=>Array.from(new Set([a].concat(V.filter(q=>q.position).map(q=>q.position)))),[V,a]),[Z,ce]=We.useState([]),[F,X]=We.useState(!1),[P,ie]=We.useState(!1),[te,Y]=We.useState(x!=="system"?x:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ve=We.useRef(null),oe=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),Ee=We.useRef(null),K=We.useRef(!1),D=We.useCallback(q=>{R(W=>{var J;return(J=W.find(re=>re.id===q.id))!=null&&J.delete||Ms.dismiss(q.id),W.filter(({id:re})=>re!==q.id)})},[]);return We.useEffect(()=>Ms.subscribe(q=>{if(q.dismiss){requestAnimationFrame(()=>{R(W=>W.map(J=>J.id===q.id?{...J,delete:!0}:J))});return}setTimeout(()=>{B8.flushSync(()=>{R(W=>{const J=W.findIndex(re=>re.id===q.id);return J!==-1?[...W.slice(0,J),{...W[J],...q},...W.slice(J+1)]:[q,...W]})})})}),[O]),We.useEffect(()=>{if(x!=="system"){Y(x);return}if(x==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Y("dark"):Y("light")),typeof window>"u")return;const q=window.matchMedia("(prefers-color-scheme: dark)");try{q.addEventListener("change",({matches:W})=>{Y(W?"dark":"light")})}catch{q.addListener(({matches:J})=>{try{Y(J?"dark":"light")}catch(re){console.error(re)}})}},[x]),We.useEffect(()=>{O.length<=1&&X(!1)},[O]),We.useEffect(()=>{const q=W=>{var J;if(i.every(L=>W[L]||W.code===L)){var U;X(!0),(U=ve.current)==null||U.focus()}W.code==="Escape"&&(document.activeElement===ve.current||(J=ve.current)!=null&&J.contains(document.activeElement))&&X(!1)};return document.addEventListener("keydown",q),()=>document.removeEventListener("keydown",q)},[i]),We.useEffect(()=>{if(ve.current)return()=>{Ee.current&&(Ee.current.focus({preventScroll:!0}),Ee.current=null,K.current=!1)}},[ve.current]),We.createElement("section",{ref:r,"aria-label":`${k} ${oe}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},I.map((q,W)=>{var J;const[re,U]=q.split("-");return V.length?We.createElement("ol",{key:q,dir:S==="auto"?l3():S,tabIndex:-1,ref:ve,className:f,"data-sonner-toaster":!0,"data-sonner-theme":te,"data-y-position":re,"data-x-position":U,style:{"--front-toast-height":`${((J=Z[0])==null?void 0:J.height)||0}px`,"--width":`${E$}px`,"--gap":`${E}px`,...y,...C$(h,p)},onBlur:L=>{K.current&&!L.currentTarget.contains(L.relatedTarget)&&(K.current=!1,Ee.current&&(Ee.current.focus({preventScroll:!0}),Ee.current=null))},onFocus:L=>{L.target instanceof HTMLElement&&L.target.dataset.dismissible==="false"||K.current||(K.current=!0,Ee.current=L.relatedTarget)},onMouseEnter:()=>X(!0),onMouseMove:()=>X(!0),onMouseLeave:()=>{P||X(!1)},onDragEnd:()=>X(!1),onPointerDown:L=>{L.target instanceof HTMLElement&&L.target.dataset.dismissible==="false"||ie(!0)},onPointerUp:()=>ie(!1)},V.filter(L=>!L.position&&W===0||L.position===q).map((L,se)=>{var Q,ee;return We.createElement(A$,{key:L.id,icons:N,index:se,toast:L,defaultRichColors:g,duration:(Q=_==null?void 0:_.duration)!=null?Q:v,className:_==null?void 0:_.className,descriptionClassName:_==null?void 0:_.descriptionClassName,invert:s,visibleToasts:w,closeButton:(ee=_==null?void 0:_.closeButton)!=null?ee:c,interacting:P,position:q,style:_==null?void 0:_.style,unstyled:_==null?void 0:_.unstyled,classNames:_==null?void 0:_.classNames,cancelButtonStyle:_==null?void 0:_.cancelButtonStyle,actionButtonStyle:_==null?void 0:_.actionButtonStyle,closeButtonAriaLabel:_==null?void 0:_.closeButtonAriaLabel,removeToast:D,toasts:V.filter(B=>B.position==L.position),heights:Z.filter(B=>B.position==L.position),setHeights:ce,expandByDefault:o,gap:E,expanded:F,swipeDirections:t.swipeDirections})})):null}))}),zt=Zr.create({baseURL:"http://127.0.0.1:8000",headers:{"Content-Type":"application/json"}});zt.interceptors.request.use(async e=>{var n,s;const r=(s=(n=(await n1()).tokens)==null?void 0:n.idToken)==null?void 0:s.toString();return r&&(e.headers.Authorization=`Bearer ${r}`),e});zt.interceptors.response.use(e=>e,e=>{var n,s;if(!e.response)return wn.error("Network error. Please check your connection."),Promise.reject(e);const t=e.response.status,r=((n=e.response.data)==null?void 0:n.detail)||((s=e.response.data)==null?void 0:s.message);return t>=500&&wn.error(r||"Server error. Please try again later."),t===401&&wn.error("Session expired. Please log in again."),Promise.reject(e)});const U8=ne.createContext(void 0),j$=({children:e})=>{const[t,r]=ne.useState(null),[n,s]=ne.useState("loading"),[a,i]=ne.useState(!1),o=ne.useRef(!1),c=async()=>{const p=(await zt.get("/users/me")).data;r(p),i(!!p.is_active),s("authenticated")};ne.useEffect(()=>{(async()=>{var x;if(o.current)return;if(o.current=!0,["/login","/signup","/forgot-password"].includes(window.location.pathname)){s("unauthenticated");return}try{if(!((x=(await n1()).tokens)!=null&&x.idToken)){s("unauthenticated");return}await c()}catch(g){console.error("Auth bootstrap failed:",g),await V4().catch(()=>{}),r(null),i(!1),s("unauthenticated")}})()},[]);const f=async()=>{try{await V4()}finally{r(null),i(!1),s("unauthenticated")}};return d.jsx(U8.Provider,{value:{user:t,isActive:a,setUser:r,status:n,refreshUser:c,logout:f},children:e})},Hi=()=>{const e=ne.useContext(U8);if(!e)throw new Error("useAuth must be used within AuthProvider");return e};/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var c3="popstate";function O$(e={}){function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return y_("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:s0(s)}return I$(t,r,null,e)}function jr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Va(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function D$(){return Math.random().toString(36).substring(2,10)}function u3(e,t){return{usr:e.state,key:e.key,idx:t}}function y_(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?id(t):t,state:r,key:t&&t.key||n||D$()}}function s0({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function id(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function I$(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o="POP",c=null,f=h();f==null&&(f=0,i.replaceState({...i.state,idx:f},""));function h(){return(i.state||{idx:null}).idx}function p(){o="POP";let w=h(),_=w==null?null:w-f;f=w,c&&c({action:o,location:y.location,delta:_})}function x(w,_){o="PUSH";let S=y_(y.location,w,_);f=h()+1;let E=u3(S,f),N=y.createHref(S);try{i.pushState(E,"",N)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;s.location.assign(N)}a&&c&&c({action:o,location:y.location,delta:1})}function g(w,_){o="REPLACE";let S=y_(y.location,w,_);f=h();let E=u3(S,f),N=y.createHref(S);i.replaceState(E,"",N),a&&c&&c({action:o,location:y.location,delta:0})}function v(w){return M$(w)}let y={get action(){return o},get location(){return e(s,i)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(c3,p),c=w,()=>{s.removeEventListener(c3,p),c=null}},createHref(w){return t(s,w)},createURL:v,encodeLocation(w){let _=v(w);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:x,replace:g,go(w){return i.go(w)}};return y}function M$(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),jr(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:s0(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function z8(e,t,r="/"){return F$(e,t,r,!1)}function F$(e,t,r,n){let s=typeof t=="string"?id(t):t,a=Fo(s.pathname||"/",r);if(a==null)return null;let i=H8(e);P$(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let f=K$(a);o=$$(i[c],f,n)}return o}function H8(e,t=[],r=[],n="",s=!1){let a=(i,o,c=s,f)=>{let h={relativePath:f===void 0?i.path||"":f,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(n)&&c)return;jr(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length)}let p=Ao([n,h.relativePath]),x=r.concat(h);i.children&&i.children.length>0&&(jr(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),H8(i.children,t,x,p,c)),!(i.path==null&&!i.index)&&t.push({path:p,score:q$(p,i.index),routesMeta:x})};return e.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,o);else for(let f of V8(i.path))a(i,o,!0,f)}),t}function V8(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=V8(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function P$(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:W$(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var L$=/^:[\w-]+$/,B$=3,U$=2,z$=1,H$=10,V$=-2,f3=e=>e==="*";function q$(e,t){let r=e.split("/"),n=r.length;return r.some(f3)&&(n+=V$),t&&(n+=U$),r.filter(s=>!f3(s)).reduce((s,a)=>s+(L$.test(a)?B$:a===""?z$:H$),n)}function W$(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function $$(e,t,r=!1){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],f=o===n.length-1,h=a==="/"?t:t.slice(a.length)||"/",p=$x({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},h),x=c.route;if(!p&&f&&r&&!n[n.length-1].route.index&&(p=$x({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!p)return null;Object.assign(s,p.params),i.push({params:s,pathname:Ao([a,p.pathname]),pathnameBase:Z$(Ao([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=Ao([a,p.pathnameBase]))}return i}function $x(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=G$(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((f,{paramName:h,isOptional:p},x)=>{if(h==="*"){let v=o[x]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const g=o[x];return p&&!g?f[h]=void 0:f[h]=(g||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:i,pattern:e}}function G$(e,t=!1,r=!0){Va(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function K$(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Va(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Fo(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}var X$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Y$(e,t="/"){let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?id(e):e,a;return r?(r=r.replace(/\/\/+/g,"/"),r.startsWith("/")?a=d3(r.substring(1),"/"):a=d3(r,t)):a=t,{pathname:a,search:Q$(n),hash:eG(s)}}function d3(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function vb(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function J$(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function zE(e){let t=J$(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function HE(e,t,r,n=!1){let s;typeof e=="string"?s=id(e):(s={...e},jr(!s.pathname||!s.pathname.includes("?"),vb("?","pathname","search",s)),jr(!s.pathname||!s.pathname.includes("#"),vb("#","pathname","hash",s)),jr(!s.search||!s.search.includes("#"),vb("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let p=t.length-1;if(!n&&i.startsWith("..")){let x=i.split("/");for(;x[0]==="..";)x.shift(),p-=1;s.pathname=x.join("/")}o=p>=0?t[p]:"/"}let c=Y$(s,o),f=i&&i!=="/"&&i.endsWith("/"),h=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(f||h)&&(c.pathname+="/"),c}var Ao=e=>e.join("/").replace(/\/\/+/g,"/"),Z$=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Q$=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,eG=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,tG=class{constructor(e,t,r,n=!1){this.status=e,this.statusText=t||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function rG(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function nG(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var q8=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function W8(e,t){let r=e;if(typeof r!="string"||!X$.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,s=!1;if(q8)try{let a=new URL(window.location.href),i=r.startsWith("//")?new URL(a.protocol+r):new URL(r),o=Fo(i.pathname,t);i.origin===a.origin&&o!=null?r=o+i.search+i.hash:s=!0}catch{Va(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:s,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $8=["POST","PUT","PATCH","DELETE"];new Set($8);var sG=["GET",...$8];new Set(sG);var od=ne.createContext(null);od.displayName="DataRouter";var m1=ne.createContext(null);m1.displayName="DataRouterState";var aG=ne.createContext(!1),G8=ne.createContext({isTransitioning:!1});G8.displayName="ViewTransition";var iG=ne.createContext(new Map);iG.displayName="Fetchers";var oG=ne.createContext(null);oG.displayName="Await";var fa=ne.createContext(null);fa.displayName="Navigation";var G0=ne.createContext(null);G0.displayName="Location";var Ka=ne.createContext({outlet:null,matches:[],isDataRoute:!1});Ka.displayName="Route";var VE=ne.createContext(null);VE.displayName="RouteError";var K8="REACT_ROUTER_ERROR",lG="REDIRECT",cG="ROUTE_ERROR_RESPONSE";function uG(e){if(e.startsWith(`${K8}:${lG}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function fG(e){if(e.startsWith(`${K8}:${cG}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new tG(t.status,t.statusText,t.data)}catch{}}function dG(e,{relative:t}={}){jr(ld(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=ne.useContext(fa),{hash:s,pathname:a,search:i}=K0(e,{relative:t}),o=a;return r!=="/"&&(o=a==="/"?r:Ao([r,a])),n.createHref({pathname:o,search:i,hash:s})}function ld(){return ne.useContext(G0)!=null}function Vi(){return jr(ld(),"useLocation() may be used only in the context of a <Router> component."),ne.useContext(G0).location}var X8="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Y8(e){ne.useContext(fa).static||ne.useLayoutEffect(e)}function Ln(){let{isDataRoute:e}=ne.useContext(Ka);return e?kG():hG()}function hG(){jr(ld(),"useNavigate() may be used only in the context of a <Router> component.");let e=ne.useContext(od),{basename:t,navigator:r}=ne.useContext(fa),{matches:n}=ne.useContext(Ka),{pathname:s}=Vi(),a=JSON.stringify(zE(n)),i=ne.useRef(!1);return Y8(()=>{i.current=!0}),ne.useCallback((c,f={})=>{if(Va(i.current,X8),!i.current)return;if(typeof c=="number"){r.go(c);return}let h=HE(c,JSON.parse(a),s,f.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Ao([t,h.pathname])),(f.replace?r.replace:r.push)(h,f.state,f)},[t,r,a,s,e])}var pG=ne.createContext(null);function mG(e){let t=ne.useContext(Ka).outlet;return ne.useMemo(()=>t&&ne.createElement(pG.Provider,{value:e},t),[t,e])}function J8(){let{matches:e}=ne.useContext(Ka),t=e[e.length-1];return t?t.params:{}}function K0(e,{relative:t}={}){let{matches:r}=ne.useContext(Ka),{pathname:n}=Vi(),s=JSON.stringify(zE(r));return ne.useMemo(()=>HE(e,JSON.parse(s),n,t==="path"),[e,s,n,t])}function xG(e,t){return Z8(e,t)}function Z8(e,t,r,n,s){var S;jr(ld(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=ne.useContext(fa),{matches:i}=ne.useContext(Ka),o=i[i.length-1],c=o?o.params:{},f=o?o.pathname:"/",h=o?o.pathnameBase:"/",p=o&&o.route;{let E=p&&p.path||"";eD(f,!p||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let x=Vi(),g;if(t){let E=typeof t=="string"?id(t):t;jr(h==="/"||((S=E.pathname)==null?void 0:S.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${E.pathname}" was given in the \`location\` prop.`),g=E}else g=x;let v=g.pathname||"/",y=v;if(h!=="/"){let E=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(E.length).join("/")}let w=z8(e,{pathname:y});Va(p||w!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Va(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=wG(w&&w.map(E=>Object.assign({},E,{params:Object.assign({},c,E.params),pathname:Ao([h,a.encodeLocation?a.encodeLocation(E.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?h:Ao([h,a.encodeLocation?a.encodeLocation(E.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathnameBase])})),i,r,n,s);return t&&_?ne.createElement(G0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},_):_}function gG(){let e=TG(),t=rG(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=ne.createElement(ne.Fragment,null,ne.createElement("p",null," Hey developer "),ne.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ne.createElement("code",{style:a},"ErrorBoundary")," or"," ",ne.createElement("code",{style:a},"errorElement")," prop on your route.")),ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},t),r?ne.createElement("pre",{style:s},r):null,i)}var yG=ne.createElement(gG,null),Q8=class extends ne.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=fG(e.digest);r&&(e=r)}let t=e!==void 0?ne.createElement(Ka.Provider,{value:this.props.routeContext},ne.createElement(VE.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?ne.createElement(vG,{error:e},t):t}};Q8.contextType=aG;var bb=new WeakMap;function vG({children:e,error:t}){let{basename:r}=ne.useContext(fa);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let n=uG(t.digest);if(n){let s=bb.get(t);if(s)throw s;let a=W8(n.location,r);if(q8&&!bb.get(t))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const i=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw bb.set(t,i),i}return ne.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return e}function bG({routeContext:e,match:t,children:r}){let n=ne.useContext(od);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),ne.createElement(Ka.Provider,{value:e},r)}function wG(e,t=[],r=null,n=null,s=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,i=r==null?void 0:r.errors;if(i!=null){let h=a.findIndex(p=>p.route.id&&(i==null?void 0:i[p.route.id])!==void 0);jr(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let o=!1,c=-1;if(r)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(c=h),p.route.id){let{loaderData:x,errors:g}=r,v=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!g||g[p.route.id]===void 0);if(p.route.lazy||v){o=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}let f=r&&n?(h,p)=>{var x,g;n(h,{location:r.location,params:((g=(x=r.matches)==null?void 0:x[0])==null?void 0:g.params)??{},unstable_pattern:nG(r.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,x)=>{let g,v=!1,y=null,w=null;r&&(g=i&&p.route.id?i[p.route.id]:void 0,y=p.route.errorElement||yG,o&&(c<0&&x===0?(eD("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,w=null):c===x&&(v=!0,w=p.route.hydrateFallbackElement||null)));let _=t.concat(a.slice(0,x+1)),S=()=>{let E;return g?E=y:v?E=w:p.route.Component?E=ne.createElement(p.route.Component,null):p.route.element?E=p.route.element:E=h,ne.createElement(bG,{match:p,routeContext:{outlet:h,matches:_,isDataRoute:r!=null},children:E})};return r&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?ne.createElement(Q8,{location:r.location,revalidation:r.revalidation,component:y,error:g,children:S(),routeContext:{outlet:null,matches:_,isDataRoute:!0},onError:f}):S()},null)}function qE(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _G(e){let t=ne.useContext(od);return jr(t,qE(e)),t}function EG(e){let t=ne.useContext(m1);return jr(t,qE(e)),t}function SG(e){let t=ne.useContext(Ka);return jr(t,qE(e)),t}function WE(e){let t=SG(e),r=t.matches[t.matches.length-1];return jr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function NG(){return WE("useRouteId")}function TG(){var n;let e=ne.useContext(VE),t=EG("useRouteError"),r=WE("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function kG(){let{router:e}=_G("useNavigate"),t=WE("useNavigate"),r=ne.useRef(!1);return Y8(()=>{r.current=!0}),ne.useCallback(async(s,a={})=>{Va(r.current,X8),r.current&&(typeof s=="number"?await e.navigate(s):await e.navigate(s,{fromRouteId:t,...a}))},[e,t])}var h3={};function eD(e,t,r){!t&&!h3[e]&&(h3[e]=!0,Va(!1,r))}ne.memo(AG);function AG({routes:e,future:t,state:r,onError:n}){return Z8(e,void 0,r,n,t)}function El({to:e,replace:t,state:r,relative:n}){jr(ld(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=ne.useContext(fa);Va(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=ne.useContext(Ka),{pathname:i}=Vi(),o=Ln(),c=HE(e,zE(a),i,n==="path"),f=JSON.stringify(c);return ne.useEffect(()=>{o(JSON.parse(f),{replace:t,state:r,relative:n})},[o,f,n,t,r]),null}function tD(e){return mG(e.context)}function Rr(e){jr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function CG({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:s,static:a=!1,unstable_useTransitions:i}){jr(!ld(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),c=ne.useMemo(()=>({basename:o,navigator:s,static:a,unstable_useTransitions:i,future:{}}),[o,s,a,i]);typeof r=="string"&&(r=id(r));let{pathname:f="/",search:h="",hash:p="",state:x=null,key:g="default"}=r,v=ne.useMemo(()=>{let y=Fo(f,o);return y==null?null:{location:{pathname:y,search:h,hash:p,state:x,key:g},navigationType:n}},[o,f,h,p,x,g,n]);return Va(v!=null,`<Router basename="${o}"> is not able to match the URL "${f}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:ne.createElement(fa.Provider,{value:c},ne.createElement(G0.Provider,{children:t,value:v}))}function RG({children:e,location:t}){return xG(v_(e),t)}function v_(e,t=[]){let r=[];return ne.Children.forEach(e,(n,s)=>{if(!ne.isValidElement(n))return;let a=[...t,s];if(n.type===ne.Fragment){r.push.apply(r,v_(n.props.children,a));return}jr(n.type===Rr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),jr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=v_(n.props.children,a)),r.push(i)}),r}var Ax="get",Cx="application/x-www-form-urlencoded";function x1(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function jG(e){return x1(e)&&e.tagName.toLowerCase()==="button"}function OG(e){return x1(e)&&e.tagName.toLowerCase()==="form"}function DG(e){return x1(e)&&e.tagName.toLowerCase()==="input"}function IG(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function MG(e,t){return e.button===0&&(!t||t==="_self")&&!IG(e)}function b_(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function FG(e,t){let r=b_(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(a=>{r.append(s,a)})}),r}var Pm=null;function PG(){if(Pm===null)try{new FormData(document.createElement("form"),0),Pm=!1}catch{Pm=!0}return Pm}var LG=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function wb(e){return e!=null&&!LG.has(e)?(Va(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Cx}"`),null):e}function BG(e,t){let r,n,s,a,i;if(OG(e)){let o=e.getAttribute("action");n=o?Fo(o,t):null,r=e.getAttribute("method")||Ax,s=wb(e.getAttribute("enctype"))||Cx,a=new FormData(e)}else if(jG(e)||DG(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||o.getAttribute("action");if(n=c?Fo(c,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||Ax,s=wb(e.getAttribute("formenctype"))||wb(o.getAttribute("enctype"))||Cx,a=new FormData(o,e),!PG()){let{name:f,type:h,value:p}=e;if(h==="image"){let x=f?`${f}.`:"";a.append(`${x}x`,"0"),a.append(`${x}y`,"0")}else f&&a.append(f,p)}}else{if(x1(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Ax,n=null,s=Cx,i=e}return a&&s==="text/plain"&&(i=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function $E(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function UG(e,t,r,n){let s=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${n}`:s.pathname=`${s.pathname}.${n}`:s.pathname==="/"?s.pathname=`_root.${n}`:t&&Fo(s.pathname,t)==="/"?s.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function zG(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function HG(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function VG(e,t,r){let n=await Promise.all(e.map(async s=>{let a=t.routes[s.route.id];if(a){let i=await zG(a,r);return i.links?i.links():[]}return[]}));return GG(n.flat(1).filter(HG).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function p3(e,t,r,n,s,a){let i=(c,f)=>r[f]?c.route.id!==r[f].route.id:!0,o=(c,f)=>{var h;return r[f].pathname!==c.pathname||((h=r[f].route.path)==null?void 0:h.endsWith("*"))&&r[f].params["*"]!==c.params["*"]};return a==="assets"?t.filter((c,f)=>i(c,f)||o(c,f)):a==="data"?t.filter((c,f)=>{var p;let h=n.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(i(c,f)||o(c,f))return!0;if(c.route.shouldRevalidate){let x=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((p=r[0])==null?void 0:p.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function qG(e,t,{includeHydrateFallback:r}={}){return WG(e.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function WG(e){return[...new Set(e)]}function $G(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function GG(e,t){let r=new Set;return new Set(t),e.reduce((n,s)=>{let a=JSON.stringify($G(s));return r.has(a)||(r.add(a),n.push({key:a,link:s})),n},[])}function rD(){let e=ne.useContext(od);return $E(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function KG(){let e=ne.useContext(m1);return $E(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var GE=ne.createContext(void 0);GE.displayName="FrameworkContext";function nD(){let e=ne.useContext(GE);return $E(e,"You must render this element inside a <HydratedRouter> element"),e}function XG(e,t){let r=ne.useContext(GE),[n,s]=ne.useState(!1),[a,i]=ne.useState(!1),{onFocus:o,onBlur:c,onMouseEnter:f,onMouseLeave:h,onTouchStart:p}=t,x=ne.useRef(null);ne.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let y=_=>{_.forEach(S=>{i(S.isIntersecting)})},w=new IntersectionObserver(y,{threshold:.5});return x.current&&w.observe(x.current),()=>{w.disconnect()}}},[e]),ne.useEffect(()=>{if(n){let y=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(y)}}},[n]);let g=()=>{s(!0)},v=()=>{s(!1),i(!1)};return r?e!=="intent"?[a,x,{}]:[a,x,{onFocus:fh(o,g),onBlur:fh(c,v),onMouseEnter:fh(f,g),onMouseLeave:fh(h,v),onTouchStart:fh(p,g)}]:[!1,x,{}]}function fh(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function YG({page:e,...t}){let{router:r}=rD(),n=ne.useMemo(()=>z8(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?ne.createElement(ZG,{page:e,matches:n,...t}):null}function JG(e){let{manifest:t,routeModules:r}=nD(),[n,s]=ne.useState([]);return ne.useEffect(()=>{let a=!1;return VG(e,t,r).then(i=>{a||s(i)}),()=>{a=!0}},[e,t,r]),n}function ZG({page:e,matches:t,...r}){let n=Vi(),{future:s,manifest:a,routeModules:i}=nD(),{basename:o}=rD(),{loaderData:c,matches:f}=KG(),h=ne.useMemo(()=>p3(e,t,f,a,n,"data"),[e,t,f,a,n]),p=ne.useMemo(()=>p3(e,t,f,a,n,"assets"),[e,t,f,a,n]),x=ne.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let y=new Set,w=!1;if(t.forEach(S=>{var N;let E=a.routes[S.route.id];!E||!E.hasLoader||(!h.some(k=>k.route.id===S.route.id)&&S.route.id in c&&((N=i[S.route.id])!=null&&N.shouldRevalidate)||E.hasClientLoader?w=!0:y.add(S.route.id))}),y.size===0)return[];let _=UG(e,o,s.unstable_trailingSlashAwareDataRequests,"data");return w&&y.size>0&&_.searchParams.set("_routes",t.filter(S=>y.has(S.route.id)).map(S=>S.route.id).join(",")),[_.pathname+_.search]},[o,s.unstable_trailingSlashAwareDataRequests,c,n,a,h,t,e,i]),g=ne.useMemo(()=>qG(p,a),[p,a]),v=JG(p);return ne.createElement(ne.Fragment,null,x.map(y=>ne.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),g.map(y=>ne.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),v.map(({key:y,link:w})=>ne.createElement("link",{key:y,nonce:r.nonce,...w,crossOrigin:w.crossOrigin??r.crossOrigin})))}function QG(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var eK=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{eK&&(window.__reactRouterVersion="7.13.0")}catch{}function tK({basename:e,children:t,unstable_useTransitions:r,window:n}){let s=ne.useRef();s.current==null&&(s.current=O$({window:n,v5Compat:!0}));let a=s.current,[i,o]=ne.useState({action:a.action,location:a.location}),c=ne.useCallback(f=>{r===!1?o(f):ne.startTransition(()=>o(f))},[r]);return ne.useLayoutEffect(()=>a.listen(c),[a,c]),ne.createElement(CG,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:a,unstable_useTransitions:r})}var sD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Af=ne.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:i,state:o,target:c,to:f,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:x,...g},v){let{basename:y,unstable_useTransitions:w}=ne.useContext(fa),_=typeof f=="string"&&sD.test(f),S=W8(f,y);f=S.to;let E=dG(f,{relative:s}),[N,k,O]=XG(n,g),R=sK(f,{replace:i,state:o,target:c,preventScrollReset:h,relative:s,viewTransition:p,unstable_defaultShouldRevalidate:x,unstable_useTransitions:w});function V(Z){t&&t(Z),Z.defaultPrevented||R(Z)}let I=ne.createElement("a",{...g,...O,href:S.absoluteURL||E,onClick:S.isExternal||a?t:V,ref:QG(v,k),target:c,"data-discover":!_&&r==="render"?"true":void 0});return N&&!_?ne.createElement(ne.Fragment,null,I,ne.createElement(YG,{page:E})):I});Af.displayName="Link";var aD=ne.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:i,viewTransition:o,children:c,...f},h){let p=K0(i,{relative:f.relative}),x=Vi(),g=ne.useContext(m1),{navigator:v,basename:y}=ne.useContext(fa),w=g!=null&&uK(p)&&o===!0,_=v.encodeLocation?v.encodeLocation(p).pathname:p.pathname,S=x.pathname,E=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;r||(S=S.toLowerCase(),E=E?E.toLowerCase():null,_=_.toLowerCase()),E&&y&&(E=Fo(E,y)||E);const N=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let k=S===_||!s&&S.startsWith(_)&&S.charAt(N)==="/",O=E!=null&&(E===_||!s&&E.startsWith(_)&&E.charAt(_.length)==="/"),R={isActive:k,isPending:O,isTransitioning:w},V=k?t:void 0,I;typeof n=="function"?I=n(R):I=[n,k?"active":null,O?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let Z=typeof a=="function"?a(R):a;return ne.createElement(Af,{...f,"aria-current":V,className:I,ref:h,style:Z,to:i,viewTransition:o},typeof c=="function"?c(R):c)});aD.displayName="NavLink";var rK=ne.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:s,state:a,method:i=Ax,action:o,onSubmit:c,relative:f,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:x,...g},v)=>{let{unstable_useTransitions:y}=ne.useContext(fa),w=lK(),_=cK(o,{relative:f}),S=i.toLowerCase()==="get"?"get":"post",E=typeof o=="string"&&sD.test(o),N=k=>{if(c&&c(k),k.defaultPrevented)return;k.preventDefault();let O=k.nativeEvent.submitter,R=(O==null?void 0:O.getAttribute("formmethod"))||i,V=()=>w(O||k.currentTarget,{fetcherKey:t,method:R,navigate:r,replace:s,state:a,relative:f,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:x});y&&r!==!1?ne.startTransition(()=>V()):V()};return ne.createElement("form",{ref:v,method:S,action:_,onSubmit:n?c:N,...g,"data-discover":!E&&e==="render"?"true":void 0})});rK.displayName="Form";function nK(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iD(e){let t=ne.useContext(od);return jr(t,nK(e)),t}function sK(e,{target:t,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:i,unstable_defaultShouldRevalidate:o,unstable_useTransitions:c}={}){let f=Ln(),h=Vi(),p=K0(e,{relative:a});return ne.useCallback(x=>{if(MG(x,t)){x.preventDefault();let g=r!==void 0?r:s0(h)===s0(p),v=()=>f(e,{replace:g,state:n,preventScrollReset:s,relative:a,viewTransition:i,unstable_defaultShouldRevalidate:o});c?ne.startTransition(()=>v()):v()}},[h,f,p,r,n,t,e,s,a,i,o,c])}function aK(e){Va(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=ne.useRef(b_(e)),r=ne.useRef(!1),n=Vi(),s=ne.useMemo(()=>FG(n.search,r.current?null:t.current),[n.search]),a=Ln(),i=ne.useCallback((o,c)=>{const f=b_(typeof o=="function"?o(new URLSearchParams(s)):o);r.current=!0,a("?"+f,c)},[a,s]);return[s,i]}var iK=0,oK=()=>`__${String(++iK)}__`;function lK(){let{router:e}=iD("useSubmit"),{basename:t}=ne.useContext(fa),r=NG(),n=e.fetch,s=e.navigate;return ne.useCallback(async(a,i={})=>{let{action:o,method:c,encType:f,formData:h,body:p}=BG(a,t);if(i.navigate===!1){let x=i.fetcherKey||oK();await n(x,r,i.action||o,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:h,body:p,formMethod:i.method||c,formEncType:i.encType||f,flushSync:i.flushSync})}else await s(i.action||o,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:h,body:p,formMethod:i.method||c,formEncType:i.encType||f,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,s,t,r])}function cK(e,{relative:t}={}){let{basename:r}=ne.useContext(fa),n=ne.useContext(Ka);jr(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...K0(e||".",{relative:t})},i=Vi();if(e==null){a.search=i.search;let o=new URLSearchParams(a.search),c=o.getAll("index");if(c.some(h=>h==="")){o.delete("index"),c.filter(p=>p).forEach(p=>o.append("index",p));let h=o.toString();a.search=h?`?${h}`:""}}return(!e||e===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:Ao([r,a.pathname])),s0(a)}function uK(e,{relative:t}={}){let r=ne.useContext(G8);jr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=iD("useViewTransitionState"),s=K0(e,{relative:t});if(!r.isTransitioning)return!1;let a=Fo(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=Fo(r.nextLocation.pathname,n)||r.nextLocation.pathname;return $x(s.pathname,i)!=null||$x(s.pathname,a)!=null}const fK=new m8(new h8(P0)),dK={configure(e,t){const r=DO(e),n=new Oz({sameSite:"lax"}),s=t!=null&&t.ssr?n:P0,a=t!=null&&t.ssr?new m8(new h8(n)):fK;if(!r.Auth){Sr.configure(r,t);return}if(t!=null&&t.Auth){Sr.configure(r,t);return}if(!Sr.libraryOptions.Auth){Nh.setAuthConfig(r.Auth),Nh.setKeyValueStorage(s),Sr.configure(r,{...t,Auth:{tokenProvider:Nh,credentialsProvider:a}});return}if(t){const i=Sr.libraryOptions.Auth;t.ssr!==void 0&&(Nh.setKeyValueStorage(s),i.credentialsProvider=a),Sr.configure(r,{Auth:i,...t});return}Sr.configure(r)},getConfig(){return Sr.getConfig()}},hK={aws_project_region:"us-east-1",aws_cognito_identity_pool_id:"us-east-1:56b9322b-f635-4de5-8568-2190b4d16cb7",aws_cognito_region:"us-east-1",aws_user_pools_id:"us-east-1_vEN2QD1i4",aws_user_pools_web_client_id:"75d8bj7e5gsqh5uo3ov7m5ua8t",oauth:{},aws_cognito_username_attributes:["EMAIL"],aws_cognito_social_providers:[],aws_cognito_signup_attributes:["EMAIL"],aws_cognito_mfa_configuration:"OFF",aws_cognito_mfa_types:["SMS"],aws_cognito_password_protection_settings:{passwordPolicyMinLength:8,passwordPolicyCharacters:[]},aws_cognito_verification_mechanisms:["EMAIL"]};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pK=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mK=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),m3=e=>{const t=mK(e);return t.charAt(0).toUpperCase()+t.slice(1)},oD=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),xK=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var gK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yK=ne.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>ne.createElement("svg",{ref:c,...gK,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:oD("lucide",s),...!a&&!xK(o)&&{"aria-hidden":"true"},...o},[...i.map(([f,h])=>ne.createElement(f,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=(e,t)=>{const r=ne.forwardRef(({className:n,...s},a)=>ne.createElement(yK,{ref:a,iconNode:t,className:oD(`lucide-${pK(m3(e))}`,`lucide-${e}`,n),...s}));return r.displayName=m3(e),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vK=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],bK=rt("arrow-down-wide-narrow",vK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wK=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],KE=rt("arrow-left",wK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _K=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],a0=rt("arrow-right",_K);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EK=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]],SK=rt("arrow-up-narrow-wide",EK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NK=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],TK=rt("bold",NK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kK=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],In=rt("building-2",kK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AK=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],cd=rt("calendar",AK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CK=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],RK=rt("chart-column",CK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jK=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Kc=rt("check",jK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OK=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],i0=rt("chevron-down",OK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DK=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Es=rt("chevron-left",DK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IK=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Mr=rt("chevron-right",IK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ic=rt("circle-alert",MK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FK=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],PK=rt("circle-check-big",FK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],us=rt("circle-check",LK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],UK=rt("circle-pause",BK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zK=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],HK=rt("circle-play",zK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Cf=rt("circle-x",VK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qK=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Bi=rt("clock",qK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WK=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Rf=rt("download",WK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $K=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Ll=rt("ellipsis-vertical",$K);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GK=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],w_=rt("external-link",GK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KK=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Mh=rt("eye-off",KK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XK=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Co=rt("eye",XK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YK=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],JK=rt("file-down",YK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZK=[["path",{d:"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34",key:"o6klzx"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z",key:"zhnas1"}]],ou=rt("file-pen",ZK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QK=[["path",{d:"M11.1 22H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.706.706l3.589 3.588A2.4 2.4 0 0 1 20 8v3.25",key:"uh4ikj"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m21 22-2.88-2.88",key:"9dd25w"}],["circle",{cx:"16",cy:"17",r:"3",key:"11br10"}]],eX=rt("file-search-corner",QK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tX=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"11.5",cy:"14.5",r:"2.5",key:"1bq0ko"}],["path",{d:"M13.3 16.3 15 18",key:"2quom7"}]],Gx=rt("file-search",tX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rX=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],__=rt("file-spreadsheet",rX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nX=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],La=rt("file-text",nX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sX=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],lD=rt("file",sX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aX=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],iX=rt("funnel",aX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oX=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],cD=rt("hash",oX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lX=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],cX=rt("heading-1",lX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uX=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],fX=rt("heading-2",uX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dX=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],hX=rt("history",dX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pX=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],g1=rt("inbox",pX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mX=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],xX=rt("info",mX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gX=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],yX=rt("italic",gX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vX=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],bX=rt("layout-dashboard",vX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wX=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M16 12H3",key:"1a2rj7"}],["path",{d:"M11 19H3",key:"zflm78"}],["path",{d:"m15 18 2 2 4-4",key:"1szwhi"}]],_X=rt("list-check",wX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EX=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],SX=rt("list-ordered",EX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NX=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],TX=rt("list",NX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kX=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ar=rt("loader-circle",kX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AX=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],y1=rt("lock",AX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CX=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],RX=rt("log-out",CX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jX=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],o0=rt("mail",jX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OX=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],jf=rt("map-pin",OX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DX=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],IX=rt("menu",DX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MX=[["path",{d:"M5 12h14",key:"1ays0h"}]],XE=rt("minus",MX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FX=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],PX=rt("package",FX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LX=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],BX=rt("pen-line",LX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UX=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],E_=rt("phone",UX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zX=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],HX=rt("play",zX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VX=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ud=rt("plus",VX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qX=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],WX=rt("refresh-cw",qX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $X=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],GX=rt("rotate-ccw",$X);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KX=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],XX=rt("rotate-cw",KX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YX=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],JX=rt("save",YX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZX=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Wl=rt("search",ZX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QX=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],uD=rt("settings",QX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eY=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],tY=rt("share-2",eY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rY=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],fD=rt("shield-check",rY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nY=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],YE=rt("shield",nY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sY=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],aY=rt("sparkles",sY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iY=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],X0=rt("square-pen",iY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oY=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],dD=rt("trash-2",oY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lY=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],fd=rt("trending-down",lY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cY=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Xc=rt("trending-up",cY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uY=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],v1=rt("triangle-alert",uY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fY=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],dY=rt("underline",fY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hY=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Of=rt("upload",hY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pY=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Kx=rt("user-check",pY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mY=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],hD=rt("user-plus",mY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xY=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],x3=rt("user-x",xY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gY=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Y0=rt("user",gY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yY=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],vY=rt("users",yY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bY=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Zn=rt("x",bY),JE=({title:e,subtitle:t,children:r})=>d.jsxs("div",{className:"flex min-h-screen bg-white",children:[d.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-[#1d4e89] flex-col p-12 justify-between",children:[d.jsx("div",{className:"flex items-center gap-3"}),d.jsx("div",{className:"mb-24",children:d.jsxs("h1",{className:"text-white text-6xl font-bold leading-tight",children:["Winvale",d.jsx("br",{}),d.jsx("span",{className:"text-blue-300",children:"Automation Platform"})]})}),d.jsx("div",{className:"text-blue-200 text-sm"})]}),d.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8 bg-[#f8fafc]",children:d.jsxs("div",{className:"max-w-md w-full",children:[d.jsxs("div",{className:"lg:hidden flex items-center justify-center gap-3 mb-6",children:[d.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center shrink-0",children:d.jsx("img",{src:"logo.png",alt:"Winvale Logo"})}),d.jsx("span",{className:"text-2xl font-bold text-slate-900",children:"Winvale"})]}),d.jsxs("div",{className:"mb-10",children:[d.jsx("h2",{className:"text-3xl text-center font-bold text-slate-900 mb-2",children:e}),d.jsx("p",{className:"text-slate-500 text-center",children:t})]}),d.jsx("div",{className:"bg-white p-8 rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-100",children:r})]})})]}),wY=/^[A-Za-z0-9]+(?:[A-Za-z0-9 .,'&()\-]*[A-Za-z0-9])?$/,pD=/^[A-Za-z]+(?:[ .'-][A-Za-z]+)*$/,_Y=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,EY=/^\+?\d{1,14}$/,SY=/^[A-Za-z0-9]{1,7}$/,NY={length:{test:e=>e.length>=8,label:"At least 8 characters"},lowercase:{test:e=>/[a-z]/.test(e),label:"At least 1 lowercase letter"},uppercase:{test:e=>/[A-Z]/.test(e),label:"At least 1 uppercase letter"},number:{test:e=>/\d/.test(e),label:"At least 1 number"},special:{test:e=>/[^A-Za-z0-9]/.test(e),label:"At least 1 special character"}},TY=e=>e?Object.values(NY).find(r=>!r.test(e))?"Password does not meet requirements":null:"Password is required",kY=(e,t,r)=>e!==t?`${r} do not match`:null,Eo=(e,t)=>e==null||typeof e=="string"&&!e.trim()?`${t} is required`:null,AY=(e,t,r)=>e&&e.length<t?`${r} must be at least ${t} characters`:null,Yn=(e,t,r)=>e&&e.length>t?`${r} must be under ${t} characters`:null,J0=e=>e!=null&&e.trim()?_Y.test(e)?Yn(e,50,"Email"):"Please enter a valid email address":"Email is required",mD=(e,t="Phone number")=>e!=null&&e.trim()?EY.test(e)?null:`${t} must be up to 14 digits and may start with +`:`${t} is required`,ZE=e=>e&&!SY.test(e)?"ZIP code must be alphanumeric and up to 7 characters":null,xD=(e,t=!1)=>{const r=(e==null?void 0:e.trim())||"",n=t?"Company name":"Name",s=t?wY:pD;return r?s.test(r)?Yn(r,30,"Name"):t?"Company name can contain letters, numbers, spaces, and . , ' & ( ) - only":"Name can contain letters, spaces, and . ' - only":`${n} is required`},CY=(e,t="Name")=>{const r=(e==null?void 0:e.trim())||"";return r?pD.test(r)?Yn(r,30,"Name"):`${t} can contain letters, spaces, and . ' - only`:null},RY=(e,t,r,n)=>e<t||e>r?`${n} must be between ${t} and ${r}`:null,g3=(e,t)=>!Number.isInteger(e)||e<0?`${t} must be a positive number`:null,jY=()=>{const{refreshUser:e}=Hi(),[t,r]=ne.useState(""),[n,s]=ne.useState(""),[a,i]=ne.useState(!1),[o,c]=ne.useState(!1),[f,h]=ne.useState(null),[p,x]=ne.useState({}),g=ne.useRef(!1),v=()=>{const w={},_=J0(t);_&&(w.email=_);const S=Eo(n,"Password");return S&&(w.password=S),x(w),Object.keys(w).length===0},y=async w=>{if(w.preventDefault(),!(o||g.current)&&(h(null),!!v())){c(!0);try{await $V({username:t,password:n}),g.current=!0;try{await e()}catch{h("Login successful, but profile could not be loaded.")}}catch(_){h((_==null?void 0:_.message)||"Failed to sign in. Please check your credentials.")}finally{c(!1)}}};return d.jsxs(JE,{title:"Welcome back",subtitle:"Sign in to access your dashboard",children:[f&&d.jsx("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 text-sm",children:f}),d.jsxs("form",{onSubmit:y,className:"space-y-6",noValidate:!0,children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(o0,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"email",value:t,onChange:w=>{r(w.target.value),x(_=>({..._,email:void 0}))},className:"block w-full pl-11 pr-4 py-3 rounded-xl outline-none transition-all bg-slate-50 border border-slate-200 focus:ring-blue-500",placeholder:"name@winvale.com"})]}),p.email&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.email})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Password"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(y1,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:a?"text":"password",value:n,onChange:w=>{s(w.target.value),x(_=>({..._,password:void 0}))},className:"block w-full pl-11 pr-11 py-3 rounded-xl outline-none transition-all bg-slate-50 border border-slate-200 focus:ring-blue-500",placeholder:""}),d.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-slate-400 hover:text-slate-600",children:a?d.jsx(Mh,{className:"h-5 w-5"}):d.jsx(Co,{className:"h-5 w-5"})})]}),p.password&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.password})]}),d.jsx("div",{className:"flex items-center justify-end",children:d.jsx(Af,{to:"/forgot-password",className:"text-sm font-semibold text-blue-600 hover:text-blue-700",children:"Forgot password?"})}),d.jsx("button",{type:"submit",disabled:o,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#3498db] hover:bg-[#2980b9] text-white font-semibold rounded-xl shadow-lg shadow-blue-500/30 transition-all active:scale-[0.98] disabled:opacity-70",children:o?d.jsx(ar,{className:"h-5 w-5 animate-spin"}):"Sign in"})]}),d.jsxs("div",{className:"mt-8 text-center text-sm border-t border-slate-100 pt-6",children:["Don't have an account?"," ",d.jsx(Af,{to:"/signup",className:"font-semibold text-blue-600 hover:text-blue-700",children:"Sign up"})]})]})},OY=e=>{const t={};t.fullName=Eo(e.fullName,"Full name")||AY(e.fullName,3,"Full name")||Yn(e.fullName,30,"Full Name")||void 0,t.email=J0(e.email)||void 0,t.password=TY(e.password)||void 0,t.confirmPassword=Eo(e.confirmPassword,"Confirm password")||kY(e.password,e.confirmPassword,"Passwords")||void 0;const r=Object.fromEntries(Object.entries(t).filter(([n,s])=>s!==void 0));return{isValid:Object.keys(r).length===0,errors:r}},Df={length:{test:e=>e.length>=8,label:"At least 8 characters"},lowercase:{test:e=>/[a-z]/.test(e),label:"At least 1 lowercase letter"},uppercase:{test:e=>/[A-Z]/.test(e),label:"At least 1 uppercase letter"},number:{test:e=>/\d/.test(e),label:"At least 1 number"},special:{test:e=>/[^A-Za-z0-9]/.test(e),label:"At least 1 special character"}},DY=({password:e})=>d.jsx("ul",{className:"mt-3 space-y-1 text-sm",children:Object.entries(Df).map(([t,r])=>{const n=r.test(e);return d.jsxs("li",{className:`flex items-center gap-2 ${n?"text-green-600":"text-slate-400"}`,children:[d.jsx("span",{className:`inline-flex h-4 w-4 items-center justify-center rounded-full border text-xs ${n?"border-green-600 bg-green-600 text-white":"border-slate-300"}`,children:n?"":""}),r.label]},t)})}),IY=()=>{const e=Ln(),[t,r]=ne.useState("details"),[n,s]=ne.useState({fullName:"",email:"",password:"",confirmPassword:""}),[a,i]=ne.useState(!1),[o,c]=ne.useState(!1),[f,h]=ne.useState(""),[p,x]=ne.useState(!1),[g,v]=ne.useState(null),[y,w]=ne.useState({}),_=R=>{w(V=>({...V,[R]:void 0}))},S=Object.values(Df).some(R=>!R.test(n.password)),E=async R=>{R.preventDefault();const{isValid:V,errors:I}=OY(n);if(!V){w(I);return}x(!0),v(null);try{await JV({username:n.email,password:n.password,options:{userAttributes:{email:n.email,name:n.fullName}}}),r("otp")}catch(Z){Z.name==="UsernameExistsException"?v("An account with this email already exists. Try signing in."):v(Z.message||"Signup failed")}finally{x(!1)}},N=async R=>{var V;R.preventDefault(),x(!0),v(null);try{await nq({username:n.email,confirmationCode:f}),e("/login")}catch(I){(V=I.message)!=null&&V.includes("Current status is CONFIRMED")||I.name==="NotAuthorizedException"?(v("This account is already verified. Please sign in."),setTimeout(()=>e("/login"),2e3)):v(I.message||"Verification failed")}finally{x(!1)}},k=t==="details"?"Sign up":"Verify email",O=t==="details"?"Join the Winvale Analysis Platform":`Enter the code sent to ${n.email}`;return d.jsxs(JE,{title:k,subtitle:O,children:[g&&d.jsx("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 text-sm",children:g}),t==="details"?d.jsxs("form",{onSubmit:E,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Full name"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(Y0,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"text",value:n.fullName,onChange:R=>{_("fullName"),s({...n,fullName:R.target.value})},className:"block w-full pl-11 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Your Name"})]}),y.fullName&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.fullName})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(o0,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"email",value:n.email,onChange:R=>{_("email"),s({...n,email:R.target.value})},className:"block w-full pl-11 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"name@winvale.com"})]}),y.email&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.email})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Password"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(y1,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:a?"text":"password",value:n.password,onChange:R=>{_("password"),s({...n,password:R.target.value})},onFocus:()=>c(!0),onBlur:()=>c(!1),className:"block w-full pl-11 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Min. 8 characters"}),d.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-slate-400 hover:text-slate-600",children:a?d.jsx(Mh,{className:"h-5 w-5"}):d.jsx(Co,{className:"h-5 w-5"})})]}),d.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${o&&S&&n.password.length>0?"max-h-40 opacity-100":"max-h-0 opacity-0"}`,children:d.jsx(DY,{password:n.password})}),y.password&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.password})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Confirm password"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(fD,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:a?"text":"password",value:n.confirmPassword,onChange:R=>{_("confirmPassword"),s({...n,confirmPassword:R.target.value})},className:"block w-full pl-11 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Re-enter password"})]}),y.confirmPassword&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.confirmPassword})]}),d.jsx("button",{type:"submit",disabled:p,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#3498db] hover:bg-[#2980b9] text-white font-semibold rounded-xl disabled:opacity-70 transition-all active:scale-[0.98]",children:p?d.jsx(ar,{className:"h-5 w-5 animate-spin"}):"Sign up"})]}):d.jsxs("form",{onSubmit:N,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Verification Code"}),d.jsx("input",{type:"text",required:!0,maxLength:6,className:"block w-full text-center text-3xl tracking-[0.5em] font-mono py-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"000000",value:f,onChange:R=>h(R.target.value)})]}),d.jsx("button",{type:"submit",disabled:p,className:"w-full py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-xl shadow-lg shadow-green-500/30 transition-all active:scale-[0.98]",children:"Confirm Registration"}),d.jsxs("button",{type:"button",onClick:()=>r("details"),className:"w-full text-slate-500 text-sm flex items-center justify-center gap-2",children:[d.jsx(KE,{className:"h-4 w-4"})," Back to details"]})]}),d.jsxs("div",{className:"mt-8 text-center text-sm border-t border-slate-100 pt-6",children:["Already have an account?"," ",d.jsx(Af,{to:"/login",className:"font-semibold text-blue-600 hover:text-blue-700",children:"Sign in"})]})]})},MY=()=>{const e=Ln(),[t,r]=ne.useState("request"),[n,s]=ne.useState(""),[a,i]=ne.useState(""),[o,c]=ne.useState(""),[f,h]=ne.useState(!1),[p,x]=ne.useState(!1),[g,v]=ne.useState(null),[y,w]=ne.useState({}),_=Object.values(Df).some(V=>!V.test(o)),S=()=>{const V={},I=J0(n);return I&&(V.email=I),w(V),Object.keys(V).length===0},E=()=>{const V={};return a.trim()||(V.otp="Recovery code is required"),o.trim()?_&&(V.newPassword="Password does not meet requirements"):V.newPassword="New password is required",w(V),Object.keys(V).length===0},N=async V=>{if(V.preventDefault(),v(null),!!S()){x(!0);try{await QV({username:n}),r("confirm")}catch(I){(I==null?void 0:I.name)==="UserNotFoundException"?v("Email does not exist"):v("Unable to process your request. Please try again.")}finally{x(!1)}}},k=async V=>{if(V.preventDefault(),v(null),!!E()){x(!0);try{await tq({username:n,confirmationCode:a,newPassword:o}),e("/login")}catch(I){v((I==null?void 0:I.message)||"Reset failed")}finally{x(!1)}}},O=t==="request"?"Reset password":"Set new password",R=t==="request"?"We will send a recovery code to your email":"Enter the code and choose a new password";return d.jsxs(JE,{title:O,subtitle:R,children:[g&&d.jsx("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 text-sm",children:g}),t==="request"?d.jsxs("form",{onSubmit:N,className:"space-y-6",noValidate:!0,children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email Address"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(o0,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"email",value:n,onChange:V=>{s(V.target.value),w(I=>({...I,email:void 0}))},className:"block w-full pl-11 pr-4 py-3 rounded-xl outline-none transition-all bg-slate-50 border border-slate-200 focus:ring-blue-500",placeholder:"name@winvale.com"})]}),y.email&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.email})]}),d.jsxs("button",{type:"submit",disabled:p,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#3498db] hover:bg-[#2980b9] text-white font-semibold rounded-xl shadow-lg shadow-blue-500/30 transition-all active:scale-[0.98] disabled:opacity-70",children:[p?d.jsx(ar,{className:"h-5 w-5 animate-spin"}):"Send Code",!p&&d.jsx(a0,{className:"h-5 w-5"})]})]}):d.jsxs("form",{onSubmit:k,className:"space-y-6",noValidate:!0,children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Recovery Code"}),d.jsx("input",{type:"text",maxLength:6,value:a,onChange:V=>{i(V.target.value),w(I=>({...I,otp:void 0}))},className:`block w-full text-center text-2xl tracking-[0.5em] font-mono py-4 rounded-xl outline-none transition-all
              bg-slate-50 border border-slate-200 focus:ring-blue-500`,placeholder:"000000"}),y.otp&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.otp})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"New Password"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(y1,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"password",value:o,onChange:V=>{c(V.target.value),w(I=>({...I,newPassword:void 0}))},onFocus:()=>h(!0),onBlur:()=>h(!1),className:`block w-full pl-11 pr-4 py-3 rounded-xl outline-none transition-all
                  bg-slate-50 border border-slate-200 focus:ring-blue-500`,placeholder:"Min. 8 characters"})]}),y.newPassword&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.newPassword}),d.jsx("div",{className:`overflow-hidden transition-all duration-300 ${f&&o.length>0&&_?"max-h-40 opacity-100":"max-h-0 opacity-0"}`,children:d.jsx("ul",{className:"mt-3 space-y-1 text-sm",children:Object.entries(Df).map(([V,I])=>{const Z=I.test(o);return d.jsxs("li",{className:`flex items-center gap-2 ${Z?"text-green-600":"text-slate-400"}`,children:[d.jsx("span",{className:`inline-flex h-4 w-4 items-center justify-center rounded-full border text-xs ${Z?"border-green-600 bg-green-600 text-white":"border-slate-300"}`,children:Z?"":""}),I.label]},V)})})})]}),d.jsxs("button",{type:"submit",disabled:p,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#3498db] hover:bg-[#2980b9] text-white font-semibold rounded-xl shadow-lg shadow-blue-500/30 transition-all active:scale-[0.98] disabled:opacity-70",children:[p?d.jsx(ar,{className:"h-5 w-5 animate-spin"}):"Update Password",!p&&d.jsx(a0,{className:"h-5 w-5"})]})]}),d.jsx("div",{className:"mt-8 pt-6 border-t border-slate-100 text-center",children:d.jsxs(Af,{to:"/login",className:"inline-flex items-center text-sm font-semibold text-blue-600 hover:text-blue-700",children:[d.jsx(KE,{className:"h-4 w-4 mr-2"})," Back to sign in"]})})]})},FY=()=>d.jsxs("div",{className:"mb-10",children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"Settings"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Manage your profile and security"})]}),PY={admin:"Administrator",user:"Consultant"},LY=/^\+?\d{1,14}$/,y3="w-full px-4 py-2.5 rounded-xl border border-slate-200 focus:outline-none focus:ring-4 focus:ring-[#3498db]/10 focus:border-[#3498db] transition-all bg-slate-50/50 text-slate-700",v3="w-full px-4 py-2.5 rounded-xl border border-slate-100 bg-slate-100/50 text-slate-500 cursor-not-allowed",BY=({user:e,onSave:t,loading:r})=>{var y;const[n,s]=ne.useState((e==null?void 0:e.name)||""),[a,i]=ne.useState(e!=null&&e.phone_no&&e.phone_no!=="NA"?e.phone_no:""),[o,c]=ne.useState(""),[f,h]=ne.useState(""),[p,x]=ne.useState(""),g=async()=>{const w=n.trim(),_=a.trim();if(c(""),x(""),h(""),!w){c("Full name is required");return}if(w.length<3){c("Full name must be at least 3 characters");return}if(w.length>30){c("Full name must be under 30 characters");return}if(_&&!LY.test(_)){x("Phone number must be up to 14 digits and may start with +");return}if(w===(e==null?void 0:e.name)&&(_||null)===((e==null?void 0:e.phone_no)||null)){h("No changes to save");return}await t({fullName:w,phone:_===""?null:_})},v=w=>{i(w.target.value),x(""),h("")};return d.jsx("section",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-slate-100/80 overflow-hidden",children:d.jsxs("div",{className:"p-8 space-y-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-8",children:[d.jsx("div",{className:"w-28 h-28 rounded-3xl bg-[#3498db]/10 flex items-center justify-center text-4xl font-bold text-[#3498db] border-4 border-white shadow-xl",children:((y=e==null?void 0:e.name)==null?void 0:y.charAt(0))||"U"}),d.jsxs("div",{className:"text-center sm:text-left",children:[d.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:e==null?void 0:e.name}),d.jsxs("div",{className:"inline-flex items-center gap-2 mt-2 px-3 py-1 bg-slate-100 rounded-full",children:[d.jsx(YE,{className:"w-3.5 h-3.5 text-[#3498db]"}),d.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-600",children:PY[e==null?void 0:e.role]||"User"})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700 ml-1",children:"Full Name"}),d.jsx("input",{className:`${y3} ${o?"border-red-500":""}`,value:n,onChange:w=>{s(w.target.value),c(""),h("")}}),o&&d.jsx("p",{className:"text-sm text-red-600 mt-1 ml-1",children:o})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700 ml-1",children:"Email"}),d.jsx("input",{type:"email",autoComplete:"email",name:"email",className:v3,value:(e==null?void 0:e.email)||"",disabled:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700 ml-1",children:"Phone Number"}),d.jsx("input",{type:"tel",autoComplete:"tel",name:"phone",className:`${y3} ${p?"border-red-500":""}`,value:a,onChange:v,placeholder:"+1234567890"}),p&&d.jsx("p",{className:"text-sm text-red-600 mt-1 ml-1",children:p})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700 ml-1",children:"Status"}),d.jsx("input",{className:v3,value:e!=null&&e.is_active?"Active":"Inactive",disabled:!0})]})]}),f&&d.jsx("div",{className:"w-full bg-red-50 p-4 border-l-4 border-red-600",children:d.jsx("p",{className:"text-sm text-red-600",children:f})}),d.jsx("div",{className:"flex justify-end pt-4",children:d.jsxs("button",{onClick:g,disabled:r,className:"btn-primary flex items-center gap-2",children:[d.jsx(JX,{className:"w-4 h-4"}),"Save Changes"]})})]})})},_b="w-full px-4 py-2.5 rounded-xl border border-slate-200 focus:outline-none focus:ring-4 focus:ring-[#3498db]/10 focus:border-[#3498db] transition-all bg-slate-50/50 text-slate-700",UY=({onUpdate:e,loading:t})=>{const[r,n]=ne.useState(!1),[s,a]=ne.useState(""),[i,o]=ne.useState(""),[c,f]=ne.useState(""),[h,p]=ne.useState(!1),[x,g]=ne.useState(!1),[v,y]=ne.useState(!1),[w,_]=ne.useState(!1),[S,E]=ne.useState(""),[N,k]=ne.useState(""),[O,R]=ne.useState(""),V=Object.values(Df).some(F=>!F.test(i)),I=()=>{E(""),k(""),R("")},Z=async()=>{if(I(),!s){E("Current password is required");return}if(!i){k("New password is required");return}if(V){k("Password does not meet all requirements");return}if(!c){R("Please confirm your new password");return}if(i!==c){R("Passwords do not match");return}if(!await e(s,i,c)){E("Current password is incorrect");return}ce()},ce=()=>{n(!1),a(""),o(""),f(""),p(!1),g(!1),y(!1),_(!1),I()};return d.jsx("section",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-slate-100/80 overflow-hidden",children:r?d.jsxs("div",{className:"p-8 space-y-6",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Update Password"}),d.jsx("button",{onClick:ce,children:d.jsx(Zn,{className:"w-5 h-5 text-slate-400"})})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:h?"text":"password",className:`${_b} ${S?"border-red-500":""} pr-10`,autoComplete:"current-password",placeholder:"Current password",value:s,onChange:F=>{a(F.target.value),E("")}}),d.jsx("button",{type:"button",onClick:()=>p(F=>!F),className:"absolute inset-y-0 right-3 flex items-center text-slate-400",children:h?d.jsx(Mh,{size:16}):d.jsx(Co,{size:16})})]}),S&&d.jsx("p",{className:"text-xs text-red-600 mt-1 ml-1",children:S})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:x?"text":"password",className:`${_b} ${N?"border-red-500":""} pr-10`,autoComplete:"new-password",placeholder:"New password",value:i,onChange:F=>{o(F.target.value),k("")},onFocus:()=>_(!0),onBlur:()=>_(!1)}),d.jsx("button",{type:"button",onClick:()=>g(F=>!F),className:"absolute inset-y-0 right-3 flex items-center text-slate-400",children:x?d.jsx(Mh,{size:16}):d.jsx(Co,{size:16})})]}),N&&d.jsx("p",{className:"text-xs text-red-600 mt-1 ml-1",children:N}),d.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${w&&i.length>0&&V?"max-h-40 opacity-100":"max-h-0 opacity-0"}`,children:d.jsx("ul",{className:"mt-3 space-y-1 text-sm",children:Object.entries(Df).map(([F,X])=>{const P=X.test(i);return d.jsxs("li",{className:`flex items-center gap-2 ${P?"text-green-600":"text-slate-400"}`,children:[d.jsx("span",{className:`inline-flex h-4 w-4 items-center justify-center rounded-full border text-xs ${P?"border-green-600 bg-green-600 text-white":"border-slate-300"}`,children:P?"":""}),X.label]},F)})})})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:v?"text":"password",className:`${_b} ${O?"border-red-500":""} pr-10`,autoComplete:"new-password",placeholder:"Confirm new password",value:c,onChange:F=>{f(F.target.value),R("")}}),d.jsx("button",{type:"button",onClick:()=>y(F=>!F),className:"absolute inset-y-0 right-3 flex items-center text-slate-400",children:v?d.jsx(Mh,{size:16}):d.jsx(Co,{size:16})})]}),O&&d.jsx("p",{className:"text-xs text-red-600 mt-1 ml-1",children:O})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:Z,disabled:t,className:"btn-primary",children:"Update Password"}),d.jsx("button",{onClick:ce,className:"px-6 py-2.5 font-bold text-slate-500",children:"Cancel"})]})]}):d.jsxs("div",{className:"p-8 flex items-center justify-between cursor-pointer",onClick:()=>n(!0),children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx(y1,{className:"w-6 h-6 text-slate-500"}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Password"}),d.jsx("p",{className:"text-sm text-slate-500",children:"Change your account password"})]})]}),d.jsx(Mr,{className:"w-4 h-4 text-[#3498db]"})]})})};function zY(){const{user:e,refreshUser:t}=Hi(),[r,n]=ne.useState(!1),s=async i=>{try{n(!0),await oq({userAttributes:{name:i.fullName}}),await zt.put("/users",{name:i.fullName.trim(),phone_no:i.phone}),await t(),wn.success("Profile updated successfully")}catch(o){console.error(o),wn.error("Failed to update profile")}finally{n(!1)}},a=async(i,o,c)=>{var f;try{return n(!0),await aq({oldPassword:i,newPassword:o}),wn.success("Password updated successfully"),!0}catch(h){return console.error(h),(h==null?void 0:h.name)==="NotAuthorizedException"||(f=h==null?void 0:h.message)!=null&&f.toLowerCase().includes("incorrect")||wn.error(h.message||"Password update failed"),!1}finally{n(!1)}};return d.jsxs("div",{className:"min-h-screen bg-slate-50/50 p-6 lg:p-10 space-y-10",children:[d.jsx(FY,{}),d.jsxs("div",{className:"space-y-6",children:[d.jsx(BY,{user:e,onSave:s,loading:r}),d.jsx(UY,{onUpdate:a,loading:r})]})]})}const HY=()=>{const e=Vi();return ne.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),d.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:d.jsxs("div",{className:"text-center",children:[d.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),d.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),d.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},VY=()=>{const{refreshUser:e,logout:t}=Hi();return ne.useEffect(()=>{const r=setInterval(()=>{e().catch(()=>{})},2e4);return()=>clearInterval(r)},[e]),d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#f5f6f7] px-4",children:d.jsxs("div",{className:"w-full max-w-md bg-white border border-slate-200 rounded-md p-10 text-center",children:[d.jsx("div",{className:"flex justify-center mb-8",children:d.jsx("img",{src:"/logo.png",alt:"Winvale",className:"h-9 object-contain"})}),d.jsxs("p",{className:"text-base text-slate-800 leading-relaxed",children:[d.jsx("span",{className:"font-semibold",children:"Your account has been created and is awaiting approval."}),d.jsx("br",{}),d.jsx("br",{}),"Access to the system will be enabled once your request has been reviewed and approved by the"," ",d.jsx("span",{className:"font-semibold",children:"Winvale Administration team"}),"."]}),d.jsx("div",{className:"mt-10",children:d.jsx("button",{onClick:t,className:"w-full btn-primary",children:"Done"})})]})})},Eb=({isAuthenticated:e,allowedRoles:t})=>{const{user:r,status:n,isActive:s}=Hi();return n==="loading"||e&&!r?null:e?s?t&&!t.includes(r.role)?d.jsx(El,{to:"/dashboard",replace:!0}):d.jsx(tD,{}):d.jsx(El,{to:"/pending-approval",replace:!0}):d.jsx(El,{to:"/login",replace:!0})},dn={ADMIN:"admin",USER:"user"},qY=[{label:"Overview",items:[{to:"/dashboard",icon:bX,label:"Dashboard",roles:[dn.ADMIN,dn.USER]}]},{label:"Analysis",items:[{to:"/pricelist-analysis",icon:eX,label:"Pricelist Analysis",roles:[dn.ADMIN,dn.USER]},{to:"/analyses",icon:hX,label:"Analysis History",roles:[dn.ADMIN,dn.USER]}]},{label:"Workspace",items:[{to:"/clients",icon:In,label:"Clients",roles:[dn.ADMIN,dn.USER]},{to:"/contracts",icon:lD,label:"Contracts",roles:[dn.ADMIN,dn.USER]},{to:"/gsa-products",icon:_X,label:"GSA Products",roles:[dn.ADMIN,dn.USER]}]},{label:"Administrative",items:[{to:"/user-activation",icon:Kx,label:"User Management",roles:[dn.ADMIN]},{to:"/client-activation",icon:In,label:"Client Management",roles:[dn.ADMIN]}]},{label:"System",items:[{to:"/settings",icon:uD,label:"Settings",roles:[dn.ADMIN,dn.USER]}]}];function WY(){var v;const{user:e,logout:t}=Hi(),[r,n]=ne.useState(!1),[s,a]=ne.useState(!1),[i,o]=ne.useState({Overview:!0,Analysis:!0,Workspace:!1,Administrative:!0,System:!1}),c=Ln(),f=(e==null?void 0:e.role)===dn.ADMIN,h={admin:"Administrator",user:"Consultant"};ne.useEffect(()=>{document.body.style.overflow=r?"hidden":"unset"},[r]);const p=y=>{f&&o(w=>({...w,[y]:!w[y]}))},x=()=>a(!0),g=async()=>{await t(),a(!1),n(!1)};return d.jsxs(d.Fragment,{children:[d.jsx("header",{className:"md:hidden sticky top-0 left-0 right-0 h-16 flex items-center justify-between px-4 z-40 bg-white border-b border-slate-200",children:d.jsx("button",{onClick:()=>n(!0),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:d.jsx(IX,{className:"w-6 h-6 text-slate-600"})})}),d.jsx("div",{className:`fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-40 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>n(!1)}),d.jsxs("aside",{className:`
          fixed md:sticky top-0 inset-y-0 left-0 z-50
          w-72 md:w-64 bg-[#f8fafc] border-r border-slate-200
          flex flex-col h-screen
          transform transition-transform duration-300 ease-in-out
          ${r?"translate-x-0":"-translate-x-full"}
          md:translate-x-0
        `,children:[d.jsxs("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between",children:[d.jsxs("div",{onClick:()=>{c("/dashboard"),n(!1)},className:"flex items-center gap-3 cursor-pointer",children:[d.jsx("img",{src:"logo.png",alt:"Logo",className:"w-8 h-8 object-contain"}),d.jsx("span",{className:"text-2xl font-bold text-[#1e293b] tracking-tight",children:"Winvale"})]}),d.jsx("button",{onClick:()=>n(!1),className:"md:hidden p-2 hover:bg-slate-200/50 rounded-lg transition-colors",children:d.jsx(Zn,{className:"w-5 h-5 text-slate-500"})})]}),d.jsx("nav",{className:"flex-1 overflow-y-auto custom-scrollbar py-4",children:qY.map(y=>{const w=y.items.filter(S=>e&&S.roles.includes(e.role));if(w.length===0)return null;const _=!f||i[y.label];return d.jsxs("div",{className:"mb-4",children:[d.jsxs("button",{disabled:!f,onClick:()=>p(y.label),className:`w-full flex items-center justify-between px-6 mb-1 text-[10px] font-bold uppercase tracking-widest transition-colors ${f?"hover:text-slate-900 cursor-pointer text-slate-400":"text-slate-400"}`,children:[d.jsx("span",{children:y.label}),f&&(_?d.jsx(i0,{size:12}):d.jsx(Mr,{size:12}))]}),d.jsx("div",{className:`space-y-0.5 overflow-hidden transition-all duration-300 ${_?"max-h-125 opacity-100":"max-h-0 opacity-0"}`,children:w.map(S=>d.jsx(aD,{to:S.to,onClick:()=>n(!1),className:({isActive:E})=>`group flex items-center gap-3.5 px-6 py-2 transition-all duration-200 relative ${E?"text-[#24578f] font-semibold bg-[#e0e4eb]":"text-slate-500 hover:text-slate-900 hover:bg-slate-100/50"}`,children:({isActive:E})=>d.jsxs(d.Fragment,{children:[E&&d.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-[#24578f] rounded-r-full"}),d.jsx(S.icon,{className:`w-5 h-5 ${E?"text-[#24578f]":"text-slate-400 group-hover:text-slate-600"}`,strokeWidth:E?2.5:2}),d.jsx("span",{children:S.label})]})},S.to))})]},y.label)})}),d.jsxs("div",{className:"p-4 bg-slate-50/50 border-t border-slate-200",children:[d.jsxs("div",{className:"flex items-center gap-3 p-2.5 rounded-xl bg-white border border-slate-200 shadow-sm mb-3",children:[d.jsx("div",{className:"w-10 h-10 rounded-full bg-linear-to-br from-[#c3d7e7] to-[#a3c1da] flex items-center justify-center shrink-0",children:d.jsx("span",{className:"text-sm font-bold text-[#1e293b]",children:((v=e==null?void 0:e.name)==null?void 0:v.charAt(0).toUpperCase())||"U"})}),d.jsxs("div",{className:"min-w-0 overflow-hidden",children:[d.jsx("p",{className:"text-sm font-bold text-slate-800 truncate",children:(e==null?void 0:e.name)||"User"}),d.jsx("p",{className:"text-[11px] text-slate-500 font-medium uppercase tracking-wider",children:h[e==null?void 0:e.role]||"Guest"})]})]}),d.jsxs("button",{onClick:x,className:"w-full flex items-center gap-3 px-3 py-2.5 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all group",children:[d.jsx(RX,{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform"}),d.jsx("span",{className:"font-semibold text-sm",children:"Sign out"})]})]})]}),s&&d.jsx("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-slate-900/40",children:d.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-sm shadow-xl mx-4",children:[d.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Confirm Signout"}),d.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"Are you sure you want to sign out?"}),d.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[d.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-600 hover:bg-slate-100 transition-colors",children:"Cancel"}),d.jsx("button",{onClick:g,className:"px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition-colors",children:"Sign out"})]})]})})]})}function $Y(){return d.jsxs("div",{className:"flex h-screen overflow-hidden bg-background",children:[d.jsx(WY,{}),d.jsx("main",{className:"flex-1 overflow-auto",children:d.jsx(tD,{})})]})}const df=(e,t)=>{const r={},n=xD(e.company_name,!0);n&&(r.company_name=n);const s=J0(e.company_email);s&&(r.company_email=s);const a=mD(e.company_phone_no,"Company Phone");a&&(r.company_phone_no=a);const i=Eo(e.company_address,"Company Address")||Yn(e.company_address,50,"Address");i&&(r.company_address=i);const o=Eo(e.company_city,"City")||Yn(e.company_city,50,"City");o&&(r.company_city=o);const c=Eo(e.company_state,"State")||Yn(e.company_state,50,"State");c&&(r.company_state=c);const f=Eo(e.company_zip,"ZIP"),h=ZE(e.company_zip);return(f||h)&&(r.company_zip=f||h||""),t(r),Object.keys(r).length===0},S_=e=>{const t={},r=xD(e.contact_officer_name,!1);r&&(t.contact_officer_name=r);const n=J0(e.contact_officer_email);n&&(t.contact_officer_email=n==="Email is required"?"Email address is required":n);const s=mD(e.contact_officer_phone_no,"Phone number");s&&(t.contact_officer_phone_no=s);const a=Yn(e.contact_officer_address,50,"Address");a&&(t.contact_officer_address=a);const i=Yn(e.contact_officer_city,50,"City");i&&(t.contact_officer_city=i);const o=Yn(e.contact_officer_state,50,"State");o&&(t.contact_officer_state=o);const c=ZE(e.contact_officer_zip);return c&&(t.contact_officer_zip=c),{isValid:Object.keys(t).length===0,errors:t}},If="inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-[10px] font-bold uppercase tracking-wider border",Z0={pending:{slug:"pending",label:"Pending",styles:"bg-orange-50 text-orange-600 border-orange-100",icon:Bi},active:{slug:"active",label:"Active",styles:"bg-[#DCFCE7] text-[#15803D] border-[#BBF7D0]",icon:HK},inactive:{slug:"inactive",label:"Inactive",styles:"bg-[#E5E7EB] text-[#374151] border-[#D1D5DB]",icon:UK},approved:{slug:"approved",label:"Approved",styles:"bg-emerald-50 text-emerald-600 border-emerald-100",icon:us},rejected:{slug:"rejected",label:"Rejected",styles:"bg-rose-50 text-rose-600 border-rose-100",icon:Cf}},lu=e=>{if(!e)return"unknown";const t=e.toLowerCase();return t in Z0?t:"unknown"},Rx=e=>{var r,n,s,a;const t=e.contact_officer_name||e.contact_officer_email||e.contact_officer_phone_no||e.contact_officer_address;return{id:e.client_id,name:e.company_name,contract:e.contract_number||"",status:lu(e.status),products:e.products_count??0,lastModification:((r=e.updated_time||e.created_time)==null?void 0:r.split("T")[0])??"",contact:t?{name:((n=e.contact_officer_name)==null?void 0:n.trim())||null,email:((s=e.contact_officer_email)==null?void 0:s.trim())||null,phone:((a=e.contact_officer_phone_no)==null?void 0:a.trim())||null,address:[e.contact_officer_address,e.contact_officer_city,e.contact_officer_state,e.contact_officer_zip].filter(Boolean).join(", ")||null}:null,email:e.company_email,phone:e.company_phone_no,address:[e.company_address,e.company_city,e.company_state,e.company_zip].filter(Boolean).join(", ")}},GY=e=>{var t;return{id:e.data.client_id,name:e.data.company_name,contract:e.data.contract_number||"",status:e.data.status,products:0,lastModification:((t=e.data.created_at)==null?void 0:t.split("T")[0])??"",contact:e.data.contact_officer_name||e.data.contact_officer_email||e.data.contact_officer_phone_no?{name:e.data.contact_officer_name||null,email:e.data.contact_officer_email||null,phone:e.data.contact_officer_phone_no||null,address:[e.data.contact_officer_address,e.data.contact_officer_city,e.data.contact_officer_state,e.data.contact_officer_zip].filter(Boolean).join(", ")||null}:null,email:e.data.company_email,phone:e.data.company_phone_no,address:[e.data.company_address,e.data.company_city,e.data.company_state,e.data.company_zip].filter(Boolean).join(", ")}},KY=(e,t)=>{var r;return{id:e.data.client_id,name:e.data.company_name,contract:e.data.contract_number||"",status:e.data.status,products:t||0,lastModification:((r=e.data.updated_time)==null?void 0:r.split("T")[0])??"",contact:e.data.contact_officer_name||e.data.contact_officer_email||e.data.contact_officer_phone_no?{name:e.data.contact_officer_name||null,email:e.data.contact_officer_email||null,phone:e.data.contact_officer_phone_no||null,address:[e.data.contact_officer_address,e.data.contact_officer_city,e.data.contact_officer_state,e.data.contact_officer_zip].filter(Boolean).join(", ")||null}:null,email:e.data.company_email,phone:e.data.company_phone_no,address:[e.data.company_address,e.data.company_city,e.data.company_state,e.data.company_zip].filter(Boolean).join(", ")}},b3=()=>({company_name:"",company_email:"",company_phone_no:"",company_address:"",company_city:"",company_state:"",company_zip:"",contact_officer_name:"",contact_officer_email:"",contact_officer_phone_no:"",contact_officer_address:"",contact_officer_city:"",contact_officer_state:"",contact_officer_zip:"",status:"pending"}),XY=({onAddClick:e})=>d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-12 mx-auto",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-[#1E293B]",children:"Clients"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Manage your GSA contract clients and their information"})]}),d.jsxs("button",{onClick:e,className:"flex items-center justify-center gap-2 bg-[#38A1DB] hover:bg-[#2D8BBF] text-white px-7 py-3 rounded-xl shadow-lg shadow-blue-200 transition-all active:scale-95 font-bold",children:[d.jsx(ud,{className:"w-5 h-5 stroke-[3px]"}),"Add Client"]})]}),YY=({searchQuery:e,onSearchChange:t,filterStatus:r,onFilterChange:n})=>{const s=["all","approved","pending","rejected"];return d.jsxs("div",{className:"mx-auto bg-white p-4 rounded-4xl shadow-sm border border-slate-200 mb-8 flex flex-col lg:flex-row gap-4 items-center",children:[d.jsxs("div",{className:"relative flex-1 w-full",children:[d.jsx(Wl,{className:"absolute left-5 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),d.jsx("input",{type:"text",placeholder:"Search clients by name, email, or contact...",className:"w-full pl-14 pr-6 py-3.5 rounded-2xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20  bg-slate-50/50 text-slate-700 placeholder:text-slate-400 transition-all font-medium",value:e,onChange:a=>t(a.target.value)})]}),d.jsx("div",{className:"flex p-1.5 bg-slate-100 rounded-2xl w-full lg:w-auto overflow-x-auto no-scrollbar",children:s.map(a=>{const i=r===a;return d.jsx("button",{onClick:()=>n(a),className:`
                flex-1 lg:flex-none px-6 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-all duration-200 whitespace-nowrap
                ${i?"bg-white text-[#24548f] shadow-sm ring-1 ring-slate-200":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}
              `,children:a},a)})})]})},w3=({client:e,onView:t,onEdit:r,onClose:n})=>{const s=Ln();return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 z-40",onClick:a=>{a.stopPropagation(),n()}}),d.jsxs("div",{className:"absolute right-8 top-12 z-50 w-52 bg-white border border-slate-100 rounded-2xl shadow-xl py-2",onClick:a=>a.stopPropagation(),children:[d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{t(),n()},children:[d.jsx(Co,{className:"w-4 h-4"}),"View Details"]}),d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{r(),n()},children:[d.jsx(X0,{className:"w-4 h-4"}),"Edit Client"]}),d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{s(`/clients/${e.id}/products`),n()},children:[d.jsx(PX,{className:"w-4 h-4"}),"View Products"]})]})]})},_3=e=>{if(!e)return"";const t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})},E3=e=>{const t=lu(e);if(t==="unknown")return d.jsx("span",{className:`${If} bg-slate-100 text-slate-700 border-slate-200`,children:"Unknown"});const{label:r,styles:n,icon:s}=Z0[t];return d.jsxs("span",{className:`${If} ${n}`,children:[d.jsx(s,{className:"w-3 h-3 stroke-[2.5px]"}),d.jsx("span",{className:"hidden sm:inline",children:r})]})},JY=({clients:e,loading:t,openClientId:r,onClientClick:n,onMenuToggle:s,onView:a,onEdit:i,currentPage:o,totalClients:c,itemsPerPage:f,onPageChange:h})=>{const p=Math.ceil(c/f),x=(o-1)*f,g=()=>{const y=[];for(let _=1;_<=p;_++)_===1||_===p||_>=o-1&&_<=o+1?y.push(_):y[y.length-1]!=="..."&&y.push("...");return y},v=()=>d.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-center px-4",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center mb-4 border border-slate-100",children:d.jsx(g1,{className:"w-8 h-8 text-slate-300"})}),d.jsx("h3",{className:"text-base font-bold text-slate-500",children:"No clients found"})]});return d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 ",children:[d.jsx("div",{className:"hidden md:block",children:d.jsxs("table",{className:"w-full text-left border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Client"}),d.jsx("th",{className:"px-4 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Contact"}),d.jsx("th",{className:"hidden lg:table-cell px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Company Email"}),d.jsx("th",{className:"hidden xl:table-cell px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Last Modified"}),d.jsx("th",{className:"w-16 p-5"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:t?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading clients..."})]})})}):e.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,children:d.jsx(v,{})})}):e.map(y=>d.jsxs("tr",{onClick:()=>n(y),className:"group hover:bg-blue-50/30 cursor-pointer transition-all duration-200",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"shrink-0 w-9 h-9 rounded-xl bg-linear-to-br from-[#3399cc] to-[#2980b9] flex items-center justify-center text-white font-bold text-xs shadow-sm",children:y.name.substring(0,2).toUpperCase()}),d.jsx("span",{className:"font-semibold text-slate-900 group-hover:text-[#38A1DB] transition-colors  max-w-50",children:y.name})]})}),d.jsx("td",{className:"px-4 py-4",children:E3(y.status)}),d.jsx("td",{className:"px-6 py-4",children:y.contact?d.jsxs("div",{className:"flex flex-col max-w-37.5",children:[d.jsx("span",{className:"text-sm font-semibold text-slate-900 truncate",children:y.contact.name}),d.jsx("span",{className:"hidden lg:block text-xs text-slate-500 truncate",children:y.contact.email})]}):d.jsx("span",{className:"text-[10px] italic font-medium text-gray-400 uppercase",children:"Not Assigned"})}),d.jsx("td",{className:"hidden lg:table-cell px-6 py-4 text-sm font-medium text-slate-600 truncate max-w-45",children:y.email}),d.jsx("td",{className:"hidden xl:table-cell px-6 py-4 text-sm text-slate-500",children:d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[d.jsx(cd,{className:"w-3.5 h-3.5 text-slate-400"}),_3(y.lastModification)]})}),d.jsxs("td",{className:"p-5 relative text-right",children:[d.jsx("button",{onClick:w=>{w.stopPropagation(),s(y.id)},className:"p-2 hover:bg-slate-200 rounded-lg transition-colors",children:d.jsx(Ll,{className:"w-5 h-5 text-slate-500"})}),r===y.id&&d.jsx(w3,{client:y,onView:()=>a(y),onEdit:()=>i(y),onClose:()=>s(y.id)})]})]},y.id))})]})}),d.jsx("div",{className:"md:hidden divide-y divide-slate-100",children:t?d.jsx("div",{className:"py-20 text-center",children:d.jsx(ar,{className:"w-8 h-8 animate-spin mx-auto text-[#24578f]"})}):e.length===0?d.jsx(v,{}):e.map(y=>{var w;return d.jsxs("div",{onClick:()=>n(y),className:"p-5 hover:bg-blue-50/50 transition active:bg-blue-100",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 rounded-2xl bg-linear-to-br from-[#3399cc] to-[#2980b9] flex items-center justify-center text-white font-bold text-lg shadow-blue-100 shadow-lg",children:y.name.substring(0,2).toUpperCase()}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-900 text-lg",children:y.name}),d.jsx("div",{className:"mt-1",children:E3(y.status)})]})]}),d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:_=>{_.stopPropagation(),s(y.id)},className:"p-2 border border-slate-200 rounded-xl bg-white shadow-sm",children:d.jsx(Ll,{className:"w-5 h-5 text-slate-500"})}),r===y.id&&d.jsx(w3,{client:y,onView:()=>a(y),onEdit:()=>i(y),onClose:()=>s(y.id)})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-slate-50 rounded-xl p-4 border border-slate-100",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Contact"}),d.jsx("p",{className:"text-sm font-semibold text-slate-800 truncate",children:((w=y.contact)==null?void 0:w.name)||""})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Modified"}),d.jsx("p",{className:"text-sm font-semibold text-slate-800",children:_3(y.lastModification)})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Company Email"}),d.jsx("p",{className:"text-sm font-semibold text-slate-800",children:y.email})]})]})]},y.id)})}),!t&&c>f&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:x+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(x+f,c)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:c})," ","clients"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:o===1,onClick:()=>h(o-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Es,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:g().map((y,w)=>d.jsx(We.Fragment,{children:y==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>h(Number(y)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                        ${o===y?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:y})},w))}),d.jsx("button",{disabled:o===p,onClick:()=>h(o+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})},dh=({icon:e,value:t})=>t?d.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[d.jsx(e,{className:"w-4 h-4 text-slate-400"}),d.jsx("span",{className:"text-sm",children:t})]}):null,gD=({client:e,onClose:t,onEdit:r})=>{if(!e)return null;const n=()=>{r(e),t()};return d.jsxs("div",{className:"fixed inset-0 bg-slate-900/40  z-50 flex items-center justify-center p-4 h-full",children:[d.jsx("div",{className:"absolute inset-0",onClick:t}),d.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"relative bg-linear-to-br p-8",children:[d.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-3 rounded-full hover:bg-white/20 text-slate-700 transition-colors",children:d.jsx(Zn,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex items-center gap-6",children:[d.jsx("div",{className:"w-20 h-20 rounded-2xl bg-[#38A1DB] shadow-lg flex items-center justify-center text-white font-black text-2xl border-4 border-white/20",children:e.name.split(" ").map(s=>s[0]).slice(0,2).join("").toUpperCase()}),d.jsxs("div",{children:[d.jsx("p",{className:"text-blue-400 text-sm font-medium uppercase tracking-widest mb-1",children:"Client Profile"}),d.jsx("h2",{className:"text-3xl font-bold text-slate-700 tracking-tight",children:e.name})]})]})]}),d.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:d.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-slate-100",children:[d.jsx(In,{className:"w-5 h-5 text-[#38A1DB]"}),d.jsx("h3",{className:"font-bold text-slate-800 uppercase text-sm tracking-wider",children:"Company Details"})]}),d.jsxs("div",{className:"bg-slate-50/50 rounded-xl p-5 border border-slate-100 space-y-4",children:[d.jsx(dh,{icon:o0,value:e.email}),d.jsx(dh,{icon:E_,value:e.phone}),d.jsx(dh,{icon:jf,value:e.address})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-slate-100",children:[d.jsx(Y0,{className:"w-5 h-5 text-[#38A1DB]"}),d.jsx("h3",{className:"font-bold text-slate-800 uppercase text-sm tracking-wider",children:"Primary Contact"})]}),d.jsx("div",{className:"bg-blue-50/30 rounded-xl p-5 border border-blue-100/50",children:e.contact?d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-[10px] font-bold text-[#38A1DB] uppercase tracking-tighter",children:"Full Name"}),d.jsx("p",{className:"text-slate-900 font-bold text-lg leading-none mt-1",children:e.contact.name||""})]}),d.jsxs("div",{className:"pt-2 space-y-3 border-t border-blue-100/50",children:[d.jsx(dh,{icon:o0,value:e.contact.email}),d.jsx(dh,{icon:E_,value:e.contact.phone})]})]}):d.jsx("div",{className:"text-center py-6",children:d.jsx("p",{className:"text-slate-400 italic text-sm",children:"No primary contact assigned"})})})]})]})}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 rounded-b-3xl flex justify-between border-t border-slate-100",children:[d.jsx("button",{onClick:t,className:"px-6 py-3 rounded-2xl font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-all active:scale-95",children:"Close"}),d.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-6 py-3 rounded-2xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:[d.jsx(X0,{className:"w-4 h-4"}),"Edit Client"]})]})]})]})},ZY=({currentStep:e,steps:t})=>d.jsx("div",{className:"flex items-center justify-center gap-4 p-4  border-slate-100 shrink-0",children:t.map((r,n)=>{const s=n+1,a=e>=s,i=e>s;return d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold ${a?"bg-[#38A1DB] text-white":"bg-slate-200 text-slate-400"}`,children:i?d.jsx(us,{className:"w-6 h-6"}):s}),d.jsx("span",{className:`font-semibold ${a?"text-[#38A1DB]":"text-slate-400"}`,children:r})]}),n<t.length-1&&d.jsx("div",{className:`w-16 h-1 rounded-full ${i?"bg-[#38A1DB]":"bg-slate-200"}`})]},s)})}),QY=({formData:e,errors:t,onChange:r,onClearError:n})=>{const s=a=>`w-full mt-2 px-4 py-3 rounded-xl border-2 transition-colors focus:outline-none border-slate-200 focus:border-[#38A1DB]"
    `;return d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Company Name ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_name,onChange:a=>{r("company_name",a.target.value),n("company_name")},"aria-invalid":!!t.company_name}),t.company_name&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_name})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Company Email ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"email",required:!0,className:s(),value:e.company_email,onChange:a=>{r("company_email",a.target.value),n("company_email")},"aria-invalid":!!t.company_email}),t.company_email&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_email})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Company Phone ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"tel",required:!0,className:s(),value:e.company_phone_no,onChange:a=>{r("company_phone_no",a.target.value),n("company_phone_no")},"aria-invalid":!!t.company_phone_no}),t.company_phone_no&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_phone_no})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Company Address ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_address,onChange:a=>{r("company_address",a.target.value),n("company_address")},"aria-invalid":!!t.company_address}),t.company_address&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_address})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["City ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_city,onChange:a=>{r("company_city",a.target.value),n("company_city")},"aria-invalid":!!t.company_city}),t.company_city&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_city})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["State ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_state,onChange:a=>{r("company_state",a.target.value),n("company_state")},"aria-invalid":!!t.company_state}),t.company_state&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_state})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["ZIP ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_zip,onChange:a=>{r("company_zip",a.target.value),n("company_zip")},"aria-invalid":!!t.company_zip}),t.company_zip&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_zip})]})]})},eJ=({formData:e,onChange:t,errors:r,onClearError:n})=>{const s=a=>`w-full mt-2 px-4 py-3 rounded-xl border-2 transition-colors focus:outline-none border-slate-200 focus:border-[#38A1DB]"
    }`;return d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Primary Contact Name ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_name,onChange:a=>{t("contact_officer_name",a.target.value),n("contact_officer_name")},"aria-invalid":!!r.contact_officer_name}),r.contact_officer_name&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_name})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Email ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"email",className:s(),value:e.contact_officer_email,onChange:a=>{t("contact_officer_email",a.target.value),n("contact_officer_email")},"aria-invalid":!!r.contact_officer_email}),r.contact_officer_email&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_email})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Phone ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"tel",className:s(),value:e.contact_officer_phone_no,onChange:a=>{t("contact_officer_phone_no",a.target.value),n("contact_officer_phone_no")},"aria-invalid":!!r.contact_officer_phone_no}),r.contact_officer_phone_no&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_phone_no})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Address"}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_address||"",onChange:a=>{t("contact_officer_address",a.target.value),n("contact_officer_address")}}),r.contact_officer_address&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_address})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"City"}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_city||"",onChange:a=>{t("contact_officer_city",a.target.value),n("contact_officer_city")}}),r.contact_officer_city&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_city})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"State"}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_state||"",onChange:a=>{t("contact_officer_state",a.target.value),n("contact_officer_state")}}),r.contact_officer_state&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_state})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"ZIP"}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_zip||"",onChange:a=>{t("contact_officer_zip",a.target.value),n("contact_officer_zip")}}),r.contact_officer_zip&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_zip})]})]})},tJ=["Company Info","Primary Contact"],N_=({isOpen:e,title:t,subtitle:r,formData:n,errors:s,backendError:a,currentStep:i,isSubmitting:o,onClose:c,onSubmit:f,onNext:h,onBack:p,onChange:x,onClearError:g,onClearBackendError:v,submitButtonText:y="Create Client Profile"})=>{if(!e)return null;const w=_=>{_.preventDefault(),f(_)};return d.jsx("div",{className:"fixed inset-0 bg-slate-900/40 backdrop-blur-none z-50 flex items-center justify-center p-4 h-full",children:d.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[d.jsx("div",{className:"bg-linear-to-br bg-slate-50 py-4 px-8 shrink-0",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-700",children:t}),d.jsx("p",{className:"text-slate-500 text-sm opacity-80",children:r})]}),d.jsx("button",{type:"button",onClick:c,className:"p-2 hover:bg-white/20 rounded-full transition-colors",disabled:o,children:d.jsx(Zn,{className:"w-6 h-6 text-slate-700"})})]})}),d.jsx(ZY,{currentStep:i,steps:tJ}),a&&d.jsx("div",{className:"mx-8 mt-4 p-4 bg-red-50 border-l-4 border-red-500 ",children:d.jsxs("div",{className:"flex items-start",children:[d.jsx("div",{className:"ml-3 flex-1",children:d.jsx("p",{className:"text-sm font-medium text-red-800",children:a})}),v&&d.jsx("button",{type:"button",onClick:v,className:"ml-3 shrink-0 text-red-400 hover:text-red-600 transition-colors",children:d.jsx(Zn,{className:"h-5 w-5"})})]})}),d.jsxs("form",{onSubmit:w,className:"flex-1 overflow-y-auto",children:[d.jsxs("div",{className:"py-4 px-8 space-y-6",children:[i===1&&d.jsx(QY,{formData:n,errors:s,onChange:x,onClearError:g}),i===2&&d.jsx(eJ,{formData:n,onChange:x,errors:s,onClearError:g})]}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 flex justify-between border-t border-slate-100 shrink-0",children:[d.jsx("button",{type:"button",onClick:i===1?c:p,className:"px-6 py-3 rounded-xl border-2 border-slate-300 font-bold text-slate-600 hover:bg-slate-100 transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:o,children:i===1?"Cancel":"Back"}),i===1?d.jsx("button",{type:"button",onClick:h,className:"px-6 py-3 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:"Next"}):d.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:o?"Processing...":y})]})]})]})})};function rJ(){const[e,t]=ne.useState(""),[r,n]=ne.useState("all"),[s,a]=ne.useState(null),[i,o]=ne.useState([]),[c,f]=ne.useState(!0),[h,p]=ne.useState({}),[x,g]=ne.useState(""),[v,y]=ne.useState(!1),[w,_]=ne.useState(!1),[S,E]=ne.useState(1),[N,k]=ne.useState(1),[O,R]=ne.useState(null),[V,I]=ne.useState(!1),[Z,ce]=ne.useState(null),[F,X]=ne.useState(b3()),[P,ie]=ne.useState(1),te=10,Y=i.filter(B=>{var he;const be=B.name.toLowerCase().includes(e.toLowerCase())||(((he=B.contact)==null?void 0:he.name)||"").toLowerCase().includes(e.toLowerCase()),z=r==="all"||B.status===r;return be&&z}),ve=Y.length,oe=(P-1)*te,Ee=Y.slice(oe,oe+te);ne.useEffect(()=>{ie(1)},[e,r]);const K=B=>{B.preventDefault(),df(F,p)&&E(2)},D=B=>{B.preventDefault(),Z&&df(Z,p)&&k(2)},q=(B,be="operation")=>{var A,j,H,ue,ye;console.error(`Error during ${be}:`,B);const z=(A=B.response)==null?void 0:A.status,he=((H=(j=B.response)==null?void 0:j.data)==null?void 0:H.detail)||((ye=(ue=B.response)==null?void 0:ue.data)==null?void 0:ye.message);let M="";switch(z){case 400:M=he||"Invalid data provided. Please check your inputs.";break;case 401:M=he||"You are not authorized. Please log in again.";break;case 403:M=he||"You don't have permission to perform this action.";break;case 404:M=he||"Client not found.";break;case 409:M=he||"A client with this email or phone number already exists. Please use different contact information.",be==="create client"?E(1):be==="update client"&&k(1);break;case 422:M=he||"Validation error. Please check all required fields.";break;case 500:M=he||"Server error occurred. Please try again later.";break;case 503:M=he||"Service temporarily unavailable. Please try again later.";break;default:B.message==="Network Error"||(M=he||`Failed to ${be}. Please try again.`)}g(M)},W=B=>{const be={};return Object.entries(B).forEach(([z,he])=>{typeof he=="string"?be[z]=he.trim():be[z]=he}),be},J=async B=>{if(B.preventDefault(),!df(F,p)){E(1);return}const z=S_(F);if(!z.isValid){p(he=>({...he,...z.errors})),E(2);return}I(!0);try{const he=W(F),M=await zt.post("/clients",he),A=GY(M);o(j=>[A,...j]),ee(),y(!1),U()}catch(he){q(he,"create client")}finally{I(!1)}},re=async B=>{if(B.preventDefault(),!Z)return;if(!df(Z,p)){k(1);return}const z=S_(Z);if(!z.isValid){p(he=>({...he,...z.errors})),k(2);return}I(!0);try{const he=W(Z),M=await zt.put(`/clients/${Z.id}`,he),A=KY(M,Z.products||0);o(j=>j.map(H=>H.id===A.id?A:H)),_(!1),ce(null),k(1),p({})}catch(he){q(he,"update client")}finally{I(!1)}},U=()=>{X(b3()),E(1),p({}),g("")},L=B=>{var be,z,he,M,A,j,H,ue,ye,pe,Ne;ce({id:B.id,company_name:B.name,company_email:B.email,company_phone_no:B.phone,company_address:B.address.split(", ")[0]||"",company_city:B.address.split(", ")[1]||"",company_state:B.address.split(", ")[2]||"",company_zip:B.address.split(", ")[3]||"",contact_officer_name:((be=B.contact)==null?void 0:be.name)||"",contact_officer_email:((z=B.contact)==null?void 0:z.email)||"",contact_officer_phone_no:((he=B.contact)==null?void 0:he.phone)||"",contact_officer_address:((A=(M=B.contact)==null?void 0:M.address)==null?void 0:A.split(", ")[0])||"",contact_officer_city:((H=(j=B.contact)==null?void 0:j.address)==null?void 0:H.split(", ")[1])||"",contact_officer_state:((ye=(ue=B.contact)==null?void 0:ue.address)==null?void 0:ye.split(", ")[2])||"",contact_officer_zip:((Ne=(pe=B.contact)==null?void 0:pe.address)==null?void 0:Ne.split(", ")[3])||"",status:B.status,products:B.products}),k(1),p({}),g(""),_(!0)},se=(B,be,z,he)=>{be({...B,[z]:he})},Q=B=>{p(be=>({...be,[B]:void 0}))},ee=async()=>{try{f(!0);const be=(await zt.get("/clients")).data.map(Rx);o(be)}catch(B){q(B,"load clients")}finally{f(!1)}};return ne.useEffect(()=>{ee()},[]),d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-6 lg:p-10 space-y-10",children:[d.jsx(XY,{onAddClick:()=>y(!0)}),d.jsx(YY,{searchQuery:e,onSearchChange:t,filterStatus:r,onFilterChange:n}),d.jsx(JY,{clients:Ee,loading:c,openClientId:O,onClientClick:a,onMenuToggle:B=>R(O===B?null:B),onView:a,onEdit:L,currentPage:P,totalClients:ve,itemsPerPage:te,onPageChange:ie}),d.jsx(gD,{client:s,onClose:()=>a(null),onEdit:L}),d.jsx(N_,{isOpen:v,title:"Add Client",subtitle:"Set up a new Client Profile ",formData:F,errors:h,backendError:x,currentStep:S,isSubmitting:V,onClose:()=>{y(!1),U()},onSubmit:J,onNext:K,onBack:()=>E(1),onChange:(B,be)=>se(F,X,B,be),onClearError:Q,onClearBackendError:()=>g(""),submitButtonText:"Create Client Profile"}),Z&&d.jsx(N_,{isOpen:w,title:"Edit Client",subtitle:"Update client profile details",formData:Z,errors:h,backendError:x,currentStep:N,isSubmitting:V,onClose:()=>{_(!1),k(1),p({}),g("")},onSubmit:re,onNext:D,onBack:()=>k(1),onChange:(B,be)=>se(Z,ce,B,be),onClearError:Q,onClearBackendError:()=>g(""),submitButtonText:"Update Client"})]})}const jx={async getAllProducts(){return(await zt.get("/products")).data},async getProductsByClient(e){return(await zt.get(`/products/client/${e}`)).data}};function nJ(){var k;const e=Ln(),{clientId:t}=J8(),[r,n]=ne.useState([]),[s,a]=ne.useState(null),[i,o]=ne.useState(!0),[c,f]=ne.useState(""),[h,p]=ne.useState(""),[x,g]=ne.useState(1),v=10;ne.useEffect(()=>{y()},[t]);const y=async()=>{var O,R;try{o(!0);const V=await jx.getProductsByClient(Number(t));n(V.items)}catch(V){f(((R=(O=V.response)==null?void 0:O.data)==null?void 0:R.detail)||"Failed to load products")}finally{o(!1)}},w=r.filter(O=>O.item_name.toLowerCase().includes(h.toLowerCase())||O.manufacturer.toLowerCase().includes(h.toLowerCase())||O.manufacturer_part_number.toLowerCase().includes(h.toLowerCase())),_=Math.ceil(w.length/v),S=(x-1)*v,E=w.slice(S,S+v),N=O=>O==null?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O);return i?d.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:d.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[d.jsx(ar,{className:"w-12 h-12 animate-spin text-[#24578f]"}),d.jsx("span",{className:"text-slate-400 font-bold",children:"Loading Products..."})]})}):d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 to-slate-100 p-6",children:[d.jsxs("div",{className:"mx-auto",children:[d.jsxs("div",{className:"mb-8",children:[d.jsxs("button",{onClick:()=>e("/clients"),className:"flex items-center gap-2 text-slate-500 hover:text-[#3399cc] transition-colors mb-4 text-sm font-medium",children:[d.jsx(KE,{size:16})," Back to Clients"]}),d.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:d.jsxs("div",{children:[d.jsxs("h1",{className:"text-3xl font-bold text-slate-900",children:[((k=r[0])==null?void 0:k.client_name)||"Client"," Products"]}),d.jsxs("p",{className:"text-slate-500",children:["Managing ",r.length," catalog items"]})]})}),d.jsx("div",{className:"mx-auto bg-white p-4 rounded-4xl shadow-sm border border-slate-100 mb-8 flex flex-col lg:flex-row gap-4 items-center",children:d.jsxs("div",{className:"relative flex-1 w-full",children:[d.jsx(Wl,{size:20,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-500 transition-colors"}),d.jsx("input",{type:"text",placeholder:"Search by name, manufacturer, or part number...",value:h,onChange:O=>{p(O.target.value),g(1)},className:"w-full pl-14 pr-4 py-3 border border-slate-200 rounded-2xl bg-slate-50/50 focus:ring-2 focus:ring-blue-500/20  outline-none transition-all"})]})})]}),d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"Item Name"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"Type"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"Manufacturer"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"MFR Part #"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"Price"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"UOM"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:E.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"px-6 py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 text-slate-500",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center border border-slate-100",children:d.jsx(g1,{className:"w-8 h-8 text-slate-300"})}),d.jsx("h3",{className:"text-base font-bold text-slate-500",children:"No products found"}),h&&d.jsx("p",{className:"text-xs text-slate-400",children:"Try adjusting your search or filters"})]})})}):E.map(O=>d.jsxs("tr",{className:"hover:bg-blue-50/50 cursor-pointer transition-colors",onClick:()=>a(O),children:[d.jsxs("td",{className:"px-6 py-4",children:[d.jsx("div",{className:"font-semibold text-slate-900",children:O.item_name}),d.jsx("div",{className:"text-xs text-slate-400 truncate max-w-50",children:O.item_description})]}),d.jsx("td",{className:"px-6 py-4",children:O.item_type==="B"?d.jsx("span",{className:"px-2 py-1 rounded text-[10px] font-bold uppercase bg-emerald-100 text-emerald-700",children:"Base"}):d.jsx("span",{className:"px-2 py-1 rounded text-[10px] font-bold uppercase bg-blue-100 text-blue-700",children:"Accessory"})}),d.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:O.manufacturer}),d.jsx("td",{className:"px-6 py-4 text-sm font-mono text-slate-500",children:O.manufacturer_part_number}),d.jsx("td",{className:"px-6 py-4 text-sm font-bold text-slate-900",children:N(O.commercial_list_price)}),d.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:O.uom||"-"})]},O.product_id))})]})}),_>1&&d.jsxs("div",{className:"flex items-center justify-between px-6 py-5 bg-white border-t border-slate-100",children:[d.jsx("div",{className:"hidden sm:block",children:d.jsxs("p",{className:"text-sm text-slate-500",children:["Showing"," ",d.jsx("span",{className:"font-semibold text-slate-900",children:S+1})," ","to"," ",d.jsx("span",{className:"font-semibold text-slate-900",children:Math.min(S+v,w.length)})," ","of"," ",d.jsx("span",{className:"font-semibold text-slate-900",children:w.length})," ","products"]})}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{onClick:()=>g(O=>Math.max(1,O-1)),disabled:x===1,className:"inline-flex items-center justify-center w-10 h-10 rounded-xl border border-slate-200 bg-white text-slate-600 transition-all hover:bg-slate-50 hover:border-slate-300 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white active:scale-95",children:d.jsx(Es,{size:18})}),d.jsx("div",{className:"flex items-center gap-1.5 mx-1",children:Array.from({length:_},(O,R)=>R+1).filter(O=>O===1||O===_||O>=x-1&&O<=x+1).map((O,R,V)=>d.jsxs(We.Fragment,{children:[R>0&&V[R-1]!==O-1&&d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}),d.jsx("button",{onClick:()=>g(O),className:`inline-flex items-center justify-center min-w-10 h-10 px-3 rounded-xl text-sm font-bold transition-all active:scale-95 ${O===x?"bg-[#3399cc] text-white shadow-blue-200 ":"bg-transparent text-slate-600 hover:bg-slate-100 hover:text-slate-900"}`,children:O})]},O))}),d.jsx("button",{onClick:()=>g(O=>Math.min(_,O+1)),disabled:x===_,className:"inline-flex items-center justify-center w-10 h-10 rounded-xl border border-slate-200 bg-white text-slate-600 transition-all hover:bg-slate-50 hover:border-slate-300 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white active:scale-95",children:d.jsx(Mr,{size:18})})]})]})]})]}),s&&d.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 transition-opacity",onClick:()=>a(null)}),d.jsxs("div",{className:"relative w-full max-w-lg bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[d.jsxs("div",{className:"p-6 border-b flex items-center justify-between bg-slate-50",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-bold text-slate-900",children:s.item_name}),d.jsx("p",{className:"text-sm text-slate-500",children:s.item_description})]}),d.jsx("button",{onClick:()=>a(null),className:"p-2 hover:bg-slate-200 rounded-full transition-colors",children:d.jsx(Zn,{size:20})})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[d.jsxs(Lm,{title:"Classification",children:[d.jsx(Ti,{label:"SIN",value:s.sin}),d.jsx(Ti,{label:"NSN",value:s.nsn}),d.jsx(Ti,{label:"UPC",value:s.upc}),d.jsx(Ti,{label:"UNSPSC",value:s.unspsc})]}),d.jsxs(Lm,{title:"Pricing & Shipping",children:[d.jsx(Ti,{label:"List Price",value:N(s.commercial_list_price)}),d.jsx(Ti,{label:"UOM",value:s.uom}),d.jsx(Ti,{label:"Qty Per Pack",value:s.quantity_per_pack}),d.jsx(Ti,{label:"COO",value:s.country_of_origin})]}),d.jsxs(Lm,{title:"Compliance",children:[d.jsx(Ti,{label:"Country of Origin",value:s.country_of_origin}),d.jsx(Ti,{label:"Recycled %",value:s.recycled_content_percent})]}),d.jsx(Lm,{title:"Documents & Links",children:d.jsxs("div",{className:"col-span-2 space-y-2",children:[s.product_url&&d.jsxs("a",{href:s.product_url,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 text-[#3399cc] hover:underline font-medium",children:[d.jsx(w_,{size:14})," View Product Website"]}),s.url_508&&d.jsxs("a",{rel:"noreferrer",className:"flex items-center gap-2 text-[#3399cc] hover:underline font-medium",children:[d.jsx(w_,{size:14})," 508 Compliance Document"]})]})})]})]})]})]})}function Lm({title:e,children:t}){return d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-4",children:e}),d.jsx("div",{className:"grid grid-cols-2 gap-4",children:t})]})}function Ti({label:e,value:t}){return d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-slate-500",children:e}),d.jsx("p",{className:"font-medium text-slate-900",children:t??"-"})]})}const sJ=({isOpen:e,onClose:t,onConfirm:r,client:n,action:s})=>{if(!e)return null;const a=s==="approve";return d.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4 h-full",children:d.jsx("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full overflow-hidden text-left",children:d.jsxs("div",{className:"p-6 sm:p-8",children:[d.jsxs("p",{className:"text-slate-500 mb-6 text-sm sm:text-base",children:["Are you sure you want to ",a?"approve":"reject"," ",d.jsx("span",{className:"font-bold text-slate-700",children:n==null?void 0:n.company_name}),"?"]}),d.jsxs("div",{className:"bg-slate-50 rounded-2xl p-4 mb-6 space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-slate-500",children:"Company:"}),d.jsx("span",{className:"text-sm font-semibold text-slate-700 truncate ml-2",children:n==null?void 0:n.company_name})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-slate-500",children:"Email:"}),d.jsx("span",{className:"text-sm font-semibold text-slate-700 truncate ml-2",children:n==null?void 0:n.company_email})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[d.jsx("button",{onClick:t,className:"flex-1 px-6 py-3 bg-white border border-slate-200 text-slate-700 rounded-xl font-bold text-sm hover:bg-slate-50 transition-all",children:"Cancel"}),d.jsx("button",{onClick:r,className:`flex-1 px-6 py-3 rounded-xl font-bold text-sm text-white transition-all shadow-sm ${a?"bg-emerald-500 hover:bg-emerald-600":"bg-rose-500 hover:bg-rose-600"}`,children:a?"Approve":"Reject"})]})]})})})},yD=({client:e,onView:t,onEdit:r,onApprove:n,onReject:s})=>{const[a,i]=ne.useState(!1),o=ne.useRef(null);ne.useEffect(()=>{const h=p=>{o.current&&!o.current.contains(p.target)&&i(!1)};return a&&document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[a]);const c=!["approved","rejected"].includes(e.status),f=e.status==="approved";return d.jsxs("div",{className:"relative",ref:o,children:[d.jsx("button",{onClick:h=>{h.stopPropagation(),i(!a)},className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:d.jsx(Ll,{className:"w-5 h-5 text-slate-600"})}),a&&d.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-slate-200 py-2 z-10",children:[d.jsxs("button",{onClick:h=>{h.stopPropagation(),t(),i(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-slate-700 hover:bg-slate-50 flex items-center gap-2 transition-colors",children:[d.jsx(Co,{className:"w-4 h-4"}),"View Details"]}),d.jsxs("button",{onClick:h=>{h.stopPropagation(),r(),i(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-slate-700 hover:bg-slate-50 flex items-center gap-2 transition-colors",children:[d.jsx(X0,{className:"w-4 h-4"}),"Edit Client"]}),d.jsx("div",{className:"border-t border-slate-100 my-2"}),c?d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:h=>{h.stopPropagation(),n(),i(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-emerald-600 hover:bg-emerald-50 flex items-center gap-2 transition-colors",children:[d.jsx(Kc,{className:"w-4 h-4"}),"Approve"]}),d.jsxs("button",{onClick:h=>{h.stopPropagation(),s(),i(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-rose-600 hover:bg-rose-50 flex items-center gap-2 transition-colors",children:[d.jsx(Zn,{className:"w-4 h-4"}),"Reject"]})]}):d.jsx("button",{onClick:h=>{h.stopPropagation(),f?s():n(),i(!1)},className:`w-full px-4 py-2 text-left text-sm font-medium flex items-center gap-2 transition-colors ${f?"text-rose-600 hover:bg-rose-50":"text-emerald-600 hover:bg-emerald-50"}`,children:f?d.jsxs(d.Fragment,{children:[d.jsx(Zn,{className:"w-4 h-4"}),"Reject"]}):d.jsxs(d.Fragment,{children:[d.jsx(Kc,{className:"w-4 h-4"}),"Approve"]})})]})]})},aJ=({client:e,onView:t,onEdit:r,onApprove:n,onReject:s,getStatusBadge:a})=>d.jsxs("div",{onClick:t,className:"bg-white rounded-2xl shadow-sm border border-slate-100 p-5 hover:shadow-md transition-all cursor-pointer",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center shrink-0",children:d.jsx(In,{className:"w-6 h-6 text-blue-500"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"font-bold text-slate-800 text-base truncate",children:e.company_name}),d.jsx("p",{className:"text-xs text-slate-400 truncate",children:e.company_email})]})]}),d.jsx("div",{onClick:i=>i.stopPropagation(),children:d.jsx(yD,{client:e,onView:t,onEdit:r,onApprove:n,onReject:s})})]}),d.jsxs("div",{className:"space-y-2.5 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(Y0,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{className:"truncate",children:e.contact_officer_name||"N/A"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(jf,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsxs("span",{className:"truncate",children:[e.company_city,", ",e.company_state]})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(cd,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{children:new Date(e.created_time).toLocaleDateString()})]})]}),d.jsx("div",{className:"flex items-center justify-between pt-3 border-t border-slate-100",children:a(e.status)})]}),iJ=()=>{const[e,t]=ne.useState([]),[r,n]=ne.useState(!0),[s,a]=ne.useState(""),[i,o]=ne.useState("pending"),[c,f]=ne.useState({isOpen:!1,client:null,action:"approve"}),[h,p]=ne.useState(null),[x,g]=ne.useState(!1),[v,y]=ne.useState(!1),[w,_]=ne.useState(null),[S,E]=ne.useState({}),[N,k]=ne.useState(1),[O,R]=ne.useState(!1),[V,I]=ne.useState(""),[Z,ce]=ne.useState(1),F=8,X=async()=>{try{n(!0);const M=await zt.get("/clients");t(Array.isArray(M.data)?M.data:[])}catch(M){P(M,"load clients")}finally{n(!1)}};ne.useEffect(()=>{X()},[]),ne.useEffect(()=>{ce(1)},[i,s]);const P=(M,A="operation")=>{var ye,pe,Ne,De,Fe;const j=(ye=M.response)==null?void 0:ye.status;let ue=((Ne=(pe=M.response)==null?void 0:pe.data)==null?void 0:Ne.detail)||((Fe=(De=M.response)==null?void 0:De.data)==null?void 0:Fe.message)||`Failed to ${A}. Please try again.`;j===409&&k(1),I(ue),wn.error(ue)},ie=M=>{const A={};return Object.entries(M).forEach(([j,H])=>{A[j]=typeof H=="string"?H.trim():H}),A},te=(M,A)=>{f({isOpen:!0,client:M,action:A})},Y=()=>{f({isOpen:!1,client:null,action:"approve"})},ve=async()=>{if(!c.client)return;const{client_id:M}=c.client,{action:A}=c;try{await zt.patch(`/clients/${M}/approve`,null,{params:{action:A}}),wn.success(`Client ${A==="approve"?"approved":"rejected"} successfully`),await X(),Y()}catch(j){P(j,`${A} client`)}},oe=M=>{const A=Rx(M);p(A),g(!0)},Ee=M=>{var A,j,H,ue,ye,pe,Ne,De,Fe,Ke,st;_({id:M.id,company_name:M.name,company_email:M.email,company_phone_no:M.phone,company_address:M.address.split(", ")[0]||"",company_city:M.address.split(", ")[1]||"",company_state:M.address.split(", ")[2]||"",company_zip:M.address.split(", ")[3]||"",contact_officer_name:((A=M.contact)==null?void 0:A.name)||"",contact_officer_email:((j=M.contact)==null?void 0:j.email)||"",contact_officer_phone_no:((H=M.contact)==null?void 0:H.phone)||"",contact_officer_address:((ye=(ue=M.contact)==null?void 0:ue.address)==null?void 0:ye.split(", ")[0])||"",contact_officer_city:((Ne=(pe=M.contact)==null?void 0:pe.address)==null?void 0:Ne.split(", ")[1])||"",contact_officer_state:((Fe=(De=M.contact)==null?void 0:De.address)==null?void 0:Fe.split(", ")[2])||"",contact_officer_zip:((st=(Ke=M.contact)==null?void 0:Ke.address)==null?void 0:st.split(", ")[3])||"",status:M.status,products:M.products}),y(!0),k(1),E({}),I("")},K=M=>{M.preventDefault(),w&&df(w,E)&&k(2)},D=async M=>{if(M.preventDefault(),!w)return;if(!df(w,E)){k(1);return}const j=S_(w);if(!j.isValid){E(H=>({...H,...j.errors})),k(2);return}R(!0);try{const H=ie(w);await zt.put(`/clients/${w.id}`,H),wn.success("Client updated successfully"),await X(),y(!1)}catch(H){P(H,"update client")}finally{R(!1)}},q=M=>{oe(M)},W=e.filter(M=>!["approved","rejected"].includes(M.status)),J=e.filter(M=>M.status==="approved"),re=e.filter(M=>M.status==="rejected"),L=(()=>{let M=[];return i==="pending"?M=W:i==="approved"?M=J:i==="rejected"?M=re:M=e,M.filter(A=>{var j,H;return((j=A.company_name)==null?void 0:j.toLowerCase().includes(s.toLowerCase()))||((H=A.contact_officer_name)==null?void 0:H.toLowerCase().includes(s.toLowerCase()))})})(),se=L.length,Q=(Z-1)*F,ee=L.slice(Q,Q+F),B=Math.ceil(se/F),be=M=>M==="rejected"?d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-rose-50 text-rose-600 border-rose-100",children:[d.jsx(Cf,{className:"w-3 h-3"})," Rejected"]}):M==="approved"?d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-emerald-50 text-emerald-600 border-emerald-100",children:[d.jsx(us,{className:"w-3 h-3"})," Approved"]}):d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-orange-50 text-orange-600 border-orange-100",children:[d.jsx(Bi,{className:"w-3 h-3"})," Pending"]}),z=()=>{switch(i){case"all":return"All Clients";case"pending":return"Pending Client Requests";case"approved":return"Approved Clients";case"rejected":return"Rejected Clients";default:return"Clients"}},he=()=>{switch(i){case"all":return"Complete list of all client profiles";case"pending":return"Client Profiles awaiting approval";case"approved":return"Approved Client Profiles";case"rejected":return"Client Profiles that are registration";default:return""}};return r?d.jsx("div",{className:"min-h-screen flex items-center justify-center",children:d.jsx(ar,{className:"w-10 h-10 animate-spin text-[#24578f]"})}):d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-4 sm:p-6 lg:p-10 space-y-6 sm:space-y-8 lg:space-y-10",children:[d.jsx(sJ,{isOpen:c.isOpen,onClose:Y,onConfirm:ve,client:c.client,action:c.action}),d.jsx(gD,{client:h,onClose:()=>{g(!1),p(null)},onEdit:Ee}),w&&d.jsx(N_,{isOpen:v,title:"Edit Client",subtitle:"Update client information",formData:w,errors:S,backendError:V,currentStep:N,isSubmitting:O,onClose:()=>y(!1),onSubmit:D,onNext:K,onBack:()=>k(1),onChange:(M,A)=>{_({...w,[M]:A}),S[M]&&E({...S,[M]:""})},onClearError:M=>E({...S,[M]:""}),onClearBackendError:()=>I(""),submitButtonText:"Update Client"}),d.jsxs("div",{className:"mx-auto",children:[d.jsx("h1",{className:"text-3xl  font-extrabold tracking-tight text-slate-800",children:"Client Management"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1 ",children:"Manage client registrations, approvals, and accounts."})]}),d.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[{label:"Total Clients",count:e.length,icon:In,color:"blue"},{label:"Pending Requests",count:W.length,icon:Bi,color:"orange"},{label:"Approved Clients",count:J.length,icon:us,color:"emerald"},{label:"Rejected",count:re.length,icon:Cf,color:"rose"}].map(M=>d.jsxs("div",{className:"bg-white p-4 sm:p-6 lg:p-8 rounded-2xl sm:rounded-3xl shadow-sm flex items-center gap-3 sm:gap-5 border border-slate-100",children:[d.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-${M.color}-50 rounded-full flex items-center justify-center shrink-0`,children:d.jsx(M.icon,{className:`w-5 h-5 sm:w-6 sm:h-6 lg:w-7 lg:h-7 text-${M.color}-600`})}),d.jsxs("div",{className:"min-w-0 flex-1",children:[d.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold uppercase tracking-widest text-slate-400 truncate",children:M.label}),d.jsx("p",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold",children:M.count})]})]},M.label))}),d.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl shadow-sm border border-slate-100 ",children:[d.jsx("div",{className:"border-b border-slate-100 px-4 sm:px-6 lg:px-8 pt-4 sm:pt-6 ",children:d.jsx("div",{className:"flex gap-1 sm:gap-2 min-w-max",children:[{id:"all",label:"All Clients",count:e.length,color:"blue"},{id:"pending",label:"Pending",count:W.length,color:"orange"},{id:"approved",label:"Approved",count:J.length,color:"emerald"},{id:"rejected",label:"Rejected",count:re.length,color:"rose"}].map(M=>d.jsxs("button",{onClick:()=>o(M.id),className:`px-4 sm:px-6 py-2 sm:py-3 rounded-t-xl font-bold text-xs sm:text-sm transition-all whitespace-nowrap ${i===M.id?`bg-${M.color}-50 text-${M.color}-600 border-b-2 border-${M.color}-600`:"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:[M.label," (",M.count,")"]},M.id))})}),d.jsxs("div",{className:"p-8 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-bold",children:z()}),d.jsx("p",{className:"text-slate-500 text-sm",children:he()})]}),d.jsxs("div",{className:"relative w-full md:w-80",children:[d.jsx(Wl,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsx("input",{type:"text",placeholder:"Search by company or contact...",className:"w-full pl-11 pr-4 py-3 bg-white border border-slate-200 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/10 focus:border-blue-400 transition-all",value:s,onChange:M=>a(M.target.value)})]})]}),d.jsxs("div",{className:"lg:hidden px-4 sm:px-6 pb-4 sm:pb-6 space-y-3 sm:space-y-4",children:[ee.map(M=>d.jsx(aJ,{client:M,onView:()=>oe(M),onEdit:()=>Ee(Rx(M)),onApprove:()=>te(M,"approve"),onReject:()=>te(M,"reject"),getStatusBadge:be},M.client_id)),ee.length===0&&d.jsx("div",{className:"py-16 text-center text-slate-400 text-sm",children:"No clients found."})]}),d.jsxs("div",{className:"hidden lg:block  px-6 pb-6 ",children:[d.jsxs("table",{className:"w-full border-collapse bg-white rounded-2xl shadow-sm",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Company"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Contact Officer"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Location"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Status"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Request Date"}),d.jsx("th",{className:"text-right px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:ee.map(M=>d.jsxs("tr",{onClick:()=>q(M),className:"group hover:bg-slate-50/30 transition-colors cursor-pointer",children:[d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:d.jsx(In,{className:"w-5 h-5 text-blue-500"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-sm text-slate-800",children:M.company_name}),d.jsx("p",{className:"text-xs text-slate-400",children:M.company_email})]})]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsx("p",{className:"text-sm font-semibold text-slate-700",children:M.contact_officer_name||"N/A"})}),d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"text-sm text-slate-600 flex items-center gap-1",children:[d.jsx(jf,{className:"w-3 h-3 text-slate-400"}),M.company_city,", ",M.company_state]})}),d.jsx("td",{className:"px-4 py-5",children:be(M.status)}),d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400 font-medium",children:[d.jsx(cd,{className:"w-4 h-4"}),new Date(M.created_time).toLocaleDateString()]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsx("div",{className:"flex items-center justify-end",children:d.jsx(yD,{client:M,onView:()=>oe(M),onEdit:()=>Ee(Rx(M)),onApprove:()=>te(M,"approve"),onReject:()=>te(M,"reject")})})})]},M.client_id))})]}),ee.length===0&&d.jsx("div",{className:"py-20 text-center text-slate-400",children:"No clients found."})]}),se>F&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Q+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(Q+F,se)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:se})," ","users"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:Z===1,onClick:()=>ce(Z-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Es,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:(()=>{const M=[];for(let j=1;j<=B;j++)j===1||j===B||j>=Z-1&&j<=Z+1?M.push(j):M[M.length-1]!=="..."&&M.push("...");return M.map((j,H)=>d.jsx(We.Fragment,{children:j==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>ce(Number(j)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                            ${Z===j?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:j})},H))})()}),d.jsx("button",{disabled:Z===B,onClick:()=>ce(Z+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})]})},l0={admin:"Administrator",user:"Consultant"},oJ=({isOpen:e,onClose:t,onConfirm:r,user:n,action:s,isSubmitting:a})=>{if(!e)return null;const i=s==="approve";return d.jsx("div",{className:"fixed inset-0 bg-slate-900/40 flex items-center justify-center z-50 p-4 h-full",children:d.jsx("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full overflow-hidden",children:d.jsxs("div",{className:"p-8",children:[d.jsxs("p",{className:"text-slate-500 mb-6",children:["Are you sure you want to ",i?"approve":"reject"," ",d.jsx("span",{className:"font-bold text-slate-700",children:n==null?void 0:n.name}),"?"]}),d.jsxs("div",{className:"bg-slate-50 rounded-2xl p-4 mb-6 space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-slate-500",children:"Email:"}),d.jsx("span",{className:"text-sm font-semibold text-slate-700",children:n==null?void 0:n.email})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-slate-500",children:"Role:"}),d.jsx("span",{className:"text-sm font-semibold text-slate-700",children:l0[n==null?void 0:n.role]||"User"})]})]}),!i&&d.jsxs("div",{className:"flex items-start gap-3 bg-rose-50 border border-rose-100 rounded-2xl p-4 mb-6",children:[d.jsx(v1,{className:"w-5 h-5 text-rose-500 shrink-0 mt-0.5"}),d.jsx("p",{className:"text-xs text-rose-700",children:"This action will reject the user's account. They won't be able to access the system."})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:t,className:"flex-1 px-6 py-3 bg-white border border-slate-200 text-slate-700 rounded-xl font-bold text-sm hover:bg-slate-50 transition-all",children:"Cancel"}),d.jsxs("button",{disabled:a,onClick:r,className:`flex-1 px-6 py-3 rounded-xl font-bold text-sm text-white transition-all shadow-sm flex items-center justify-center gap-2 ${i?"bg-emerald-500 hover:bg-emerald-600":"bg-rose-500 hover:bg-rose-600"} disabled:opacity-70`,children:[a&&d.jsx(ar,{className:"w-4 h-4 animate-spin"}),i?"Approve":"Reject"]})]})]})})})},lJ=({isOpen:e,onClose:t,onConfirm:r,user:n,isSubmitting:s})=>{if(!e)return null;const a=l0[n==null?void 0:n.role]||"User",i=(n==null?void 0:n.role)==="admin"?"Consultant":"Administrator";return d.jsx("div",{className:"fixed inset-0 bg-slate-900/40 flex items-center justify-center z-50 p-4 h-full",children:d.jsx("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full overflow-hidden",children:d.jsxs("div",{className:"p-8",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Change User Role"}),d.jsxs("p",{className:"text-slate-500 mb-6",children:["Are you sure you want to change the role of"," ",d.jsx("span",{className:"font-bold text-slate-700",children:n==null?void 0:n.name}),"?"]}),d.jsxs("div",{className:"bg-slate-50 rounded-2xl p-4 mb-6 space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-slate-500",children:"Current Role:"}),d.jsx("span",{className:"text-sm font-semibold text-slate-700",children:a})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-slate-500",children:"New Role:"}),d.jsx("span",{className:"text-sm font-semibold text-[#3399cc]",children:i})]})]}),d.jsxs("div",{className:"flex items-start gap-3 bg-yellow-50 border border-yellow-100 rounded-2xl p-4 mb-6",children:[d.jsx(v1,{className:"w-5 h-5 text-yellow-600 shrink-0 mt-0.5"}),d.jsx("p",{className:"text-xs text-yellow-700",children:"This will change the user's permissions and access level in the system."})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:t,disabled:s,className:"flex-1 px-6 py-3 bg-white border border-slate-200 text-slate-700 rounded-xl font-bold text-sm hover:bg-slate-50 transition-all disabled:opacity-70",children:"Cancel"}),d.jsxs("button",{disabled:s,onClick:r,className:"flex-1 px-6 py-3 rounded-xl font-bold text-sm text-white transition-all shadow-sm flex items-center justify-center gap-2 bg-[#3399cc] hover:bg-[#2980b9] disabled:opacity-70",children:[s&&d.jsx(ar,{className:"w-4 h-4 animate-spin"}),"Change Role"]})]})]})})})},vD=({user:e,onApprove:t,onReject:r,onChangeRole:n})=>{const[s,a]=ne.useState(!1),i=ne.useRef(null);ne.useEffect(()=>{const f=h=>{i.current&&!i.current.contains(h.target)&&a(!1)};return s&&document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[s]);const o=!e.is_active&&!e.is_deleted,c=e.is_active&&!e.is_deleted;return d.jsxs("div",{className:"relative",ref:i,children:[d.jsx("button",{onClick:f=>{f.stopPropagation(),a(!s)},className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:d.jsx(Ll,{className:"w-5 h-5 text-slate-600"})}),s&&d.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-slate-200 py-2 z-10",children:[o&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:f=>{f.stopPropagation(),t(),a(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-emerald-600 hover:bg-emerald-50 flex items-center gap-2 transition-colors",children:[d.jsx(Kx,{className:"w-4 h-4"}),"Approve"]}),d.jsxs("button",{onClick:f=>{f.stopPropagation(),r(),a(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-rose-600 hover:bg-rose-50 flex items-center gap-2 transition-colors",children:[d.jsx(x3,{className:"w-4 h-4"}),"Reject"]})]}),c&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:f=>{f.stopPropagation(),n(),a(!1)},className:"w-full px-4 py-2 text-left text-sm  text-slate-700 font-medium  hover:bg-slate-50 flex items-center gap-2 transition-colors",children:[d.jsx(WX,{className:"w-4 h-4 text-[#3399cc]"}),"Change Role"]}),d.jsx("div",{className:"border-t border-slate-100 my-2"}),d.jsxs("button",{onClick:f=>{f.stopPropagation(),r(),a(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-rose-600 hover:bg-rose-50 flex items-center gap-2 transition-colors",children:[d.jsx(x3,{className:"w-4 h-4"}),"Reject"]})]}),e.is_deleted&&d.jsxs("button",{onClick:f=>{f.stopPropagation(),t(),a(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-emerald-600 hover:bg-emerald-50 flex items-center gap-2 transition-colors",children:[d.jsx(Kx,{className:"w-4 h-4"}),"Approve"]})]})]})},cJ=({user:e,onApprove:t,onReject:r,onChangeRole:n,getStatusBadge:s,getRoleStyle:a})=>d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 p-5 hover:shadow-md transition-all",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center text-blue-500 font-bold text-sm uppercase shrink-0",children:e.name.charAt(0)}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"font-bold text-slate-800 text-base truncate",children:e.name}),d.jsx("p",{className:"text-xs text-slate-400 truncate",children:e.email})]})]}),d.jsx("div",{onClick:i=>i.stopPropagation(),children:d.jsx(vD,{user:e,onApprove:t,onReject:r,onChangeRole:n})})]}),d.jsxs("div",{className:"space-y-2.5 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(E_,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{className:"truncate",children:e.phone_no||"No Phone"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[d.jsx(YE,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border capitalize ${a(e.role)}`,children:l0[e.role]||"User"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(cd,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{children:new Date(e.created_time).toLocaleDateString()})]})]}),d.jsx("div",{className:"flex items-center justify-between pt-3 border-t border-slate-100",children:s(e)})]});function uJ(){const[e,t]=ne.useState([]),[r,n]=ne.useState(!0),[s,a]=ne.useState(!1),[i,o]=ne.useState(""),[c,f]=ne.useState("pending"),[h,p]=ne.useState({isOpen:!1,user:null,action:"approve"}),[x,g]=ne.useState({isOpen:!1,user:null}),[v,y]=ne.useState(1),w=8,_=async()=>{try{n(!0);const q=(await zt.get("/users/all")).data;t(Array.isArray(q)?q:[q])}catch(D){console.error("Error fetching users:",D)}finally{n(!1)}};ne.useEffect(()=>{_()},[]),ne.useEffect(()=>{y(1)},[c,i]);const S=e.filter(D=>!D.is_active&&!D.is_deleted),E=e.filter(D=>D.is_active&&!D.is_deleted),N=e.filter(D=>D.is_deleted),k=(D,q)=>{p({isOpen:!0,user:D,action:q})},O=()=>{p({isOpen:!1,user:null,action:"approve"})},R=D=>{g({isOpen:!0,user:D})},V=()=>{g({isOpen:!1,user:null})},I=async(D,q)=>{try{a(!0),await zt.patch(`/users/${D}/approve`,null,{params:{action:q}}),t(W=>W.map(J=>J.user_id===D?{...J,is_active:q==="approve",is_deleted:q==="reject"}:J)),wn.success(`Client ${q==="approve"?"approved":"rejected"} successfully`),O()}catch(W){console.error(W),wn.error(`Failed to ${q} user`)}finally{a(!1)}},Z=()=>{h.user&&I(h.user.user_id,h.action)},ce=async()=>{var D,q;if(x.user)try{a(!0),await zt.put(`/users/change_role/${x.user.user_id}`),await _(),wn.success("User role changed successfully"),V()}catch(W){console.error(W);const J=((q=(D=W.response)==null?void 0:D.data)==null?void 0:q.detail)||"Failed to change user role";wn.error(J)}finally{a(!1)}},X=(()=>{let D=[];switch(c){case"all":D=e;break;case"pending":D=S;break;case"approved":D=E;break;case"rejected":D=N;break;default:D=e}return D.filter(q=>q.name.toLowerCase().includes(i.toLowerCase())||q.email.toLowerCase().includes(i.toLowerCase()))})(),P=X.length,ie=(v-1)*w,te=X.slice(ie,ie+w),Y=Math.ceil(P/w),ve=D=>{switch(l0[D]||"default"){case"Administrator":return"bg-purple-50 text-purple-600 border-purple-100";case"Consultant":return"bg-orange-50 text-orange-600 border-orange-100";default:return"bg-slate-50 text-slate-600 border-slate-100"}},oe=D=>D.is_deleted?d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-rose-50 text-rose-600 border-rose-100",children:[d.jsx(Cf,{className:"w-3 h-3"}),"Rejected"]}):D.is_active?d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-emerald-50 text-emerald-600 border-emerald-100",children:[d.jsx(us,{className:"w-3 h-3"}),"Approved"]}):d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-orange-50 text-orange-600 border-orange-100",children:[d.jsx(Bi,{className:"w-3 h-3"}),"Pending"]}),Ee=()=>{switch(c){case"all":return"All Users";case"pending":return"Pending User Requests";case"approved":return"Approved Users";case"rejected":return"Rejected Users";default:return"Users"}},K=()=>{switch(c){case"all":return"Complete list of all users in the system";case"pending":return"Users awaiting account activation";case"approved":return"Users with active accounts";case"rejected":return"Users whose accounts were rejected";default:return""}};return r?d.jsx("div",{className:"min-h-screen flex items-center justify-center",children:d.jsx(ar,{className:"w-8 h-8 animate-spin text-[#24578f]"})}):d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-4 sm:p-6 lg:p-10 space-y-6 sm:space-y-8 lg:space-y-10",children:[d.jsx(oJ,{isOpen:h.isOpen,onClose:O,onConfirm:Z,user:h.user,action:h.action,isSubmitting:s}),d.jsx(lJ,{isOpen:x.isOpen,onClose:V,onConfirm:ce,user:x.user,isSubmitting:s}),d.jsxs("div",{className:"mx-auto",children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"User Management"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Manage user accounts, approvals, and permissions."})]}),d.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[{label:"Total Users",count:e.length,icon:vY,color:"blue"},{label:"Pending Approvals",count:S.length,icon:Bi,color:"orange"},{label:"Approved",count:E.length,icon:us,color:"emerald"},{label:"Rejected",count:N.length,icon:Cf,color:"rose"}].map(D=>d.jsxs("div",{className:"bg-white p-4 sm:p-6 lg:p-8 rounded-2xl sm:rounded-3xl shadow-sm flex items-center gap-3 sm:gap-5 border border-slate-100",children:[d.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-${D.color}-50 rounded-full flex items-center justify-center shrink-0`,children:d.jsx(D.icon,{className:`w-5 h-5 sm:w-6 sm:h-6 lg:w-7 lg:h-7 text-${D.color}-600`})}),d.jsxs("div",{className:"min-w-0 flex-1",children:[d.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold uppercase tracking-widest text-slate-400 truncate",children:D.label}),d.jsx("p",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900",children:D.count})]})]},D.label))}),d.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl shadow-sm border border-slate-100 ",children:[d.jsx("div",{className:"border-b border-slate-100 px-4 sm:px-6 lg:px-8 pt-4 sm:pt-6 ",children:d.jsx("div",{className:"flex gap-1 sm:gap-2 min-w-max",children:[{id:"all",label:"All Users",count:e.length,color:"blue"},{id:"pending",label:"Pending",count:S.length,color:"orange"},{id:"approved",label:"Approved",count:E.length,color:"emerald"},{id:"rejected",label:"Rejected",count:N.length,color:"rose"}].map(D=>d.jsxs("button",{onClick:()=>f(D.id),className:`px-4 sm:px-6 py-2 sm:py-3 rounded-t-xl font-bold text-xs sm:text-sm transition-all whitespace-nowrap ${c===D.id?`bg-${D.color}-50 text-${D.color}-600 border-b-2 border-${D.color}-600`:"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:[D.label," (",D.count,")"]},D.id))})}),d.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-bold text-slate-900",children:Ee()}),d.jsx("p",{className:"text-slate-500 text-sm",children:K()})]}),d.jsxs("div",{className:"relative w-full md:w-80",children:[d.jsx(Wl,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsx("input",{type:"text",placeholder:"Search users...",className:"w-full pl-11 pr-4 py-3 bg-white border border-slate-200 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/10 focus:border-blue-400 transition-all",value:i,onChange:D=>o(D.target.value)})]})]}),d.jsxs("div",{className:"lg:hidden px-4 sm:px-6 pb-4 sm:pb-6 space-y-3 sm:space-y-4",children:[te.map(D=>d.jsx(cJ,{user:D,onApprove:()=>k(D,"approve"),onReject:()=>k(D,"reject"),onChangeRole:()=>R(D),getStatusBadge:oe,getRoleStyle:ve},D.user_id)),te.length===0&&d.jsx("div",{className:"py-16 text-center text-slate-400 text-sm",children:"No users found."})]}),d.jsxs("div",{className:"hidden lg:block  px-6 pb-6",children:[d.jsxs("table",{className:"w-full border-collapse bg-white rounded-2xl shadow-sm",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"User"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Role"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Phone"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Request Date"}),d.jsx("th",{className:"text-right px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:te.map(D=>d.jsxs("tr",{className:"group hover:bg-slate-50/30 transition-colors",children:[d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center text-blue-500 font-bold text-xs uppercase",children:D.name.charAt(0)}),d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-sm text-slate-800",children:D.name}),d.jsx("p",{className:"text-xs text-slate-400 flex items-center gap-1",children:D.email})]})]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border capitalize ${ve(D.role)}`,children:[d.jsx(YE,{className:"w-3 h-3"}),l0[D.role]||"User"]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsx("p",{className:"text-sm font-semibold text-slate-600",children:D.phone_no||"No Phone"})}),d.jsx("td",{className:"px-4 py-5",children:oe(D)}),d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400 font-medium",children:[d.jsx(cd,{className:"w-4 h-4"}),new Date(D.created_time).toLocaleDateString("en-US")]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsx("div",{className:"flex items-center justify-end",children:d.jsx(vD,{user:D,onApprove:()=>k(D,"approve"),onReject:()=>k(D,"reject"),onChangeRole:()=>R(D)})})})]},D.user_id))})]}),te.length===0&&d.jsx("div",{className:"py-20 text-center text-slate-400",children:"No users found."})]}),P>w&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:ie+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(ie+w,P)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:P})," ","users"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:v===1,onClick:()=>y(v-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Es,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:(()=>{const D=[];for(let W=1;W<=Y;W++)W===1||W===Y||W>=v-1&&W<=v+1?D.push(W):D[D.length-1]!=="..."&&D.push("...");return D.map((W,J)=>d.jsx(We.Fragment,{children:W==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>y(Number(W)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                            ${v===W?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:W})},J))})()}),d.jsx("button",{disabled:v===Y,onClick:()=>y(v+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})]})}const Xx={async getAllContracts(){return(await zt.get("/contracts")).data},async getContractByClientId(e){return(await zt.get(`/contracts/${e}`)).data},async createContract(e,t){return(await zt.post(`/contracts/${e}`,t)).data},async updateContract(e,t){return(await zt.put(`/contracts/${e}`,t)).data},async deleteContract(e){await zt.delete(`/contracts/${e}`)}};function fJ({contracts:e,loading:t,onView:r,onEdit:n,onDelete:s,currentPage:a,totalContracts:i,itemsPerPage:o,onPageChange:c}){const[f,h]=ne.useState(null),p=Math.ceil(i/o),x=(a-1)*o,g=()=>{const y=[];for(let _=1;_<=p;_++)_===1||_===p||_>=a-1&&_<=a+1?y.push(_):y[y.length-1]!=="..."&&y.push("...");return y},v=()=>d.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-center px-4",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center mb-4 border border-slate-100",children:d.jsx(g1,{className:"w-8 h-8 text-slate-300"})}),d.jsx("h3",{className:"text-base font-bold text-slate-500",children:"No contracts found"})]});return d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 ",children:[d.jsx("div",{className:"hidden md:block",children:d.jsxs("table",{className:"w-full border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Contract"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Client"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Officer"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Location"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Last Modified"}),d.jsx("th",{className:"w-16 px-6 py-4"})]})}),d.jsx("tbody",{className:"divide-slate-100 divide-y",children:t?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading contracts..."})]})})}):e.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,children:d.jsx(v,{})})}):e.map(y=>d.jsxs("tr",{onClick:()=>r(y),className:"group hover:bg-blue-50/30 cursor-pointer transition-all duration-200",children:[d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("span",{className:"font-bold text-slate-800 text-sm group-hover:text-[#38A1DB] transition-colors",children:y.contract_number})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-10 h-10 shrink-0 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] flex items-center justify-center text-white text-xs font-bold shadow-sm",children:y.client.slice(0,2).toLocaleUpperCase()}),d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-bold text-slate-800 text-sm transition-colors",children:y.client}),d.jsxs("span",{className:"text-[11px] text-slate-400 font-medium",children:["ID: #",y.client_id]})]})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm text-slate-600 font-medium",children:y.contract_officer_name||d.jsx("span",{className:"text-slate-300",children:""})})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[d.jsx(jf,{className:"w-3.5 h-3.5 text-slate-400"}),d.jsx("span",{className:"text-sm truncate max-w-37.5",children:y.contract_officer_city?`${y.contract_officer_city}, ${y.contract_officer_state}`:"Not set"})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[d.jsx(cd,{className:"w-3.5 h-3.5 text-slate-400"}),d.jsx("span",{className:"text-sm",children:new Date(y.updated_time).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})}),d.jsxs("td",{className:"px-6 py-4 text-right relative",children:[d.jsx("button",{onClick:w=>{w.stopPropagation(),h(f===y.client_id?null:y.client_id)},className:"p-2 hover:bg-slate-200 rounded-lg transition-colors",children:d.jsx(Ll,{className:"w-5 h-5 text-slate-400"})}),f===y.client_id&&d.jsx(S3,{onView:()=>r(y),onEdit:()=>n(y),onDelete:()=>s(y.client_id),onClose:()=>h(null)})]})]},y.client_profile_id))})]})}),d.jsx("div",{className:"md:hidden divide-y divide-slate-100",children:t?d.jsx("div",{className:"py-20 text-center",children:d.jsx(ar,{className:"w-8 h-8 animate-spin mx-auto text-[#24578f]"})}):e.length===0?d.jsx(v,{}):e.map(y=>d.jsxs("div",{onClick:()=>r(y),className:"p-5 hover:bg-blue-50/50 transition active:bg-blue-100",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 rounded-2xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] flex items-center justify-center text-white font-bold text-lg shadow-blue-100 shadow-lg",children:y.contract_number.slice(0,2)}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-900 text-sm",children:y.contract_number}),d.jsx("p",{className:"text-xs text-slate-500 font-medium",children:y.client})]})]}),d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:w=>{w.stopPropagation(),h(f===y.client_id?null:y.client_id)},className:"p-2 border border-slate-200 rounded-xl bg-white shadow-sm",children:d.jsx(Ll,{className:"w-5 h-5 text-slate-500"})}),f===y.client_id&&d.jsx(S3,{onView:()=>r(y),onEdit:()=>n(y),onDelete:()=>s(y.client_id),onClose:()=>h(null)})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-slate-50 rounded-xl p-4 border border-slate-100",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Officer"}),d.jsx("p",{className:"text-xs font-semibold text-slate-800 truncate",children:y.contract_officer_name||""})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Modified"}),d.jsx("p",{className:"text-xs font-semibold text-slate-800",children:new Date(y.updated_time).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Location"}),d.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[d.jsx(jf,{size:12,className:"text-slate-400"}),d.jsx("p",{className:"text-xs font-semibold text-slate-800",children:y.contract_officer_city?`${y.contract_officer_city}, ${y.contract_officer_state}`:"Not set"})]})]})]})]},y.client_profile_id))}),!t&&i>o&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:x+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(x+o,i)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:i})," ","contracts"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:a===1,onClick:()=>c(a-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Es,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:g().map((y,w)=>d.jsx(We.Fragment,{children:y==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>c(Number(y)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                        ${a===y?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:y})},w))}),d.jsx("button",{disabled:a===p,onClick:()=>c(a+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})}const S3=({onView:e,onEdit:t,onDelete:r,onClose:n})=>d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 z-40",onClick:s=>{s.stopPropagation(),n()}}),d.jsxs("div",{className:"absolute right-12 top-10 z-50 w-52 bg-white border border-slate-100 rounded-xl shadow-xl py-1.5 overflow-hidden animate-in fade-in zoom-in duration-100",onClick:s=>s.stopPropagation(),children:[d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{e(),n()},children:[d.jsx(Co,{className:"w-4 h-4 text-slate-400"})," View Details"]}),d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{t(),n()},children:[d.jsx(X0,{className:"w-4 h-4 text-slate-400"})," Edit Contract"]}),d.jsx("div",{className:"h-px bg-slate-100 my-1"}),d.jsxs("button",{className:"text-red-500 w-full px-4 py-3 text-left text-sm font-bold hover:bg-slate-50 flex items-center gap-3",onClick:()=>{r(),n()},children:[d.jsx(dD,{className:"w-4 h-4"})," Delete Contract"]})]})]});function dJ({contract:e,onClose:t,onEdit:r}){if(!e)return null;const n=({icon:s,value:a})=>a?d.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[d.jsx(s,{className:"w-4 h-4 text-slate-400"}),d.jsx("span",{className:"text-sm",children:a})]}):null;return d.jsxs("div",{className:"fixed inset-0 bg-slate-900/40  z-50 flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0",onClick:t}),d.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"sticky top-0 bg-linear-to-br px-8 py-6 rounded-t-3xl z-10",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-5",children:[d.jsx("div",{className:"relative",children:d.jsx("div",{className:"w-18 h-18 rounded-2xl bg-[#38A1DB]/20 backdrop-blur flex items-center justify-center shadow-inner text-[#38A1DB]",children:d.jsx(La,{className:"w-7 h-7"})})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-blue-400 text-sm font-medium uppercase tracking-widest mb-1",children:"Contract Details"}),d.jsx("h2",{className:"text-2xl font-bold text-slate-700 tracking-tight",children:e.contract_number}),d.jsx("p",{className:"text-sm md:text-base text-blue-100 font-medium mt-1",children:d.jsx("span",{className:"font-semibold text-slate-500",children:e.client||""})})]})]}),d.jsx("button",{onClick:t,className:"p-3 rounded-full hover:bg-white/20 transition-colors text-slate-700",children:d.jsx(Zn,{className:"w-6 h-6 text-slate-700"})})]})}),d.jsxs("div",{className:"p-8 grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-linear-to-br from-slate-50 to-white p-6 rounded-2xl border border-slate-200",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(Y0,{className:"w-6 h-6 text-[#38A1DB]"}),d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Contract Officer"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Officer Name"}),d.jsx("p",{className:"text-slate-800 font-semibold mt-1",children:e.contract_officer_name||""})]}),d.jsx(n,{icon:jf,value:`${e.contract_officer_address||""}, ${e.contract_officer_city||""}, ${e.contract_officer_state||""} ${e.contract_officer_zip||""}`.trim().replace(/^,\s*/,"").replace(/,\s*,/g,",")})]})]}),d.jsxs("div",{className:"bg-linear-to-br from-blue-50 to-white p-6 rounded-2xl border border-blue-200",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(uD,{className:"w-6 h-6 text-[#38A1DB]"}),d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Terms & Logistics"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center border-b border-blue-100 pb-2",children:[d.jsx("span",{className:"text-sm text-slate-500 font-medium uppercase tracking-tight",children:"FOB Term"}),d.jsx("span",{className:"font-bold text-slate-800",children:e.fob_term})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Normal Deliv."}),d.jsxs("p",{className:"text-sm font-bold text-slate-700",children:[e.normal_delivery_time," Days"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Expedited"}),d.jsxs("p",{className:"text-sm font-bold text-slate-700",children:[e.expedited_delivery_time," Days"]})]})]}),d.jsxs("div",{className:"pt-2",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Energy Star Compliance"}),d.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[d.jsx(fD,{className:`w-4 h-4 ${e.energy_star_compliance==="Yes"?"text-emerald-500":"text-slate-300"}`}),d.jsx("span",{className:"text-sm font-bold text-slate-700",children:e.energy_star_compliance})]})]})]})]}),d.jsxs("div",{className:"md:col-span-2 bg-slate-50 p-6 rounded-2xl border border-slate-200",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d.jsx(xX,{className:"w-6 h-6 text-slate-400"}),d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Additional Terms"})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Additional Concessions"}),d.jsx("p",{className:"text-slate-700 mt-2 text-sm leading-relaxed",children:e.additional_concessions||"None specified"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Q/V Discount Details"}),d.jsx("p",{className:"text-slate-700 mt-2 text-sm leading-relaxed",children:e.q_v_discount||"None specified"})]})]})]})]}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 rounded-b-3xl flex justify-between border-t border-slate-100 z-10",children:[d.jsx("button",{onClick:t,className:"px-6 py-3 rounded-2xl font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-all active:scale-95",children:"Close"}),d.jsxs("button",{onClick:()=>{r(e),t()},className:`flex items-center gap-2 px-6 py-3 rounded-2xl
             bg-linear-to-br from-[#38A1DB] to-[#2D8BBF]
             text-white font-bold shadow-lg hover:shadow-xl
             transition-all active:scale-95`,children:[d.jsx(X0,{className:"w-4 h-4 stroke-[2.5px]"}),"Edit Contract"]})]})]})]})}function hJ(e,t,r=!0){ne.useEffect(()=>{if(!r)return;const n=s=>{e.current&&!e.current.contains(s.target)&&t(s)};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[e,t,r])}function pJ({contract:e,onChange:t,clients:r,clientSearch:n,setClientSearch:s,showClientDropdown:a,setShowClientDropdown:i,errors:o}){const c=ne.useRef(null),f=!!e.client_id;hJ(c,()=>i(!1),a);const h=r.filter(p=>p.client_id.toString().includes(n)||p.company_name.toLowerCase().includes(n.toLowerCase()));return d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Contract Number ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",className:`w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB]"
          } outline-none`,value:e.contract_number,onChange:p=>t({...e,contract_number:p.target.value})}),o.contract_number&&d.jsx("div",{className:"mt-1 text-xs text-red-600",children:d.jsx("span",{children:o.contract_number})})]}),d.jsxs("div",{className:"md:col-span-2 relative",ref:c,children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Client ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",placeholder:"Search by Client ID or Company Name",className:`w-full mt-2 px-4 py-3 pr-10 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none ${f?"bg-slate-50 cursor-not-allowed":""}`,value:n,readOnly:f,onFocus:()=>{f||i(!0)},onChange:p=>{f||(s(p.target.value),i(!0),t({...e,client_id:void 0}))}}),f&&d.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/3 text-slate-400 hover:text-red-500",onClick:()=>{t({...e,client_id:void 0}),s(""),i(!1)},children:d.jsx(Zn,{className:"w-5 h-5"})})]}),o.client_id&&d.jsx("div",{className:"mt-1 text-xs text-red-600",children:d.jsx("span",{children:o.client_id})}),a&&!f&&d.jsx("div",{className:"absolute z-50 mt-2 w-full max-h-60 overflow-y-auto bg-white border border-slate-200 rounded-xl shadow-lg",children:h.length===0?d.jsx("div",{className:"px-4 py-3 text-slate-500 text-sm",children:"No clients found"}):h.map(p=>d.jsx("button",{type:"button",className:"w-full px-4 py-3 text-left hover:bg-blue-50 flex justify-between items-center",onClick:()=>{t({...e,client_id:p.client_id}),s(`${p.company_name}`),i(!1)},children:d.jsx("span",{className:"font-semibold text-slate-700",children:p.company_name})},p.client_id))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Officer Name"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_name||"",onChange:p=>t({...e,contract_officer_name:p.target.value})}),o.contract_officer_name&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_name})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Officer Address"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_address||"",onChange:p=>t({...e,contract_officer_address:p.target.value})}),o.contract_officer_address&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_address})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"City"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_city||"",onChange:p=>t({...e,contract_officer_city:p.target.value})}),o.contract_officer_city&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_city})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"State"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_state||"",onChange:p=>t({...e,contract_officer_state:p.target.value})}),o.contract_officer_state&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_state})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"ZIP"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_zip||"",onChange:p=>t({...e,contract_officer_zip:p.target.value})}),o.contract_officer_zip&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_zip})]})]})]})}function mJ({contract:e,onChange:t,errors:r}){return d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"FOB Term"}),d.jsxs("select",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none bg-white",value:e.fob_term||"Origin",onChange:n=>t({...e,fob_term:n.target.value}),children:[d.jsx("option",{value:"Origin",children:"Origin"}),d.jsx("option",{value:"Destination",children:"Destination"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Energy Star Compliance"}),d.jsxs("select",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none bg-white",value:e.energy_star_compliance||"Yes",onChange:n=>t({...e,energy_star_compliance:n.target.value}),children:[d.jsx("option",{value:"Yes",children:"Yes"}),d.jsx("option",{value:"No",children:"No"}),d.jsx("option",{value:"N/A",children:"N/A"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Normal Delivery (Days)"}),d.jsx("input",{type:"number",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.normal_delivery_time||30,onChange:n=>t({...e,normal_delivery_time:parseInt(n.target.value)||0})}),r.normal_delivery_time&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.normal_delivery_time})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Expedited Delivery (Days)"}),d.jsx("input",{type:"number",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.expedited_delivery_time||10,onChange:n=>t({...e,expedited_delivery_time:parseInt(n.target.value)||0})}),r.expedited_delivery_time&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.expedited_delivery_time})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Quantity/Volume Discounts"}),d.jsx("input",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none resize-none",value:e.q_v_discount||"",onChange:n=>t({...e,q_v_discount:n.target.value})}),r.q_v_discount&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.q_v_discount})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Additional Concessions"}),d.jsx("textarea",{rows:2,className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none resize-none",value:e.additional_concessions||"",onChange:n=>t({...e,additional_concessions:n.target.value})}),r.additional_concessions&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.additional_concessions})]})]})}const bD={async getAllClients(){return(await zt.get("/clients")).data},async getApprovedClients(){return(await zt.get("/clients/approved")).data}},wD=e=>{const t={};Eo(e.client_id,"Client")&&(t.client_id="You must select a client");const n=Eo(e.contract_number,"Contract number")||Yn(e.contract_number,50,"Contract Number");n&&(t.contract_number=n);const s=CY(e.contract_officer_name,"Name");s&&(t.contract_officer_name=s);const a=Yn(e.contract_officer_address,50,"Address");a&&(t.contract_officer_address=a);const i=Yn(e.contract_officer_city,50,"City");i&&(t.contract_officer_city=i);const o=Yn(e.contract_officer_state,50,"State");o&&(t.contract_officer_state=o);const c=ZE(e.contract_officer_zip);return c&&(t.contract_officer_zip=c),{isValid:Object.keys(t).length===0,errors:t}},xJ=e=>{const t={},r=Yn(e.origin_country,50,"");r&&(t.origin_country=r);const n=RY(e.gsa_proposed_discount,0,100,"Discount");n&&(t.gsa_proposed_discount=n);const s=Yn(e.q_v_discount,50,"Quantity/Volume Discount");s&&(t.q_v_discount=s);const a=Yn(e.additional_concessions,50,"Additional Concessions");a&&(t.additional_concessions=a);const i=g3(e.normal_delivery_time,"Normal delivery time");i&&(t.normal_delivery_time=i);const o=g3(e.expedited_delivery_time,"Expedited delivery time");return o&&(t.expedited_delivery_time=o),e.fob_term||(t.fob_term="FOB term is required"),e.energy_star_compliance||(t.energy_star_compliance="Energy Star compliance is required"),{isValid:Object.keys(t).length===0,errors:t}},N3={client_id:void 0,contract_number:"",contract_officer_name:"",contract_officer_address:"",contract_officer_city:"",contract_officer_state:"",contract_officer_zip:"",origin_country:"USA",gsa_proposed_discount:0,q_v_discount:"",additional_concessions:"",normal_delivery_time:30,expedited_delivery_time:10,fob_term:"Origin",energy_star_compliance:"Yes",is_deleted:!1};function gJ({isOpen:e,onClose:t,onSuccess:r}){const[n,s]=ne.useState(1),[a,i]=ne.useState(N3),[o,c]=ne.useState([]),[f,h]=ne.useState(""),[p,x]=ne.useState(!1),[g,v]=ne.useState(!1),[y,w]=ne.useState({});ne.useEffect(()=>{e&&_()},[e]);const _=async()=>{try{const N=await bD.getAllClients();c(N)}catch(N){console.error("Failed to load clients",N)}},S=async N=>{var O,R,V,I,Z,ce;if(N.preventDefault(),n===1){const F=wD(a);w(F.errors),F.isValid&&s(2);return}const k=xJ(a);if(w(k.errors),!!k.isValid){if(!a.client_id){w({client_id:"Client selection is missing"}),s(1);return}v(!0),w({}),x(!1);try{const{client_id:F,...X}=a,P={...X,contract_officer_name:((O=X.contract_officer_name)==null?void 0:O.trim())||"",contract_number:X.contract_number.trim(),origin_country:((R=X.origin_country)==null?void 0:R.trim())||"USA",gsa_proposed_discount:Number(X.gsa_proposed_discount)||0,normal_delivery_time:Number(X.normal_delivery_time)||0,expedited_delivery_time:Number(X.expedited_delivery_time)||0};await Xx.createContract(F,P),r(),E()}catch(F){const X=(I=(V=F==null?void 0:F.response)==null?void 0:V.data)==null?void 0:I.detail;((Z=F==null?void 0:F.response)==null?void 0:Z.status)===409?w({submit:X||"This client already has an active contract."}):Array.isArray(X)?w({submit:((ce=X[0])==null?void 0:ce.msg)||"Invalid data format provided."}):w({submit:X||"An error occurred while creating the contract."})}finally{v(!1)}}},E=()=>{s(1),i(N3),h(""),w({}),t()};return ne.useEffect(()=>{w({})},[n]),e?d.jsx("div",{className:"fixed inset-0 bg-slate-900/40 z-50 flex items-center justify-center p-4 ",children:d.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[d.jsx("div",{className:"bg-slate-50 py-5 px-8 shrink-0",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-700",children:"Create Contract"}),d.jsx("p",{className:"text-slate-500 text-sm opacity-80",children:"Setup a new contract profile for your client"})]}),d.jsx("button",{type:"button",onClick:E,className:"p-2 hover:bg-white/20 rounded-full transition-colors",disabled:g,children:d.jsx(Zn,{className:"w-6 h-6 text-slate-700"})})]})}),d.jsx("div",{className:"flex items-center justify-center gap-4 p-4 shrink-0",children:["Client & Officer","Terms & Delivery"].map((N,k)=>{const O=k+1,R=n>=O,V=n>O;return d.jsxs(We.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold transition-all ${R?"bg-[#38A1DB] text-white":"bg-slate-200 text-slate-400"}`,children:V?d.jsx(us,{className:"w-6 h-6"}):O}),d.jsx("span",{className:`font-semibold ${R?"text-[#38A1DB]":"text-slate-400"}`,children:N})]}),k===0&&d.jsx("div",{className:`w-16 h-1 rounded-full transition-colors ${V?"bg-[#38A1DB]":"bg-slate-200"}`})]},O)})}),d.jsxs("form",{onSubmit:S,noValidate:!0,className:"flex-1 overflow-y-auto",children:[d.jsxs("div",{className:"py-6 px-8 space-y-6",children:[y.submit&&d.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-r-xl p-4 flex items-start gap-3",children:[d.jsx(Ic,{className:"w-5 h-5 text-red-500 shrink-0 mt-0.5"}),d.jsx("div",{children:d.jsx("p",{className:"text-sm text-red-700",children:y.submit})})]}),n===1&&d.jsx(pJ,{contract:a,onChange:i,clients:o,clientSearch:f,setClientSearch:h,showClientDropdown:p,setShowClientDropdown:x,errors:y}),n===2&&d.jsx(mJ,{contract:a,onChange:i,errors:y})]}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 flex justify-between border-t border-slate-100 shrink-0",children:[d.jsx("button",{type:"button",onClick:()=>{n===1?E():s(1)},className:"px-6 py-3 rounded-xl border-2 border-slate-300 font-bold text-slate-600 hover:bg-slate-100 transition-colors disabled:opacity-50",disabled:g,children:n===1?"Cancel":"Back"}),d.jsx("button",{type:"submit",disabled:g,className:"px-6 py-3 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:g?d.jsxs(d.Fragment,{children:[d.jsx(ar,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):n===1?"Next":"Create Contract Profile"})]})]})]})}):null}const yJ={contract_number:"",contract_officer_name:"",contract_officer_address:"",contract_officer_city:"",contract_officer_state:"",contract_officer_zip:"",origin_country:"USA",gsa_proposed_discount:0,q_v_discount:"",additional_concessions:"",normal_delivery_time:30,expedited_delivery_time:10,fob_term:"Origin",energy_star_compliance:"Yes"};function vJ({isOpen:e,contract:t,onClose:r,onSuccess:n}){const[s,a]=ne.useState(1),[i,o]=ne.useState(yJ),[c,f]=ne.useState(!1),[h,p]=ne.useState({});ne.useEffect(()=>{e&&t&&(o({contract_number:t.contract_number||"",contract_officer_name:t.contract_officer_name||"",contract_officer_address:t.contract_officer_address||"",contract_officer_city:t.contract_officer_city||"",contract_officer_state:t.contract_officer_state||"",contract_officer_zip:t.contract_officer_zip||"",origin_country:t.origin_country||"USA",gsa_proposed_discount:t.gsa_proposed_discount||0,q_v_discount:t.q_v_discount||"",additional_concessions:t.additional_concessions||"",normal_delivery_time:t.normal_delivery_time||30,expedited_delivery_time:t.expedited_delivery_time||10,fob_term:t.fob_term||"Origin",energy_star_compliance:t.energy_star_compliance||"Yes"}),a(1),p({}))},[e,t]);const x=async v=>{var y,w,_,S;if(v.preventDefault(),s===1){const E=wD(i);p(E.errors),E.isValid&&a(2);return}if(!(t!=null&&t.client_id)){p({submit:"Missing Client ID. Cannot update."});return}f(!0),p({});try{const E={...i,contract_number:i.contract_number.trim(),origin_country:((y=i.origin_country)==null?void 0:y.trim())||"USA",gsa_proposed_discount:Number(i.gsa_proposed_discount)||0,normal_delivery_time:Number(i.normal_delivery_time)||0,expedited_delivery_time:Number(i.expedited_delivery_time)||0};await Xx.updateContract(t.client_id,E),n(),g()}catch(E){const N=(_=(w=E==null?void 0:E.response)==null?void 0:w.data)==null?void 0:_.detail;Array.isArray(N)?p({submit:((S=N[0])==null?void 0:S.msg)||"Validation error"}):p({submit:N||"An unexpected error occurred"}),console.error("Update Error:",E)}finally{f(!1)}},g=()=>{a(1),p({}),r()};return!e||!t?null:d.jsx("div",{className:"fixed inset-0 bg-slate-900/40 z-50 flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[d.jsx("div",{className:"bg-slate-50 py-4 px-8 shrink-0",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold  text-slate-700",children:"Edit Contract"}),d.jsxs("p",{className:"text-slate-500 text-sm",children:["Update contract details for ",t.client]})]}),d.jsx("button",{type:"button",onClick:g,className:"p-2 hover:bg-white/20 rounded-full transition-colors",disabled:c,children:d.jsx(Zn,{className:"w-6 h-6 text-slate-700"})})]})}),d.jsx("div",{className:"flex items-center justify-center gap-4 p-4 shrink-0",children:["Contract & Officer","Terms & Delivery"].map((v,y)=>{const w=y+1,_=s>=w,S=s>w;return d.jsxs(We.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold transition-colors ${_?"bg-[#38A1DB] text-white":"bg-slate-200 text-slate-400"}`,children:S?d.jsx(us,{className:"w-6 h-6"}):w}),d.jsx("span",{className:`font-semibold ${_?"text-[#38A1DB]":"text-slate-400"}`,children:v})]}),y===0&&d.jsx("div",{className:`w-16 h-1 rounded-full ${s>1?"bg-[#38A1DB]":"bg-slate-200"}`})]},w)})}),d.jsxs("form",{onSubmit:x,noValidate:!0,className:"flex-1 overflow-y-auto",children:[d.jsxs("div",{className:"py-6 px-8 space-y-6",children:[h.submit&&d.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-center gap-3 text-red-800",children:[d.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),d.jsx("p",{className:"text-sm font-semibold",children:h.submit})]}),s===1?d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Contract Number *"}),d.jsx("input",{type:"text",className:`w-full mt-2 px-4 py-3 rounded-xl border-2 transition-all outline-none ${h.contract_number?"border-red-300 focus:border-red-500 bg-red-50/30":"border-slate-200 focus:border-[#38A1DB]"}`,value:i.contract_number,onChange:v=>o({...i,contract_number:v.target.value})}),h.contract_number&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.contract_number})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Officer Name"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_name,onChange:v=>o({...i,contract_officer_name:v.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Officer Address"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_address,onChange:v=>o({...i,contract_officer_address:v.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"City"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_city,onChange:v=>o({...i,contract_officer_city:v.target.value})})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"State"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_state,onChange:v=>o({...i,contract_officer_state:v.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"ZIP"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_zip,onChange:v=>o({...i,contract_officer_zip:v.target.value})})]})]})]}):d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"FOB Term"}),d.jsxs("select",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none bg-white",value:i.fob_term,onChange:v=>o({...i,fob_term:v.target.value}),children:[d.jsx("option",{value:"Origin",children:"Origin"}),d.jsx("option",{value:"Destination",children:"Destination"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Energy Star"}),d.jsxs("select",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none bg-white",value:i.energy_star_compliance,onChange:v=>o({...i,energy_star_compliance:v.target.value}),children:[d.jsx("option",{value:"Yes",children:"Yes"}),d.jsx("option",{value:"No",children:"No"}),d.jsx("option",{value:"N/A",children:"N/A"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Normal Delivery (Days)"}),d.jsx("input",{type:"number",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.normal_delivery_time,onChange:v=>o({...i,normal_delivery_time:parseInt(v.target.value)||0})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Expedited Delivery (Days)"}),d.jsx("input",{type:"number",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.expedited_delivery_time,onChange:v=>o({...i,expedited_delivery_time:parseInt(v.target.value)||0})})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Quantity Discounts"}),d.jsx("textarea",{rows:2,className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none resize-none",value:i.q_v_discount,onChange:v=>o({...i,q_v_discount:v.target.value})})]})]})]}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 flex justify-between border-t border-slate-100 shrink-0",children:[d.jsx("button",{type:"button",onClick:()=>s===1?g():a(1),className:"px-6 py-3 rounded-xl border-2 border-slate-300 font-bold text-slate-600 hover:bg-slate-100 transition-all disabled:opacity-50",disabled:c,children:s===1?"Cancel":"Back"}),d.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:c?d.jsxs(d.Fragment,{children:[d.jsx(ar,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):s===1?"Next":"Update Contract"})]})]})]})})}function bJ({isOpen:e,title:t="Delete Contract",description:r="Are you sure you want to delete this contract? This action cannot be undone.",confirmText:n="Delete",cancelText:s="Cancel",loading:a=!1,onConfirm:i,onCancel:o}){return e?d.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:o}),d.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl w-full max-w-md p-6",children:[d.jsx("button",{onClick:o,className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:d.jsx(Zn,{className:"w-4 h-4"})}),d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:"w-12 h-8 rounded-xl bg-red-100 flex items-center justify-center",children:d.jsx(v1,{className:"w-5 h-5 text-red-600"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t}),d.jsx("p",{className:"text-sm text-slate-500 mt-1",children:r})]})]}),d.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[d.jsx("button",{onClick:o,className:"px-4 py-2 rounded-xl font-semibold text-slate-600 hover:bg-slate-100",disabled:a,children:s}),d.jsx("button",{onClick:i,disabled:a,className:"px-4 py-2 rounded-xl font-semibold bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",children:n})]})]})]}):null}function wJ(){const[e,t]=ne.useState(""),[r,n]=ne.useState(null),[s,a]=ne.useState([]),[i,o]=ne.useState(!0),[c,f]=ne.useState(null),[h,p]=ne.useState(!1),[x,g]=ne.useState(!1),[v,y]=ne.useState(null),[w,_]=ne.useState(!1),[S,E]=ne.useState(null),[N,k]=ne.useState(!1),[O,R]=ne.useState(1),V=8;ne.useEffect(()=>{I()},[]),ne.useEffect(()=>{R(1)},[e]);const I=async()=>{try{o(!0),f(null);const Y=await Xx.getAllContracts();a(Y)}catch(Y){console.error("Error fetching contracts:",Y)}finally{o(!1)}},Z=ne.useMemo(()=>s.filter(Y=>{var oe;if(Y.is_deleted)return!1;const ve=e.toLowerCase();return Y.contract_number.toLowerCase().includes(ve)||((oe=Y.contract_officer_name)==null?void 0:oe.toLowerCase().includes(ve))||Y.client.toLowerCase().includes(ve)}),[s,e]),ce=Z.length,F=(O-1)*V,X=Z.slice(F,F+V),P=Y=>{E(Y),_(!0)},ie=async()=>{if(S)try{k(!0),await Xx.deleteContract(S),a(Y=>Y.map(ve=>ve.client_id===S?{...ve,is_deleted:!0}:ve))}catch(Y){f(Y instanceof Error?Y.message:"Failed to delete contract")}finally{k(!1),_(!1),E(null)}},te=Y=>{y(Y),g(!0)};return d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-6 lg:p-10 space-y-10",children:[c&&d.jsxs("div",{className:"mx-auto mb-6 bg-red-50 border border-red-200 rounded-2xl p-4 flex items-start gap-3",children:[d.jsx(Ic,{className:"w-5 h-5 text-red-500 shrink-0 mt-0.5"}),d.jsx("div",{className:"flex-1",children:d.jsx("p",{className:"text-sm font-semibold text-red-800",children:c})}),d.jsx("button",{onClick:()=>f(null),className:"text-red-400 hover:text-red-600",children:d.jsx(Zn,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-12 mx-auto ",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"Contracts"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Manage your GSA contract profiles and logistics information"})]}),d.jsxs("button",{onClick:()=>p(!0),className:"flex items-center justify-center gap-2 bg-[#38A1DB] hover:bg-[#2D8BBF] text-white px-7 py-3 rounded-xl shadow-lg shadow-blue-200 transition-all active:scale-95 font-bold",children:[d.jsx(ud,{className:"w-5 h-5 stroke-[3px]"}),"Add Contract"]})]}),d.jsx("div",{className:"mx-auto bg-white p-4 rounded-4xl shadow-sm border border-slate-100 mb-8 flex flex-col lg:flex-row gap-4 items-center",children:d.jsxs("div",{className:"relative flex-1 w-full",children:[d.jsx(Wl,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),d.jsx("input",{type:"text",placeholder:"Search contracts by number, officer name, or client...",className:"w-full pl-14 pr-6 py-3.5 rounded-2xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20  bg-slate-50/50 text-slate-700 placeholder:text-slate-400 transition-all font-medium",value:e,onChange:Y=>t(Y.target.value)})]})}),d.jsx("div",{className:"mx-auto ",children:d.jsx(fJ,{contracts:X,loading:i,onView:n,onEdit:te,onDelete:P,currentPage:O,totalContracts:ce,itemsPerPage:V,onPageChange:R})}),d.jsx(dJ,{contract:r,onClose:()=>n(null),onEdit:te}),d.jsx(gJ,{isOpen:h,onClose:()=>p(!1),onSuccess:I}),d.jsx(vJ,{isOpen:x,contract:v,onClose:()=>{g(!1),y(null)},onSuccess:I}),d.jsx(bJ,{isOpen:w,loading:N,onCancel:()=>{_(!1),E(null)},onConfirm:ie})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Yx={};Yx.version="0.18.5";var _D=1252,_J=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],QE={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},eS=function(e){_J.indexOf(e)!=-1&&(_D=QE[0]=e)};function EJ(){eS(1252)}var ai=function(e){eS(e)};function tS(){ai(1200),EJ()}function T3(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function SJ(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function ED(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Th=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?SJ(e.slice(2)):t==254&&r==255?ED(e.slice(2)):t==65279?e.slice(1):e},Bm=function(t){return String.fromCharCode(t)},k3=function(t){return String.fromCharCode(t)},c0,kl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function u0(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),i=(r&3)<<4|n>>4,s=e.charCodeAt(f++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=kl.charAt(a)+kl.charAt(i)+kl.charAt(o)+kl.charAt(c);return t}function ca(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=kl.indexOf(e.charAt(f++)),i=kl.indexOf(e.charAt(f++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=kl.indexOf(e.charAt(f++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=kl.indexOf(e.charAt(f++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Ft=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Bo=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Bl(e){return Ft?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function A3(e){return Ft?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var sa=function(t){return Ft?Bo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function b1(e){if(typeof ArrayBuffer>"u")return sa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function $l(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function NJ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function rS(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return rS(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Dn=Ft?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Bo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function TJ(e){for(var t=[],r=0,n=e.length+250,s=Bl(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Bl(65535),n=65530)}return t.push(s.slice(0,r)),Dn(t)}var Ss=/\u0000/g,kh=/[\u0001-\u0006]/g;function mf(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ii(e,t){var r=""+e;return r.length>=t?r:Hr("0",t-r.length)+r}function nS(e,t){var r=""+e;return r.length>=t?r:Hr(" ",t-r.length)+r}function Jx(e,t){var r=""+e;return r.length>=t?r:r+Hr(" ",t-r.length)}function kJ(e,t){var r=""+Math.round(e);return r.length>=t?r:Hr("0",t-r.length)+r}function AJ(e,t){var r=""+e;return r.length>=t?r:Hr("0",t-r.length)+r}var C3=Math.pow(2,32);function Qu(e,t){if(e>C3||e<-C3)return kJ(e,t);var r=Math.round(e);return AJ(r,t)}function Zx(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var R3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function CJ(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var yt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},j3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},RJ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qx(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,f=0,h=0,p=Math.floor(s);f<t&&(p=Math.floor(s),o=p*i+a,h=p*f+c,!(s-p<5e-8));)s=1/(s-p),a=i,i=o,c=f,f=h;if(h>t&&(f>t?(h=c,o=a):(h=f,o=i)),!r)return[0,n*o,h];var x=Math.floor(n*o/h);return[x,n*o-x*h,h]}function Nc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=FJ(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var SD=new Date(1899,11,31,0,0,0),jJ=SD.getTime(),OJ=new Date(1900,2,1,0,0,0);function ND(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=OJ&&(r+=1440*60*1e3),(r-(jJ+(e.getTimezoneOffset()-SD.getTimezoneOffset())*6e4))/(1440*60*1e3)}function sS(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function DJ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function IJ(e){var t=e<0?12:11,r=sS(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function MJ(e){var t=sS(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function f0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=IJ(e):t===10?r=e.toFixed(10).substr(0,12):r=MJ(e),sS(DJ(r.toUpperCase()))}function Yc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):f0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return qa(14,ND(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function FJ(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function PJ(e,t,r,n){var s="",a=0,i=0,o=r.y,c,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,f=2;break;default:c=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,f=t.length;break;case 3:return Sb[r.m-1][1];case 5:return Sb[r.m-1][0];default:return Sb[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,f=t.length;break;case 3:return R3[r.q][0];default:return R3[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ii(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=ii(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:c=o,f=1;break}var h=f>0?ii(c,f):"";return h}function Al(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var TD=/%/g;function LJ(e,t,r){var n=t.replace(TD,""),s=t.length-n.length;return Ro(e,n,r*Math.pow(10,2*s))+Hr("%",s)}function BJ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ro(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function kD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+kD(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,h){return c+f+h.substr(0,(s+a)%s)+"."+h.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var AD=/# (\?+)( ?)\/( ?)(\d+)/;function UJ(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Hr(" ",e[1].length+1+e[4].length):nS(i,e[1].length)+e[2]+"/"+e[3]+ii(o,e[4].length))}function zJ(e,t,r){return r+(t===0?"":""+t)+Hr(" ",e[1].length+2+e[4].length)}var CD=/^#*0*\.([0#]+)/,RD=/\).*[0#]/,jD=/\(###\) ###\\?-####/;function vs(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function O3(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function D3(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function HJ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function VJ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ka(e,t,r){if(e.charCodeAt(0)===40&&!t.match(RD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ka("n",n,r):"("+ka("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return BJ(e,t,r);if(t.indexOf("%")!==-1)return LJ(e,t,r);if(t.indexOf("E")!==-1)return kD(t,r);if(t.charCodeAt(0)===36)return"$"+ka(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Qu(c,t.length);if(t.match(/^[#?]+$/))return s=Qu(r,0),s==="0"&&(s=""),s.length>t.length?s:vs(t.substr(0,t.length-s.length))+s;if(a=t.match(AD))return UJ(a,c,f);if(t.match(/^#+0+$/))return f+Qu(c,t.length-t.indexOf("0"));if(a=t.match(CD))return s=O3(r,a[1].length).replace(/^([^\.]+)$/,"$1."+vs(a[1])).replace(/\.$/,"."+vs(a[1])).replace(/\.(\d*)$/,function(v,y){return"."+y+Hr("0",vs(a[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+O3(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+Al(Qu(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ka(e,t,-r):Al(""+(Math.floor(r)+HJ(r,a[1].length)))+"."+ii(D3(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ka(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=mf(ka(e,t.replace(/[\\-]/g,""),r)),i=0,mf(mf(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(jD))return s=ka(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Qx(c,Math.pow(10,i)-1,!1),s=""+f,h=Ro("n",a[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+a[2]+"/"+a[3],h=Jx(o[2],i),h.length<a[4].length&&(h=vs(a[4].substr(a[4].length-h.length))+h),s+=h,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Qx(c,Math.pow(10,i)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?nS(o[1],i)+a[2]+"/"+a[3]+Jx(o[2],i):Hr(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Qu(r,0),t.length<=s.length?s:vs(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,x=t.length-s.length-p;return vs(t.substr(0,p)+s+t.substr(t.length-x))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=D3(r,a[1].length),r<0?"-"+ka(e,t,-r):Al(VJ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ii(0,3-v.length):"")+v})+"."+ii(i,a[1].length);switch(t){case"###,##0.00":return ka(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Al(Qu(c,0));return g!=="0"?f+g:"";case"###,###.00":return ka(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ka(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function qJ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ro(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function WJ(e,t,r){var n=t.replace(TD,""),s=t.length-n.length;return Ro(e,n,r*Math.pow(10,2*s))+Hr("%",s)}function OD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+OD(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,h){return c+f+h.substr(0,(s+a)%s)+"."+h.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ci(e,t,r){if(e.charCodeAt(0)===40&&!t.match(RD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ci("n",n,r):"("+Ci("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return qJ(e,t,r);if(t.indexOf("%")!==-1)return WJ(e,t,r);if(t.indexOf("E")!==-1)return OD(t,r);if(t.charCodeAt(0)===36)return"$"+Ci(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ii(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:vs(t.substr(0,t.length-s.length))+s;if(a=t.match(AD))return zJ(a,c,f);if(t.match(/^#+0+$/))return f+ii(c,t.length-t.indexOf("0"));if(a=t.match(CD))return s=(""+r).replace(/^([^\.]+)$/,"$1."+vs(a[1])).replace(/\.$/,"."+vs(a[1])),s=s.replace(/\.(\d*)$/,function(v,y){return"."+y+Hr("0",vs(a[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+Al(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ci(e,t,-r):Al(""+r)+"."+Hr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Ci(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=mf(Ci(e,t.replace(/[\\-]/g,""),r)),i=0,mf(mf(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(jD))return s=Ci(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Qx(c,Math.pow(10,i)-1,!1),s=""+f,h=Ro("n",a[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+a[2]+"/"+a[3],h=Jx(o[2],i),h.length<a[4].length&&(h=vs(a[4].substr(a[4].length-h.length))+h),s+=h,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Qx(c,Math.pow(10,i)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?nS(o[1],i)+a[2]+"/"+a[3]+Jx(o[2],i):Hr(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:vs(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,x=t.length-s.length-p;return vs(t.substr(0,p)+s+t.substr(t.length-x))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ci(e,t,-r):Al(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ii(0,3-v.length):"")+v})+"."+ii(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Al(""+c);return g!=="0"?f+g:"";default:if(t.match(/\.[0#?]*$/))return Ci(e,t.slice(0,t.lastIndexOf(".")),r)+vs(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ro(e,t,r){return(r|0)===r?Ci(e,t,r):ka(e,t,r)}function $J(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var DD=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function dd(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Zx(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(DD))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function GJ(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",f,h,p,x="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Zx(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(p=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(p);s[s.length]={t:"t",v:a},++i;break;case"\\":var g=e.charAt(++i),v=g==="("||g===")"?g:"t";s[s.length]={t:v,v:g},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(f==null&&(f=Nc(t,r,e.charAt(i+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Nc(t,r),f==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=x),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var y={t:o,v:o};if(f==null&&(f=Nc(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",x="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",i+=5,x="h"):e.substr(i,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",i+=5,x="h"):(y.t="t",++i),f==null&&y.t==="T")return"";s[s.length]=y,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(DD)){if(f==null&&(f=Nc(t,r),f==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",dd(e)||(s[s.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,_=0,S;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=x,c="h",w<1&&(w=1);break;case"s":(S=s[i].v.match(/\.0+$/))&&(_=Math.max(_,S[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var E="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=PJ(s[i].t.charCodeAt(0),s[i].v,f,_),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;E+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=Yc(t,r);break}var k="",O,R;if(E.length>0){E.charCodeAt(0)==40?(O=t<0&&E.charCodeAt(0)===45?-t:t,R=Ro("n",E,O)):(O=t<0&&n>1?-t:t,R=Ro("n",E,O),O<0&&s[0]&&s[0].t=="t"&&(R=R.substr(1),s[0].v="-"+s[0].v)),N=R.length-1;var V=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){V=i;break}var I=s.length;if(V===s.length&&R.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=R.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=R.substr(0,N+1),N=-1),s[i].t="t",I=i);N>=0&&I<s.length&&(s[I].v=R.substr(0,N+1)+s[I].v)}else if(V!==s.length&&R.indexOf("E")===-1){for(N=R.indexOf(".")-1,i=V;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(h=s[i].v.indexOf(".")>-1&&i===V?s[i].v.indexOf(".")-1:s[i].v.length-1,k=s[i].v.substr(h+1);h>=0;--h)N>=0&&(s[i].v.charAt(h)==="0"||s[i].v.charAt(h)==="#")&&(k=R.charAt(N--)+k);s[i].v=k,s[i].t="t",I=i}for(N>=0&&I<s.length&&(s[I].v=R.substr(0,N+1)+s[I].v),N=R.indexOf(".")+1,i=V;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==V)){for(h=s[i].v.indexOf(".")>-1&&i===V?s[i].v.indexOf(".")+1:0,k=s[i].v.substr(0,h);h<s[i].v.length;++h)N<R.length&&(k+=R.charAt(N++));s[i].v=k,s[i].t="t",I=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(O=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Ro(s[i].t,s[i].v,O),s[i].t="t");var Z="";for(i=0;i!==s.length;++i)s[i]!=null&&(Z+=s[i].v);return Z}var I3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function M3(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function KJ(e,t){var r=$J(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(I3),o=r[1].match(I3);return M3(t,i)?[n,r[0]]:M3(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function qa(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:yt)[e],n==null&&(n=r.table&&r.table[j3[e]]||yt[j3[e]]),n==null&&(n=RJ[e]||"General");break}if(Zx(n,0))return Yc(t,r);t instanceof Date&&(t=ND(t,r.date1904));var s=KJ(n,t);if(Zx(s[1]))return Yc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return GJ(s[1],t,r,s[0])}function jo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(yt[r]==null){t<0&&(t=r);continue}if(yt[r]==e){t=r;break}}t<0&&(t=391)}return yt[t]=e,t}function w1(e){for(var t=0;t!=392;++t)e[t]!==void 0&&jo(e[t],t)}function hd(){yt=CJ()}var XJ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ID=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function YJ(e){var t=typeof e=="number"?yt[e]:e;return t=t.replace(ID,"(\\d+)"),new RegExp("^"+t+"$")}function JJ(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(ID)||[]).forEach(function(p,x){var g=parseInt(r[x+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=g;break;case"d":a=g;break;case"h":i=g;break;case"s":c=g;break;case"m":i>=0?o=g:s=g;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?f:n==-1&&s==-1&&a==-1?h:f+"T"+h}var ZJ=(function(){var e={};e.version="1.2.0";function t(){for(var R=0,V=new Array(256),I=0;I!=256;++I)R=I,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,V[I]=R;return typeof Int32Array<"u"?new Int32Array(V):V}var r=t();function n(R){var V=0,I=0,Z=0,ce=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)ce[Z]=R[Z];for(Z=0;Z!=256;++Z)for(I=R[Z],V=256+Z;V<4096;V+=256)I=ce[V]=I>>>8^R[I&255];var F=[];for(Z=1;Z!=16;++Z)F[Z-1]=typeof Int32Array<"u"?ce.subarray(Z*256,Z*256+256):ce.slice(Z*256,Z*256+256);return F}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],f=s[4],h=s[5],p=s[6],x=s[7],g=s[8],v=s[9],y=s[10],w=s[11],_=s[12],S=s[13],E=s[14];function N(R,V){for(var I=V^-1,Z=0,ce=R.length;Z<ce;)I=I>>>8^r[(I^R.charCodeAt(Z++))&255];return~I}function k(R,V){for(var I=V^-1,Z=R.length-15,ce=0;ce<Z;)I=E[R[ce++]^I&255]^S[R[ce++]^I>>8&255]^_[R[ce++]^I>>16&255]^w[R[ce++]^I>>>24]^y[R[ce++]]^v[R[ce++]]^g[R[ce++]]^x[R[ce++]]^p[R[ce++]]^h[R[ce++]]^f[R[ce++]]^c[R[ce++]]^o[R[ce++]]^i[R[ce++]]^a[R[ce++]]^r[R[ce++]];for(Z+=15;ce<Z;)I=I>>>8^r[(I^R[ce++])&255];return~I}function O(R,V){for(var I=V^-1,Z=0,ce=R.length,F=0,X=0;Z<ce;)F=R.charCodeAt(Z++),F<128?I=I>>>8^r[(I^F)&255]:F<2048?(I=I>>>8^r[(I^(192|F>>6&31))&255],I=I>>>8^r[(I^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,X=R.charCodeAt(Z++)&1023,I=I>>>8^r[(I^(240|F>>8&7))&255],I=I>>>8^r[(I^(128|F>>2&63))&255],I=I>>>8^r[(I^(128|X>>6&15|(F&3)<<4))&255],I=I>>>8^r[(I^(128|X&63))&255]):(I=I>>>8^r[(I^(224|F>>12&15))&255],I=I>>>8^r[(I^(128|F>>6&63))&255],I=I>>>8^r[(I^(128|F&63))&255]);return~I}return e.table=r,e.bstr=N,e.buf=k,e.str=O,e})(),mt=(function(){var t={};t.version="1.2.1";function r(ae,xe){for(var fe=ae.split("/"),de=xe.split("/"),me=0,ge=0,Ae=Math.min(fe.length,de.length);me<Ae;++me){if(ge=fe[me].length-de[me].length)return ge;if(fe[me]!=de[me])return fe[me]<de[me]?-1:1}return fe.length-de.length}function n(ae){if(ae.charAt(ae.length-1)=="/")return ae.slice(0,-1).indexOf("/")===-1?ae:n(ae.slice(0,-1));var xe=ae.lastIndexOf("/");return xe===-1?ae:ae.slice(0,xe+1)}function s(ae){if(ae.charAt(ae.length-1)=="/")return s(ae.slice(0,-1));var xe=ae.lastIndexOf("/");return xe===-1?ae:ae.slice(xe+1)}function a(ae,xe){typeof xe=="string"&&(xe=new Date(xe));var fe=xe.getHours();fe=fe<<6|xe.getMinutes(),fe=fe<<5|xe.getSeconds()>>>1,ae.write_shift(2,fe);var de=xe.getFullYear()-1980;de=de<<4|xe.getMonth()+1,de=de<<5|xe.getDate(),ae.write_shift(2,de)}function i(ae){var xe=ae.read_shift(2)&65535,fe=ae.read_shift(2)&65535,de=new Date,me=fe&31;fe>>>=5;var ge=fe&15;fe>>>=4,de.setMilliseconds(0),de.setFullYear(fe+1980),de.setMonth(ge-1),de.setDate(me);var Ae=xe&31;xe>>>=5;var ze=xe&63;return xe>>>=6,de.setHours(xe),de.setMinutes(ze),de.setSeconds(Ae<<1),de}function o(ae){$n(ae,0);for(var xe={},fe=0;ae.l<=ae.length-4;){var de=ae.read_shift(2),me=ae.read_shift(2),ge=ae.l+me,Ae={};switch(de){case 21589:fe=ae.read_shift(1),fe&1&&(Ae.mtime=ae.read_shift(4)),me>5&&(fe&2&&(Ae.atime=ae.read_shift(4)),fe&4&&(Ae.ctime=ae.read_shift(4))),Ae.mtime&&(Ae.mt=new Date(Ae.mtime*1e3));break}ae.l=ge,xe[de]=Ae}return xe}var c;function f(){return c||(c={})}function h(ae,xe){if(ae[0]==80&&ae[1]==75)return Ya(ae,xe);if((ae[0]|32)==109&&(ae[1]|32)==105)return br(ae,xe);if(ae.length<512)throw new Error("CFB file size "+ae.length+" < 512");var fe=3,de=512,me=0,ge=0,Ae=0,ze=0,Ce=0,Re=[],Oe=ae.slice(0,512);$n(Oe,0);var Xe=p(Oe);switch(fe=Xe[0],fe){case 3:de=512;break;case 4:de=4096;break;case 0:if(Xe[1]==0)return Ya(ae,xe);default:throw new Error("Major Version: Expected 3 or 4 saw "+fe)}de!==512&&(Oe=ae.slice(0,de),$n(Oe,28));var Ze=ae.slice(0,de);x(Oe,fe);var nt=Oe.read_shift(4,"i");if(fe===3&&nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+nt);Oe.l+=4,Ae=Oe.read_shift(4,"i"),Oe.l+=4,Oe.chk("00100000","Mini Stream Cutoff Size: "),ze=Oe.read_shift(4,"i"),me=Oe.read_shift(4,"i"),Ce=Oe.read_shift(4,"i"),ge=Oe.read_shift(4,"i");for(var Ye=-1,tt=0;tt<109&&(Ye=Oe.read_shift(4,"i"),!(Ye<0));++tt)Re[tt]=Ye;var ct=g(ae,de);w(Ce,ge,ct,de,Re);var yr=S(ct,Ae,Re,de);yr[Ae].name="!Directory",me>0&&ze!==X&&(yr[ze].name="!MiniFAT"),yr[Re[0]].name="!FAT",yr.fat_addrs=Re,yr.ssz=de;var vr={},Ar=[],ha=[],ec=[];E(Ae,yr,ct,Ar,me,vr,ha,ze),v(ha,ec,Ar),Ar.shift();var $o={FileIndex:ha,FullPaths:ec};return xe&&xe.raw&&($o.raw={header:Ze,sectors:ct}),$o}function p(ae){if(ae[ae.l]==80&&ae[ae.l+1]==75)return[0,0];ae.chk(P,"Header Signature: "),ae.l+=16;var xe=ae.read_shift(2,"u");return[ae.read_shift(2,"u"),xe]}function x(ae,xe){var fe=9;switch(ae.l+=2,fe=ae.read_shift(2)){case 9:if(xe!=3)throw new Error("Sector Shift: Expected 9 saw "+fe);break;case 12:if(xe!=4)throw new Error("Sector Shift: Expected 12 saw "+fe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+fe)}ae.chk("0600","Mini Sector Shift: "),ae.chk("000000000000","Reserved: ")}function g(ae,xe){for(var fe=Math.ceil(ae.length/xe)-1,de=[],me=1;me<fe;++me)de[me-1]=ae.slice(me*xe,(me+1)*xe);return de[fe-1]=ae.slice(fe*xe),de}function v(ae,xe,fe){for(var de=0,me=0,ge=0,Ae=0,ze=0,Ce=fe.length,Re=[],Oe=[];de<Ce;++de)Re[de]=Oe[de]=de,xe[de]=fe[de];for(;ze<Oe.length;++ze)de=Oe[ze],me=ae[de].L,ge=ae[de].R,Ae=ae[de].C,Re[de]===de&&(me!==-1&&Re[me]!==me&&(Re[de]=Re[me]),ge!==-1&&Re[ge]!==ge&&(Re[de]=Re[ge])),Ae!==-1&&(Re[Ae]=de),me!==-1&&de!=Re[de]&&(Re[me]=Re[de],Oe.lastIndexOf(me)<ze&&Oe.push(me)),ge!==-1&&de!=Re[de]&&(Re[ge]=Re[de],Oe.lastIndexOf(ge)<ze&&Oe.push(ge));for(de=1;de<Ce;++de)Re[de]===de&&(ge!==-1&&Re[ge]!==ge?Re[de]=Re[ge]:me!==-1&&Re[me]!==me&&(Re[de]=Re[me]));for(de=1;de<Ce;++de)if(ae[de].type!==0){if(ze=de,ze!=Re[ze])do ze=Re[ze],xe[de]=xe[ze]+"/"+xe[de];while(ze!==0&&Re[ze]!==-1&&ze!=Re[ze]);Re[de]=-1}for(xe[0]+="/",de=1;de<Ce;++de)ae[de].type!==2&&(xe[de]+="/")}function y(ae,xe,fe){for(var de=ae.start,me=ae.size,ge=[],Ae=de;fe&&me>0&&Ae>=0;)ge.push(xe.slice(Ae*F,Ae*F+F)),me-=F,Ae=wc(fe,Ae*4);return ge.length===0?Le(0):Dn(ge).slice(0,ae.size)}function w(ae,xe,fe,de,me){var ge=X;if(ae===X){if(xe!==0)throw new Error("DIFAT chain shorter than expected")}else if(ae!==-1){var Ae=fe[ae],ze=(de>>>2)-1;if(!Ae)return;for(var Ce=0;Ce<ze&&(ge=wc(Ae,Ce*4))!==X;++Ce)me.push(ge);w(wc(Ae,de-4),xe-1,fe,de,me)}}function _(ae,xe,fe,de,me){var ge=[],Ae=[];me||(me=[]);var ze=de-1,Ce=0,Re=0;for(Ce=xe;Ce>=0;){me[Ce]=!0,ge[ge.length]=Ce,Ae.push(ae[Ce]);var Oe=fe[Math.floor(Ce*4/de)];if(Re=Ce*4&ze,de<4+Re)throw new Error("FAT boundary crossed: "+Ce+" 4 "+de);if(!ae[Oe])break;Ce=wc(ae[Oe],Re)}return{nodes:ge,data:G3([Ae])}}function S(ae,xe,fe,de){var me=ae.length,ge=[],Ae=[],ze=[],Ce=[],Re=de-1,Oe=0,Xe=0,Ze=0,nt=0;for(Oe=0;Oe<me;++Oe)if(ze=[],Ze=Oe+xe,Ze>=me&&(Ze-=me),!Ae[Ze]){Ce=[];var Ye=[];for(Xe=Ze;Xe>=0;){Ye[Xe]=!0,Ae[Xe]=!0,ze[ze.length]=Xe,Ce.push(ae[Xe]);var tt=fe[Math.floor(Xe*4/de)];if(nt=Xe*4&Re,de<4+nt)throw new Error("FAT boundary crossed: "+Xe+" 4 "+de);if(!ae[tt]||(Xe=wc(ae[tt],nt),Ye[Xe]))break}ge[Ze]={nodes:ze,data:G3([Ce])}}return ge}function E(ae,xe,fe,de,me,ge,Ae,ze){for(var Ce=0,Re=de.length?2:0,Oe=xe[ae].data,Xe=0,Ze=0,nt;Xe<Oe.length;Xe+=128){var Ye=Oe.slice(Xe,Xe+128);$n(Ye,64),Ze=Ye.read_shift(2),nt=fS(Ye,0,Ze-Re),de.push(nt);var tt={name:nt,type:Ye.read_shift(1),color:Ye.read_shift(1),L:Ye.read_shift(4,"i"),R:Ye.read_shift(4,"i"),C:Ye.read_shift(4,"i"),clsid:Ye.read_shift(16),state:Ye.read_shift(4,"i"),start:0,size:0},ct=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);ct!==0&&(tt.ct=N(Ye,Ye.l-8));var yr=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);yr!==0&&(tt.mt=N(Ye,Ye.l-8)),tt.start=Ye.read_shift(4,"i"),tt.size=Ye.read_shift(4,"i"),tt.size<0&&tt.start<0&&(tt.size=tt.type=0,tt.start=X,tt.name=""),tt.type===5?(Ce=tt.start,me>0&&Ce!==X&&(xe[Ce].name="!StreamData")):tt.size>=4096?(tt.storage="fat",xe[tt.start]===void 0&&(xe[tt.start]=_(fe,tt.start,xe.fat_addrs,xe.ssz)),xe[tt.start].name=tt.name,tt.content=xe[tt.start].data.slice(0,tt.size)):(tt.storage="minifat",tt.size<0?tt.size=0:Ce!==X&&tt.start!==X&&xe[Ce]&&(tt.content=y(tt,xe[Ce].data,(xe[ze]||{}).data))),tt.content&&$n(tt.content,0),ge[nt]=tt,Ae.push(tt)}}function N(ae,xe){return new Date((na(ae,xe+4)/1e7*Math.pow(2,32)+na(ae,xe)/1e7-11644473600)*1e3)}function k(ae,xe){return f(),h(c.readFileSync(ae),xe)}function O(ae,xe){var fe=xe&&xe.type;switch(fe||Ft&&Buffer.isBuffer(ae)&&(fe="buffer"),fe||"base64"){case"file":return k(ae,xe);case"base64":return h(sa(ca(ae)),xe);case"binary":return h(sa(ae),xe)}return h(ae,xe)}function R(ae,xe){var fe=xe||{},de=fe.root||"Root Entry";if(ae.FullPaths||(ae.FullPaths=[]),ae.FileIndex||(ae.FileIndex=[]),ae.FullPaths.length!==ae.FileIndex.length)throw new Error("inconsistent CFB structure");ae.FullPaths.length===0&&(ae.FullPaths[0]=de+"/",ae.FileIndex[0]={name:de,type:5}),fe.CLSID&&(ae.FileIndex[0].clsid=fe.CLSID),V(ae)}function V(ae){var xe="Sh33tJ5";if(!mt.find(ae,"/"+xe)){var fe=Le(4);fe[0]=55,fe[1]=fe[3]=50,fe[2]=54,ae.FileIndex.push({name:xe,type:2,content:fe,size:4,L:69,R:69,C:69}),ae.FullPaths.push(ae.FullPaths[0]+xe),I(ae)}}function I(ae,xe){R(ae);for(var fe=!1,de=!1,me=ae.FullPaths.length-1;me>=0;--me){var ge=ae.FileIndex[me];switch(ge.type){case 0:de?fe=!0:(ae.FileIndex.pop(),ae.FullPaths.pop());break;case 1:case 2:case 5:de=!0,isNaN(ge.R*ge.L*ge.C)&&(fe=!0),ge.R>-1&&ge.L>-1&&ge.R==ge.L&&(fe=!0);break;default:fe=!0;break}}if(!(!fe&&!xe)){var Ae=new Date(1987,1,19),ze=0,Ce=Object.create?Object.create(null):{},Re=[];for(me=0;me<ae.FullPaths.length;++me)Ce[ae.FullPaths[me]]=!0,ae.FileIndex[me].type!==0&&Re.push([ae.FullPaths[me],ae.FileIndex[me]]);for(me=0;me<Re.length;++me){var Oe=n(Re[me][0]);de=Ce[Oe],de||(Re.push([Oe,{name:s(Oe).replace("/",""),type:1,clsid:te,ct:Ae,mt:Ae,content:null}]),Ce[Oe]=!0)}for(Re.sort(function(nt,Ye){return r(nt[0],Ye[0])}),ae.FullPaths=[],ae.FileIndex=[],me=0;me<Re.length;++me)ae.FullPaths[me]=Re[me][0],ae.FileIndex[me]=Re[me][1];for(me=0;me<Re.length;++me){var Xe=ae.FileIndex[me],Ze=ae.FullPaths[me];if(Xe.name=s(Ze).replace("/",""),Xe.L=Xe.R=Xe.C=-(Xe.color=1),Xe.size=Xe.content?Xe.content.length:0,Xe.start=0,Xe.clsid=Xe.clsid||te,me===0)Xe.C=Re.length>1?1:-1,Xe.size=0,Xe.type=5;else if(Ze.slice(-1)=="/"){for(ze=me+1;ze<Re.length&&n(ae.FullPaths[ze])!=Ze;++ze);for(Xe.C=ze>=Re.length?-1:ze,ze=me+1;ze<Re.length&&n(ae.FullPaths[ze])!=n(Ze);++ze);Xe.R=ze>=Re.length?-1:ze,Xe.type=1}else n(ae.FullPaths[me+1]||"")==n(Ze)&&(Xe.R=me+1),Xe.type=2}}}function Z(ae,xe){var fe=xe||{};if(fe.fileType=="mad")return Qn(ae,fe);switch(I(ae),fe.fileType){case"zip":return gs(ae,fe)}var de=(function(nt){for(var Ye=0,tt=0,ct=0;ct<nt.FileIndex.length;++ct){var yr=nt.FileIndex[ct];if(yr.content){var vr=yr.content.length;vr>0&&(vr<4096?Ye+=vr+63>>6:tt+=vr+511>>9)}}for(var Ar=nt.FullPaths.length+3>>2,ha=Ye+7>>3,ec=Ye+127>>7,$o=ha+tt+Ar+ec,gi=$o+127>>7,yd=gi<=109?0:Math.ceil((gi-109)/127);$o+gi+yd+127>>7>gi;)yd=++gi<=109?0:Math.ceil((gi-109)/127);var As=[1,yd,gi,ec,Ar,tt,Ye,0];return nt.FileIndex[0].size=Ye<<6,As[7]=(nt.FileIndex[0].start=As[0]+As[1]+As[2]+As[3]+As[4]+As[5])+(As[6]+7>>3),As})(ae),me=Le(de[7]<<9),ge=0,Ae=0;{for(ge=0;ge<8;++ge)me.write_shift(1,ie[ge]);for(ge=0;ge<8;++ge)me.write_shift(2,0);for(me.write_shift(2,62),me.write_shift(2,3),me.write_shift(2,65534),me.write_shift(2,9),me.write_shift(2,6),ge=0;ge<3;++ge)me.write_shift(2,0);for(me.write_shift(4,0),me.write_shift(4,de[2]),me.write_shift(4,de[0]+de[1]+de[2]+de[3]-1),me.write_shift(4,0),me.write_shift(4,4096),me.write_shift(4,de[3]?de[0]+de[1]+de[2]-1:X),me.write_shift(4,de[3]),me.write_shift(-4,de[1]?de[0]-1:X),me.write_shift(4,de[1]),ge=0;ge<109;++ge)me.write_shift(-4,ge<de[2]?de[1]+ge:-1)}if(de[1])for(Ae=0;Ae<de[1];++Ae){for(;ge<236+Ae*127;++ge)me.write_shift(-4,ge<de[2]?de[1]+ge:-1);me.write_shift(-4,Ae===de[1]-1?X:Ae+1)}var ze=function(nt){for(Ae+=nt;ge<Ae-1;++ge)me.write_shift(-4,ge+1);nt&&(++ge,me.write_shift(-4,X))};for(Ae=ge=0,Ae+=de[1];ge<Ae;++ge)me.write_shift(-4,Y.DIFSECT);for(Ae+=de[2];ge<Ae;++ge)me.write_shift(-4,Y.FATSECT);ze(de[3]),ze(de[4]);for(var Ce=0,Re=0,Oe=ae.FileIndex[0];Ce<ae.FileIndex.length;++Ce)Oe=ae.FileIndex[Ce],Oe.content&&(Re=Oe.content.length,!(Re<4096)&&(Oe.start=Ae,ze(Re+511>>9)));for(ze(de[6]+7>>3);me.l&511;)me.write_shift(-4,Y.ENDOFCHAIN);for(Ae=ge=0,Ce=0;Ce<ae.FileIndex.length;++Ce)Oe=ae.FileIndex[Ce],Oe.content&&(Re=Oe.content.length,!(!Re||Re>=4096)&&(Oe.start=Ae,ze(Re+63>>6)));for(;me.l&511;)me.write_shift(-4,Y.ENDOFCHAIN);for(ge=0;ge<de[4]<<2;++ge){var Xe=ae.FullPaths[ge];if(!Xe||Xe.length===0){for(Ce=0;Ce<17;++Ce)me.write_shift(4,0);for(Ce=0;Ce<3;++Ce)me.write_shift(4,-1);for(Ce=0;Ce<12;++Ce)me.write_shift(4,0);continue}Oe=ae.FileIndex[ge],ge===0&&(Oe.start=Oe.size?Oe.start-1:X);var Ze=ge===0&&fe.root||Oe.name;if(Re=2*(Ze.length+1),me.write_shift(64,Ze,"utf16le"),me.write_shift(2,Re),me.write_shift(1,Oe.type),me.write_shift(1,Oe.color),me.write_shift(-4,Oe.L),me.write_shift(-4,Oe.R),me.write_shift(-4,Oe.C),Oe.clsid)me.write_shift(16,Oe.clsid,"hex");else for(Ce=0;Ce<4;++Ce)me.write_shift(4,0);me.write_shift(4,Oe.state||0),me.write_shift(4,0),me.write_shift(4,0),me.write_shift(4,0),me.write_shift(4,0),me.write_shift(4,Oe.start),me.write_shift(4,Oe.size),me.write_shift(4,0)}for(ge=1;ge<ae.FileIndex.length;++ge)if(Oe=ae.FileIndex[ge],Oe.size>=4096)if(me.l=Oe.start+1<<9,Ft&&Buffer.isBuffer(Oe.content))Oe.content.copy(me,me.l,0,Oe.size),me.l+=Oe.size+511&-512;else{for(Ce=0;Ce<Oe.size;++Ce)me.write_shift(1,Oe.content[Ce]);for(;Ce&511;++Ce)me.write_shift(1,0)}for(ge=1;ge<ae.FileIndex.length;++ge)if(Oe=ae.FileIndex[ge],Oe.size>0&&Oe.size<4096)if(Ft&&Buffer.isBuffer(Oe.content))Oe.content.copy(me,me.l,0,Oe.size),me.l+=Oe.size+63&-64;else{for(Ce=0;Ce<Oe.size;++Ce)me.write_shift(1,Oe.content[Ce]);for(;Ce&63;++Ce)me.write_shift(1,0)}if(Ft)me.l=me.length;else for(;me.l<me.length;)me.write_shift(1,0);return me}function ce(ae,xe){var fe=ae.FullPaths.map(function(Ce){return Ce.toUpperCase()}),de=fe.map(function(Ce){var Re=Ce.split("/");return Re[Re.length-(Ce.slice(-1)=="/"?2:1)]}),me=!1;xe.charCodeAt(0)===47?(me=!0,xe=fe[0].slice(0,-1)+xe):me=xe.indexOf("/")!==-1;var ge=xe.toUpperCase(),Ae=me===!0?fe.indexOf(ge):de.indexOf(ge);if(Ae!==-1)return ae.FileIndex[Ae];var ze=!ge.match(kh);for(ge=ge.replace(Ss,""),ze&&(ge=ge.replace(kh,"!")),Ae=0;Ae<fe.length;++Ae)if((ze?fe[Ae].replace(kh,"!"):fe[Ae]).replace(Ss,"")==ge||(ze?de[Ae].replace(kh,"!"):de[Ae]).replace(Ss,"")==ge)return ae.FileIndex[Ae];return null}var F=64,X=-2,P="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:P,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ve(ae,xe,fe){f();var de=Z(ae,fe);c.writeFileSync(xe,de)}function oe(ae){for(var xe=new Array(ae.length),fe=0;fe<ae.length;++fe)xe[fe]=String.fromCharCode(ae[fe]);return xe.join("")}function Ee(ae,xe){var fe=Z(ae,xe);switch(xe&&xe.type||"buffer"){case"file":return f(),c.writeFileSync(xe.filename,fe),fe;case"binary":return typeof fe=="string"?fe:oe(fe);case"base64":return u0(typeof fe=="string"?fe:oe(fe));case"buffer":if(Ft)return Buffer.isBuffer(fe)?fe:Bo(fe);case"array":return typeof fe=="string"?sa(fe):fe}return fe}var K;function D(ae){try{var xe=ae.InflateRaw,fe=new xe;if(fe._processChunk(new Uint8Array([3,0]),fe._finishFlushFlag),fe.bytesRead)K=ae;else throw new Error("zlib does not expose bytesRead")}catch(de){console.error("cannot use native zlib: "+(de.message||de))}}function q(ae,xe){if(!K)return mi(ae,xe);var fe=K.InflateRaw,de=new fe,me=de._processChunk(ae.slice(ae.l),de._finishFlushFlag);return ae.l+=de.bytesRead,me}function W(ae){return K?K.deflateRawSync(ae):dt(ae)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function L(ae){var xe=(ae<<1|ae<<11)&139536|(ae<<5|ae<<15)&558144;return(xe>>16|xe>>8|xe)&255}for(var se=typeof Uint8Array<"u",Q=se?new Uint8Array(256):[],ee=0;ee<256;++ee)Q[ee]=L(ee);function B(ae,xe){var fe=Q[ae&255];return xe<=8?fe>>>8-xe:(fe=fe<<8|Q[ae>>8&255],xe<=16?fe>>>16-xe:(fe=fe<<8|Q[ae>>16&255],fe>>>24-xe))}function be(ae,xe){var fe=xe&7,de=xe>>>3;return(ae[de]|(fe<=6?0:ae[de+1]<<8))>>>fe&3}function z(ae,xe){var fe=xe&7,de=xe>>>3;return(ae[de]|(fe<=5?0:ae[de+1]<<8))>>>fe&7}function he(ae,xe){var fe=xe&7,de=xe>>>3;return(ae[de]|(fe<=4?0:ae[de+1]<<8))>>>fe&15}function M(ae,xe){var fe=xe&7,de=xe>>>3;return(ae[de]|(fe<=3?0:ae[de+1]<<8))>>>fe&31}function A(ae,xe){var fe=xe&7,de=xe>>>3;return(ae[de]|(fe<=1?0:ae[de+1]<<8))>>>fe&127}function j(ae,xe,fe){var de=xe&7,me=xe>>>3,ge=(1<<fe)-1,Ae=ae[me]>>>de;return fe<8-de||(Ae|=ae[me+1]<<8-de,fe<16-de)||(Ae|=ae[me+2]<<16-de,fe<24-de)||(Ae|=ae[me+3]<<24-de),Ae&ge}function H(ae,xe,fe){var de=xe&7,me=xe>>>3;return de<=5?ae[me]|=(fe&7)<<de:(ae[me]|=fe<<de&255,ae[me+1]=(fe&7)>>8-de),xe+3}function ue(ae,xe,fe){var de=xe&7,me=xe>>>3;return fe=(fe&1)<<de,ae[me]|=fe,xe+1}function ye(ae,xe,fe){var de=xe&7,me=xe>>>3;return fe<<=de,ae[me]|=fe&255,fe>>>=8,ae[me+1]=fe,xe+8}function pe(ae,xe,fe){var de=xe&7,me=xe>>>3;return fe<<=de,ae[me]|=fe&255,fe>>>=8,ae[me+1]=fe&255,ae[me+2]=fe>>>8,xe+16}function Ne(ae,xe){var fe=ae.length,de=2*fe>xe?2*fe:xe+5,me=0;if(fe>=xe)return ae;if(Ft){var ge=A3(de);if(ae.copy)ae.copy(ge);else for(;me<ae.length;++me)ge[me]=ae[me];return ge}else if(se){var Ae=new Uint8Array(de);if(Ae.set)Ae.set(ae);else for(;me<fe;++me)Ae[me]=ae[me];return Ae}return ae.length=de,ae}function De(ae){for(var xe=new Array(ae),fe=0;fe<ae;++fe)xe[fe]=0;return xe}function Fe(ae,xe,fe){var de=1,me=0,ge=0,Ae=0,ze=0,Ce=ae.length,Re=se?new Uint16Array(32):De(32);for(ge=0;ge<32;++ge)Re[ge]=0;for(ge=Ce;ge<fe;++ge)ae[ge]=0;Ce=ae.length;var Oe=se?new Uint16Array(Ce):De(Ce);for(ge=0;ge<Ce;++ge)Re[me=ae[ge]]++,de<me&&(de=me),Oe[ge]=0;for(Re[0]=0,ge=1;ge<=de;++ge)Re[ge+16]=ze=ze+Re[ge-1]<<1;for(ge=0;ge<Ce;++ge)ze=ae[ge],ze!=0&&(Oe[ge]=Re[ze+16]++);var Xe=0;for(ge=0;ge<Ce;++ge)if(Xe=ae[ge],Xe!=0)for(ze=B(Oe[ge],de)>>de-Xe,Ae=(1<<de+4-Xe)-1;Ae>=0;--Ae)xe[ze|Ae<<Xe]=Xe&15|ge<<4;return de}var Ke=se?new Uint16Array(512):De(512),st=se?new Uint16Array(32):De(32);if(!se){for(var at=0;at<512;++at)Ke[at]=0;for(at=0;at<32;++at)st[at]=0}(function(){for(var ae=[],xe=0;xe<32;xe++)ae.push(5);Fe(ae,st,32);var fe=[];for(xe=0;xe<=143;xe++)fe.push(8);for(;xe<=255;xe++)fe.push(9);for(;xe<=279;xe++)fe.push(7);for(;xe<=287;xe++)fe.push(8);Fe(fe,Ke,288)})();var Gt=(function(){for(var xe=se?new Uint8Array(32768):[],fe=0,de=0;fe<U.length-1;++fe)for(;de<U[fe+1];++de)xe[de]=fe;for(;de<32768;++de)xe[de]=29;var me=se?new Uint8Array(259):[];for(fe=0,de=0;fe<re.length-1;++fe)for(;de<re[fe+1];++de)me[de]=fe;function ge(ze,Ce){for(var Re=0;Re<ze.length;){var Oe=Math.min(65535,ze.length-Re),Xe=Re+Oe==ze.length;for(Ce.write_shift(1,+Xe),Ce.write_shift(2,Oe),Ce.write_shift(2,~Oe&65535);Oe-- >0;)Ce[Ce.l++]=ze[Re++]}return Ce.l}function Ae(ze,Ce){for(var Re=0,Oe=0,Xe=se?new Uint16Array(32768):[];Oe<ze.length;){var Ze=Math.min(65535,ze.length-Oe);if(Ze<10){for(Re=H(Ce,Re,+(Oe+Ze==ze.length)),Re&7&&(Re+=8-(Re&7)),Ce.l=Re/8|0,Ce.write_shift(2,Ze),Ce.write_shift(2,~Ze&65535);Ze-- >0;)Ce[Ce.l++]=ze[Oe++];Re=Ce.l*8;continue}Re=H(Ce,Re,+(Oe+Ze==ze.length)+2);for(var nt=0;Ze-- >0;){var Ye=ze[Oe];nt=(nt<<5^Ye)&32767;var tt=-1,ct=0;if((tt=Xe[nt])&&(tt|=Oe&-32768,tt>Oe&&(tt-=32768),tt<Oe))for(;ze[tt+ct]==ze[Oe+ct]&&ct<250;)++ct;if(ct>2){Ye=me[ct],Ye<=22?Re=ye(Ce,Re,Q[Ye+1]>>1)-1:(ye(Ce,Re,3),Re+=5,ye(Ce,Re,Q[Ye-23]>>5),Re+=3);var yr=Ye<8?0:Ye-4>>2;yr>0&&(pe(Ce,Re,ct-re[Ye]),Re+=yr),Ye=xe[Oe-tt],Re=ye(Ce,Re,Q[Ye]>>3),Re-=3;var vr=Ye<4?0:Ye-2>>1;vr>0&&(pe(Ce,Re,Oe-tt-U[Ye]),Re+=vr);for(var Ar=0;Ar<ct;++Ar)Xe[nt]=Oe&32767,nt=(nt<<5^ze[Oe])&32767,++Oe;Ze-=ct-1}else Ye<=143?Ye=Ye+48:Re=ue(Ce,Re,1),Re=ye(Ce,Re,Q[Ye]),Xe[nt]=Oe&32767,++Oe}Re=ye(Ce,Re,0)-1}return Ce.l=(Re+7)/8|0,Ce.l}return function(Ce,Re){return Ce.length<8?ge(Ce,Re):Ae(Ce,Re)}})();function dt(ae){var xe=Le(50+Math.floor(ae.length*1.1)),fe=Gt(ae,xe);return xe.slice(0,fe)}var Lt=se?new Uint16Array(32768):De(32768),pr=se?new Uint16Array(32768):De(32768),vt=se?new Uint16Array(128):De(128),or=1,Tn=1;function lr(ae,xe){var fe=M(ae,xe)+257;xe+=5;var de=M(ae,xe)+1;xe+=5;var me=he(ae,xe)+4;xe+=4;for(var ge=0,Ae=se?new Uint8Array(19):De(19),ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ce=1,Re=se?new Uint8Array(8):De(8),Oe=se?new Uint8Array(8):De(8),Xe=Ae.length,Ze=0;Ze<me;++Ze)Ae[J[Ze]]=ge=z(ae,xe),Ce<ge&&(Ce=ge),Re[ge]++,xe+=3;var nt=0;for(Re[0]=0,Ze=1;Ze<=Ce;++Ze)Oe[Ze]=nt=nt+Re[Ze-1]<<1;for(Ze=0;Ze<Xe;++Ze)(nt=Ae[Ze])!=0&&(ze[Ze]=Oe[nt]++);var Ye=0;for(Ze=0;Ze<Xe;++Ze)if(Ye=Ae[Ze],Ye!=0){nt=Q[ze[Ze]]>>8-Ye;for(var tt=(1<<7-Ye)-1;tt>=0;--tt)vt[nt|tt<<Ye]=Ye&7|Ze<<3}var ct=[];for(Ce=1;ct.length<fe+de;)switch(nt=vt[A(ae,xe)],xe+=nt&7,nt>>>=3){case 16:for(ge=3+be(ae,xe),xe+=2,nt=ct[ct.length-1];ge-- >0;)ct.push(nt);break;case 17:for(ge=3+z(ae,xe),xe+=3;ge-- >0;)ct.push(0);break;case 18:for(ge=11+A(ae,xe),xe+=7;ge-- >0;)ct.push(0);break;default:ct.push(nt),Ce<nt&&(Ce=nt);break}var yr=ct.slice(0,fe),vr=ct.slice(fe);for(Ze=fe;Ze<286;++Ze)yr[Ze]=0;for(Ze=de;Ze<30;++Ze)vr[Ze]=0;return or=Fe(yr,Lt,286),Tn=Fe(vr,pr,30),xe}function qo(ae,xe){if(ae[0]==3&&!(ae[1]&3))return[Bl(xe),2];for(var fe=0,de=0,me=A3(xe||1<<18),ge=0,Ae=me.length>>>0,ze=0,Ce=0;(de&1)==0;){if(de=z(ae,fe),fe+=3,de>>>1)de>>1==1?(ze=9,Ce=5):(fe=lr(ae,fe),ze=or,Ce=Tn);else{fe&7&&(fe+=8-(fe&7));var Re=ae[fe>>>3]|ae[(fe>>>3)+1]<<8;if(fe+=32,Re>0)for(!xe&&Ae<ge+Re&&(me=Ne(me,ge+Re),Ae=me.length);Re-- >0;)me[ge++]=ae[fe>>>3],fe+=8;continue}for(;;){!xe&&Ae<ge+32767&&(me=Ne(me,ge+32767),Ae=me.length);var Oe=j(ae,fe,ze),Xe=de>>>1==1?Ke[Oe]:Lt[Oe];if(fe+=Xe&15,Xe>>>=4,(Xe>>>8&255)===0)me[ge++]=Xe;else{if(Xe==256)break;Xe-=257;var Ze=Xe<8?0:Xe-4>>2;Ze>5&&(Ze=0);var nt=ge+re[Xe];Ze>0&&(nt+=j(ae,fe,Ze),fe+=Ze),Oe=j(ae,fe,Ce),Xe=de>>>1==1?st[Oe]:pr[Oe],fe+=Xe&15,Xe>>>=4;var Ye=Xe<4?0:Xe-2>>1,tt=U[Xe];for(Ye>0&&(tt+=j(ae,fe,Ye),fe+=Ye),!xe&&Ae<nt&&(me=Ne(me,nt+100),Ae=me.length);ge<nt;)me[ge]=me[ge-tt],++ge}}}return xe?[me,fe+7>>>3]:[me.slice(0,ge),fe+7>>>3]}function mi(ae,xe){var fe=ae.slice(ae.l||0),de=qo(fe,xe);return ae.l+=de[1],de[0]}function xs(ae,xe){if(ae)typeof console<"u"&&console.error(xe);else throw new Error(xe)}function Ya(ae,xe){var fe=ae;$n(fe,0);var de=[],me=[],ge={FileIndex:de,FullPaths:me};R(ge,{root:xe.root});for(var Ae=fe.length-4;(fe[Ae]!=80||fe[Ae+1]!=75||fe[Ae+2]!=5||fe[Ae+3]!=6)&&Ae>=0;)--Ae;fe.l=Ae+4,fe.l+=4;var ze=fe.read_shift(2);fe.l+=6;var Ce=fe.read_shift(4);for(fe.l=Ce,Ae=0;Ae<ze;++Ae){fe.l+=20;var Re=fe.read_shift(4),Oe=fe.read_shift(4),Xe=fe.read_shift(2),Ze=fe.read_shift(2),nt=fe.read_shift(2);fe.l+=8;var Ye=fe.read_shift(4),tt=o(fe.slice(fe.l+Xe,fe.l+Xe+Ze));fe.l+=Xe+Ze+nt;var ct=fe.l;fe.l=Ye+4,Ja(fe,Re,Oe,ge,tt),fe.l=ct}return ge}function Ja(ae,xe,fe,de,me){ae.l+=2;var ge=ae.read_shift(2),Ae=ae.read_shift(2),ze=i(ae);if(ge&8257)throw new Error("Unsupported ZIP encryption");for(var Ce=ae.read_shift(4),Re=ae.read_shift(4),Oe=ae.read_shift(4),Xe=ae.read_shift(2),Ze=ae.read_shift(2),nt="",Ye=0;Ye<Xe;++Ye)nt+=String.fromCharCode(ae[ae.l++]);if(Ze){var tt=o(ae.slice(ae.l,ae.l+Ze));(tt[21589]||{}).mt&&(ze=tt[21589].mt),((me||{})[21589]||{}).mt&&(ze=me[21589].mt)}ae.l+=Ze;var ct=ae.slice(ae.l,ae.l+Re);switch(Ae){case 8:ct=q(ae,Oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ae)}var yr=!1;ge&8&&(Ce=ae.read_shift(4),Ce==134695760&&(Ce=ae.read_shift(4),yr=!0),Re=ae.read_shift(4),Oe=ae.read_shift(4)),Re!=xe&&xs(yr,"Bad compressed size: "+xe+" != "+Re),Oe!=fe&&xs(yr,"Bad uncompressed size: "+fe+" != "+Oe),An(de,nt,ct,{unsafe:!0,mt:ze})}function gs(ae,xe){var fe=xe||{},de=[],me=[],ge=Le(1),Ae=fe.compression?8:0,ze=0,Ce=0,Re=0,Oe=0,Xe=0,Ze=ae.FullPaths[0],nt=Ze,Ye=ae.FileIndex[0],tt=[],ct=0;for(Ce=1;Ce<ae.FullPaths.length;++Ce)if(nt=ae.FullPaths[Ce].slice(Ze.length),Ye=ae.FileIndex[Ce],!(!Ye.size||!Ye.content||nt=="Sh33tJ5")){var yr=Oe,vr=Le(nt.length);for(Re=0;Re<nt.length;++Re)vr.write_shift(1,nt.charCodeAt(Re)&127);vr=vr.slice(0,vr.l),tt[Xe]=ZJ.buf(Ye.content,0);var Ar=Ye.content;Ae==8&&(Ar=W(Ar)),ge=Le(30),ge.write_shift(4,67324752),ge.write_shift(2,20),ge.write_shift(2,ze),ge.write_shift(2,Ae),Ye.mt?a(ge,Ye.mt):ge.write_shift(4,0),ge.write_shift(-4,tt[Xe]),ge.write_shift(4,Ar.length),ge.write_shift(4,Ye.content.length),ge.write_shift(2,vr.length),ge.write_shift(2,0),Oe+=ge.length,de.push(ge),Oe+=vr.length,de.push(vr),Oe+=Ar.length,de.push(Ar),ge=Le(46),ge.write_shift(4,33639248),ge.write_shift(2,0),ge.write_shift(2,20),ge.write_shift(2,ze),ge.write_shift(2,Ae),ge.write_shift(4,0),ge.write_shift(-4,tt[Xe]),ge.write_shift(4,Ar.length),ge.write_shift(4,Ye.content.length),ge.write_shift(2,vr.length),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(4,0),ge.write_shift(4,yr),ct+=ge.l,me.push(ge),ct+=vr.length,me.push(vr),++Xe}return ge=Le(22),ge.write_shift(4,101010256),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,Xe),ge.write_shift(2,Xe),ge.write_shift(4,ct),ge.write_shift(4,Oe),ge.write_shift(2,0),Dn([Dn(de),Dn(me),ge])}var nn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wt(ae,xe){if(ae.ctype)return ae.ctype;var fe=ae.name||"",de=fe.match(/\.([^\.]+)$/);return de&&nn[de[1]]||xe&&(de=(fe=xe).match(/[\.\\]([^\.\\])+$/),de&&nn[de[1]])?nn[de[1]]:"application/octet-stream"}function gr(ae){for(var xe=u0(ae),fe=[],de=0;de<xe.length;de+=76)fe.push(xe.slice(de,de+76));return fe.join(`\r
`)+`\r
`}function sn(ae){var xe=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Re){var Oe=Re.charCodeAt(0).toString(16).toUpperCase();return"="+(Oe.length==1?"0"+Oe:Oe)});xe=xe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),xe.charAt(0)==`
`&&(xe="=0D"+xe.slice(1)),xe=xe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var fe=[],de=xe.split(`\r
`),me=0;me<de.length;++me){var ge=de[me];if(ge.length==0){fe.push("");continue}for(var Ae=0;Ae<ge.length;){var ze=76,Ce=ge.slice(Ae,Ae+ze);Ce.charAt(ze-1)=="="?ze--:Ce.charAt(ze-2)=="="?ze-=2:Ce.charAt(ze-3)=="="&&(ze-=3),Ce=ge.slice(Ae,Ae+ze),Ae+=ze,Ae<ge.length&&(Ce+="="),fe.push(Ce)}}return fe.join(`\r
`)}function kn(ae){for(var xe=[],fe=0;fe<ae.length;++fe){for(var de=ae[fe];fe<=ae.length&&de.charAt(de.length-1)=="=";)de=de.slice(0,de.length-1)+ae[++fe];xe.push(de)}for(var me=0;me<xe.length;++me)xe[me]=xe[me].replace(/[=][0-9A-Fa-f]{2}/g,function(ge){return String.fromCharCode(parseInt(ge.slice(1),16))});return sa(xe.join(`\r
`))}function xi(ae,xe,fe){for(var de="",me="",ge="",Ae,ze=0;ze<10;++ze){var Ce=xe[ze];if(!Ce||Ce.match(/^\s*$/))break;var Re=Ce.match(/^(.*?):\s*([^\s].*)$/);if(Re)switch(Re[1].toLowerCase()){case"content-location":de=Re[2].trim();break;case"content-type":ge=Re[2].trim();break;case"content-transfer-encoding":me=Re[2].trim();break}}switch(++ze,me.toLowerCase()){case"base64":Ae=sa(ca(xe.slice(ze).join("")));break;case"quoted-printable":Ae=kn(xe.slice(ze));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+me)}var Oe=An(ae,de.slice(fe.length),Ae,{unsafe:!0});ge&&(Oe.ctype=ge)}function br(ae,xe){if(oe(ae.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var fe=xe&&xe.root||"",de=(Ft&&Buffer.isBuffer(ae)?ae.toString("binary"):oe(ae)).split(`\r
`),me=0,ge="";for(me=0;me<de.length;++me)if(ge=de[me],!!/^Content-Location:/i.test(ge)&&(ge=ge.slice(ge.indexOf("file")),fe||(fe=ge.slice(0,ge.lastIndexOf("/")+1)),ge.slice(0,fe.length)!=fe))for(;fe.length>0&&(fe=fe.slice(0,fe.length-1),fe=fe.slice(0,fe.lastIndexOf("/")+1),ge.slice(0,fe.length)!=fe););var Ae=(de[1]||"").match(/boundary="(.*?)"/);if(!Ae)throw new Error("MAD cannot find boundary");var ze="--"+(Ae[1]||""),Ce=[],Re=[],Oe={FileIndex:Ce,FullPaths:Re};R(Oe);var Xe,Ze=0;for(me=0;me<de.length;++me){var nt=de[me];nt!==ze&&nt!==ze+"--"||(Ze++&&xi(Oe,de.slice(Xe,me),fe),Xe=me)}return Oe}function Qn(ae,xe){var fe=xe||{},de=fe.boundary||"SheetJS";de="------="+de;for(var me=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+de.slice(2)+'"',"","",""],ge=ae.FullPaths[0],Ae=ge,ze=ae.FileIndex[0],Ce=1;Ce<ae.FullPaths.length;++Ce)if(Ae=ae.FullPaths[Ce].slice(ge.length),ze=ae.FileIndex[Ce],!(!ze.size||!ze.content||Ae=="Sh33tJ5")){Ae=Ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var Re=ze.content,Oe=Ft&&Buffer.isBuffer(Re)?Re.toString("binary"):oe(Re),Xe=0,Ze=Math.min(1024,Oe.length),nt=0,Ye=0;Ye<=Ze;++Ye)(nt=Oe.charCodeAt(Ye))>=32&&nt<128&&++Xe;var tt=Xe>=Ze*4/5;me.push(de),me.push("Content-Location: "+(fe.root||"file:///C:/SheetJS/")+Ae),me.push("Content-Transfer-Encoding: "+(tt?"quoted-printable":"base64")),me.push("Content-Type: "+wt(ze,Ae)),me.push(""),me.push(tt?sn(Oe):gr(Oe))}return me.push(de+`--\r
`),me.join(`\r
`)}function Gi(ae){var xe={};return R(xe,ae),xe}function An(ae,xe,fe,de){var me=de&&de.unsafe;me||R(ae);var ge=!me&&mt.find(ae,xe);if(!ge){var Ae=ae.FullPaths[0];xe.slice(0,Ae.length)==Ae?Ae=xe:(Ae.slice(-1)!="/"&&(Ae+="/"),Ae=(Ae+xe).replace("//","/")),ge={name:s(xe),type:2},ae.FileIndex.push(ge),ae.FullPaths.push(Ae),me||mt.utils.cfb_gc(ae)}return ge.content=fe,ge.size=fe?fe.length:0,de&&(de.CLSID&&(ge.clsid=de.CLSID),de.mt&&(ge.mt=de.mt),de.ct&&(ge.ct=de.ct)),ge}function es(ae,xe){R(ae);var fe=mt.find(ae,xe);if(fe){for(var de=0;de<ae.FileIndex.length;++de)if(ae.FileIndex[de]==fe)return ae.FileIndex.splice(de,1),ae.FullPaths.splice(de,1),!0}return!1}function Wo(ae,xe,fe){R(ae);var de=mt.find(ae,xe);if(de){for(var me=0;me<ae.FileIndex.length;++me)if(ae.FileIndex[me]==de)return ae.FileIndex[me].name=s(fe),ae.FullPaths[me]=fe,!0}return!1}function $s(ae){I(ae,!0)}return t.find=ce,t.read=O,t.parse=h,t.write=Ee,t.writeFile=ve,t.utils={cfb_new:Gi,cfb_add:An,cfb_del:es,cfb_mov:Wo,cfb_gc:$s,ReadShift:Fh,CheckField:rI,prep_blob:$n,bconcat:Dn,use_zlib:D,_deflateRaw:dt,_inflateRaw:mi,consts:Y},t})();function QJ(e){return typeof e=="string"?b1(e):Array.isArray(e)?NJ(e):e}function Q0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=b1(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Fi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([QJ(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=$l(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function eZ(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Wr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function F3(e,t){for(var r=[],n=Wr(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function _1(e){for(var t=[],r=Wr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function E1(e){for(var t=[],r=Wr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function tZ(e){for(var t=[],r=Wr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var eg=new Date(1899,11,30,0,0,0);function _n(e,t){var r=e.getTime(),n=eg.getTime()+(e.getTimezoneOffset()-eg.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var MD=new Date,rZ=eg.getTime()+(MD.getTimezoneOffset()-eg.getTimezoneOffset())*6e4,P3=MD.getTimezoneOffset();function S1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+rZ),t.getTimezoneOffset()!==P3&&t.setTime(t.getTime()+(t.getTimezoneOffset()-P3)*6e4),t}function nZ(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var L3=new Date("2017-02-19T19:06:09.000Z"),FD=isNaN(L3.getFullYear())?new Date("2/19/17"):L3,sZ=FD.getFullYear()==2017;function Tr(e,t){var r=new Date(e);if(sZ)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(FD.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Jc(e,t){if(Ft&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Fi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Fi(ED(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Fi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Fi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function kr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=kr(e[r]));return t}function Hr(e,t){for(var r="";r.length<t;)r+=e;return r}function li(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var aZ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Mf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&aZ.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var iZ=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}})();function PD(e){return e?e.content&&e.type?Jc(e.content,!0):e.data?Th(e.data):e.asNodeBuffer&&Ft?Th(e.asNodeBuffer().toString("binary")):e.asBinary?Th(e.asBinary()):e._data&&e._data.getContent?Th(Jc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function LD(e){if(!e)return null;if(e.data)return T3(e.data);if(e.asNodeBuffer&&Ft)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?T3(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function oZ(e){return e&&e.name.slice(-4)===".bin"?LD(e):PD(e)}function ja(e,t){for(var r=e.FullPaths||Wr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function aS(e,t){var r=ja(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function pn(e,t,r){if(!r)return oZ(aS(e,t));if(!t)return null;try{return pn(e,t)}catch{return null}}function aa(e,t,r){if(!r)return PD(aS(e,t));if(!t)return null;try{return aa(e,t)}catch{return null}}function lZ(e,t,r){return LD(aS(e,t))}function B3(e){for(var t=e.FullPaths||Wr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function jt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ft?n=Bo(r):n=TJ(r),mt.utils.cfb_add(e,t,n)}mt.utils.cfb_add(e,t,r)}else e.file(t,r)}function iS(){return mt.utils.cfb_new()}function BD(e,t){switch(t.type){case"base64":return mt.read(e,{type:"base64"});case"binary":return mt.read(e,{type:"binary"});case"buffer":case"array":return mt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ah(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Qr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,cZ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,U3=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,uZ=/<[^>]*>/g,ps=Qr.match(U3)?U3:uZ,fZ=/<\w*:/,dZ=/<(\/?)\w+:/;function _t(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(cZ),o=0,c="",f=0,h="",p="",x=1;if(i)for(f=0;f!=i.length;++f){for(p=i[f],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(h=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(x=(s=p.charCodeAt(a+1))==34||s==39?1:0,c=p.slice(a+1+x,p.length-x),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var g=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[g]&&h.slice(o-3,o)=="ext")continue;n[g]=c,n[g.toLowerCase()]=c}}return n}function qi(e){return e.replace(dZ,"<$1")}var UD={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},oS=_1(UD),Wt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return UD[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),lS=/[&<>'"]/g,hZ=/[\u0000-\u0008\u000b-\u001f]/g;function sr(e){var t=e+"";return t.replace(lS,function(r){return oS[r]}).replace(hZ,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function z3(e){return sr(e).replace(/ /g,"_x0020_")}var zD=/[\u0000-\u001f]/g;function cS(e){var t=e+"";return t.replace(lS,function(r){return oS[r]}).replace(/\n/g,"<br/>").replace(zD,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function pZ(e){var t=e+"";return t.replace(lS,function(r){return oS[r]}).replace(zD,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var H3=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function mZ(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Nr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Nb(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function V3(e){var t=Bl(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function q3(e){return Bo(e,"binary").toString("utf8")}var Um="foo bar baz",hr=Ft&&(q3(Um)==Nb(Um)&&q3||V3(Um)==Nb(Um)&&V3)||Nb,Fi=Ft?function(e){return Bo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},d0=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),HD=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),xZ=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),gZ=/<\/?(?:vt:)?variant>/g,yZ=/<(?:vt:)([^>]*)>([\s\S]*)</;function W3(e,t){var r=_t(e),n=e.match(xZ(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(gZ,"").match(yZ);i&&s.push({v:hr(i[2]),t:i[1]})}),s}var VD=/(^\s|\s$|\n)/;function Xn(e,t){return"<"+e+(t.match(VD)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function h0(e){return Wr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Qe(e,t,r){return"<"+e+(r!=null?h0(r):"")+(t!=null?(t.match(VD)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function T_(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function vZ(e,t){switch(typeof e){case"string":var r=Qe("vt:lpwstr",sr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Qe((e|0)==e?"vt:i4":"vt:r8",sr(String(e)));case"boolean":return Qe("vt:bool",e?"true":"false")}if(e instanceof Date)return Qe("vt:filetime",T_(e));throw new Error("Unable to serialize "+e)}function uS(e){if(Ft&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return hr($l(rS(e)));throw new Error("Bad input format: expected Buffer or string")}var p0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,bn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},cu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ra={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bZ(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function wZ(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var $3=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},G3=Ft?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Bo(t)})):$3(e)}:$3,K3=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(So(e,s)));return n.join("").replace(Ss,"")},fS=Ft?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ss,""):K3(e,t,r)}:K3,X3=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},qD=Ft?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):X3(e,t,r)}:X3,Y3=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(of(e,s)));return n.join("")},ep=Ft?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Y3(t,r,n)}:Y3,WD=function(e,t){var r=na(e,t);return r>0?ep(e,t+4,t+4+r-1):""},$D=WD,GD=function(e,t){var r=na(e,t);return r>0?ep(e,t+4,t+4+r-1):""},KD=GD,XD=function(e,t){var r=2*na(e,t);return r>0?ep(e,t+4,t+4+r-1):""},YD=XD,JD=function(t,r){var n=na(t,r);return n>0?fS(t,r+4,r+4+n):""},ZD=JD,QD=function(e,t){var r=na(e,t);return r>0?ep(e,t+4,t+4+r):""},eI=QD,tI=function(e,t){return bZ(e,t)},tg=tI,dS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ft&&($D=function(t,r){if(!Buffer.isBuffer(t))return WD(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},KD=function(t,r){if(!Buffer.isBuffer(t))return GD(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},YD=function(t,r){if(!Buffer.isBuffer(t))return XD(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},ZD=function(t,r){if(!Buffer.isBuffer(t))return JD(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},eI=function(t,r){if(!Buffer.isBuffer(t))return QD(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},tg=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):tI(t,r)},dS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var of=function(e,t){return e[t]},So=function(e,t){return e[t+1]*256+e[t]},_Z=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},na=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},wc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},EZ=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Fh(e,t){var r="",n,s,a=[],i,o,c,f;switch(t){case"dbcs":if(f=this.l,Ft&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(So(this,f)),f+=2;e*=2;break;case"utf8":r=ep(this,this.l,this.l+e);break;case"utf16le":e*=2,r=fS(this,this.l,this.l+e);break;case"wstr":return Fh.call(this,e,"dbcs");case"lpstr-ansi":r=$D(this,this.l),e=4+na(this,this.l);break;case"lpstr-cp":r=KD(this,this.l),e=4+na(this,this.l);break;case"lpwstr":r=YD(this,this.l),e=4+2*na(this,this.l);break;case"lpp4":e=4+na(this,this.l),r=ZD(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+na(this,this.l),r=eI(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=of(this,this.l+e++))!==0;)a.push(Bm(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=So(this,this.l+e))!==0;)a.push(Bm(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return i=of(this,f),this.l=f+1,o=Fh.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Bm(So(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return i=of(this,f),this.l=f+1,o=Fh.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Bm(of(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=of(this,this.l),this.l++,n;case 2:return n=(t==="i"?_Z:So)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?wc:EZ)(this,this.l),this.l+=4,n):(s=na(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=tg(this,this.l):s=tg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=qD(this,this.l,e);break}}return this.l+=e,r}var SZ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},NZ=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},TZ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function kZ(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)TZ(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,SZ(this,t,this.l);break;case 8:if(n=8,r==="f"){wZ(this,t,this.l);break}case 16:break;case-4:n=4,NZ(this,t,this.l);break}return this.l+=n,this}function rI(e,t){var r=qD(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function $n(e,t){e.l=t,e.read_shift=Fh,e.chk=rI,e.write_shift=kZ}function ds(e,t){e.l+=t}function Le(e){var t=Bl(e);return $n(t,0),t}function Uo(e,t,r){if(e){var n,s,a;$n(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=b0[o]||b0[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var h=f.f&&f.f(e,a,r);if(e.l=c,t(h,f,o))return}}}function Us(){var e=[],t=Ft?256:2048,r=function(f){var h=Le(f);return $n(h,0),h},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(s(),n=r(Math.max(f+1,t)))},i=function(){return s(),Dn(e)},o=function(f){s(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function qe(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=b0[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&dS(r)&&e.push(r)}}function Ph(e,t,r){var n=kr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function J3(e,t,r){var n=kr(e);return n.s=Ph(n.s,t.s,r),n.e=Ph(n.e,t.s,r),n}function Lh(e,t){if(e.cRel&&e.c<0)for(e=kr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=kr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=bt(e);return!e.cRel&&e.cRel!=null&&(r=RZ(r)),!e.rRel&&e.rRel!=null&&(r=AZ(r)),r}function Tb(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dr(e.s.c)+":"+(e.e.cRel?"":"$")+Dr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Jr(e.s.r)+":"+(e.e.rRel?"":"$")+Jr(e.e.r):Lh(e.s,t.biff)+":"+Lh(e.e,t.biff)}function hS(e){return parseInt(CZ(e),10)-1}function Jr(e){return""+(e+1)}function AZ(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function CZ(e){return e.replace(/\$(\d+)$/,"$1")}function pS(e){for(var t=jZ(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Dr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function RZ(e){return e.replace(/^([A-Z])/,"$$$1")}function jZ(e){return e.replace(/^\$([A-Z])/,"$1")}function OZ(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ir(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function bt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Vs(e){var t=e.indexOf(":");return t==-1?{s:Ir(e),e:Ir(e)}:{s:Ir(e.slice(0,t)),e:Ir(e.slice(t+1))}}function Ct(e,t){return typeof t>"u"||typeof t=="number"?Ct(e.s,e.e):(typeof e!="string"&&(e=bt(e)),typeof t!="string"&&(t=bt(t)),e==t?e:e+":"+t)}function $t(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function Z3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=qa(e.z,r?_n(t):t)}catch{}try{return e.w=qa((e.XF||{}).numFmtId||(r?14:0),r?_n(t):t)}catch{return""+t}}function Po(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?zo[e.v]||e.v:t==null?Z3(e,e.v):Z3(e,t))}function Gl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function nI(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Ir(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var h=$t(a["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),i==-1&&(f.e.r=i=h.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[p].length;++x)if(!(typeof t[p][x]>"u")){var g={v:t[p][x]},v=i+p,y=o+x;if(f.s.r>v&&(f.s.r=v),f.s.c>y&&(f.s.c=y),f.e.r<v&&(f.e.r=v),f.e.c<y&&(f.e.c=y),t[p][x]&&typeof t[p][x]=="object"&&!Array.isArray(t[p][x])&&!(t[p][x]instanceof Date))g=t[p][x];else if(Array.isArray(g.v)&&(g.f=t[p][x][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||yt[14],n.cellDates?(g.t="d",g.w=qa(g.z,_n(g.v))):(g.t="n",g.v=_n(g.v),g.w=qa(g.z,g.v))):g.t="s";if(s)a[v]||(a[v]=[]),a[v][y]&&a[v][y].z&&(g.z=a[v][y].z),a[v][y]=g;else{var w=bt({c:y,r:v});a[w]&&a[w].z&&(g.z=a[w].z),a[w]=g}}}return f.s.c<1e7&&(a["!ref"]=Ct(f)),a}function pd(e,t){return nI(null,e,t)}function DZ(e){return e.read_shift(4,"i")}function ci(e,t){return t||(t=Le(4)),t.write_shift(4,e),t}function fs(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Mn(e,t){var r=!1;return t==null&&(r=!0,t=Le(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function IZ(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function MZ(e,t){return t||(t=Le(4)),t.write_shift(2,0),t.write_shift(2,0),t}function mS(e,t){var r=e.l,n=e.read_shift(1),s=fs(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(IZ(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function FZ(e,t){var r=!1;return t==null&&(r=!0,t=Le(15+4*e.t.length)),t.write_shift(1,0),Mn(e.t,t),r?t.slice(0,t.l):t}var PZ=mS;function LZ(e,t){var r=!1;return t==null&&(r=!0,t=Le(23+4*e.t.length)),t.write_shift(1,1),Mn(e.t,t),t.write_shift(4,1),MZ({},t),r?t.slice(0,t.l):t}function Xa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function uu(e,t){return t==null&&(t=Le(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function fu(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function du(e,t){return t==null&&(t=Le(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var BZ=fs,sI=Mn;function xS(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function rg(e,t){var r=!1;return t==null&&(r=!0,t=Le(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var UZ=fs,k_=xS,gS=rg;function yS(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?tg([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):wc(t,0)>>2;return r?s/100:s}function aI(e,t){t==null&&(t=Le(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function iI(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function zZ(e,t){return t||(t=Le(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var hu=iI,md=zZ;function cs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zc(e,t){return(t||Le(8)).write_shift(8,e,"f")}function HZ(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var f=Mc[s];f&&(t.rgb=x0(f));break;case 2:t.rgb=x0([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function ng(e,t){if(t||(t=Le(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function VZ(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function qZ(e,t){t||(t=Le(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function oI(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function WZ(e){return oI(e,1)}function $Z(e){return oI(e,2)}var vS=2,Fs=3,zm=11,Q3=12,sg=19,Hm=64,GZ=65,KZ=71,XZ=4108,YZ=4126,jn=80,lI=81,JZ=[jn,lI],A_={1:{n:"CodePage",t:vS},2:{n:"Category",t:jn},3:{n:"PresentationFormat",t:jn},4:{n:"ByteCount",t:Fs},5:{n:"LineCount",t:Fs},6:{n:"ParagraphCount",t:Fs},7:{n:"SlideCount",t:Fs},8:{n:"NoteCount",t:Fs},9:{n:"HiddenCount",t:Fs},10:{n:"MultimediaClipCount",t:Fs},11:{n:"ScaleCrop",t:zm},12:{n:"HeadingPairs",t:XZ},13:{n:"TitlesOfParts",t:YZ},14:{n:"Manager",t:jn},15:{n:"Company",t:jn},16:{n:"LinksUpToDate",t:zm},17:{n:"CharacterCount",t:Fs},19:{n:"SharedDoc",t:zm},22:{n:"HyperlinksChanged",t:zm},23:{n:"AppVersion",t:Fs,p:"version"},24:{n:"DigSig",t:GZ},26:{n:"ContentType",t:jn},27:{n:"ContentStatus",t:jn},28:{n:"Language",t:jn},29:{n:"Version",t:jn},255:{},2147483648:{n:"Locale",t:sg},2147483651:{n:"Behavior",t:sg},1919054434:{}},C_={1:{n:"CodePage",t:vS},2:{n:"Title",t:jn},3:{n:"Subject",t:jn},4:{n:"Author",t:jn},5:{n:"Keywords",t:jn},6:{n:"Comments",t:jn},7:{n:"Template",t:jn},8:{n:"LastAuthor",t:jn},9:{n:"RevNumber",t:jn},10:{n:"EditTime",t:Hm},11:{n:"LastPrinted",t:Hm},12:{n:"CreatedDate",t:Hm},13:{n:"ModifiedDate",t:Hm},14:{n:"PageCount",t:Fs},15:{n:"WordCount",t:Fs},16:{n:"CharCount",t:Fs},17:{n:"Thumbnail",t:KZ},18:{n:"Application",t:jn},19:{n:"DocSecurity",t:Fs},255:{},2147483648:{n:"Locale",t:sg},2147483651:{n:"Behavior",t:sg},1919054434:{}},e5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ZZ=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function QZ(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var eQ=QZ([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Mc=kr(eQ),zo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},cI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},R_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Vm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function bS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function tQ(e){var t=bS();if(!e||!e.match)return t;var r={};if((e.match(ps)||[]).forEach(function(n){var s=_t(n);switch(s[0].replace(fZ,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[R_[s.ContentType]]!==void 0&&t[R_[s.ContentType]].push(s.PartName);break}}),t.xmlns!==bn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function uI(e,t){var r=tZ(R_),n=[],s;n[n.length]=Qr,n[n.length]=Qe("Types",null,{xmlns:bn.CT,"xmlns:xsd":bn.xsd,"xmlns:xsi":bn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Qe("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Qe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Vm[c][t.bookType]||Vm[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(f){n[n.length]=Qe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Vm[c][t.bookType]||Vm[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(f){n[n.length]=Qe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Pt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function m0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Bh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ps)||[]).forEach(function(s){var a=_t(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:Ah(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function xf(e){var t=[Qr,Qe("Relationships",null,{xmlns:bn.RELS})];return Wr(e["!id"]).forEach(function(r){t[t.length]=Qe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function nr(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Pt.HLINK,Pt.XPATH,Pt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var rQ="application/vnd.oasis.opendocument.spreadsheet";function nQ(e,t){for(var r=uS(e),n,s;n=p0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=_t(n[0],!1),s.path=="/"&&s.type!==rQ)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function sQ(e){var t=[Qr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function t5(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function aQ(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function iQ(e){var t=[Qr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(t5(e[r][0],e[r][1])),t.push(aQ("",e[r][0]));return t.push(t5("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function fI(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Yx.version+"</meta:generator></office:meta></office:document-meta>"}var Ba=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],oQ=(function(){for(var e=new Array(Ba.length),t=0;t<Ba.length;++t){var r=Ba[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function dI(e){var t={};e=hr(e);for(var r=0;r<Ba.length;++r){var n=Ba[r],s=e.match(oQ[r]);s!=null&&s.length>0&&(t[n[1]]=Wt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Tr(t[n[1]]))}return t}function kb(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=sr(t),n[n.length]=r?Qe(e,t,r):Xn(e,t))}function hI(e,t){var r=t||{},n=[Qr,Qe("cp:coreProperties",null,{"xmlns:cp":bn.CORE_PROPS,"xmlns:dc":bn.dc,"xmlns:dcterms":bn.dcterms,"xmlns:dcmitype":bn.dcmitype,"xmlns:xsi":bn.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&kb("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:T_(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&kb("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:T_(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Ba.length;++a){var i=Ba[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&kb(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Fc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],pI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function mI(e,t,r,n){var s=[];if(typeof e=="string")s=W3(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(h){return{v:h}}));var i=typeof t=="string"?W3(t,n).map(function(h){return h.v}):t,o=0,c=0;if(i.length>0)for(var f=0;f!==s.length;f+=2){switch(c=+s[f+1].v,s[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function lQ(e,t,r){var n={};return t||(t={}),e=hr(e),Fc.forEach(function(s){var a=(e.match(d0(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=Wt(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&mI(n.HeadingPairs,n.TitlesOfParts,t,r),t}function xI(e){var t=[],r=Qe;return e||(e={}),e.Application="SheetJS",t[t.length]=Qr,t[t.length]=Qe("Properties",null,{xmlns:bn.EXT_PROPS,"xmlns:vt":bn.vt}),Fc.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=sr(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+sr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var cQ=/<[^>]+>[^<]*/g;function uQ(e,t){var r={},n="",s=e.match(cQ);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=_t(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Wt(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),f=c[0].slice(4),h=c[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Wt(h);break;case"bool":r[n]=Nr(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Tr(h);break;case"cy":case"error":r[n]=Wt(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,f,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function gI(e){var t=[Qr,Qe("Properties",null,{xmlns:bn.CUST_PROPS,"xmlns:vt":bn.vt})];if(!e)return t.join("");var r=1;return Wr(e).forEach(function(s){++r,t[t.length]=Qe("property",vZ(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:sr(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var j_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ab;function fQ(e,t,r){Ab||(Ab=_1(j_)),t=Ab[t]||t,e[t]=r}function dQ(e,t){var r=[];return Wr(j_).map(function(n){for(var s=0;s<Ba.length;++s)if(Ba[s][1]==n)return Ba[s];for(s=0;s<Fc.length;++s)if(Fc[s][1]==n)return Fc[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Xn(j_[n[1]]||n[1],s))}}),Qe("DocumentProperties",r.join(""),{xmlns:ra.o})}function hQ(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Wr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Ba.length;++i)if(a==Ba[i][1])return;for(i=0;i<Fc.length;++i)if(a==Fc[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Qe(z3(a),o,{"dt:dt":c}))}}),t&&Wr(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Qe(z3(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+ra.o+'">'+s.join("")+"</"+n+">"}function wS(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function pQ(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=Le(8);return i.write_shift(4,n),i.write_shift(4,s),i}function yI(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function vI(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function bI(e,t,r){return t===31?vI(e):yI(e,t,r)}function O_(e,t,r){return bI(e,t,r===!1?0:4)}function mQ(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return bI(e,t,0)}function xQ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Ss,""),e.l-s&2&&(e.l+=2)}return r}function gQ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Ss,"");return r}function yQ(e){var t=e.l,r=ag(e,lI);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ag(e,Fs);return[r,n]}function vQ(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(yQ(e));return r}function r5(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Ss,"").replace(kh,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function wI(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function bQ(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ag(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==Q3&&n!==t&&JZ.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Q3?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return yI(e,n,4).replace(Ss,"");case 31:return vI(e);case 64:return wS(e);case 65:return wI(e);case 71:return bQ(e);case 80:return O_(e,n,!a.raw).replace(Ss,"");case 81:return mQ(e,n).replace(Ss,"");case 4108:return vQ(e);case 4126:case 4127:return n==4127?xQ(e):gQ(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function n5(e,t){var r=Le(4),n=Le(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Le(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=pQ(t);break;case 31:case 80:for(n=Le(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Dn([r,n])}function s5(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,f={};for(i=0;i!=s;++i){var h=e.read_shift(4),p=e.read_shift(4);a[i]=[h,p+r]}a.sort(function(S,E){return S[1]-E[1]});var x={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var g=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,g=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],g=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],g=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(g=!1,e.l=a[i][1]),g)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[a[i][0]];if(x[v.n]=ag(e,v.t,{raw:!0}),v.p==="version"&&(x[v.n]=String(x[v.n]>>16)+"."+("0000"+String(x[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(x[v.n]){case 0:x[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ai(o=x[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[v.n])}}else if(a[i][0]===1){if(o=x.CodePage=ag(e,vS),ai(o),c!==-1){var y=e.l;e.l=a[c][1],f=r5(e,o),e.l=y}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}f=r5(e,o)}else{var w=f[a[i][0]],_;switch(e[e.l]){case 65:e.l+=4,_=wI(e);break;case 30:e.l+=4,_=O_(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=O_(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=Kr(e,4);break;case 64:e.l+=4,_=Tr(wS(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[w]=_}}return e.l=r+n,x}var _I=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function wQ(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function a5(e,t,r){var n=Le(8),s=[],a=[],i=8,o=0,c=Le(8),f=Le(8);if(c.write_shift(4,2),c.write_shift(4,1200),f.write_shift(4,1),a.push(c),s.push(f),i+=8+c.length,!t){f=Le(8),f.write_shift(4,0),s.unshift(f);var h=[Le(4)];for(h[0].write_shift(4,e.length),o=0;o<e.length;++o){var p=e[o][0];for(c=Le(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=Dn(h),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(_I.indexOf(e[o][0])>-1||pI.indexOf(e[o][0])>-1)&&e[o][1]!=null){var x=e[o][1],g=0;if(t){g=+t[e[o][0]];var v=r[g];if(v.p=="version"&&typeof x=="string"){var y=x.split(".");x=(+y[0]<<16)+(+y[1]||0)}c=n5(v.t,x)}else{var w=wQ(x);w==-1&&(w=31,x=String(x)),c=n5(w,x)}a.push(c),f=Le(8),f.write_shift(4,t?g:2+o),s.push(f),i+=8+c.length}var _=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,_),_+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Dn([n].concat(s).concat(a))}function i5(e,t,r){var n=e.content;if(!n)return{};$n(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),h=n.read_shift(16);if(h!==mt.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var p=s5(n,t),x={SystemIdentifier:f};for(var g in p)x[g]=p[g];if(x.FMTID=a,s===1)return x;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=s5(n,null)}catch{}for(g in v)x[g]=v[g];return x.FMTID=[a,i],x}function o5(e,t,r,n,s,a){var i=Le(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,mt.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=a5(e,r,n);if(o.push(c),s){var f=a5(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(f)}return Dn(o)}function xl(e,t){return e.read_shift(t),null}function _Q(e,t){t||(t=Le(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function EQ(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Kr(e,t){return e.read_shift(t)===1}function bs(e,t){return t||(t=Le(2)),t.write_shift(2,+!!e),t}function mn(e){return e.read_shift(2,"u")}function Ia(e,t){return t||(t=Le(2)),t.write_shift(2,e),t}function EI(e,t){return EQ(e,t,mn)}function SQ(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function SI(e,t,r){return r||(r=Le(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function tp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function NQ(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=h,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function TQ(e){var t=e.t||"",r=Le(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Le(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Dn(s)}function Qc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function rp(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Qc(e,n,r)}function pu(e,t,r){if(r.biff>5)return rp(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function NI(e,t,r){return r||(r=Le(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function kQ(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function AQ(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Ss,"");return n&&(e.l+=24),s}function CQ(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Ss,"");return r+i}function RQ(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return AQ(e);case"0303000000000000c000000000000046":return CQ(e);default:throw new Error("Unsupported Moniker "+r)}}function qm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ss,""):"";return r}function l5(e,t){t||(t=Le(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function jQ(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,f="",h,p;s&16&&(a=qm(e,r-e.l)),s&128&&(i=qm(e,r-e.l)),(s&257)===257&&(o=qm(e,r-e.l)),(s&257)===1&&(c=RQ(e,r-e.l)),s&8&&(f=qm(e,r-e.l)),s&32&&(h=e.read_shift(16)),s&64&&(p=wS(e)),e.l=r;var x=i||o||c||"";x&&f&&(x+="#"+f),x||(x="#"+f),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var g={Target:x};return h&&(g.guid=h),p&&(g.time=p),a&&(g.Tooltip=a),g}function OQ(e){var t=Le(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),l5(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&l5(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function TI(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function kI(e,t){var r=TI(e);return r[3]=0,r}function Wi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function eu(e,t,r,n){return n||(n=Le(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function DQ(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function IQ(e,t,r){return t===0?"":pu(e,t,r)}function MQ(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function AI(e){var t=e.read_shift(2),r=yS(e);return[t,r]}function FQ(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=tp(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function N1(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function CI(e,t){return t||(t=Le(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function RI(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var PQ=RI;function jI(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function LQ(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function BQ(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function rs(e){e.l+=2,e.l+=e.read_shift(2)}var UQ={0:rs,4:rs,5:rs,6:rs,7:BQ,8:rs,9:rs,10:rs,11:rs,12:rs,13:LQ,14:rs,15:rs,16:rs,17:rs,18:rs,19:rs,20:rs,21:jI};function zQ(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(UQ[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Wm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function _S(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Le(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function HQ(e,t){return t===0||e.read_shift(2),1200}function VQ(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=pu(e,0,r);return e.read_shift(t+n-e.l),s}function qQ(e,t){var r=!t||t.biff==8,n=Le(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function WQ(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function $Q(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=tp(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function GQ(e,t){var r=!t||t.biff>=8?2:1,n=Le(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function KQ(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(NQ(e));return a.Count=n,a.Unique=s,a}function XQ(e,t){var r=Le(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=TQ(e[s]);var a=Dn([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function YQ(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function JQ(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function ZQ(e){var t=DQ(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function QQ(e){return e.read_shift(2),e.read_shift(4)}function c5(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function eee(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:f}}function tee(){var e=Le(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function ree(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function nee(e){var t=Le(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function see(){}function aee(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=tp(e,0,r),n}function iee(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=Le(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function oee(e){var t=Wi(e);return t.isst=e.read_shift(4),t}function lee(e,t,r,n){var s=Le(10);return eu(e,t,n,s),s.write_shift(4,r),s}function cee(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Wi(e);r.biff==2&&e.l++;var a=rp(e,n-e.l,r);return s.val=a,s}function uee(e,t,r,n,s){var a=!s||s.biff==8,i=Le(8+ +a+(1+a)*r.length);return eu(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function fee(e,t,r){var n=e.read_shift(2),s=pu(e,0,r);return[n,s]}function dee(e,t,r,n){var s=r&&r.biff==5;n||(n=Le(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var hee=pu;function u5(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function pee(e,t){var r=t.biff==8||!t.biff?4:2,n=Le(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function mee(e){var t=e.read_shift(2),r=e.read_shift(2),n=AI(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function xee(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(AI(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function gee(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function yee(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=ZZ[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function vee(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=yee(e,t,n.fStyle,r),n}function f5(e,t,r,n){var s=r&&r.biff==5;n||(n=Le(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function bee(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function wee(e){var t=Le(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function d5(e,t,r){var n=Wi(e);(r.biff==2||t==9)&&++e.l;var s=SQ(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function _ee(e,t,r,n,s,a){var i=Le(8);return eu(e,t,n,i),SI(r,a,i),i}function Eee(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Wi(e),s=cs(e);return n.val=s,n}function See(e,t,r,n){var s=Le(14);return eu(e,t,n,s),Zc(r,s),s}var h5=IQ;function Nee(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Qc(e,a),o=[];n>e.l;)o.push(rp(e));return[a,s,i,o]}function p5(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=FQ(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var Tee=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function m5(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Qc(e,i,r);s&32&&(f=Tee[f.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var p=n==e.l||o===0||!(h>0)?[]:zse(e,h,r,o);return{chKey:a,Name:f,itab:c,rgce:p}}function OI(e,t,r){if(r.biff<8)return kee(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(MQ(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function kee(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=tp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Aee(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Qc(e,n,r),i=Qc(e,s,r);return[a,i]}function Cee(e,t,r){var n=RI(e);e.l++;var s=e.read_shift(1);return t-=8,[Hse(e,t,r),s,n]}function x5(e,t,r){var n=PQ(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Bse(e,t,r)]}function Ree(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function jee(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=pu(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Oee(e,t,r){return jee(e,t,r)}function Dee(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(N1(e));return r}function Iee(e){var t=Le(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)CI(e[r],t);return t}function Mee(e,t,r){if(r&&r.biff<8)return Pee(e,t,r);var n=jI(e),s=zQ(e,t-22,n[1]);return{cmo:n,ft:s}}var Fee={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function Pee(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Fee[n]||ds)(e,t,r)),{cmo:[s,n,a],ft:i}}function Lee(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=kQ(e,6,r);var o=e.read_shift(2);e.read_shift(2),mn(e,2);var c=e.read_shift(2);e.l+=c;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],p=Qc(e,e.lens[f+1]-e.lens[f]-1);if(s+=p,s.length>=(h?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Bee(e,t){var r=N1(e);e.l+=16;var n=jQ(e,t-24);return[r,n]}function Uee(e){var t=Le(24),r=Ir(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Dn([t,OQ(e[1])])}function zee(e,t){e.read_shift(2);var r=N1(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Ss,""),[r,n]}function Hee(e){var t=e[1].Tooltip,r=Le(10+2*(t.length+1));r.write_shift(2,2048);var n=Ir(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Vee(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=e5[r]||r,r=e.read_shift(2),t[1]=e5[r]||r,t}function qee(e){return e||(e=Le(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Wee(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(kI(e));return r}function $ee(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(kI(e));return r}function Gee(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function DI(e,t,r){if(!r.cellStyles)return ds(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var f={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(f.level=c>>8&7),f}function Kee(e,t){var r=Le(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Xee(e,t){var r={};return t<32||(e.l+=16,r.header=cs(e),r.footer=cs(e),e.l+=2),r}function Yee(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Jee(e){for(var t=Le(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Zee=Wi,Qee=EI,ete=rp;function tte(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function rte(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Wi(e);++e.l;var s=pu(e,t-7,r);return n.t="str",n.val=s,n}function nte(e){var t=Wi(e);++e.l;var r=cs(e);return t.t="n",t.val=r,t}function ste(e,t,r){var n=Le(15);return ip(n,e,t),n.write_shift(8,r,"f"),n}function ate(e){var t=Wi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function ite(e,t,r){var n=Le(9);return ip(n,e,t),n.write_shift(2,r),n}function ote(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function lte(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function cte(e,t,r){var n=e.l+t,s=Wi(e),a=e.read_shift(2),i=Qc(e,a,r);return e.l=n,s.t="str",s.val=i,s}var ute=[2,3,48,49,131,139,140,245],D_=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=_1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var f=[],h=Bl(1);switch(c.type){case"base64":h=sa(ca(o));break;case"binary":h=sa(o);break;case"buffer":case"array":h=o;break}$n(h,0);var p=h.read_shift(1),x=!!(p&136),g=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,w=521;p==2&&(y=h.read_shift(2)),h.l+=3,p!=2&&(y=h.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(w=h.read_shift(2));var _=h.read_shift(2),S=c.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(S=e[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var E=[],N={},k=Math.min(h.length,p==2?521:w-10-(g?264:0)),O=v?32:11;h.l<k&&h[h.l]!=13;)switch(N={},N.name=c0.utils.decode(S,h.slice(h.l,h.l+O)).replace(/[\u0000\r\n].*$/g,""),h.l+=O,N.type=String.fromCharCode(h.read_shift(1)),p!=2&&!v&&(N.offset=h.read_shift(4)),N.len=h.read_shift(1),p==2&&(N.offset=h.read_shift(2)),N.dec=h.read_shift(1),N.name.length&&E.push(N),p!=2&&(h.l+=v?13:14),N.type){case"B":(!g||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var R=0,V=0;for(f[0]=[],V=0;V!=E.length;++V)f[0][V]=E[V].name;for(;y-- >0;){if(h[h.l]===42){h.l+=_;continue}for(++h.l,f[++R]=[],V=0,V=0;V!=E.length;++V){var I=h.slice(h.l,h.l+E[V].len);h.l+=E[V].len,$n(I,0);var Z=c0.utils.decode(S,I);switch(E[V].type){case"C":Z.trim().length&&(f[R][V]=Z.replace(/\s+$/,""));break;case"D":Z.length===8?f[R][V]=new Date(+Z.slice(0,4),+Z.slice(4,6)-1,+Z.slice(6,8)):f[R][V]=Z;break;case"F":f[R][V]=parseFloat(Z.trim());break;case"+":case"I":f[R][V]=v?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(Z.trim().toUpperCase()){case"Y":case"T":f[R][V]=!0;break;case"N":case"F":f[R][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Z+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[R][V]="##MEMO##"+(v?parseInt(Z.trim(),10):I.read_shift(4));break;case"N":Z=Z.replace(/\u0000/g,"").trim(),Z&&Z!="."&&(f[R][V]=+Z||0);break;case"@":f[R][V]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":f[R][V]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":f[R][V]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[R][V]=-I.read_shift(-8,"f");break;case"B":if(g&&E[V].len==8){f[R][V]=I.read_shift(8,"f");break}case"G":case"P":I.l+=E[V].len;break;case"0":if(E[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[V].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(f=f.slice(0,c.sheetRows)),c.DBF=E,f}function n(o,c){var f=c||{};f.dateNF||(f.dateNF="yyyymmdd");var h=pd(r(o,f),f);return h["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,h}function s(o,c){try{return Gl(n(o,c),c)}catch(f){if(c&&c.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var f=c||{};if(+f.codepage>=0&&ai(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=Us(),p=cg(o,{header:1,raw:!0,cellDates:!0}),x=p[0],g=p.slice(1),v=o["!cols"]||[],y=0,w=0,_=0,S=1;for(y=0;y<x.length;++y){if(((v[y]||{}).DBF||{}).name){x[y]=v[y].DBF.name,++_;continue}if(x[y]!=null){if(++_,typeof x[y]=="number"&&(x[y]=x[y].toString(10)),typeof x[y]!="string")throw new Error("DBF Invalid column name "+x[y]+" |"+typeof x[y]+"|");if(x.indexOf(x[y])!==y){for(w=0;w<1024;++w)if(x.indexOf(x[y]+"_"+w)==-1){x[y]+="_"+w;break}}}}var E=$t(o["!ref"]),N=[],k=[],O=[];for(y=0;y<=E.e.c-E.s.c;++y){var R="",V="",I=0,Z=[];for(w=0;w<g.length;++w)g[w][y]!=null&&Z.push(g[w][y]);if(Z.length==0||x[y]==null){N[y]="?";continue}for(w=0;w<Z.length;++w){switch(typeof Z[w]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=Z[w]instanceof Date?"D":"C";break;default:V="C"}I=Math.max(I,String(Z[w]).length),R=R&&R!=V?"C":V}I>250&&(I=250),V=((v[y]||{}).DBF||{}).type,V=="C"&&v[y].DBF.len>I&&(I=v[y].DBF.len),R=="B"&&V=="N"&&(R="N",O[y]=v[y].DBF.dec,I=v[y].DBF.len),k[y]=R=="C"||V=="N"?I:a[R]||0,S+=k[y],N[y]=R}var ce=h.next(32);for(ce.write_shift(4,318902576),ce.write_shift(4,g.length),ce.write_shift(2,296+32*_),ce.write_shift(2,S),y=0;y<4;++y)ce.write_shift(4,0);for(ce.write_shift(4,0|(+t[_D]||3)<<8),y=0,w=0;y<x.length;++y)if(x[y]!=null){var F=h.next(32),X=(x[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,X,"sbcs"),F.write_shift(1,N[y]=="?"?"C":N[y],"sbcs"),F.write_shift(4,w),F.write_shift(1,k[y]||a[N[y]]||0),F.write_shift(1,O[y]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),w+=k[y]||a[N[y]]||0}var P=h.next(264);for(P.write_shift(4,13),y=0;y<65;++y)P.write_shift(4,0);for(y=0;y<g.length;++y){var ie=h.next(S);for(ie.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(N[w]){case"L":ie.write_shift(1,g[y][w]==null?63:g[y][w]?84:70);break;case"B":ie.write_shift(8,g[y][w]||0,"f");break;case"N":var te="0";for(typeof g[y][w]=="number"&&(te=g[y][w].toFixed(O[w]||0)),_=0;_<k[w]-te.length;++_)ie.write_shift(1,32);ie.write_shift(1,te,"sbcs");break;case"D":g[y][w]?(ie.write_shift(4,("0000"+g[y][w].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(g[y][w].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+g[y][w].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(g[y][w]!=null?g[y][w]:"").slice(0,k[w]);for(ie.write_shift(1,Y,"sbcs"),_=0;_<k[w]-Y.length;++_)ie.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),II=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Wr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,g){var v=e[g];return typeof v=="number"?k3(v):v},n=function(x,g,v){var y=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return y==59?x:k3(y)};e["|"]=254;function s(x,g){switch(g.type){case"base64":return a(ca(x),g);case"binary":return a(x,g);case"buffer":return a(Ft&&Buffer.isBuffer(x)?x.toString("binary"):$l(x),g);case"array":return a(Jc(x),g)}throw new Error("Unrecognized type "+g.type)}function a(x,g){var v=x.split(/[\n\r]+/),y=-1,w=-1,_=0,S=0,E=[],N=[],k=null,O={},R=[],V=[],I=[],Z=0,ce;for(+g.codepage>=0&&ai(+g.codepage);_!==v.length;++_){Z=0;var F=v[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),X=F.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),P=X[0],ie;if(F.length>0)switch(P){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&N.push(F.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,Y=!1,ve=!1,oe=!1,Ee=-1,K=-1;for(S=1;S<X.length;++S)switch(X[S].charAt(0)){case"A":break;case"X":w=parseInt(X[S].slice(1))-1,Y=!0;break;case"Y":for(y=parseInt(X[S].slice(1))-1,Y||(w=0),ce=E.length;ce<=y;++ce)E[ce]=[];break;case"K":ie=X[S].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(li(ie))?isNaN(Mf(ie).getDate())||(ie=Tr(ie)):(ie=li(ie),k!==null&&dd(k)&&(ie=S1(ie))),te=!0;break;case"E":oe=!0;var D=gf(X[S].slice(1),{r:y,c:w});E[y][w]=[E[y][w],D];break;case"S":ve=!0,E[y][w]=[E[y][w],"S5S"];break;case"G":break;case"R":Ee=parseInt(X[S].slice(1))-1;break;case"C":K=parseInt(X[S].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}if(te&&(E[y][w]&&E[y][w].length==2?E[y][w][0]=ie:E[y][w]=ie,k=null),ve){if(oe)throw new Error("SYLK shared formula cannot have own formula");var q=Ee>-1&&E[Ee][K];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");E[y][w][1]=ZI(q[1],{r:y-Ee,c:w-K})}break;case"F":var W=0;for(S=1;S<X.length;++S)switch(X[S].charAt(0)){case"X":w=parseInt(X[S].slice(1))-1,++W;break;case"Y":for(y=parseInt(X[S].slice(1))-1,ce=E.length;ce<=y;++ce)E[ce]=[];break;case"M":Z=parseInt(X[S].slice(1))/20;break;case"F":break;case"G":break;case"P":k=N[parseInt(X[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=X[S].slice(1).split(" "),ce=parseInt(I[0],10);ce<=parseInt(I[1],10);++ce)Z=parseInt(I[2],10),V[ce-1]=Z===0?{hidden:!0}:{wch:Z},Ul(V[ce-1]);break;case"C":w=parseInt(X[S].slice(1))-1,V[w]||(V[w]={});break;case"R":y=parseInt(X[S].slice(1))-1,R[y]||(R[y]={}),Z>0?(R[y].hpt=Z,R[y].hpx=Pf(Z)):Z===0&&(R[y].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}W<1&&(k=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}}return R.length>0&&(O["!rows"]=R),V.length>0&&(O["!cols"]=V),g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),[E,O]}function i(x,g){var v=s(x,g),y=v[0],w=v[1],_=pd(y,g);return Wr(w).forEach(function(S){_[S]=w[S]}),_}function o(x,g){return Gl(i(x,g),g)}function c(x,g,v,y){var w="C;Y"+(v+1)+";X"+(y+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+AS(x.f,{r:v,c:y}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function f(x,g){g.forEach(function(v,y){var w="F;W"+(y+1)+" "+(y+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=g0(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=y0(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function h(x,g){g.forEach(function(v,y){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*v0(v.hpx)+";"),w.length>2&&x.push(w+"R"+(y+1))})}function p(x,g){var v=["ID;PWXL;N;E"],y=[],w=$t(x["!ref"]),_,S=Array.isArray(x),E=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),x["!cols"]&&f(v,x["!cols"]),x["!rows"]&&h(v,x["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var k=w.s.c;k<=w.e.c;++k){var O=bt({r:N,c:k});_=S?(x[N]||[])[k]:x[O],!(!_||_.v==null&&(!_.f||_.F))&&y.push(c(_,x,N,k))}return v.join(E)+E+y.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:i,from_sheet:p}})(),MI=(function(){function e(a,i){switch(i.type){case"base64":return t(ca(a),i);case"binary":return t(a,i);case"buffer":return t(Ft&&Buffer.isBuffer(a)?a.toString("binary"):$l(a),i);case"array":return t(Jc(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,f=-1,h=0,p=[];h!==o.length;++h){if(o[h].trim()==="BOT"){p[++c]=[],f=0;continue}if(!(c<0)){var x=o[h].trim().split(","),g=x[0],v=x[1];++h;for(var y=o[h]||"";(y.match(/["]/g)||[]).length&1&&h<o.length-1;)y+=`
`+o[++h];switch(y=y.trim(),+g){case-1:if(y==="BOT"){p[++c]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[c][f]=!0:y==="FALSE"?p[c][f]=!1:isNaN(li(v))?isNaN(Mf(v).getDate())?p[c][f]=v:p[c][f]=Tr(v):p[c][f]=li(v),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[c][f++]=y!==""?y:null;break}if(y==="EOD")break}}return i&&i.sheetRows&&(p=p.slice(0,i.sheetRows)),p}function r(a,i){return pd(e(a,i),i)}function n(a,i){return Gl(r(a,i),i)}var s=(function(){var a=function(c,f,h,p,x){c.push(f),c.push(h+","+p),c.push('"'+x.replace(/"/g,'""')+'"')},i=function(c,f,h,p){c.push(f+","+h),c.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var f=[],h=$t(c["!ref"]),p,x=Array.isArray(c);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,h.e.r-h.s.r+1,""),a(f,"TUPLES",0,h.e.c-h.s.c+1,""),a(f,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){i(f,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var y=bt({r:g,c:v});if(p=x?(c[g]||[])[v]:c[y],!p){i(f,1,0,"");continue}switch(p.t){case"n":var w=p.w;!w&&p.v!=null&&(w=p.v),w==null?p.f&&!p.F?i(f,1,0,"="+p.f):i(f,1,0,""):i(f,0,w,"V");break;case"b":i(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":i(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=qa(p.z||yt[14],_n(Tr(p.v)))),i(f,0,p.w,"V");break;default:i(f,1,0,"")}}}i(f,-1,0,"EOD");var _=`\r
`,S=f.join(_);return S}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),FI=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,x){for(var g=p.split(`
`),v=-1,y=-1,w=0,_=[];w!==g.length;++w){var S=g[w].trim().split(":");if(S[0]==="cell"){var E=Ir(S[1]);if(_.length<=E.r)for(v=_.length;v<=E.r;++v)_[v]||(_[v]=[]);switch(v=E.r,y=E.c,S[2]){case"t":_[v][y]=e(S[3]);break;case"v":_[v][y]=+S[3];break;case"vtf":var N=S[S.length-1];case"vtc":switch(S[3]){case"nl":_[v][y]=!!+S[4];break;default:_[v][y]=+S[4];break}S[2]=="vtf"&&(_[v][y]=[_[v][y],N])}}}return x&&x.sheetRows&&(_=_.slice(0,x.sheetRows)),_}function n(p,x){return pd(r(p,x),x)}function s(p,x){return Gl(n(p,x),x)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var x=[],g=[],v,y="",w=Vs(p["!ref"]),_=Array.isArray(p),S=w.s.r;S<=w.e.r;++S)for(var E=w.s.c;E<=w.e.c;++E)if(y=bt({r:S,c:E}),v=_?(p[S]||[])[E]:p[y],!(!v||v.v==null||v.t==="z")){switch(g=["cell",y,"t"],v.t){case"s":case"str":g.push(t(v.v));break;case"n":v.f?(g[2]="vtf",g[3]="n",g[4]=v.v,g[5]=t(v.f)):(g[2]="v",g[3]=v.v);break;case"b":g[2]="vt"+(v.f?"f":"c"),g[3]="nl",g[4]=v.v?"1":"0",g[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=_n(Tr(v.v));g[2]="vtc",g[3]="nd",g[4]=""+N,g[5]=v.w||qa(v.z||yt[14],N);break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(p){return[a,i,o,i,f(p),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:h}})(),Ff=(function(){function e(h,p,x,g,v){v.raw?p[x][g]=h:h===""||(h==="TRUE"?p[x][g]=!0:h==="FALSE"?p[x][g]=!1:isNaN(li(h))?isNaN(Mf(h).getDate())?p[x][g]=h:p[x][g]=Tr(h):p[x][g]=li(h))}function t(h,p){var x=p||{},g=[];if(!h||h.length===0)return g;for(var v=h.split(/[\r\n]/),y=v.length-1;y>=0&&v[y].length===0;)--y;for(var w=10,_=0,S=0;S<=y;++S)_=v[S].indexOf(" "),_==-1?_=v[S].length:_++,w=Math.max(w,_);for(S=0;S<=y;++S){g[S]=[];var E=0;for(e(v[S].slice(0,w).trim(),g,S,E,x),E=1;E<=(v[S].length-w)/10+1;++E)e(v[S].slice(w+(E-1)*10,w+E*10).trim(),g,S,E,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(h){for(var p={},x=!1,g=0,v=0;g<h.length;++g)(v=h.charCodeAt(g))==34?x=!x:!x&&v in r&&(p[v]=(p[v]||0)+1);v=[];for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&v.push([p[g],g]);if(!v.length){p=n;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&v.push([p[g],g])}return v.sort(function(y,w){return y[0]-w[0]||n[y[1]]-n[w[1]]}),r[v.pop()[1]]||44}function a(h,p){var x=p||{},g="",v=x.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=s(h.slice(0,1024)):x&&x.FS?g=x.FS:g=s(h.slice(0,1024));var w=0,_=0,S=0,E=0,N=0,k=g.charCodeAt(0),O=!1,R=0,V=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var I=x.dateNF!=null?YJ(x.dateNF):null;function Z(){var ce=h.slice(E,N),F={};if(ce.charAt(0)=='"'&&ce.charAt(ce.length-1)=='"'&&(ce=ce.slice(1,-1).replace(/""/g,'"')),ce.length===0)F.t="z";else if(x.raw)F.t="s",F.v=ce;else if(ce.trim().length===0)F.t="s",F.v=ce;else if(ce.charCodeAt(0)==61)ce.charCodeAt(1)==34&&ce.charCodeAt(ce.length-1)==34?(F.t="s",F.v=ce.slice(2,-1).replace(/""/g,'"')):Nne(ce)?(F.t="n",F.f=ce.slice(1)):(F.t="s",F.v=ce);else if(ce=="TRUE")F.t="b",F.v=!0;else if(ce=="FALSE")F.t="b",F.v=!1;else if(!isNaN(S=li(ce)))F.t="n",x.cellText!==!1&&(F.w=ce),F.v=S;else if(!isNaN(Mf(ce).getDate())||I&&ce.match(I)){F.z=x.dateNF||yt[14];var X=0;I&&ce.match(I)&&(ce=JJ(ce,x.dateNF,ce.match(I)||[]),X=1),x.cellDates?(F.t="d",F.v=Tr(ce,X)):(F.t="n",F.v=_n(Tr(ce,X))),x.cellText!==!1&&(F.w=qa(F.z,F.v instanceof Date?_n(F.v):F.v)),x.cellNF||delete F.z}else F.t="s",F.v=ce;if(F.t=="z"||(x.dense?(v[w]||(v[w]=[]),v[w][_]=F):v[bt({c:_,r:w})]=F),E=N+1,V=h.charCodeAt(E),y.e.c<_&&(y.e.c=_),y.e.r<w&&(y.e.r=w),R==k)++_;else if(_=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;N<h.length;++N)switch(R=h.charCodeAt(N)){case 34:V===34&&(O=!O);break;case k:case 10:case 13:if(!O&&Z())break e;break}return N-E>0&&Z(),v["!ref"]=Ct(y),v}function i(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?a(h,p):pd(t(h,p),p)}function o(h,p){var x="",g=p.type=="string"?[0,0,0,0]:FS(h,p);switch(p.type){case"base64":x=ca(h);break;case"binary":x=h;break;case"buffer":p.codepage==65001?x=h.toString("utf8"):p.codepage&&typeof c0<"u"||(x=Ft&&Buffer.isBuffer(h)?h.toString("binary"):$l(h));break;case"array":x=Jc(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+p.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=hr(x.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?x=hr(x):p.type=="binary"&&typeof c0<"u",x.slice(0,19)=="socialcalc:version:"?FI.to_sheet(p.type=="string"?x:hr(x),p):i(x,p)}function c(h,p){return Gl(o(h,p),p)}function f(h){for(var p=[],x=$t(h["!ref"]),g,v=Array.isArray(h),y=x.s.r;y<=x.e.r;++y){for(var w=[],_=x.s.c;_<=x.e.c;++_){var S=bt({r:y,c:_});if(g=v?(h[y]||[])[_]:h[S],!g||g.v==null){w.push("          ");continue}for(var E=(g.w||(Po(g),g.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(_===0?" ":""))}p.push(w.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:f}})();function fte(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=II.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Ff.to_workbook(e,t)}}var Pc=(function(){function e(D,q,W){if(D){$n(D,D.l||0);for(var J=W.Enum||Ee;D.l<D.length;){var re=D.read_shift(2),U=J[re]||J[65535],L=D.read_shift(2),se=D.l+L,Q=U.f&&U.f(D,L,W);if(D.l=se,q(Q,U,re))return}}}function t(D,q){switch(q.type){case"base64":return r(sa(ca(D)),q);case"binary":return r(sa(D),q);case"buffer":case"array":return r(D,q)}throw"Unsupported type "+q.type}function r(D,q){if(!D)return D;var W=q||{},J=W.dense?[]:{},re="Sheet1",U="",L=0,se={},Q=[],ee=[],B={s:{r:0,c:0},e:{r:0,c:0}},be=W.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)W.Enum=Ee,e(D,function(A,j,H){switch(H){case 0:W.vers=A,A>=4096&&(W.qpro=!0);break;case 6:B=A;break;case 204:A&&(U=A);break;case 222:U=A;break;case 15:case 51:W.qpro||(A[1].v=A[1].v.slice(1));case 13:case 14:case 16:H==14&&(A[2]&112)==112&&(A[2]&15)>1&&(A[2]&15)<15&&(A[1].z=W.dateNF||yt[14],W.cellDates&&(A[1].t="d",A[1].v=S1(A[1].v))),W.qpro&&A[3]>L&&(J["!ref"]=Ct(B),se[re]=J,Q.push(re),J=W.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},L=A[3],re=U||"Sheet"+(L+1),U="");var ue=W.dense?(J[A[0].r]||[])[A[0].c]:J[bt(A[0])];if(ue){ue.t=A[1].t,ue.v=A[1].v,A[1].z!=null&&(ue.z=A[1].z),A[1].f!=null&&(ue.f=A[1].f);break}W.dense?(J[A[0].r]||(J[A[0].r]=[]),J[A[0].r][A[0].c]=A[1]):J[bt(A[0])]=A[1];break}},W);else if(D[2]==26||D[2]==14)W.Enum=K,D[2]==14&&(W.qpro=!0,D.l=0),e(D,function(A,j,H){switch(H){case 204:re=A;break;case 22:A[1].v=A[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(A[3]>L&&(J["!ref"]=Ct(B),se[re]=J,Q.push(re),J=W.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},L=A[3],re="Sheet"+(L+1)),be>0&&A[0].r>=be)break;W.dense?(J[A[0].r]||(J[A[0].r]=[]),J[A[0].r][A[0].c]=A[1]):J[bt(A[0])]=A[1],B.e.c<A[0].c&&(B.e.c=A[0].c),B.e.r<A[0].r&&(B.e.r=A[0].r);break;case 27:A[14e3]&&(ee[A[14e3][0]]=A[14e3][1]);break;case 1537:ee[A[0]]=A[1],A[0]==L&&(re=A[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(J["!ref"]=Ct(B),se[U||re]=J,Q.push(U||re),!ee.length)return{SheetNames:Q,Sheets:se};for(var z={},he=[],M=0;M<ee.length;++M)se[Q[M]]?(he.push(ee[M]||Q[M]),z[ee[M]]=se[ee[M]]||se[Q[M]]):(he.push(ee[M]),z[ee[M]]={"!ref":"A1"});return{SheetNames:he,Sheets:z}}function n(D,q){var W=q||{};if(+W.codepage>=0&&ai(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var J=Us(),re=$t(D["!ref"]),U=Array.isArray(D),L=[];et(J,0,a(1030)),et(J,6,c(re));for(var se=Math.min(re.e.r,8191),Q=re.s.r;Q<=se;++Q)for(var ee=Jr(Q),B=re.s.c;B<=re.e.c;++B){Q===re.s.r&&(L[B]=Dr(B));var be=L[B]+ee,z=U?(D[Q]||[])[B]:D[be];if(!(!z||z.t=="z"))if(z.t=="n")(z.v|0)==z.v&&z.v>=-32768&&z.v<=32767?et(J,13,g(Q,B,z.v)):et(J,14,y(Q,B,z.v));else{var he=Po(z);et(J,15,p(Q,B,he.slice(0,239)))}}return et(J,1),J.end()}function s(D,q){var W=q||{};if(+W.codepage>=0&&ai(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var J=Us();et(J,0,i(D));for(var re=0,U=0;re<D.SheetNames.length;++re)(D.Sheets[D.SheetNames[re]]||{})["!ref"]&&et(J,27,oe(D.SheetNames[re],U++));var L=0;for(re=0;re<D.SheetNames.length;++re){var se=D.Sheets[D.SheetNames[re]];if(!(!se||!se["!ref"])){for(var Q=$t(se["!ref"]),ee=Array.isArray(se),B=[],be=Math.min(Q.e.r,8191),z=Q.s.r;z<=be;++z)for(var he=Jr(z),M=Q.s.c;M<=Q.e.c;++M){z===Q.s.r&&(B[M]=Dr(M));var A=B[M]+he,j=ee?(se[z]||[])[M]:se[A];if(!(!j||j.t=="z"))if(j.t=="n")et(J,23,Z(z,M,L,j.v));else{var H=Po(j);et(J,22,R(z,M,L,H.slice(0,239)))}}++L}}return et(J,1),J.end()}function a(D){var q=Le(2);return q.write_shift(2,D),q}function i(D){var q=Le(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var W=0,J=0,re=0,U=0;U<D.SheetNames.length;++U){var L=D.SheetNames[U],se=D.Sheets[L];if(!(!se||!se["!ref"])){++re;var Q=Vs(se["!ref"]);W<Q.e.r&&(W=Q.e.r),J<Q.e.c&&(J=Q.e.c)}}return W>8191&&(W=8191),q.write_shift(2,W),q.write_shift(1,re),q.write_shift(1,J),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(D,q,W){var J={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&W.qpro?(J.s.c=D.read_shift(1),D.l++,J.s.r=D.read_shift(2),J.e.c=D.read_shift(1),D.l++,J.e.r=D.read_shift(2),J):(J.s.c=D.read_shift(2),J.s.r=D.read_shift(2),q==12&&W.qpro&&(D.l+=2),J.e.c=D.read_shift(2),J.e.r=D.read_shift(2),q==12&&W.qpro&&(D.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function c(D){var q=Le(8);return q.write_shift(2,D.s.c),q.write_shift(2,D.s.r),q.write_shift(2,D.e.c),q.write_shift(2,D.e.r),q}function f(D,q,W){var J=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(J[0].c=D.read_shift(1),J[3]=D.read_shift(1),J[0].r=D.read_shift(2),D.l+=2):(J[2]=D.read_shift(1),J[0].c=D.read_shift(2),J[0].r=D.read_shift(2)),J}function h(D,q,W){var J=D.l+q,re=f(D,q,W);if(re[1].t="s",W.vers==20768){D.l++;var U=D.read_shift(1);return re[1].v=D.read_shift(U,"utf8"),re}return W.qpro&&D.l++,re[1].v=D.read_shift(J-D.l,"cstr"),re}function p(D,q,W){var J=Le(7+W.length);J.write_shift(1,255),J.write_shift(2,q),J.write_shift(2,D),J.write_shift(1,39);for(var re=0;re<J.length;++re){var U=W.charCodeAt(re);J.write_shift(1,U>=128?95:U)}return J.write_shift(1,0),J}function x(D,q,W){var J=f(D,q,W);return J[1].v=D.read_shift(2,"i"),J}function g(D,q,W){var J=Le(7);return J.write_shift(1,255),J.write_shift(2,q),J.write_shift(2,D),J.write_shift(2,W,"i"),J}function v(D,q,W){var J=f(D,q,W);return J[1].v=D.read_shift(8,"f"),J}function y(D,q,W){var J=Le(13);return J.write_shift(1,255),J.write_shift(2,q),J.write_shift(2,D),J.write_shift(8,W,"f"),J}function w(D,q,W){var J=D.l+q,re=f(D,q,W);if(re[1].v=D.read_shift(8,"f"),W.qpro)D.l=J;else{var U=D.read_shift(2);N(D.slice(D.l,D.l+U),re),D.l+=U}return re}function _(D,q,W){var J=q&32768;return q&=-32769,q=(J?D:0)+(q>=8192?q-16384:q),(J?"":"$")+(W?Dr(q):Jr(q))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(D,q){$n(D,0);for(var W=[],J=0,re="",U="",L="",se="";D.l<D.length;){var Q=D[D.l++];switch(Q){case 0:W.push(D.read_shift(8,"f"));break;case 1:U=_(q[0].c,D.read_shift(2),!0),re=_(q[0].r,D.read_shift(2),!1),W.push(U+re);break;case 2:{var ee=_(q[0].c,D.read_shift(2),!0),B=_(q[0].r,D.read_shift(2),!1);U=_(q[0].c,D.read_shift(2),!0),re=_(q[0].r,D.read_shift(2),!1),W.push(ee+B+":"+U+re)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(D.read_shift(2));break;case 6:{for(var be="";Q=D[D.l++];)be+=String.fromCharCode(Q);W.push('"'+be.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:se=W.pop(),L=W.pop(),W.push(["AND","OR"][Q-20]+"("+L+","+se+")");break;default:if(Q<32&&E[Q])se=W.pop(),L=W.pop(),W.push(L+E[Q]+se);else if(S[Q]){if(J=S[Q][1],J==69&&(J=D[D.l++]),J>W.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+W.join("|")+"|");return}var z=W.slice(-J);W.length-=J,W.push(S[Q][0]+"("+z.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}W.length==1?q[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function k(D){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=D.read_shift(2),q[3]=D[D.l++],q[0].c=D[D.l++],q}function O(D,q){var W=k(D);return W[1].t="s",W[1].v=D.read_shift(q-4,"cstr"),W}function R(D,q,W,J){var re=Le(6+J.length);re.write_shift(2,D),re.write_shift(1,W),re.write_shift(1,q),re.write_shift(1,39);for(var U=0;U<J.length;++U){var L=J.charCodeAt(U);re.write_shift(1,L>=128?95:L)}return re.write_shift(1,0),re}function V(D,q){var W=k(D);W[1].v=D.read_shift(2);var J=W[1].v>>1;if(W[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return W[1].v=J,W}function I(D,q){var W=k(D),J=D.read_shift(4),re=D.read_shift(4),U=D.read_shift(2);if(U==65535)return J===0&&re===3221225472?(W[1].t="e",W[1].v=15):J===0&&re===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var L=U&32768;return U=(U&32767)-16446,W[1].v=(1-L*2)*(re*Math.pow(2,U+32)+J*Math.pow(2,U)),W}function Z(D,q,W,J){var re=Le(14);if(re.write_shift(2,D),re.write_shift(1,W),re.write_shift(1,q),J==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var U=0,L=0,se=0,Q=0;return J<0&&(U=1,J=-J),L=Math.log2(J)|0,J/=Math.pow(2,L-31),Q=J>>>0,(Q&2147483648)==0&&(J/=2,++L,Q=J>>>0),J-=Q,Q|=2147483648,Q>>>=0,J*=Math.pow(2,32),se=J>>>0,re.write_shift(4,se),re.write_shift(4,Q),L+=16383+(U?32768:0),re.write_shift(2,L),re}function ce(D,q){var W=I(D);return D.l+=q-14,W}function F(D,q){var W=k(D),J=D.read_shift(4);return W[1].v=J>>6,W}function X(D,q){var W=k(D),J=D.read_shift(8,"f");return W[1].v=J,W}function P(D,q){var W=X(D);return D.l+=q-10,W}function ie(D,q){return D[D.l+q-1]==0?D.read_shift(q,"cstr"):""}function te(D,q){var W=D[D.l++];W>q-1&&(W=q-1);for(var J="";J.length<W;)J+=String.fromCharCode(D[D.l++]);return J}function Y(D,q,W){if(!(!W.qpro||q<21)){var J=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var re=D.read_shift(q-21,"cstr");return[J,re]}}function ve(D,q){for(var W={},J=D.l+q;D.l<J;){var re=D.read_shift(2);if(re==14e3){for(W[re]=[0,""],W[re][0]=D.read_shift(2);D[D.l];)W[re][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return W}function oe(D,q){var W=Le(5+D.length);W.write_shift(2,14e3),W.write_shift(2,q);for(var J=0;J<D.length;++J){var re=D.charCodeAt(J);W[W.l++]=re>127?95:re}return W[W.l++]=0,W}var Ee={0:{n:"BOF",f:mn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:ce},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:P},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function dte(e){var t={},r=e.match(ps),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=_t(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=QE[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var hte=(function(){var e=d0("t"),t=d0("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Wt(i[1])},c=a.match(t);return c&&(o.s=dte(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),pte=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),mte=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,xte=/<(?:\w+:)?r>/,gte=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ES(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Wt(hr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=hr(e),r&&(n.h=cS(n.t))):e.match(xte)&&(n.r=hr(e),n.t=Wt(hr((e.replace(gte,"").match(mte)||[]).join("").replace(ps,""))),r&&(n.h=pte(hte(n.r)))),n):{t:""}}var yte=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,vte=/<(?:\w+:)?(?:si|sstItem)>/g,bte=/<\/(?:\w+:)?(?:si|sstItem)>/;function wte(e,t){var r=[],n="";if(!e)return r;var s=e.match(yte);if(s){n=s[2].replace(vte,"").split(bte);for(var a=0;a!=n.length;++a){var i=ES(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=_t(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var _te=/^\s|\s$|[\t\n\r]/;function PI(e,t){if(!t.bookSST)return"";var r=[Qr];r[r.length]=Qe("sst",null,{xmlns:cu[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(_te)&&(a+=' xml:space="preserve"'),a+=">"+sr(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Ete(e){return[e.read_shift(4),e.read_shift(4)]}function Ste(e,t){var r=[],n=!1;return Uo(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Nte(e,t){return t||(t=Le(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Tte=FZ;function kte(e){var t=Us();qe(t,159,Nte(e));for(var r=0;r<e.length;++r)qe(t,19,Tte(e[r]));return qe(t,160),t.end()}function LI(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Oo(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Ate(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Oo(e,4),t.U=Oo(e,4),t.W=Oo(e,4),t}function Cte(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Rte(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Cte(e));return t}function jte(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Ote(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Oo(e,4),t.U=Oo(e,4),t.W=Oo(e,4),t}function Dte(e){var t=Ote(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function BI(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function UI(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Ite(e){var t=Oo(e);switch(t.Minor){case 2:return[t.Minor,Mte(e)];case 3:return[t.Minor,Fte()];case 4:return[t.Minor,Pte(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Mte(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=BI(e,r),s=UI(e,e.length-e.l);return{t:"Std",h:n,v:s}}function Fte(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Pte(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ps,function(a){var i=_t(a);switch(qi(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Lte(e,t){var r={},n=r.EncryptionVersionInfo=Oo(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=BI(e,s),t-=s,r.EncryptionVerifier=UI(e,t),r}function Bte(e){var t={},r=t.EncryptionVersionInfo=Oo(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function SS(e){var t=0,r,n=LI(e),s=n.length+1,a,i,o,c,f;for(r=Bl(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=(t&16384)===0?0:1,c=t<<1&32767,f=o|c,t=f^i;return t^52811}var zI=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,f=i.length-1;f>=0;--f)for(var h=i[f],p=0;p!=7;++p)h&64&&(o^=r[c]),h*=2,--c;return o};return function(i){for(var o=LI(i),c=a(o),f=o.length,h=Bl(16),p=0;p!=16;++p)h[p]=0;var x,g,v;for((f&1)===1&&(x=c>>8,h[f]=s(e[0],x),--f,x=c&255,g=o[o.length-1],h[f]=s(g,x));f>0;)--f,x=c>>8,h[f]=s(o[f],x),--f,x=c&255,h[f]=s(o[f],x);for(f=15,v=15-o.length;v>0;)x=c>>8,h[f]=s(e[v],x),--f,--v,x=c&255,h[f]=s(o[f],x),--f,--v;return h}})(),Ute=function(e,t,r,n,s){s||(s=t),n||(n=zI(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},zte=function(e){var t=0,r=zI(e);return function(n){var s=Ute("",n,t,r);return t=s[1],s[0]}};function Hte(e,t,r,n){var s={key:mn(e),verificationBytes:mn(e)};return r.password&&(s.verifier=SS(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=zte(r.password)),s}function Vte(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Bte(e):n.Data=Lte(e,t),n}function qte(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Vte(e,t-2,n):Hte(e,r.biff>=8?t:t-2,r,n),n}var HI=(function(){function e(s,a){switch(a.type){case"base64":return t(ca(s),a);case"binary":return t(s,a);case"buffer":return t(Ft&&Buffer.isBuffer(s)?s.toString("binary"):$l(s),a);case"array":return t(Jc(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,p){Array.isArray(o)&&(o[p]=[]);for(var x=/\\\w+\b/g,g=0,v,y=-1;v=x.exec(h);){switch(v[0]){case"\\cell":var w=h.slice(g,x.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++y,w.length){var _={v:w,t:"s"};Array.isArray(o)?o[p][y]=_:o[bt({r:p,c:y})]=_}break}g=x.lastIndex}y>f.e.c&&(f.e.c=y)}),o["!ref"]=Ct(f),o}function r(s,a){return Gl(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=$t(s["!ref"]),o,c=Array.isArray(s),f=i.s.r;f<=i.e.r;++f){a.push("\\trowd\\trautofit1");for(var h=i.s.c;h<=i.e.c;++h)a.push("\\cellx"+(h+1));for(a.push("\\pard\\intbl"),h=i.s.c;h<=i.e.c;++h){var p=bt({r:f,c:h});o=c?(s[f]||[])[h]:s[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Po(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Wte(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function x0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function $te(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,f=s+a;switch(c=i/(f>1?2-f:f),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,f/2]}function Gte(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var f=0;f!=3;++f)i[f]=Math.round(i[f]*255);return i}function ig(e,t){if(t===0)return e;var r=$te(Wte(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),x0(Gte(r))}var VI=6,Kte=15,Xte=1,is=VI;function g0(e){return Math.floor((e+Math.round(128/is)/256)*is)}function y0(e){return Math.floor((e-5)/is*100+.5)/100}function og(e){return Math.round((e*is+5)/is*256)/256}function Cb(e){return og(y0(g0(e)))}function NS(e){var t=Math.abs(e-Cb(e)),r=is;if(t>.005)for(is=Xte;is<Kte;++is)Math.abs(e-Cb(e))<=t&&(t=Math.abs(e-Cb(e)),r=is);is=r}function Ul(e){e.width?(e.wpx=g0(e.width),e.wch=y0(e.wpx),e.MDW=is):e.wpx?(e.wch=y0(e.wpx),e.width=og(e.wch),e.MDW=is):typeof e.wch=="number"&&(e.width=og(e.wch),e.wpx=g0(e.width),e.MDW=is),e.customWidth&&delete e.customWidth}var Yte=96,qI=Yte;function v0(e){return e*96/qI}function Pf(e){return e*qI/96}var Jte={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Zte(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(ps)||[]).forEach(function(i){var o=_t(i);switch(qi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Nr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Nr(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function Qte(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(ps)||[]).forEach(function(i){var o=_t(i);switch(qi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function ere(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(ps)||[]).forEach(function(i){var o=_t(i);switch(qi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=hr(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Nr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Nr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Nr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Nr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Nr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Nr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Nr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=QE[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Nr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Mc[s.color.index];s.color.index==81&&(c=Mc[1]),c||(c=Mc[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=ig(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function tre(e,t,r){t.NumberFmt=[];for(var n=Wr(yt),s=0;s<n.length;++s)t.NumberFmt[n[s]]=yt[n[s]];var a=e[0].match(ps);if(a)for(s=0;s<a.length;++s){var i=_t(a[s]);switch(qi(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Wt(hr(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}jo(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function rre(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Qe("numFmt",null,{numFmtId:n,formatCode:sr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Qe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var $m=["numFmtId","fillId","fontId","borderId","xfId"],Gm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function nre(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(ps)||[]).forEach(function(a){var i=_t(a),o=0;switch(qi(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<$m.length;++o)n[$m[o]]&&(n[$m[o]]=parseInt(n[$m[o]],10));for(o=0;o<Gm.length;++o)n[Gm[o]]&&(n[Gm[o]]=Nr(n[Gm[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Nr(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function sre(e){var t=[];return t[t.length]=Qe("cellXfs",null),e.forEach(function(r){t[t.length]=Qe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Qe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var are=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,f){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&tre(p,h,f),(p=o.match(s))&&ere(p,h,c,f),(p=o.match(n))&&Qte(p,h,c,f),(p=o.match(a))&&Zte(p,h,c,f),(p=o.match(r))&&nre(p,h,f),h}})();function WI(e,t){var r=[Qr,Qe("styleSheet",null,{xmlns:cu[0],"xmlns:vt":bn.vt})],n;return e.SSF&&(n=rre(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=sre(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ire(e,t){var r=e.read_shift(2),n=fs(e);return[r,n]}function ore(e,t,r){r||(r=Le(6+4*t.length)),r.write_shift(2,e),Mn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function lre(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=VZ(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=HZ(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=fs(e),n}function cre(e,t){t||(t=Le(153)),t.write_shift(2,e.sz*20),qZ(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ng(e.color,t);var n=0;return n=2,t.write_shift(1,n),Mn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var ure=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rb,fre=ds;function g5(e,t){t||(t=Le(84)),Rb||(Rb=_1(ure));var r=Rb[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(ng({auto:1},t),ng({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function dre(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function $I(e,t,r){r||(r=Le(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function hh(e,t){return t||(t=Le(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var hre=ds;function pre(e,t){return t||(t=Le(51)),t.write_shift(1,0),hh(null,t),hh(null,t),hh(null,t),hh(null,t),hh(null,t),t.length>t.l?t.slice(0,t.l):t}function mre(e,t){return t||(t=Le(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),rg(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function xre(e,t,r){var n=Le(2052);return n.write_shift(4,e),rg(t,n),rg(r,n),n.length>n.l?n.slice(0,n.l):n}function gre(e,t,r){var n={};n.NumberFmt=[];for(var s in yt)n.NumberFmt[s]=yt[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Uo(e,function(c,f,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],jo(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=ig(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(h),i=!0;break;case 38:a.pop(),i=!1;break;default:if(f.T>0)a.push(h);else if(f.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function yre(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(qe(e,615,ci(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&qe(e,44,ore(s,t[s]))}),qe(e,616))}}function vre(e){var t=1;qe(e,611,ci(t)),qe(e,43,cre({sz:12,color:{theme:1},name:"Calibri",family:2})),qe(e,612)}function bre(e){var t=2;qe(e,603,ci(t)),qe(e,45,g5({patternType:"none"})),qe(e,45,g5({patternType:"gray125"})),qe(e,604)}function wre(e){var t=1;qe(e,613,ci(t)),qe(e,46,pre()),qe(e,614)}function _re(e){var t=1;qe(e,626,ci(t)),qe(e,47,$I({numFmtId:0},65535)),qe(e,627)}function Ere(e,t){qe(e,617,ci(t.length)),t.forEach(function(r){qe(e,47,$I(r,0))}),qe(e,618)}function Sre(e){var t=1;qe(e,619,ci(t)),qe(e,48,mre({xfId:0,name:"Normal"})),qe(e,620)}function Nre(e){var t=0;qe(e,505,ci(t)),qe(e,506)}function Tre(e){var t=0;qe(e,508,xre(t,"TableStyleMedium9","PivotStyleMedium4")),qe(e,509)}function kre(e,t){var r=Us();return qe(r,278),yre(r,e.SSF),vre(r),bre(r),wre(r),_re(r),Ere(r,t.cellXfs),Sre(r),Nre(r),Tre(r),qe(r,279),r.end()}var Are=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Cre(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ps)||[]).forEach(function(s){var a=_t(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[Are.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Rre(){}function jre(){}var Ore=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Dre=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Ire=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Mre(e,t,r){t.themeElements={};var n;[["clrScheme",Ore,Cre],["fontScheme",Dre,Rre],["fmtScheme",Ire,jre]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var Fre=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function GI(e,t){(!e||e.length===0)&&(e=TS());var r,n={};if(!(r=e.match(Fre)))throw new Error("themeElements not found in theme");return Mre(r[0],n,t),n.raw=e,n}function TS(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Qr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Pre(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=BD(a,{type:"array"})}catch{return}var o=aa(i,"theme/theme/theme1.xml",!0);if(o)return GI(o,r)}}function Lre(e){return e.read_shift(4)}function Bre(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Ure(e,4);break;case 2:t.xclrValue=TI(e);break;case 3:t.xclrValue=Lre(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Ure(e,t){return ds(e,t)}function zre(e,t){return ds(e,t)}function Hre(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Bre(e);break;case 6:n[1]=zre(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Vre(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(Hre(e,r-e.l));return{ixfe:n,ext:a}}function qre(e,t){t.forEach(function(r){r[0]})}function Wre(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:fs(e)}}function $re(e){var t=Le(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Mn(e.name,t),t.slice(0,t.l)}function Gre(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Kre(e){var t=Le(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Xre(e,t){var r=Le(8+2*t.length);return r.write_shift(4,e),Mn(t,r),r.slice(0,r.l)}function Yre(e){return e.l+=4,e.read_shift(4)!=0}function Jre(e,t){var r=Le(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Zre(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return Uo(e,function(c,f,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(h),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!f.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function Qre(){var e=Us();return qe(e,332),qe(e,334,ci(1)),qe(e,335,$re({name:"XLDAPR",version:12e4,flags:3496657072})),qe(e,336),qe(e,339,Xre(1,"XLDAPR")),qe(e,52),qe(e,35,ci(514)),qe(e,4096,ci(0)),qe(e,4097,Ia(1)),qe(e,36),qe(e,53),qe(e,340),qe(e,337,Jre(1)),qe(e,51,Kre([[1,0]])),qe(e,338),qe(e,333),e.end()}function ene(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(ps,function(o){var c=_t(o);switch(qi(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==c.name&&(i=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function KI(){var e=[Qr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function tne(e){var t=[];if(!e)return t;var r=1;return(e.match(ps)||[]).forEach(function(n){var s=_t(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function rne(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=bt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function nne(e,t,r){var n=[];return Uo(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function sne(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Uo(e,function(o,c,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},s)}function ane(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var hf=1024;function XI(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Qe("xml",null,{"xmlns:v":ra.v,"xmlns:o":ra.o,"xmlns:x":ra.x,"xmlns:mv":ra.mv}).replace(/\/>/,">"),Qe("o:shapelayout",Qe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Qe("v:shapetype",[Qe("v:stroke",null,{joinstyle:"miter"}),Qe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];hf<e*1e3;)hf+=1e3;return t.forEach(function(a){var i=Ir(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Qe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Qe("v:fill",c,o),h={on:"t",obscured:"t"};++hf,s=s.concat(["<v:shape"+h0({id:"_x0000_s"+hf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Qe("v:shadow",null,h),Qe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Xn("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Xn("x:AutoFill","False"),Xn("x:Row",String(i.r)),Xn("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function y5(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Ir(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=$t(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var f=Ct(c);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var h={a:i.author,t:i.t,r:i.r,T:r};i.h&&(h.h=i.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(h.a==n[p].id){h.a=n[p].name||h.a;break}}a.c.push(h)})}function ine(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=_t(o[0]),f={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=Ir(c.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var p=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!p&&!!p[1]&&ES(p[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),n.push(f)}}}}),n}function YI(e){var t=[Qr,Qe("comments",null,{xmlns:cu[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=sr(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(sr(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Xn("t",sr(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(Xn("t",sr(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function one(e,t){var r=[],n=!1,s={},a=0;return e.replace(ps,function(o,c){var f=_t(o);switch(qi(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function lne(e,t,r){var n=[Qr,Qe("ThreadedComments",null,{xmlns:bn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Qe("threadedComment",Xn("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function cne(e,t){var r=[],n=!1;return e.replace(ps,function(a){var i=_t(a);switch(qi(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function une(e){var t=[Qr,Qe("personList",null,{xmlns:bn.TCMNT,"xmlns:x":cu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Qe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function fne(e){var t={};t.iauthor=e.read_shift(4);var r=hu(e);return t.rfx=r.s,t.ref=bt(r.s),e.l+=16,t}function dne(e,t){return t==null&&(t=Le(36)),t.write_shift(4,e[1].iauthor),md(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var hne=fs;function pne(e){return Mn(e.slice(0,54))}function mne(e,t){var r=[],n=[],s={},a=!1;return Uo(e,function(o,c,f){switch(f){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function xne(e){var t=Us(),r=[];return qe(t,628),qe(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),qe(t,632,pne(s.a)))})}),qe(t,631),qe(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Ir(n[0]),e:Ir(n[0])};qe(t,635,dne([a,s])),s.t&&s.t.length>0&&qe(t,637,LZ(s)),qe(t,636),delete s.iauthor})}),qe(t,634),qe(t,629),t.end()}var gne="application/vnd.ms-office.vbaProject";function yne(e){var t=mt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");mt.utils.cfb_add(t,s,e.FileIndex[n].content)}}),mt.write(t)}function vne(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&mt.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var JI=["xlsb","xlsm","xlam","biff8","xla"];function bne(){return{"!type":"dialog"}}function wne(){return{"!type":"dialog"}}function _ne(){return{"!type":"macro"}}function Ene(){return{"!type":"macro"}}var gf=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,h=i.length>0?parseInt(i,10)|0:0;return o?h+=t.c:--h,c?f+=t.r:--f,s+(o?"":"$")+Dr(h)+(c?"":"$")+Jr(f)}return function(s,a){return t=a,s.replace(e,r)}})(),kS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,AS=(function(){return function(t,r){return t.replace(kS,function(n,s,a,i,o,c){var f=pS(i)-(a?0:r.c),h=hS(c)-(o?0:r.r),p=h==0?"":o?h+1:"["+h+"]",x=f==0?"":a?f+1:"["+f+"]";return s+"R"+p+"C"+x})}})();function ZI(e,t){return e.replace(kS,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Dr(pS(a)+t.c))+(i=="$"?i+o:Jr(hS(o)+t.r))})}function Sne(e,t,r){var n=Vs(t),s=n.s,a=Ir(r),i={r:a.r-s.r,c:a.c-s.c};return ZI(e,i)}function Nne(e){return e.length!=1}function v5(e){return e.replace(/_xlfn\./g,"")}function un(e){e.l+=1}function zl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function QI(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return eM(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=zl(e),o=zl(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function eM(e){var t=zl(e),r=zl(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Tne(e,t,r){if(r.biff<8)return eM(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=zl(e),i=zl(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function tM(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return kne(e);var n=e.read_shift(r&&r.biff==12?4:2),s=zl(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function kne(e){var t=zl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Ane(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Cne(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Rne(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function Rne(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function jne(e,t,r){var n=(e[e.l++]&96)>>5,s=QI(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function One(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=QI(e,a,r);return[n,s,i]}function Dne(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Ine(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function Mne(e,t,r){var n=(e[e.l++]&96)>>5,s=Tne(e,t-1,r);return[n,s]}function Fne(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function b5(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Pne(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Lne(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Bne(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Une(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function zne(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function rM(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Hne(e){return e.read_shift(2),rM(e)}function Vne(e){return e.read_shift(2),rM(e)}function qne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=tM(e,0,r);return[n,s]}function Wne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Cne(e,0,r);return[n,s]}function $ne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=tM(e,0,r);return[n,s,a]}function Gne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Yse[s],aM[s],n]}function Kne(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Xne(e);return[s,(a[0]===0?aM:Xse)[a[1]]]}function Xne(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Yne(e,t,r){e.l+=r&&r.biff==2?3:4}function Jne(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Zne(e){return e.l++,zo[e.read_shift(1)]}function Qne(e){return e.l++,e.read_shift(2)}function ese(e){return e.l++,e.read_shift(1)!==0}function tse(e){return e.l++,cs(e)}function rse(e,t,r){return e.l++,tp(e,t-1,r)}function nse(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Kr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=zo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=cs(e);break;case 2:r[1]=pu(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function sse(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?hu:N1)(e));return s}function ase(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=nse(e,r.biff);return i}function ise(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function ose(e,t,r){if(r.biff==5)return lse(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function lse(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function cse(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function use(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function fse(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function dse(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var hse=ds,pse=ds,mse=ds;function np(e,t,r){return e.l+=2,[Ane(e)]}function CS(e){return e.l+=6,[]}var xse=np,gse=CS,yse=CS,vse=np;function nM(e){return e.l+=2,[mn(e),e.read_shift(2)&1]}var bse=np,wse=nM,_se=CS,Ese=np,Sse=np,Nse=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Tse(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=Nse[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function kse(e){return e.l+=2,[e.read_shift(4)]}function Ase(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Cse(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Rse(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jse(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Ose(e){return e.l+=4,[0,0]}var w5={1:{n:"PtgExp",f:Jne},2:{n:"PtgTbl",f:mse},3:{n:"PtgAdd",f:un},4:{n:"PtgSub",f:un},5:{n:"PtgMul",f:un},6:{n:"PtgDiv",f:un},7:{n:"PtgPower",f:un},8:{n:"PtgConcat",f:un},9:{n:"PtgLt",f:un},10:{n:"PtgLe",f:un},11:{n:"PtgEq",f:un},12:{n:"PtgGe",f:un},13:{n:"PtgGt",f:un},14:{n:"PtgNe",f:un},15:{n:"PtgIsect",f:un},16:{n:"PtgUnion",f:un},17:{n:"PtgRange",f:un},18:{n:"PtgUplus",f:un},19:{n:"PtgUminus",f:un},20:{n:"PtgPercent",f:un},21:{n:"PtgParen",f:un},22:{n:"PtgMissArg",f:un},23:{n:"PtgStr",f:rse},26:{n:"PtgSheet",f:Ase},27:{n:"PtgEndSheet",f:Cse},28:{n:"PtgErr",f:Zne},29:{n:"PtgBool",f:ese},30:{n:"PtgInt",f:Qne},31:{n:"PtgNum",f:tse},32:{n:"PtgArray",f:Fne},33:{n:"PtgFunc",f:Gne},34:{n:"PtgFuncVar",f:Kne},35:{n:"PtgName",f:ise},36:{n:"PtgRef",f:qne},37:{n:"PtgArea",f:jne},38:{n:"PtgMemArea",f:cse},39:{n:"PtgMemErr",f:hse},40:{n:"PtgMemNoMem",f:pse},41:{n:"PtgMemFunc",f:use},42:{n:"PtgRefErr",f:fse},43:{n:"PtgAreaErr",f:Dne},44:{n:"PtgRefN",f:Wne},45:{n:"PtgAreaN",f:Mne},46:{n:"PtgMemAreaN",f:Rse},47:{n:"PtgMemNoMemN",f:jse},57:{n:"PtgNameX",f:ose},58:{n:"PtgRef3d",f:$ne},59:{n:"PtgArea3d",f:One},60:{n:"PtgRefErr3d",f:dse},61:{n:"PtgAreaErr3d",f:Ine},255:{}},Dse={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ise={1:{n:"PtgElfLel",f:nM},2:{n:"PtgElfRw",f:Ese},3:{n:"PtgElfCol",f:xse},6:{n:"PtgElfRwV",f:Sse},7:{n:"PtgElfColV",f:vse},10:{n:"PtgElfRadical",f:bse},11:{n:"PtgElfRadicalS",f:_se},13:{n:"PtgElfColS",f:gse},15:{n:"PtgElfColSV",f:yse},16:{n:"PtgElfRadicalLel",f:wse},25:{n:"PtgList",f:Tse},29:{n:"PtgSxName",f:kse},255:{}},Mse={0:{n:"PtgAttrNoop",f:Ose},1:{n:"PtgAttrSemi",f:zne},2:{n:"PtgAttrIf",f:Bne},4:{n:"PtgAttrChoose",f:Pne},8:{n:"PtgAttrGoto",f:Lne},16:{n:"PtgAttrSum",f:Yne},32:{n:"PtgAttrBaxcel",f:b5},33:{n:"PtgAttrBaxcel",f:b5},64:{n:"PtgAttrSpace",f:Hne},65:{n:"PtgAttrSpaceSemi",f:Vne},128:{n:"PtgAttrIfError",f:Une},255:{}};function sp(e,t,r,n){if(n.biff<8)return ds(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=ase(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=sse(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(ds(e,t)),a}function ap(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=w5[a]||w5[Dse[a]],(a===24||a===25)&&(s=(a===24?Ise:Mse)[e[e.l+1]]),!s||!s.f?ds(e,t):i.push([s.n,s.f(e,t,r)]);return i}function Fse(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Pse={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Lse(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function sM(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _5(e,t,r){var n=sM(e,t,r);return n=="#REF"?n:Lse(n,r)}function as(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,f,h,p=0,x=0,g,v="";if(!e[0]||!e[0][0])return"";for(var y=-1,w="",_=0,S=e[0].length;_<S;++_){var E=e[0][_];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),f=o.pop(),y>=0){switch(e[0][y][1][0]){case 0:w=Hr(" ",e[0][y][1][1]);break;case 1:w=Hr("\r",e[0][y][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+w,y=-1}o.push(f+Pse[E[0]]+c);break;case"PtgIsect":c=o.pop(),f=o.pop(),o.push(f+" "+c);break;case"PtgUnion":c=o.pop(),f=o.pop(),o.push(f+","+c);break;case"PtgRange":c=o.pop(),f=o.pop(),o.push(f+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Ph(E[1][1],i,s),o.push(Lh(h,a));break;case"PtgRefN":h=r?Ph(E[1][1],r,s):E[1][1],o.push(Lh(h,a));break;case"PtgRef3d":p=E[1][1],h=Ph(E[1][2],i,s),v=_5(n,p,s),o.push(v+"!"+Lh(h,a));break;case"PtgFunc":case"PtgFuncVar":var N=E[1][0],k=E[1][1];N||(N=0),N&=127;var O=N==0?[]:o.slice(-N);o.length-=N,k==="User"&&(k=O.shift()),o.push(k+"("+O.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":g=J3(E[1][1],r?{s:r}:i,s),o.push(Tb(g,s));break;case"PtgArea":g=J3(E[1][1],i,s),o.push(Tb(g,s));break;case"PtgArea3d":p=E[1][1],g=E[1][2],v=_5(n,p,s),o.push(v+"!"+Tb(g,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=E[1][2];var R=(n.names||[])[x-1]||(n[0]||[])[x],V=R?R.Name:"SH33TJSNAME"+String(x);V&&V.slice(0,6)=="_xlfn."&&!s.xlfn&&(V=V.slice(6)),o.push(V);break;case"PtgNameX":var I=E[1][1];x=E[1][2];var Z;if(s.biff<=5)I<0&&(I=-I),n[I]&&(Z=n[I][x]);else{var ce="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][x]&&n[I][x].itab>0&&(ce=n.SheetNames[n[I][x].itab-1]+"!"):ce=n.SheetNames[x-1]+"!"),n[I]&&n[I][x])ce+=n[I][x].Name;else if(n[0]&&n[0][x])ce+=n[0][x].Name;else{var F=(sM(n,I,s)||"").split(";;");F[x-1]?ce=F[x-1]:ce+="SH33TJSERRX"}o.push(ce);break}Z||(Z={Name:"SH33TJSERRY"}),o.push(Z.Name);break;case"PtgParen":var X="(",P=")";if(y>=0){switch(w="",e[0][y][1][0]){case 2:X=Hr(" ",e[0][y][1][1])+X;break;case 3:X=Hr("\r",e[0][y][1][1])+X;break;case 4:P=Hr(" ",e[0][y][1][1])+P;break;case 5:P=Hr("\r",e[0][y][1][1])+P;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}o.push(X+o.pop()+P);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:E[1][1],r:E[1][0]};var ie={c:r.c,r:r.r};if(n.sharedf[bt(h)]){var te=n.sharedf[bt(h)];o.push(as(te,i,ie,n,s))}else{var Y=!1;for(c=0;c!=n.arrayf.length;++c)if(f=n.arrayf[c],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){o.push(as(f[1],i,ie,n,s)),Y=!0;break}Y||o.push(E[1])}break;case"PtgArray":o.push("{"+Fse(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&ve.indexOf(e[0][_][0])==-1){E=e[0][y];var oe=!0;switch(E[1][0]){case 4:oe=!1;case 0:w=Hr(" ",E[1][1]);break;case 5:oe=!1;case 1:w=Hr("\r",E[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((oe?w:"")+o.pop()+(oe?"":w)),y=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Bse(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],ds(e,t-2)];var o=ap(e,i,r);return t!==i+s&&(a=sp(e,t-i-s,o,r)),e.l=n,[o,a]}function Use(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],ds(e,t-2)];var o=ap(e,i,r);return t!==i+s&&(a=sp(e,t-i-s,o,r)),e.l=n,[o,a]}function zse(e,t,r,n){var s=e.l+t,a=ap(e,n,r),i;return s!==e.l&&(i=sp(e,s-e.l,a,r)),[a,i]}function Hse(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=ap(e,a,r);return a==65535?[[],ds(e,t-2)]:(t!==a+2&&(s=sp(e,n-a-2,i,r)),[i,s])}function Vse(e){var t;if(So(e,e.l+6)!==65535)return[cs(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function qse(e){if(e==null){var t=Le(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Zc(e);return Zc(0)}function jb(e,t,r){var n=e.l+t,s=Wi(e);r.biff==2&&++e.l;var a=Vse(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Use(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Wse(e,t,r,n,s){var a=eu(t,r,s),i=qse(e.v),o=Le(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var f=Le(e.bf.length),h=0;h<e.bf.length;++h)f[h]=e.bf[h];var p=Dn([a,i,o,f]);return p}function T1(e,t,r){var n=e.read_shift(4),s=ap(e,n,r),a=e.read_shift(4),i=a>0?sp(e,a,s,r):null;return[s,i]}var $se=T1,k1=T1,Gse=T1,Kse=T1,Xse={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},aM={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Yse={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function E5(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Jse(e){var t="of:="+e.replace(kS,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ob(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Zse(e){return e.replace(/\./,"!")}var Uh={},yf={},zh=typeof Map<"u";function RS(e,t,r){var n=0,s=e.length;if(r){if(zh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=zh?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(zh?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function A1(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(is=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=y0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=og(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Lc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Kl(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){jo(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function iM(e,t,r,n,s,a){try{n.cellNF&&(e.z=yt[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Tr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(yt[t]==null&&jo(XJ[t]||"General",t),e.t==="e")e.w=e.w||zo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=f0(e.v);else if(e.t==="d"){var i=_n(e.v);(i|0)===i?e.w=i.toString(10):e.w=f0(i)}else{if(e.v===void 0)return"";e.w=Yc(e.v,yf)}else e.t==="d"?e.w=qa(t,_n(e.v),yf):e.w=qa(t,e.v,yf)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ig(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ig(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function Qse(e,t,r){if(e&&e["!ref"]){var n=$t(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function eae(e,t){var r=$t(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ct(r))}var tae=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,rae=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,nae=/<(?:\w:)?hyperlink [^>]*>/mg,sae=/"(\w*:\w*)"/,aae=/<(?:\w:)?col\b[^>]*[\/]?>/g,iae=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,oae=/<(?:\w:)?pageMargins[^>]*\/>/g,oM=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,lae=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,cae=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function uae(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",p=e.match(rae);p?(f=e.slice(0,p.index),h=e.slice(p.index+p[0].length)):f=h=e;var x=f.match(oM);x?jS(x[0],o,s,r):(x=f.match(lae))&&dae(x[0],x[1]||"",o,s,r);var g=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var v=f.slice(g,g+50).match(sae);v&&eae(o,v[1])}var y=f.match(cae);y&&y[1]&&Nae(y[1],s);var w=[];if(t.cellStyles){var _=f.match(aae);_&&bae(w,_)}p&&Aae(p[1],o,t,c,a,i);var S=h.match(iae);S&&(o["!autofilter"]=_ae(S[0]));var E=[],N=h.match(tae);if(N)for(g=0;g!=N.length;++g)E[g]=$t(N[g].slice(N[g].indexOf('"')+1));var k=h.match(nae);k&&gae(o,k,n);var O=h.match(oae);if(O&&(o["!margins"]=yae(_t(O[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ct(c)),t.sheetRows>0&&o["!ref"]){var R=$t(o["!ref"]);t.sheetRows<=+R.e.r&&(R.e.r=t.sheetRows-1,R.e.r>c.e.r&&(R.e.r=c.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>c.e.c&&(R.e.c=c.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ct(R))}return w.length>0&&(o["!cols"]=w),E.length>0&&(o["!merges"]=E),o}function fae(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ct(e[r])+'"/>';return t+"</mergeCells>"}function jS(e,t,r,n){var s=_t(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Wt(hr(s.codeName)))}function dae(e,t,r,n,s){jS(e.slice(0,e.indexOf(">")),r,n,s)}function hae(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Fi(sr(c))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),o=(o||"")+Qe("outlinePr",null,f)}!a&&!o||(s[s.length]=Qe("sheetPr",o,i))}var pae=["objects","scenarios","selectLockedCells","selectUnlockedCells"],mae=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function xae(e){var t={sheet:1};return pae.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),mae.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=SS(e.password).toString(16).toUpperCase()),Qe("sheetProtection",null,t)}function gae(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=_t(hr(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Wt(a.location))):(a.Target="#"+Wt(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=$t(a.ref),c=o.s.r;c<=o.e.r;++c)for(var f=o.s.c;f<=o.e.c;++f){var h=bt({c:f,r:c});n?(e[c]||(e[c]=[]),e[c][f]||(e[c][f]={t:"z",v:void 0}),e[c][f].l=a):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=a)}}}function yae(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function vae(e){return Lc(e),Qe("pageMargins",null,e)}function bae(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=_t(t[n],!0);s.hidden&&(s.hidden=Nr(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,NS(s.width)),Ul(s);a<=i;)e[a++]=kr(s)}}function wae(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Qe("col",null,A1(s,n)));return r[r.length]="</cols>",r.join("")}function _ae(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Eae(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Ct(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Vs(s);i.s.r==i.e.r&&(i.e.r=Vs(t["!ref"]).e.r,s=Ct(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Qe("autoFilter",null,{ref:s})}var Sae=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Nae(e,t){t.Views||(t.Views=[{}]),(e.match(Sae)||[]).forEach(function(r,n){var s=_t(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Nr(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function Tae(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Qe("sheetViews",Qe("sheetView",null,s),{})}function kae(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=zo[e.v];break;case"d":n&&n.cellDates?s=Tr(e.v,-1).toISOString():(e=kr(e),e.t="n",s=""+(e.v=_n(Tr(e.v)))),typeof e.z>"u"&&(e.z=yt[14]);break;default:s=e.v;break}var o=Xn("v",sr(s)),c={r:t},f=Kl(n.cellXfs,e,n);switch(f!==0&&(c.s=f),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Xn("v",""+RS(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Qe("f",sr(e.f),h)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Qe("c",o,c)}var Aae=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=d0("v"),i=d0("f");return function(c,f,h,p,x,g){for(var v=0,y="",w=[],_=[],S=0,E=0,N=0,k="",O,R,V=0,I=0,Z,ce,F=0,X=0,P=Array.isArray(g.CellXf),ie,te=[],Y=[],ve=Array.isArray(f),oe=[],Ee={},K=!1,D=!!h.sheetStubs,q=c.split(t),W=0,J=q.length;W!=J;++W){y=q[W].trim();var re=y.length;if(re!==0){var U=0;e:for(v=0;v<re;++v)switch(y[v]){case">":if(y[v-1]!="/"){++v;break e}if(h&&h.cellStyles){if(R=_t(y.slice(U,v),!0),V=R.r!=null?parseInt(R.r,10):V+1,I=-1,h.sheetRows&&h.sheetRows<V)continue;Ee={},K=!1,R.ht&&(K=!0,Ee.hpt=parseFloat(R.ht),Ee.hpx=Pf(Ee.hpt)),R.hidden=="1"&&(K=!0,Ee.hidden=!0),R.outlineLevel!=null&&(K=!0,Ee.level=+R.outlineLevel),K&&(oe[V-1]=Ee)}break;case"<":U=v;break}if(U>=v)break;if(R=_t(y.slice(U,v),!0),V=R.r!=null?parseInt(R.r,10):V+1,I=-1,!(h.sheetRows&&h.sheetRows<V)){p.s.r>V-1&&(p.s.r=V-1),p.e.r<V-1&&(p.e.r=V-1),h&&h.cellStyles&&(Ee={},K=!1,R.ht&&(K=!0,Ee.hpt=parseFloat(R.ht),Ee.hpx=Pf(Ee.hpt)),R.hidden=="1"&&(K=!0,Ee.hidden=!0),R.outlineLevel!=null&&(K=!0,Ee.level=+R.outlineLevel),K&&(oe[V-1]=Ee)),w=y.slice(v).split(e);for(var L=0;L!=w.length&&w[L].trim().charAt(0)=="<";++L);for(w=w.slice(L),v=0;v!=w.length;++v)if(y=w[v].trim(),y.length!==0){if(_=y.match(r),S=v,E=0,N=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,_!=null&&_.length===2){for(S=0,k=_[1],E=0;E!=k.length&&!((N=k.charCodeAt(E)-64)<1||N>26);++E)S=26*S+N;--S,I=S}else++I;for(E=0;E!=y.length&&y.charCodeAt(E)!==62;++E);if(++E,R=_t(y.slice(0,E),!0),R.r||(R.r=bt({r:V-1,c:I})),k=y.slice(E),O={t:""},(_=k.match(a))!=null&&_[1]!==""&&(O.v=Wt(_[1])),h.cellFormula){if((_=k.match(i))!=null&&_[1]!==""){if(O.f=Wt(hr(_[1])).replace(/\r\n/g,`
`),h.xlfn||(O.f=v5(O.f)),_[0].indexOf('t="array"')>-1)O.F=(k.match(s)||[])[1],O.F.indexOf(":")>-1&&te.push([$t(O.F),O.F]);else if(_[0].indexOf('t="shared"')>-1){ce=_t(_[0]);var se=Wt(hr(_[1]));h.xlfn||(se=v5(se)),Y[parseInt(ce.si,10)]=[ce,se,R.r]}}else(_=k.match(/<f[^>]*\/>/))&&(ce=_t(_[0]),Y[ce.si]&&(O.f=Sne(Y[ce.si][1],Y[ce.si][2],R.r)));var Q=Ir(R.r);for(E=0;E<te.length;++E)Q.r>=te[E][0].s.r&&Q.r<=te[E][0].e.r&&Q.c>=te[E][0].s.c&&Q.c<=te[E][0].e.c&&(O.F=te[E][1])}if(R.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(D)O.t="z";else continue;else O.t=R.t||"n";switch(p.s.c>I&&(p.s.c=I),p.e.c<I&&(p.e.c=I),O.t){case"n":if(O.v==""||O.v==null){if(!D)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!D)continue;O.t="z"}else Z=Uh[parseInt(O.v,10)],O.v=Z.t,O.r=Z.r,h.cellHTML&&(O.h=Z.h);break;case"str":O.t="s",O.v=O.v!=null?hr(O.v):"",h.cellHTML&&(O.h=cS(O.v));break;case"inlineStr":_=k.match(n),O.t="s",_!=null&&(Z=ES(_[1]))?(O.v=Z.t,h.cellHTML&&(O.h=Z.h)):O.v="";break;case"b":O.v=Nr(O.v);break;case"d":h.cellDates?O.v=Tr(O.v,1):(O.v=_n(Tr(O.v,1)),O.t="n");break;case"e":(!h||h.cellText!==!1)&&(O.w=O.v),O.v=cI[O.v];break}if(F=X=0,ie=null,P&&R.s!==void 0&&(ie=g.CellXf[R.s],ie!=null&&(ie.numFmtId!=null&&(F=ie.numFmtId),h.cellStyles&&ie.fillId!=null&&(X=ie.fillId))),iM(O,F,X,h,x,g),h.cellDates&&P&&O.t=="n"&&dd(yt[F])&&(O.t="d",O.v=S1(O.v)),R.cm&&h.xlmeta){var ee=(h.xlmeta.Cell||[])[+R.cm-1];ee&&ee.type=="XLDAPR"&&(O.D=!0)}if(ve){var B=Ir(R.r);f[B.r]||(f[B.r]=[]),f[B.r][B.c]=O}else f[R.r]=O}}}}oe.length>0&&(f["!rows"]=oe)}})();function Cae(e,t,r,n){var s=[],a=[],i=$t(e["!ref"]),o="",c,f="",h=[],p=0,x=0,g=e["!rows"],v=Array.isArray(e),y={r:f},w,_=-1;for(x=i.s.c;x<=i.e.c;++x)h[x]=Dr(x);for(p=i.s.r;p<=i.e.r;++p){for(a=[],f=Jr(p),x=i.s.c;x<=i.e.c;++x){c=h[x]+f;var S=v?(e[p]||[])[x]:e[c];S!==void 0&&(o=kae(S,c,e,t))!=null&&a.push(o)}(a.length>0||g&&g[p])&&(y={r:f},g&&g[p]&&(w=g[p],w.hidden&&(y.hidden=1),_=-1,w.hpx?_=v0(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(y.ht=_,y.customHeight=1),w.level&&(y.outlineLevel=w.level)),s[s.length]=Qe("row",a.join(""),y))}if(g)for(;p<g.length;++p)g&&g[p]&&(y={r:p+1},w=g[p],w.hidden&&(y.hidden=1),_=-1,w.hpx?_=v0(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(y.ht=_,y.customHeight=1),w.level&&(y.outlineLevel=w.level),s[s.length]=Qe("row","",y));return s.join("")}function lM(e,t,r,n){var s=[Qr,Qe("worksheet",null,{xmlns:cu[0],"xmlns:r":bn.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var f=c["!ref"]||"A1",h=$t(f);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),f=Ct(h)}n||(n={}),c["!comments"]=[];var p=[];hae(c,r,e,t,s),s[s.length]=Qe("dimension",null,{ref:f}),s[s.length]=Tae(c,t,e,r),t.sheetFormat&&(s[s.length]=Qe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=wae(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=Cae(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=xae(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=Eae(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=fae(c["!merges"]));var x=-1,g,v=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(y){y[1].Target&&(g={ref:y[0]},y[1].Target.charAt(0)!="#"&&(v=nr(n,-1,sr(y[1].Target).replace(/#.*$/,""),Pt.HLINK),g["r:id"]="rId"+v),(x=y[1].Target.indexOf("#"))>-1&&(g.location=sr(y[1].Target.slice(x+1))),y[1].Tooltip&&(g.tooltip=sr(y[1].Tooltip)),s[s.length]=Qe("hyperlink",null,g))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=vae(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Xn("ignoredErrors",Qe("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(v=nr(n,-1,"../drawings/drawing"+(e+1)+".xml",Pt.DRAW),s[s.length]=Qe("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=p),c["!comments"].length>0&&(v=nr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Pt.VML),s[s.length]=Qe("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Rae(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function jae(e,t,r){var n=Le(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=v0(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var f={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var p=-1,x=-1,g=h<<10;g<h+1<<10;++g){f.c=g;var v=Array.isArray(r)?(r[f.r]||[])[f.c]:r[bt(f)];v&&(p<0&&(p=g),x=g)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,x))}var y=n.l;return n.l=c,n.write_shift(4,o),n.l=y,n.length>n.l?n.slice(0,n.l):n}function Oae(e,t,r,n){var s=jae(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&qe(e,0,s)}var Dae=hu,Iae=md;function Mae(){}function Fae(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=BZ(e),r}function Pae(e,t,r){r==null&&(r=Le(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return ng({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),sI(e,r),r.slice(0,r.l)}function Lae(e){var t=Xa(e);return[t]}function Bae(e,t,r){return r==null&&(r=Le(8)),uu(t,r)}function Uae(e){var t=fu(e);return[t]}function zae(e,t,r){return r==null&&(r=Le(4)),du(t,r)}function Hae(e){var t=Xa(e),r=e.read_shift(1);return[t,r,"b"]}function Vae(e,t,r){return r==null&&(r=Le(9)),uu(t,r),r.write_shift(1,e.v?1:0),r}function qae(e){var t=fu(e),r=e.read_shift(1);return[t,r,"b"]}function Wae(e,t,r){return r==null&&(r=Le(5)),du(t,r),r.write_shift(1,e.v?1:0),r}function $ae(e){var t=Xa(e),r=e.read_shift(1);return[t,r,"e"]}function Gae(e,t,r){return r==null&&(r=Le(9)),uu(t,r),r.write_shift(1,e.v),r}function Kae(e){var t=fu(e),r=e.read_shift(1);return[t,r,"e"]}function Xae(e,t,r){return r==null&&(r=Le(8)),du(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Yae(e){var t=Xa(e),r=e.read_shift(4);return[t,r,"s"]}function Jae(e,t,r){return r==null&&(r=Le(12)),uu(t,r),r.write_shift(4,t.v),r}function Zae(e){var t=fu(e),r=e.read_shift(4);return[t,r,"s"]}function Qae(e,t,r){return r==null&&(r=Le(8)),du(t,r),r.write_shift(4,t.v),r}function eie(e){var t=Xa(e),r=cs(e);return[t,r,"n"]}function tie(e,t,r){return r==null&&(r=Le(16)),uu(t,r),Zc(e.v,r),r}function cM(e){var t=fu(e),r=cs(e);return[t,r,"n"]}function rie(e,t,r){return r==null&&(r=Le(12)),du(t,r),Zc(e.v,r),r}function nie(e){var t=Xa(e),r=yS(e);return[t,r,"n"]}function sie(e,t,r){return r==null&&(r=Le(12)),uu(t,r),aI(e.v,r),r}function aie(e){var t=fu(e),r=yS(e);return[t,r,"n"]}function iie(e,t,r){return r==null&&(r=Le(8)),du(t,r),aI(e.v,r),r}function oie(e){var t=Xa(e),r=mS(e);return[t,r,"is"]}function lie(e){var t=Xa(e),r=fs(e);return[t,r,"str"]}function cie(e,t,r){return r==null&&(r=Le(12+4*e.v.length)),uu(t,r),Mn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function uie(e){var t=fu(e),r=fs(e);return[t,r,"str"]}function fie(e,t,r){return r==null&&(r=Le(8+4*e.v.length)),du(t,r),Mn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function die(e,t,r){var n=e.l+t,s=Xa(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=k1(e,n-e.l,r);i[3]=as(o,null,s,r.supbooks,r)}else e.l=n;return i}function hie(e,t,r){var n=e.l+t,s=Xa(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=k1(e,n-e.l,r);i[3]=as(o,null,s,r.supbooks,r)}else e.l=n;return i}function pie(e,t,r){var n=e.l+t,s=Xa(e);s.r=r["!row"];var a=cs(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=k1(e,n-e.l,r);i[3]=as(o,null,s,r.supbooks,r)}else e.l=n;return i}function mie(e,t,r){var n=e.l+t,s=Xa(e);s.r=r["!row"];var a=fs(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=k1(e,n-e.l,r);i[3]=as(o,null,s,r.supbooks,r)}else e.l=n;return i}var xie=hu,gie=md;function yie(e,t){return t==null&&(t=Le(4)),t.write_shift(4,e),t}function vie(e,t){var r=e.l+t,n=hu(e),s=xS(e),a=fs(e),i=fs(e),o=fs(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function bie(e,t){var r=Le(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));md({s:Ir(e[0]),e:Ir(e[0])},r),gS("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Mn(s||"",r),Mn(e[1].Tooltip||"",r),Mn("",r),r.slice(0,r.l)}function wie(){}function _ie(e,t,r){var n=e.l+t,s=iI(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=$se(e,n-e.l,r);i[1]=o}else e.l=n;return i}function Eie(e,t,r){var n=e.l+t,s=hu(e),a=[s];if(r.cellFormula){var i=Kse(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function Sie(e,t,r){r==null&&(r=Le(18));var n=A1(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var uM=["left","right","top","bottom","header","footer"];function Nie(e){var t={};return uM.forEach(function(r){t[r]=cs(e)}),t}function Tie(e,t){return t==null&&(t=Le(48)),Lc(e),uM.forEach(function(r){Zc(e[r],t)}),t}function kie(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Aie(e,t,r){r==null&&(r=Le(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Cie(e){var t=Le(24);return t.write_shift(4,4),t.write_shift(4,1),md(e,t),t}function Rie(e,t){return t==null&&(t=Le(66)),t.write_shift(2,e.password?SS(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function jie(){}function Oie(){}function Die(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,x=!1,g,v,y,w,_,S,E,N,k,O=[];o.biff=12,o["!row"]=0;var R=0,V=!1,I=[],Z={},ce=o.supbooks||s.supbooks||[[]];if(ce.sharedf=Z,ce.arrayf=I,ce.SheetNames=s.SheetNames||s.Sheets.map(function(ve){return ve.name}),!o.supbooks&&(o.supbooks=ce,s.Names))for(var F=0;F<s.Names.length;++F)ce[0][F+1]=s.Names[F];var X=[],P=[],ie=!1;b0[16]={n:"BrtShortReal",f:cM};var te;if(Uo(e,function(oe,Ee,K){if(!x)switch(K){case 148:f=oe;break;case 0:g=oe,o.sheetRows&&o.sheetRows<=g.r&&(x=!0),N=Jr(w=g.r),o["!row"]=g.r,(oe.hidden||oe.hpt||oe.level!=null)&&(oe.hpt&&(oe.hpx=Pf(oe.hpt)),P[oe.r]=oe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:oe[2]},oe[2]){case"n":v.v=oe[1];break;case"s":E=Uh[oe[1]],v.v=E.t,v.r=E.r;break;case"b":v.v=!!oe[1];break;case"e":v.v=oe[1],o.cellText!==!1&&(v.w=zo[v.v]);break;case"str":v.t="s",v.v=oe[1];break;case"is":v.t="s",v.v=oe[1].t;break}if((y=i.CellXf[oe[0].iStyleRef])&&iM(v,y.numFmtId,null,o,a,i),_=oe[0].c==-1?_+1:oe[0].c,o.dense?(c[w]||(c[w]=[]),c[w][_]=v):c[Dr(_)+N]=v,o.cellFormula){for(V=!1,R=0;R<I.length;++R){var D=I[R];g.r>=D[0].s.r&&g.r<=D[0].e.r&&_>=D[0].s.c&&_<=D[0].e.c&&(v.F=Ct(D[0]),V=!0)}!V&&oe.length>3&&(v.f=oe[3])}if(h.s.r>g.r&&(h.s.r=g.r),h.s.c>_&&(h.s.c=_),h.e.r<g.r&&(h.e.r=g.r),h.e.c<_&&(h.e.c=_),o.cellDates&&y&&v.t=="n"&&dd(yt[y.numFmtId])){var q=Nc(v.v);q&&(v.t="d",v.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}te&&(te.type=="XLDAPR"&&(v.D=!0),te=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;v={t:"z",v:void 0},_=oe[0].c==-1?_+1:oe[0].c,o.dense?(c[w]||(c[w]=[]),c[w][_]=v):c[Dr(_)+N]=v,h.s.r>g.r&&(h.s.r=g.r),h.s.c>_&&(h.s.c=_),h.e.r<g.r&&(h.e.r=g.r),h.e.c<_&&(h.e.c=_),te&&(te.type=="XLDAPR"&&(v.D=!0),te=void 0);break;case 176:O.push(oe);break;case 49:te=((o.xlmeta||{}).Cell||[])[oe-1];break;case 494:var W=n["!id"][oe.relId];for(W?(oe.Target=W.Target,oe.loc&&(oe.Target+="#"+oe.loc),oe.Rel=W):oe.relId==""&&(oe.Target="#"+oe.loc),w=oe.rfx.s.r;w<=oe.rfx.e.r;++w)for(_=oe.rfx.s.c;_<=oe.rfx.e.c;++_)o.dense?(c[w]||(c[w]=[]),c[w][_]||(c[w][_]={t:"z",v:void 0}),c[w][_].l=oe):(S=bt({c:_,r:w}),c[S]||(c[S]={t:"z",v:void 0}),c[S].l=oe);break;case 426:if(!o.cellFormula)break;I.push(oe),k=o.dense?c[w][_]:c[Dr(_)+N],k.f=as(oe[1],h,{r:g.r,c:_},ce,o),k.F=Ct(oe[0]);break;case 427:if(!o.cellFormula)break;Z[bt(oe[0].s)]=oe[1],k=o.dense?c[w][_]:c[Dr(_)+N],k.f=as(oe[1],h,{r:g.r,c:_},ce,o);break;case 60:if(!o.cellStyles)break;for(;oe.e>=oe.s;)X[oe.e--]={width:oe.w/256,hidden:!!(oe.flags&1),level:oe.level},ie||(ie=!0,NS(oe.w/256)),Ul(X[oe.e+1]);break;case 161:c["!autofilter"]={ref:Ct(oe)};break;case 476:c["!margins"]=oe;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),oe.name&&(s.Sheets[r].CodeName=oe.name),(oe.above||oe.left)&&(c["!outline"]={above:oe.above,left:oe.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),oe.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!Ee.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(c["!ref"]=Ct(f||h)),o.sheetRows&&c["!ref"]){var Y=$t(c["!ref"]);o.sheetRows<=+Y.e.r&&(Y.e.r=o.sheetRows-1,Y.e.r>h.e.r&&(Y.e.r=h.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>h.e.c&&(Y.e.c=h.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ct(Y))}return O.length>0&&(c["!merges"]=O),X.length>0&&(c["!cols"]=X),P.length>0&&(c["!rows"]=P),c}function Iie(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=kr(t),t.z=t.z||yt[14],t.v=_n(Tr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Kl(s.cellXfs,t,s),t.l&&a["!links"].push([bt(c),t.l]),t.c&&a["!comments"].push([bt(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=RS(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?qe(e,18,Qae(t,c)):qe(e,7,Jae(t,c))):(c.t="str",i?qe(e,17,fie(t,c)):qe(e,6,cie(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?qe(e,13,iie(t,c)):qe(e,2,sie(t,c)):i?qe(e,16,rie(t,c)):qe(e,5,tie(t,c)),!0;case"b":return c.t="b",i?qe(e,15,Wae(t,c)):qe(e,4,Vae(t,c)),!0;case"e":return c.t="e",i?qe(e,14,Xae(t,c)):qe(e,3,Gae(t,c)),!0}return i?qe(e,12,zae(t,c)):qe(e,1,Bae(t,c)),!0}function Mie(e,t,r,n){var s=$t(t["!ref"]||"A1"),a,i="",o=[];qe(e,145);var c=Array.isArray(t),f=s.e.r;t["!rows"]&&(f=Math.max(s.e.r,t["!rows"].length-1));for(var h=s.s.r;h<=f;++h){i=Jr(h),Oae(e,t,s,h);var p=!1;if(h<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){h===s.s.r&&(o[x]=Dr(x)),a=o[x]+i;var g=c?(t[h]||[])[x]:t[a];if(!g){p=!1;continue}p=Iie(e,g,h,x,n,t,p)}}qe(e,146)}function Fie(e,t){!t||!t["!merges"]||(qe(e,177,yie(t["!merges"].length)),t["!merges"].forEach(function(r){qe(e,176,gie(r))}),qe(e,178))}function Pie(e,t){!t||!t["!cols"]||(qe(e,390),t["!cols"].forEach(function(r,n){r&&qe(e,60,Sie(n,r))}),qe(e,391))}function Lie(e,t){!t||!t["!ref"]||(qe(e,648),qe(e,649,Cie($t(t["!ref"]))),qe(e,650))}function Bie(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=nr(r,-1,n[1].Target.replace(/#.*$/,""),Pt.HLINK);qe(e,494,bie(n,s))}}),delete t["!links"]}function Uie(e,t,r,n){if(t["!comments"].length>0){var s=nr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Pt.VML);qe(e,551,gS("rId"+s)),t["!legacy"]=s}}function zie(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Ct(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Vs(a);o.s.r==o.e.r&&(o.e.r=Vs(t["!ref"]).e.r,a=Ct(o));for(var c=0;c<i.length;++c){var f=i[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),qe(e,161,md($t(a))),qe(e,162)}}function Hie(e,t,r){qe(e,133),qe(e,137,Aie(t,r)),qe(e,138),qe(e,134)}function Vie(e,t){t["!protect"]&&qe(e,535,Rie(t["!protect"]))}function qie(e,t,r,n){var s=Us(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=$t(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],qe(s,129),(r.vbaraw||i["!outline"])&&qe(s,147,Pae(o,i["!outline"])),qe(s,148,Iae(c)),Hie(s,i,r.Workbook),Pie(s,i),Mie(s,i,e,t),Vie(s,i),zie(s,i,r,e),Fie(s,i),Bie(s,i,n),i["!margins"]&&qe(s,476,Tie(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Lie(s,i),Uie(s,i,e,n),qe(s,130),s.end()}function Wie(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=Wt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function $ie(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var x=Wie(p);h.s.r=h.s.c=0,h.e.c=o,f=Dr(o),x[0].forEach(function(g,v){i[f+Jr(v)]={t:"n",v:g,z:x[1]},c=v}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(i["!ref"]=Ct(h)),i}function Gie(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(oM);return o&&jS(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Kie(e,t){e.l+=10;var r=fs(e);return{name:r}}function Xie(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Uo(e,function(c,f,h){switch(h){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var OS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Yie=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Jie=[],Zie=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function S5(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Nr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function N5(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Nr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function fM(e){N5(e.WBProps,OS),N5(e.CalcPr,Zie),S5(e.WBView,Yie),S5(e.Sheets,Jie),yf.date1904=Nr(e.WBProps.date1904)}function Qie(e){return!e.Workbook||!e.Workbook.WBProps?"false":Nr(e.Workbook.WBProps.date1904)?"true":"false"}var eoe="][*?/\\".split("");function dM(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return eoe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function toe(e,t,r){e.forEach(function(n,s){dM(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function roe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];toe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Qse(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var noe=/<\w+:workbook/;function soe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(ps,function(c,f){var h=_t(c);switch(qi(h[0])){case"<?xml":break;case"<workbook":c.match(noe)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[s];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":OS.forEach(function(p){if(h[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Nr(h[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(h[p[0]],10);break;default:r.WBProps[p[0]]=h[p[0]]}}),h.codeName&&(r.WBProps.CodeName=hr(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Wt(hr(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=hr(h.name),h.comment&&(a.Comment=h.comment),h.localSheetId&&(a.Sheet=+h.localSheetId),Nr(h.hidden||"0")&&(a.Hidden=!0),i=f+c.length;break;case"</definedName>":a.Ref=Wt(hr(e.slice(i,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),cu.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return fM(r),r}function hM(e){var t=[Qr];t[t.length]=Qe("workbook",null,{xmlns:cu[0],"xmlns:r":bn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(OS.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Qe("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:sr(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Qe("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Qe("definedName",sr(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function aoe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=k_(e),r.name=fs(e),r}function ioe(e,t){return t||(t=Le(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),gS(e.strRelID,t),Mn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function ooe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?fs(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function loe(e,t){t||(t=Le(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),sI(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function coe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function uoe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=UZ(e),i=Gse(e,0,r),o=xS(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function foe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],b0[16]={n:"BrtFRTArchID$",f:coe},Uo(e,function(c,f,h){switch(h){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=as(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([h,c]):i[0]=[h,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(h),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!f.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),fM(r),r.Names=a,r.supbooks=i,r}function doe(e,t){qe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};qe(e,156,ioe(s))}qe(e,144)}function hoe(e,t){t||(t=Le(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Mn("SheetJS",t),Mn(Yx.version,t),Mn(Yx.version,t),Mn("7262",t),t.length>t.l?t.slice(0,t.l):t}function poe(e,t){t||(t=Le(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function moe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(qe(e,135),qe(e,158,poe(s)),qe(e,136))}}function xoe(e,t){var r=Us();return qe(r,131),qe(r,128,hoe()),qe(r,153,loe(e.Workbook&&e.Workbook.WBProps||null)),moe(r,e),doe(r,e),qe(r,132),r.end()}function goe(e,t,r){return t.slice(-4)===".bin"?foe(e,r):soe(e,r)}function yoe(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Die(e,n,r,s,a,i,o):uae(e,n,r,s,a,i,o)}function voe(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Xie(e,n,r,s,a):Gie(e,n,r,s,a)}function boe(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?_ne():Ene()}function woe(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?bne():wne()}function _oe(e,t,r,n){return t.slice(-4)===".bin"?gre(e,r,n):are(e,r,n)}function Eoe(e,t,r){return GI(e,r)}function Soe(e,t,r){return t.slice(-4)===".bin"?Ste(e,r):wte(e,r)}function Noe(e,t,r){return t.slice(-4)===".bin"?mne(e,r):ine(e,r)}function Toe(e,t,r){return t.slice(-4)===".bin"?nne(e):tne(e)}function koe(e,t,r,n){return r.slice(-4)===".bin"?sne(e,t,r,n):void 0}function Aoe(e,t,r){return t.slice(-4)===".bin"?Zre(e,t,r):ene(e,t,r)}function Coe(e,t,r){return(t.slice(-4)===".bin"?xoe:hM)(e)}function Roe(e,t,r,n,s){return(t.slice(-4)===".bin"?qie:lM)(e,r,n,s)}function joe(e,t,r){return(t.slice(-4)===".bin"?kre:WI)(e,r)}function Ooe(e,t,r){return(t.slice(-4)===".bin"?kte:PI)(e,r)}function Doe(e,t,r){return(t.slice(-4)===".bin"?xne:YI)(e)}function Ioe(e){return(e.slice(-4)===".bin"?Qre:KI)()}var pM=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,mM=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ti(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(pM),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(mM),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function Moe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(pM),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(mM),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Hh;function Foe(e,t){var r=Hh[e]||Wt(e);return r==="General"?Yc(t):qa(r,t)}function Poe(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Nr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Tr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Wt(t)]=s}function Loe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||zo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=f0(e.v):e.w=Yc(e.v):e.w=Foe(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Hh[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&dd(n)){var s=Nc(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function Boe(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Jte[n.Pattern]||n.Pattern)}e[t.ID]=t}function Uoe(e,t,r,n,s,a,i,o,c,f){var h="General",p=n.StyleID,x={};f=f||{};var g=[],v=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&i&&(p=i.StyleID);a[p]!==void 0&&(a[p].nf&&(h=a[p].nf),a[p].Interior&&g.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Nr(e);break;case"String":n.t="s",n.r=H3(Wt(e)),n.v=e.indexOf("<")>-1?Wt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Tr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Wt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=cI[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=H3(t||e));break}if(Loe(n,h,f),f.cellFormula!==!1)if(n.Formula){var y=Wt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=gf(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=gf("RC:RC",s):n.ArrayRange&&(n.F=gf(n.ArrayRange,s),c.push([$t(n.F),n.F]))}else for(v=0;v<c.length;++v)s.r>=c[v][0].s.r&&s.r<=c[v][0].e.r&&s.c>=c[v][0].s.c&&s.c<=c[v][0].e.c&&(n.F=c[v][1]);f.cellStyles&&(g.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function zoe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Db(e,t){var r=t||{};hd();var n=Th(uS(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=hr(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=kr(r);return i.type="string",Ff.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(j){s.indexOf("<"+j)>=0&&(a=!0)}),a)return Tle(n,r);Hh={"General Number":"General","General Date":yt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":yt[15],"Short Date":yt[14],"Long Time":yt[19],"Medium Time":yt[18],"Short Time":yt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:yt[2],Standard:yt[4],Percent:yt[10],Scientific:yt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],f,h={},p=[],x=r.dense?[]:{},g="",v={},y={},w=ti('<Data ss:Type="String">'),_=0,S=0,E=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},O={},R="",V=0,I=[],Z={},ce={},F=0,X=[],P=[],ie={},te=[],Y,ve=!1,oe=[],Ee=[],K={},D=0,q=0,W={Sheets:[],WBProps:{date1904:!1}},J={};p0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";o=p0.exec(n);)switch(o[3]=(re=o[3]).toLowerCase()){case"data":if(re=="data"){if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Uoe(n.slice(_,o.index),R,w,c[c.length-1][0]=="comment"?ie:v,{c:S,r:E},k,te[S],y,oe,r):(R="",w=ti(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(P.length>0&&(v.c=P),(!r.sheetRows||r.sheetRows>E)&&v.v!==void 0&&(r.dense?(x[E]||(x[E]=[]),x[E][S]=v):x[Dr(S)+Jr(E)]=v),v.HRef&&(v.l={Target:Wt(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(D=S+(parseInt(v.MergeAcross,10)|0),q=E+(parseInt(v.MergeDown,10)|0),I.push({s:{c:S,r:E},e:{c:D,r:q}})),!r.sheetStubs)v.MergeAcross?S=D+1:++S;else if(v.MergeAcross||v.MergeDown){for(var U=S;U<=D;++U)for(var L=E;L<=q;++L)(U>S||L>E)&&(r.dense?(x[L]||(x[L]=[]),x[L][U]={t:"z"}):x[Dr(U)+Jr(L)]={t:"z"});S=D+1}else++S;else v=Moe(o[0]),v.Index&&(S=+v.Index-1),S<N.s.c&&(N.s.c=S),S>N.e.c&&(N.e.c=S),o[0].slice(-2)==="/>"&&++S,P=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<N.s.r&&(N.s.r=E),E>N.e.r&&(N.e.r=E),o[0].slice(-2)==="/>"&&(y=ti(o[0]),y.Index&&(E=+y.Index-1)),S=0,++E):(y=ti(o[0]),y.Index&&(E=+y.Index-1),K={},(y.AutoFitHeight=="0"||y.Height)&&(K.hpx=parseInt(y.Height,10),K.hpt=v0(K.hpx),Ee[E]=K),y.Hidden=="1"&&(K.hidden=!0,Ee[E]=K));break;case"worksheet":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));p.push(g),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(x["!ref"]=Ct(N),r.sheetRows&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=Ct(N))),I.length&&(x["!merges"]=I),te.length>0&&(x["!cols"]=te),Ee.length>0&&(x["!rows"]=Ee),h[g]=x}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=S=0,c.push([o[3],!1]),f=ti(o[0]),g=Wt(f.Name),x=r.dense?[]:{},I=[],oe=[],Ee=[],J={name:g,Hidden:0},W.Sheets.push(J);break;case"table":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),te=[],ve=!1}break;case"style":o[1]==="/"?Boe(k,O,r):O=ti(o[0]);break;case"numberformat":O.nf=Wt(ti(o[0]).Format||"General"),Hh[O.nf]&&(O.nf=Hh[O.nf]);for(var se=0;se!=392&&yt[se]!=O.nf;++se);if(se==392){for(se=57;se!=392;++se)if(yt[se]==null){jo(O.nf,se);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Y=ti(o[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!ve&&Y.wpx>10){ve=!0,is=VI;for(var Q=0;Q<te.length;++Q)te[Q]&&Ul(te[Q])}ve&&Ul(Y),te[Y.Index-1||te.length]=Y;for(var ee=0;ee<+Y.Span;++ee)te[te.length]=kr(Y);break;case"namedrange":if(o[1]==="/")break;W.Names||(W.Names=[]);var B=_t(o[0]),be={Name:B.Name,Ref:gf(B.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(be.Sheet=W.Sheets.length-1),W.Names.push(be);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?R+=n.slice(V,o.index):V=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=ti(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?fQ(Z,re,n.slice(F,o.index)):F=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));zoe(ie),P.push(ie)}else c.push([o[3],!1]),f=ti(o[0]),ie={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var z=ti(o[0]);x["!autofilter"]={ref:gf(z.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return R5(n,r);var he=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:he=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:he=!1}break;case"excelworkbook":switch(o[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:he=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:he=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(F,o.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2;break}else F=o.index+o[0].length;break;case"header":x["!margins"]||Lc(x["!margins"]={},"xlml"),isNaN(+_t(o[0]).Margin)||(x["!margins"].header=+_t(o[0]).Margin);break;case"footer":x["!margins"]||Lc(x["!margins"]={},"xlml"),isNaN(+_t(o[0]).Margin)||(x["!margins"].footer=+_t(o[0]).Margin);break;case"pagemargins":var M=_t(o[0]);x["!margins"]||Lc(x["!margins"]={},"xlml"),isNaN(+M.Top)||(x["!margins"].top=+M.Top),isNaN(+M.Left)||(x["!margins"].left=+M.Left),isNaN(+M.Right)||(x["!margins"].right=+M.Right),isNaN(+M.Bottom)||(x["!margins"].bottom=+M.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:he=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:he=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:he=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:he=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:he=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:he=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:he=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:he=!1}break;case"smarttags":break;default:he=!1;break}if(he||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Poe(ce,re,X,n.slice(F,o.index)):(X=o,F=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var A={};return!r.bookSheets&&!r.bookProps&&(A.Sheets=h),A.SheetNames=p,A.Workbook=W,A.SSF=kr(yt),A.Props=Z,A.Custprops=ce,A}function I_(e,t){switch(IS(t=t||{}),t.type||"base64"){case"base64":return Db(ca(e),t);case"binary":case"buffer":case"file":return Db(e,t);case"array":return Db($l(e),t)}}function Hoe(e,t){var r=[];return e.Props&&r.push(dQ(e.Props,t)),e.Custprops&&r.push(hQ(e.Props,e.Custprops)),r.join("")}function Voe(){return""}function qoe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Qe("NumberFormat",null,{"ss:Format":sr(yt[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Qe("Style",a.join(""),i))}),Qe("Styles",r.join(""))}function xM(e){return Qe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+AS(e.Ref,{r:0,c:0})})}function Woe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(xM(s)))}return Qe("Names",r.join(""))}function $oe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(xM(o)))}return a.join("")}function Goe(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Qe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Qe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Qe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Qe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Xn("ProtectContents","True")),e["!protect"].objects&&s.push(Xn("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Xn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Xn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Xn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Qe("WorksheetOptions",s.join(""),{xmlns:ra.x})}function Koe(e){return e.map(function(t){var r=mZ(t.t||""),n=Qe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Qe("Comment",n,{"ss:Author":t.a})}).join("")}function Xoe(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+sr(AS(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Ir(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=sr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=sr(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],h=0;h!=f.length;++h)f[h].s.c!=i.c||f[h].s.r!=i.r||(f[h].e.c>f[h].s.c&&(o["ss:MergeAcross"]=f[h].e.c-f[h].s.c),f[h].e.r>f[h].s.r&&(o["ss:MergeDown"]=f[h].e.r-f[h].s.r));var p="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",x=String(e.v);break;case"b":p="Boolean",x=e.v?"1":"0";break;case"e":p="Error",x=zo[e.v];break;case"d":p="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||yt[14]);break;case"s":p="String",x=pZ(e.v||"");break}var g=Kl(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=i.c+1;var v=e.v!=null?x:"",y=e.t=="z"?"":'<Data ss:Type="'+p+'">'+v+"</Data>";return(e.c||[]).length>0&&(y+=Koe(e.c)),Qe("Cell",y,o)}function Yoe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Pf(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Joe(e,t,r,n){if(!e["!ref"])return"";var s=$t(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,_){Ul(w);var S=!!w.width,E=A1(_,w),N={"ss:Index":_+1};S&&(N["ss:Width"]=g0(E.width)),w.hidden&&(N["ss:Hidden"]="1"),o.push(Qe("Column",null,N))});for(var c=Array.isArray(e),f=s.s.r;f<=s.e.r;++f){for(var h=[Yoe(f,(e["!rows"]||[])[f])],p=s.s.c;p<=s.e.c;++p){var x=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>p)&&!(a[i].s.r>f)&&!(a[i].e.c<p)&&!(a[i].e.r<f)){(a[i].s.c!=p||a[i].s.r!=f)&&(x=!0);break}if(!x){var g={r:f,c:p},v=bt(g),y=c?(e[f]||[])[p]:e[v];h.push(Xoe(y,v,e,t,r,n,g))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function Zoe(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?$oe(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?Joe(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(Goe(a,t,e,r)),n.join("")}function Qoe(e,t){t||(t={}),e.SSF||(e.SSF=kr(yt)),e.SSF&&(hd(),w1(e.SSF),t.revssf=E1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Kl(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Hoe(e,t)),r.push(Voe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Qe("Worksheet",Zoe(n,t,e),{"ss:Name":sr(e.SheetNames[n])}));return r[2]=qoe(e,t),r[3]=Woe(e),Qr+Qe("Workbook",r.join(""),{xmlns:ra.ss,"xmlns:o":ra.o,"xmlns:x":ra.x,"xmlns:ss":ra.ss,"xmlns:dt":ra.dt,"xmlns:html":ra.html})}function ele(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=WZ(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=$Z(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var tle=[60,1084,2066,2165,2175];function rle(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=So(r,r.l),f=M_[c],h=0;f!=null&&tle.indexOf(c)>-1;)a=So(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),o=r.slice(h,r.l+4+a),i.push(o),r.l+=4+a,f=M_[c=So(r,r.l)];var p=Dn(i);$n(p,0);var x=0;p.lens=[];for(var g=0;g<i.length;++g)p.lens.push(x),x+=i[g].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,s)}function ki(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=yt[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||zo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=f0(e.v):e.w=Yc(e.v):e.w=qa(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&dd(yt[n]||String(n))){var s=Nc(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Km(e,t,r){return{v:e,ixfe:t,t:r}}function nle(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],f="",h={},p,x="",g,v,y,w,_={},S=[],E,N,k=[],O=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},I=function(dt){return dt<8?Mc[dt]:dt<64&&O[dt-8]||Mc[dt]},Z=function(dt,Lt,pr){var vt=Lt.XF.data;if(!(!vt||!vt.patternType||!pr||!pr.cellStyles)){Lt.s={},Lt.s.patternType=vt.patternType;var or;(or=x0(I(vt.icvFore)))&&(Lt.s.fgColor={rgb:or}),(or=x0(I(vt.icvBack)))&&(Lt.s.bgColor={rgb:or})}},ce=function(dt,Lt,pr){if(!(K>1)&&!(pr.sheetRows&&dt.r>=pr.sheetRows)){if(pr.cellStyles&&Lt.XF&&Lt.XF.data&&Z(dt,Lt,pr),delete Lt.ixfe,delete Lt.XF,p=dt,x=bt(dt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<i.s.r&&(i.s.r=dt.r),dt.c<i.s.c&&(i.s.c=dt.c),dt.r+1>i.e.r&&(i.e.r=dt.r+1),dt.c+1>i.e.c&&(i.e.c=dt.c+1),pr.cellFormula&&Lt.f){for(var vt=0;vt<S.length;++vt)if(!(S[vt][0].s.c>dt.c||S[vt][0].s.r>dt.r)&&!(S[vt][0].e.c<dt.c||S[vt][0].e.r<dt.r)){Lt.F=Ct(S[vt][0]),(S[vt][0].s.c!=dt.c||S[vt][0].s.r!=dt.r)&&delete Lt.f,Lt.f&&(Lt.f=""+as(S[vt][1],i,dt,oe,F));break}}pr.dense?(s[dt.r]||(s[dt.r]=[]),s[dt.r][dt.c]=Lt):s[x]=Lt}},F={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(F.password=t.password);var X,P=[],ie=[],te=[],Y=[],ve=!1,oe=[];oe.SheetNames=F.snames,oe.sharedf=F.sharedf,oe.arrayf=F.arrayf,oe.names=[],oe.XTI=[];var Ee=0,K=0,D=0,q=[],W=[],J;F.codepage=1200,ai(1200);for(var re=!1;e.l<e.length-1;){var U=e.l,L=e.read_shift(2);if(L===0&&Ee===10)break;var se=e.l===e.length?0:e.read_shift(2),Q=M_[L];if(Q&&Q.f){if(t.bookSheets&&Ee===133&&L!==133)break;if(Ee=L,Q.r===2||Q.r==12){var ee=e.read_shift(2);if(se-=2,!F.enc&&ee!==L&&((ee&255)<<8|ee>>8)!==L)throw new Error("rt mismatch: "+ee+"!="+L);Q.r==12&&(e.l+=10,se-=10)}var B={};if(L===10?B=Q.f(e,se,F):B=rle(L,Q,e,se,F),K==0&&[9,521,1033,2057].indexOf(Ee)===-1)continue;switch(L){case 34:r.opts.Date1904=R.WBProps.date1904=B;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(e.l=0),F.enc=B,!t.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=B;break;case 66:var be=Number(B);switch(be){case 21010:be=1200;break;case 32768:be=1e4;break;case 32769:be=1252;break}ai(F.codepage=be),re=!0;break;case 317:F.rrtabid=B;break;case 25:F.winlocked=B;break;case 439:r.opts.RefreshAll=B;break;case 12:r.opts.CalcCount=B;break;case 16:r.opts.CalcDelta=B;break;case 17:r.opts.CalcIter=B;break;case 13:r.opts.CalcMode=B;break;case 14:r.opts.CalcPrecision=B;break;case 95:r.opts.CalcSaveRecalc=B;break;case 15:F.CalcRefMode=B;break;case 2211:r.opts.FullCalc=B;break;case 129:B.fDialog&&(s["!type"]="dialog"),B.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),B.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:k.push(B);break;case 430:oe.push([B]),oe[oe.length-1].XTI=[];break;case 35:case 547:oe[oe.length-1].push(B);break;case 24:case 536:J={Name:B.Name,Ref:as(B.rgce,i,null,oe,F)},B.itab>0&&(J.Sheet=B.itab-1),oe.names.push(J),oe[0]||(oe[0]=[],oe[0].XTI=[]),oe[oe.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(W[B.itab-1]={ref:Ct(B.rgce[0][0][1][2])});break;case 22:F.ExternCount=B;break;case 23:oe.length==0&&(oe[0]=[],oe[0].XTI=[]),oe[oe.length-1].XTI=oe[oe.length-1].XTI.concat(B),oe.XTI=oe.XTI.concat(B);break;case 2196:if(F.biff<8)break;J!=null&&(J.Comment=B[1]);break;case 18:s["!protect"]=B;break;case 19:B!==0&&F.WTF&&console.error("Password verifier: "+B);break;case 133:a[B.pos]=B,F.snames.push(B.name);break;case 10:{if(--K)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Ct(i),t.sheetRows&&t.sheetRows<=i.e.r){var z=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ct(i),i.e.r=z}i.e.r++,i.e.c++}P.length>0&&(s["!merges"]=P),ie.length>0&&(s["!objects"]=ie),te.length>0&&(s["!cols"]=te),Y.length>0&&(s["!rows"]=Y),R.Sheets.push(V)}f===""?h=s:n[f]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[L]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),F.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(F.biff=5,re=!0,ai(F.codepage=28591)),F.biff==8&&B.BIFFVer==0&&B.dt==16&&(F.biff=2),K++)break;if(s=t.dense?[]:{},F.biff<8&&!re&&(re=!0,ai(F.codepage=t.codepage||1252)),F.biff<5||B.BIFFVer==0&&B.dt==4096){f===""&&(f="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var he={pos:e.l-se,name:f};a[he.pos]=he,F.snames.push(f)}else f=(a[U]||{name:""}).name;B.dt==32&&(s["!type"]="chart"),B.dt==64&&(s["!type"]="macro"),P=[],ie=[],F.arrayf=S=[],te=[],Y=[],ve=!1,V={Hidden:(a[U]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[B.r]||[])[B.c]:s[bt({c:B.c,r:B.r})])&&++B.c,E={ixfe:B.ixfe,XF:k[B.ixfe]||{},v:B.val,t:"n"},D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce({c:B.c,r:B.r},E,t);break;case 5:case 517:E={ixfe:B.ixfe,XF:k[B.ixfe],v:B.val,t:B.t},D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce({c:B.c,r:B.r},E,t);break;case 638:E={ixfe:B.ixfe,XF:k[B.ixfe],v:B.rknum,t:"n"},D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce({c:B.c,r:B.r},E,t);break;case 189:for(var M=B.c;M<=B.C;++M){var A=B.rkrec[M-B.c][0];E={ixfe:A,XF:k[A],v:B.rkrec[M-B.c][1],t:"n"},D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce({c:M,r:B.r},E,t)}break;case 6:case 518:case 1030:{if(B.val=="String"){o=B;break}if(E=Km(B.val,B.cell.ixfe,B.tt),E.XF=k[E.ixfe],t.cellFormula){var j=B.formula;if(j&&j[0]&&j[0][0]&&j[0][0][0]=="PtgExp"){var H=j[0][0][1][0],ue=j[0][0][1][1],ye=bt({r:H,c:ue});_[ye]?E.f=""+as(B.formula,i,B.cell,oe,F):E.F=((t.dense?(s[H]||[])[ue]:s[ye])||{}).F}else E.f=""+as(B.formula,i,B.cell,oe,F)}D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce(B.cell,E,t),o=B}break;case 7:case 519:if(o)o.val=B,E=Km(B,o.cell.ixfe,"s"),E.XF=k[E.ixfe],t.cellFormula&&(E.f=""+as(o.formula,i,o.cell,oe,F)),D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce(o.cell,E,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(B);var pe=bt(B[0].s);if(g=t.dense?(s[B[0].s.r]||[])[B[0].s.c]:s[pe],t.cellFormula&&g){if(!o||!pe||!g)break;g.f=""+as(B[1],i,B[0],oe,F),g.F=Ct(B[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!o)break;_[bt(o.cell)]=B[0],g=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[bt(o.cell)],(g||{}).f=""+as(B[0],i,p,oe,F)}}break;case 253:E=Km(c[B.isst].t,B.ixfe,"s"),c[B.isst].h&&(E.h=c[B.isst].h),E.XF=k[E.ixfe],D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce({c:B.c,r:B.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:B.ixfe,XF:k[B.ixfe],t:"z"},D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce({c:B.c,r:B.r},E,t));break;case 190:if(t.sheetStubs)for(var Ne=B.c;Ne<=B.C;++Ne){var De=B.ixfe[Ne-B.c];E={ixfe:De,XF:k[De],t:"z"},D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce({c:Ne,r:B.r},E,t)}break;case 214:case 516:case 4:E=Km(B.val,B.ixfe,"s"),E.XF=k[E.ixfe],D>0&&(E.z=q[E.ixfe>>8&63]),ki(E,t,r.opts.Date1904),ce({c:B.c,r:B.r},E,t);break;case 0:case 512:K===1&&(i=B);break;case 252:c=B;break;case 1054:if(F.biff==4){q[D++]=B[1];for(var Fe=0;Fe<D+163&&yt[Fe]!=B[1];++Fe);Fe>=163&&jo(B[1],D+163)}else jo(B[1],B[0]);break;case 30:{q[D++]=B;for(var Ke=0;Ke<D+163&&yt[Ke]!=B;++Ke);Ke>=163&&jo(B,D+163)}break;case 229:P=P.concat(B);break;case 93:ie[B.cmo[0]]=F.lastobj=B;break;case 438:F.lastobj.TxO=B;break;case 127:F.lastobj.ImData=B;break;case 440:for(w=B[0].s.r;w<=B[0].e.r;++w)for(y=B[0].s.c;y<=B[0].e.c;++y)g=t.dense?(s[w]||[])[y]:s[bt({c:y,r:w})],g&&(g.l=B[1]);break;case 2048:for(w=B[0].s.r;w<=B[0].e.r;++w)for(y=B[0].s.c;y<=B[0].e.c;++y)g=t.dense?(s[w]||[])[y]:s[bt({c:y,r:w})],g&&g.l&&(g.l.Tooltip=B[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;g=t.dense?(s[B[0].r]||[])[B[0].c]:s[bt(B[0])];var st=ie[B[2]];g||(t.dense?(s[B[0].r]||(s[B[0].r]=[]),g=s[B[0].r][B[0].c]={t:"z"}):g=s[bt(B[0])]={t:"z"},i.e.r=Math.max(i.e.r,B[0].r),i.s.r=Math.min(i.s.r,B[0].r),i.e.c=Math.max(i.e.c,B[0].c),i.s.c=Math.min(i.s.c,B[0].c)),g.c||(g.c=[]),v={a:B[1],t:st.TxO.t},g.c.push(v)}break;case 2173:qre(k[B.ixfe],B.ext);break;case 125:{if(!F.cellStyles)break;for(;B.e>=B.s;)te[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},ve||(ve=!0,NS(B.w/256)),Ul(te[B.e+1])}break;case 520:{var at={};B.level!=null&&(Y[B.r]=at,at.level=B.level),B.hidden&&(Y[B.r]=at,at.hidden=!0),B.hpt&&(Y[B.r]=at,at.hpt=B.hpt,at.hpx=Pf(B.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Lc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[L]]=B;break;case 161:s["!margins"]||Lc(s["!margins"]={}),s["!margins"].header=B.header,s["!margins"].footer=B.footer;break;case 574:B.RTL&&(R.Views[0].RTL=!0);break;case 146:O=B;break;case 2198:X=B;break;case 140:N=B;break;case 442:f?V.CodeName=B||V.name:R.WBProps.CodeName=B||"ThisWorkbook";break}}else Q||console.error("Missing Info for XLS Record 0x"+L.toString(16)),e.l+=se}return r.SheetNames=Wr(a).sort(function(Gt,dt){return Number(Gt)-Number(dt)}).map(function(Gt){return a[Gt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&W.forEach(function(Gt,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=Gt}),r.Strings=c,r.SSF=kr(yt),F.enc&&(r.Encryption=F.enc),X&&(r.Themes=X),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),oe.names.length>0&&(R.Names=oe.names),r.Workbook=R,r}var Vh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function sle(e,t,r){var n=mt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=i5(n,A_,Vh.DSI);for(var a in s)t[a]=s[a]}catch(f){if(r.WTF)throw f}var i=mt.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=i5(i,C_,Vh.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(mI(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function ale(e,t){var r=[],n=[],s=[],a=0,i,o=F3(A_,"n"),c=F3(C_,"n");if(e.Props)for(i=Wr(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Wr(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var f=[];for(a=0;a<s.length;++a)_I.indexOf(s[a][0])>-1||pI.indexOf(s[a][0])>-1||s[a][1]!=null&&f.push(s[a]);n.length&&mt.utils.cfb_add(t,"/SummaryInformation",o5(n,Vh.SI,c,C_)),(r.length||f.length)&&mt.utils.cfb_add(t,"/DocumentSummaryInformation",o5(r,Vh.DSI,o,A_,f.length?f:null,Vh.UDI))}function gM(e,t){t||(t={}),IS(t),tS(),t.codepage&&eS(t.codepage);var r,n;if(e.FullPaths){if(mt.find(e,"/encryption"))throw new Error("File is password-protected");r=mt.find(e,"!CompObj"),n=mt.find(e,"/Workbook")||mt.find(e,"/Book")}else{switch(t.type){case"base64":e=sa(ca(e));break;case"binary":e=sa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}$n(e,0),n={content:e}}var s,a;if(r&&ele(r),t.bookProps&&!t.bookSheets)s={};else{var i=Ft?"buffer":"array";if(n&&n.content)s=nle(n.content,t);else if((a=mt.find(e,"PerfectOffice_MAIN"))&&a.content)s=Pc.to_workbook(a.content,(t.type=i,t));else if((a=mt.find(e,"NativeContent_MAIN"))&&a.content)s=Pc.to_workbook(a.content,(t.type=i,t));else throw(a=mt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&mt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=yne(e))}var o={};return e.FullPaths&&sle(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function ile(e,t){var r=t||{},n=mt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return mt.utils.cfb_add(n,s,yM(e,r)),r.biff==8&&(e.Props||e.Custprops)&&ale(e,n),r.biff==8&&e.vbaraw&&vne(n,mt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var b0={0:{f:Rae},1:{f:Lae},2:{f:nie},3:{f:$ae},4:{f:Hae},5:{f:eie},6:{f:lie},7:{f:Yae},8:{f:mie},9:{f:pie},10:{f:die},11:{f:hie},12:{f:Uae},13:{f:aie},14:{f:Kae},15:{f:qae},16:{f:cM},17:{f:uie},18:{f:Zae},19:{f:mS},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:uoe},40:{},42:{},43:{f:lre},44:{f:ire},45:{f:fre},46:{f:hre},47:{f:dre},48:{},49:{f:DZ},50:{},51:{f:Gre},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:DI},62:{f:oie},63:{f:rne},64:{f:jie},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ds,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kie},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Fae},148:{f:Dae,p:16},151:{f:wie},152:{},153:{f:ooe},154:{},155:{},156:{f:aoe},157:{},158:{},159:{T:1,f:Ete},160:{T:-1},161:{T:1,f:hu},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:xie},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Wre},336:{T:-1},337:{f:Yre,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:k_},357:{},358:{},359:{},360:{T:1},361:{},362:{f:OI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_ie},427:{f:Eie},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Nie},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Mae},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vie},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:k_},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:hne},633:{T:1},634:{T:-1},635:{T:1,f:fne},636:{T:-1},637:{f:PZ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Kie},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Oie},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},M_={6:{f:jb},10:{f:xl},12:{f:mn},13:{f:mn},14:{f:Kr},15:{f:Kr},16:{f:cs},17:{f:Kr},18:{f:Kr},19:{f:mn},20:{f:h5},21:{f:h5},23:{f:OI},24:{f:m5},25:{f:Kr},26:{},27:{},28:{f:Oee},29:{},34:{f:Kr},35:{f:p5},38:{f:cs},39:{f:cs},40:{f:cs},41:{f:cs},42:{f:Kr},43:{f:Kr},47:{f:qte},49:{f:aee},51:{f:mn},60:{},61:{f:eee},64:{f:Kr},65:{f:see},66:{f:mn},77:{},80:{},81:{},82:{},85:{f:mn},89:{},90:{},91:{},92:{f:VQ},93:{f:Mee},94:{},95:{f:Kr},96:{},97:{},99:{f:Kr},125:{f:DI},128:{f:bee},129:{f:WQ},130:{f:mn},131:{f:Kr},132:{f:Kr},133:{f:$Q},134:{},140:{f:Vee},141:{f:mn},144:{},146:{f:$ee},151:{},152:{},153:{},154:{},155:{},156:{f:mn},157:{},158:{},160:{f:Qee},161:{f:Xee},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:xee},190:{f:gee},193:{f:xl},197:{},198:{},199:{},200:{},201:{},202:{f:Kr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:mn},220:{},221:{f:Kr},222:{},224:{f:vee},225:{f:HQ},226:{f:xl},227:{},229:{f:Dee},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:KQ},253:{f:oee},255:{f:YQ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:EI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Kr},353:{f:xl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Nee},431:{f:Kr},432:{},433:{},434:{},437:{},438:{f:Lee},439:{f:Kr},440:{f:Bee},441:{},442:{f:rp},443:{},444:{f:mn},445:{},446:{},448:{f:xl},449:{f:QQ,r:2},450:{f:xl},512:{f:u5},513:{f:Zee},515:{f:Eee},516:{f:cee},517:{f:d5},519:{f:ete},520:{f:JQ},523:{},545:{f:x5},549:{f:c5},566:{},574:{f:ree},638:{f:mee},659:{},1048:{},1054:{f:fee},1084:{},1212:{f:Cee},2048:{f:zee},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Wm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:xl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Gee,r:12},2173:{f:Vre,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Kr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Aee,r:12},2197:{},2198:{f:Pre,r:12},2199:{},2200:{},2201:{},2202:{f:Ree,r:12},2203:{f:xl},2204:{},2205:{},2206:{},2207:{},2211:{f:ZQ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:mn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Yee},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Wee},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:u5},1:{},2:{f:ate},3:{f:nte},4:{f:rte},5:{f:d5},7:{f:ote},8:{},9:{f:Wm},11:{},22:{f:mn},30:{f:hee},31:{},32:{},33:{f:x5},36:{},37:{f:c5},50:{f:lte},62:{},52:{},67:{},68:{f:mn},69:{},86:{},126:{},127:{f:tte},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:cte},223:{},234:{},354:{},421:{},518:{f:jb},521:{f:Wm},536:{f:m5},547:{f:p5},561:{},579:{},1030:{f:jb},1033:{f:Wm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function et(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&dS(r)&&e.push(r)}}function ole(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return et(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,f=0;f+(i[o]||8224)<=8224;)f+=i[o]||8224,o++;var h=e.next(4);for(h.write_shift(2,a),h.write_shift(2,f),e.push(r.slice(c,c+f)),c+=f;c<s;){for(h=e.next(4),h.write_shift(2,60),f=0;f+(i[o]||8224)<=8224;)f+=i[o]||8224,o++;h.write_shift(2,f),e.push(r.slice(c,c+f)),c+=f}}}function ip(e,t,r){return e||(e=Le(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function lle(e,t,r,n){var s=Le(9);return ip(s,e,t),SI(r,n||"b",s),s}function cle(e,t,r){var n=Le(8+2*r.length);return ip(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function ule(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?_n(Tr(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?et(e,2,ite(r,n,s)):et(e,3,ste(r,n,s));return;case"b":case"e":et(e,5,lle(r,n,t.v,t.t));return;case"s":case"str":et(e,4,cle(r,n,(t.v||"").slice(0,255)));return}et(e,1,ip(null,r,n))}function fle(e,t,r,n){var s=Array.isArray(t),a=$t(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Ct(a)}for(var f=a.s.r;f<=a.e.r;++f){o=Jr(f);for(var h=a.s.c;h<=a.e.c;++h){f===a.s.r&&(c[h]=Dr(h)),i=c[h]+o;var p=s?(t[f]||[])[h]:t[i];p&&ule(e,p,f,h)}}}function dle(e,t){for(var r=t||{},n=Us(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return et(n,r.biff==4?1033:r.biff==3?521:9,_S(e,16,r)),fle(n,e.Sheets[e.SheetNames[s]],s,r),et(n,10),n.end()}function hle(e,t,r){et(e,49,iee({sz:12,name:"Arial"},r))}function ple(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&et(e,1054,dee(s,t[s],r))})}function mle(e,t){var r=Le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),et(e,2151,r),r=Le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),CI($t(t["!ref"]||"A1"),r),r.write_shift(4,4),et(e,2152,r)}function xle(e,t){for(var r=0;r<16;++r)et(e,224,f5({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){et(e,224,f5(n,0,t))})}function gle(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];et(e,440,Uee(n)),n[1].Tooltip&&et(e,2048,Hee(n))}delete t["!links"]}function yle(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&et(e,125,Kee(A1(s,n),s))})}}function vle(e,t,r,n,s){var a=16+Kl(s.cellXfs,t,s);if(t.v==null&&!t.bf){et(e,513,eu(r,n,a));return}if(t.bf)et(e,6,Wse(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?_n(Tr(t.v)):t.v;et(e,515,See(r,n,i,a));break;case"b":case"e":et(e,517,_ee(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=RS(s.Strings,t.v,s.revStrings);et(e,253,lee(r,n,o,a))}else et(e,516,uee(r,n,(t.v||"").slice(0,255),a,s));break;default:et(e,513,eu(r,n,a))}}function ble(e,t,r){var n=Us(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),f=t.biff==8,h,p="",x=[],g=$t(a["!ref"]||"A1"),v=f?65536:16384;if(g.e.c>255||g.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,v-1)}et(n,2057,_S(r,16,t)),et(n,13,Ia(1)),et(n,12,Ia(100)),et(n,15,bs(!0)),et(n,17,bs(!1)),et(n,16,Zc(.001)),et(n,95,bs(!0)),et(n,42,bs(!1)),et(n,43,bs(!1)),et(n,130,Ia(1)),et(n,128,wee()),et(n,131,bs(!1)),et(n,132,bs(!1)),f&&yle(n,a["!cols"]),et(n,512,pee(g,t)),f&&(a["!links"]=[]);for(var y=g.s.r;y<=g.e.r;++y){p=Jr(y);for(var w=g.s.c;w<=g.e.c;++w){y===g.s.r&&(x[w]=Dr(w)),h=x[w]+p;var _=c?(a[y]||[])[w]:a[h];_&&(vle(n,_,y,w,t),f&&_.l&&a["!links"].push([h,_.l]))}}var S=o.CodeName||o.name||s;return f&&et(n,574,nee((i.Views||[])[0])),f&&(a["!merges"]||[]).length&&et(n,229,Iee(a["!merges"])),f&&gle(n,a),et(n,442,NI(S)),f&&mle(n,a),et(n,10),n.end()}function wle(e,t,r){var n=Us(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(et(n,2057,_S(e,5,r)),r.bookType=="xla"&&et(n,135),et(n,225,o?Ia(1200):null),et(n,193,_Q(2)),c&&et(n,191),c&&et(n,192),et(n,226),et(n,92,qQ("SheetJS",r)),et(n,66,Ia(o?1200:1252)),o&&et(n,353,Ia(0)),o&&et(n,448),et(n,317,Jee(e.SheetNames.length)),o&&e.vbaraw&&et(n,211),o&&e.vbaraw){var f=i.CodeName||"ThisWorkbook";et(n,442,NI(f))}et(n,156,Ia(17)),et(n,25,bs(!1)),et(n,18,bs(!1)),et(n,19,Ia(0)),o&&et(n,431,bs(!1)),o&&et(n,444,Ia(0)),et(n,61,tee()),et(n,64,bs(!1)),et(n,141,Ia(0)),et(n,34,bs(Qie(e)=="true")),et(n,14,bs(!0)),o&&et(n,439,bs(!1)),et(n,218,Ia(0)),hle(n,e,r),ple(n,e.SSF,r),xle(n,r),o&&et(n,352,bs(!1));var h=n.end(),p=Us();o&&et(p,140,qee()),o&&r.Strings&&ole(p,252,XQ(r.Strings)),et(p,10);var x=p.end(),g=Us(),v=0,y=0;for(y=0;y<e.SheetNames.length;++y)v+=(o?12:11)+(o?2:1)*e.SheetNames[y].length;var w=h.length+v+x.length;for(y=0;y<e.SheetNames.length;++y){var _=a[y]||{};et(g,133,GQ({pos:w,hs:_.Hidden||0,dt:0,name:e.SheetNames[y]},r)),w+=t[y].length}var S=g.end();if(v!=S.length)throw new Error("BS8 "+v+" != "+S.length);var E=[];return h.length&&E.push(h),S.length&&E.push(S),x.length&&E.push(x),Dn(E)}function _le(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=kr(yt)),e&&e.SSF&&(hd(),w1(e.SSF),r.revssf=E1(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,MS(r),r.cellXfs=[],Kl(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=ble(s,r,e);return n.unshift(wle(e,n,r)),Dn(n)}function yM(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Vs(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return _le(e,t);case 4:case 3:case 2:return dle(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function T5(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=iZ(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,p=0,x=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<c.length;++i){var y=c[i].trim(),w=y.slice(0,3).toLowerCase();if(w=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(w!="<td"&&w!="<th")){var _=y.split(/<\/t[dh]>/i);for(o=0;o<_.length;++o){var S=_[o].trim();if(S.match(/<t[dh]/i)){for(var E=S,N=0;E.charAt(0)=="<"&&(N=E.indexOf(">"))>-1;)E=E.slice(N+1);for(var k=0;k<v.length;++k){var O=v[k];O.s.c==h&&O.s.r<f&&f<=O.e.r&&(h=O.e.c+1,k=-1)}var R=_t(S.slice(0,S.indexOf(">")));x=R.colspan?+R.colspan:1,((p=+R.rowspan)>1||x>1)&&v.push({s:{r:f,c:h},e:{r:f+(p||1)-1,c:h+x-1}});var V=R.t||R["data-t"]||"";if(!E.length){h+=x;continue}if(E=HD(E),g.s.r>f&&(g.s.r=f),g.e.r<f&&(g.e.r=f),g.s.c>h&&(g.s.c=h),g.e.c<h&&(g.e.c=h),!E.length){h+=x;continue}var I={t:"s",v:E};r.raw||!E.trim().length||V=="s"||(E==="TRUE"?I={t:"b",v:!0}:E==="FALSE"?I={t:"b",v:!1}:isNaN(li(E))?isNaN(Mf(E).getDate())||(I={t:"d",v:Tr(E)},r.cellDates||(I={t:"n",v:_n(I.v)}),I.z=r.dateNF||yt[14]):I={t:"n",v:li(E)}),r.dense?(n[f]||(n[f]=[]),n[f][h]=I):n[bt({r:f,c:h})]=I,h+=x}}}}return n["!ref"]=Ct(g),v.length&&(n["!merges"]=v),n}function Ele(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,f=0;f<s.length;++f)if(!(s[f].s.r>r||s[f].s.c>i)&&!(s[f].e.r<r||s[f].e.c<i)){if(s[f].s.r<r||s[f].s.c<i){o=-1;break}o=s[f].e.r-s[f].s.r+1,c=s[f].e.c-s[f].s.c+1;break}if(!(o<0)){var h=bt({r,c:i}),p=n.dense?(e[r]||[])[i]:e[h],x=p&&p.v!=null&&(p.h||cS(p.w||(Po(p),p.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?x='<span contenteditable="true">'+x+"</span>":p&&(g["data-t"]=p&&p.t||"z",p.v!=null&&(g["data-v"]=p.v),p.z!=null&&(g["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+p.l.Target+'">'+x+"</a>")),g.id=(n.id||"sjs")+"-"+h,a.push(Qe("td",x,g))}}var v="<tr>";return v+a.join("")+"</tr>"}var Sle='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Nle="</body></html>";function Tle(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Gl(T5(r[0],t),t);var n=LS();return r.forEach(function(s,a){BS(n,T5(s,t),"Sheet"+(a+1))}),n}function kle(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function vM(e,t){var r=t||{},n=r.header!=null?r.header:Sle,s=r.footer!=null?r.footer:Nle,a=[n],i=Vs(e["!ref"]);r.dense=Array.isArray(e),a.push(kle(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(Ele(e,i,o,r));return a.push("</table>"+s),a.join("")}function bM(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Ir(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var h=Vs(e["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),s==-1&&(f.e.r=s=h.e.r+1)}var p=[],x=0,g=e["!rows"]||(e["!rows"]=[]),v=0,y=0,w=0,_=0,S=0,E=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&y<c;++v){var N=o[v];if(k5(N)){if(n.display)continue;g[y]={hidden:!0}}var k=N.children;for(w=_=0;w<k.length;++w){var O=k[w];if(!(n.display&&k5(O))){var R=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):HD(O.innerHTML),V=O.getAttribute("data-z")||O.getAttribute("z");for(x=0;x<p.length;++x){var I=p[x];I.s.c==_+a&&I.s.r<y+s&&y+s<=I.e.r&&(_=I.e.c+1-a,x=-1)}E=+O.getAttribute("colspan")||1,((S=+O.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:y+s,c:_+a},e:{r:y+s+(S||1)-1,c:_+a+(E||1)-1}});var Z={t:"s",v:R},ce=O.getAttribute("data-t")||O.getAttribute("t")||"";R!=null&&(R.length==0?Z.t=ce||"z":n.raw||R.trim().length==0||ce=="s"||(R==="TRUE"?Z={t:"b",v:!0}:R==="FALSE"?Z={t:"b",v:!1}:isNaN(li(R))?isNaN(Mf(R).getDate())||(Z={t:"d",v:Tr(R)},n.cellDates||(Z={t:"n",v:_n(Z.v)}),Z.z=n.dateNF||yt[14]):Z={t:"n",v:li(R)})),Z.z===void 0&&V!=null&&(Z.z=V);var F="",X=O.getElementsByTagName("A");if(X&&X.length)for(var P=0;P<X.length&&!(X[P].hasAttribute("href")&&(F=X[P].getAttribute("href"),F.charAt(0)!="#"));++P);F&&F.charAt(0)!="#"&&(Z.l={Target:F}),n.dense?(e[y+s]||(e[y+s]=[]),e[y+s][_+a]=Z):e[bt({c:_+a,r:y+s})]=Z,f.e.c<_+a&&(f.e.c=_+a),_+=E}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+s),e["!ref"]=Ct(f),y>=c&&(e["!fullref"]=Ct((f.e.r=o.length-v+y-1+s,f))),e}function wM(e,t){var r=t||{},n=r.dense?[]:{};return bM(n,e,t)}function Ale(e,t){return Gl(wM(e,t),t)}function k5(e){var t="",r=Cle(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Cle(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Rle(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Wt(t.replace(/<[^>]*>/g,""));return[r]}var A5={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function _M(e,t){var r=t||{},n=uS(e),s=[],a,i,o={name:""},c="",f=0,h,p,x={},g=[],v=r.dense?[]:{},y,w,_={value:""},S="",E=0,N=[],k=-1,O=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,I={},Z=[],ce={},F=0,X=0,P=[],ie=1,te=1,Y=[],ve={Names:[]},oe={},Ee=["",""],K=[],D={},q="",W=0,J=!1,re=!1,U=0;for(p0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=p0.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?v["!ref"]=Ct(R):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=R.e.r&&(v["!fullref"]=v["!ref"],R.e.r=r.sheetRows-1,v["!ref"]=Ct(R)),Z.length&&(v["!merges"]=Z),P.length&&(v["!rows"]=P),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),g.push(h.name),x[h.name]=v,re=!1):y[0].charAt(y[0].length-2)!=="/"&&(h=_t(y[0],!1),k=O=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,v=r.dense?[]:{},Z=[],P=[],re=!0);break;case"table-row-group":y[1]==="/"?--V:++V;break;case"table-row":case"":if(y[1]==="/"){k+=ie,ie=1;break}if(p=_t(y[0],!1),p.?k=p.-1:k==-1&&(k=0),ie=+p["number-rows-repeated"]||1,ie<10)for(U=0;U<ie;++U)V>0&&(P[k+U]={level:V});O=-1;break;case"covered-table-cell":y[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(v[k]||(v[k]=[]),v[k][O]={t:"z"}):v[bt({r:k,c:O})]={t:"z"}),S="",N=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++O,_=_t(y[0],!1),te=parseInt(_["number-columns-repeated"]||"1",10),w={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(w.f=E5(Wt(_.formula))),(_.||_["value-type"])=="string"&&(w.t="s",w.v=Wt(_["string-value"]||""),r.dense?(v[k]||(v[k]=[]),v[k][O]=w):v[bt({r:k,c:O})]=w),O+=te-1;else if(y[1]!=="/"){++O,S="",E=0,N=[],te=1;var L=ie?k+ie-1:k;if(O>R.e.c&&(R.e.c=O),O<R.s.c&&(R.s.c=O),k<R.s.r&&(R.s.r=k),L>R.e.r&&(R.e.r=L),_=_t(y[0],!1),K=[],D={},w={t:_.||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=Wt(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(F=parseInt(_["number-matrix-rows-spanned"],10)||0,X=parseInt(_["number-matrix-columns-spanned"],10)||0,ce={s:{r:k,c:O},e:{r:k+F-1,c:O+X-1}},w.F=Ct(ce),Y.push([ce,w.F])),_.formula)w.f=E5(_.formula);else for(U=0;U<Y.length;++U)k>=Y[U][0].s.r&&k<=Y[U][0].e.r&&O>=Y[U][0].s.c&&O<=Y[U][0].e.c&&(w.F=Y[U][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(F=parseInt(_["number-rows-spanned"],10)||0,X=parseInt(_["number-columns-spanned"],10)||0,ce={s:{r:k,c:O},e:{r:k+F-1,c:O+X-1}},Z.push(ce)),_["number-columns-repeated"]&&(te=parseInt(_["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Nr(_["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(_.value);break;case"percentage":w.t="n",w.v=parseFloat(_.value);break;case"currency":w.t="n",w.v=parseFloat(_.value);break;case"date":w.t="d",w.v=Tr(_["date-value"]),r.cellDates||(w.t="n",w.v=_n(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=nZ(_["time-value"])/86400,r.cellDates&&(w.t="d",w.v=S1(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(_.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",_["string-value"]!=null&&(S=Wt(_["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(J=!1,w.t==="s"&&(w.v=S||"",N.length&&(w.R=N),J=E==0),oe.Target&&(w.l=oe),K.length>0&&(w.c=K,K=[]),S&&r.cellText!==!1&&(w.w=S),J&&(w.t="z",delete w.v),(!J||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var se=0;se<ie;++se){if(te=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(v[k+se]||(v[k+se]=[]),v[k+se][O]=se==0?w:kr(w);--te>0;)v[k+se][O+te]=kr(w);else for(v[bt({r:k+se,c:O})]=w;--te>0;)v[bt({r:k+se,c:O+te})]=kr(w);R.e.c<=O&&(R.e.c=O)}te=parseInt(_["number-columns-repeated"]||"1",10),O+=te-1,te=0,w={},S="",N=[]}oe={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((a=s.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((a=s.pop())[0]!==y[3])throw"Bad state: "+a;D.t=S,N.length&&(D.R=N),D.a=q,K.push(D)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);q="",W=0,S="",E=0,N=[];break;case"creator":y[1]==="/"?q=n.slice(W,y.index):W=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((a=s.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);S="",E=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(I[o.name]=c,(a=s.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&(c="",o=_t(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=_t(y[0],!1),c+=A5[y[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=_t(y[0],!1),c+=A5[y[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":i=_t(y[0],!1),Ee=Ob(i["cell-range-address"]);var Q={Name:i.name,Ref:Ee[0]+"!"+Ee[1]};re&&(Q.Sheet=g.length),ve.Names.push(Q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!_||!_["string-value"])){var ee=Rle(n.slice(E,y.index));S=(S.length>0?S+`
`:"")+ee[0]}else _t(y[0],!1),E=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{Ee=Ob(_t(y[0])["target-range-address"]),x[Ee[0]]["!autofilter"]={ref:Ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(oe=_t(y[0],!1),!oe.href)break;oe.Target=Wt(oe.href),delete oe.href,oe.Target.charAt(0)=="#"&&oe.Target.indexOf(".")>-1?(Ee=Ob(oe.Target.slice(1)),oe.Target="#"+Ee[0]+"!"+Ee[1]):oe.Target.match(/^\.\.[\\\/]/)&&(oe.Target=oe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var B={Sheets:x,SheetNames:g,Workbook:ve};return r.bookSheets&&delete B.Sheets,B}function C5(e,t){t=t||{},ja(e,"META-INF/manifest.xml")&&nQ(pn(e,"META-INF/manifest.xml"),t);var r=aa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=_M(hr(r),t);return ja(e,"meta.xml")&&(n.Props=dI(pn(e,"meta.xml"))),n}function R5(e,t){return _M(e,t)}var jle=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+h0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qr+t}})(),j5=(function(){var e=function(a){return sr(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+sr(i.SheetNames[o])+`" table:style-name="ta1">
`);var f=0,h=0,p=Vs(a["!ref"]||"A1"),x=a["!merges"]||[],g=0,v=Array.isArray(a);if(a["!cols"])for(h=0;h<=p.e.c;++h)c.push("        <table:table-column"+(a["!cols"][h]?' table:style-name="co'+a["!cols"][h].ods+'"':"")+`></table:table-column>
`);var y="",w=a["!rows"]||[];for(f=0;f<p.s.r;++f)y=w[f]?' table:style-name="ro'+w[f].ods+'"':"",c.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=p.e.r;++f){for(y=w[f]?' table:style-name="ro'+w[f].ods+'"':"",c.push("        <table:table-row"+y+`>
`),h=0;h<p.s.c;++h)c.push(t);for(;h<=p.e.c;++h){var _=!1,S={},E="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>h)&&!(x[g].s.r>f)&&!(x[g].e.c<h)&&!(x[g].e.r<f)){(x[g].s.c!=h||x[g].s.r!=f)&&(_=!0),S["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,S["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(_){c.push(r);continue}var N=bt({r:f,c:h}),k=v?(a[f]||[])[h]:a[N];if(k&&k.f&&(S["table:formula"]=sr(Jse(k.f)),k.F&&k.F.slice(0,N.length)==N)){var O=Vs(k.F);S["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,S["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!k){c.push(t);continue}switch(k.t){case"b":E=k.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=k.v?"true":"false";break;case"n":E=k.w||String(k.v||0),S["office:value-type"]="float",S["office:value"]=k.v||0;break;case"s":case"str":E=k.v==null?"":k.v,S["office:value-type"]="string";break;case"d":E=k.w||Tr(k.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Tr(k.v).toISOString(),S["table:style-name"]="ce1";break;default:c.push(t);continue}var R=e(E);if(k.l&&k.l.Target){var V=k.l.Target;V=V.charAt(0)=="#"?"#"+Zse(V.slice(1)):V,V.charAt(0)!="#"&&!V.match(/^\w+:/)&&(V="../"+V),R=Qe("text:a",R,{"xlink:href":V.replace(/&/g,"&amp;")})}c.push("          "+Qe("table:table-cell",Qe("text:p",R,{}),S)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var h=0;h<f["!cols"].length;++h)if(f["!cols"][h]){var p=f["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Ul(p),p.ods=o;var x=f["!cols"][h].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var h=0;h<f["!rows"].length;++h)if(f["!rows"][h]){f["!rows"][h].ods=c;var p=f["!rows"][h].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[Qr],f=h0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=h0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+f+h+`>
`),c.push(fI().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+f+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=i.SheetNames.length;++p)c.push(n(i.Sheets[i.SheetNames[p]],i,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function EM(e,t){if(t.bookType=="fods")return j5(e,t);var r=iS(),n="",s=[],a=[];return n="mimetype",jt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",jt(r,n,j5(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",jt(r,n,jle(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",jt(r,n,Qr+fI()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",jt(r,n,iQ(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",jt(r,n,sQ(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function tu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function F_(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):hr($l(e))}function Ole(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):sa(Fi(e))}function Dle(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Hl(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function O5(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Ile(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Mle(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function w0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function tr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function qr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Yt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=w0(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=w0(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var f={data:o,type:a};t[s]==null?t[s]=[f]:t[s].push(f)}return t}function qn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(tr(n*8+s.type)),s.type==2&&t.push(tr(s.data.length)),t.push(s.data))})}),Hl(t)}function DS(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Aa(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=w0(e,n),a=Yt(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:qr(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=Yt(o.data),f=qr(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(i.merge=qr(a[3][0].data)>>>0>0),r.push(i)}return r}function ef(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:tr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:tr(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:tr(i.data.length)}],n[2].push({data:qn(i.meta),type:2})});var a=qn(n);t.push(tr(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Hl(t)}function Fle(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=w0(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Hl(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(f>=c)for(s.push(s[0].slice(-c)),f-=c;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-c,-c+f))}}var h=Hl(s);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Ca(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Fle(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Hl(t)}function tf(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=tr(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Hl(t)}function Ple(e,t,r,n){var s=tu(e),a=s.getUint32(4,!0),i=(n>1?12:8)+O5(a&(n>1?3470:398))*4,o=-1,c=-1,f=NaN,h=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=O5(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(f=s.getFloat64(i,!0),i+=8),a&64&&(h.setTime(h.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(c>-1)p={t:"s",v:t[c]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function Lle(e,t,r){var n=tu(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,f=NaN,h=new Date(2001,0,1);s&1&&(c=Ile(e,a),a+=16),s&2&&(f=n.getFloat64(a,!0),a+=8),s&4&&(h.setTime(h.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(i>-1)p={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return p}function Ib(e,t){var r=new Uint8Array(32),n=tu(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Mle(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Mb(e,t){var r=new Uint8Array(32),n=tu(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Ble(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ple(e,t,r,e[0]);case 5:return Lle(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ss(e){var t=Yt(e);return w0(t[1][0].data)}function D5(e,t){var r=Yt(t.data),n=qr(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Yt(i.data),c=qr(o[1][0].data)>>>0;switch(n){case 1:a[c]=F_(o[3][0].data);break;case 8:{var f=e[ss(o[9][0].data)][0],h=Yt(f.data),p=e[ss(h[1][0].data)][0],x=qr(p.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var g=Yt(p.data);a[c]=g[3].map(function(v){return F_(v.data)}).join("")}break}}),a}function Ule(e,t){var r,n,s,a,i,o,c,f,h,p,x,g,v,y,w=Yt(e),_=qr(w[1][0].data)>>>0,S=qr(w[2][0].data)>>>0,E=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&qr(w[8][0].data)>0||!1,N,k;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,k=(f=(c=w[6])==null?void 0:c[0])==null?void 0:f.data;else if((p=(h=w[4])==null?void 0:h[0])!=null&&p.data&&t!=1)N=(g=(x=w[4])==null?void 0:x[0])==null?void 0:g.data,k=(y=(v=w[3])==null?void 0:v[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var O=E?4:1,R=tu(N),V=[],I=0;I<N.length/2;++I){var Z=R.getUint16(I*2,!0);Z<65535&&V.push([I,Z])}if(V.length!=S)throw"Expected ".concat(S," cells, found ").concat(V.length);var ce=[];for(I=0;I<V.length-1;++I)ce[V[I][0]]=k.subarray(V[I][1]*O,V[I+1][1]*O);return V.length>=1&&(ce[V[V.length-1][0]]=k.subarray(V[V.length-1][1]*O)),{R:_,cells:ce}}function zle(e,t){var r,n=Yt(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?qr(n[7][0].data)>>>0>0?1:0:-1,a=DS(n[5],function(i){return Ule(i,s)});return{nrows:qr(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,f){if(i[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));i[o.R][f]=c}),i},[])}}function Hle(e,t,r){var n,s=Yt(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(qr(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(qr(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ct(a);var i=Yt(s[4][0].data),o=D5(e,e[ss(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?D5(e,e[ss(i[17][0].data)][0]):[],f=Yt(i[3][0].data),h=0;f[1].forEach(function(p){var x=Yt(p.data),g=e[ss(x[2][0].data)][0],v=qr(g.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var y=zle(e,g);y.data.forEach(function(w,_){w.forEach(function(S,E){var N=bt({r:h+_,c:E}),k=Ble(S,o,c);k&&(r[N]=k)})}),h+=y.nrows})}function Vle(e,t){var r=Yt(t.data),n={"!ref":"A1"},s=e[ss(r[2][0].data)],a=qr(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Hle(e,s[0],n),n}function qle(e,t){var r,n=Yt(t.data),s={name:(r=n[1])!=null&&r[0]?F_(n[1][0].data):"",sheets:[]},a=DS(n[2],ss);return a.forEach(function(i){e[i].forEach(function(o){var c=qr(o.meta[1][0].data);c==6e3&&s.sheets.push(Vle(e,o))})}),s}function Wle(e,t){var r=LS(),n=Yt(t.data),s=DS(n[1],ss);if(s.forEach(function(a){e[a].forEach(function(i){var o=qr(i.meta[1][0].data);if(o==2){var c=qle(e,i);c.sheets.forEach(function(f,h){BS(r,f,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Fb(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var f;try{f=Ca(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var h;try{h=Aa(f)}catch(p){return console.log("## "+(p.message||p))}h.forEach(function(p){a[p.id]=p.messages,i.push(p.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&qr(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(f){var h=qr(f.meta[1][0].data)>>>0;if(h==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Wle(a,o)}function $le(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&qr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,f=tu(e[7][0].data),h=0,p=[],x=tu(e[4][0].data),g=0,v=[],y=0;y<t.length;++y){if(t[y]==null){f.setUint16(y*2,65535,!0),x.setUint16(y*2,65535);continue}f.setUint16(y*2,h,!0),x.setUint16(y*2,g,!0);var w,_;switch(typeof t[y]){case"string":w=Ib({t:"s",v:t[y]},r),_=Mb({t:"s",v:t[y]},r);break;case"number":w=Ib({t:"n",v:t[y]},r),_=Mb({t:"n",v:t[y]},r);break;case"boolean":w=Ib({t:"b",v:t[y]},r),_=Mb({t:"b",v:t[y]},r);break;default:throw new Error("Unsupported value "+t[y])}p.push(w),h+=w.length,v.push(_),g+=_.length,++c}for(e[2][0].data=tr(c);y<e[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),x.setUint16(y*2,65535,!0);return e[6][0].data=Hl(p),e[3][0].data=Hl(v),c}function Gle(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Vs(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Ct(n)));var a=cg(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(q){return q.forEach(function(W){typeof W=="string"&&i.push(W)})});var o={},c=[],f=mt.read(t.numbers,{type:"base64"});f.FileIndex.map(function(q,W){return[q,f.FullPaths[W]]}).forEach(function(q){var W=q[0],J=q[1];if(W.type==2&&W.name.match(/\.iwa/)){var re=W.content,U=Ca(re),L=Aa(U);L.forEach(function(se){c.push(se.id),o[se.id]={deps:[],location:J,type:qr(se.messages[0].meta[1][0].data)}})}}),c.sort(function(q,W){return q-W});var h=c.filter(function(q){return q>1}).map(function(q){return[q,tr(q)]});f.FileIndex.map(function(q,W){return[q,f.FullPaths[W]]}).forEach(function(q){var W=q[0];if(q[1],!!W.name.match(/\.iwa/)){var J=Aa(Ca(W.content));J.forEach(function(re){re.messages.forEach(function(U){h.forEach(function(L){re.messages.some(function(se){return qr(se.meta[1][0].data)!=11006&&Dle(se.data,L[1])})&&o[L[0]].deps.push(re.id)})})})}});for(var p=mt.find(f,o[1].location),x=Aa(Ca(p.content)),g,v=0;v<x.length;++v){var y=x[v];y.id==1&&(g=y)}var w=ss(Yt(g.messages[0].data)[1][0].data);for(p=mt.find(f,o[w].location),x=Aa(Ca(p.content)),v=0;v<x.length;++v)y=x[v],y.id==w&&(g=y);for(w=ss(Yt(g.messages[0].data)[2][0].data),p=mt.find(f,o[w].location),x=Aa(Ca(p.content)),v=0;v<x.length;++v)y=x[v],y.id==w&&(g=y);for(w=ss(Yt(g.messages[0].data)[2][0].data),p=mt.find(f,o[w].location),x=Aa(Ca(p.content)),v=0;v<x.length;++v)y=x[v],y.id==w&&(g=y);var _=Yt(g.messages[0].data);{_[6][0].data=tr(n.e.r+1),_[7][0].data=tr(n.e.c+1);var S=ss(_[46][0].data),E=mt.find(f,o[S].location),N=Aa(Ca(E.content));{for(var k=0;k<N.length&&N[k].id!=S;++k);if(N[k].id!=S)throw"Bad ColumnRowUIDMapArchive";var O=Yt(N[k].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var R=0;R<=n.e.c;++R){var V=[];V[1]=V[2]=[{type:0,data:tr(R+420690)}],O[1].push({type:2,data:qn(V)}),O[2].push({type:0,data:tr(R)}),O[3].push({type:0,data:tr(R)})}O[4]=[],O[5]=[],O[6]=[];for(var I=0;I<=n.e.r;++I)V=[],V[1]=V[2]=[{type:0,data:tr(I+726270)}],O[4].push({type:2,data:qn(V)}),O[5].push({type:0,data:tr(I)}),O[6].push({type:0,data:tr(I)});N[k].messages[0].data=qn(O)}E.content=tf(ef(N)),E.size=E.content.length,delete _[46];var Z=Yt(_[4][0].data);{Z[7][0].data=tr(n.e.r+1);var ce=Yt(Z[1][0].data),F=ss(ce[2][0].data);E=mt.find(f,o[F].location),N=Aa(Ca(E.content));{if(N[0].id!=F)throw"Bad HeaderStorageBucket";var X=Yt(N[0].messages[0].data);for(I=0;I<a.length;++I){var P=Yt(X[2][0].data);P[1][0].data=tr(I),P[4][0].data=tr(a[I].length),X[2][I]={type:X[2][0].type,data:qn(P)}}N[0].messages[0].data=qn(X)}E.content=tf(ef(N)),E.size=E.content.length;var ie=ss(Z[2][0].data);E=mt.find(f,o[ie].location),N=Aa(Ca(E.content));{if(N[0].id!=ie)throw"Bad HeaderStorageBucket";for(X=Yt(N[0].messages[0].data),R=0;R<=n.e.c;++R)P=Yt(X[2][0].data),P[1][0].data=tr(R),P[4][0].data=tr(n.e.r+1),X[2][R]={type:X[2][0].type,data:qn(P)};N[0].messages[0].data=qn(X)}E.content=tf(ef(N)),E.size=E.content.length;var te=ss(Z[4][0].data);(function(){for(var q=mt.find(f,o[te].location),W=Aa(Ca(q.content)),J,re=0;re<W.length;++re){var U=W[re];U.id==te&&(J=U)}var L=Yt(J.messages[0].data);{L[3]=[];var se=[];i.forEach(function(B,be){se[1]=[{type:0,data:tr(be)}],se[2]=[{type:0,data:tr(1)}],se[3]=[{type:2,data:Ole(B)}],L[3].push({type:2,data:qn(se)})})}J.messages[0].data=qn(L);var Q=ef(W),ee=tf(Q);q.content=ee,q.size=q.content.length})();var Y=Yt(Z[3][0].data);{var ve=Y[1][0];delete Y[2];var oe=Yt(ve.data);{var Ee=ss(oe[2][0].data);(function(){for(var q=mt.find(f,o[Ee].location),W=Aa(Ca(q.content)),J,re=0;re<W.length;++re){var U=W[re];U.id==Ee&&(J=U)}var L=Yt(J.messages[0].data);{delete L[6],delete Y[7];var se=new Uint8Array(L[5][0].data);L[5]=[];for(var Q=0,ee=0;ee<=n.e.r;++ee){var B=Yt(se);Q+=$le(B,a[ee],i),B[1][0].data=tr(ee),L[5].push({data:qn(B),type:2})}L[1]=[{type:0,data:tr(n.e.c+1)}],L[2]=[{type:0,data:tr(n.e.r+1)}],L[3]=[{type:0,data:tr(Q)}],L[4]=[{type:0,data:tr(n.e.r+1)}]}J.messages[0].data=qn(L);var be=ef(W),z=tf(be);q.content=z,q.size=q.content.length})()}ve.data=qn(oe)}Z[3][0].data=qn(Y)}_[4][0].data=qn(Z)}g.messages[0].data=qn(_);var K=ef(x),D=tf(K);return p.content=D,p.size=p.content.length,f}function SM(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function IS(e){SM([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function MS(e){SM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Kle(e){return Pt.WS.indexOf(e)>-1?"sheet":e==Pt.CS?"chart":e==Pt.DS?"dialog":e==Pt.MS?"macro":e&&e.length?e:"sheet"}function Xle(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Kle(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Yle(e,t,r,n,s,a,i,o,c,f,h,p){try{a[n]=Bh(aa(e,r,!0),t);var x=pn(e,t),g;switch(o){case"sheet":g=yoe(x,t,s,c,a[n],f,h,p);break;case"chart":if(g=voe(x,t,s,c,a[n],f,h,p),!g||!g["!drawel"])break;var v=Ah(g["!drawel"].Target,t),y=m0(v),w=ane(aa(e,v,!0),Bh(aa(e,y,!0),v)),_=Ah(w,v),S=m0(_);g=$ie(aa(e,_,!0),_,c,Bh(aa(e,S,!0),_),f,g);break;case"macro":g=boe(x,t,s,c,a[n],f,h,p);break;case"dialog":g=woe(x,t,s,c,a[n],f,h,p);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=g;var E=[];a&&a[n]&&Wr(a[n]).forEach(function(N){var k="";if(a[n][N].Type==Pt.CMNT){k=Ah(a[n][N].Target,t);var O=Noe(pn(e,k,!0),k,c);if(!O||!O.length)return;y5(g,O,!1)}a[n][N].Type==Pt.TCMNT&&(k=Ah(a[n][N].Target,t),E=E.concat(one(pn(e,k,!0),c)))}),E&&E.length&&y5(g,E,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function Sa(e){return e.charAt(0)=="/"?e.slice(1):e}function Jle(e,t){if(hd(),t=t||{},IS(t),ja(e,"META-INF/manifest.xml")||ja(e,"objectdata.xml"))return C5(e,t);if(ja(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Fb<"u"){if(e.FileIndex)return Fb(e);var r=mt.utils.cfb_new();return B3(e).forEach(function(P){jt(r,P,lZ(e,P))}),Fb(r)}throw new Error("Unsupported NUMBERS file")}if(!ja(e,"[Content_Types].xml"))throw ja(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ja(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=B3(e),s=tQ(aa(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",pn(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!pn(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},f={};if(!t.bookSheets&&!t.bookProps){if(Uh=[],s.sst)try{Uh=Soe(pn(e,Sa(s.sst)),s.sst,t)}catch(P){if(t.WTF)throw P}t.cellStyles&&s.themes.length&&(c=Eoe(aa(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(f=_oe(pn(e,Sa(s.style)),s.style,c,t))}s.links.map(function(P){try{var ie=Bh(aa(e,m0(Sa(P))),P);return koe(pn(e,Sa(P)),ie,P,t)}catch{}});var h=goe(pn(e,Sa(s.workbooks[0])),s.workbooks[0],t),p={},x="";s.coreprops.length&&(x=pn(e,Sa(s.coreprops[0]),!0),x&&(p=dI(x)),s.extprops.length!==0&&(x=pn(e,Sa(s.extprops[0]),!0),x&&lQ(x,p,t)));var g={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(x=aa(e,Sa(s.custprops[0]),!0),x&&(g=uQ(x,t)));var v={};if((t.bookSheets||t.bookProps)&&(h.Sheets?i=h.Sheets.map(function(ie){return ie.name}):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),t.bookProps&&(v.Props=p,v.Custprops=g),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var y={};t.bookDeps&&s.calcchain&&(y=Toe(pn(e,Sa(s.calcchain)),s.calcchain));var w=0,_={},S,E;{var N=h.Sheets;p.Worksheets=N.length,p.SheetNames=[];for(var k=0;k!=N.length;++k)p.SheetNames[k]=N[k].name}var O=a?"bin":"xml",R=s.workbooks[0].lastIndexOf("/"),V=(s.workbooks[0].slice(0,R+1)+"_rels/"+s.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");ja(e,V)||(V="xl/_rels/workbook."+O+".rels");var I=Bh(aa(e,V,!0),V.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=Aoe(pn(e,Sa(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=cne(pn(e,Sa(s.people[0])),t)),I&&(I=Xle(I,h.Sheets));var Z=pn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=p.Worksheets;++w){var ce="sheet";if(I&&I[w]?(S="xl/"+I[w][1].replace(/[\/]?xl\//,""),ja(e,S)||(S=I[w][1]),ja(e,S)||(S=V.replace(/_rels\/.*$/,"")+I[w][1]),ce=I[w][2]):(S="xl/worksheets/sheet"+(w+1-Z)+"."+O,S=S.replace(/sheet0\./,"sheet.")),E=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(p.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var F=!1,X=0;X!=t.sheets.length;++X)typeof t.sheets[X]=="number"&&t.sheets[X]==w&&(F=1),typeof t.sheets[X]=="string"&&t.sheets[X].toLowerCase()==p.SheetNames[w].toLowerCase()&&(F=1);if(!F)continue e}}Yle(e,S,E,p.SheetNames[w],w,_,i,ce,t,h,c,f)}return v={Directory:s,Workbook:h,Props:p,Custprops:g,Deps:y,Sheets:i,SheetNames:p.SheetNames,Strings:Uh,Styles:f,Themes:c,SSF:kr(yt)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(P,ie){P=P.replace(/^Root Entry[\/]/,""),v.keys.push(P),v.files[P]=e.FileIndex[ie]}))),t&&t.bookVBA&&(s.vba.length>0?v.vbaraw=pn(e,Sa(s.vba[0]),!0):s.defaults&&s.defaults.bin===gne&&(v.vbaraw=pn(e,"xl/vbaProject.bin",!0))),v}function Zle(e,t){var r=t||{},n="Workbook",s=mt.find(e,n);try{if(n="/!DataSpaces/Version",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Ate(s.content),n="/!DataSpaces/DataSpaceMap",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Rte(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=jte(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Dte(s.content)}catch{}if(n="/EncryptionInfo",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Ite(s.content);if(n="/EncryptedPackage",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Qle(e,t){return t.bookType=="ods"?EM(e,t):t.bookType=="numbers"?Gle(e,t):t.bookType=="xlsb"?ece(e,t):tce(e,t)}function ece(e,t){hf=1024,e&&!e.SSF&&(e.SSF=kr(yt)),e&&e.SSF&&(hd(),w1(e.SSF),t.revssf=E1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,zh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=JI.indexOf(t.bookType)>-1,s=bS();MS(t=t||{});var a=iS(),i="",o=0;if(t.cellXfs=[],Kl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",jt(a,i,hI(e.Props,t)),s.coreprops.push(i),nr(t.rels,2,i,Pt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(e.SheetNames[f]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,jt(a,i,xI(e.Props)),s.extprops.push(i),nr(t.rels,3,i,Pt.EXT_PROPS),e.Custprops!==e.Props&&Wr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",jt(a,i,gI(e.Custprops)),s.custprops.push(i),nr(t.rels,4,i,Pt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],x=(p||{})["!type"]||"sheet";switch(x){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,jt(a,i,Roe(o-1,i,t,e,h)),s.sheets.push(i),nr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Pt.WS[0])}if(p){var g=p["!comments"],v=!1,y="";g&&g.length>0&&(y="xl/comments"+o+"."+r,jt(a,y,Doe(g,y)),s.comments.push(y),nr(h,-1,"../comments"+o+"."+r,Pt.CMNT),v=!0),p["!legacy"]&&v&&jt(a,"xl/drawings/vmlDrawing"+o+".vml",XI(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&jt(a,m0(i),xf(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,jt(a,i,Ooe(t.Strings,i,t)),s.strs.push(i),nr(t.wbrels,-1,"sharedStrings."+r,Pt.SST)),i="xl/workbook."+r,jt(a,i,Coe(e,i)),s.workbooks.push(i),nr(t.rels,1,i,Pt.WB),i="xl/theme/theme1.xml",jt(a,i,TS(e.Themes,t)),s.themes.push(i),nr(t.wbrels,-1,"theme/theme1.xml",Pt.THEME),i="xl/styles."+r,jt(a,i,joe(e,i,t)),s.styles.push(i),nr(t.wbrels,-1,"styles."+r,Pt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",jt(a,i,e.vbaraw),s.vba.push(i),nr(t.wbrels,-1,"vbaProject.bin",Pt.VBA)),i="xl/metadata."+r,jt(a,i,Ioe(i)),s.metadata.push(i),nr(t.wbrels,-1,"metadata."+r,Pt.XLMETA),jt(a,"[Content_Types].xml",uI(s,t)),jt(a,"_rels/.rels",xf(t.rels)),jt(a,"xl/_rels/workbook."+r+".rels",xf(t.wbrels)),delete t.revssf,delete t.ssf,a}function tce(e,t){hf=1024,e&&!e.SSF&&(e.SSF=kr(yt)),e&&e.SSF&&(hd(),w1(e.SSF),t.revssf=E1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,zh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=JI.indexOf(t.bookType)>-1,s=bS();MS(t=t||{});var a=iS(),i="",o=0;if(t.cellXfs=[],Kl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",jt(a,i,hI(e.Props,t)),s.coreprops.push(i),nr(t.rels,2,i,Pt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(e.SheetNames[f]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,jt(a,i,xI(e.Props)),s.extprops.push(i),nr(t.rels,3,i,Pt.EXT_PROPS),e.Custprops!==e.Props&&Wr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",jt(a,i,gI(e.Custprops)),s.custprops.push(i),nr(t.rels,4,i,Pt.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var p={"!id":{}},x=e.Sheets[e.SheetNames[o-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,jt(a,i,lM(o-1,t,e,p)),s.sheets.push(i),nr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Pt.WS[0])}if(x){var v=x["!comments"],y=!1,w="";if(v&&v.length>0){var _=!1;v.forEach(function(S){S[1].forEach(function(E){E.T==!0&&(_=!0)})}),_&&(w="xl/threadedComments/threadedComment"+o+"."+r,jt(a,w,lne(v,h,t)),s.threadedcomments.push(w),nr(p,-1,"../threadedComments/threadedComment"+o+"."+r,Pt.TCMNT)),w="xl/comments"+o+"."+r,jt(a,w,YI(v)),s.comments.push(w),nr(p,-1,"../comments"+o+"."+r,Pt.CMNT),y=!0}x["!legacy"]&&y&&jt(a,"xl/drawings/vmlDrawing"+o+".vml",XI(o,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&jt(a,m0(i),xf(p))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,jt(a,i,PI(t.Strings,t)),s.strs.push(i),nr(t.wbrels,-1,"sharedStrings."+r,Pt.SST)),i="xl/workbook."+r,jt(a,i,hM(e)),s.workbooks.push(i),nr(t.rels,1,i,Pt.WB),i="xl/theme/theme1.xml",jt(a,i,TS(e.Themes,t)),s.themes.push(i),nr(t.wbrels,-1,"theme/theme1.xml",Pt.THEME),i="xl/styles."+r,jt(a,i,WI(e,t)),s.styles.push(i),nr(t.wbrels,-1,"styles."+r,Pt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",jt(a,i,e.vbaraw),s.vba.push(i),nr(t.wbrels,-1,"vbaProject.bin",Pt.VBA)),i="xl/metadata."+r,jt(a,i,KI()),s.metadata.push(i),nr(t.wbrels,-1,"metadata."+r,Pt.XLMETA),h.length>1&&(i="xl/persons/person.xml",jt(a,i,une(h)),s.people.push(i),nr(t.wbrels,-1,"persons/person.xml",Pt.PEOPLE)),jt(a,"[Content_Types].xml",uI(s,t)),jt(a,"_rels/.rels",xf(t.rels)),jt(a,"xl/_rels/workbook."+r+".rels",xf(t.wbrels)),delete t.revssf,delete t.ssf,a}function FS(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ca(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function rce(e,t){return mt.find(e,"EncryptedPackage")?Zle(e,t):gM(e,t)}function nce(e,t){var r,n=e,s=t||{};return s.type||(s.type=Ft&&Buffer.isBuffer(e)?"buffer":"base64"),r=BD(n,s),Jle(r,s)}function NM(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return I_(e.slice(r),t);default:break e}return Ff.to_workbook(e,t)}function sce(e,t){var r="",n=FS(e,t);switch(t.type){case"base64":r=ca(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Jc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=hr(r)),t.type="binary",NM(r,t)}function ace(e,t){var r=e;return t.type=="base64"&&(r=ca(r)),r=c0.utils.decode(1200,r.slice(2),"str"),t.type="binary",NM(r,t)}function ice(e){return e.match(/[^\x00-\x7F]/)?Fi(e):e}function Pb(e,t,r,n){return n?(r.type="string",Ff.to_workbook(e,r)):Ff.to_workbook(t,r)}function lg(e,t){tS();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return lg(new Uint8Array(e),(r=kr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),yf={},r.dateNF&&(yf.dateNF=r.dateNF),r.type||(r.type=Ft&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ft?"buffer":"binary",n=eZ(e),typeof Uint8Array<"u"&&!Ft&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=ice(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=kr(r),r.type="array",lg(rS(n),r)}switch((s=FS(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return rce(mt.read(n,r),r);break;case 9:if(s[1]<=8)return gM(n,r);break;case 60:return I_(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return fte(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return MI.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?nce(n,r):Pb(e,n,r,a);case 239:return s[3]===60?I_(n,r):Pb(e,n,r,a);case 255:if(s[1]===254)return ace(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Pc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Pc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return D_.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return HI.to_workbook(n,r);break;case 10:case 13:case 32:return sce(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ute.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?D_.to_workbook(n,r):Pb(e,n,r,a)}function TM(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Q0(t.file,mt.write(e,{type:Ft?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return mt.write(e,t)}function oce(e,t){var r=kr(t||{}),n=Qle(e,r);return lce(n,r)}function lce(e,t){var r={},n=Ft?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?mt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(b1(s))}return t.password&&typeof encrypt_agile<"u"?TM(encrypt_agile(s,t.password),t):t.type==="file"?Q0(t.file,s):t.type=="string"?hr(s):s}function cce(e,t){var r=t||{},n=ile(e,r);return TM(n,r)}function Ri(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return u0(Fi(n));case"binary":return Fi(n);case"string":return e;case"file":return Q0(t.file,n,"utf8");case"buffer":return Ft?Bo(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ri(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function uce(e,t){switch(t.type){case"base64":return u0(e);case"binary":return e;case"string":return e;case"file":return Q0(t.file,e,"binary");case"buffer":return Ft?Bo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Xm(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?u0(r):t.type=="string"?hr(r):r;case"file":return Q0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function kM(e,t){tS(),roe(e);var r=kr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=kM(e,r);return r.type="array",b1(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ri(Qoe(e,r),r);case"slk":case"sylk":return Ri(II.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Ri(vM(e.Sheets[e.SheetNames[s]],r),r);case"txt":return uce(AM(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Ri(PS(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ri(MI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Xm(D_.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Ri(Ff.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Ri(HI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Ri(FI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Ri(EM(e,r),r);case"wk1":return Xm(Pc.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Xm(Pc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Xm(yM(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),cce(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return oce(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function fce(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function dce(e,t,r){var n={};return n.type="file",n.file=t,fce(n),kM(e,n)}function hce(e,t,r,n,s,a,i,o){var c=Jr(r),f=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!i||e[r])for(var g=t.s.c;g<=t.e.c;++g){var v=i?e[r][g]:e[n[g]+c];if(v===void 0||v.t===void 0){if(f===void 0)continue;a[g]!=null&&(x[a[g]]=f);continue}var y=v.v;switch(v.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[g]!=null){if(y==null)if(v.t=="e"&&y===null)x[a[g]]=null;else if(f!==void 0)x[a[g]]=f;else if(h&&y===null)x[a[g]]=null;else continue;else x[a[g]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?y:Po(v,y,o);y!=null&&(p=!1)}}return{row:x,isempty:p}}function cg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof h){case"string":c=$t(h);break;case"number":c=$t(e["!ref"]),c.s.r=h;break;default:c=h}n>0&&(s=0);var p=Jr(c.s.r),x=[],g=[],v=0,y=0,w=Array.isArray(e),_=c.s.r,S=0,E={};w&&!e[_]&&(e[_]=[]);var N=f.skipHidden&&e["!cols"]||[],k=f.skipHidden&&e["!rows"]||[];for(S=c.s.c;S<=c.e.c;++S)if(!(N[S]||{}).hidden)switch(x[S]=Dr(S),r=w?e[_][S]:e[x[S]+p],n){case 1:a[S]=S-c.s.c;break;case 2:a[S]=x[S];break;case 3:a[S]=f.header[S-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Po(r,null,f),y=E[i]||0,!y)E[i]=1;else{do o=i+"_"+y++;while(E[o]);E[i]=y,E[o]=1}a[S]=o}for(_=c.s.r+s;_<=c.e.r;++_)if(!(k[_]||{}).hidden){var O=hce(e,c,_,x,n,a,w,f);(O.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(g[v++]=O.row)}return g.length=v,g}var I5=/"/g;function pce(e,t,r,n,s,a,i,o){for(var c=!0,f=[],h="",p=Jr(r),x=t.s.c;x<=t.e.c;++x)if(n[x]){var g=o.dense?(e[r]||[])[x]:e[n[x]+p];if(g==null)h="";else if(g.v!=null){c=!1,h=""+(o.rawNumbers&&g.t=="n"?g.v:Po(g,null,o));for(var v=0,y=0;v!==h.length;++v)if((y=h.charCodeAt(v))===s||y===a||y===34||o.forceQuotes){h='"'+h.replace(I5,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(c=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(I5,'""')+'"')):h="";f.push(h)}return o.blankrows===!1&&c?null:f.join(i)}function PS(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=$t(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),h="",p=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(x[v]||{}).hidden||(p[v]=Dr(v));for(var y=0,w=s.s.r;w<=s.e.r;++w)(g[w]||{}).hidden||(h=pce(e,s,w,p,i,c,a,n),h!=null&&(n.strip&&(h=h.replace(f,"")),(h||n.blankrows!==!1)&&r.push((y++?o:"")+h)));return delete n.dense,r.join("")}function AM(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=PS(e,t);return r}function mce(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=$t(e["!ref"]),a="",i=[],o,c=[],f=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Dr(o);for(var h=s.s.r;h<=s.e.r;++h)for(a=Jr(h),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=f?(e[h]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function CM(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Ir(n.origin):n.origin;i=c.r,o=c.c}var f,h={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var p=$t(a["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),i==-1&&(i=p.e.r+1,h.e.r=i+t.length-1+s)}else i==-1&&(i=0,h.e.r=t.length-1+s);var x=n.header||[],g=0;t.forEach(function(y,w){Wr(y).forEach(function(_){(g=x.indexOf(_))==-1&&(x[g=x.length]=_);var S=y[_],E="z",N="",k=bt({c:o+g,r:i+w+s});f=_0(a,k),S&&typeof S=="object"&&!(S instanceof Date)?a[k]=S:(typeof S=="number"?E="n":typeof S=="boolean"?E="b":typeof S=="string"?E="s":S instanceof Date?(E="d",n.cellDates||(E="n",S=_n(S)),N=n.dateNF||yt[14]):S===null&&n.nullError&&(E="e",S=0),f?(f.t=E,f.v=S,delete f.w,delete f.R,N&&(f.z=N)):a[k]=f={t:E,v:S},N&&(f.z=N))})}),h.e.c=Math.max(h.e.c,o+x.length-1);var v=Jr(i);if(s)for(g=0;g<x.length;++g)a[Dr(g+o)+v]={t:"s",v:x[g]};return a["!ref"]=Ct(h),a}function xce(e,t){return CM(null,e,t)}function _0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ir(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?_0(e,bt(t)):_0(e,bt({r:t,c:r||0}))}function gce(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function LS(){return{SheetNames:[],Sheets:{}}}function BS(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(dM(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function yce(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=gce(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function vce(e,t){return e.z=t,e}function RM(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function bce(e,t,r){return RM(e,"#"+t,r)}function wce(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function _ce(e,t,r,n){for(var s=typeof t!="string"?t:$t(t),a=typeof t=="string"?t:Ct(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=_0(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var qh={encode_col:Dr,encode_row:Jr,encode_cell:bt,encode_range:Ct,decode_col:pS,decode_row:hS,split_cell:OZ,decode_cell:Ir,decode_range:Vs,format_cell:Po,sheet_add_aoa:nI,sheet_add_json:CM,sheet_add_dom:bM,aoa_to_sheet:pd,json_to_sheet:xce,table_to_sheet:wM,table_to_book:Ale,sheet_to_csv:PS,sheet_to_txt:AM,sheet_to_json:cg,sheet_to_html:vM,sheet_to_formulae:mce,sheet_to_row_object_array:cg,sheet_get_cell:_0,book_new:LS,book_append_sheet:BS,book_set_sheet_visibility:yce,cell_set_number_format:vce,cell_set_hyperlink:RM,cell_set_internal_link:bce,cell_add_comment:wce,sheet_set_array_formula:_ce,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ece=()=>{const e=Ln(),[t,r]=ne.useState([]),[n,s]=ne.useState(""),[a,i]=ne.useState(null),[o,c]=ne.useState(!1),[f,h]=ne.useState(!0),[p,x]=ne.useState(null),[g,v]=ne.useState(null),[y,w]=ne.useState(null);ne.useEffect(()=>{_()},[]);const _=async()=>{try{h(!0);const O=await zt.get("clients/approved");r(O.data)}catch{v("Failed to load approved clients")}finally{h(!1)}},S=async O=>{var V;const R=((V=O.target.files)==null?void 0:V[0])??null;if(!R){i(null),w(null);return}if(!R.name.endsWith(".xlsx")){v("Invalid format. Please select an Excel (.xlsx) file"),i(null);return}i(R),v(null),x(null),await E(R)},E=async O=>{try{const R=await O.arrayBuffer(),V=new Uint8Array(R),I=lg(V,{type:"array"}),Z=I.Sheets[I.SheetNames[0]],ce=qh.sheet_to_json(Z);w(ce.slice(0,10))}catch(R){console.error("Preview failed:",R),w(null)}},N=async()=>{var R,V;if(!n){v("Please select a client to associate with these products");return}if(!a){v("Please select a file to upload");return}c(!0),v(null),x(null);const O=new FormData;O.append("file",a);try{const I=await zt.post(`/upload/${n}`,O,{headers:{"Content-Type":"multipart/form-data"}});x(I.data),i(null),w(null),setTimeout(()=>{e("/gsa-products")},2500)}catch(I){v(((V=(R=I==null?void 0:I.response)==null?void 0:R.data)==null?void 0:V.detail)??(I==null?void 0:I.message)??"Upload failed")}finally{c(!1)}},k=()=>!y||y.length===0?[]:Object.keys(y[0]);return d.jsx("div",{className:"min-h-screen bg-linear-to-br from-slate-50 to-slate-100 p-6 md:p-10",children:d.jsxs("div",{className:" mx-auto",children:[d.jsxs("button",{onClick:()=>e(-1),className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 transition-colors mb-6 font-medium group",children:[d.jsx(Es,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),"Back to Products"]}),d.jsxs("div",{className:"mb-10",children:[d.jsx("h1",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Upload GSA Price List"}),d.jsx("p",{className:"text-slate-500 mt-1",children:"Update your product catalog by uploading an Excel spreadsheet."})]}),d.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[d.jsxs("div",{className:"bg-white rounded-4xl shadow-sm border border-slate-200 p-8 md:p-10 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 p-8 pointer-events-none opacity-5",children:d.jsx(__,{size:120})}),d.jsxs("div",{className:"space-y-8 relative",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"w-6 h-6 rounded-full bg-[#3399cc] text-white flex items-center justify-center text-xs font-bold",children:"1"}),d.jsx("label",{className:"text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Select Client"})]}),f?d.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-2xl",children:[d.jsx(ar,{className:"w-5 h-5 animate-spin text-[#24578f]"}),d.jsx("span",{className:"text-slate-500 text-sm font-medium",children:"Fetching approved clients..."})]}):d.jsxs("div",{className:"relative",children:[d.jsx(In,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:18}),d.jsxs("select",{value:n,onChange:O=>s(O.target.value),className:"w-full pl-12 pr-4 py-4 bg-white border border-slate-200 rounded-2xl focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-slate-900 appearance-none font-medium",children:[d.jsx("option",{value:"",children:"-- Choose an approved client --"}),t.map(O=>d.jsxs("option",{value:O.client_id,children:[O.company_name,O.contract_number?` (${O.contract_number})`:"(No contract)"]},O.client_id))]}),d.jsx(Sce,{})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"w-6 h-6 rounded-full bg-[#3399cc] text-white flex items-center justify-center text-xs font-bold",children:"2"}),d.jsx("label",{className:"text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Upload Spreadsheet"})]}),a?d.jsxs("div",{className:"flex items-center justify-between p-6 bg-blue-50 border border-blue-100 rounded-2xl",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-12 h-12 bg-[#3399cc] rounded-xl flex items-center justify-center text-white",children:d.jsx(__,{size:24})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-bold text-slate-900 truncate max-w-50 md:max-w-xs",children:a.name}),d.jsxs("p",{className:"text-xs text-slate-500",children:[(a.size/1024).toFixed(1)," KB  Ready to upload"]})]})]}),d.jsx("button",{onClick:()=>{i(null),w(null)},className:"p-2 hover:bg-white rounded-full text-slate-400 hover:text-red-500 transition-all",children:d.jsx(Zn,{size:20})})]}):d.jsxs("label",{className:"group flex flex-col items-center justify-center w-full h-56 border-2 border-dashed border-slate-200 rounded-4xl cursor-pointer hover:border-[#3399cc] hover:bg-blue-50/30 transition-all bg-slate-50/50",children:[d.jsxs("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:d.jsx(Of,{className:"w-8 h-8 text-[#3399cc]"})}),d.jsx("p",{className:"text-base font-bold text-slate-700 mb-1",children:"Click to browse and upload"}),d.jsx("p",{className:"text-sm text-slate-400",children:"Excel (.xlsx) files only"})]}),d.jsx("input",{id:"file-input",type:"file",accept:".xlsx",onChange:S,className:"hidden"})]})]}),d.jsx("div",{className:"pt-4",children:d.jsx("button",{onClick:N,disabled:o||!a||!n,className:"w-full bg-[#3399cc] text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-3 transition-all hover:bg-[#2b82ad] disabled:opacity-40 disabled:grayscale shadow-lg shadow-blue-200 hover:shadow-xl active:scale-[0.98]",children:o?d.jsxs(d.Fragment,{children:[d.jsx(ar,{className:"w-5 h-5 animate-spin"})," Processing Upload..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Of,{size:20})," Start Product Import"," ",d.jsx(a0,{size:18})]})})}),g&&d.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 rounded-2xl flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[d.jsx(Ic,{className:"w-5 h-5 text-red-500 shrink-0 mt-0.5"}),d.jsx("p",{className:"text-sm text-red-700 font-medium",children:g})]}),p&&d.jsxs("div",{className:"p-5 bg-emerald-50 border border-emerald-100 rounded-2xl flex items-start gap-4 animate-in zoom-in-95 duration-300",children:[d.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-full flex items-center justify-center shrink-0",children:d.jsx(PK,{className:"w-6 h-6 text-white"})}),d.jsxs("div",{className:"text-sm text-emerald-800",children:[d.jsx("p",{className:"font-black text-base uppercase tracking-tight",children:"Upload Successful"}),d.jsxs("div",{className:"flex gap-4 mt-1 font-medium opacity-80",children:[d.jsxs("span",{children:["Inserted: ",d.jsx("strong",{children:p.inserted})]}),d.jsx("span",{className:"w-1 h-1 bg-emerald-300 rounded-full my-auto"}),d.jsxs("span",{children:["Updated: ",d.jsx("strong",{children:p.updated})]})]}),d.jsx("p",{className:"mt-3 text-xs opacity-60 italic font-medium",children:"Redirecting to catalog..."})]})]})]})]}),y&&y.length>0&&d.jsxs("div",{className:"bg-white rounded-4xl shadow-sm border border-slate-200 overflow-hidden animate-in fade-in slide-in-from-bottom-4 duration-500",children:[d.jsxs("div",{className:"p-6 border-b border-slate-100 bg-slate-50/50 flex items-center justify-between",children:[d.jsx("h2",{className:"text-sm font-black text-slate-400 uppercase tracking-[0.2em]",children:"Data Preview (First 10 Rows)"}),d.jsx("span",{className:"text-[10px] font-bold bg-slate-200 text-slate-600 px-2 py-0.5 rounded uppercase",children:"Read Only"})]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full border-collapse",children:[d.jsx("thead",{children:d.jsx("tr",{className:"bg-white",children:k().map(O=>d.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-slate-400 uppercase tracking-wider border-b border-slate-100",children:O},O))})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:y.map((O,R)=>d.jsx("tr",{className:"hover:bg-slate-50/50 transition-colors",children:k().map(V=>d.jsx("td",{className:"px-6 py-4 text-xs font-semibold text-slate-600 whitespace-nowrap",children:O[V]!=null?String(O[V]):""},V))},R))})]})})]})]})]})})},Sce=()=>d.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400",children:d.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{d:"M2.5 4.5L6 8L9.5 4.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})});function Nce({onUploadClick:e}){return d.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center md:justify-between gap-6 mb-12 mx-auto",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"Products"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Catalog management and inventory overview"})]}),d.jsxs("button",{onClick:e,className:"flex items-center justify-center gap-2 bg-[#3399cc] text-white px-6 py-2.5 rounded-xl font-semibold hover:bg-[#2b82ad] transition-all shadow-md hover:shadow-lg active:scale-95",children:[d.jsx(Of,{size:18}),"Upload GSA"]})]})}function Tce({clients:e,selectedClient:t,onClientSelect:r}){const n=ne.useRef(null),[s,a]=ne.useState(!1),[i,o]=ne.useState("");ne.useEffect(()=>{const h=p=>{n.current&&!n.current.contains(p.target)&&a(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const c=h=>{r(h),a(!1),o("")},f=e.filter(h=>h.company_name.toLowerCase().includes(i.toLowerCase()));return d.jsxs("div",{className:"relative w-full md:w-80",ref:n,children:[d.jsxs("div",{onClick:()=>a(!s),className:`w-full flex items-center justify-between px-4 py-3.5 bg-slate-50/50 border rounded-2xl cursor-pointer transition-all hover:border-slate-300 ${s?"border-[#3399cc] ring-4 ring-[#3399cc]/10":"border-slate-200"}`,children:[d.jsxs("div",{className:"flex items-center gap-3 overflow-hidden text-slate-700",children:[d.jsx(In,{size:18,className:"text-slate-400 shrink-0"}),d.jsx("span",{className:`truncate font-medium ${t?"text-slate-900":"text-slate-400"}`,children:t?t.company_name:"All Clients"})]}),d.jsx(i0,{size:18,className:`text-slate-400 transition-transform duration-300 ${s?"rotate-180":""}`})]}),s&&d.jsxs("div",{className:"absolute z-50 w-full mt-2 bg-white border border-slate-200 rounded-2xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[d.jsx("div",{className:"p-3 border-b border-slate-100 bg-slate-50/50",children:d.jsxs("div",{className:"relative",children:[d.jsx(Wl,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:14}),d.jsx("input",{autoFocus:!0,type:"text",placeholder:"Filter by company name...",value:i,onChange:h=>o(h.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-200 rounded-xl outline-none focus:border-[#3399cc] bg-white transition-colors"})]})}),d.jsxs("div",{className:"max-h-64 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-200",children:[d.jsxs("div",{onClick:()=>c(null),className:"px-4 py-3 text-sm hover:bg-slate-50 cursor-pointer flex items-center justify-between transition-colors",children:[d.jsx("span",{className:"font-medium text-slate-600",children:"Show All"}),!t&&d.jsx(Kc,{size:16,className:"text-[#3399cc]"})]}),f.map(h=>d.jsxs("div",{onClick:()=>c(h),className:"px-4 py-3 text-sm hover:bg-slate-50 cursor-pointer flex items-center justify-between transition-colors border-t border-slate-50",children:[d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-semibold text-slate-800",children:h.company_name}),d.jsx("span",{className:"text-[10px] text-slate-400 uppercase tracking-tight",children:h.status})]}),(t==null?void 0:t.client_id)===h.client_id&&d.jsx(Kc,{size:16,className:"text-[#3399cc]"})]},h.client_id)),f.length===0&&d.jsx("div",{className:"px-4 py-10 text-center text-slate-400 text-sm italic",children:"No companies found"})]})]})]})}function kce({searchTerm:e,onSearchChange:t,clients:r,selectedClient:n,onClientSelect:s}){return d.jsxs("div",{className:"mx-auto bg-white p-4 rounded-4xl shadow-sm border border-slate-100 mb-8 flex flex-col lg:flex-row gap-4 items-center",children:[d.jsxs("div",{className:"relative flex-1 w-full",children:[d.jsx(Wl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:20}),d.jsx("input",{type:"text",placeholder:"Search by name, manufacturer, or part number...",value:e,onChange:a=>t(a.target.value),className:"w-full pl-14 pr-6 py-3.5 rounded-2xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20  bg-slate-50/50 text-slate-700 placeholder:text-slate-400 transition-all font-medium"})]}),d.jsx(Tce,{clients:r,selectedClient:n,onClientSelect:s})]})}const jM=e=>e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e):"-";function Ace({product:e,onClick:t}){return d.jsxs("tr",{className:"hover:bg-slate-50/80 transition-colors cursor-pointer group",onClick:t,children:[d.jsxs("td",{className:"px-6 py-4",children:[d.jsx("div",{className:"text-sm font-bold text-slate-800 group-hover:text-[#3399cc] transition-colors",children:e.item_name}),e.item_description&&d.jsx("div",{className:"text-xs text-slate-500 mt-1 truncate max-w-62.5 font-medium",children:e.item_description})]}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:`px-3 py-1 rounded-lg text-[10px] font-extrabold uppercase tracking-wider ${e.item_type==="A"?"bg-blue-50 text-blue-600":"bg-emerald-50 text-emerald-600"}`,children:e.item_type==="A"?"Accessory":"Base"})}),d.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 font-semibold",children:e.client_name}),d.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.manufacturer}),d.jsx("td",{className:"px-6 py-4 text-sm font-mono text-slate-600 font-medium",children:e.manufacturer_part_number}),d.jsx("td",{className:"px-6 py-4 text-sm font-black text-slate-900",children:jM(e.commercial_list_price)}),d.jsx("td",{className:"px-6 py-4 text-sm font-mono text-slate-600",children:e.uom})]})}function Cce({currentPage:e,totalPages:t,itemsPerPage:r,startIndex:n,totalItems:s,onPageChange:a}){const i=()=>{const o=[];if(t<=5)for(let f=1;f<=t;f++)o.push(f);else e<=3?o.push(1,2,3,4,"...",t):e>=t-2?o.push(1,"...",t-3,t-2,t-1,t):o.push(1,"...",e-1,e,e+1,"...",t);return o};return d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:n+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(n+r,s)})," ","of ",d.jsx("span",{className:"text-slate-900 font-semibold",children:s})," ","products"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:e===1,onClick:()=>a(e-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Es,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:i().map((o,c)=>d.jsx(We.Fragment,{children:o==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>a(Number(o)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                  ${e===o?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:o})},c))}),d.jsx("button",{disabled:e===t,onClick:()=>a(e+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})}function Rce({products:e,filteredProducts:t,loading:r,selectedClient:n,currentPage:s,totalPages:a,itemsPerPage:i,startIndex:o,onProductClick:c,onPageChange:f}){return d.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden relative transition-all",children:[d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50/50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Item Description"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Type"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Client"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Manufacturer"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"MFR Part #"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Price"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"UOM"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:r?d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"px-6 py-32",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading Products..."})]})})}):e.length>0?e.map(h=>d.jsx(Ace,{product:h,onClick:()=>c(h)},h.product_id)):d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"px-6 py-20",children:d.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center mb-4 border border-slate-100",children:d.jsx(g1,{className:"w-8 h-8 text-slate-300"})}),d.jsx("h3",{className:"text-base font-bold text-slate-500",children:n?"No products found for this client":"No products match your search"})]})})})})]})}),t.length>i&&d.jsx(Cce,{currentPage:s,totalPages:a,itemsPerPage:i,startIndex:o,totalItems:t.length,onPageChange:f})]})}function jce({product:e,onClose:t}){return d.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 transition-opacity",onClick:t}),d.jsxs("div",{className:"relative w-full max-w-lg bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[d.jsxs("div",{className:"p-6 border-b border-slate-100 flex items-start justify-between bg-white sticky top-0 z-10",children:[d.jsxs("div",{className:"pr-8",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${e.item_type==="A"?"bg-blue-100 text-blue-700":"bg-emerald-100 text-emerald-700"}`,children:e.item_type==="A"?"Accessory":"Base Product"}),e.hazmat&&d.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 rounded text-[10px] font-bold uppercase",children:"Hazmat"})]}),d.jsx("h2",{className:"text-xl font-bold text-slate-900 leading-tight",children:e.item_name}),d.jsx("p",{className:"text-xs text-slate-500 mt-1 font-medium italic",children:e.item_description})]}),d.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-400 hover:text-slate-900",children:d.jsx(Zn,{size:24})})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-8 space-y-10 scrollbar-thin",children:[e.photo_path&&d.jsx("div",{className:"w-full h-48 bg-slate-50 rounded-2xl border border-slate-100 overflow-hidden flex items-center justify-center",children:d.jsx("img",{src:e.photo_path,alt:e.item_name,className:"h-full w-full object-contain p-4",onError:r=>r.currentTarget.style.display="none"})}),d.jsxs(ph,{title:"Core Identifiers",children:[d.jsx(Rn,{label:"Client",value:e.client_name}),d.jsx(Rn,{label:"Client Part #",value:e.client_part_number}),d.jsx(Rn,{label:"Mfr Part #",value:e.manufacturer_part_number}),d.jsx(Rn,{label:"Manufacturer",value:e.manufacturer})]}),d.jsxs(ph,{title:"Physical Specifications",children:[d.jsx(Rn,{label:"Dimensions (L x W x H)",value:e.length?`${e.length} x ${e.width} x ${e.height} ${e.physical_uom||""}`:null}),d.jsx(Rn,{label:"Weight",value:e.weight_lbs?`${e.weight_lbs} lbs`:null}),d.jsx(Rn,{label:"Warranty",value:e.warranty_period}),d.jsx(Rn,{label:"Quantity per Pack",value:`${e.quantity_per_pack||1} ${e.quantity_unit_uom||""}`})]}),d.jsxs(ph,{title:"Pricing & Classification",children:[d.jsx(Rn,{label:"Commercial List Price",value:jM(e.commercial_list_price)}),d.jsx(Rn,{label:"UOM",value:e.uom}),d.jsx(Rn,{label:"SIN",value:e.sin}),d.jsx(Rn,{label:"NSN",value:e.nsn}),d.jsx(Rn,{label:"UPC",value:e.upc}),d.jsx(Rn,{label:"UNSPSC",value:e.unspsc})]}),d.jsxs(ph,{title:"Compliance & Environment",children:[d.jsx(Rn,{label:"Country of Origin",value:e.country_of_origin}),d.jsx(Rn,{label:"Recycled Content",value:e.recycled_content_percent?`${e.recycled_content_percent}%`:"0%"}),d.jsx(Rn,{label:"Hazmat Status",value:e.hazmat?"Yes":"No"}),d.jsx(Rn,{label:"Product Info Code",value:e.product_info_code})]}),d.jsx(ph,{title:"Resources & Links",children:d.jsxs("div",{className:"col-span-2 flex flex-col gap-3",children:[e.product_url&&d.jsxs("a",{href:e.product_url,target:"_blank",rel:"noreferrer",className:"flex items-center justify-between gap-3 text-slate-700 hover:text-[#3399cc] font-semibold text-sm bg-slate-50 p-4 rounded-xl border border-slate-100 transition-all hover:border-[#3399cc]/30",children:[d.jsxs("span",{className:"flex items-center gap-2",children:[d.jsx(w_,{size:16})," Product Page"]}),d.jsx(Mr,{size:14,className:"text-slate-400"})]}),e.url_508&&d.jsxs("a",{target:"_blank",rel:"noreferrer",className:"flex items-center justify-between gap-3 text-slate-700 hover:text-[#3399cc] font-semibold text-sm bg-slate-50 p-4 rounded-xl border border-slate-100 transition-all hover:border-[#3399cc]/30",children:[d.jsxs("span",{className:"flex items-center gap-2",children:[d.jsx(Kc,{size:16,className:"text-emerald-500"})," 508 Compliance Link"]}),d.jsx(Mr,{size:14,className:"text-slate-400"})]})]})}),d.jsx("div",{className:"pt-6 border-t border-slate-100",children:d.jsxs("div",{className:"flex justify-between text-[10px] font-medium text-slate-400 uppercase tracking-tighter",children:[d.jsxs("span",{children:["Created:"," ",e.created_time?new Date(e.created_time).toLocaleDateString("en-US"):"N/A"]}),d.jsxs("span",{children:["Last Updated:"," ",e.updated_time?new Date(e.updated_time).toLocaleDateString("en-US"):"N/A"]})]})})]})]})]})}function ph({title:e,children:t}){return d.jsxs("div",{children:[d.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-5",children:e}),d.jsx("div",{className:"grid grid-cols-2 gap-y-8 gap-x-4",children:t})]})}function Rn({label:e,value:t}){return d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1 tracking-wide",children:e}),d.jsx("p",{className:"text-sm font-bold text-slate-800",children:t??""})]})}function Oce(){const e=Ln(),[t,r]=ne.useState([]),[n,s]=ne.useState([]),[a,i]=ne.useState(null),[o,c]=ne.useState(!0),[f,h]=ne.useState(""),[p,x]=ne.useState(""),[g,v]=ne.useState(1),[y,w]=ne.useState(null),_=10;ne.useEffect(()=>{(async()=>{var V,I;try{c(!0),h("");const[Z,ce]=await Promise.allSettled([jx.getAllProducts(),bD.getApprovedClients()]);Z.status==="fulfilled"?r(Z.value.items):((I=(V=Z.reason)==null?void 0:V.response)==null?void 0:I.status)===404?r([]):h("Failed to load products"),ce.status==="fulfilled"&&s(ce.value)}catch{h("Failed to initialize page data")}finally{c(!1)}})()},[]);const S=async R=>{w(R),v(1),h("");try{if(c(!0),R){const V=await jx.getProductsByClient(R.client_id);r(V.items)}else{const V=await jx.getAllProducts();r(V.items)}}catch(V){V.response&&V.response.status===404?r([]):(console.error("Filtering error",V),h("Failed to fetch products for this client"))}finally{c(!1)}},E=ne.useMemo(()=>t.filter(R=>R.item_name.toLowerCase().includes(p.toLowerCase())||R.manufacturer.toLowerCase().includes(p.toLowerCase())||R.manufacturer_part_number.toLowerCase().includes(p.toLowerCase())),[t,p]),N=Math.ceil(E.length/_),k=(g-1)*_,O=ne.useMemo(()=>E.slice(k,k+_),[E,k,_]);return d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-6 lg:p-10 space-y-10",children:[d.jsxs("div",{className:"mx-auto",children:[d.jsx(Nce,{onUploadClick:()=>e("/gsa-products/upload")}),d.jsx(kce,{searchTerm:p,onSearchChange:R=>{x(R),v(1)},clients:n,selectedClient:y,onClientSelect:S}),d.jsx(Rce,{products:O,filteredProducts:E,loading:o,selectedClient:y,currentPage:g,totalPages:N,itemsPerPage:_,startIndex:k,onProductClick:i,onPageChange:v})]}),a&&d.jsx(jce,{product:a,onClose:()=>i(null)})]})}function OM(e,t){const r=qh.book_new(),n={Additions:t.additions,Deletions:t.deletions,"Price Increases":t.priceIncreases,"Price Decreases":t.priceDecreases,"Description Changes":t.descriptionChanges};Object.entries(n).forEach(([a,i])=>{if(!i||i.length===0)return;const o=i.map(f=>({"Part Number":f.manufacturer_part_number||"","Product Name":f.product_name||"","Old Price":f.old_price??"","New Price":f.new_price??"","Old Description":f.old_description||"","New Description":f.new_description||""})),c=qh.json_to_sheet(o);qh.book_append_sheet(r,c,a)});const s=`ANAL-JOB-${e}-analysis.xlsx`;dce(r,s)}const Dce=[{id:1,title:"Select Client",description:"Choose a client"},{id:2,title:"Upload Pricelist",description:"Upload Excel file"},{id:3,title:"Run Analysis",description:"Process data"},{id:4,title:"Review Results",description:"Review and export"}];function Ice(){const e=Ln(),[t,r]=ne.useState(1),[n,s]=ne.useState(""),[a,i]=ne.useState(!1),[o,c]=ne.useState("additions"),[f,h]=ne.useState(1),p=5,[x,g]=ne.useState([]),[v,y]=ne.useState(!0),[w,_]=ne.useState(null),[S,E]=ne.useState(null),[N,k]=ne.useState(""),[O,R]=ne.useState(null),[V,I]=ne.useState(null),[Z,ce]=ne.useState(null),[F,X]=ne.useState(0),[P,ie]=ne.useState(!1);ne.useEffect(()=>{te()},[]);const te=async()=>{try{y(!0);const q=await zt.get("clients/approved");g(q.data)}catch{}finally{y(!1)}},Y=async q=>{ie(!0);try{const W=await zt.get(`/jobs/${q}`);I(W.data)}catch{_("Failed to fetch detailed job results.")}finally{ie(!1)}},ve=async q=>{var ee,B;if(q.type==="click"){(ee=document.getElementById("file-upload-input"))==null||ee.click();return}const J=((B=q.target.files)==null?void 0:B[0])??null;if(!J)return;if(!J.name.endsWith(".xlsx")){_("Invalid format. Please select an Excel (.xlsx) file");return}E(J),k(J.name),_(null);const re=await J.arrayBuffer(),U=new Uint8Array(re),L=lg(U,{type:"array"}),se=L.Sheets[L.SheetNames[0]],Q=qh.sheet_to_json(se,{defval:""});if(Q.length===0){_("The uploaded Excel file contains no data rows."),E(null),ce(null),X(0);return}X(Q.length),ce(Q)},oe=async()=>{var W,J;if(!S||!n){_("Missing file or client selection");return}i(!0),_(null);const q=new FormData;q.append("file",S);try{const re=await zt.post(`/cpl/${n}`,q,{headers:{"Content-Type":"multipart/form-data"}});R(re.data),await Y(re.data.job_id),r(4),i(!1)}catch(re){i(!1),_(((J=(W=re==null?void 0:re.response)==null?void 0:W.data)==null?void 0:J.detail)??"Analysis failed. Please try again.")}},Ee=()=>{const q=(V==null?void 0:V.modifications_actions)||[];return{additions:q.filter(W=>W.action_type==="NEW_PRODUCT"||W.action_type==="ADD_PRODUCT"),deletions:q.filter(W=>W.action_type==="REMOVED_PRODUCT"),priceIncreases:q.filter(W=>W.action_type==="PRICE_INCREASE"),priceDecreases:q.filter(W=>W.action_type==="PRICE_DECREASE"),descriptionChanges:q.filter(W=>W.action_type==="DESCRIPTION_CHANGE")}},K=()=>{r(1),s(""),E(null),k(""),R(null),I(null),ce(null),X(0),_(null),c("additions"),h(1)},D=()=>{switch(t){case 1:return d.jsxs("div",{className:"group bg-white/80 backdrop-blur-md rounded-3xl border border-slate-200 shadow-2xl shadow-slate-200/60 overflow-hidden",children:[d.jsxs("div",{className:"p-8 border-b border-slate-100 bg-slate-50/30",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[d.jsx("div",{className:"p-2.5 bg-cyan-50 rounded-xl shadow-sm ring-1 ring-cyan-100",children:d.jsx(In,{className:"w-5 h-5 text-[#3399cc]"})}),d.jsx("h3",{className:"text-xl font-semibold text-slate-800 tracking-tight",children:"Select Client"})]}),d.jsx("p",{className:"text-sm text-slate-500",children:"Choose the client for analysis"})]}),d.jsxs("div",{className:"p-8 space-y-8",children:[d.jsxs("div",{className:"relative group/select",children:[d.jsx(In,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:18}),d.jsxs("select",{value:n,onChange:he=>{s(he.target.value),_(null)},className:"w-full pl-12 pr-12 py-4 bg-white border border-slate-200 rounded-2xl focus:border-[#3399cc] outline-none appearance-none font-medium cursor-pointer",children:[d.jsx("option",{value:"",children:"-- Choose an approved client --"}),x.map(he=>d.jsxs("option",{value:he.client_id,children:[he.company_name," (",he.contract_number||"No Contract",")"]},he.client_id))]}),d.jsx(i0,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400"})]}),w&&d.jsxs("div",{className:"p-4 bg-red-50 text-red-700 rounded-xl flex items-center gap-2",children:[d.jsx(Ic,{className:"w-5 h-5"})," ",w]}),d.jsx("div",{className:"flex justify-end",children:d.jsxs("button",{onClick:()=>{r(2),_(null)},disabled:!n,className:"btn-primary",children:["Continue ",d.jsx(Mr,{className:"w-4 h-4"})]})})]})]});case 2:return d.jsxs("div",{className:"group bg-white/80 backdrop-blur-md rounded-3xl border border-slate-200 shadow-2xl shadow-slate-200/60 overflow-hidden",children:[d.jsxs("div",{className:"p-8 border-b border-slate-100 bg-slate-50/30",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("div",{className:"p-2.5 bg-cyan-50 rounded-xl shadow-sm ring-1 ring-cyan-100",children:d.jsx(__,{className:"w-5 h-5 text-[#3399cc]"})}),d.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:"Upload Commercial Pricelist"})]}),d.jsx("p",{className:"text-sm text-slate-500",children:"Upload the updated commercial pricelist (Excel format)"})]}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsx("input",{id:"file-upload-input",type:"file",className:"hidden",accept:".xlsx",onChange:ve}),d.jsx("div",{className:`border-2 border-dashed rounded-xl p-12 text-center transition-colors cursor-pointer ${S?"border-emerald-500 bg-emerald-50":"border-slate-300 hover:border-[#3399cc] hover:bg-cyan-50/50"}`,onClick:ve,children:S?d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"w-16 h-16 mx-auto rounded-xl bg-emerald-100 flex items-center justify-center",children:d.jsx(Kc,{className:"w-8 h-8 text-emerald-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-slate-900",children:N}),d.jsx("p",{className:"text-sm text-slate-500",children:"Click to replace"})]})]}):d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-sm flex items-center justify-center mx-auto",children:d.jsx(Of,{className:"w-8 h-8 text-[#3399cc]"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-slate-900",children:"Click to browse and upload"}),d.jsx("p",{className:"text-sm text-slate-500",children:"Excel files (.xlsx)"})]})]})}),Z&&Z.length>0&&d.jsxs("div",{className:"mt-6 border border-slate-200 rounded-xl overflow-hidden",children:[d.jsxs("div",{className:"bg-slate-50 px-4 py-2 border-b border-slate-200 flex justify-between items-center",children:[d.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase",children:["Data Preview (",F," rows)"]}),d.jsx("button",{onClick:()=>{E(null),ce(null)},className:"text-slate-400 hover:text-red-500",children:d.jsx(Zn,{className:"w-4 h-4"})})]}),d.jsx("div",{className:"max-h-100 overflow-auto",children:d.jsxs("table",{className:"w-full text-[11px] text-left border-collapse",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsx("tr",{className:"bg-slate-100 border-b border-slate-200",children:Object.keys(Z[0]).map(he=>d.jsx("th",{className:"px-4 py-2 font-bold text-slate-700 whitespace-nowrap",children:he},he))})}),d.jsx("tbody",{children:Z.map((he,M)=>d.jsx("tr",{className:"bg-white hover:bg-slate-50 border-b border-slate-50 transition-colors",children:Object.values(he).map((A,j)=>d.jsx("td",{className:"px-4 py-2 text-slate-600 whitespace-nowrap",children:String(A)},j))},M))})]})})]}),w&&d.jsxs("div",{className:"p-4 bg-red-50 text-red-700 rounded-xl flex items-center gap-2",children:[d.jsx(Ic,{className:"w-5 h-5"})," ",w]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("button",{onClick:()=>{r(1),E(null),ce(null),_(null)},className:"h-11 flex items-center gap-2 px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-700 font-bold hover:bg-slate-50 transition-all shadow-sm",children:[d.jsx(Es,{className:"w-4 h-4"})," Back"]}),d.jsxs("button",{onClick:()=>{r(3),_(null)},disabled:!S,className:"btn-primary",children:["Continue ",d.jsx(Mr,{className:"w-4 h-4"})]})]})]})]});case 3:const q=x.find(he=>String(he.client_id)===String(n));return d.jsxs("div",{className:"group bg-white/80 backdrop-blur-md rounded-3xl border border-slate-200 shadow-2xl shadow-slate-200/60 overflow-hidden",children:[d.jsxs("div",{className:"p-8 border-b border-slate-100 bg-slate-50/30",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("div",{className:"p-2.5 bg-cyan-50 rounded-xl shadow-sm ring-1 ring-cyan-100",children:d.jsx(aY,{className:"w-5 h-5 text-[#3399cc]"})}),d.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:"Run Analysis"})]}),d.jsx("p",{className:"text-sm text-slate-500",children:"Compare uploaded data with GSA contract data"})]}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full mb-10",children:[d.jsxs("div",{className:"p-4 rounded-2xl bg-slate-50 border border-slate-100 flex items-center gap-4",children:[d.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:d.jsx(In,{className:"w-5 h-5 text-[#3399cc]"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Client Name"}),d.jsx("p",{className:"text-sm font-semibold text-slate-700",children:(q==null?void 0:q.company_name)||"N/A"})]})]}),d.jsxs("div",{className:"p-4 rounded-2xl bg-slate-50 border border-slate-100 flex items-center gap-4",children:[d.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:d.jsx(Gx,{className:"w-5 h-5 text-emerald-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Contract Number"}),d.jsx("p",{className:"text-sm font-semibold text-slate-700",children:(q==null?void 0:q.contract_number)||"No Contract"})]})]}),d.jsxs("div",{className:"p-4 rounded-2xl bg-slate-50 border border-slate-100 flex items-center gap-4",children:[d.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:d.jsx(La,{className:"w-5 h-5 text-indigo-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"File Name"}),d.jsx("p",{className:"text-sm font-semibold text-slate-700 max-w-70",children:N})]})]}),d.jsxs("div",{className:"p-4 rounded-2xl bg-slate-50 border border-slate-100 flex items-center gap-4",children:[d.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:d.jsx(cD,{className:"w-5 h-5 text-orange-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Total Rows"}),d.jsx("p",{className:"text-sm font-semibold text-slate-700",children:F.toLocaleString()})]})]})]}),w&&d.jsxs("div",{className:"p-4 bg-red-50 text-red-700 rounded-xl flex items-center gap-2",children:[d.jsx(Ic,{className:"w-5 h-5"})," ",w]}),d.jsxs("div",{className:"flex justify-between pt-4",children:[d.jsxs("button",{onClick:()=>{r(2),R(null),_(null)},disabled:a,className:"h-11 flex items-center gap-2 px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-700 font-bold hover:bg-slate-50 transition-all shadow-sm",children:[d.jsx(Es,{className:"w-4 h-4"})," Back"]}),d.jsx("button",{onClick:oe,disabled:a,className:"btn-primary",children:a?d.jsxs(d.Fragment,{children:[d.jsx(ar,{className:"w-5 h-5 animate-spin"})," Analyzing..."]}):d.jsxs(d.Fragment,{children:[d.jsx(HX,{className:"w-4 h-4 fill-current"})," Run Analysis"]})})]})]})]});case 4:if(P)return d.jsxs("div",{className:"py-20 text-center",children:[d.jsx(ar,{className:"w-10 h-10 animate-spin mx-auto text-[#3399cc]"}),d.jsx("p",{className:"mt-4 text-slate-500",children:"Fetching modification details..."})]});const W=Ee(),J=W[o]||[],re=J.length,U=Math.ceil(re/p),L=(f-1)*p,se=J.slice(L,L+p),Q=he=>{const M=[];if(he<=7){for(let H=1;H<=he;H++)M.push(H);return M}M.push(1),f>4&&M.push("...");const A=Math.max(2,f-1),j=Math.min(he-1,f+1);for(let H=A;H<=j;H++)M.push(H);return f<he-3&&M.push("..."),M.push(he),M},ee=[{id:"additions",label:"Additions",icon:ud,variant:"emerald",count:W.additions.length},{id:"deletions",label:"Deletions",icon:XE,variant:"red",count:W.deletions.length},{id:"priceIncreases",label:"Increases",icon:Xc,variant:"amber",count:W.priceIncreases.length},{id:"priceDecreases",label:"Decreases",icon:fd,variant:"cyan",count:W.priceDecreases.length},{id:"descriptionChanges",label:"Descriptions",icon:ou,variant:"blue",count:W.descriptionChanges.length}],B=o==="descriptionChanges",be=o==="priceIncreases"||o==="priceDecreases",z=o==="additions"||o==="deletions";return d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:ee.map(he=>d.jsx(Mce,{label:he.label,value:he.count,icon:d.jsx(he.icon,{className:"w-4 h-4"}),variant:he.variant},he.id))}),d.jsxs("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden",children:[d.jsxs("div",{className:"px-6 py-5 border-b border-slate-100 flex items-center justify-between gap-4",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Analysis Results"}),d.jsxs("button",{onClick:()=>OM(O.job_id,W),className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-slate-50 text-slate-700 text-sm font-bold border border-slate-200 hover:bg-slate-100 transition-all",children:[d.jsx(Rf,{size:16})," Export All"]})]}),d.jsx("div",{className:"px-6 pt-4",children:d.jsx("div",{className:"bg-slate-100/80 p-1 rounded-2xl flex items-center w-full ",children:ee.map(he=>d.jsxs("button",{onClick:()=>{c(he.id),h(1)},className:`flex-1 flex items-center justify-center gap-2 py-2.5 rounded-xl text-sm font-bold transition-all
                         ${o===he.id?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(he.icon,{size:14,className:o===he.id?`text-${he.variant}-600`:""}),he.label]},he.id))})}),d.jsx("div",{className:"p-6",children:d.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden",children:d.jsxs("table",{className:"w-full text-sm table-fixed",children:[d.jsx("thead",{className:"bg-slate-50/50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Part Number"}),d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Product Name"}),B&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Old Description"}),d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"New Description"})]}),be&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"Old Price"}),d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"New Price"})]}),z&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Description"}),d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"Price"})]})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-100",children:[se.map((he,M)=>d.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[d.jsx("td",{className:"p-3 font-mono text-xs text-slate-500",children:he.manufacturer_part_number||"N/A"}),d.jsx("td",{className:"p-3 font-medium text-slate-900",children:he.product_name||"Unknown Product"}),B&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-xs text-slate-400 truncate max-w-60",children:he.old_description||"-"}),d.jsx("td",{className:"p-3 text-xs text-slate-700",children:he.new_description||"-"})]}),be&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-right text-slate-400 tabular-nums",children:he.old_price?`$${Number(he.old_price).toLocaleString()}`:"-"}),d.jsx("td",{className:"p-3 text-right font-bold text-slate-900 tabular-nums",children:he.new_price?`$${Number(he.new_price).toLocaleString()}`:"-"})]}),z&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-xs text-slate-700 truncate max-w-60",children:he.description||he.new_description||"-"}),d.jsx("td",{className:"p-3 text-right font-bold text-slate-900 tabular-nums",children:he.price??he.new_price?`$${Number(he.price??he.new_price).toLocaleString()}`:"-"})]})]},M)),J.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:4,className:"p-10 text-center text-slate-400 italic",children:"No modifications found for this category."})})]})]})})}),re>p&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:L+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(L+p,re)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:re})," ","results"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:f===1,onClick:()=>h(f-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Es,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:Q(U).map((he,M)=>he==="..."?d.jsx("span",{className:"min-w-9 h-9 flex items-center justify-center text-slate-400 font-bold",children:""},M):d.jsx("button",{onClick:()=>h(he),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
        ${f===he?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:he},M))}),d.jsx("button",{disabled:f===U,onClick:()=>h(f+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]}),d.jsxs("div",{className:"flex justify-between items-center pt-4",children:[d.jsx("button",{onClick:K,className:"px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-700 font-bold hover:bg-slate-50 transition-all shadow-sm",children:"Start New Analysis"}),d.jsxs("button",{onClick:()=>e(`/documents?job_id=${O.job_id}`),className:"btn-primary",children:["Generate Documents ",d.jsx(a0,{className:"w-4 h-4"})]})]})]});default:return null}};return d.jsxs("div",{className:"min-h-screen bg-slate-50/50 p-6 lg:p-10 space-y-10",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:"Price List Analysis"}),d.jsx("p",{className:"text-slate-500 font-medium",children:"Compare commercial pricelists with GSA contract data"})]}),d.jsx("div",{className:"flex items-center gap-2 p-2 rounded-2xl bg-white shadow-sm overflow-x-auto",children:Dce.map(q=>d.jsxs("div",{className:"flex items-center shrink-0",children:[d.jsxs("div",{className:`h-10 px-4 flex items-center gap-3 rounded-3xl transition-all ${t===q.id?"bg-[#3399cc] text-white shadow-lg":"text-slate-400"}`,children:[d.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border ${t===q.id?"border-white/30":"border-slate-200"}`,children:t>q.id?d.jsx(Kc,{className:"w-3 h-3"}):q.id}),d.jsx("p",{className:"text-xs font-bold uppercase tracking-widest hidden sm:block",children:q.title})]}),q.id<4&&d.jsx("div",{className:"w-4 h-px bg-slate-200 mx-1"})]},q.id))}),d.jsx("div",{className:"w-full",children:D()})]})}const Mce=({label:e,value:t,icon:r,variant:n="blue"})=>{const a={emerald:{bg:"bg-emerald-50",text:"text-emerald-600",border:"border-emerald-100",iconBg:"bg-emerald-100/50"},red:{bg:"bg-red-50",text:"text-red-600",border:"border-red-100",iconBg:"bg-red-100/50"},amber:{bg:"bg-amber-50",text:"text-amber-600",border:"border-amber-100",iconBg:"bg-amber-100/50"},cyan:{bg:"bg-cyan-50",text:"text-[#3399cc]",border:"border-cyan-100",iconBg:"bg-cyan-100/50"},blue:{bg:"bg-blue-50",text:"text-blue-600",border:"border-blue-100",iconBg:"bg-blue-100/50"}}[n];return d.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm h-full hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`w-12 h-12 rounded-2xl ${a.iconBg} flex items-center justify-center ${a.text}`,children:We.cloneElement(r,{size:20})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-2xl font-bold text-slate-900 tabular-nums leading-none",children:t.toLocaleString()}),d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mt-1.5",children:e})]})]})})},Ox=[{id:"add-product",name:"Additions",description:"Request to add new products to an existing GSA contract",icon:"Plus",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contracting Officer",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin",label:"SIN",type:"text",behavior:"editable",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"solicitationNumber",label:"Solicitation Number",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"refresh",label:"Refresh Number",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"coo",label:"Country of Origin",type:"text",behavior:"manual",section:"Request Details"},{id:"basicDiscount",label:"GSA Basic Discount",type:"text",behavior:"manual",section:"Request Details"},{id:"numberOfProductsAdded",label:"Number of Products Added",type:"number",behavior:"readonly",section:"Request Details"},{id:"quantityVolumeDiscount",label:"Quantity / Volume Discount",type:"text",behavior:"readonly",section:"Request Details"},{id:"otherDiscounts",label:"Other Discounts / Concessions",type:"text",behavior:"readonly",section:"Request Details"},{id:"additionRationale",label:"Addition Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"deliveryAroNormal",label:"Delivery ARO  Normal",type:"text",behavior:"readonly",section:"Logistics & Compliance"},{id:"deliveryAroExpedited",label:"Delivery ARO  Expedited",type:"text",behavior:"readonly",section:"Logistics & Compliance"},{id:"fobTerms",label:"FOB Terms",type:"text",behavior:"readonly",section:"Logistics & Compliance"},{id:"energyStarCompliance",label:"Energy Star Compliance",type:"select",behavior:"readonly",section:"Logistics & Compliance",options:[{value:"yes",label:"Yes"},{value:"no",label:"No"},{value:"na",label:"Not Applicable"}]}]},{id:"delete-product",name:"Deletions",description:"Request to remove products from an existing GSA contract",icon:"Trash2",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contracting Officer",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin",label:"SIN",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"numberOfProductsDeleted",label:"Number of Products Deleted",type:"number",behavior:"readonly",section:"Request Details"},{id:"deletionRationale",label:"Deletional Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]}]},{id:"price-increase",name:"Price Increase",description:"Economic Price Adjustment for price increases based on index changes",icon:"TrendingUp",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contractor Name",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin",label:"SIN",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"requestedIncrease",label:"Requested Increase (%)",type:"percentage",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"increaseRationale",label:"Increase Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"backgroundInfo",label:"Background Information",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]}]},{id:"price-decrease",name:"Price Decrease",description:"Economic Price Adjustment for price decreases based on index changes",icon:"TrendingDown",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contractor Name",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin",label:"SIN",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"requestedDecrease",label:"Requested Decrease (%)",type:"percentage",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"decreaseRationale",label:"Decrease Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]}]},{id:"description-change",name:"Description Changes",description:"Request to modify product descriptions without price changes",icon:"FileEdit",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contractor Name",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin",label:"SIN",type:"text",behavior:"editable",section:"Request Details"},{id:"descriptionChanged",label:"Number of Products Changed",type:"number",behavior:"readonly",section:"Request Details"},{id:"modificationRationale",label:"Description Change Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]}]}],Fce=e=>Ox.find(t=>t.id===e),Pce=async e=>(await zt.get(`/generate/${e}`)).data,Lce=e=>{const t=e.client||{},r=e.client_contract||{},n=e.modification_summary||{},s=r.discounts||{},a=r.delivery||{},i=r.address||r.addres||{},o=r.other||{};return{companyName:t.company_name,contractNumber:r.contract_number,contractorName:r.contract_officer_name,contractorAddress:i.contract_officer_address,contractorCity:i.contract_officer_city,contractorState:i.contract_officer_state,contractorZip:i.contract_officer_zip,gsaOfficeAddressLine:i.contract_officer_address,gsaOfficeCity:i.contract_officer_city,gsaOfficeState:i.contract_officer_state,gsaOfficeZip:i.contract_officer_zip,gsaOfficeCityStateZip:`${i.contract_officer_city||""}, ${i.contract_officer_state||""} ${i.contract_officer_zip||""}`.trim(),deliveryAroNormal:a.normal_delivery_time,deliveryAroExpedited:a.expedited_delivery_time,fobTerms:o.fob_term,coo:r.origin_country,basicDiscount:s.gsa_proposed_discount,quantityVolumeDiscount:s.q_v_discount,otherDiscounts:o.additional_concessions,energyStarCompliance:(()=>{var f;const c=(f=o.energy_star_compliance)==null?void 0:f.toLowerCase();return c==="yes"?"yes":c==="no"?"no":c==="applicable"||c==="not applicable"||c==="n/a"?"na":""})(),numberOfProductsAdded:n.products_added,numberOfProductsDeleted:n.products_deleted,descriptionChanged:n.description_changed,numberOfItemsChanged:n.description_changed,requestedIncrease:n.price_increased>0?"":void 0,requestedDecrease:n.price_decreased>0?"":void 0}},DM=ne.createContext(void 0),Bce=({children:e})=>{const{user:t}=Hi(),[r,n]=ne.useState("select-type"),[s,a]=ne.useState(null),[i,o]=ne.useState(null),[c,f]=ne.useState({}),[h,p]=ne.useState([]),[x,g]=ne.useState([]),[v,y]=ne.useState(null),w=ne.useCallback(async(O,R)=>{const V=Fce(O);if(V){o(V),a(O),n("load-config");try{let I={};const Z=R?await Pce(R):null;Z&&(console.log("Received job details:",Z),I=Lce(Z),y(Z.modification_summary)),t&&(I.consultantName=t.name,I.consultantEmail=t.email,I.consultantPhone=t.phone_no);const ce={};V.fields.forEach(F=>{I[F.id]!==void 0?ce[F.id]=I[F.id]:F.defaultValue!==void 0&&(ce[F.id]=F.defaultValue)}),console.log("Final initialData to set:",ce),f(ce)}catch(I){console.error("Prefill failed:",I),f({})}}},[t]),_=ne.useCallback((O,R)=>{f(V=>({...V,[O]:R})),p(V=>V.filter(I=>I.fieldId!==O))},[]),S=ne.useCallback(()=>{if(!i)return!1;const O=[];return i.fields.forEach(R=>{var I;const V=c[R.id];(I=R.validation)==null||I.forEach(Z=>{switch(Z.type){case"required":(!V||typeof V=="string"&&V.trim()==="")&&O.push({fieldId:R.id,message:Z.message});break;case"email":V&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(V))&&O.push({fieldId:R.id,message:Z.message});break;case"phone":V&&!/^[\d\s\-\(\)\+]+$/.test(String(V))&&O.push({fieldId:R.id,message:Z.message});break}})}),p(O),O.length===0},[i,c]),E=ne.useCallback(()=>{n("select-type"),a(null),o(null),f({}),p([]),y(null)},[]),N=ne.useCallback(()=>{const O=`DOC-${Date.now().toString(36).toUpperCase()}`,R=x.filter(V=>V.documentType===s).length;return{id:O,documentType:(i==null?void 0:i.name)||"",version:`v1.${R}`,generatedBy:(t==null?void 0:t.name)||"Unknown User",generatedAt:new Date().toISOString(),data:{...c}}},[i,x,c,s,t]),k=ne.useCallback(O=>{g(R=>[O,...R])},[]);return d.jsx(DM.Provider,{value:{currentStep:r,setCurrentStep:n,selectedDocumentType:s,setSelectedDocumentType:a,documentConfig:i,formData:c,setFormData:f,updateField:_,validationErrors:h,setValidationErrors:p,validateForm:S,documentHistory:x,addToHistory:k,loadDocumentConfig:w,resetWorkflow:E,generateDocument:N,analysisSummary:v},children:e})},C1=()=>{const e=ne.useContext(DM);if(!e)throw new Error("useDocument must be used within a DocumentProvider");return e},Uce={Plus:ud,Trash2:dD,TrendingUp:Xc,TrendingDown:fd,FileEdit:ou},zce=({config:e,isSelected:t,onSelect:r,variant:n="grid"})=>{const s=Uce[e.icon]||ou;return n==="horizontal"?d.jsxs("div",{onClick:r,className:`
          group cursor-pointer transition-all duration-300
          px-6 py-4 rounded-2xl relative overflow-hidden flex items-center gap-4 shrink-0
          ${t?"bg-white shadow-md border-2 border-[#24548f] scale-[1.02]":"bg-white/50 backdrop-blur-sm shadow-sm border border-slate-200 hover:shadow-md hover:border-[#24548f]/40 hover:scale-[1.01]"}
        `,children:[d.jsx("div",{className:`
            w-10 h-10 rounded-xl flex items-center justify-center shrink-0
            transition-all duration-300
            ${t?"bg-[#24548f] shadow-lg shadow-[#24548f]/25":"bg-slate-50 border border-slate-200 group-hover:bg-[#24548f]/10"}
          `,children:d.jsx(s,{className:`w-5 h-5 transition-all duration-300 ${t?"scale-110":"group-hover:scale-110"}`,style:{color:t?"#ffffff":"#24548f"},strokeWidth:2.5})}),d.jsx("div",{className:"flex-1 min-w-0",children:d.jsx("h3",{className:"font-bold text-sm text-slate-900 tracking-tight truncate",children:e.name})}),t&&d.jsx("div",{className:"absolute top-2 right-2 w-1.5 h-1.5 rounded-full bg-[#24548f] animate-pulse"})]}):d.jsxs("div",{onClick:r,className:`
        group cursor-pointer transition-all duration-300
        p-8 rounded-[24px] relative overflow-hidden
        ${t?"bg-white shadow-xl border-2 border-[#24548f] scale-[1.02]":"bg-white/80 backdrop-blur-sm shadow-sm border border-slate-200 hover:shadow-lg hover:border-[#24548f]/40 hover:scale-[1.01]"}
      `,children:[t&&d.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#24548f]/5 via-transparent to-transparent pointer-events-none"}),d.jsxs("div",{className:"flex items-start gap-6 relative z-10",children:[d.jsx("div",{className:`
            w-14 h-14 rounded-2xl flex items-center justify-center shrink-0
            transition-all duration-300
            ${t?"bg-[#24548f] shadow-lg shadow-[#24548f]/25":"bg-slate-50 border border-slate-200 group-hover:bg-[#24548f]/10 group-hover:border-[#24548f]/30"}
          `,children:d.jsx(s,{className:`w-6 h-6 transition-all duration-300 ${t?"scale-110":"group-hover:scale-110"}`,style:{color:t?"#ffffff":"#24548f"},strokeWidth:2.5})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex items-center justify-between gap-3 mb-2",children:[d.jsx("h3",{className:"font-bold text-lg text-slate-900 tracking-tight",children:e.name}),d.jsx(Mr,{className:`w-5 h-5 transition-all duration-300 shrink-0 ${t?"text-[#24548f] translate-x-1":"text-slate-300 group-hover:text-[#24548f] group-hover:translate-x-1"}`})]}),d.jsx("p",{className:"text-sm text-slate-500 font-medium leading-relaxed",children:e.description})]})]}),t&&d.jsx("div",{className:"absolute top-4 right-4 w-2 h-2 rounded-full bg-[#24548f] animate-pulse"})]})};function Hce(){var _;const{documentConfig:e,formData:t,updateField:r,validateForm:n,setCurrentStep:s,validationErrors:a}=C1(),[i,o]=ne.useState(""),c={muted:"#627383",border:"#d9e0e8",destructive:"#df3a3a",secondaryBg:"#f8fafc"},f=`
    w-full mt-2 px-4 py-3 rounded-xl border transition-all text-sm font-medium
    focus:outline-none focus:ring-4 focus:ring-[#24548f]/5 focus:border-[#24548f]
    placeholder:text-slate-400
  `,h=`
    w-full mt-2 px-4 py-3 rounded-xl border bg-[#f8fafc] text-[#627383] 
    cursor-not-allowed border-[#d9e0e8] font-medium text-sm
  `,p=ne.useMemo(()=>e!=null&&e.fields?e.fields.reduce((S,E)=>{const N=E.section||"General Information";return S[N]||(S[N]=[]),S[N].push(E),S},{}):{},[e]),x=ne.useMemo(()=>Object.keys(p),[p]);ne.useEffect(()=>{x.length>0&&!i&&o(x[0])},[x,i]);const g=()=>{n()&&s("preview")},v=S=>{var N;const E=((N=p[S])==null?void 0:N.map(k=>k.id))||[];return a.some(k=>E.includes(k.fieldId))};if(!e)return d.jsx("div",{className:"min-h-[400px] flex items-center justify-center text-slate-500 font-bold",children:"Please select a document type first."});const y=S=>{switch(S){case"number":case"email":case"password":case"date":return S;default:return"text"}},w=x.indexOf(i);return d.jsxs("div",{className:"animate-fade-in  mx-auto",children:[d.jsx("div",{className:"flex flex-wrap gap-2 mb-6 border-b border-slate-200",children:x.map(S=>{const E=i===S,N=v(S);return d.jsxs("button",{onClick:()=>o(S),className:`px-6 py-4 text-xs font-bold uppercase tracking-widest transition-all border-b-2 relative ${E?"border-[#24548f] text-[#24548f]":"border-transparent text-slate-400 hover:text-slate-600"}`,children:[S,N&&d.jsxs("span",{className:"absolute top-3 right-2 flex h-2 w-2",children:[d.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),d.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-red-500"})]})]},S)})}),d.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden min-h-[400px] animate-slide-up",children:d.jsx("div",{className:"p-8 flex flex-wrap -mx-4 gap-y-6",children:(_=p[i])==null?void 0:_.map(S=>{var O;const E=S.behavior==="readonly",N=a.some(R=>R.fieldId===S.id),k=S.width||(S.type==="textarea"?"w-full":"w-full md:w-1/2");return d.jsxs("div",{className:`${k} px-4`,children:[d.jsxs("label",{className:"text-[11px] font-black uppercase tracking-widest ml-1",style:{color:c.muted},children:[S.required&&d.jsx("span",{className:"text-red-500 mr-1",children:"*"}),S.label]}),S.type==="textarea"?d.jsx("textarea",{value:t[S.id]||"",onChange:R=>r(S.id,R.target.value),disabled:E,placeholder:S.placeholder,className:`${E?h:f} min-h-[120px] resize-none`,style:{borderColor:N?c.destructive:c.border,backgroundColor:E?c.secondaryBg:"white"}}):S.type==="select"?d.jsxs("div",{className:"relative",children:[d.jsxs("select",{value:t[S.id]||"",onChange:R=>r(S.id,R.target.value),disabled:E,className:`${E?h:f} appearance-none pr-8`,style:{borderColor:N?c.destructive:c.border,backgroundColor:E?c.secondaryBg:"white"},children:[d.jsxs("option",{value:"",disabled:!0,children:["Select ",S.label]}),(O=S.options)==null?void 0:O.map(R=>d.jsx("option",{value:R.value,children:R.label},R.value))]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:d.jsx(Mr,{className:"w-4 h-4 text-gray-400 rotate-90"})})]}):d.jsx("input",{type:y(S.type),value:t[S.id]||"",onChange:R=>r(S.id,R.target.value),disabled:E,placeholder:S.placeholder,className:E?h:f,style:{borderColor:N?c.destructive:c.border,backgroundColor:E?c.secondaryBg:"white"}}),N&&d.jsxs("div",{className:"flex items-center gap-1 mt-1.5 ml-1 text-red-600",children:[d.jsx(Ic,{className:"w-3 h-3"}),d.jsx("p",{className:"text-[10px] font-bold",children:"This field is required"})]})]},S.id)})})}),d.jsxs("div",{className:"mt-8 flex items-center justify-between pb-10",children:[d.jsxs("button",{onClick:()=>w>0?o(x[w-1]):s("select-type"),className:"flex items-center gap-2 px-6 py-3 rounded-xl font-bold text-sm text-slate-600 hover:bg-slate-100 transition-colors",children:[d.jsx(Es,{className:"w-4 h-4"}),w===0?"Back":"Previous Section"]}),w===x.length-1?d.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-8 py-3 bg-[#24548f] text-white rounded-xl font-bold text-sm hover:bg-[#1a3e6b] transition-all shadow-lg shadow-blue-900/10",children:["Review & Continue",d.jsx(Mr,{className:"w-4 h-4",strokeWidth:3})]}):d.jsxs("button",{onClick:()=>o(x[w+1]),className:"flex items-center gap-2 px-8 py-3 bg-white border border-slate-200 text-[#24548f] rounded-xl font-bold text-sm hover:bg-slate-50 transition-all",children:["Next Section",d.jsx(Mr,{className:"w-4 h-4"})]})]})]})}const IM=e=>{switch(e){case"addition":case"add-product":case"add-product-modification":return"addition";case"deletion":case"delete-product":return"deletion";case"price-increase":return"price-increase";case"price-decrease":return"price-decrease";case"description-change":return"description-change";default:return console.error("No template mapped for documentId:",e),null}},MM=({data:e})=>d.jsxs("div",{className:"relative text-[14px] leading-[1.6] text-foreground px-12 py-10",style:{fontFamily:"'Times New Roman', Times, serif"},children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-[120px]"})}),d.jsx("p",{className:"mb-6",children:e.submissionDate}),d.jsxs("p",{className:"mb-6",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-6",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["Add Product Modification to GSA Contract ",d.jsx("strong",{children:e.contractNumber})]})]})}),d.jsxs("p",{className:"mb-4",children:["Dear ",e.salutation," ",e.contractorName]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of an Add Product Modification to GSA Schedule Contract ",d.jsx("strong",{children:e.contractNumber}),"."," ",d.jsx("strong",{children:e.companyName}),"requests to add ",d.jsx("strong",{children:e.numberOfProductsAdded})," products under SIN(s)"," ",d.jsx("strong",{children:e.sin}),". These products are being added because"," ",d.jsx("strong",{children:e.additionRationale}),"."]}),d.jsxs("ul",{className:"list-disc ml-6 mb-4 space-y-1",children:[d.jsxs("li",{children:["We certify that these products are TAA Compliant in accordance with 52.225-6 Trade Agreements Certificate (May 2014). Country of Origin:",d.jsx("strong",{children:` ${e.coo}`}),"."]}),d.jsxs("li",{children:["GSA Basic Discount: ",d.jsx("strong",{children:e.basicDiscount})," %"]}),d.jsxs("li",{children:["Number of products added: ",d.jsx("strong",{children:e.numberOfProductsAdded||"0"})]}),d.jsxs("li",{children:["Quantity / Volume Discount:"," ",d.jsx("strong",{children:e.quantityVolumeDiscount||"None"})]}),d.jsxs("li",{children:["Other Discounts / Concessions: ",d.jsx("strong",{children:e.otherDiscounts||""})]}),d.jsxs("li",{children:["Delivery After Receipt of Order (ARO):",d.jsxs("ul",{className:"list-disc ml-6",children:[d.jsxs("li",{children:["Normal: ",d.jsx("strong",{children:e.deliveryAroNormal})]}),d.jsxs("li",{children:["Expedited: ",d.jsx("strong",{children:e.deliveryAroExpedited})]})]})]}),d.jsxs("li",{children:["FOB Terms: ",d.jsx("strong",{children:e.fobTerms})]}),d.jsx("li",{children:"There have been (no) changes to our Commercial Sales Practices."}),d.jsxs("li",{children:["Energy Star Compliance:"," ",e.energyStarCompliance==="yes"?d.jsx("strong",{children:"Yes"}):e.energyStarCompliance==="no"?d.jsx("strong",{children:"No"}):e.energyStarCompliance==="na"?d.jsx("strong",{children:"Not Applicable"}):""]}),d.jsxs("li",{children:["This modification is submitted under Solicitation",d.jsx("strong",{children:` ${e.solicitationNumber}`})," Refresh ",d.jsx("strong",{children:e.refresh}),"."]}),d.jsx("li",{children:"Items added are not identical or substantially similar to previously deleted items with lower Schedule pricing."}),d.jsx("li",{children:"No hazardous materials will be delivered under this contract."}),d.jsx("li",{children:"Place of Performance per FAR 52.215-6 (see current Solicitation)."}),d.jsx("li",{children:"If applicable, EPA method and mechanism are unchanged or proposed herein."})]}),d.jsx("p",{className:"mb-4",children:"I certify that the information provided is current, complete, and accurate. All other terms and conditions of the contract remain unchanged."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",d.jsx("strong",{children:e.consultantName})," at The Winvale Group at ",d.jsx("strong",{children:e.consultantPhone})," or"," ",d.jsx("strong",{children:e.consultantEmail}),"."]}),d.jsx("p",{className:"mb-16",children:"Sincerely,"}),d.jsxs("div",{children:[d.jsx("p",{children:d.jsx("strong",{children:e.contractorName})}),d.jsx("p",{children:d.jsxs("strong",{children:[e.authorizedNegotiatorTitle||"Director of Contracts","  Authorized to sign on behalf of ",e.companyName||"COMPANY NAME"]})})]})]}),FM=({data:e})=>d.jsxs("div",{className:"relative text-[14px] leading-[1.6] text-foreground px-12 py-10",style:{fontFamily:"'Times New Roman', Times, serif"},children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-35 object-contain"})}),d.jsx("p",{className:"mb-6",children:e.submissionDate||"DATE"}),d.jsxs("p",{className:"mb-6",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-6",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["Deletion Modification to GSA Contract ",d.jsx("strong",{children:e.contractNumber})]})]})}),d.jsxs("p",{className:"mb-4",children:["Dear ",e.salutation," ",e.contractorName]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of a Deletion Modification to GSA Schedule Contract ",d.jsx("strong",{children:e.contractNumber}),". The modification consists of the deletion of"," ",d.jsx("strong",{children:e.numberOfProductsDeleted})," item(s) listed under SIN"," ",d.jsx("strong",{children:e.sin}),". These products are being removed because ",d.jsx("strong",{children:e.deletionRationale}),"."]}),d.jsxs("p",{className:"mb-1",children:[e.companyName," states the following:"]}),d.jsx("ol",{className:"list-[lower-alpha] ml-10 mb-4 space-y-1",children:d.jsx("li",{children:"The items being deleted will not be added at a later date with a higher price without justification for such higher price."})}),d.jsx("p",{className:"mb-4",children:"I certify to the best of my knowledge that the information provided is current, complete, and accurate. All other terms and conditions of the contract remain unchanged."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",e.consultantName," of The Winvale Group at"," ",e.consultantPhone," or ",e.consultantEmail,"."]}),d.jsx("p",{className:"mb-16",children:"Sincerely,"}),d.jsxs("div",{children:[d.jsx("p",{children:d.jsx("strong",{children:e.contractorName})}),d.jsx("p",{children:d.jsxs("strong",{children:[e.authorizedNegotiatorTitle||"Director of Contracts","  Authorized to sign on behalf of ",e.companyName||"COMPANY NAME"]})})]})]}),Vce=({data:e})=>d.jsxs("div",{className:"relative text-[13px] leading-[1.6] text-foreground px-8 py-6",children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-35 object-contain"})}),d.jsx("p",{className:"mb-4",children:e.submissionDate}),d.jsxs("p",{className:"mb-4",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-4",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["Product Descriptive Change Modification to GSA Contract"," ",d.jsx("strong",{children:e.contractNumber})]})]})}),d.jsxs("p",{className:"mb-3",children:["Dear ",e.salutation," ",e.contractorName]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of a product descriptive modification to GSA Schedule Contract ",d.jsx("strong",{children:e.contractNumber})," ","under SIN ",d.jsx("strong",{children:e.sin}),". The modification consists of descriptive changes for"," ",d.jsx("strong",{children:e.descriptionChanged})," item(s) due to"," ",d.jsx("strong",{children:e.modificationRationale}),". These revisions will not result in any changes to the GSA price."]}),d.jsx("p",{className:"mb-4",children:"I certify to the best of my knowledge that the information provided is current, complete, and accurate. All other terms and conditions of the contract remain unchanged."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",d.jsx("strong",{children:e.consultantName})," at ",d.jsx("strong",{children:e.consultantPhone})," or ",d.jsx("strong",{children:e.consultantEmail}),"."]}),d.jsx("p",{className:"mb-16",children:"Respectfully,"}),d.jsxs("div",{children:[d.jsx("p",{children:d.jsx("strong",{children:e.contractorName})}),d.jsx("p",{children:d.jsxs("strong",{children:[e.authorizedNegotiatorTitle||"Director of Contracts","  Authorized to sign on behalf of ",e.companyName||"COMPANY NAME"]})})]})]}),PM=({data:e})=>d.jsxs("div",{className:"relative text-[14px] leading-[1.6] text-foreground px-12 py-10",style:{fontFamily:"'Times New Roman', Times, serif"},children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-35 object-contain"})}),d.jsx("p",{className:"mb-6",children:e.submissionDate}),d.jsxs("p",{className:"mb-6",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-6",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["EPA Modification Based on a Commercial Price List to GSA Contract"," ",d.jsx("strong",{children:e.contractNumber})]})]})}),d.jsxs("p",{className:"mb-4",children:["Dear ",e.salutation," ",e.contractorName]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of an Economic Price Adjustment (EPA) increase based on a Commercial Price List to GSA Schedule Contract ",d.jsx("strong",{children:e.contractNumber})," under SIN ",d.jsx("strong",{children:e.sin}),". This request is submitted in accordance with EPA Clause GSAM 538.270-4(a)(3). The proposed modification consists of a price increase of"," ",d.jsxs("strong",{children:[e.requestedIncrease||e.priceIncreasePercent,"%"]})," for"," ",d.jsx("strong",{children:e.numberOfItemsAffected})," item(s) due to"," ",d.jsx("strong",{children:e.increaseRationale}),"."]}),d.jsxs("ul",{className:"list-[lower-alpha] ml-10 mb-4 space-y-2",children:[d.jsx("li",{children:e.backgroundInfo||"[Background information regarding your current prices, the applicable wage determination price levels (if applicable), and the increases necessary for your company.]"}),d.jsx("li",{children:e.justification||"The requested EPA is calculated in accordance with the contractually approved EPA clause and methodology. The increase does not exceed the contract ceiling, and all required supporting documentation has been provided within eMod."}),d.jsxs("li",{children:[e.companyName," acknowledges that the proposed price increase will not become effective until the Contracting Officer executes the completed modification."]}),d.jsx("li",{children:"All prices offered to GSA include the current Industrial Funding Fee (IFF)."}),d.jsx("li",{children:e.cspStatement||"For non-TDR contracts only: Commercial Sales Practices (CSP) information previously submitted remains accurate and unchanged. If CSP information has changed, an updated CSP-1 has been provided with this modification."})]}),d.jsx("p",{className:"mb-4",children:"I certify to the best of my knowledge that the information I provided is current, complete and accurate. All other terms and conditions remain the same."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",e.consultantName," at The Winvale Group at ",e.consultantPhone," or"," ",e.consultantEmail,"."]}),d.jsx("p",{className:"mb-16",children:"Sincerely,"}),d.jsxs("div",{children:[d.jsx("p",{children:d.jsx("strong",{children:e.contractorName})}),d.jsx("p",{children:d.jsxs("strong",{children:[e.authorizedNegotiatorTitle||"[Title]","  Authorized to sign on behalf of ",e.companyName||"[Company Name]"]})})]})]}),qce=({data:e})=>d.jsxs("div",{className:"relative text-[14px] leading-[1.6] text-foreground px-12 py-10",style:{fontFamily:"'Times New Roman', Times, serif"},children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-35 object-contain"})}),d.jsx("p",{className:"mb-6",children:e.submissionDate}),d.jsxs("p",{className:"mb-6",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-6",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["Price Reduction Modification Based on a Commercial Price List to GSA Contract ",e.contractNumber]})]})}),d.jsxs("p",{className:"mb-4",children:["Dear ",e.salutation," ",e.contractorName,","]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of a price reduction modification based on a Commercial Price List to GSA Schedule Contract ",d.jsx("strong",{children:e.contractNumber})," under SIN"," ",d.jsx("strong",{children:e.sin}),". This request is submitted in accordance with EPA Clause GSAM 538.270-4(a)(3). The proposed modification consists of a price decrease of ",d.jsxs("strong",{children:[e.priceDecreasePercent,"%"]})," for"," ",d.jsx("strong",{children:e.numberOfItemsAffected})," item(s) due to"," ",d.jsx("strong",{children:e.decreaseRationale}),"."]}),d.jsxs("ul",{className:"list-disc ml-10 mb-4 space-y-2",children:[d.jsxs("li",{children:[e.companyName," acknowledges that this proposed price decrease will go into effect immediately, as of the date of submission."]}),d.jsx("li",{children:"All prices offered to GSA include the current Industrial Funding Fee (IFF)."}),d.jsx("li",{children:e.cspStatement||"For non-TDR contracts only: Commercial Sales Practices (CSP) information previously submitted in accordance with GSAR 552.238-81 Price Reductions remains accurate and unchanged. If CSP information has changed, an updated CSP-1 has been provided within eMod."})]}),d.jsx("p",{className:"mb-4",children:"I certify to the best of my knowledge that the information I provided is current, complete, and accurate. All other terms and conditions remain the same."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",e.consultantName," at The Winvale Group at"," ",e.consultantPhone," or ",e.consultantEmail,"."]}),d.jsx("p",{className:"mb-16",children:"Sincerely,"}),d.jsxs("div",{children:[d.jsx("p",{children:d.jsx("strong",{children:e.contractorName})}),d.jsx("p",{children:d.jsxs("strong",{children:[e.authorizedNegotiatorTitle||"[Title]","  Authorized to sign on behalf of ",e.companyName||"[Company Name]"]})})]})]}),Wce=({documentId:e,data:t})=>{const r=IM(e);return d.jsx("div",{id:"document-export-root",className:"bg-white text-black w-full",children:(()=>{switch(r){case"addition":return d.jsx(MM,{data:t});case"deletion":return d.jsx(FM,{data:t});case"description-change":return d.jsx(Vce,{data:t});case"price-increase":return d.jsx(PM,{data:t});case"price-decrease":return d.jsx(qce,{data:t});default:return null}})()})};var Lb={exports:{}},Bb={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M5;function $ce(){if(M5)return Bb;M5=1;var e=I0();function t(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,s=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function o(p,x){var g=x(),v=n({inst:{value:g,getSnapshot:x}}),y=v[0].inst,w=v[1];return a(function(){y.value=g,y.getSnapshot=x,c(y)&&w({inst:y})},[p,g,x]),s(function(){return c(y)&&w({inst:y}),p(function(){c(y)&&w({inst:y})})},[p]),i(g),g}function c(p){var x=p.getSnapshot;p=p.value;try{var g=x();return!r(p,g)}catch{return!0}}function f(p,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:o;return Bb.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,Bb}var F5;function LM(){return F5||(F5=1,Lb.exports=$ce()),Lb.exports}var BM=LM();function Wn(e){this.content=e}Wn.prototype={constructor:Wn,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,r){var n=r&&r!=e?this.remove(r):this,s=n.find(e),a=n.content.slice();return s==-1?a.push(r||e,t):(a[s+1]=t,r&&(a[s]=r)),new Wn(a)},remove:function(e){var t=this.find(e);if(t==-1)return this;var r=this.content.slice();return r.splice(t,2),new Wn(r)},addToStart:function(e,t){return new Wn([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var r=this.remove(e).content.slice();return r.push(e,t),new Wn(r)},addBefore:function(e,t,r){var n=this.remove(t),s=n.content.slice(),a=n.find(e);return s.splice(a==-1?s.length:a,0,t,r),new Wn(s)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=Wn.from(e),e.size?new Wn(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=Wn.from(e),e.size?new Wn(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Wn.from(e);for(var r=0;r<e.content.length;r+=2)t=t.remove(e.content[r]);return t},toObject:function(){var e={};return this.forEach(function(t,r){e[t]=r}),e},get size(){return this.content.length>>1}};Wn.from=function(e){if(e instanceof Wn)return e;var t=[];if(e)for(var r in e)t.push(r,e[r]);return new Wn(t)};function UM(e,t,r){for(let n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:r;let s=e.child(n),a=t.child(n);if(s==a){r+=s.nodeSize;continue}if(!s.sameMarkup(a))return r;if(s.isText&&s.text!=a.text){for(let i=0;s.text[i]==a.text[i];i++)r++;return r}if(s.content.size||a.content.size){let i=UM(s.content,a.content,r+1);if(i!=null)return i}r+=s.nodeSize}}function zM(e,t,r,n){for(let s=e.childCount,a=t.childCount;;){if(s==0||a==0)return s==a?null:{a:r,b:n};let i=e.child(--s),o=t.child(--a),c=i.nodeSize;if(i==o){r-=c,n-=c;continue}if(!i.sameMarkup(o))return{a:r,b:n};if(i.isText&&i.text!=o.text){let f=0,h=Math.min(i.text.length,o.text.length);for(;f<h&&i.text[i.text.length-f-1]==o.text[o.text.length-f-1];)f++,r--,n--;return{a:r,b:n}}if(i.content.size||o.content.size){let f=zM(i.content,o.content,r-1,n-1);if(f)return f}r-=c,n-=c}}class Ge{constructor(t,r){if(this.content=t,this.size=r||0,r==null)for(let n=0;n<t.length;n++)this.size+=t[n].nodeSize}nodesBetween(t,r,n,s=0,a){for(let i=0,o=0;o<r;i++){let c=this.content[i],f=o+c.nodeSize;if(f>t&&n(c,s+o,a||null,i)!==!1&&c.content.size){let h=o+1;c.nodesBetween(Math.max(0,t-h),Math.min(c.content.size,r-h),n,s+h)}o=f}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,r,n,s){let a="",i=!0;return this.nodesBetween(t,r,(o,c)=>{let f=o.isText?o.text.slice(Math.max(t,c)-c,r-c):o.isLeaf?s?typeof s=="function"?s(o):s:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&f||o.isTextblock)&&n&&(i?i=!1:a+=n),a+=f},0),a}append(t){if(!t.size)return this;if(!this.size)return t;let r=this.lastChild,n=t.firstChild,s=this.content.slice(),a=0;for(r.isText&&r.sameMarkup(n)&&(s[s.length-1]=r.withText(r.text+n.text),a=1);a<t.content.length;a++)s.push(t.content[a]);return new Ge(s,this.size+t.size)}cut(t,r=this.size){if(t==0&&r==this.size)return this;let n=[],s=0;if(r>t)for(let a=0,i=0;i<r;a++){let o=this.content[a],c=i+o.nodeSize;c>t&&((i<t||c>r)&&(o.isText?o=o.cut(Math.max(0,t-i),Math.min(o.text.length,r-i)):o=o.cut(Math.max(0,t-i-1),Math.min(o.content.size,r-i-1))),n.push(o),s+=o.nodeSize),i=c}return new Ge(n,s)}cutByIndex(t,r){return t==r?Ge.empty:t==0&&r==this.content.length?this:new Ge(this.content.slice(t,r))}replaceChild(t,r){let n=this.content[t];if(n==r)return this;let s=this.content.slice(),a=this.size+r.nodeSize-n.nodeSize;return s[t]=r,new Ge(s,a)}addToStart(t){return new Ge([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new Ge(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(t.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let r=this.content[t];if(!r)throw new RangeError("Index "+t+" out of range for "+this);return r}maybeChild(t){return this.content[t]||null}forEach(t){for(let r=0,n=0;r<this.content.length;r++){let s=this.content[r];t(s,n,r),n+=s.nodeSize}}findDiffStart(t,r=0){return UM(this,t,r)}findDiffEnd(t,r=this.size,n=t.size){return zM(this,t,r,n)}findIndex(t){if(t==0)return Ym(0,t);if(t==this.size)return Ym(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,n=0;;r++){let s=this.child(r),a=n+s.nodeSize;if(a>=t)return a==t?Ym(r+1,a):Ym(r,n);n=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,r){if(!r)return Ge.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ge(r.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return Ge.empty;let r,n=0;for(let s=0;s<t.length;s++){let a=t[s];n+=a.nodeSize,s&&a.isText&&t[s-1].sameMarkup(a)?(r||(r=t.slice(0,s)),r[r.length-1]=a.withText(r[r.length-1].text+a.text)):r&&r.push(a)}return new Ge(r||t,n)}static from(t){if(!t)return Ge.empty;if(t instanceof Ge)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Ge([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ge.empty=new Ge([],0);const Ub={index:0,offset:0};function Ym(e,t){return Ub.index=e,Ub.offset=t,Ub}function ug(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;let r=Array.isArray(e);if(Array.isArray(t)!=r)return!1;if(r){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!ug(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!ug(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}let xr=class P_{constructor(t,r){this.type=t,this.attrs=r}addToSet(t){let r,n=!1;for(let s=0;s<t.length;s++){let a=t[s];if(this.eq(a))return t;if(this.type.excludes(a.type))r||(r=t.slice(0,s));else{if(a.type.excludes(this.type))return t;!n&&a.type.rank>this.type.rank&&(r||(r=t.slice(0,s)),r.push(this),n=!0),r&&r.push(a)}}return r||(r=t.slice()),n||r.push(this),r}removeFromSet(t){for(let r=0;r<t.length;r++)if(this.eq(t[r]))return t.slice(0,r).concat(t.slice(r+1));return t}isInSet(t){for(let r=0;r<t.length;r++)if(this.eq(t[r]))return!0;return!1}eq(t){return this==t||this.type==t.type&&ug(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let r in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=t.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let s=n.create(r.attrs);return n.checkAttrs(s.attrs),s}static sameSet(t,r){if(t==r)return!0;if(t.length!=r.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].eq(r[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return P_.none;if(t instanceof P_)return[t];let r=t.slice();return r.sort((n,s)=>n.type.rank-s.type.rank),r}};xr.none=[];class fg extends Error{}class it{constructor(t,r,n){this.content=t,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,r){let n=VM(this.content,t+this.openStart,r);return n&&new it(n,this.openStart,this.openEnd)}removeBetween(t,r){return new it(HM(this.content,t+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,r){if(!r)return it.empty;let n=r.openStart||0,s=r.openEnd||0;if(typeof n!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new it(Ge.fromJSON(t,r.content),n,s)}static maxOpen(t,r=!0){let n=0,s=0;for(let a=t.firstChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.firstChild)n++;for(let a=t.lastChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.lastChild)s++;return new it(t,n,s)}}it.empty=new it(Ge.empty,0,0);function HM(e,t,r){let{index:n,offset:s}=e.findIndex(t),a=e.maybeChild(n),{index:i,offset:o}=e.findIndex(r);if(s==t||a.isText){if(o!=r&&!e.child(i).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(r))}if(n!=i)throw new RangeError("Removing non-flat range");return e.replaceChild(n,a.copy(HM(a.content,t-s-1,r-s-1)))}function VM(e,t,r,n){let{index:s,offset:a}=e.findIndex(t),i=e.maybeChild(s);if(a==t||i.isText)return n&&!n.canReplace(s,s,r)?null:e.cut(0,t).append(r).append(e.cut(t));let o=VM(i.content,t-a-1,r,i);return o&&e.replaceChild(s,i.copy(o))}function Gce(e,t,r){if(r.openStart>e.depth)throw new fg("Inserted content deeper than insertion position");if(e.depth-r.openStart!=t.depth-r.openEnd)throw new fg("Inconsistent open depths");return qM(e,t,r,0)}function qM(e,t,r,n){let s=e.index(n),a=e.node(n);if(s==t.index(n)&&n<e.depth-r.openStart){let i=qM(e,t,r,n+1);return a.copy(a.content.replaceChild(s,i))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&e.depth==n&&t.depth==n){let i=e.parent,o=i.content;return Uc(i,o.cut(0,e.parentOffset).append(r.content).append(o.cut(t.parentOffset)))}else{let{start:i,end:o}=Kce(r,e);return Uc(a,$M(e,i,o,t,n))}else return Uc(a,dg(e,t,n))}function WM(e,t){if(!t.type.compatibleContent(e.type))throw new fg("Cannot join "+t.type.name+" onto "+e.type.name)}function L_(e,t,r){let n=e.node(r);return WM(n,t.node(r)),n}function Bc(e,t){let r=t.length-1;r>=0&&e.isText&&e.sameMarkup(t[r])?t[r]=e.withText(t[r].text+e.text):t.push(e)}function Wh(e,t,r,n){let s=(t||e).node(r),a=0,i=t?t.index(r):s.childCount;e&&(a=e.index(r),e.depth>r?a++:e.textOffset&&(Bc(e.nodeAfter,n),a++));for(let o=a;o<i;o++)Bc(s.child(o),n);t&&t.depth==r&&t.textOffset&&Bc(t.nodeBefore,n)}function Uc(e,t){return e.type.checkContent(t),e.copy(t)}function $M(e,t,r,n,s){let a=e.depth>s&&L_(e,t,s+1),i=n.depth>s&&L_(r,n,s+1),o=[];return Wh(null,e,s,o),a&&i&&t.index(s)==r.index(s)?(WM(a,i),Bc(Uc(a,$M(e,t,r,n,s+1)),o)):(a&&Bc(Uc(a,dg(e,t,s+1)),o),Wh(t,r,s,o),i&&Bc(Uc(i,dg(r,n,s+1)),o)),Wh(n,null,s,o),new Ge(o)}function dg(e,t,r){let n=[];if(Wh(null,e,r,n),e.depth>r){let s=L_(e,t,r+1);Bc(Uc(s,dg(e,t,r+1)),n)}return Wh(t,null,r,n),new Ge(n)}function Kce(e,t){let r=t.depth-e.openStart,s=t.node(r).copy(e.content);for(let a=r-1;a>=0;a--)s=t.node(a).copy(Ge.from(s));return{start:s.resolveNoCache(e.openStart+r),end:s.resolveNoCache(s.content.size-e.openEnd-r)}}class E0{constructor(t,r,n){this.pos=t,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,r=this.index(this.depth);if(r==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],s=t.child(r);return n?t.child(r).cut(n):s}get nodeBefore(){let t=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(t).cut(0,r):t==0?null:this.parent.child(t-1)}posAtIndex(t,r){r=this.resolveDepth(r);let n=this.path[r*3],s=r==0?0:this.path[r*3-1]+1;for(let a=0;a<t;a++)s+=n.child(a).nodeSize;return s}marks(){let t=this.parent,r=this.index();if(t.content.size==0)return xr.none;if(this.textOffset)return t.child(r).marks;let n=t.maybeChild(r-1),s=t.maybeChild(r);if(!n){let o=n;n=s,s=o}let a=n.marks;for(var i=0;i<a.length;i++)a[i].type.spec.inclusive===!1&&(!s||!a[i].isInSet(s.marks))&&(a=a[i--].removeFromSet(a));return a}marksAcross(t){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,s=t.parent.maybeChild(t.index());for(var a=0;a<n.length;a++)n[a].type.spec.inclusive===!1&&(!s||!n[a].isInSet(s.marks))&&(n=n[a--].removeFromSet(n));return n}sharedDepth(t){for(let r=this.depth;r>0;r--)if(this.start(r)<=t&&this.end(r)>=t)return r;return 0}blockRange(t=this,r){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!r||r(this.node(n))))return new hg(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let r=1;r<=this.depth;r++)t+=(t?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return t+":"+this.parentOffset}static resolve(t,r){if(!(r>=0&&r<=t.content.size))throw new RangeError("Position "+r+" out of range");let n=[],s=0,a=r;for(let i=t;;){let{index:o,offset:c}=i.content.findIndex(a),f=a-c;if(n.push(i,o,s+c),!f||(i=i.child(o),i.isText))break;a=f-1,s+=c+1}return new E0(r,n,a)}static resolveCached(t,r){let n=P5.get(t);if(n)for(let a=0;a<n.elts.length;a++){let i=n.elts[a];if(i.pos==r)return i}else P5.set(t,n=new Xce);let s=n.elts[n.i]=E0.resolve(t,r);return n.i=(n.i+1)%Yce,s}}class Xce{constructor(){this.elts=[],this.i=0}}const Yce=12,P5=new WeakMap;class hg{constructor(t,r,n){this.$from=t,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Jce=Object.create(null);class ui{constructor(t,r,n,s=xr.none){this.type=t,this.attrs=r,this.marks=s,this.content=n||Ge.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,r,n,s=0){this.content.nodesBetween(t,r,n,s,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,r,n,s){return this.content.textBetween(t,r,n,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,r,n){return this.type==t&&ug(this.attrs,r||t.defaultAttrs||Jce)&&xr.sameSet(this.marks,n||xr.none)}copy(t=null){return t==this.content?this:new ui(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new ui(this.type,this.attrs,this.content,t)}cut(t,r=this.content.size){return t==0&&r==this.content.size?this:this.copy(this.content.cut(t,r))}slice(t,r=this.content.size,n=!1){if(t==r)return it.empty;let s=this.resolve(t),a=this.resolve(r),i=n?0:s.sharedDepth(r),o=s.start(i),f=s.node(i).content.cut(s.pos-o,a.pos-o);return new it(f,s.depth-i,a.depth-i)}replace(t,r,n){return Gce(this.resolve(t),this.resolve(r),n)}nodeAt(t){for(let r=this;;){let{index:n,offset:s}=r.content.findIndex(t);if(r=r.maybeChild(n),!r)return null;if(s==t||r.isText)return r;t-=s+1}}childAfter(t){let{index:r,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(r),index:r,offset:n};let s=this.content.child(r-1);return{node:s,index:r-1,offset:n-s.nodeSize}}resolve(t){return E0.resolveCached(this,t)}resolveNoCache(t){return E0.resolve(this,t)}rangeHasMark(t,r,n){let s=!1;return r>t&&this.nodesBetween(t,r,a=>(n.isInSet(a.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),GM(this.marks,t)}contentMatchAt(t){let r=this.type.contentMatch.matchFragment(this.content,0,t);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(t,r,n=Ge.empty,s=0,a=n.childCount){let i=this.contentMatchAt(t).matchFragment(n,s,a),o=i&&i.matchFragment(this.content,r);if(!o||!o.validEnd)return!1;for(let c=s;c<a;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0}canReplaceWith(t,r,n,s){if(s&&!this.type.allowsMarks(s))return!1;let a=this.contentMatchAt(t).matchType(n),i=a&&a.matchFragment(this.content,r);return i?i.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=xr.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!xr.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let t={type:this.type.name};for(let r in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(r=>r.toJSON())),t}static fromJSON(t,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(t.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(r.text,n)}let s=Ge.fromJSON(t,r.content),a=t.nodeType(r.type).create(r.attrs,s,n);return a.type.checkAttrs(a.attrs),a}}ui.prototype.text=void 0;class pg extends ui{constructor(t,r,n,s){if(super(t,r,null,s),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):GM(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,r){return this.text.slice(t,r)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new pg(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new pg(this.type,this.attrs,t,this.marks)}cut(t=0,r=this.text.length){return t==0&&r==this.text.length?this:this.withText(this.text.slice(t,r))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function GM(e,t){for(let r=e.length-1;r>=0;r--)t=e[r].type.name+"("+t+")";return t}class ru{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,r){let n=new Zce(t,r);if(n.next==null)return ru.empty;let s=KM(n);n.next&&n.err("Unexpected trailing text");let a=aue(sue(s));return iue(a,n),a}matchType(t){for(let r=0;r<this.next.length;r++)if(this.next[r].type==t)return this.next[r].next;return null}matchFragment(t,r=0,n=t.childCount){let s=this;for(let a=r;s&&a<n;a++)s=s.matchType(t.child(a).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:r}=this.next[t];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(t){for(let r=0;r<this.next.length;r++)for(let n=0;n<t.next.length;n++)if(this.next[r].type==t.next[n].type)return!0;return!1}fillBefore(t,r=!1,n=0){let s=[this];function a(i,o){let c=i.matchFragment(t,n);if(c&&(!r||c.validEnd))return Ge.from(o.map(f=>f.createAndFill()));for(let f=0;f<i.next.length;f++){let{type:h,next:p}=i.next[f];if(!(h.isText||h.hasRequiredAttrs())&&s.indexOf(p)==-1){s.push(p);let x=a(p,o.concat(h));if(x)return x}}return null}return a(this,[])}findWrapping(t){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];let r=this.computeWrapping(t);return this.wrapCache.push(t,r),r}computeWrapping(t){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let s=n.shift(),a=s.match;if(a.matchType(t)){let i=[];for(let o=s;o.type;o=o.via)i.push(o.type);return i.reverse()}for(let i=0;i<a.next.length;i++){let{type:o,next:c}=a.next[i];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in r)&&(!s.type||c.validEnd)&&(n.push({match:o.contentMatch,type:o,via:s}),r[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function r(n){t.push(n);for(let s=0;s<n.next.length;s++)t.indexOf(n.next[s].next)==-1&&r(n.next[s].next)}return r(this),t.map((n,s)=>{let a=s+(n.validEnd?"*":" ")+" ";for(let i=0;i<n.next.length;i++)a+=(i?", ":"")+n.next[i].type.name+"->"+t.indexOf(n.next[i].next);return a}).join(`
`)}}ru.empty=new ru(!0);class Zce{constructor(t,r){this.string=t,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function KM(e){let t=[];do t.push(Qce(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function Qce(e){let t=[];do t.push(eue(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function eue(e){let t=nue(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=tue(e,t);else break;return t}function L5(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function tue(e,t){let r=L5(e),n=r;return e.eat(",")&&(e.next!="}"?n=L5(e):n=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:t}}function rue(e,t){let r=e.nodeTypes,n=r[t];if(n)return[n];let s=[];for(let a in r){let i=r[a];i.isInGroup(t)&&s.push(i)}return s.length==0&&e.err("No node type or group '"+t+"' found"),s}function nue(e){if(e.eat("(")){let t=KM(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=rue(e,e.next).map(r=>(e.inline==null?e.inline=r.isInline:e.inline!=r.isInline&&e.err("Mixing inline and block content"),{type:"name",value:r}));return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function sue(e){let t=[[]];return s(a(e,0),r()),t;function r(){return t.push([])-1}function n(i,o,c){let f={term:c,to:o};return t[i].push(f),f}function s(i,o){i.forEach(c=>c.to=o)}function a(i,o){if(i.type=="choice")return i.exprs.reduce((c,f)=>c.concat(a(f,o)),[]);if(i.type=="seq")for(let c=0;;c++){let f=a(i.exprs[c],o);if(c==i.exprs.length-1)return f;s(f,o=r())}else if(i.type=="star"){let c=r();return n(o,c),s(a(i.expr,c),c),[n(c)]}else if(i.type=="plus"){let c=r();return s(a(i.expr,o),c),s(a(i.expr,c),c),[n(c)]}else{if(i.type=="opt")return[n(o)].concat(a(i.expr,o));if(i.type=="range"){let c=o;for(let f=0;f<i.min;f++){let h=r();s(a(i.expr,c),h),c=h}if(i.max==-1)s(a(i.expr,c),c);else for(let f=i.min;f<i.max;f++){let h=r();n(c,h),s(a(i.expr,c),h),c=h}return[n(c)]}else{if(i.type=="name")return[n(o,void 0,i.value)];throw new Error("Unknown expr type")}}}}function XM(e,t){return t-e}function B5(e,t){let r=[];return n(t),r.sort(XM);function n(s){let a=e[s];if(a.length==1&&!a[0].term)return n(a[0].to);r.push(s);for(let i=0;i<a.length;i++){let{term:o,to:c}=a[i];!o&&r.indexOf(c)==-1&&n(c)}}}function aue(e){let t=Object.create(null);return r(B5(e,0));function r(n){let s=[];n.forEach(i=>{e[i].forEach(({term:o,to:c})=>{if(!o)return;let f;for(let h=0;h<s.length;h++)s[h][0]==o&&(f=s[h][1]);B5(e,c).forEach(h=>{f||s.push([o,f=[]]),f.indexOf(h)==-1&&f.push(h)})})});let a=t[n.join(",")]=new ru(n.indexOf(e.length-1)>-1);for(let i=0;i<s.length;i++){let o=s[i][1].sort(XM);a.next.push({type:s[i][0],next:t[o.join(",")]||r(o)})}return a}}function iue(e,t){for(let r=0,n=[e];r<n.length;r++){let s=n[r],a=!s.validEnd,i=[];for(let o=0;o<s.next.length;o++){let{type:c,next:f}=s.next[o];i.push(c.name),a&&!(c.isText||c.hasRequiredAttrs())&&(a=!1),n.indexOf(f)==-1&&n.push(f)}a&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function YM(e){let t=Object.create(null);for(let r in e){let n=e[r];if(!n.hasDefault)return null;t[r]=n.default}return t}function JM(e,t){let r=Object.create(null);for(let n in e){let s=t&&t[n];if(s===void 0){let a=e[n];if(a.hasDefault)s=a.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=s}return r}function ZM(e,t,r,n){for(let s in t)if(!(s in e))throw new RangeError(`Unsupported attribute ${s} for ${r} of type ${s}`);for(let s in e){let a=e[s];a.validate&&a.validate(t[s])}}function QM(e,t){let r=Object.create(null);if(t)for(let n in t)r[n]=new lue(e,n,t[n]);return r}let U5=class eF{constructor(t,r,n){this.name=t,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=QM(t,n.attrs),this.defaultAttrs=YM(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ru.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:JM(this.attrs,t)}create(t=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ui(this,this.computeAttrs(t),Ge.from(r),xr.setFrom(n))}createChecked(t=null,r,n){return r=Ge.from(r),this.checkContent(r),new ui(this,this.computeAttrs(t),r,xr.setFrom(n))}createAndFill(t=null,r,n){if(t=this.computeAttrs(t),r=Ge.from(r),r.size){let i=this.contentMatch.fillBefore(r);if(!i)return null;r=i.append(r)}let s=this.contentMatch.matchFragment(r),a=s&&s.fillBefore(Ge.empty,!0);return a?new ui(this,t,r.append(a),xr.setFrom(n)):null}validContent(t){let r=this.contentMatch.matchFragment(t);if(!r||!r.validEnd)return!1;for(let n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){ZM(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let r=0;r<t.length;r++)if(!this.allowsMarkType(t[r].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let r;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?r&&r.push(t[n]):r||(r=t.slice(0,n));return r?r.length?r:xr.none:t}static compile(t,r){let n=Object.create(null);t.forEach((a,i)=>n[a]=new eF(a,r,i));let s=r.spec.topNode||"doc";if(!n[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let a in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function oue(e,t,r){let n=r.split("|");return s=>{let a=s===null?"null":typeof s;if(n.indexOf(a)<0)throw new RangeError(`Expected value of type ${n} for attribute ${t} on type ${e}, got ${a}`)}}class lue{constructor(t,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?oue(t,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class R1{constructor(t,r,n,s){this.name=t,this.rank=r,this.schema=n,this.spec=s,this.attrs=QM(t,s.attrs),this.excluded=null;let a=YM(this.attrs);this.instance=a?new xr(this,a):null}create(t=null){return!t&&this.instance?this.instance:new xr(this,JM(this.attrs,t))}static compile(t,r){let n=Object.create(null),s=0;return t.forEach((a,i)=>n[a]=new R1(a,s++,r,i)),n}removeFromSet(t){for(var r=0;r<t.length;r++)t[r].type==this&&(t=t.slice(0,r).concat(t.slice(r+1)),r--);return t}isInSet(t){for(let r=0;r<t.length;r++)if(t[r].type==this)return t[r]}checkAttrs(t){ZM(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class tF{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let s in t)r[s]=t[s];r.nodes=Wn.from(t.nodes),r.marks=Wn.from(t.marks||{}),this.nodes=U5.compile(this.spec.nodes,this),this.marks=R1.compile(this.spec.marks,this);let n=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let a=this.nodes[s],i=a.spec.content||"",o=a.spec.marks;if(a.contentMatch=n[i]||(n[i]=ru.parse(i,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=o=="_"?null:o?z5(this,o.split(" ")):o==""||!a.inlineContent?[]:null}for(let s in this.marks){let a=this.marks[s],i=a.spec.excludes;a.excluded=i==null?[a]:i==""?[]:z5(this,i.split(" "))}this.nodeFromJSON=s=>ui.fromJSON(this,s),this.markFromJSON=s=>xr.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,r=null,n,s){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof U5){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(r,n,s)}text(t,r){let n=this.nodes.text;return new pg(n,n.defaultAttrs,t,xr.setFrom(r))}mark(t,r){return typeof t=="string"&&(t=this.marks[t]),t.create(r)}nodeType(t){let r=this.nodes[t];if(!r)throw new RangeError("Unknown node type: "+t);return r}}function z5(e,t){let r=[];for(let n=0;n<t.length;n++){let s=t[n],a=e.marks[s],i=a;if(a)r.push(a);else for(let o in e.marks){let c=e.marks[o];(s=="_"||c.spec.group&&c.spec.group.split(" ").indexOf(s)>-1)&&r.push(i=c)}if(!i)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return r}function cue(e){return e.tag!=null}function uue(e){return e.style!=null}class Dl{constructor(t,r){this.schema=t,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(s=>{if(cue(s))this.tags.push(s);else if(uue(s)){let a=/[^=]*/.exec(s.style)[0];n.indexOf(a)<0&&n.push(a),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let a=t.nodes[s.node];return a.contentMatch.matchType(a)})}parse(t,r={}){let n=new V5(this,r,!1);return n.addAll(t,xr.none,r.from,r.to),n.finish()}parseSlice(t,r={}){let n=new V5(this,r,!0);return n.addAll(t,xr.none,r.from,r.to),it.maxOpen(n.finish())}matchTag(t,r,n){for(let s=n?this.tags.indexOf(n)+1:0;s<this.tags.length;s++){let a=this.tags[s];if(hue(t,a.tag)&&(a.namespace===void 0||t.namespaceURI==a.namespace)&&(!a.context||r.matchesContext(a.context))){if(a.getAttrs){let i=a.getAttrs(t);if(i===!1)continue;a.attrs=i||void 0}return a}}}matchStyle(t,r,n,s){for(let a=s?this.styles.indexOf(s)+1:0;a<this.styles.length;a++){let i=this.styles[a],o=i.style;if(!(o.indexOf(t)!=0||i.context&&!n.matchesContext(i.context)||o.length>t.length&&(o.charCodeAt(t.length)!=61||o.slice(t.length+1)!=r))){if(i.getAttrs){let c=i.getAttrs(r);if(c===!1)continue;i.attrs=c||void 0}return i}}}static schemaRules(t){let r=[];function n(s){let a=s.priority==null?50:s.priority,i=0;for(;i<r.length;i++){let o=r[i];if((o.priority==null?50:o.priority)<a)break}r.splice(i,0,s)}for(let s in t.marks){let a=t.marks[s].spec.parseDOM;a&&a.forEach(i=>{n(i=q5(i)),i.mark||i.ignore||i.clearMark||(i.mark=s)})}for(let s in t.nodes){let a=t.nodes[s].spec.parseDOM;a&&a.forEach(i=>{n(i=q5(i)),i.node||i.ignore||i.mark||(i.node=s)})}return r}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new Dl(t,Dl.schemaRules(t)))}}const rF={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},fue={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},nF={ol:!0,ul:!0},S0=1,B_=2,$h=4;function H5(e,t,r){return t!=null?(t?S0:0)|(t==="full"?B_:0):e&&e.whitespace=="pre"?S0|B_:r&~$h}class Jm{constructor(t,r,n,s,a,i){this.type=t,this.attrs=r,this.marks=n,this.solid=s,this.options=i,this.content=[],this.activeMarks=xr.none,this.match=a||(i&$h?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Ge.from(t));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,s;return(s=n.findWrapping(t.type))?(this.match=n,s):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&S0)){let n=this.content[this.content.length-1],s;if(n&&n.isText&&(s=/[ \t\r\n\u000c]+$/.exec(n.text))){let a=n;n.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-s[0].length))}}let r=Ge.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(Ge.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!rF.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class V5{constructor(t,r,n){this.parser=t,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let s=r.topNode,a,i=H5(null,r.preserveWhitespace,0)|(n?$h:0);s?a=new Jm(s.type,s.attrs,xr.none,!0,r.topMatch||s.type.contentMatch,i):n?a=new Jm(null,null,xr.none,!0,null,i):a=new Jm(t.schema.topNodeType,null,xr.none,!0,null,i),this.nodes=[a],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,r){t.nodeType==3?this.addTextNode(t,r):t.nodeType==1&&this.addElement(t,r)}addTextNode(t,r){let n=t.nodeValue,s=this.top,a=s.options&B_?"full":this.localPreserveWS||(s.options&S0)>0,{schema:i}=this.parser;if(a==="full"||s.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(a)if(a==="full")n=n.replace(/\r\n?/g,`
`);else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){let o=n.split(/\r?\n|\r/);for(let c=0;c<o.length;c++)c&&this.insertNode(i.linebreakReplacement.create(),r,!0),o[c]&&this.insertNode(i.text(o[c]),r,!/\S/.test(o[c]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let o=s.content[s.content.length-1],c=t.previousSibling;(!o||c&&c.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),r,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,r,n){let s=this.localPreserveWS,a=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let i=t.nodeName.toLowerCase(),o;nF.hasOwnProperty(i)&&this.parser.normalizeLists&&due(t);let c=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(o=this.parser.matchTag(t,this,n));e:if(c?c.ignore:fue.hasOwnProperty(i))this.findInside(t),this.ignoreFallback(t,r);else if(!c||c.skip||c.closeParent){c&&c.closeParent?this.open=Math.max(0,this.open-1):c&&c.skip.nodeType&&(t=c.skip);let f,h=this.needsBlock;if(rF.hasOwnProperty(i))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),f=!0,a.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,r);break e}let p=c&&c.skip?r:this.readStyles(t,r);p&&this.addAll(t,p),f&&this.sync(a),this.needsBlock=h}else{let f=this.readStyles(t,r);f&&this.addElementByRule(t,c,f,c.consuming===!1?o:void 0)}this.localPreserveWS=s}leafFallback(t,r){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),r)}ignoreFallback(t,r){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(t,r){let n=t.style;if(n&&n.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let a=this.parser.matchedStyles[s],i=n.getPropertyValue(a);if(i)for(let o=void 0;;){let c=this.parser.matchStyle(a,i,this,o);if(!c)break;if(c.ignore)return null;if(c.clearMark?r=r.filter(f=>!c.clearMark(f)):r=r.concat(this.parser.schema.marks[c.mark].create(c.attrs)),c.consuming===!1)o=c;else break}}return r}addElementByRule(t,r,n,s){let a,i;if(r.node)if(i=this.parser.schema.nodes[r.node],i.isLeaf)this.insertNode(i.create(r.attrs),n,t.nodeName=="BR")||this.leafFallback(t,n);else{let c=this.enter(i,r.attrs||null,n,r.preserveWhitespace);c&&(a=!0,n=c)}else{let c=this.parser.schema.marks[r.mark];n=n.concat(c.create(r.attrs))}let o=this.top;if(i&&i.isLeaf)this.findInside(t);else if(s)this.addElement(t,n,s);else if(r.getContent)this.findInside(t),r.getContent(t,this.parser.schema).forEach(c=>this.insertNode(c,n,!1));else{let c=t;typeof r.contentElement=="string"?c=t.querySelector(r.contentElement):typeof r.contentElement=="function"?c=r.contentElement(t):r.contentElement&&(c=r.contentElement),this.findAround(t,c,!0),this.addAll(c,n),this.findAround(t,c,!1)}a&&this.sync(o)&&this.open--}addAll(t,r,n,s){let a=n||0;for(let i=n?t.childNodes[n]:t.firstChild,o=s==null?null:t.childNodes[s];i!=o;i=i.nextSibling,++a)this.findAtPoint(t,a),this.addDOM(i,r);this.findAtPoint(t,a)}findPlace(t,r,n){let s,a;for(let i=this.open,o=0;i>=0;i--){let c=this.nodes[i],f=c.findWrapping(t);if(f&&(!s||s.length>f.length+o)&&(s=f,a=c,!f.length))break;if(c.solid){if(n)break;o+=2}}if(!s)return null;this.sync(a);for(let i=0;i<s.length;i++)r=this.enterInner(s[i],null,r,!1);return r}insertNode(t,r,n){if(t.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(r=this.enterInner(a,null,r))}let s=this.findPlace(t,r,n);if(s){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(t.type));let i=xr.none;for(let o of s.concat(t.marks))(a.type?a.type.allowsMarkType(o.type):W5(o.type,t.type))&&(i=o.addToSet(i));return a.content.push(t.mark(i)),!0}return!1}enter(t,r,n,s){let a=this.findPlace(t.create(r),n,!1);return a&&(a=this.enterInner(t,r,n,!0,s)),a}enterInner(t,r,n,s=!1,a){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(t);let o=H5(t,a,i.options);i.options&$h&&i.content.length==0&&(o|=$h);let c=xr.none;return n=n.filter(f=>(i.type?i.type.allowsMarkType(f.type):W5(f.type,t))?(c=f.addToSet(c),!1):!0),this.nodes.push(new Jm(t,r,c,s,null,o)),this.open++,n}closeExtra(t=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let r=this.open;r>=0;r--){if(this.nodes[r]==t)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=S0)}return!1}get currentPos(){this.closeExtra();let t=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let s=n.length-1;s>=0;s--)t+=n[s].nodeSize;r&&t++}return t}findAtPoint(t,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&t.nodeType==1&&t.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(t,r,n){if(t!=r&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&t.nodeType==1&&t.contains(this.find[s].node)&&r.compareDocumentPosition(this.find[s].node)&(n?2:4)&&(this.find[s].pos=this.currentPos)}findInText(t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&(this.find[r].pos=this.currentPos-(t.nodeValue.length-this.find[r].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let r=t.split("/"),n=this.options.context,s=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),a=-(n?n.depth+1:0)+(s?0:1),i=(o,c)=>{for(;o>=0;o--){let f=r[o];if(f==""){if(o==r.length-1||o==0)continue;for(;c>=a;c--)if(i(o-1,c))return!0;return!1}else{let h=c>0||c==0&&s?this.nodes[c].type:n&&c>=a?n.node(c-a).type:null;if(!h||h.name!=f&&!h.isInGroup(f))return!1;c--}}return!0};return i(r.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let r=t.depth;r>=0;r--){let n=t.node(r).contentMatchAt(t.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function due(e){for(let t=e.firstChild,r=null;t;t=t.nextSibling){let n=t.nodeType==1?t.nodeName.toLowerCase():null;n&&nF.hasOwnProperty(n)&&r?(r.appendChild(t),t=r):n=="li"?r=t:n&&(r=null)}}function hue(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function q5(e){let t={};for(let r in e)t[r]=e[r];return t}function W5(e,t){let r=t.schema.nodes;for(let n in r){let s=r[n];if(!s.allowsMarkType(e))continue;let a=[],i=o=>{a.push(o);for(let c=0;c<o.edgeCount;c++){let{type:f,next:h}=o.edge(c);if(f==t||a.indexOf(h)<0&&i(h))return!0}};if(i(s.contentMatch))return!0}}class mu{constructor(t,r){this.nodes=t,this.marks=r}serializeFragment(t,r={},n){n||(n=zb(r).createDocumentFragment());let s=n,a=[];return t.forEach(i=>{if(a.length||i.marks.length){let o=0,c=0;for(;o<a.length&&c<i.marks.length;){let f=i.marks[c];if(!this.marks[f.type.name]){c++;continue}if(!f.eq(a[o][0])||f.type.spec.spanning===!1)break;o++,c++}for(;o<a.length;)s=a.pop()[1];for(;c<i.marks.length;){let f=i.marks[c++],h=this.serializeMark(f,i.isInline,r);h&&(a.push([f,s]),s.appendChild(h.dom),s=h.contentDOM||h.dom)}}s.appendChild(this.serializeNodeInner(i,r))}),n}serializeNodeInner(t,r){let{dom:n,contentDOM:s}=Dx(zb(r),this.nodes[t.type.name](t),null,t.attrs);if(s){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,r,s)}return n}serializeNode(t,r={}){let n=this.serializeNodeInner(t,r);for(let s=t.marks.length-1;s>=0;s--){let a=this.serializeMark(t.marks[s],t.isInline,r);a&&((a.contentDOM||a.dom).appendChild(n),n=a.dom)}return n}serializeMark(t,r,n={}){let s=this.marks[t.type.name];return s&&Dx(zb(n),s(t,r),null,t.attrs)}static renderSpec(t,r,n=null,s){return Dx(t,r,n,s)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new mu(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let r=$5(t.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(t){return $5(t.marks)}}function $5(e){let t={};for(let r in e){let n=e[r].spec.toDOM;n&&(t[r]=n)}return t}function zb(e){return e.document||window.document}const G5=new WeakMap;function pue(e){let t=G5.get(e);return t===void 0&&G5.set(e,t=mue(e)),t}function mue(e){let t=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")t||(t=[]),t.push(n);else for(let s=0;s<n.length;s++)r(n[s]);else for(let s in n)r(n[s])}return r(e),t}function Dx(e,t,r,n){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let s=t[0],a;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(a=pue(n))&&a.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let i=s.indexOf(" ");i>0&&(r=s.slice(0,i),s=s.slice(i+1));let o,c=r?e.createElementNS(r,s):e.createElement(s),f=t[1],h=1;if(f&&typeof f=="object"&&f.nodeType==null&&!Array.isArray(f)){h=2;for(let p in f)if(f[p]!=null){let x=p.indexOf(" ");x>0?c.setAttributeNS(p.slice(0,x),p.slice(x+1),f[p]):p=="style"&&c.style?c.style.cssText=f[p]:c.setAttribute(p,f[p])}}for(let p=h;p<t.length;p++){let x=t[p];if(x===0){if(p<t.length-1||p>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}else{let{dom:g,contentDOM:v}=Dx(e,x,r,n);if(c.appendChild(g),v){if(o)throw new RangeError("Multiple content holes");o=v}}}return{dom:c,contentDOM:o}}const sF=65535,aF=Math.pow(2,16);function xue(e,t){return e+t*aF}function K5(e){return e&sF}function gue(e){return(e-(e&sF))/aF}const iF=1,oF=2,Ix=4,lF=8;class U_{constructor(t,r,n){this.pos=t,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&lF)>0}get deletedBefore(){return(this.delInfo&(iF|Ix))>0}get deletedAfter(){return(this.delInfo&(oF|Ix))>0}get deletedAcross(){return(this.delInfo&Ix)>0}}class ia{constructor(t,r=!1){if(this.ranges=t,this.inverted=r,!t.length&&ia.empty)return ia.empty}recover(t){let r=0,n=K5(t);if(!this.inverted)for(let s=0;s<n;s++)r+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[n*3]+r+gue(t)}mapResult(t,r=1){return this._map(t,r,!1)}map(t,r=1){return this._map(t,r,!0)}_map(t,r,n){let s=0,a=this.inverted?2:1,i=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let c=this.ranges[o]-(this.inverted?s:0);if(c>t)break;let f=this.ranges[o+a],h=this.ranges[o+i],p=c+f;if(t<=p){let x=f?t==c?-1:t==p?1:r:r,g=c+s+(x<0?0:h);if(n)return g;let v=t==(r<0?c:p)?null:xue(o/3,t-c),y=t==c?oF:t==p?iF:Ix;return(r<0?t!=c:t!=p)&&(y|=lF),new U_(g,y,v)}s+=h-f}return n?t+s:new U_(t+s,0,null)}touches(t,r){let n=0,s=K5(r),a=this.inverted?2:1,i=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let c=this.ranges[o]-(this.inverted?n:0);if(c>t)break;let f=this.ranges[o+a],h=c+f;if(t<=h&&o==s*3)return!0;n+=this.ranges[o+i]-f}return!1}forEach(t){let r=this.inverted?2:1,n=this.inverted?1:2;for(let s=0,a=0;s<this.ranges.length;s+=3){let i=this.ranges[s],o=i-(this.inverted?a:0),c=i+(this.inverted?0:a),f=this.ranges[s+r],h=this.ranges[s+n];t(o,o+f,c,c+h),a+=h-f}}invert(){return new ia(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?ia.empty:new ia(t<0?[0,-t,0]:[0,0,t])}}ia.empty=new ia([]);class N0{constructor(t,r,n=0,s=t?t.length:0){this.mirror=r,this.from=n,this.to=s,this._maps=t||[],this.ownData=!(t||r)}get maps(){return this._maps}slice(t=0,r=this.maps.length){return new N0(this._maps,this.mirror,t,r)}appendMap(t,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(t){for(let r=0,n=this._maps.length;r<t._maps.length;r++){let s=t.getMirror(r);this.appendMap(t._maps[r],s!=null&&s<r?n+s:void 0)}}getMirror(t){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==t)return this.mirror[r+(r%2?-1:1)]}}setMirror(t,r){this.mirror||(this.mirror=[]),this.mirror.push(t,r)}appendMappingInverted(t){for(let r=t.maps.length-1,n=this._maps.length+t._maps.length;r>=0;r--){let s=t.getMirror(r);this.appendMap(t._maps[r].invert(),s!=null&&s>r?n-s-1:void 0)}}invert(){let t=new N0;return t.appendMappingInverted(this),t}map(t,r=1){if(this.mirror)return this._map(t,r,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,r);return t}mapResult(t,r=1){return this._map(t,r,!1)}_map(t,r,n){let s=0;for(let a=this.from;a<this.to;a++){let i=this._maps[a],o=i.mapResult(t,r);if(o.recover!=null){let c=this.getMirror(a);if(c!=null&&c>a&&c<this.to){a=c,t=this._maps[c].recover(o.recover);continue}}s|=o.delInfo,t=o.pos}return n?t:new U_(t,s,null)}}const Hb=Object.create(null);class ms{getMap(){return ia.empty}merge(t){return null}static fromJSON(t,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Hb[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(t,r)}static jsonID(t,r){if(t in Hb)throw new RangeError("Duplicate use of step JSON ID "+t);return Hb[t]=r,r.prototype.jsonID=t,r}}class xn{constructor(t,r){this.doc=t,this.failed=r}static ok(t){return new xn(t,null)}static fail(t){return new xn(null,t)}static fromReplace(t,r,n,s){try{return xn.ok(t.replace(r,n,s))}catch(a){if(a instanceof fg)return xn.fail(a.message);throw a}}}function US(e,t,r){let n=[];for(let s=0;s<e.childCount;s++){let a=e.child(s);a.content.size&&(a=a.copy(US(a.content,t,a))),a.isInline&&(a=t(a,r,s)),n.push(a)}return Ge.fromArray(n)}class Cl extends ms{constructor(t,r,n){super(),this.from=t,this.to=r,this.mark=n}apply(t){let r=t.slice(this.from,this.to),n=t.resolve(this.from),s=n.node(n.sharedDepth(this.to)),a=new it(US(r.content,(i,o)=>!i.isAtom||!o.type.allowsMarkType(this.mark.type)?i:i.mark(this.mark.addToSet(i.marks)),s),r.openStart,r.openEnd);return xn.fromReplace(t,this.from,this.to,a)}invert(){return new oi(this.from,this.to,this.mark)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Cl(r.pos,n.pos,this.mark)}merge(t){return t instanceof Cl&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Cl(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Cl(r.from,r.to,t.markFromJSON(r.mark))}}ms.jsonID("addMark",Cl);class oi extends ms{constructor(t,r,n){super(),this.from=t,this.to=r,this.mark=n}apply(t){let r=t.slice(this.from,this.to),n=new it(US(r.content,s=>s.mark(this.mark.removeFromSet(s.marks)),t),r.openStart,r.openEnd);return xn.fromReplace(t,this.from,this.to,n)}invert(){return new Cl(this.from,this.to,this.mark)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new oi(r.pos,n.pos,this.mark)}merge(t){return t instanceof oi&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new oi(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new oi(r.from,r.to,t.markFromJSON(r.mark))}}ms.jsonID("removeMark",oi);class Rl extends ms{constructor(t,r){super(),this.pos=t,this.mark=r}apply(t){let r=t.nodeAt(this.pos);if(!r)return xn.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return xn.fromReplace(t,this.pos,this.pos+1,new it(Ge.from(n),0,r.isLeaf?0:1))}invert(t){let r=t.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let s=0;s<r.marks.length;s++)if(!r.marks[s].isInSet(n))return new Rl(this.pos,r.marks[s]);return new Rl(this.pos,this.mark)}}return new nu(this.pos,this.mark)}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new Rl(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Rl(r.pos,t.markFromJSON(r.mark))}}ms.jsonID("addNodeMark",Rl);class nu extends ms{constructor(t,r){super(),this.pos=t,this.mark=r}apply(t){let r=t.nodeAt(this.pos);if(!r)return xn.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return xn.fromReplace(t,this.pos,this.pos+1,new it(Ge.from(n),0,r.isLeaf?0:1))}invert(t){let r=t.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new Rl(this.pos,this.mark)}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new nu(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new nu(r.pos,t.markFromJSON(r.mark))}}ms.jsonID("removeNodeMark",nu);class On extends ms{constructor(t,r,n,s=!1){super(),this.from=t,this.to=r,this.slice=n,this.structure=s}apply(t){return this.structure&&z_(t,this.from,this.to)?xn.fail("Structure replace would overwrite content"):xn.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new ia([this.from,this.to-this.from,this.slice.size])}invert(t){return new On(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new On(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof On)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let r=this.slice.size+t.slice.size==0?it.empty:new it(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new On(this.from,this.to+(t.to-t.from),r,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let r=this.slice.size+t.slice.size==0?it.empty:new it(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new On(t.from,this.to,r,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new On(r.from,r.to,it.fromJSON(t,r.slice),!!r.structure)}}ms.jsonID("replace",On);class Fn extends ms{constructor(t,r,n,s,a,i,o=!1){super(),this.from=t,this.to=r,this.gapFrom=n,this.gapTo=s,this.slice=a,this.insert=i,this.structure=o}apply(t){if(this.structure&&(z_(t,this.from,this.gapFrom)||z_(t,this.gapTo,this.to)))return xn.fail("Structure gap-replace would overwrite content");let r=t.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return xn.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?xn.fromReplace(t,this.from,this.to,n):xn.fail("Content does not fit in gap")}getMap(){return new ia([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let r=this.gapTo-this.gapFrom;return new Fn(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),s=this.from==this.gapFrom?r.pos:t.map(this.gapFrom,-1),a=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||s<r.pos||a>n.pos?null:new Fn(r.pos,n.pos,s,a,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Fn(r.from,r.to,r.gapFrom,r.gapTo,it.fromJSON(t,r.slice),r.insert,!!r.structure)}}ms.jsonID("replaceAround",Fn);function z_(e,t,r){let n=e.resolve(t),s=r-t,a=n.depth;for(;s>0&&a>0&&n.indexAfter(a)==n.node(a).childCount;)a--,s--;if(s>0){let i=n.node(a).maybeChild(n.indexAfter(a));for(;s>0;){if(!i||i.isLeaf)return!0;i=i.firstChild,s--}}return!1}function yue(e,t,r,n){let s=[],a=[],i,o;e.doc.nodesBetween(t,r,(c,f,h)=>{if(!c.isInline)return;let p=c.marks;if(!n.isInSet(p)&&h.type.allowsMarkType(n.type)){let x=Math.max(f,t),g=Math.min(f+c.nodeSize,r),v=n.addToSet(p);for(let y=0;y<p.length;y++)p[y].isInSet(v)||(i&&i.to==x&&i.mark.eq(p[y])?i.to=g:s.push(i=new oi(x,g,p[y])));o&&o.to==x?o.to=g:a.push(o=new Cl(x,g,n))}}),s.forEach(c=>e.step(c)),a.forEach(c=>e.step(c))}function vue(e,t,r,n){let s=[],a=0;e.doc.nodesBetween(t,r,(i,o)=>{if(!i.isInline)return;a++;let c=null;if(n instanceof R1){let f=i.marks,h;for(;h=n.isInSet(f);)(c||(c=[])).push(h),f=h.removeFromSet(f)}else n?n.isInSet(i.marks)&&(c=[n]):c=i.marks;if(c&&c.length){let f=Math.min(o+i.nodeSize,r);for(let h=0;h<c.length;h++){let p=c[h],x;for(let g=0;g<s.length;g++){let v=s[g];v.step==a-1&&p.eq(s[g].style)&&(x=v)}x?(x.to=f,x.step=a):s.push({style:p,from:Math.max(o,t),to:f,step:a})}}}),s.forEach(i=>e.step(new oi(i.from,i.to,i.style)))}function zS(e,t,r,n=r.contentMatch,s=!0){let a=e.doc.nodeAt(t),i=[],o=t+1;for(let c=0;c<a.childCount;c++){let f=a.child(c),h=o+f.nodeSize,p=n.matchType(f.type);if(!p)i.push(new On(o,h,it.empty));else{n=p;for(let x=0;x<f.marks.length;x++)r.allowsMarkType(f.marks[x].type)||e.step(new oi(o,h,f.marks[x]));if(s&&f.isText&&r.whitespace!="pre"){let x,g=/\r?\n|\r/g,v;for(;x=g.exec(f.text);)v||(v=new it(Ge.from(r.schema.text(" ",r.allowedMarks(f.marks))),0,0)),i.push(new On(o+x.index,o+x.index+x[0].length,v))}}o=h}if(!n.validEnd){let c=n.fillBefore(Ge.empty,!0);e.replace(o,o,new it(c,0,0))}for(let c=i.length-1;c>=0;c--)e.step(i[c])}function bue(e,t,r){return(t==0||e.canReplace(t,e.childCount))&&(r==e.childCount||e.canReplace(0,r))}function xd(e){let r=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,s=0,a=0;;--n){let i=e.$from.node(n),o=e.$from.index(n)+s,c=e.$to.indexAfter(n)-a;if(n<e.depth&&i.canReplace(o,c,r))return n;if(n==0||i.type.spec.isolating||!bue(i,o,c))break;o&&(s=1),c<i.childCount&&(a=1)}return null}function wue(e,t,r){let{$from:n,$to:s,depth:a}=t,i=n.before(a+1),o=s.after(a+1),c=i,f=o,h=Ge.empty,p=0;for(let v=a,y=!1;v>r;v--)y||n.index(v)>0?(y=!0,h=Ge.from(n.node(v).copy(h)),p++):c--;let x=Ge.empty,g=0;for(let v=a,y=!1;v>r;v--)y||s.after(v+1)<s.end(v)?(y=!0,x=Ge.from(s.node(v).copy(x)),g++):f++;e.step(new Fn(c,f,i,o,new it(h.append(x),p,g),h.size-p,!0))}function HS(e,t,r=null,n=e){let s=_ue(e,t),a=s&&Eue(n,t);return a?s.map(X5).concat({type:t,attrs:r}).concat(a.map(X5)):null}function X5(e){return{type:e,attrs:null}}function _ue(e,t){let{parent:r,startIndex:n,endIndex:s}=e,a=r.contentMatchAt(n).findWrapping(t);if(!a)return null;let i=a.length?a[0]:t;return r.canReplaceWith(n,s,i)?a:null}function Eue(e,t){let{parent:r,startIndex:n,endIndex:s}=e,a=r.child(n),i=t.contentMatch.findWrapping(a.type);if(!i)return null;let c=(i.length?i[i.length-1]:t).contentMatch;for(let f=n;c&&f<s;f++)c=c.matchType(r.child(f).type);return!c||!c.validEnd?null:i}function Sue(e,t,r){let n=Ge.empty;for(let i=r.length-1;i>=0;i--){if(n.size){let o=r[i].type.contentMatch.matchFragment(n);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Ge.from(r[i].type.create(r[i].attrs,n))}let s=t.start,a=t.end;e.step(new Fn(s,a,s,a,new it(n,0,0),r.length,!0))}function Nue(e,t,r,n,s){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=e.steps.length;e.doc.nodesBetween(t,r,(i,o)=>{let c=typeof s=="function"?s(i):s;if(i.isTextblock&&!i.hasMarkup(n,c)&&Tue(e.doc,e.mapping.slice(a).map(o),n)){let f=null;if(n.schema.linebreakReplacement){let g=n.whitespace=="pre",v=!!n.contentMatch.matchType(n.schema.linebreakReplacement);g&&!v?f=!1:!g&&v&&(f=!0)}f===!1&&uF(e,i,o,a),zS(e,e.mapping.slice(a).map(o,1),n,void 0,f===null);let h=e.mapping.slice(a),p=h.map(o,1),x=h.map(o+i.nodeSize,1);return e.step(new Fn(p,x,p+1,x-1,new it(Ge.from(n.create(c,null,i.marks)),0,0),1,!0)),f===!0&&cF(e,i,o,a),!1}})}function cF(e,t,r,n){t.forEach((s,a)=>{if(s.isText){let i,o=/\r?\n|\r/g;for(;i=o.exec(s.text);){let c=e.mapping.slice(n).map(r+1+a+i.index);e.replaceWith(c,c+1,t.type.schema.linebreakReplacement.create())}}})}function uF(e,t,r,n){t.forEach((s,a)=>{if(s.type==s.type.schema.linebreakReplacement){let i=e.mapping.slice(n).map(r+1+a);e.replaceWith(i,i+1,t.type.schema.text(`
`))}})}function Tue(e,t,r){let n=e.resolve(t),s=n.index();return n.parent.canReplaceWith(s,s+1,r)}function kue(e,t,r,n,s){let a=e.doc.nodeAt(t);if(!a)throw new RangeError("No node at given position");r||(r=a.type);let i=r.create(n,null,s||a.marks);if(a.isLeaf)return e.replaceWith(t,t+a.nodeSize,i);if(!r.validContent(a.content))throw new RangeError("Invalid content for node type "+r.name);e.step(new Fn(t,t+a.nodeSize,t+1,t+a.nodeSize-1,new it(Ge.from(i),0,0),1,!0))}function Do(e,t,r=1,n){let s=e.resolve(t),a=s.depth-r,i=n&&n[n.length-1]||s.parent;if(a<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!i.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let f=s.depth-1,h=r-2;f>a;f--,h--){let p=s.node(f),x=s.index(f);if(p.type.spec.isolating)return!1;let g=p.content.cutByIndex(x,p.childCount),v=n&&n[h+1];v&&(g=g.replaceChild(0,v.type.create(v.attrs)));let y=n&&n[h]||p;if(!p.canReplace(x+1,p.childCount)||!y.type.validContent(g))return!1}let o=s.indexAfter(a),c=n&&n[0];return s.node(a).canReplaceWith(o,o,c?c.type:s.node(a+1).type)}function Aue(e,t,r=1,n){let s=e.doc.resolve(t),a=Ge.empty,i=Ge.empty;for(let o=s.depth,c=s.depth-r,f=r-1;o>c;o--,f--){a=Ge.from(s.node(o).copy(a));let h=n&&n[f];i=Ge.from(h?h.type.create(h.attrs,i):s.node(o).copy(i))}e.step(new On(t,t,new it(a.append(i),r,r),!0))}function Xl(e,t){let r=e.resolve(t),n=r.index();return fF(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function Cue(e,t){t.content.size||e.type.compatibleContent(t.type);let r=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let s=0;s<t.childCount;s++){let a=t.child(s),i=a.type==n?e.type.schema.nodes.text:a.type;if(r=r.matchType(i),!r||!e.type.allowsMarks(a.marks))return!1}return r.validEnd}function fF(e,t){return!!(e&&t&&!e.isLeaf&&Cue(e,t))}function j1(e,t,r=-1){let n=e.resolve(t);for(let s=n.depth;;s--){let a,i,o=n.index(s);if(s==n.depth?(a=n.nodeBefore,i=n.nodeAfter):r>0?(a=n.node(s+1),o++,i=n.node(s).maybeChild(o)):(a=n.node(s).maybeChild(o-1),i=n.node(s+1)),a&&!a.isTextblock&&fF(a,i)&&n.node(s).canReplace(o,o+1))return t;if(s==0)break;t=r<0?n.before(s):n.after(s)}}function Rue(e,t,r){let n=null,{linebreakReplacement:s}=e.doc.type.schema,a=e.doc.resolve(t-r),i=a.node().type;if(s&&i.inlineContent){let h=i.whitespace=="pre",p=!!i.contentMatch.matchType(s);h&&!p?n=!1:!h&&p&&(n=!0)}let o=e.steps.length;if(n===!1){let h=e.doc.resolve(t+r);uF(e,h.node(),h.before(),o)}i.inlineContent&&zS(e,t+r-1,i,a.node().contentMatchAt(a.index()),n==null);let c=e.mapping.slice(o),f=c.map(t-r);if(e.step(new On(f,c.map(t+r,-1),it.empty,!0)),n===!0){let h=e.doc.resolve(f);cF(e,h.node(),h.before(),e.steps.length)}return e}function jue(e,t,r){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),r))return t;if(n.parentOffset==0)for(let s=n.depth-1;s>=0;s--){let a=n.index(s);if(n.node(s).canReplaceWith(a,a,r))return n.before(s+1);if(a>0)return null}if(n.parentOffset==n.parent.content.size)for(let s=n.depth-1;s>=0;s--){let a=n.indexAfter(s);if(n.node(s).canReplaceWith(a,a,r))return n.after(s+1);if(a<n.node(s).childCount)return null}return null}function dF(e,t,r){let n=e.resolve(t);if(!r.content.size)return t;let s=r.content;for(let a=0;a<r.openStart;a++)s=s.firstChild.content;for(let a=1;a<=(r.openStart==0&&r.size?2:1);a++)for(let i=n.depth;i>=0;i--){let o=i==n.depth?0:n.pos<=(n.start(i+1)+n.end(i+1))/2?-1:1,c=n.index(i)+(o>0?1:0),f=n.node(i),h=!1;if(a==1)h=f.canReplace(c,c,s);else{let p=f.contentMatchAt(c).findWrapping(s.firstChild.type);h=p&&f.canReplaceWith(c,c,p[0])}if(h)return o==0?n.pos:o<0?n.before(i+1):n.after(i+1)}return null}function O1(e,t,r=t,n=it.empty){if(t==r&&!n.size)return null;let s=e.resolve(t),a=e.resolve(r);return hF(s,a,n)?new On(t,r,n):new Oue(s,a,n).fit()}function hF(e,t,r){return!r.openStart&&!r.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),r.content)}class Oue{constructor(t,r,n){this.$from=t,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=Ge.empty;for(let s=0;s<=t.depth;s++){let a=t.node(s);this.frontier.push({type:a.type,match:a.contentMatchAt(t.indexAfter(s))})}for(let s=t.depth;s>0;s--)this.placed=Ge.from(t.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let f=this.findFittable();f?this.placeNodes(f):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,s=this.close(t<0?this.$to:n.doc.resolve(t));if(!s)return null;let a=this.placed,i=n.depth,o=s.depth;for(;i&&o&&a.childCount==1;)a=a.firstChild.content,i--,o--;let c=new it(a,i,o);return t>-1?new Fn(n.pos,t,this.$to.pos,this.$to.end(),c,r):c.size||n.pos!=this.$to.pos?new On(n.pos,s.pos,c):null}findFittable(){let t=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,s=this.unplaced.openEnd;n<t;n++){let a=r.firstChild;if(r.childCount>1&&(s=0),a.type.spec.isolating&&s<=n){t=n;break}r=a.content}for(let r=1;r<=2;r++)for(let n=r==1?t:this.unplaced.openStart;n>=0;n--){let s,a=null;n?(a=Vb(this.unplaced.content,n-1).firstChild,s=a.content):s=this.unplaced.content;let i=s.firstChild;for(let o=this.depth;o>=0;o--){let{type:c,match:f}=this.frontier[o],h,p=null;if(r==1&&(i?f.matchType(i.type)||(p=f.fillBefore(Ge.from(i),!1)):a&&c.compatibleContent(a.type)))return{sliceDepth:n,frontierDepth:o,parent:a,inject:p};if(r==2&&i&&(h=f.findWrapping(i.type)))return{sliceDepth:n,frontierDepth:o,parent:a,wrap:h};if(a&&f.matchType(a.type))break}}}openMore(){let{content:t,openStart:r,openEnd:n}=this.unplaced,s=Vb(t,r);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new it(t,r+1,Math.max(n,s.size+r>=t.size-n?r+1:0)),!0)}dropNode(){let{content:t,openStart:r,openEnd:n}=this.unplaced,s=Vb(t,r);if(s.childCount<=1&&r>0){let a=t.size-r<=r+s.size;this.unplaced=new it(Ch(t,r-1,1),r-1,a?r-1:n)}else this.unplaced=new it(Ch(t,r,1),r,n)}placeNodes({sliceDepth:t,frontierDepth:r,parent:n,inject:s,wrap:a}){for(;this.depth>r;)this.closeFrontierNode();if(a)for(let y=0;y<a.length;y++)this.openFrontierNode(a[y]);let i=this.unplaced,o=n?n.content:i.content,c=i.openStart-t,f=0,h=[],{match:p,type:x}=this.frontier[r];if(s){for(let y=0;y<s.childCount;y++)h.push(s.child(y));p=p.matchFragment(s)}let g=o.size+t-(i.content.size-i.openEnd);for(;f<o.childCount;){let y=o.child(f),w=p.matchType(y.type);if(!w)break;f++,(f>1||c==0||y.content.size)&&(p=w,h.push(pF(y.mark(x.allowedMarks(y.marks)),f==1?c:0,f==o.childCount?g:-1)))}let v=f==o.childCount;v||(g=-1),this.placed=Rh(this.placed,r,Ge.from(h)),this.frontier[r].match=p,v&&g<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,w=o;y<g;y++){let _=w.lastChild;this.frontier.push({type:_.type,match:_.contentMatchAt(_.childCount)}),w=_.content}this.unplaced=v?t==0?it.empty:new it(Ch(i.content,t-1,1),t-1,g<0?i.openEnd:t-1):new it(Ch(i.content,t,f),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],r;if(!t.type.isTextblock||!qb(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,s=this.$to.after(n);for(;n>1&&s==this.$to.end(--n);)++s;return s}findCloseLevel(t){e:for(let r=Math.min(this.depth,t.depth);r>=0;r--){let{match:n,type:s}=this.frontier[r],a=r<t.depth&&t.end(r+1)==t.pos+(t.depth-(r+1)),i=qb(t,r,s,n,a);if(i){for(let o=r-1;o>=0;o--){let{match:c,type:f}=this.frontier[o],h=qb(t,o,f,c,!0);if(!h||h.childCount)continue e}return{depth:r,fit:i,move:a?t.doc.resolve(t.after(r+1)):t}}}}close(t){let r=this.findCloseLevel(t);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=Rh(this.placed,r.depth,r.fit)),t=r.move;for(let n=r.depth+1;n<=t.depth;n++){let s=t.node(n),a=s.type.contentMatch.fillBefore(s.content,!0,t.index(n));this.openFrontierNode(s.type,s.attrs,a)}return t}openFrontierNode(t,r=null,n){let s=this.frontier[this.depth];s.match=s.match.matchType(t),this.placed=Rh(this.placed,this.depth,Ge.from(t.create(r,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(Ge.empty,!0);r.childCount&&(this.placed=Rh(this.placed,this.frontier.length,r))}}function Ch(e,t,r){return t==0?e.cutByIndex(r,e.childCount):e.replaceChild(0,e.firstChild.copy(Ch(e.firstChild.content,t-1,r)))}function Rh(e,t,r){return t==0?e.append(r):e.replaceChild(e.childCount-1,e.lastChild.copy(Rh(e.lastChild.content,t-1,r)))}function Vb(e,t){for(let r=0;r<t;r++)e=e.firstChild.content;return e}function pF(e,t,r){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,pF(n.firstChild,t-1,n.childCount==1?r-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(Ge.empty,!0)))),e.copy(n)}function qb(e,t,r,n,s){let a=e.node(t),i=s?e.indexAfter(t):e.index(t);if(i==a.childCount&&!r.compatibleContent(a.type))return null;let o=n.fillBefore(a.content,!0,i);return o&&!Due(r,a.content,i)?o:null}function Due(e,t,r){for(let n=r;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}function Iue(e){return e.spec.defining||e.spec.definingForContent}function Mue(e,t,r,n){if(!n.size)return e.deleteRange(t,r);let s=e.doc.resolve(t),a=e.doc.resolve(r);if(hF(s,a,n))return e.step(new On(t,r,n));let i=xF(s,a);i[i.length-1]==0&&i.pop();let o=-(s.depth+1);i.unshift(o);for(let x=s.depth,g=s.pos-1;x>0;x--,g--){let v=s.node(x).type.spec;if(v.defining||v.definingAsContext||v.isolating)break;i.indexOf(x)>-1?o=x:s.before(x)==g&&i.splice(1,0,-x)}let c=i.indexOf(o),f=[],h=n.openStart;for(let x=n.content,g=0;;g++){let v=x.firstChild;if(f.push(v),g==n.openStart)break;x=v.content}for(let x=h-1;x>=0;x--){let g=f[x],v=Iue(g.type);if(v&&!g.sameMarkup(s.node(Math.abs(o)-1)))h=x;else if(v||!g.type.isTextblock)break}for(let x=n.openStart;x>=0;x--){let g=(x+h+1)%(n.openStart+1),v=f[g];if(v)for(let y=0;y<i.length;y++){let w=i[(y+c)%i.length],_=!0;w<0&&(_=!1,w=-w);let S=s.node(w-1),E=s.index(w-1);if(S.canReplaceWith(E,E,v.type,v.marks))return e.replace(s.before(w),_?a.after(w):r,new it(mF(n.content,0,n.openStart,g),g,n.openEnd))}}let p=e.steps.length;for(let x=i.length-1;x>=0&&(e.replace(t,r,n),!(e.steps.length>p));x--){let g=i[x];g<0||(t=s.before(g),r=a.after(g))}}function mF(e,t,r,n,s){if(t<r){let a=e.firstChild;e=e.replaceChild(0,a.copy(mF(a.content,t+1,r,n,a)))}if(t>n){let a=s.contentMatchAt(0),i=a.fillBefore(e).append(e);e=i.append(a.matchFragment(i).fillBefore(Ge.empty,!0))}return e}function Fue(e,t,r,n){if(!n.isInline&&t==r&&e.doc.resolve(t).parent.content.size){let s=jue(e.doc,t,n.type);s!=null&&(t=r=s)}e.replaceRange(t,r,new it(Ge.from(n),0,0))}function Pue(e,t,r){let n=e.doc.resolve(t),s=e.doc.resolve(r),a=xF(n,s);for(let i=0;i<a.length;i++){let o=a[i],c=i==a.length-1;if(c&&o==0||n.node(o).type.contentMatch.validEnd)return e.delete(n.start(o),s.end(o));if(o>0&&(c||n.node(o-1).canReplace(n.index(o-1),s.indexAfter(o-1))))return e.delete(n.before(o),s.after(o))}for(let i=1;i<=n.depth&&i<=s.depth;i++)if(t-n.start(i)==n.depth-i&&r>n.end(i)&&s.end(i)-r!=s.depth-i&&n.start(i-1)==s.start(i-1)&&n.node(i-1).canReplace(n.index(i-1),s.index(i-1)))return e.delete(n.before(i),r);e.delete(t,r)}function xF(e,t){let r=[],n=Math.min(e.depth,t.depth);for(let s=n;s>=0;s--){let a=e.start(s);if(a<e.pos-(e.depth-s)||t.end(s)>t.pos+(t.depth-s)||e.node(s).type.spec.isolating||t.node(s).type.spec.isolating)break;(a==t.start(s)||s==e.depth&&s==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&s&&t.start(s-1)==a-1)&&r.push(s)}return r}class vf extends ms{constructor(t,r,n){super(),this.pos=t,this.attr=r,this.value=n}apply(t){let r=t.nodeAt(this.pos);if(!r)return xn.fail("No node at attribute step's position");let n=Object.create(null);for(let a in r.attrs)n[a]=r.attrs[a];n[this.attr]=this.value;let s=r.type.create(n,null,r.marks);return xn.fromReplace(t,this.pos,this.pos+1,new it(Ge.from(s),0,r.isLeaf?0:1))}getMap(){return ia.empty}invert(t){return new vf(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new vf(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new vf(r.pos,r.attr,r.value)}}ms.jsonID("attr",vf);class T0 extends ms{constructor(t,r){super(),this.attr=t,this.value=r}apply(t){let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let n=t.type.create(r,t.content,t.marks);return xn.ok(n)}getMap(){return ia.empty}invert(t){return new T0(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new T0(r.attr,r.value)}}ms.jsonID("docAttr",T0);let Lf=class extends Error{};Lf=function e(t){let r=Error.call(this,t);return r.__proto__=e.prototype,r};Lf.prototype=Object.create(Error.prototype);Lf.prototype.constructor=Lf;Lf.prototype.name="TransformError";class gF{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new N0}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let r=this.maybeStep(t);if(r.failed)throw new Lf(r.failed);return this}maybeStep(t){let r=t.apply(this.doc);return r.failed||this.addStep(t,r.doc),r}get docChanged(){return this.steps.length>0}changedRange(){let t=1e9,r=-1e9;for(let n=0;n<this.mapping.maps.length;n++){let s=this.mapping.maps[n];n&&(t=s.map(t,1),r=s.map(r,-1)),s.forEach((a,i,o,c)=>{t=Math.min(t,o),r=Math.max(r,c)})}return t==1e9?null:{from:t,to:r}}addStep(t,r){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=r}replace(t,r=t,n=it.empty){let s=O1(this.doc,t,r,n);return s&&this.step(s),this}replaceWith(t,r,n){return this.replace(t,r,new it(Ge.from(n),0,0))}delete(t,r){return this.replace(t,r,it.empty)}insert(t,r){return this.replaceWith(t,t,r)}replaceRange(t,r,n){return Mue(this,t,r,n),this}replaceRangeWith(t,r,n){return Fue(this,t,r,n),this}deleteRange(t,r){return Pue(this,t,r),this}lift(t,r){return wue(this,t,r),this}join(t,r=1){return Rue(this,t,r),this}wrap(t,r){return Sue(this,t,r),this}setBlockType(t,r=t,n,s=null){return Nue(this,t,r,n,s),this}setNodeMarkup(t,r,n=null,s){return kue(this,t,r,n,s),this}setNodeAttribute(t,r,n){return this.step(new vf(t,r,n)),this}setDocAttribute(t,r){return this.step(new T0(t,r)),this}addNodeMark(t,r){return this.step(new Rl(t,r)),this}removeNodeMark(t,r){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(r instanceof xr)r.isInSet(n.marks)&&this.step(new nu(t,r));else{let s=n.marks,a,i=[];for(;a=r.isInSet(s);)i.push(new nu(t,a)),s=a.removeFromSet(s);for(let o=i.length-1;o>=0;o--)this.step(i[o])}return this}split(t,r=1,n){return Aue(this,t,r,n),this}addMark(t,r,n){return yue(this,t,r,n),this}removeMark(t,r,n){return vue(this,t,r,n),this}clearIncompatible(t,r,n){return zS(this,t,r,n),this}}const Wb=Object.create(null);class It{constructor(t,r,n){this.$anchor=t,this.$head=r,this.ranges=n||[new Lue(t.min(r),t.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let r=0;r<t.length;r++)if(t[r].$from.pos!=t[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,r=it.empty){let n=r.content.lastChild,s=null;for(let o=0;o<r.openEnd;o++)s=n,n=n.lastChild;let a=t.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:c,$to:f}=i[o],h=t.mapping.slice(a);t.replaceRange(h.map(c.pos),h.map(f.pos),o?it.empty:r),o==0&&Z5(t,a,(n?n.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(t,r){let n=t.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:i,$to:o}=s[a],c=t.mapping.slice(n),f=c.map(i.pos),h=c.map(o.pos);a?t.deleteRange(f,h):(t.replaceRangeWith(f,h,r),Z5(t,n,r.isInline?-1:1))}}static findFrom(t,r,n=!1){let s=t.parent.inlineContent?new St(t):lf(t.node(0),t.parent,t.pos,t.index(),r,n);if(s)return s;for(let a=t.depth-1;a>=0;a--){let i=r<0?lf(t.node(0),t.node(a),t.before(a+1),t.index(a),r,n):lf(t.node(0),t.node(a),t.after(a+1),t.index(a)+1,r,n);if(i)return i}return null}static near(t,r=1){return this.findFrom(t,r)||this.findFrom(t,-r)||new la(t.node(0))}static atStart(t){return lf(t,t,0,0,1)||new la(t)}static atEnd(t){return lf(t,t,t.content.size,t.childCount,-1)||new la(t)}static fromJSON(t,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Wb[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(t,r)}static jsonID(t,r){if(t in Wb)throw new RangeError("Duplicate use of selection JSON ID "+t);return Wb[t]=r,r.prototype.jsonID=t,r}getBookmark(){return St.between(this.$anchor,this.$head).getBookmark()}}It.prototype.visible=!0;class Lue{constructor(t,r){this.$from=t,this.$to=r}}let Y5=!1;function J5(e){!Y5&&!e.parent.inlineContent&&(Y5=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class St extends It{constructor(t,r=t){J5(t),J5(r),super(t,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,r){let n=t.resolve(r.map(this.head));if(!n.parent.inlineContent)return It.near(n);let s=t.resolve(r.map(this.anchor));return new St(s.parent.inlineContent?s:n,n)}replace(t,r=it.empty){if(super.replace(t,r),r==it.empty){let n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}}eq(t){return t instanceof St&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new D1(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new St(t.resolve(r.anchor),t.resolve(r.head))}static create(t,r,n=r){let s=t.resolve(r);return new this(s,n==r?s:t.resolve(n))}static between(t,r,n){let s=t.pos-r.pos;if((!n||s)&&(n=s>=0?1:-1),!r.parent.inlineContent){let a=It.findFrom(r,n,!0)||It.findFrom(r,-n,!0);if(a)r=a.$head;else return It.near(r,n)}return t.parent.inlineContent||(s==0?t=r:(t=(It.findFrom(t,-n,!0)||It.findFrom(t,n,!0)).$anchor,t.pos<r.pos!=s<0&&(t=r))),new St(t,r)}}It.jsonID("text",St);class D1{constructor(t,r){this.anchor=t,this.head=r}map(t){return new D1(t.map(this.anchor),t.map(this.head))}resolve(t){return St.between(t.resolve(this.anchor),t.resolve(this.head))}}class xt extends It{constructor(t){let r=t.nodeAfter,n=t.node(0).resolve(t.pos+r.nodeSize);super(t,n),this.node=r}map(t,r){let{deleted:n,pos:s}=r.mapResult(this.anchor),a=t.resolve(s);return n?It.near(a):new xt(a)}content(){return new it(Ge.from(this.node),0,0)}eq(t){return t instanceof xt&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new VS(this.anchor)}static fromJSON(t,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new xt(t.resolve(r.anchor))}static create(t,r){return new xt(t.resolve(r))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}xt.prototype.visible=!1;It.jsonID("node",xt);class VS{constructor(t){this.anchor=t}map(t){let{deleted:r,pos:n}=t.mapResult(this.anchor);return r?new D1(n,n):new VS(n)}resolve(t){let r=t.resolve(this.anchor),n=r.nodeAfter;return n&&xt.isSelectable(n)?new xt(r):It.near(r)}}class la extends It{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,r=it.empty){if(r==it.empty){t.delete(0,t.doc.content.size);let n=It.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else super.replace(t,r)}toJSON(){return{type:"all"}}static fromJSON(t){return new la(t)}map(t){return new la(t)}eq(t){return t instanceof la}getBookmark(){return Bue}}It.jsonID("all",la);const Bue={map(){return this},resolve(e){return new la(e)}};function lf(e,t,r,n,s,a=!1){if(t.inlineContent)return St.create(e,r);for(let i=n-(s>0?0:1);s>0?i<t.childCount:i>=0;i+=s){let o=t.child(i);if(o.isAtom){if(!a&&xt.isSelectable(o))return xt.create(e,r-(s<0?o.nodeSize:0))}else{let c=lf(e,o,r+s,s<0?o.childCount:0,s,a);if(c)return c}r+=o.nodeSize*s}return null}function Z5(e,t,r){let n=e.steps.length-1;if(n<t)return;let s=e.steps[n];if(!(s instanceof On||s instanceof Fn))return;let a=e.mapping.maps[n],i;a.forEach((o,c,f,h)=>{i==null&&(i=h)}),e.setSelection(It.near(e.doc.resolve(i),r))}const Q5=1,Zm=2,eR=4;class Uue extends gF{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Q5)&~Zm,this.storedMarks=null,this}get selectionSet(){return(this.updated&Q5)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=Zm,this}ensureMarks(t){return xr.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Zm)>0}addStep(t,r){super.addStep(t,r),this.updated=this.updated&~Zm,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,r=!0){let n=this.selection;return r&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||xr.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,r,n){let s=this.doc.type.schema;if(r==null)return t?this.replaceSelectionWith(s.text(t),!0):this.deleteSelection();{if(n==null&&(n=r),!t)return this.deleteRange(r,n);let a=this.storedMarks;if(!a){let i=this.doc.resolve(r);a=n==r?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,s.text(t,a)),!this.selection.empty&&this.selection.to==r+t.length&&this.setSelection(It.near(this.selection.$to)),this}}setMeta(t,r){return this.meta[typeof t=="string"?t:t.key]=r,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=eR,this}get scrolledIntoView(){return(this.updated&eR)>0}}function tR(e,t){return!t||!e?e:e.bind(t)}class jh{constructor(t,r,n){this.name=t,this.init=tR(r.init,n),this.apply=tR(r.apply,n)}}const zue=[new jh("doc",{init(e){return e.doc||e.schema.topNodeType.createAndFill()},apply(e){return e.doc}}),new jh("selection",{init(e,t){return e.selection||It.atStart(t.doc)},apply(e){return e.selection}}),new jh("storedMarks",{init(e){return e.storedMarks||null},apply(e,t,r,n){return n.selection.$cursor?e.storedMarks:null}}),new jh("scrollToSelection",{init(){return 0},apply(e,t){return e.scrolledIntoView?t+1:t}})];class $b{constructor(t,r){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=zue.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new jh(n.key,n.spec.state,n))})}}class pf{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let s=this.config.plugins[n];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let r=[t],n=this.applyInner(t),s=null;for(;;){let a=!1;for(let i=0;i<this.config.plugins.length;i++){let o=this.config.plugins[i];if(o.spec.appendTransaction){let c=s?s[i].n:0,f=s?s[i].state:this,h=c<r.length&&o.spec.appendTransaction.call(o,c?r.slice(c):r,f,n);if(h&&n.filterTransaction(h,i)){if(h.setMeta("appendedTransaction",t),!s){s=[];for(let p=0;p<this.config.plugins.length;p++)s.push(p<i?{state:n,n:r.length}:{state:this,n:0})}r.push(h),n=n.applyInner(h),a=!0}s&&(s[i]={state:n,n:r.length})}}if(!a)return{state:n,transactions:r}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new pf(this.config),n=this.config.fields;for(let s=0;s<n.length;s++){let a=n[s];r[a.name]=a.apply(t,this[a.name],this,r)}return r}get tr(){return new Uue(this)}static create(t){let r=new $b(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new pf(r);for(let s=0;s<r.fields.length;s++)n[r.fields[s].name]=r.fields[s].init(t,n);return n}reconfigure(t){let r=new $b(this.schema,t.plugins),n=r.fields,s=new pf(r);for(let a=0;a<n.length;a++){let i=n[a].name;s[i]=this.hasOwnProperty(i)?this[i]:n[a].init(t,s)}return s}toJSON(t){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),t&&typeof t=="object")for(let n in t){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=t[n],a=s.spec.state;a&&a.toJSON&&(r[n]=a.toJSON.call(s,this[s.key]))}return r}static fromJSON(t,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let s=new $b(t.schema,t.plugins),a=new pf(s);return s.fields.forEach(i=>{if(i.name=="doc")a.doc=ui.fromJSON(t.schema,r.doc);else if(i.name=="selection")a.selection=It.fromJSON(a.doc,r.selection);else if(i.name=="storedMarks")r.storedMarks&&(a.storedMarks=r.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let o in n){let c=n[o],f=c.spec.state;if(c.key==i.name&&f&&f.fromJSON&&Object.prototype.hasOwnProperty.call(r,o)){a[i.name]=f.fromJSON.call(c,t,r[o],a);return}}a[i.name]=i.init(t,a)}}),a}}function yF(e,t,r){for(let n in e){let s=e[n];s instanceof Function?s=s.bind(t):n=="handleDOMEvents"&&(s=yF(s,t,{})),r[n]=s}return r}class Fr{constructor(t){this.spec=t,this.props={},t.props&&yF(t.props,this,this.props),this.key=t.key?t.key.key:vF("plugin")}getState(t){return t[this.key]}}const Gb=Object.create(null);function vF(e){return e in Gb?e+"$"+ ++Gb[e]:(Gb[e]=0,e+"$")}class Nn{constructor(t="key"){this.key=vF(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const qS=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function bF(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("backward",e):r.parentOffset>0)?null:r}const wF=(e,t,r)=>{let n=bF(e,r);if(!n)return!1;let s=WS(n);if(!s){let i=n.blockRange(),o=i&&xd(i);return o==null?!1:(t&&t(e.tr.lift(i,o).scrollIntoView()),!0)}let a=s.nodeBefore;if(RF(e,s,t,-1))return!0;if(n.parent.content.size==0&&(Bf(a,"end")||xt.isSelectable(a)))for(let i=n.depth;;i--){let o=O1(e.doc,n.before(i),n.after(i),it.empty);if(o&&o.slice.size<o.to-o.from){if(t){let c=e.tr.step(o);c.setSelection(Bf(a,"end")?It.findFrom(c.doc.resolve(c.mapping.map(s.pos,-1)),-1):xt.create(c.doc,s.pos-a.nodeSize)),t(c.scrollIntoView())}return!0}if(i==1||n.node(i-1).childCount>1)break}return a.isAtom&&s.depth==n.depth-1?(t&&t(e.tr.delete(s.pos-a.nodeSize,s.pos).scrollIntoView()),!0):!1},Hue=(e,t,r)=>{let n=bF(e,r);if(!n)return!1;let s=WS(n);return s?_F(e,s,t):!1},Vue=(e,t,r)=>{let n=SF(e,r);if(!n)return!1;let s=$S(n);return s?_F(e,s,t):!1};function _F(e,t,r){let n=t.nodeBefore,s=n,a=t.pos-1;for(;!s.isTextblock;a--){if(s.type.spec.isolating)return!1;let h=s.lastChild;if(!h)return!1;s=h}let i=t.nodeAfter,o=i,c=t.pos+1;for(;!o.isTextblock;c++){if(o.type.spec.isolating)return!1;let h=o.firstChild;if(!h)return!1;o=h}let f=O1(e.doc,a,c,it.empty);if(!f||f.from!=a||f instanceof On&&f.slice.size>=c-a)return!1;if(r){let h=e.tr.step(f);h.setSelection(St.create(h.doc,a)),r(h.scrollIntoView())}return!0}function Bf(e,t,r=!1){for(let n=e;n;n=t=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const EF=(e,t,r)=>{let{$head:n,empty:s}=e.selection,a=n;if(!s)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",e):n.parentOffset>0)return!1;a=WS(n)}let i=a&&a.nodeBefore;return!i||!xt.isSelectable(i)?!1:(t&&t(e.tr.setSelection(xt.create(e.doc,a.pos-i.nodeSize)).scrollIntoView()),!0)};function WS(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function SF(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)?null:r}const NF=(e,t,r)=>{let n=SF(e,r);if(!n)return!1;let s=$S(n);if(!s)return!1;let a=s.nodeAfter;if(RF(e,s,t,1))return!0;if(n.parent.content.size==0&&(Bf(a,"start")||xt.isSelectable(a))){let i=O1(e.doc,n.before(),n.after(),it.empty);if(i&&i.slice.size<i.to-i.from){if(t){let o=e.tr.step(i);o.setSelection(Bf(a,"start")?It.findFrom(o.doc.resolve(o.mapping.map(s.pos)),1):xt.create(o.doc,o.mapping.map(s.pos))),t(o.scrollIntoView())}return!0}}return a.isAtom&&s.depth==n.depth-1?(t&&t(e.tr.delete(s.pos,s.pos+a.nodeSize).scrollIntoView()),!0):!1},TF=(e,t,r)=>{let{$head:n,empty:s}=e.selection,a=n;if(!s)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;a=$S(n)}let i=a&&a.nodeAfter;return!i||!xt.isSelectable(i)?!1:(t&&t(e.tr.setSelection(xt.create(e.doc,a.pos)).scrollIntoView()),!0)};function $S(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let r=e.node(t);if(e.index(t)+1<r.childCount)return e.doc.resolve(e.after(t+1));if(r.type.spec.isolating)break}return null}const que=(e,t)=>{let r=e.selection,n=r instanceof xt,s;if(n){if(r.node.isTextblock||!Xl(e.doc,r.from))return!1;s=r.from}else if(s=j1(e.doc,r.from,-1),s==null)return!1;if(t){let a=e.tr.join(s);n&&a.setSelection(xt.create(a.doc,s-e.doc.resolve(s).nodeBefore.nodeSize)),t(a.scrollIntoView())}return!0},Wue=(e,t)=>{let r=e.selection,n;if(r instanceof xt){if(r.node.isTextblock||!Xl(e.doc,r.to))return!1;n=r.to}else if(n=j1(e.doc,r.to,1),n==null)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0},$ue=(e,t)=>{let{$from:r,$to:n}=e.selection,s=r.blockRange(n),a=s&&xd(s);return a==null?!1:(t&&t(e.tr.lift(s,a).scrollIntoView()),!0)},kF=(e,t)=>{let{$head:r,$anchor:n}=e.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function GS(e){for(let t=0;t<e.edgeCount;t++){let{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const Gue=(e,t)=>{let{$head:r,$anchor:n}=e.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let s=r.node(-1),a=r.indexAfter(-1),i=GS(s.contentMatchAt(a));if(!i||!s.canReplaceWith(a,a,i))return!1;if(t){let o=r.after(),c=e.tr.replaceWith(o,o,i.createAndFill());c.setSelection(It.near(c.doc.resolve(o),1)),t(c.scrollIntoView())}return!0},AF=(e,t)=>{let r=e.selection,{$from:n,$to:s}=r;if(r instanceof la||n.parent.inlineContent||s.parent.inlineContent)return!1;let a=GS(s.parent.contentMatchAt(s.indexAfter()));if(!a||!a.isTextblock)return!1;if(t){let i=(!n.parentOffset&&s.index()<s.parent.childCount?n:s).pos,o=e.tr.insert(i,a.createAndFill());o.setSelection(St.create(o.doc,i+1)),t(o.scrollIntoView())}return!0},CF=(e,t)=>{let{$cursor:r}=e.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let a=r.before();if(Do(e.doc,a))return t&&t(e.tr.split(a).scrollIntoView()),!0}let n=r.blockRange(),s=n&&xd(n);return s==null?!1:(t&&t(e.tr.lift(n,s).scrollIntoView()),!0)};function Kue(e){return(t,r)=>{let{$from:n,$to:s}=t.selection;if(t.selection instanceof xt&&t.selection.node.isBlock)return!n.parentOffset||!Do(t.doc,n.pos)?!1:(r&&r(t.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let a=[],i,o,c=!1,f=!1;for(let g=n.depth;;g--)if(n.node(g).isBlock){c=n.end(g)==n.pos+(n.depth-g),f=n.start(g)==n.pos-(n.depth-g),o=GS(n.node(g-1).contentMatchAt(n.indexAfter(g-1))),a.unshift(c&&o?{type:o}:null),i=g;break}else{if(g==1)return!1;a.unshift(null)}let h=t.tr;(t.selection instanceof St||t.selection instanceof la)&&h.deleteSelection();let p=h.mapping.map(n.pos),x=Do(h.doc,p,a.length,a);if(x||(a[0]=o?{type:o}:null,x=Do(h.doc,p,a.length,a)),!x)return!1;if(h.split(p,a.length,a),!c&&f&&n.node(i).type!=o){let g=h.mapping.map(n.before(i)),v=h.doc.resolve(g);o&&n.node(i-1).canReplaceWith(v.index(),v.index()+1,o)&&h.setNodeMarkup(h.mapping.map(n.before(i)),o)}return r&&r(h.scrollIntoView()),!0}}const Xue=Kue(),Yue=(e,t)=>{let{$from:r,to:n}=e.selection,s,a=r.sharedDepth(n);return a==0?!1:(s=r.before(a),t&&t(e.tr.setSelection(xt.create(e.doc,s))),!0)};function Jue(e,t,r){let n=t.nodeBefore,s=t.nodeAfter,a=t.index();return!n||!s||!n.type.compatibleContent(s.type)?!1:!n.content.size&&t.parent.canReplace(a-1,a)?(r&&r(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(a,a+1)||!(s.isTextblock||Xl(e.doc,t.pos))?!1:(r&&r(e.tr.join(t.pos).scrollIntoView()),!0)}function RF(e,t,r,n){let s=t.nodeBefore,a=t.nodeAfter,i,o,c=s.type.spec.isolating||a.type.spec.isolating;if(!c&&Jue(e,t,r))return!0;let f=!c&&t.parent.canReplace(t.index(),t.index()+1);if(f&&(i=(o=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&o.matchType(i[0]||a.type).validEnd){if(r){let g=t.pos+a.nodeSize,v=Ge.empty;for(let _=i.length-1;_>=0;_--)v=Ge.from(i[_].create(null,v));v=Ge.from(s.copy(v));let y=e.tr.step(new Fn(t.pos-1,g,t.pos,g,new it(v,1,0),i.length,!0)),w=y.doc.resolve(g+2*i.length);w.nodeAfter&&w.nodeAfter.type==s.type&&Xl(y.doc,w.pos)&&y.join(w.pos),r(y.scrollIntoView())}return!0}let h=a.type.spec.isolating||n>0&&c?null:It.findFrom(t,1),p=h&&h.$from.blockRange(h.$to),x=p&&xd(p);if(x!=null&&x>=t.depth)return r&&r(e.tr.lift(p,x).scrollIntoView()),!0;if(f&&Bf(a,"start",!0)&&Bf(s,"end")){let g=s,v=[];for(;v.push(g),!g.isTextblock;)g=g.lastChild;let y=a,w=1;for(;!y.isTextblock;y=y.firstChild)w++;if(g.canReplace(g.childCount,g.childCount,y.content)){if(r){let _=Ge.empty;for(let E=v.length-1;E>=0;E--)_=Ge.from(v[E].copy(_));let S=e.tr.step(new Fn(t.pos-v.length,t.pos+a.nodeSize,t.pos+w,t.pos+a.nodeSize-w,new it(_,v.length,0),0,!0));r(S.scrollIntoView())}return!0}}return!1}function jF(e){return function(t,r){let n=t.selection,s=e<0?n.$from:n.$to,a=s.depth;for(;s.node(a).isInline;){if(!a)return!1;a--}return s.node(a).isTextblock?(r&&r(t.tr.setSelection(St.create(t.doc,e<0?s.start(a):s.end(a)))),!0):!1}}const Zue=jF(-1),Que=jF(1);function efe(e,t=null){return function(r,n){let{$from:s,$to:a}=r.selection,i=s.blockRange(a),o=i&&HS(i,e,t);return o?(n&&n(r.tr.wrap(i,o).scrollIntoView()),!0):!1}}function rR(e,t=null){return function(r,n){let s=!1;for(let a=0;a<r.selection.ranges.length&&!s;a++){let{$from:{pos:i},$to:{pos:o}}=r.selection.ranges[a];r.doc.nodesBetween(i,o,(c,f)=>{if(s)return!1;if(!(!c.isTextblock||c.hasMarkup(e,t)))if(c.type==e)s=!0;else{let h=r.doc.resolve(f),p=h.index();s=h.parent.canReplaceWith(p,p+1,e)}})}if(!s)return!1;if(n){let a=r.tr;for(let i=0;i<r.selection.ranges.length;i++){let{$from:{pos:o},$to:{pos:c}}=r.selection.ranges[i];a.setBlockType(o,c,e,t)}n(a.scrollIntoView())}return!0}}function KS(...e){return function(t,r,n){for(let s=0;s<e.length;s++)if(e[s](t,r,n))return!0;return!1}}KS(qS,wF,EF);KS(qS,NF,TF);KS(kF,AF,CF,Xue);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function tfe(e,t=null){return function(r,n){let{$from:s,$to:a}=r.selection,i=s.blockRange(a);if(!i)return!1;let o=n?r.tr:null;return rfe(o,i,e,t)?(n&&n(o.scrollIntoView()),!0):!1}}function rfe(e,t,r,n=null){let s=!1,a=t,i=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(r)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let c=i.resolve(t.start-2);a=new hg(c,c,t.depth),t.endIndex<t.parent.childCount&&(t=new hg(t.$from,i.resolve(t.$to.end(t.depth)),t.depth)),s=!0}let o=HS(a,r,n,t);return o?(e&&nfe(e,t,o,s,r),!0):!1}function nfe(e,t,r,n,s){let a=Ge.empty;for(let h=r.length-1;h>=0;h--)a=Ge.from(r[h].type.create(r[h].attrs,a));e.step(new Fn(t.start-(n?2:0),t.end,t.start,t.end,new it(a,0,0),r.length,!0));let i=0;for(let h=0;h<r.length;h++)r[h].type==s&&(i=h+1);let o=r.length-i,c=t.start+r.length-(n?2:0),f=t.parent;for(let h=t.startIndex,p=t.endIndex,x=!0;h<p;h++,x=!1)!x&&Do(e.doc,c,o)&&(e.split(c,o),c+=2*o),c+=f.child(h).nodeSize;return e}function sfe(e){return function(t,r){let{$from:n,$to:s}=t.selection,a=n.blockRange(s,i=>i.childCount>0&&i.firstChild.type==e);return a?r?n.node(a.depth-1).type==e?afe(t,r,e,a):ife(t,r,a):!0:!1}}function afe(e,t,r,n){let s=e.tr,a=n.end,i=n.$to.end(n.depth);a<i&&(s.step(new Fn(a-1,i,a,i,new it(Ge.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new hg(s.doc.resolve(n.$from.pos),s.doc.resolve(i),n.depth));const o=xd(n);if(o==null)return!1;s.lift(n,o);let c=s.doc.resolve(s.mapping.map(a,-1)-1);return Xl(s.doc,c.pos)&&c.nodeBefore.type==c.nodeAfter.type&&s.join(c.pos),t(s.scrollIntoView()),!0}function ife(e,t,r){let n=e.tr,s=r.parent;for(let g=r.end,v=r.endIndex-1,y=r.startIndex;v>y;v--)g-=s.child(v).nodeSize,n.delete(g-1,g+1);let a=n.doc.resolve(r.start),i=a.nodeAfter;if(n.mapping.map(r.end)!=r.start+a.nodeAfter.nodeSize)return!1;let o=r.startIndex==0,c=r.endIndex==s.childCount,f=a.node(-1),h=a.index(-1);if(!f.canReplace(h+(o?0:1),h+1,i.content.append(c?Ge.empty:Ge.from(s))))return!1;let p=a.pos,x=p+i.nodeSize;return n.step(new Fn(p-(o?1:0),x+(c?1:0),p+1,x-1,new it((o?Ge.empty:Ge.from(s.copy(Ge.empty))).append(c?Ge.empty:Ge.from(s.copy(Ge.empty))),o?0:1,c?0:1),o?0:1)),t(n.scrollIntoView()),!0}function ofe(e){return function(t,r){let{$from:n,$to:s}=t.selection,a=n.blockRange(s,f=>f.childCount>0&&f.firstChild.type==e);if(!a)return!1;let i=a.startIndex;if(i==0)return!1;let o=a.parent,c=o.child(i-1);if(c.type!=e)return!1;if(r){let f=c.lastChild&&c.lastChild.type==o.type,h=Ge.from(f?e.create():null),p=new it(Ge.from(e.create(null,Ge.from(o.type.create(null,h)))),f?3:1,0),x=a.start,g=a.end;r(t.tr.step(new Fn(x-(f?3:1),g,x,g,p,1,!0)).scrollIntoView())}return!0}}const Gn=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},Uf=function(e){let t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t};let H_=null;const bo=function(e,t,r){let n=H_||(H_=document.createRange());return n.setEnd(e,r??e.nodeValue.length),n.setStart(e,t||0),n},lfe=function(){H_=null},su=function(e,t,r,n){return r&&(nR(e,t,r,n,-1)||nR(e,t,r,n,1))},cfe=/^(img|br|input|textarea|hr)$/i;function nR(e,t,r,n,s){for(var a;;){if(e==r&&t==n)return!0;if(t==(s<0?0:Fa(e))){let i=e.parentNode;if(!i||i.nodeType!=1||op(e)||cfe.test(e.nodeName)||e.contentEditable=="false")return!1;t=Gn(e)+(s<0?0:1),e=i}else if(e.nodeType==1){let i=e.childNodes[t+(s<0?-1:0)];if(i.nodeType==1&&i.contentEditable=="false")if(!((a=i.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)t+=s;else return!1;else e=i,t=s<0?Fa(e):0}else return!1}}function Fa(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function ufe(e,t){for(;;){if(e.nodeType==3&&t)return e;if(e.nodeType==1&&t>0){if(e.contentEditable=="false")return null;e=e.childNodes[t-1],t=Fa(e)}else if(e.parentNode&&!op(e))t=Gn(e),e=e.parentNode;else return null}}function ffe(e,t){for(;;){if(e.nodeType==3&&t<e.nodeValue.length)return e;if(e.nodeType==1&&t<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[t],t=0}else if(e.parentNode&&!op(e))t=Gn(e)+1,e=e.parentNode;else return null}}function dfe(e,t,r){for(let n=t==0,s=t==Fa(e);n||s;){if(e==r)return!0;let a=Gn(e);if(e=e.parentNode,!e)return!1;n=n&&a==0,s=s&&a==Fa(e)}}function op(e){let t;for(let r=e;r&&!(t=r.pmViewDesc);r=r.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const I1=function(e){return e.focusNode&&su(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function _c(e,t){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=e,r.key=r.code=t,r}function hfe(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function pfe(e,t,r){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,r);if(n)return{node:n.offsetNode,offset:Math.min(Fa(n.offsetNode),n.offset)}}catch{}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,r);if(n)return{node:n.startContainer,offset:Math.min(Fa(n.startContainer),n.startOffset)}}}const Ui=typeof navigator<"u"?navigator:null,sR=typeof document<"u"?document:null,Yl=Ui&&Ui.userAgent||"",V_=/Edge\/(\d+)/.exec(Yl),OF=/MSIE \d/.exec(Yl),q_=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Yl),zs=!!(OF||q_||V_),Il=OF?document.documentMode:q_?+q_[1]:V_?+V_[1]:0,Ua=!zs&&/gecko\/(\d+)/i.test(Yl);Ua&&+(/Firefox\/(\d+)/.exec(Yl)||[0,0])[1];const W_=!zs&&/Chrome\/(\d+)/.exec(Yl),Jn=!!W_,DF=W_?+W_[1]:0,hs=!zs&&!!Ui&&/Apple Computer/.test(Ui.vendor),zf=hs&&(/Mobile\/\w+/.test(Yl)||!!Ui&&Ui.maxTouchPoints>2),Ma=zf||(Ui?/Mac/.test(Ui.platform):!1),IF=Ui?/Win/.test(Ui.platform):!1,No=/Android \d/.test(Yl),lp=!!sR&&"webkitFontSmoothing"in sR.documentElement.style,mfe=lp?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function xfe(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function ho(e,t){return typeof e=="number"?e:e[t]}function gfe(e){let t=e.getBoundingClientRect(),r=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*r,top:t.top,bottom:t.top+e.clientHeight*n}}function aR(e,t,r){let n=e.someProp("scrollThreshold")||0,s=e.someProp("scrollMargin")||5,a=e.dom.ownerDocument;for(let i=r||e.dom;i;){if(i.nodeType!=1){i=Uf(i);continue}let o=i,c=o==a.body,f=c?xfe(a):gfe(o),h=0,p=0;if(t.top<f.top+ho(n,"top")?p=-(f.top-t.top+ho(s,"top")):t.bottom>f.bottom-ho(n,"bottom")&&(p=t.bottom-t.top>f.bottom-f.top?t.top+ho(s,"top")-f.top:t.bottom-f.bottom+ho(s,"bottom")),t.left<f.left+ho(n,"left")?h=-(f.left-t.left+ho(s,"left")):t.right>f.right-ho(n,"right")&&(h=t.right-f.right+ho(s,"right")),h||p)if(c)a.defaultView.scrollBy(h,p);else{let g=o.scrollLeft,v=o.scrollTop;p&&(o.scrollTop+=p),h&&(o.scrollLeft+=h);let y=o.scrollLeft-g,w=o.scrollTop-v;t={left:t.left-y,top:t.top-w,right:t.right-y,bottom:t.bottom-w}}let x=c?"fixed":getComputedStyle(i).position;if(/^(fixed|sticky)$/.test(x))break;i=x=="absolute"?i.offsetParent:Uf(i)}}function yfe(e){let t=e.dom.getBoundingClientRect(),r=Math.max(0,t.top),n,s;for(let a=(t.left+t.right)/2,i=r+1;i<Math.min(innerHeight,t.bottom);i+=5){let o=e.root.elementFromPoint(a,i);if(!o||o==e.dom||!e.dom.contains(o))continue;let c=o.getBoundingClientRect();if(c.top>=r-20){n=o,s=c.top;break}}return{refDOM:n,refTop:s,stack:MF(e.dom)}}function MF(e){let t=[],r=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=r);n=Uf(n));return t}function vfe({refDOM:e,refTop:t,stack:r}){let n=e?e.getBoundingClientRect().top:0;FF(r,n==0?0:n-t)}function FF(e,t){for(let r=0;r<e.length;r++){let{dom:n,top:s,left:a}=e[r];n.scrollTop!=s+t&&(n.scrollTop=s+t),n.scrollLeft!=a&&(n.scrollLeft=a)}}let rf=null;function bfe(e){if(e.setActive)return e.setActive();if(rf)return e.focus(rf);let t=MF(e);e.focus(rf==null?{get preventScroll(){return rf={preventScroll:!0},!0}}:void 0),rf||(rf=!1,FF(t,0))}function PF(e,t){let r,n=2e8,s,a=0,i=t.top,o=t.top,c,f;for(let h=e.firstChild,p=0;h;h=h.nextSibling,p++){let x;if(h.nodeType==1)x=h.getClientRects();else if(h.nodeType==3)x=bo(h).getClientRects();else continue;for(let g=0;g<x.length;g++){let v=x[g];if(v.top<=i&&v.bottom>=o){i=Math.max(v.bottom,i),o=Math.min(v.top,o);let y=v.left>t.left?v.left-t.left:v.right<t.left?t.left-v.right:0;if(y<n){r=h,n=y,s=y&&r.nodeType==3?{left:v.right<t.left?v.right:v.left,top:t.top}:t,h.nodeType==1&&y&&(a=p+(t.left>=(v.left+v.right)/2?1:0));continue}}else v.top>t.top&&!c&&v.left<=t.left&&v.right>=t.left&&(c=h,f={left:Math.max(v.left,Math.min(v.right,t.left)),top:v.top});!r&&(t.left>=v.right&&t.top>=v.top||t.left>=v.left&&t.top>=v.bottom)&&(a=p+1)}}return!r&&c&&(r=c,s=f,n=0),r&&r.nodeType==3?wfe(r,s):!r||n&&r.nodeType==1?{node:e,offset:a}:PF(r,s)}function wfe(e,t){let r=e.nodeValue.length,n=document.createRange(),s;for(let a=0;a<r;a++){n.setEnd(e,a+1),n.setStart(e,a);let i=vl(n,1);if(i.top!=i.bottom&&XS(t,i)){s={node:e,offset:a+(t.left>=(i.left+i.right)/2?1:0)};break}}return n.detach(),s||{node:e,offset:0}}function XS(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function _fe(e,t){let r=e.parentNode;return r&&/^li$/i.test(r.nodeName)&&t.left<e.getBoundingClientRect().left?r:e}function Efe(e,t,r){let{node:n,offset:s}=PF(t,r),a=-1;if(n.nodeType==1&&!n.firstChild){let i=n.getBoundingClientRect();a=i.left!=i.right&&r.left>(i.left+i.right)/2?1:-1}return e.docView.posFromDOM(n,s,a)}function Sfe(e,t,r,n){let s=-1;for(let a=t,i=!1;a!=e.dom;){let o=e.docView.nearestDesc(a,!0),c;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((c=o.dom.getBoundingClientRect()).width||c.height)&&(o.node.isBlock&&o.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(o.dom.nodeName)&&(!i&&c.left>n.left||c.top>n.top?s=o.posBefore:(!i&&c.right<n.left||c.bottom<n.top)&&(s=o.posAfter),i=!0),!o.contentDOM&&s<0&&!o.node.isText))return(o.node.isBlock?n.top<(c.top+c.bottom)/2:n.left<(c.left+c.right)/2)?o.posBefore:o.posAfter;a=o.dom.parentNode}return s>-1?s:e.docView.posFromDOM(t,r,-1)}function LF(e,t,r){let n=e.childNodes.length;if(n&&r.top<r.bottom)for(let s=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-r.top)/(r.bottom-r.top))-2)),a=s;;){let i=e.childNodes[a];if(i.nodeType==1){let o=i.getClientRects();for(let c=0;c<o.length;c++){let f=o[c];if(XS(t,f))return LF(i,t,f)}}if((a=(a+1)%n)==s)break}return e}function Nfe(e,t){let r=e.dom.ownerDocument,n,s=0,a=pfe(r,t.left,t.top);a&&({node:n,offset:s}=a);let i=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top),o;if(!i||!e.dom.contains(i.nodeType!=1?i.parentNode:i)){let f=e.dom.getBoundingClientRect();if(!XS(t,f)||(i=LF(e.dom,t,f),!i))return null}if(hs)for(let f=i;n&&f;f=Uf(f))f.draggable&&(n=void 0);if(i=_fe(i,t),n){if(Ua&&n.nodeType==1&&(s=Math.min(s,n.childNodes.length),s<n.childNodes.length)){let h=n.childNodes[s],p;h.nodeName=="IMG"&&(p=h.getBoundingClientRect()).right<=t.left&&p.bottom>t.top&&s++}let f;lp&&s&&n.nodeType==1&&(f=n.childNodes[s-1]).nodeType==1&&f.contentEditable=="false"&&f.getBoundingClientRect().top>=t.top&&s--,n==e.dom&&s==n.childNodes.length-1&&n.lastChild.nodeType==1&&t.top>n.lastChild.getBoundingClientRect().bottom?o=e.state.doc.content.size:(s==0||n.nodeType!=1||n.childNodes[s-1].nodeName!="BR")&&(o=Sfe(e,n,s,t))}o==null&&(o=Efe(e,i,t));let c=e.docView.nearestDesc(i,!0);return{pos:o,inside:c?c.posAtStart-c.border:-1}}function iR(e){return e.top<e.bottom||e.left<e.right}function vl(e,t){let r=e.getClientRects();if(r.length){let n=r[t<0?0:r.length-1];if(iR(n))return n}return Array.prototype.find.call(r,iR)||e.getBoundingClientRect()}const Tfe=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function BF(e,t,r){let{node:n,offset:s,atom:a}=e.docView.domFromPos(t,r<0?-1:1),i=lp||Ua;if(n.nodeType==3)if(i&&(Tfe.test(n.nodeValue)||(r<0?!s:s==n.nodeValue.length))){let c=vl(bo(n,s,s),r);if(Ua&&s&&/\s/.test(n.nodeValue[s-1])&&s<n.nodeValue.length){let f=vl(bo(n,s-1,s-1),-1);if(f.top==c.top){let h=vl(bo(n,s,s+1),-1);if(h.top!=c.top)return mh(h,h.left<f.left)}}return c}else{let c=s,f=s,h=r<0?1:-1;return r<0&&!s?(f++,h=-1):r>=0&&s==n.nodeValue.length?(c--,h=1):r<0?c--:f++,mh(vl(bo(n,c,f),h),h<0)}if(!e.state.doc.resolve(t-(a||0)).parent.inlineContent){if(a==null&&s&&(r<0||s==Fa(n))){let c=n.childNodes[s-1];if(c.nodeType==1)return Kb(c.getBoundingClientRect(),!1)}if(a==null&&s<Fa(n)){let c=n.childNodes[s];if(c.nodeType==1)return Kb(c.getBoundingClientRect(),!0)}return Kb(n.getBoundingClientRect(),r>=0)}if(a==null&&s&&(r<0||s==Fa(n))){let c=n.childNodes[s-1],f=c.nodeType==3?bo(c,Fa(c)-(i?0:1)):c.nodeType==1&&(c.nodeName!="BR"||!c.nextSibling)?c:null;if(f)return mh(vl(f,1),!1)}if(a==null&&s<Fa(n)){let c=n.childNodes[s];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let f=c?c.nodeType==3?bo(c,0,i?0:1):c.nodeType==1?c:null:null;if(f)return mh(vl(f,-1),!0)}return mh(vl(n.nodeType==3?bo(n):n,-r),r>=0)}function mh(e,t){if(e.width==0)return e;let r=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:r,right:r}}function Kb(e,t){if(e.height==0)return e;let r=t?e.top:e.bottom;return{top:r,bottom:r,left:e.left,right:e.right}}function UF(e,t,r){let n=e.state,s=e.root.activeElement;n!=t&&e.updateState(t),s!=e.dom&&e.focus();try{return r()}finally{n!=t&&e.updateState(n),s!=e.dom&&s&&s.focus()}}function kfe(e,t,r){let n=t.selection,s=r=="up"?n.$from:n.$to;return UF(e,t,()=>{let{node:a}=e.docView.domFromPos(s.pos,r=="up"?-1:1);for(;;){let o=e.docView.nearestDesc(a,!0);if(!o)break;if(o.node.isBlock){a=o.contentDOM||o.dom;break}a=o.dom.parentNode}let i=BF(e,s.pos,1);for(let o=a.firstChild;o;o=o.nextSibling){let c;if(o.nodeType==1)c=o.getClientRects();else if(o.nodeType==3)c=bo(o,0,o.nodeValue.length).getClientRects();else continue;for(let f=0;f<c.length;f++){let h=c[f];if(h.bottom>h.top+1&&(r=="up"?i.top-h.top>(h.bottom-i.top)*2:h.bottom-i.bottom>(i.bottom-h.top)*2))return!1}}return!0})}const Afe=/[\u0590-\u08ac]/;function Cfe(e,t,r){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let s=n.parentOffset,a=!s,i=s==n.parent.content.size,o=e.domSelection();return o?!Afe.test(n.parent.textContent)||!o.modify?r=="left"||r=="backward"?a:i:UF(e,t,()=>{let{focusNode:c,focusOffset:f,anchorNode:h,anchorOffset:p}=e.domSelectionRange(),x=o.caretBidiLevel;o.modify("move",r,"character");let g=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:v,focusOffset:y}=e.domSelectionRange(),w=v&&!g.contains(v.nodeType==1?v:v.parentNode)||c==v&&f==y;try{o.collapse(h,p),c&&(c!=h||f!=p)&&o.extend&&o.extend(c,f)}catch{}return x!=null&&(o.caretBidiLevel=x),w}):n.pos==n.start()||n.pos==n.end()}let oR=null,lR=null,cR=!1;function Rfe(e,t,r){return oR==t&&lR==r?cR:(oR=t,lR=r,cR=r=="up"||r=="down"?kfe(e,t,r):Cfe(e,t,r))}const za=0,uR=1,Tc=2,zi=3;class cp{constructor(t,r,n,s){this.parent=t,this.children=r,this.dom=n,this.contentDOM=s,this.dirty=za,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,r,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let r=0;r<this.children.length;r++)t+=this.children[r].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let r=0,n=this.posAtStart;;r++){let s=this.children[r];if(s==t)return n;n+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,r,n){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(n<0){let a,i;if(t==this.contentDOM)a=t.childNodes[r-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.previousSibling}for(;a&&!((i=a.pmViewDesc)&&i.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(i)+i.size:this.posAtStart}else{let a,i;if(t==this.contentDOM)a=t.childNodes[r];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.nextSibling}for(;a&&!((i=a.pmViewDesc)&&i.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(i):this.posAtEnd}let s;if(t==this.dom&&this.contentDOM)s=r>Gn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let a=t;;a=a.parentNode){if(a==this.dom){s=!1;break}if(a.previousSibling)break}if(s==null&&r==t.childNodes.length)for(let a=t;;a=a.parentNode){if(a==this.dom){s=!0;break}if(a.nextSibling)break}}return s??n>0?this.posAtEnd:this.posAtStart}nearestDesc(t,r=!1){for(let n=!0,s=t;s;s=s.parentNode){let a=this.getDesc(s),i;if(a&&(!r||a.node))if(n&&(i=a.nodeDOM)&&!(i.nodeType==1?i.contains(t.nodeType==1?t:t.parentNode):i==t))n=!1;else return a}}getDesc(t){let r=t.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(t,r,n){for(let s=t;s;s=s.parentNode){let a=this.getDesc(s);if(a)return a.localPosFromDOM(t,r,n)}return-1}descAt(t){for(let r=0,n=0;r<this.children.length;r++){let s=this.children[r],a=n+s.size;if(n==t&&a!=n){for(;!s.border&&s.children.length;)for(let i=0;i<s.children.length;i++){let o=s.children[i];if(o.size){s=o;break}}return s}if(t<a)return s.descAt(t-n-s.border);n=a}}domFromPos(t,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,s=0;for(let a=0;n<this.children.length;n++){let i=this.children[n],o=a+i.size;if(o>t||i instanceof HF){s=t-a;break}a=o}if(s)return this.children[n].domFromPos(s-this.children[n].border,r);for(let a;n&&!(a=this.children[n-1]).size&&a instanceof zF&&a.side>=0;n--);if(r<=0){let a,i=!0;for(;a=n?this.children[n-1]:null,!(!a||a.dom.parentNode==this.contentDOM);n--,i=!1);return a&&r&&i&&!a.border&&!a.domAtom?a.domFromPos(a.size,r):{node:this.contentDOM,offset:a?Gn(a.dom)+1:0}}else{let a,i=!0;for(;a=n<this.children.length?this.children[n]:null,!(!a||a.dom.parentNode==this.contentDOM);n++,i=!1);return a&&i&&!a.border&&!a.domAtom?a.domFromPos(0,r):{node:this.contentDOM,offset:a?Gn(a.dom):this.contentDOM.childNodes.length}}}parseRange(t,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,a=-1;for(let i=n,o=0;;o++){let c=this.children[o],f=i+c.size;if(s==-1&&t<=f){let h=i+c.border;if(t>=h&&r<=f-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(t,r,h);t=i;for(let p=o;p>0;p--){let x=this.children[p-1];if(x.size&&x.dom.parentNode==this.contentDOM&&!x.emptyChildAt(1)){s=Gn(x.dom)+1;break}t-=x.size}s==-1&&(s=0)}if(s>-1&&(f>r||o==this.children.length-1)){r=f;for(let h=o+1;h<this.children.length;h++){let p=this.children[h];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){a=Gn(p.dom);break}r+=p.size}a==-1&&(a=this.contentDOM.childNodes.length);break}i=f}return{node:this.contentDOM,from:t,to:r,fromOffset:s,toOffset:a}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[t<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(t)}domAfterPos(t){let{node:r,offset:n}=this.domFromPos(t,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+t);return r.childNodes[n]}setSelection(t,r,n,s=!1){let a=Math.min(t,r),i=Math.max(t,r);for(let g=0,v=0;g<this.children.length;g++){let y=this.children[g],w=v+y.size;if(a>v&&i<w)return y.setSelection(t-v-y.border,r-v-y.border,n,s);v=w}let o=this.domFromPos(t,t?-1:1),c=r==t?o:this.domFromPos(r,r?-1:1),f=n.root.getSelection(),h=n.domSelectionRange(),p=!1;if((Ua||hs)&&t==r){let{node:g,offset:v}=o;if(g.nodeType==3){if(p=!!(v&&g.nodeValue[v-1]==`
`),p&&v==g.nodeValue.length)for(let y=g,w;y;y=y.parentNode){if(w=y.nextSibling){w.nodeName=="BR"&&(o=c={node:w.parentNode,offset:Gn(w)+1});break}let _=y.pmViewDesc;if(_&&_.node&&_.node.isBlock)break}}else{let y=g.childNodes[v-1];p=y&&(y.nodeName=="BR"||y.contentEditable=="false")}}if(Ua&&h.focusNode&&h.focusNode!=c.node&&h.focusNode.nodeType==1){let g=h.focusNode.childNodes[h.focusOffset];g&&g.contentEditable=="false"&&(s=!0)}if(!(s||p&&hs)&&su(o.node,o.offset,h.anchorNode,h.anchorOffset)&&su(c.node,c.offset,h.focusNode,h.focusOffset))return;let x=!1;if((f.extend||t==r)&&!(p&&Ua)){f.collapse(o.node,o.offset);try{t!=r&&f.extend(c.node,c.offset),x=!0}catch{}}if(!x){if(t>r){let v=o;o=c,c=v}let g=document.createRange();g.setEnd(c.node,c.offset),g.setStart(o.node,o.offset),f.removeAllRanges(),f.addRange(g)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,r){for(let n=0,s=0;s<this.children.length;s++){let a=this.children[s],i=n+a.size;if(n==i?t<=i&&r>=n:t<i&&r>n){let o=n+a.border,c=i-a.border;if(t>=o&&r<=c){this.dirty=t==n||r==i?Tc:uR,t==o&&r==c&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=zi:a.markDirty(t-o,r-o);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?Tc:zi}n=i}this.dirty=Tc}markParentsDirty(){let t=1;for(let r=this.parent;r;r=r.parent,t++){let n=t==1?Tc:uR;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}}class zF extends cp{constructor(t,r,n,s){let a,i=r.type.toDOM;if(typeof i=="function"&&(i=i(n,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)})),!r.type.spec.raw){if(i.nodeType!=1){let o=document.createElement("span");o.appendChild(i),i=o}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(t,[],i,null),this.widget=r,this.widget=r,a=this}matchesWidget(t){return this.dirty==za&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let r=this.widget.spec.stopEvent;return r?r(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class jfe extends cp{constructor(t,r,n,s){super(t,[],r,null),this.textDOM=n,this.text=s}get size(){return this.text.length}localPosFromDOM(t,r){return t!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class au extends cp{constructor(t,r,n,s,a){super(t,[],n,s),this.mark=r,this.spec=a}static create(t,r,n,s){let a=s.nodeViews[r.type.name],i=a&&a(r,s,n);return(!i||!i.dom)&&(i=mu.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new au(t,r,i.dom,i.contentDOM||i.dom,i)}parseRule(){return this.dirty&zi||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=zi&&this.mark.eq(t)}markDirty(t,r){if(super.markDirty(t,r),this.dirty!=za){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=za}}slice(t,r,n){let s=au.create(this.parent,this.mark,!0,n),a=this.children,i=this.size;r<i&&(a=G_(a,r,i,n)),t>0&&(a=G_(a,0,t,n));for(let o=0;o<a.length;o++)a[o].parent=s;return s.children=a,s}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Ml extends cp{constructor(t,r,n,s,a,i,o,c,f){super(t,[],a,i),this.node=r,this.outerDeco=n,this.innerDeco=s,this.nodeDOM=o}static create(t,r,n,s,a,i){let o=a.nodeViews[r.type.name],c,f=o&&o(r,a,()=>{if(!c)return i;if(c.parent)return c.parent.posBeforeChild(c)},n,s),h=f&&f.dom,p=f&&f.contentDOM;if(r.isText){if(!h)h=document.createTextNode(r.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else h||({dom:h,contentDOM:p}=mu.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!p&&!r.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),r.type.spec.draggable&&(h.draggable=!0));let x=h;return h=WF(h,n,r),f?c=new Ofe(t,r,n,s,h,p||null,x,f,a,i+1):r.isText?new M1(t,r,n,s,h,x,a):new Ml(t,r,n,s,h,p||null,x,a,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>Ge.empty)}return t}matchesNode(t,r,n){return this.dirty==za&&t.eq(this.node)&&mg(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,r){let n=this.node.inlineContent,s=r,a=t.composing?this.localCompositionInfo(t,r):null,i=a&&a.pos>-1?a:null,o=a&&a.pos<0,c=new Ife(this,i&&i.node,t);Pfe(this.node,this.innerDeco,(f,h,p)=>{f.spec.marks?c.syncToMarks(f.spec.marks,n,t,h):f.type.side>=0&&!p&&c.syncToMarks(h==this.node.childCount?xr.none:this.node.child(h).marks,n,t,h),c.placeWidget(f,t,s)},(f,h,p,x)=>{c.syncToMarks(f.marks,n,t,x);let g;c.findNodeMatch(f,h,p,x)||o&&t.state.selection.from>s&&t.state.selection.to<s+f.nodeSize&&(g=c.findIndexWithChild(a.node))>-1&&c.updateNodeAt(f,h,p,g,t)||c.updateNextNode(f,h,p,t,x,s)||c.addNode(f,h,p,t,s),s+=f.nodeSize}),c.syncToMarks([],n,t,0),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||this.dirty==Tc)&&(i&&this.protectLocalComposition(t,i),VF(this.contentDOM,this.children,t),zf&&Lfe(this.dom))}localCompositionInfo(t,r){let{from:n,to:s}=t.state.selection;if(!(t.state.selection instanceof St)||n<r||s>r+this.node.content.size)return null;let a=t.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let i=a.nodeValue,o=Bfe(this.node.content,i,n-r,s-r);return o<0?null:{node:a,pos:o,text:i}}else return{node:a,pos:-1,text:""}}protectLocalComposition(t,{node:r,pos:n,text:s}){if(this.getDesc(r))return;let a=r;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let i=new jfe(this,a,r,s);t.input.compositionNodes.push(i),this.children=G_(this.children,n,n+s.length,t,i)}update(t,r,n,s){return this.dirty==zi||!t.sameMarkup(this.node)?!1:(this.updateInner(t,r,n,s),!0)}updateInner(t,r,n,s){this.updateOuterDeco(r),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=za}updateOuterDeco(t){if(mg(t,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=qF(this.dom,this.nodeDOM,$_(this.outerDeco,this.node,r),$_(t,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function fR(e,t,r,n,s){WF(n,t,e);let a=new Ml(void 0,e,t,r,n,n,n,s,0);return a.contentDOM&&a.updateChildren(s,0),a}class M1 extends Ml{constructor(t,r,n,s,a,i,o){super(t,r,n,s,a,null,i,o,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,r,n,s){return this.dirty==zi||this.dirty!=za&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=za||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=t,this.dirty=za,!0)}inParent(){let t=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,r,n){return t==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(t,r,n)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,r,n){let s=this.node.cut(t,r),a=document.createTextNode(s.text);return new M1(this.parent,s,this.outerDeco,this.innerDeco,a,a,n)}markDirty(t,r){super.markDirty(t,r),this.dom!=this.nodeDOM&&(t==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=zi)}get domAtom(){return!1}isText(t){return this.node.text==t}}class HF extends cp{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==za&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Ofe extends Ml{constructor(t,r,n,s,a,i,o,c,f,h){super(t,r,n,s,a,i,o,f,h),this.spec=c}update(t,r,n,s){if(this.dirty==zi)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let a=this.spec.update(t,r,n);return a&&this.updateInner(t,r,n,s),a}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,r,n,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,r,n,s){this.spec.setSelection?this.spec.setSelection(t,r,n.root):super.setSelection(t,r,n,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function VF(e,t,r){let n=e.firstChild,s=!1;for(let a=0;a<t.length;a++){let i=t[a],o=i.dom;if(o.parentNode==e){for(;o!=n;)n=dR(n),s=!0;n=n.nextSibling}else s=!0,e.insertBefore(o,n);if(i instanceof au){let c=n?n.previousSibling:e.lastChild;VF(i.contentDOM,i.children,r),n=c?c.nextSibling:e.firstChild}}for(;n;)n=dR(n),s=!0;s&&r.trackWrites==e&&(r.trackWrites=null)}const Gh=function(e){e&&(this.nodeName=e)};Gh.prototype=Object.create(null);const kc=[new Gh];function $_(e,t,r){if(e.length==0)return kc;let n=r?kc[0]:new Gh,s=[n];for(let a=0;a<e.length;a++){let i=e[a].type.attrs;if(i){i.nodeName&&s.push(n=new Gh(i.nodeName));for(let o in i){let c=i[o];c!=null&&(r&&s.length==1&&s.push(n=new Gh(t.isInline?"span":"div")),o=="class"?n.class=(n.class?n.class+" ":"")+c:o=="style"?n.style=(n.style?n.style+";":"")+c:o!="nodeName"&&(n[o]=c))}}}return s}function qF(e,t,r,n){if(r==kc&&n==kc)return t;let s=t;for(let a=0;a<n.length;a++){let i=n[a],o=r[a];if(a){let c;o&&o.nodeName==i.nodeName&&s!=e&&(c=s.parentNode)&&c.nodeName.toLowerCase()==i.nodeName||(c=document.createElement(i.nodeName),c.pmIsDeco=!0,c.appendChild(s),o=kc[0]),s=c}Dfe(s,o||kc[0],i)}return s}function Dfe(e,t,r){for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&e.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=t[n]&&e.setAttribute(n,r[n]);if(t.class!=r.class){let n=t.class?t.class.split(" ").filter(Boolean):[],s=r.class?r.class.split(" ").filter(Boolean):[];for(let a=0;a<n.length;a++)s.indexOf(n[a])==-1&&e.classList.remove(n[a]);for(let a=0;a<s.length;a++)n.indexOf(s[a])==-1&&e.classList.add(s[a]);e.classList.length==0&&e.removeAttribute("class")}if(t.style!=r.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=n.exec(t.style);)e.style.removeProperty(s[1])}r.style&&(e.style.cssText+=r.style)}}function WF(e,t,r){return qF(e,e,kc,$_(t,r,e.nodeType!=1))}function mg(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].type.eq(t[r].type))return!1;return!0}function dR(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class Ife{constructor(t,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=Mfe(t.node.content,t)}destroyBetween(t,r){if(t!=r){for(let n=t;n<r;n++)this.top.children[n].destroy();this.top.children.splice(t,r-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,r,n,s){let a=0,i=this.stack.length>>1,o=Math.min(i,t.length);for(;a<o&&(a==i-1?this.top:this.stack[a+1<<1]).matchesMark(t[a])&&t[a].type.spec.spanning!==!1;)a++;for(;a<i;)this.destroyRest(),this.top.dirty=za,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<t.length;){this.stack.push(this.top,this.index+1);let c=-1,f=this.top.children.length;s<this.preMatch.index&&(f=Math.min(this.index+3,f));for(let h=this.index;h<f;h++){let p=this.top.children[h];if(p.matchesMark(t[i])&&!this.isLocked(p.dom)){c=h;break}}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{let h=au.create(this.top,t[i],r,n);this.top.children.splice(this.index,0,h),this.top=h,this.changed=!0}this.index=0,i++}}findNodeMatch(t,r,n,s){let a=-1,i;if(s>=this.preMatch.index&&(i=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&i.matchesNode(t,r,n))a=this.top.children.indexOf(i,this.index);else for(let o=this.index,c=Math.min(this.top.children.length,o+5);o<c;o++){let f=this.top.children[o];if(f.matchesNode(t,r,n)&&!this.preMatch.matched.has(f)){a=o;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(t,r,n,s,a){let i=this.top.children[s];return i.dirty==zi&&i.dom==i.contentDOM&&(i.dirty=Tc),i.update(t,r,n,a)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(t){for(;;){let r=t.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=t.pmViewDesc;if(n){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==n)return s}return-1}t=r}}updateNextNode(t,r,n,s,a,i){for(let o=this.index;o<this.top.children.length;o++){let c=this.top.children[o];if(c instanceof Ml){let f=this.preMatch.matched.get(c);if(f!=null&&f!=a)return!1;let h=c.dom,p,x=this.isLocked(h)&&!(t.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==t.text&&c.dirty!=zi&&mg(r,c.outerDeco));if(!x&&c.update(t,r,n,s))return this.destroyBetween(this.index,o),c.dom!=h&&(this.changed=!0),this.index++,!0;if(!x&&(p=this.recreateWrapper(c,t,r,n,s,i)))return this.destroyBetween(this.index,o),this.top.children[this.index]=p,p.contentDOM&&(p.dirty=Tc,p.updateChildren(s,i+1),p.dirty=za),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,r,n,s,a,i){if(t.dirty||r.isAtom||!t.children.length||!t.node.content.eq(r.content)||!mg(n,t.outerDeco)||!s.eq(t.innerDeco))return null;let o=Ml.create(this.top,r,n,s,a,i);if(o.contentDOM){o.children=t.children,t.children=[];for(let c of o.children)c.parent=o}return t.destroy(),o}addNode(t,r,n,s,a){let i=Ml.create(this.top,t,r,n,s,a);i.contentDOM&&i.updateChildren(s,a+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(t,r,n){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(t)&&(t==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let a=new zF(this.top,t,r,n);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],r=this.top;for(;t instanceof au;)r=t,t=r.children[r.children.length-1];(!t||!(t instanceof M1)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((hs||Jn)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(t,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);t=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),t=="BR"&&(n.className="ProseMirror-trailingBreak");let s=new HF(this.top,[],n,null);r!=this.top?r.children.push(s):r.children.splice(this.index++,0,s),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function Mfe(e,t){let r=t,n=r.children.length,s=e.childCount,a=new Map,i=[];e:for(;s>0;){let o;for(;;)if(n){let f=r.children[n-1];if(f instanceof au)r=f,n=f.children.length;else{o=f,n--;break}}else{if(r==t)break e;n=r.parent.children.indexOf(r),r=r.parent}let c=o.node;if(c){if(c!=e.child(s-1))break;--s,a.set(o,s),i.push(o)}}return{index:s,matched:a,matches:i.reverse()}}function Ffe(e,t){return e.type.side-t.type.side}function Pfe(e,t,r,n){let s=t.locals(e),a=0;if(s.length==0){for(let f=0;f<e.childCount;f++){let h=e.child(f);n(h,s,t.forChild(a,h),f),a+=h.nodeSize}return}let i=0,o=[],c=null;for(let f=0;;){let h,p;for(;i<s.length&&s[i].to==a;){let w=s[i++];w.widget&&(h?(p||(p=[h])).push(w):h=w)}if(h)if(p){p.sort(Ffe);for(let w=0;w<p.length;w++)r(p[w],f,!!c)}else r(h,f,!!c);let x,g;if(c)g=-1,x=c,c=null;else if(f<e.childCount)g=f,x=e.child(f++);else break;for(let w=0;w<o.length;w++)o[w].to<=a&&o.splice(w--,1);for(;i<s.length&&s[i].from<=a&&s[i].to>a;)o.push(s[i++]);let v=a+x.nodeSize;if(x.isText){let w=v;i<s.length&&s[i].from<w&&(w=s[i].from);for(let _=0;_<o.length;_++)o[_].to<w&&(w=o[_].to);w<v&&(c=x.cut(w-a),x=x.cut(0,w-a),v=w,g=-1)}else for(;i<s.length&&s[i].to<v;)i++;let y=x.isInline&&!x.isLeaf?o.filter(w=>!w.inline):o.slice();n(x,y,t.forChild(a,x),g),a=v}}function Lfe(e){if(e.nodeName=="UL"||e.nodeName=="OL"){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function Bfe(e,t,r,n){for(let s=0,a=0;s<e.childCount&&a<=n;){let i=e.child(s++),o=a;if(a+=i.nodeSize,!i.isText)continue;let c=i.text;for(;s<e.childCount;){let f=e.child(s++);if(a+=f.nodeSize,!f.isText)break;c+=f.text}if(a>=r){if(a>=n&&c.slice(n-t.length-o,n-o)==t)return n-t.length;let f=o<n?c.lastIndexOf(t,n-o-1):-1;if(f>=0&&f+t.length+o>=r)return o+f;if(r==n&&c.length>=n+t.length-o&&c.slice(n-o,n-o+t.length)==t)return n}}return-1}function G_(e,t,r,n,s){let a=[];for(let i=0,o=0;i<e.length;i++){let c=e[i],f=o,h=o+=c.size;f>=r||h<=t?a.push(c):(f<t&&a.push(c.slice(0,t-f,n)),s&&(a.push(s),s=void 0),h>r&&a.push(c.slice(r-f,c.size,n)))}return a}function YS(e,t=null){let r=e.domSelectionRange(),n=e.state.doc;if(!r.focusNode)return null;let s=e.docView.nearestDesc(r.focusNode),a=s&&s.size==0,i=e.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(i<0)return null;let o=n.resolve(i),c,f;if(I1(r)){for(c=i;s&&!s.node;)s=s.parent;let p=s.node;if(s&&p.isAtom&&xt.isSelectable(p)&&s.parent&&!(p.isInline&&dfe(r.focusNode,r.focusOffset,s.dom))){let x=s.posBefore;f=new xt(i==x?o:n.resolve(x))}}else{if(r instanceof e.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let p=i,x=i;for(let g=0;g<r.rangeCount;g++){let v=r.getRangeAt(g);p=Math.min(p,e.docView.posFromDOM(v.startContainer,v.startOffset,1)),x=Math.max(x,e.docView.posFromDOM(v.endContainer,v.endOffset,-1))}if(p<0)return null;[c,i]=x==e.state.selection.anchor?[x,p]:[p,x],o=n.resolve(i)}else c=e.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(c<0)return null}let h=n.resolve(c);if(!f){let p=t=="pointer"||e.state.selection.head<o.pos&&!a?1:-1;f=JS(e,h,o,p)}return f}function $F(e){return e.editable?e.hasFocus():KF(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Io(e,t=!1){let r=e.state.selection;if(GF(e,r),!!$F(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Jn){let n=e.domSelectionRange(),s=e.domObserver.currentSelection;if(n.anchorNode&&s.anchorNode&&su(n.anchorNode,n.anchorOffset,s.anchorNode,s.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)zfe(e);else{let{anchor:n,head:s}=r,a,i;hR&&!(r instanceof St)&&(r.$from.parent.inlineContent||(a=pR(e,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(i=pR(e,r.to))),e.docView.setSelection(n,s,e,t),hR&&(a&&mR(a),i&&mR(i)),r.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Ufe(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const hR=hs||Jn&&DF<63;function pR(e,t){let{node:r,offset:n}=e.docView.domFromPos(t,0),s=n<r.childNodes.length?r.childNodes[n]:null,a=n?r.childNodes[n-1]:null;if(hs&&s&&s.contentEditable=="false")return Xb(s);if((!s||s.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(s)return Xb(s);if(a)return Xb(a)}}function Xb(e){return e.contentEditable="true",hs&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function mR(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Ufe(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let r=e.domSelectionRange(),n=r.anchorNode,s=r.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=s)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!$F(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function zfe(e){let t=e.domSelection();if(!t)return;let r=e.cursorWrapper.dom,n=r.nodeName=="IMG";n?t.collapse(r.parentNode,Gn(r)+1):t.collapse(r,0),!n&&!e.state.selection.visible&&zs&&Il<=11&&(r.disabled=!0,r.disabled=!1)}function GF(e,t){if(t instanceof xt){let r=e.docView.descAt(t.from);r!=e.lastSelectedViewDesc&&(xR(e),r&&r.selectNode(),e.lastSelectedViewDesc=r)}else xR(e)}function xR(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function JS(e,t,r,n){return e.someProp("createSelectionBetween",s=>s(e,t,r))||St.between(t,r,n)}function gR(e){return e.editable&&!e.hasFocus()?!1:KF(e)}function KF(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function Hfe(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),r=e.domSelectionRange();return su(t.node,t.offset,r.anchorNode,r.anchorOffset)}function K_(e,t){let{$anchor:r,$head:n}=e.selection,s=t>0?r.max(n):r.min(n),a=s.parent.inlineContent?s.depth?e.doc.resolve(t>0?s.after():s.before()):null:s;return a&&It.findFrom(a,t)}function bl(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function yR(e,t,r){let n=e.state.selection;if(n instanceof St)if(r.indexOf("s")>-1){let{$head:s}=n,a=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let i=e.state.doc.resolve(s.pos+a.nodeSize*(t<0?-1:1));return bl(e,new St(n.$anchor,i))}else if(n.empty){if(e.endOfTextblock(t>0?"forward":"backward")){let s=K_(e.state,t);return s&&s instanceof xt?bl(e,s):!1}else if(!(Ma&&r.indexOf("m")>-1)){let s=n.$head,a=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter,i;if(!a||a.isText)return!1;let o=t<0?s.pos-a.nodeSize:s.pos;return a.isAtom||(i=e.docView.descAt(o))&&!i.contentDOM?xt.isSelectable(a)?bl(e,new xt(t<0?e.state.doc.resolve(s.pos-a.nodeSize):s)):lp?bl(e,new St(e.state.doc.resolve(t<0?o:o+a.nodeSize))):!1:!1}}else return!1;else{if(n instanceof xt&&n.node.isInline)return bl(e,new St(t>0?n.$to:n.$from));{let s=K_(e.state,t);return s?bl(e,s):!1}}}function xg(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function Kh(e,t){let r=e.pmViewDesc;return r&&r.size==0&&(t<0||e.nextSibling||e.nodeName!="BR")}function nf(e,t){return t<0?Vfe(e):qfe(e)}function Vfe(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let s,a,i=!1;for(Ua&&r.nodeType==1&&n<xg(r)&&Kh(r.childNodes[n],-1)&&(i=!0);;)if(n>0){if(r.nodeType!=1)break;{let o=r.childNodes[n-1];if(Kh(o,-1))s=r,a=--n;else if(o.nodeType==3)r=o,n=r.nodeValue.length;else break}}else{if(XF(r))break;{let o=r.previousSibling;for(;o&&Kh(o,-1);)s=r.parentNode,a=Gn(o),o=o.previousSibling;if(o)r=o,n=xg(r);else{if(r=r.parentNode,r==e.dom)break;n=0}}}i?X_(e,r,n):s&&X_(e,s,a)}function qfe(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let s=xg(r),a,i;for(;;)if(n<s){if(r.nodeType!=1)break;let o=r.childNodes[n];if(Kh(o,1))a=r,i=++n;else break}else{if(XF(r))break;{let o=r.nextSibling;for(;o&&Kh(o,1);)a=o.parentNode,i=Gn(o)+1,o=o.nextSibling;if(o)r=o,n=0,s=xg(r);else{if(r=r.parentNode,r==e.dom)break;n=s=0}}}a&&X_(e,a,i)}function XF(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function Wfe(e,t){for(;e&&t==e.childNodes.length&&!op(e);)t=Gn(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let r=e.childNodes[t];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;e=r,t=0}}function $fe(e,t){for(;e&&!t&&!op(e);)t=Gn(e),e=e.parentNode;for(;e&&t;){let r=e.childNodes[t-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;e=r,t=e.childNodes.length}}function X_(e,t,r){if(t.nodeType!=3){let a,i;(i=Wfe(t,r))?(t=i,r=0):(a=$fe(t,r))&&(t=a,r=a.nodeValue.length)}let n=e.domSelection();if(!n)return;if(I1(n)){let a=document.createRange();a.setEnd(t,r),a.setStart(t,r),n.removeAllRanges(),n.addRange(a)}else n.extend&&n.extend(t,r);e.domObserver.setCurSelection();let{state:s}=e;setTimeout(()=>{e.state==s&&Io(e)},50)}function vR(e,t){let r=e.state.doc.resolve(t);if(!(Jn||IF)&&r.parent.inlineContent){let s=e.coordsAtPos(t);if(t>r.start()){let a=e.coordsAtPos(t-1),i=(a.top+a.bottom)/2;if(i>s.top&&i<s.bottom&&Math.abs(a.left-s.left)>1)return a.left<s.left?"ltr":"rtl"}if(t<r.end()){let a=e.coordsAtPos(t+1),i=(a.top+a.bottom)/2;if(i>s.top&&i<s.bottom&&Math.abs(a.left-s.left)>1)return a.left>s.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function bR(e,t,r){let n=e.state.selection;if(n instanceof St&&!n.empty||r.indexOf("s")>-1||Ma&&r.indexOf("m")>-1)return!1;let{$from:s,$to:a}=n;if(!s.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let i=K_(e.state,t);if(i&&i instanceof xt)return bl(e,i)}if(!s.parent.inlineContent){let i=t<0?s:a,o=n instanceof la?It.near(i,t):It.findFrom(i,t);return o?bl(e,o):!1}return!1}function wR(e,t){if(!(e.state.selection instanceof St))return!0;let{$head:r,$anchor:n,empty:s}=e.state.selection;if(!r.sameParent(n))return!0;if(!s)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let a=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(a&&!a.isText){let i=e.state.tr;return t<0?i.delete(r.pos-a.nodeSize,r.pos):i.delete(r.pos,r.pos+a.nodeSize),e.dispatch(i),!0}return!1}function _R(e,t,r){e.domObserver.stop(),t.contentEditable=r,e.domObserver.start()}function Gfe(e){if(!hs||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:r}=e.domSelectionRange();if(t&&t.nodeType==1&&r==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let n=t.firstChild;_R(e,n,"true"),setTimeout(()=>_R(e,n,"false"),20)}return!1}function Kfe(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function Xfe(e,t){let r=t.keyCode,n=Kfe(t);if(r==8||Ma&&r==72&&n=="c")return wR(e,-1)||nf(e,-1);if(r==46&&!t.shiftKey||Ma&&r==68&&n=="c")return wR(e,1)||nf(e,1);if(r==13||r==27)return!0;if(r==37||Ma&&r==66&&n=="c"){let s=r==37?vR(e,e.state.selection.from)=="ltr"?-1:1:-1;return yR(e,s,n)||nf(e,s)}else if(r==39||Ma&&r==70&&n=="c"){let s=r==39?vR(e,e.state.selection.from)=="ltr"?1:-1:1;return yR(e,s,n)||nf(e,s)}else{if(r==38||Ma&&r==80&&n=="c")return bR(e,-1,n)||nf(e,-1);if(r==40||Ma&&r==78&&n=="c")return Gfe(e)||bR(e,1,n)||nf(e,1);if(n==(Ma?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function ZS(e,t){e.someProp("transformCopied",g=>{t=g(t,e)});let r=[],{content:n,openStart:s,openEnd:a}=t;for(;s>1&&a>1&&n.childCount==1&&n.firstChild.childCount==1;){s--,a--;let g=n.firstChild;r.push(g.type.name,g.attrs!=g.type.defaultAttrs?g.attrs:null),n=g.content}let i=e.someProp("clipboardSerializer")||mu.fromSchema(e.state.schema),o=tP(),c=o.createElement("div");c.appendChild(i.serializeFragment(n,{document:o}));let f=c.firstChild,h,p=0;for(;f&&f.nodeType==1&&(h=eP[f.nodeName.toLowerCase()]);){for(let g=h.length-1;g>=0;g--){let v=o.createElement(h[g]);for(;c.firstChild;)v.appendChild(c.firstChild);c.appendChild(v),p++}f=c.firstChild}f&&f.nodeType==1&&f.setAttribute("data-pm-slice",`${s} ${a}${p?` -${p}`:""} ${JSON.stringify(r)}`);let x=e.someProp("clipboardTextSerializer",g=>g(t,e))||t.content.textBetween(0,t.content.size,`

`);return{dom:c,text:x,slice:t}}function YF(e,t,r,n,s){let a=s.parent.type.spec.code,i,o;if(!r&&!t)return null;let c=!!t&&(n||a||!r);if(c){if(e.someProp("transformPastedText",x=>{t=x(t,a||n,e)}),a)return o=new it(Ge.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),e.someProp("transformPasted",x=>{o=x(o,e,!0)}),o;let p=e.someProp("clipboardTextParser",x=>x(t,s,n,e));if(p)o=p;else{let x=s.marks(),{schema:g}=e.state,v=mu.fromSchema(g);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(y=>{let w=i.appendChild(document.createElement("p"));y&&w.appendChild(v.serializeNode(g.text(y,x)))})}}else e.someProp("transformPastedHTML",p=>{r=p(r,e)}),i=Qfe(r),lp&&ede(i);let f=i&&i.querySelector("[data-pm-slice]"),h=f&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(f.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let p=+h[3];p>0;p--){let x=i.firstChild;for(;x&&x.nodeType!=1;)x=x.nextSibling;if(!x)break;i=x}if(o||(o=(e.someProp("clipboardParser")||e.someProp("domParser")||Dl.fromSchema(e.state.schema)).parseSlice(i,{preserveWhitespace:!!(c||h),context:s,ruleFromNode(x){return x.nodeName=="BR"&&!x.nextSibling&&x.parentNode&&!Yfe.test(x.parentNode.nodeName)?{ignore:!0}:null}})),h)o=tde(ER(o,+h[1],+h[2]),h[4]);else if(o=it.maxOpen(Jfe(o.content,s),!0),o.openStart||o.openEnd){let p=0,x=0;for(let g=o.content.firstChild;p<o.openStart&&!g.type.spec.isolating;p++,g=g.firstChild);for(let g=o.content.lastChild;x<o.openEnd&&!g.type.spec.isolating;x++,g=g.lastChild);o=ER(o,p,x)}return e.someProp("transformPasted",p=>{o=p(o,e,c)}),o}const Yfe=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Jfe(e,t){if(e.childCount<2)return e;for(let r=t.depth;r>=0;r--){let s=t.node(r).contentMatchAt(t.index(r)),a,i=[];if(e.forEach(o=>{if(!i)return;let c=s.findWrapping(o.type),f;if(!c)return i=null;if(f=i.length&&a.length&&ZF(c,a,o,i[i.length-1],0))i[i.length-1]=f;else{i.length&&(i[i.length-1]=QF(i[i.length-1],a.length));let h=JF(o,c);i.push(h),s=s.matchType(h.type),a=c}}),i)return Ge.from(i)}return e}function JF(e,t,r=0){for(let n=t.length-1;n>=r;n--)e=t[n].create(null,Ge.from(e));return e}function ZF(e,t,r,n,s){if(s<e.length&&s<t.length&&e[s]==t[s]){let a=ZF(e,t,r,n.lastChild,s+1);if(a)return n.copy(n.content.replaceChild(n.childCount-1,a));if(n.contentMatchAt(n.childCount).matchType(s==e.length-1?r.type:e[s+1]))return n.copy(n.content.append(Ge.from(JF(r,e,s+1))))}}function QF(e,t){if(t==0)return e;let r=e.content.replaceChild(e.childCount-1,QF(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(Ge.empty,!0);return e.copy(r.append(n))}function Y_(e,t,r,n,s,a){let i=t<0?e.firstChild:e.lastChild,o=i.content;return e.childCount>1&&(a=0),s<n-1&&(o=Y_(o,t,r,n,s+1,a)),s>=r&&(o=t<0?i.contentMatchAt(0).fillBefore(o,a<=s).append(o):o.append(i.contentMatchAt(i.childCount).fillBefore(Ge.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,i.copy(o))}function ER(e,t,r){return t<e.openStart&&(e=new it(Y_(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),r<e.openEnd&&(e=new it(Y_(e.content,1,r,e.openEnd,0,0),e.openStart,r)),e}const eP={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let SR=null;function tP(){return SR||(SR=document.implementation.createHTMLDocument("title"))}let Yb=null;function Zfe(e){let t=window.trustedTypes;return t?(Yb||(Yb=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),Yb.createHTML(e)):e}function Qfe(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let r=tP().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(e),s;if((s=n&&eP[n[1].toLowerCase()])&&(e=s.map(a=>"<"+a+">").join("")+e+s.map(a=>"</"+a+">").reverse().join("")),r.innerHTML=Zfe(e),s)for(let a=0;a<s.length;a++)r=r.querySelector(s[a])||r;return r}function ede(e){let t=e.querySelectorAll(Jn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<t.length;r++){let n=t[r];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}function tde(e,t){if(!e.size)return e;let r=e.content.firstChild.type.schema,n;try{n=JSON.parse(t)}catch{return e}let{content:s,openStart:a,openEnd:i}=e;for(let o=n.length-2;o>=0;o-=2){let c=r.nodes[n[o]];if(!c||c.hasRequiredAttrs())break;s=Ge.from(c.create(n[o+1],s)),a++,i++}return new it(s,a,i)}const Ts={},ks={},rde={touchstart:!0,touchmove:!0};class nde{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function sde(e){for(let t in Ts){let r=Ts[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=n=>{ide(e,n)&&!QS(e,n)&&(e.editable||!(n.type in ks))&&r(e,n)},rde[t]?{passive:!0}:void 0)}hs&&e.dom.addEventListener("input",()=>null),J_(e)}function jl(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function ade(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function J_(e){e.someProp("handleDOMEvents",t=>{for(let r in t)e.input.eventHandlers[r]||e.dom.addEventListener(r,e.input.eventHandlers[r]=n=>QS(e,n))})}function QS(e,t){return e.someProp("handleDOMEvents",r=>{let n=r[t.type];return n?n(e,t)||t.defaultPrevented:!1})}function ide(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let r=t.target;r!=e.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(t))return!1;return!0}function ode(e,t){!QS(e,t)&&Ts[t.type]&&(e.editable||!(t.type in ks))&&Ts[t.type](e,t)}ks.keydown=(e,t)=>{let r=t;if(e.input.shiftKey=r.keyCode==16||r.shiftKey,!nP(e,r)&&(e.input.lastKeyCode=r.keyCode,e.input.lastKeyCodeTime=Date.now(),!(No&&Jn&&r.keyCode==13)))if(r.keyCode!=229&&e.domObserver.forceFlush(),zf&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();e.input.lastIOSEnter=n,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==n&&(e.someProp("handleKeyDown",s=>s(e,_c(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",n=>n(e,r))||Xfe(e,r)?r.preventDefault():jl(e,"key")};ks.keyup=(e,t)=>{t.keyCode==16&&(e.input.shiftKey=!1)};ks.keypress=(e,t)=>{let r=t;if(nP(e,r)||!r.charCode||r.ctrlKey&&!r.altKey||Ma&&r.metaKey)return;if(e.someProp("handleKeyPress",s=>s(e,r))){r.preventDefault();return}let n=e.state.selection;if(!(n instanceof St)||!n.$from.sameParent(n.$to)){let s=String.fromCharCode(r.charCode),a=()=>e.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!e.someProp("handleTextInput",i=>i(e,n.$from.pos,n.$to.pos,s,a))&&e.dispatch(a()),r.preventDefault()}};function F1(e){return{left:e.clientX,top:e.clientY}}function lde(e,t){let r=t.x-e.clientX,n=t.y-e.clientY;return r*r+n*n<100}function eN(e,t,r,n,s){if(n==-1)return!1;let a=e.state.doc.resolve(n);for(let i=a.depth+1;i>0;i--)if(e.someProp(t,o=>i>a.depth?o(e,r,a.nodeAfter,a.before(i),s,!0):o(e,r,a.node(i),a.before(i),s,!1)))return!0;return!1}function bf(e,t,r){if(e.focused||e.focus(),e.state.selection.eq(t))return;let n=e.state.tr.setSelection(t);n.setMeta("pointer",!0),e.dispatch(n)}function cde(e,t){if(t==-1)return!1;let r=e.state.doc.resolve(t),n=r.nodeAfter;return n&&n.isAtom&&xt.isSelectable(n)?(bf(e,new xt(r)),!0):!1}function ude(e,t){if(t==-1)return!1;let r=e.state.selection,n,s;r instanceof xt&&(n=r.node);let a=e.state.doc.resolve(t);for(let i=a.depth+1;i>0;i--){let o=i>a.depth?a.nodeAfter:a.node(i);if(xt.isSelectable(o)){n&&r.$from.depth>0&&i>=r.$from.depth&&a.before(r.$from.depth+1)==r.$from.pos?s=a.before(r.$from.depth):s=a.before(i);break}}return s!=null?(bf(e,xt.create(e.state.doc,s)),!0):!1}function fde(e,t,r,n,s){return eN(e,"handleClickOn",t,r,n)||e.someProp("handleClick",a=>a(e,t,n))||(s?ude(e,r):cde(e,r))}function dde(e,t,r,n){return eN(e,"handleDoubleClickOn",t,r,n)||e.someProp("handleDoubleClick",s=>s(e,t,n))}function hde(e,t,r,n){return eN(e,"handleTripleClickOn",t,r,n)||e.someProp("handleTripleClick",s=>s(e,t,n))||pde(e,r,n)}function pde(e,t,r){if(r.button!=0)return!1;let n=e.state.doc;if(t==-1)return n.inlineContent?(bf(e,St.create(n,0,n.content.size)),!0):!1;let s=n.resolve(t);for(let a=s.depth+1;a>0;a--){let i=a>s.depth?s.nodeAfter:s.node(a),o=s.before(a);if(i.inlineContent)bf(e,St.create(n,o+1,o+1+i.content.size));else if(xt.isSelectable(i))bf(e,xt.create(n,o));else continue;return!0}}function tN(e){return gg(e)}const rP=Ma?"metaKey":"ctrlKey";Ts.mousedown=(e,t)=>{let r=t;e.input.shiftKey=r.shiftKey;let n=tN(e),s=Date.now(),a="singleClick";s-e.input.lastClick.time<500&&lde(r,e.input.lastClick)&&!r[rP]&&e.input.lastClick.button==r.button&&(e.input.lastClick.type=="singleClick"?a="doubleClick":e.input.lastClick.type=="doubleClick"&&(a="tripleClick")),e.input.lastClick={time:s,x:r.clientX,y:r.clientY,type:a,button:r.button};let i=e.posAtCoords(F1(r));i&&(a=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new mde(e,i,r,!!n)):(a=="doubleClick"?dde:hde)(e,i.pos,i.inside,r)?r.preventDefault():jl(e,"pointer"))};class mde{constructor(t,r,n,s){this.view=t,this.pos=r,this.event=n,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[rP],this.allowDefault=n.shiftKey;let a,i;if(r.inside>-1)a=t.state.doc.nodeAt(r.inside),i=r.inside;else{let h=t.state.doc.resolve(r.pos);a=h.parent,i=h.depth?h.before():0}const o=s?null:n.target,c=o?t.docView.nearestDesc(o,!0):null;this.target=c&&c.nodeDOM.nodeType==1?c.nodeDOM:null;let{selection:f}=t.state;(n.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||f instanceof xt&&f.from<=i&&f.to>i)&&(this.mightDrag={node:a,pos:i,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ua&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),jl(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Io(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(F1(t))),this.updateAllowDefault(t),this.allowDefault||!r?jl(this.view,"pointer"):fde(this.view,r.pos,r.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||hs&&this.mightDrag&&!this.mightDrag.node.isAtom||Jn&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(bf(this.view,It.near(this.view.state.doc.resolve(r.pos))),t.preventDefault()):jl(this.view,"pointer")}move(t){this.updateAllowDefault(t),jl(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}Ts.touchstart=e=>{e.input.lastTouch=Date.now(),tN(e),jl(e,"pointer")};Ts.touchmove=e=>{e.input.lastTouch=Date.now(),jl(e,"pointer")};Ts.contextmenu=e=>tN(e);function nP(e,t){return e.composing?!0:hs&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}const xde=No?5e3:-1;ks.compositionstart=ks.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,r=t.selection.$to;if(t.selection instanceof St&&(t.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)||Jn&&IF&&gde(e)))e.markCursor=e.state.storedMarks||r.marks(),gg(e,!0),e.markCursor=null;else if(gg(e,!t.selection.empty),Ua&&t.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=e.domSelectionRange();for(let s=n.focusNode,a=n.focusOffset;s&&s.nodeType==1&&a!=0;){let i=a<0?s.lastChild:s.childNodes[a-1];if(!i)break;if(i.nodeType==3){let o=e.domSelection();o&&o.collapse(i,i.nodeValue.length);break}else s=i,a=-1}}e.input.composing=!0}sP(e,xde)};function gde(e){let{focusNode:t,focusOffset:r}=e.domSelectionRange();if(!t||t.nodeType!=1||r>=t.childNodes.length)return!1;let n=t.childNodes[r];return n.nodeType==1&&n.contentEditable=="false"}ks.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.badSafariComposition?e.domObserver.forceFlush():e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,sP(e,20))};function sP(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>gg(e),t))}function aP(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=vde());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function yde(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let r=ufe(t.focusNode,t.focusOffset),n=ffe(t.focusNode,t.focusOffset);if(r&&n&&r!=n){let s=n.pmViewDesc,a=e.domObserver.lastChangedTextNode;if(r==a||n==a)return a;if(!s||!s.isText(n.nodeValue))return n;if(e.input.compositionNode==n){let i=r.pmViewDesc;if(!(!i||!i.isText(r.nodeValue)))return n}}return r||n}function vde(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function gg(e,t=!1){if(!(No&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),aP(e),t||e.docView&&e.docView.dirty){let r=YS(e),n=e.state.selection;return r&&!r.eq(n)?e.dispatch(e.state.tr.setSelection(r)):(e.markCursor||t)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}function bde(e,t){if(!e.dom.parentNode)return;let r=e.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(t),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),s=document.createRange();s.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(s),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),e.focus()},50)}const k0=zs&&Il<15||zf&&mfe<604;Ts.copy=ks.cut=(e,t)=>{let r=t,n=e.state.selection,s=r.type=="cut";if(n.empty)return;let a=k0?null:r.clipboardData,i=n.content(),{dom:o,text:c}=ZS(e,i);a?(r.preventDefault(),a.clearData(),a.setData("text/html",o.innerHTML),a.setData("text/plain",c)):bde(e,o),s&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function wde(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function _de(e,t){if(!e.dom.parentNode)return;let r=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let s=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),r?A0(e,n.value,null,s,t):A0(e,n.textContent,n.innerHTML,s,t)},50)}function A0(e,t,r,n,s){let a=YF(e,t,r,n,e.state.selection.$from);if(e.someProp("handlePaste",c=>c(e,s,a||it.empty)))return!0;if(!a)return!1;let i=wde(a),o=i?e.state.tr.replaceSelectionWith(i,n):e.state.tr.replaceSelection(a);return e.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function iP(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let r=e.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}ks.paste=(e,t)=>{let r=t;if(e.composing&&!No)return;let n=k0?null:r.clipboardData,s=e.input.shiftKey&&e.input.lastKeyCode!=45;n&&A0(e,iP(n),n.getData("text/html"),s,r)?r.preventDefault():_de(e,r)};class oP{constructor(t,r,n){this.slice=t,this.move=r,this.node=n}}const Ede=Ma?"altKey":"ctrlKey";function lP(e,t){let r=e.someProp("dragCopies",n=>!n(t));return r??!t[Ede]}Ts.dragstart=(e,t)=>{let r=t,n=e.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let s=e.state.selection,a=s.empty?null:e.posAtCoords(F1(r)),i;if(!(a&&a.pos>=s.from&&a.pos<=(s instanceof xt?s.to-1:s.to))){if(n&&n.mightDrag)i=xt.create(e.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let p=e.docView.nearestDesc(r.target,!0);p&&p.node.type.spec.draggable&&p!=e.docView&&(i=xt.create(e.state.doc,p.posBefore))}}let o=(i||e.state.selection).content(),{dom:c,text:f,slice:h}=ZS(e,o);(!r.dataTransfer.files.length||!Jn||DF>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(k0?"Text":"text/html",c.innerHTML),r.dataTransfer.effectAllowed="copyMove",k0||r.dataTransfer.setData("text/plain",f),e.dragging=new oP(h,lP(e,r),i)};Ts.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)};ks.dragover=ks.dragenter=(e,t)=>t.preventDefault();ks.drop=(e,t)=>{try{Sde(e,t,e.dragging)}finally{e.dragging=null}};function Sde(e,t,r){if(!t.dataTransfer)return;let n=e.posAtCoords(F1(t));if(!n)return;let s=e.state.doc.resolve(n.pos),a=r&&r.slice;a?e.someProp("transformPasted",g=>{a=g(a,e,!1)}):a=YF(e,iP(t.dataTransfer),k0?null:t.dataTransfer.getData("text/html"),!1,s);let i=!!(r&&lP(e,t));if(e.someProp("handleDrop",g=>g(e,t,a||it.empty,i))){t.preventDefault();return}if(!a)return;t.preventDefault();let o=a?dF(e.state.doc,s.pos,a):s.pos;o==null&&(o=s.pos);let c=e.state.tr;if(i){let{node:g}=r;g?g.replace(c):c.deleteSelection()}let f=c.mapping.map(o),h=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,p=c.doc;if(h?c.replaceRangeWith(f,f,a.content.firstChild):c.replaceRange(f,f,a),c.doc.eq(p))return;let x=c.doc.resolve(f);if(h&&xt.isSelectable(a.content.firstChild)&&x.nodeAfter&&x.nodeAfter.sameMarkup(a.content.firstChild))c.setSelection(new xt(x));else{let g=c.mapping.map(o);c.mapping.maps[c.mapping.maps.length-1].forEach((v,y,w,_)=>g=_),c.setSelection(JS(e,x,c.doc.resolve(g)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))}Ts.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Io(e)},20))};Ts.blur=(e,t)=>{let r=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),r.relatedTarget&&e.dom.contains(r.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};Ts.beforeinput=(e,t)=>{if(Jn&&No&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:n}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=n||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",a=>a(e,_c(8,"Backspace")))))return;let{$cursor:s}=e.state.selection;s&&s.pos>0&&e.dispatch(e.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let e in ks)Ts[e]=ks[e];function C0(e,t){if(e==t)return!0;for(let r in e)if(e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0}class yg{constructor(t,r){this.toDOM=t,this.spec=r||zc,this.side=this.spec.side||0}map(t,r,n,s){let{pos:a,deleted:i}=t.mapResult(r.from+s,this.side<0?-1:1);return i?null:new ws(a-n,a-n,this)}valid(){return!0}eq(t){return this==t||t instanceof yg&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&C0(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Fl{constructor(t,r){this.attrs=t,this.spec=r||zc}map(t,r,n,s){let a=t.map(r.from+s,this.spec.inclusiveStart?-1:1)-n,i=t.map(r.to+s,this.spec.inclusiveEnd?1:-1)-n;return a>=i?null:new ws(a,i,this)}valid(t,r){return r.from<r.to}eq(t){return this==t||t instanceof Fl&&C0(this.attrs,t.attrs)&&C0(this.spec,t.spec)}static is(t){return t.type instanceof Fl}destroy(){}}class rN{constructor(t,r){this.attrs=t,this.spec=r||zc}map(t,r,n,s){let a=t.mapResult(r.from+s,1);if(a.deleted)return null;let i=t.mapResult(r.to+s,-1);return i.deleted||i.pos<=a.pos?null:new ws(a.pos-n,i.pos-n,this)}valid(t,r){let{index:n,offset:s}=t.content.findIndex(r.from),a;return s==r.from&&!(a=t.child(n)).isText&&s+a.nodeSize==r.to}eq(t){return this==t||t instanceof rN&&C0(this.attrs,t.attrs)&&C0(this.spec,t.spec)}destroy(){}}class ws{constructor(t,r,n){this.from=t,this.to=r,this.type=n}copy(t,r){return new ws(t,r,this.type)}eq(t,r=0){return this.type.eq(t.type)&&this.from+r==t.from&&this.to+r==t.to}map(t,r,n){return this.type.map(t,this,r,n)}static widget(t,r,n){return new ws(t,t,new yg(r,n))}static inline(t,r,n,s){return new ws(t,r,new Fl(n,s))}static node(t,r,n,s){return new ws(t,r,new rN(n,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Fl}get widget(){return this.type instanceof yg}}const cf=[],zc={};class Or{constructor(t,r){this.local=t.length?t:cf,this.children=r.length?r:cf}static create(t,r){return r.length?vg(r,t,0,zc):ns}find(t,r,n){let s=[];return this.findInner(t??0,r??1e9,s,0,n),s}findInner(t,r,n,s,a){for(let i=0;i<this.local.length;i++){let o=this.local[i];o.from<=r&&o.to>=t&&(!a||a(o.spec))&&n.push(o.copy(o.from+s,o.to+s))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<r&&this.children[i+1]>t){let o=this.children[i]+1;this.children[i+2].findInner(t-o,r-o,n,s+o,a)}}map(t,r,n){return this==ns||t.maps.length==0?this:this.mapInner(t,r,0,0,n||zc)}mapInner(t,r,n,s,a){let i;for(let o=0;o<this.local.length;o++){let c=this.local[o].map(t,n,s);c&&c.type.valid(r,c)?(i||(i=[])).push(c):a.onRemove&&a.onRemove(this.local[o].spec)}return this.children.length?Nde(this.children,i||[],t,r,n,s,a):i?new Or(i.sort(Hc),cf):ns}add(t,r){return r.length?this==ns?Or.create(t,r):this.addInner(t,r,0):this}addInner(t,r,n){let s,a=0;t.forEach((o,c)=>{let f=c+n,h;if(h=uP(r,o,f)){for(s||(s=this.children.slice());a<s.length&&s[a]<c;)a+=3;s[a]==c?s[a+2]=s[a+2].addInner(o,h,f+1):s.splice(a,0,c,c+o.nodeSize,vg(h,o,f+1,zc)),a+=3}});let i=cP(a?fP(r):r,-n);for(let o=0;o<i.length;o++)i[o].type.valid(t,i[o])||i.splice(o--,1);return new Or(i.length?this.local.concat(i).sort(Hc):this.local,s||this.children)}remove(t){return t.length==0||this==ns?this:this.removeInner(t,0)}removeInner(t,r){let n=this.children,s=this.local;for(let a=0;a<n.length;a+=3){let i,o=n[a]+r,c=n[a+1]+r;for(let h=0,p;h<t.length;h++)(p=t[h])&&p.from>o&&p.to<c&&(t[h]=null,(i||(i=[])).push(p));if(!i)continue;n==this.children&&(n=this.children.slice());let f=n[a+2].removeInner(i,o+1);f!=ns?n[a+2]=f:(n.splice(a,3),a-=3)}if(s.length){for(let a=0,i;a<t.length;a++)if(i=t[a])for(let o=0;o<s.length;o++)s[o].eq(i,r)&&(s==this.local&&(s=this.local.slice()),s.splice(o--,1))}return n==this.children&&s==this.local?this:s.length||n.length?new Or(s,n):ns}forChild(t,r){if(this==ns)return this;if(r.isLeaf)return Or.empty;let n,s;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(n=this.children[o+2]);break}let a=t+1,i=a+r.content.size;for(let o=0;o<this.local.length;o++){let c=this.local[o];if(c.from<i&&c.to>a&&c.type instanceof Fl){let f=Math.max(a,c.from)-a,h=Math.min(i,c.to)-a;f<h&&(s||(s=[])).push(c.copy(f,h))}}if(s){let o=new Or(s.sort(Hc),cf);return n?new Sl([o,n]):o}return n||ns}eq(t){if(this==t)return!0;if(!(t instanceof Or)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(t.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=t.children[r]||this.children[r+1]!=t.children[r+1]||!this.children[r+2].eq(t.children[r+2]))return!1;return!0}locals(t){return nN(this.localsInner(t))}localsInner(t){if(this==ns)return cf;if(t.inlineContent||!this.local.some(Fl.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Fl||r.push(this.local[n]);return r}forEachSet(t){t(this)}}Or.empty=new Or([],[]);Or.removeOverlap=nN;const ns=Or.empty;class Sl{constructor(t){this.members=t}map(t,r){const n=this.members.map(s=>s.map(t,r,zc));return Sl.from(n)}forChild(t,r){if(r.isLeaf)return Or.empty;let n=[];for(let s=0;s<this.members.length;s++){let a=this.members[s].forChild(t,r);a!=ns&&(a instanceof Sl?n=n.concat(a.members):n.push(a))}return Sl.from(n)}eq(t){if(!(t instanceof Sl)||t.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(t.members[r]))return!1;return!0}locals(t){let r,n=!0;for(let s=0;s<this.members.length;s++){let a=this.members[s].localsInner(t);if(a.length)if(!r)r=a;else{n&&(r=r.slice(),n=!1);for(let i=0;i<a.length;i++)r.push(a[i])}}return r?nN(n?r:r.sort(Hc)):cf}static from(t){switch(t.length){case 0:return ns;case 1:return t[0];default:return new Sl(t.every(r=>r instanceof Or)?t:t.reduce((r,n)=>r.concat(n instanceof Or?n:n.members),[]))}}forEachSet(t){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(t)}}function Nde(e,t,r,n,s,a,i){let o=e.slice();for(let f=0,h=a;f<r.maps.length;f++){let p=0;r.maps[f].forEach((x,g,v,y)=>{let w=y-v-(g-x);for(let _=0;_<o.length;_+=3){let S=o[_+1];if(S<0||x>S+h-p)continue;let E=o[_]+h-p;g>=E?o[_+1]=x<=E?-2:-1:x>=h&&w&&(o[_]+=w,o[_+1]+=w)}p+=w}),h=r.maps[f].map(h,-1)}let c=!1;for(let f=0;f<o.length;f+=3)if(o[f+1]<0){if(o[f+1]==-2){c=!0,o[f+1]=-1;continue}let h=r.map(e[f]+a),p=h-s;if(p<0||p>=n.content.size){c=!0;continue}let x=r.map(e[f+1]+a,-1),g=x-s,{index:v,offset:y}=n.content.findIndex(p),w=n.maybeChild(v);if(w&&y==p&&y+w.nodeSize==g){let _=o[f+2].mapInner(r,w,h+1,e[f]+a+1,i);_!=ns?(o[f]=p,o[f+1]=g,o[f+2]=_):(o[f+1]=-2,c=!0)}else c=!0}if(c){let f=Tde(o,e,t,r,s,a,i),h=vg(f,n,0,i);t=h.local;for(let p=0;p<o.length;p+=3)o[p+1]<0&&(o.splice(p,3),p-=3);for(let p=0,x=0;p<h.children.length;p+=3){let g=h.children[p];for(;x<o.length&&o[x]<g;)x+=3;o.splice(x,0,h.children[p],h.children[p+1],h.children[p+2])}}return new Or(t.sort(Hc),o)}function cP(e,t){if(!t||!e.length)return e;let r=[];for(let n=0;n<e.length;n++){let s=e[n];r.push(new ws(s.from+t,s.to+t,s.type))}return r}function Tde(e,t,r,n,s,a,i){function o(c,f){for(let h=0;h<c.local.length;h++){let p=c.local[h].map(n,s,f);p?r.push(p):i.onRemove&&i.onRemove(c.local[h].spec)}for(let h=0;h<c.children.length;h+=3)o(c.children[h+2],c.children[h]+f+1)}for(let c=0;c<e.length;c+=3)e[c+1]==-1&&o(e[c+2],t[c]+a+1);return r}function uP(e,t,r){if(t.isLeaf)return null;let n=r+t.nodeSize,s=null;for(let a=0,i;a<e.length;a++)(i=e[a])&&i.from>r&&i.to<n&&((s||(s=[])).push(i),e[a]=null);return s}function fP(e){let t=[];for(let r=0;r<e.length;r++)e[r]!=null&&t.push(e[r]);return t}function vg(e,t,r,n){let s=[],a=!1;t.forEach((o,c)=>{let f=uP(e,o,c+r);if(f){a=!0;let h=vg(f,o,r+c+1,n);h!=ns&&s.push(c,c+o.nodeSize,h)}});let i=cP(a?fP(e):e,-r).sort(Hc);for(let o=0;o<i.length;o++)i[o].type.valid(t,i[o])||(n.onRemove&&n.onRemove(i[o].spec),i.splice(o--,1));return i.length||s.length?new Or(i,s):ns}function Hc(e,t){return e.from-t.from||e.to-t.to}function nN(e){let t=e;for(let r=0;r<t.length-1;r++){let n=t[r];if(n.from!=n.to)for(let s=r+1;s<t.length;s++){let a=t[s];if(a.from==n.from){a.to!=n.to&&(t==e&&(t=e.slice()),t[s]=a.copy(a.from,n.to),NR(t,s+1,a.copy(n.to,a.to)));continue}else{a.from<n.to&&(t==e&&(t=e.slice()),t[r]=n.copy(n.from,a.from),NR(t,s,n.copy(a.from,n.to)));break}}}return t}function NR(e,t,r){for(;t<e.length&&Hc(r,e[t])>0;)t++;e.splice(t,0,r)}function Jb(e){let t=[];return e.someProp("decorations",r=>{let n=r(e.state);n&&n!=ns&&t.push(n)}),e.cursorWrapper&&t.push(Or.create(e.state.doc,[e.cursorWrapper.deco])),Sl.from(t)}const kde={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Ade=zs&&Il<=11;class Cde{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class Rde{constructor(t,r){this.view=t,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Cde,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let s=0;s<n.length;s++)this.queue.push(n[s]);zs&&Il<=11&&n.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():hs&&t.composing&&n.some(s=>s.type=="childList"&&s.target.nodeName=="TR")?(t.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),Ade&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,kde)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let r=0;r<t.length;r++)this.queue.push(t[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(gR(this.view)){if(this.suppressingSelectionUpdates)return Io(this.view);if(zs&&Il<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&su(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let r=new Set,n;for(let a=t.focusNode;a;a=Uf(a))r.add(a);for(let a=t.anchorNode;a;a=Uf(a))if(r.has(a)){n=a;break}let s=n&&this.view.docView.nearestDesc(n);if(s&&s.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=t.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&gR(t)&&!this.ignoreSelectionChange(n),a=-1,i=-1,o=!1,c=[];if(t.editable)for(let h=0;h<r.length;h++){let p=this.registerMutation(r[h],c);p&&(a=a<0?p.from:Math.min(p.from,a),i=i<0?p.to:Math.max(p.to,i),p.typeOver&&(o=!0))}if(c.some(h=>h.nodeName=="BR")&&(t.input.lastKeyCode==8||t.input.lastKeyCode==46)){for(let h of c)if(h.nodeName=="BR"&&h.parentNode){let p=h.nextSibling;p&&p.nodeType==1&&p.contentEditable=="false"&&h.parentNode.removeChild(h)}}else if(Ua&&c.length){let h=c.filter(p=>p.nodeName=="BR");if(h.length==2){let[p,x]=h;p.parentNode&&p.parentNode.parentNode==x.parentNode?x.remove():p.remove()}else{let{focusNode:p}=this.currentSelection;for(let x of h){let g=x.parentNode;g&&g.nodeName=="LI"&&(!p||Dde(t,p)!=g)&&x.remove()}}}let f=null;a<0&&s&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&I1(n)&&(f=YS(t))&&f.eq(It.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Io(t),this.currentSelection.set(n),t.scrollToSelection()):(a>-1||s)&&(a>-1&&(t.docView.markDirty(a,i),jde(t)),t.input.badSafariComposition&&(t.input.badSafariComposition=!1,Ide(t,c)),this.handleDOMChange(a,i,o,c),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||Io(t),this.currentSelection.set(n))}registerMutation(t,r){if(r.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(n==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!n||n.ignoreMutation(t))return null;if(t.type=="childList"){for(let h=0;h<t.addedNodes.length;h++){let p=t.addedNodes[h];r.push(p),p.nodeType==3&&(this.lastChangedTextNode=p)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let s=t.previousSibling,a=t.nextSibling;if(zs&&Il<=11&&t.addedNodes.length)for(let h=0;h<t.addedNodes.length;h++){let{previousSibling:p,nextSibling:x}=t.addedNodes[h];(!p||Array.prototype.indexOf.call(t.addedNodes,p)<0)&&(s=p),(!x||Array.prototype.indexOf.call(t.addedNodes,x)<0)&&(a=x)}let i=s&&s.parentNode==t.target?Gn(s)+1:0,o=n.localPosFromDOM(t.target,i,-1),c=a&&a.parentNode==t.target?Gn(a):t.target.childNodes.length,f=n.localPosFromDOM(t.target,c,1);return{from:o,to:f}}else return t.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let TR=new WeakMap,kR=!1;function jde(e){if(!TR.has(e)&&(TR.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=Ua,kR)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),kR=!0}}function AR(e,t){let r=t.startContainer,n=t.startOffset,s=t.endContainer,a=t.endOffset,i=e.domAtPos(e.state.selection.anchor);return su(i.node,i.offset,s,a)&&([r,n,s,a]=[s,a,r,n]),{anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:a}}function Ode(e,t){if(t.getComposedRanges){let s=t.getComposedRanges(e.root)[0];if(s)return AR(e,s)}let r;function n(s){s.preventDefault(),s.stopImmediatePropagation(),r=s.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0),r?AR(e,r):null}function Dde(e,t){for(let r=t.parentNode;r&&r!=e.dom;r=r.parentNode){let n=e.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function Ide(e,t){var r;let{focusNode:n,focusOffset:s}=e.domSelectionRange();for(let a of t)if(((r=a.parentNode)===null||r===void 0?void 0:r.nodeName)=="TR"){let i=a.nextSibling;for(;i&&i.nodeName!="TD"&&i.nodeName!="TH";)i=i.nextSibling;if(i){let o=i;for(;;){let c=o.firstChild;if(!c||c.nodeType!=1||c.contentEditable=="false"||/^(BR|IMG)$/.test(c.nodeName))break;o=c}o.insertBefore(a,o.firstChild),n==a&&e.domSelection().collapse(a,s)}else a.parentNode.removeChild(a)}}function Mde(e,t,r){let{node:n,fromOffset:s,toOffset:a,from:i,to:o}=e.docView.parseRange(t,r),c=e.domSelectionRange(),f,h=c.anchorNode;if(h&&e.dom.contains(h.nodeType==1?h:h.parentNode)&&(f=[{node:h,offset:c.anchorOffset}],I1(c)||f.push({node:c.focusNode,offset:c.focusOffset})),Jn&&e.input.lastKeyCode===8)for(let w=a;w>s;w--){let _=n.childNodes[w-1],S=_.pmViewDesc;if(_.nodeName=="BR"&&!S){a=w;break}if(!S||S.size)break}let p=e.state.doc,x=e.someProp("domParser")||Dl.fromSchema(e.state.schema),g=p.resolve(i),v=null,y=x.parse(n,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:s,to:a,preserveWhitespace:g.parent.type.whitespace=="pre"?"full":!0,findPositions:f,ruleFromNode:Fde,context:g});if(f&&f[0].pos!=null){let w=f[0].pos,_=f[1]&&f[1].pos;_==null&&(_=w),v={anchor:w+i,head:_+i}}return{doc:y,sel:v,from:i,to:o}}function Fde(e){let t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(hs&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(e.parentNode.lastChild==e||hs&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Pde=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Lde(e,t,r,n,s){let a=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let R=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,V=YS(e,R);if(V&&!e.state.selection.eq(V)){if(Jn&&No&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",Z=>Z(e,_c(13,"Enter"))))return;let I=e.state.tr.setSelection(V);R=="pointer"?I.setMeta("pointer",!0):R=="key"&&I.scrollIntoView(),a&&I.setMeta("composition",a),e.dispatch(I)}return}let i=e.state.doc.resolve(t),o=i.sharedDepth(r);t=i.before(o+1),r=e.state.doc.resolve(r).after(o+1);let c=e.state.selection,f=Mde(e,t,r),h=e.state.doc,p=h.slice(f.from,f.to),x,g;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(x=e.state.selection.to,g="end"):(x=e.state.selection.from,g="start"),e.input.lastKeyCode=null;let v=zde(p.content,f.doc.content,f.from,x,g);if(v&&e.input.domChangeCount++,(zf&&e.input.lastIOSEnter>Date.now()-225||No)&&s.some(R=>R.nodeType==1&&!Pde.test(R.nodeName))&&(!v||v.endA>=v.endB)&&e.someProp("handleKeyDown",R=>R(e,_c(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!v)if(n&&c instanceof St&&!c.empty&&c.$head.sameParent(c.$anchor)&&!e.composing&&!(f.sel&&f.sel.anchor!=f.sel.head))v={start:c.from,endA:c.to,endB:c.to};else{if(f.sel){let R=CR(e,e.state.doc,f.sel);if(R&&!R.eq(e.state.selection)){let V=e.state.tr.setSelection(R);a&&V.setMeta("composition",a),e.dispatch(V)}}return}e.state.selection.from<e.state.selection.to&&v.start==v.endB&&e.state.selection instanceof St&&(v.start>e.state.selection.from&&v.start<=e.state.selection.from+2&&e.state.selection.from>=f.from?v.start=e.state.selection.from:v.endA<e.state.selection.to&&v.endA>=e.state.selection.to-2&&e.state.selection.to<=f.to&&(v.endB+=e.state.selection.to-v.endA,v.endA=e.state.selection.to)),zs&&Il<=11&&v.endB==v.start+1&&v.endA==v.start&&v.start>f.from&&f.doc.textBetween(v.start-f.from-1,v.start-f.from+1)==" "&&(v.start--,v.endA--,v.endB--);let y=f.doc.resolveNoCache(v.start-f.from),w=f.doc.resolveNoCache(v.endB-f.from),_=h.resolve(v.start),S=y.sameParent(w)&&y.parent.inlineContent&&_.end()>=v.endA;if((zf&&e.input.lastIOSEnter>Date.now()-225&&(!S||s.some(R=>R.nodeName=="DIV"||R.nodeName=="P"))||!S&&y.pos<f.doc.content.size&&(!y.sameParent(w)||!y.parent.inlineContent)&&y.pos<w.pos&&!/\S/.test(f.doc.textBetween(y.pos,w.pos,"","")))&&e.someProp("handleKeyDown",R=>R(e,_c(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>v.start&&Ude(h,v.start,v.endA,y,w)&&e.someProp("handleKeyDown",R=>R(e,_c(8,"Backspace")))){No&&Jn&&e.domObserver.suppressSelectionUpdates();return}Jn&&v.endB==v.start&&(e.input.lastChromeDelete=Date.now()),No&&!S&&y.start()!=w.start()&&w.parentOffset==0&&y.depth==w.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==v.endA&&(v.endB-=2,w=f.doc.resolveNoCache(v.endB-f.from),setTimeout(()=>{e.someProp("handleKeyDown",function(R){return R(e,_c(13,"Enter"))})},20));let E=v.start,N=v.endA,k=R=>{let V=R||e.state.tr.replace(E,N,f.doc.slice(v.start-f.from,v.endB-f.from));if(f.sel){let I=CR(e,V.doc,f.sel);I&&!(Jn&&e.composing&&I.empty&&(v.start!=v.endB||e.input.lastChromeDelete<Date.now()-100)&&(I.head==E||I.head==V.mapping.map(N)-1)||zs&&I.empty&&I.head==E)&&V.setSelection(I)}return a&&V.setMeta("composition",a),V.scrollIntoView()},O;if(S)if(y.pos==w.pos){zs&&Il<=11&&y.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>Io(e),20));let R=k(e.state.tr.delete(E,N)),V=h.resolve(v.start).marksAcross(h.resolve(v.endA));V&&R.ensureMarks(V),e.dispatch(R)}else if(v.endA==v.endB&&(O=Bde(y.parent.content.cut(y.parentOffset,w.parentOffset),_.parent.content.cut(_.parentOffset,v.endA-_.start())))){let R=k(e.state.tr);O.type=="add"?R.addMark(E,N,O.mark):R.removeMark(E,N,O.mark),e.dispatch(R)}else if(y.parent.child(y.index()).isText&&y.index()==w.index()-(w.textOffset?0:1)){let R=y.parent.textBetween(y.parentOffset,w.parentOffset),V=()=>k(e.state.tr.insertText(R,E,N));e.someProp("handleTextInput",I=>I(e,E,N,R,V))||e.dispatch(V())}else e.dispatch(k());else e.dispatch(k())}function CR(e,t,r){return Math.max(r.anchor,r.head)>t.content.size?null:JS(e,t.resolve(r.anchor),t.resolve(r.head))}function Bde(e,t){let r=e.firstChild.marks,n=t.firstChild.marks,s=r,a=n,i,o,c;for(let h=0;h<n.length;h++)s=n[h].removeFromSet(s);for(let h=0;h<r.length;h++)a=r[h].removeFromSet(a);if(s.length==1&&a.length==0)o=s[0],i="add",c=h=>h.mark(o.addToSet(h.marks));else if(s.length==0&&a.length==1)o=a[0],i="remove",c=h=>h.mark(o.removeFromSet(h.marks));else return null;let f=[];for(let h=0;h<t.childCount;h++)f.push(c(t.child(h)));if(Ge.from(f).eq(e))return{mark:o,type:i}}function Ude(e,t,r,n,s){if(r-t<=s.pos-n.pos||Zb(n,!0,!1)<s.pos)return!1;let a=e.resolve(t);if(!n.parent.isTextblock){let o=a.nodeAfter;return o!=null&&r==t+o.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let i=e.resolve(Zb(a,!0,!0));return!i.parent.isTextblock||i.pos>r||Zb(i,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(i.parent.content)}function Zb(e,t,r){let n=e.depth,s=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,s++,t=!1;if(r){let a=e.node(n).maybeChild(e.indexAfter(n));for(;a&&!a.isLeaf;)a=a.firstChild,s++}return s}function zde(e,t,r,n,s){let a=e.findDiffStart(t,r);if(a==null)return null;let{a:i,b:o}=e.findDiffEnd(t,r+e.size,r+t.size);if(s=="end"){let c=Math.max(0,a-Math.min(i,o));n-=i+c-a}if(i<a&&e.size<t.size){let c=n<=a&&n>=i?a-n:0;a-=c,a&&a<t.size&&RR(t.textBetween(a-1,a+1))&&(a+=c?1:-1),o=a+(o-i),i=a}else if(o<a){let c=n<=a&&n>=o?a-n:0;a-=c,a&&a<e.size&&RR(e.textBetween(a-1,a+1))&&(a+=c?1:-1),i=a+(i-o),o=a}return{start:a,endA:i,endB:o}}function RR(e){if(e.length!=2)return!1;let t=e.charCodeAt(0),r=e.charCodeAt(1);return t>=56320&&t<=57343&&r>=55296&&r<=56319}class dP{constructor(t,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new nde,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(MR),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=DR(this),OR(this),this.nodeViews=IR(this),this.docView=fR(this.state.doc,jR(this),Jb(this),this.dom,this),this.domObserver=new Rde(this,(n,s,a,i)=>Lde(this,n,s,a,i)),this.domObserver.start(),sde(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let r in t)this._props[r]=t[r];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&J_(this);let r=this._props;this._props=t,t.plugins&&(t.plugins.forEach(MR),this.directPlugins=t.plugins),this.updateStateInner(t.state,r)}setProps(t){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in t)r[n]=t[n];this.update(r)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,r){var n;let s=this.state,a=!1,i=!1;t.storedMarks&&this.composing&&(aP(this),i=!0),this.state=t;let o=s.plugins!=t.plugins||this._props.plugins!=r.plugins;if(o||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let g=IR(this);Vde(g,this.nodeViews)&&(this.nodeViews=g,a=!0)}(o||r.handleDOMEvents!=this._props.handleDOMEvents)&&J_(this),this.editable=DR(this),OR(this);let c=Jb(this),f=jR(this),h=s.plugins!=t.plugins&&!s.doc.eq(t.doc)?"reset":t.scrollToSelection>s.scrollToSelection?"to selection":"preserve",p=a||!this.docView.matchesNode(t.doc,f,c);(p||!t.selection.eq(s.selection))&&(i=!0);let x=h=="preserve"&&i&&this.dom.style.overflowAnchor==null&&yfe(this);if(i){this.domObserver.stop();let g=p&&(zs||Jn)&&!this.composing&&!s.selection.empty&&!t.selection.empty&&Hde(s.selection,t.selection);if(p){let v=Jn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=yde(this)),(a||!this.docView.update(t.doc,f,c,this))&&(this.docView.updateOuterDeco(f),this.docView.destroy(),this.docView=fR(t.doc,f,c,this.dom,this)),v&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(g=!0)}g||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Hfe(this))?Io(this,g):(GF(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((n=this.dragging)===null||n===void 0)&&n.node&&!s.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,s),h=="reset"?this.dom.scrollTop=0:h=="to selection"?this.scrollToSelection():x&&vfe(x)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof xt){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&aR(this,r.getBoundingClientRect(),t)}else aR(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,t)}}updateDraggedNode(t,r){let n=t.node,s=-1;if(this.state.doc.nodeAt(n.from)==n.node)s=n.from;else{let a=n.from+(this.state.doc.content.size-r.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==n.node&&(s=a)}this.dragging=new oP(t.slice,t.move,s<0?void 0:xt.create(this.state.doc,s))}someProp(t,r){let n=this._props&&this._props[t],s;if(n!=null&&(s=r?r(n):n))return s;for(let i=0;i<this.directPlugins.length;i++){let o=this.directPlugins[i].props[t];if(o!=null&&(s=r?r(o):o))return s}let a=this.state.plugins;if(a)for(let i=0;i<a.length;i++){let o=a[i].props[t];if(o!=null&&(s=r?r(o):o))return s}}hasFocus(){if(zs){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&bfe(this.dom),Io(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return t||document}updateRoot(){this._root=null}posAtCoords(t){return Nfe(this,t)}coordsAtPos(t,r=1){return BF(this,t,r)}domAtPos(t,r=0){return this.docView.domFromPos(t,r)}nodeDOM(t){let r=this.docView.descAt(t);return r?r.nodeDOM:null}posAtDOM(t,r,n=-1){let s=this.docView.posFromDOM(t,r,n);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(t,r){return Rfe(this,r||this.state,t)}pasteHTML(t,r){return A0(this,"",t,!1,r||new ClipboardEvent("paste"))}pasteText(t,r){return A0(this,t,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(t){return ZS(this,t)}destroy(){this.docView&&(ade(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Jb(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,lfe())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return ode(this,t)}domSelectionRange(){let t=this.domSelection();return t?hs&&this.root.nodeType===11&&hfe(this.dom.ownerDocument)==this.dom&&Ode(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}dP.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};function jR(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(e.state)),r)for(let n in r)n=="class"?t.class+=" "+r[n]:n=="style"?t.style=(t.style?t.style+";":"")+r[n]:!t[n]&&n!="contenteditable"&&n!="nodeName"&&(t[n]=String(r[n]))}),t.translate||(t.translate="no"),[ws.node(0,e.state.doc.content.size,t)]}function OR(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:ws.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function DR(e){return!e.someProp("editable",t=>t(e.state)===!1)}function Hde(e,t){let r=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(r)!=t.$anchor.start(r)}function IR(e){let t=Object.create(null);function r(n){for(let s in n)Object.prototype.hasOwnProperty.call(t,s)||(t[s]=n[s])}return e.someProp("nodeViews",r),e.someProp("markViews",r),t}function Vde(e,t){let r=0,n=0;for(let s in e){if(e[s]!=t[s])return!0;r++}for(let s in t)n++;return r!=n}function MR(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Vl={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},bg={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},qde=typeof navigator<"u"&&/Mac/.test(navigator.platform),Wde=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Kn=0;Kn<10;Kn++)Vl[48+Kn]=Vl[96+Kn]=String(Kn);for(var Kn=1;Kn<=24;Kn++)Vl[Kn+111]="F"+Kn;for(var Kn=65;Kn<=90;Kn++)Vl[Kn]=String.fromCharCode(Kn+32),bg[Kn]=String.fromCharCode(Kn);for(var Qb in Vl)bg.hasOwnProperty(Qb)||(bg[Qb]=Vl[Qb]);function $de(e){var t=qde&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||Wde&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",r=!t&&e.key||(e.shiftKey?bg:Vl)[e.keyCode]||e.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const Gde=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Kde=typeof navigator<"u"&&/Win/.test(navigator.platform);function Xde(e){let t=e.split(/-(?!$)/),r=t[t.length-1];r=="Space"&&(r=" ");let n,s,a,i;for(let o=0;o<t.length-1;o++){let c=t[o];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))Gde?i=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(r="Alt-"+r),s&&(r="Ctrl-"+r),i&&(r="Meta-"+r),a&&(r="Shift-"+r),r}function Yde(e){let t=Object.create(null);for(let r in e)t[Xde(r)]=e[r];return t}function ew(e,t,r=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),r&&t.shiftKey&&(e="Shift-"+e),e}function Jde(e){return new Fr({props:{handleKeyDown:hP(e)}})}function hP(e){let t=Yde(e);return function(r,n){let s=$de(n),a,i=t[ew(s,n)];if(i&&i(r.state,r.dispatch,r))return!0;if(s.length==1&&s!=" "){if(n.shiftKey){let o=t[ew(s,n,!1)];if(o&&o(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(Kde&&n.ctrlKey&&n.altKey)&&(a=Vl[n.keyCode])&&a!=s){let o=t[ew(a,n)];if(o&&o(r.state,r.dispatch,r))return!0}}return!1}}var Zde=Object.defineProperty,sN=(e,t)=>{for(var r in t)Zde(e,r,{get:t[r],enumerable:!0})};function P1(e){const{state:t,transaction:r}=e;let{selection:n}=r,{doc:s}=r,{storedMarks:a}=r;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return a},get selection(){return n},get doc(){return s},get tr(){return n=r.selection,s=r.doc,a=r.storedMarks,r}}}var L1=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:n}=t,{tr:s}=r,a=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([i,o])=>[i,(...f)=>{const h=o(...f)(a);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(s),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:n,state:s}=this,{view:a}=n,i=[],o=!!e,c=e||s.tr,f=()=>(!o&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(c),i.every(p=>p===!0)),h={...Object.fromEntries(Object.entries(r).map(([p,x])=>[p,(...v)=>{const y=this.buildProps(c,t),w=x(...v)(y);return i.push(w),h}])),run:f};return h}createCan(e){const{rawCommands:t,state:r}=this,n=!1,s=e||r.tr,a=this.buildProps(s,n);return{...Object.fromEntries(Object.entries(t).map(([o,c])=>[o,(...f)=>c(...f)({...a,dispatch:void 0})])),chain:()=>this.createChain(s,n)}}buildProps(e,t=!0){const{rawCommands:r,editor:n,state:s}=this,{view:a}=n,i={tr:e,editor:n,view:a,state:P1({state:s,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([o,c])=>[o,(...f)=>c(...f)(i)]))}};return i}},pP={};sN(pP,{blur:()=>Qde,clearContent:()=>ehe,clearNodes:()=>the,command:()=>rhe,createParagraphNear:()=>nhe,cut:()=>she,deleteCurrentNode:()=>ahe,deleteNode:()=>ihe,deleteRange:()=>ohe,deleteSelection:()=>lhe,enter:()=>che,exitCode:()=>uhe,extendMarkRange:()=>fhe,first:()=>dhe,focus:()=>phe,forEach:()=>mhe,insertContent:()=>xhe,insertContentAt:()=>vhe,joinBackward:()=>_he,joinDown:()=>whe,joinForward:()=>Ehe,joinItemBackward:()=>She,joinItemForward:()=>Nhe,joinTextblockBackward:()=>The,joinTextblockForward:()=>khe,joinUp:()=>bhe,keyboardShortcut:()=>Che,lift:()=>Rhe,liftEmptyBlock:()=>jhe,liftListItem:()=>Ohe,newlineInCode:()=>Dhe,resetAttributes:()=>Ihe,scrollIntoView:()=>Mhe,selectAll:()=>Fhe,selectNodeBackward:()=>Phe,selectNodeForward:()=>Lhe,selectParentNode:()=>Bhe,selectTextblockEnd:()=>Uhe,selectTextblockStart:()=>zhe,setContent:()=>Hhe,setMark:()=>l0e,setMeta:()=>c0e,setNode:()=>u0e,setNodeSelection:()=>f0e,setTextDirection:()=>d0e,setTextSelection:()=>h0e,sinkListItem:()=>p0e,splitBlock:()=>m0e,splitListItem:()=>x0e,toggleList:()=>g0e,toggleMark:()=>y0e,toggleNode:()=>v0e,toggleWrap:()=>b0e,undoInputRule:()=>w0e,unsetAllMarks:()=>_0e,unsetMark:()=>E0e,unsetTextDirection:()=>S0e,updateAttributes:()=>N0e,wrapIn:()=>T0e,wrapInList:()=>k0e});var Qde=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var r;e.isDestroyed||(t.dom.blur(),(r=window==null?void 0:window.getSelection())==null||r.removeAllRanges())}),!0),ehe=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),the=()=>({state:e,tr:t,dispatch:r})=>{const{selection:n}=t,{ranges:s}=n;return r&&s.forEach(({$from:a,$to:i})=>{e.doc.nodesBetween(a.pos,i.pos,(o,c)=>{if(o.type.isText)return;const{doc:f,mapping:h}=t,p=f.resolve(h.map(c)),x=f.resolve(h.map(c+o.nodeSize)),g=p.blockRange(x);if(!g)return;const v=xd(g);if(o.type.isTextblock){const{defaultType:y}=p.parent.contentMatchAt(p.index());t.setNodeMarkup(g.start,y)}(v||v===0)&&t.lift(g,v)})}),!0},rhe=e=>t=>e(t),nhe=()=>({state:e,dispatch:t})=>AF(e,t),she=(e,t)=>({editor:r,tr:n})=>{const{state:s}=r,a=s.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);const i=n.mapping.map(t);return n.insert(i,a.content),n.setSelection(new St(n.doc.resolve(Math.max(i-1,0)))),!0},ahe=()=>({tr:e,dispatch:t})=>{const{selection:r}=e,n=r.$anchor.node();if(n.content.size>0)return!1;const s=e.selection.$anchor;for(let a=s.depth;a>0;a-=1)if(s.node(a).type===n.type){if(t){const o=s.before(a),c=s.after(a);e.delete(o,c).scrollIntoView()}return!0}return!1};function gn(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var ihe=e=>({tr:t,state:r,dispatch:n})=>{const s=gn(e,r.schema),a=t.selection.$anchor;for(let i=a.depth;i>0;i-=1)if(a.node(i).type===s){if(n){const c=a.before(i),f=a.after(i);t.delete(c,f).scrollIntoView()}return!0}return!1},ohe=e=>({tr:t,dispatch:r})=>{const{from:n,to:s}=e;return r&&t.delete(n,s),!0},lhe=()=>({state:e,dispatch:t})=>qS(e,t),che=()=>({commands:e})=>e.keyboardShortcut("Enter"),uhe=()=>({state:e,dispatch:t})=>Gue(e,t);function aN(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function wg(e,t,r={strict:!0}){const n=Object.keys(t);return n.length?n.every(s=>r.strict?t[s]===e[s]:aN(t[s])?t[s].test(e[s]):t[s]===e[s]):!0}function mP(e,t,r={}){return e.find(n=>n.type===t&&wg(Object.fromEntries(Object.keys(r).map(s=>[s,n.attrs[s]])),r))}function FR(e,t,r={}){return!!mP(e,t,r)}function iN(e,t,r){var n;if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if((!s.node||!s.node.marks.some(h=>h.type===t))&&(s=e.parent.childBefore(e.parentOffset)),!s.node||!s.node.marks.some(h=>h.type===t)||(r=r||((n=s.node.marks[0])==null?void 0:n.attrs),!mP([...s.node.marks],t,r)))return;let i=s.index,o=e.start()+s.offset,c=i+1,f=o+s.node.nodeSize;for(;i>0&&FR([...e.parent.child(i-1).marks],t,r);)i-=1,o-=e.parent.child(i).nodeSize;for(;c<e.parent.childCount&&FR([...e.parent.child(c).marks],t,r);)f+=e.parent.child(c).nodeSize,c+=1;return{from:o,to:f}}function Ho(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var fhe=(e,t={})=>({tr:r,state:n,dispatch:s})=>{const a=Ho(e,n.schema),{doc:i,selection:o}=r,{$from:c,from:f,to:h}=o;if(s){const p=iN(c,a,t);if(p&&p.from<=f&&p.to>=h){const x=St.create(i,p.from,p.to);r.setSelection(x)}}return!0},dhe=e=>t=>{const r=typeof e=="function"?e(t):e;for(let n=0;n<r.length;n+=1)if(r[n](t))return!0;return!1};function xP(e){return e instanceof St}function Ac(e=0,t=0,r=0){return Math.min(Math.max(e,t),r)}function gP(e,t=null){if(!t)return null;const r=It.atStart(e),n=It.atEnd(e);if(t==="start"||t===!0)return r;if(t==="end")return n;const s=r.from,a=n.to;return t==="all"?St.create(e,Ac(0,s,a),Ac(e.content.size,s,a)):St.create(e,Ac(t,s,a),Ac(t,s,a))}function PR(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function _g(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function hhe(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var phe=(e=null,t={})=>({editor:r,view:n,tr:s,dispatch:a})=>{t={scrollIntoView:!0,...t};const i=()=>{(_g()||PR())&&n.dom.focus(),hhe()&&!_g()&&!PR()&&n.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{r.isDestroyed||(n.focus(),t!=null&&t.scrollIntoView&&r.commands.scrollIntoView())})};try{if(n.hasFocus()&&e===null||e===!1)return!0}catch{return!1}if(a&&e===null&&!xP(r.state.selection))return i(),!0;const o=gP(s.doc,e)||r.state.selection,c=r.state.selection.eq(o);return a&&(c||s.setSelection(o),c&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},mhe=(e,t)=>r=>e.every((n,s)=>t(n,{...r,index:s})),xhe=(e,t)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},e,t),yP=e=>{const t=e.childNodes;for(let r=t.length-1;r>=0;r-=1){const n=t[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):n.nodeType===1&&yP(n)}return e};function Qm(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${e}</body>`,r=new window.DOMParser().parseFromString(t,"text/html").body;return yP(r)}function R0(e,t,r){if(e instanceof ui||e instanceof Ge)return e;r={slice:!0,parseOptions:{},...r};const n=typeof e=="object"&&e!==null,s=typeof e=="string";if(n)try{if(Array.isArray(e)&&e.length>0)return Ge.fromArray(e.map(o=>t.nodeFromJSON(o)));const i=t.nodeFromJSON(e);return r.errorOnInvalidContent&&i.check(),i}catch(a){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",a),R0("",t,r)}if(s){if(r.errorOnInvalidContent){let i=!1,o="";const c=new tF({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:f=>(i=!0,o=typeof f=="string"?f:f.outerHTML,null)}]}})});if(r.slice?Dl.fromSchema(c).parseSlice(Qm(e),r.parseOptions):Dl.fromSchema(c).parse(Qm(e),r.parseOptions),r.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const a=Dl.fromSchema(t);return r.slice?a.parseSlice(Qm(e),r.parseOptions).content:a.parse(Qm(e),r.parseOptions)}return R0("",t,r)}function ghe(e,t,r){const n=e.steps.length-1;if(n<t)return;const s=e.steps[n];if(!(s instanceof On||s instanceof Fn))return;const a=e.mapping.maps[n];let i=0;a.forEach((o,c,f,h)=>{i===0&&(i=h)}),e.setSelection(It.near(e.doc.resolve(i),r))}var yhe=e=>!("type"in e),vhe=(e,t,r)=>({tr:n,dispatch:s,editor:a})=>{var i;if(s){r={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let o;const c=w=>{a.emit("contentError",{editor:a,error:w,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},f={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{R0(t,a.schema,{parseOptions:f,errorOnInvalidContent:!0})}catch(w){c(w)}try{o=R0(t,a.schema,{parseOptions:f,errorOnInvalidContent:(i=r.errorOnInvalidContent)!=null?i:a.options.enableContentCheck})}catch(w){return c(w),!1}let{from:h,to:p}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},x=!0,g=!0;if((yhe(o)?o:[o]).forEach(w=>{w.check(),x=x?w.isText&&w.marks.length===0:!1,g=g?w.isBlock:!1}),h===p&&g){const{parent:w}=n.doc.resolve(h);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(h-=1,p+=1)}let y;if(x){if(Array.isArray(t))y=t.map(w=>w.text||"").join("");else if(t instanceof Ge){let w="";t.forEach(_=>{_.text&&(w+=_.text)}),y=w}else typeof t=="object"&&t&&t.text?y=t.text:y=t;n.insertText(y,h,p)}else{y=o;const w=n.doc.resolve(h),_=w.node(),S=w.parentOffset===0,E=_.isText||_.isTextblock,N=_.content.size>0;S&&E&&N&&(h=Math.max(0,h-1)),n.replaceWith(h,p,y)}r.updateSelection&&ghe(n,n.steps.length-1,-1),r.applyInputRules&&n.setMeta("applyInputRules",{from:h,text:y}),r.applyPasteRules&&n.setMeta("applyPasteRules",{from:h,text:y})}return!0},bhe=()=>({state:e,dispatch:t})=>que(e,t),whe=()=>({state:e,dispatch:t})=>Wue(e,t),_he=()=>({state:e,dispatch:t})=>wF(e,t),Ehe=()=>({state:e,dispatch:t})=>NF(e,t),She=()=>({state:e,dispatch:t,tr:r})=>{try{const n=j1(e.doc,e.selection.$from.pos,-1);return n==null?!1:(r.join(n,2),t&&t(r),!0)}catch{return!1}},Nhe=()=>({state:e,dispatch:t,tr:r})=>{try{const n=j1(e.doc,e.selection.$from.pos,1);return n==null?!1:(r.join(n,2),t&&t(r),!0)}catch{return!1}},The=()=>({state:e,dispatch:t})=>Hue(e,t),khe=()=>({state:e,dispatch:t})=>Vue(e,t);function vP(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Ahe(e){const t=e.split(/-(?!$)/);let r=t[t.length-1];r==="Space"&&(r=" ");let n,s,a,i;for(let o=0;o<t.length-1;o+=1){const c=t[o];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))_g()||vP()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return n&&(r=`Alt-${r}`),s&&(r=`Ctrl-${r}`),i&&(r=`Meta-${r}`),a&&(r=`Shift-${r}`),r}var Che=e=>({editor:t,view:r,tr:n,dispatch:s})=>{const a=Ahe(e).split(/-(?!$)/),i=a.find(f=>!["Alt","Ctrl","Meta","Shift"].includes(f)),o=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),c=t.captureTransaction(()=>{r.someProp("handleKeyDown",f=>f(r,o))});return c==null||c.steps.forEach(f=>{const h=f.map(n.mapping);h&&s&&n.maybeStep(h)}),!0};function ql(e,t,r={}){const{from:n,to:s,empty:a}=e.selection,i=t?gn(t,e.schema):null,o=[];e.doc.nodesBetween(n,s,(p,x)=>{if(p.isText)return;const g=Math.max(n,x),v=Math.min(s,x+p.nodeSize);o.push({node:p,from:g,to:v})});const c=s-n,f=o.filter(p=>i?i.name===p.node.type.name:!0).filter(p=>wg(p.node.attrs,r,{strict:!1}));return a?!!f.length:f.reduce((p,x)=>p+x.to-x.from,0)>=c}var Rhe=(e,t={})=>({state:r,dispatch:n})=>{const s=gn(e,r.schema);return ql(r,s,t)?$ue(r,n):!1},jhe=()=>({state:e,dispatch:t})=>CF(e,t),Ohe=e=>({state:t,dispatch:r})=>{const n=gn(e,t.schema);return sfe(n)(t,r)},Dhe=()=>({state:e,dispatch:t})=>kF(e,t);function B1(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function LR(e,t){const r=typeof t=="string"?[t]:t;return Object.keys(e).reduce((n,s)=>(r.includes(s)||(n[s]=e[s]),n),{})}var Ihe=(e,t)=>({tr:r,state:n,dispatch:s})=>{let a=null,i=null;const o=B1(typeof e=="string"?e:e.name,n.schema);if(!o)return!1;o==="node"&&(a=gn(e,n.schema)),o==="mark"&&(i=Ho(e,n.schema));let c=!1;return r.selection.ranges.forEach(f=>{n.doc.nodesBetween(f.$from.pos,f.$to.pos,(h,p)=>{a&&a===h.type&&(c=!0,s&&r.setNodeMarkup(p,void 0,LR(h.attrs,t))),i&&h.marks.length&&h.marks.forEach(x=>{i===x.type&&(c=!0,s&&r.addMark(p,p+h.nodeSize,i.create(LR(x.attrs,t))))})})}),c},Mhe=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),Fhe=()=>({tr:e,dispatch:t})=>{if(t){const r=new la(e.doc);e.setSelection(r)}return!0},Phe=()=>({state:e,dispatch:t})=>EF(e,t),Lhe=()=>({state:e,dispatch:t})=>TF(e,t),Bhe=()=>({state:e,dispatch:t})=>Yue(e,t),Uhe=()=>({state:e,dispatch:t})=>Que(e,t),zhe=()=>({state:e,dispatch:t})=>Zue(e,t);function Z_(e,t,r={},n={}){return R0(e,t,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}var Hhe=(e,{errorOnInvalidContent:t,emitUpdate:r=!0,parseOptions:n={}}={})=>({editor:s,tr:a,dispatch:i,commands:o})=>{const{doc:c}=a;if(n.preserveWhitespace!=="full"){const f=Z_(e,s.schema,n,{errorOnInvalidContent:t??s.options.enableContentCheck});return i&&a.replaceWith(0,c.content.size,f).setMeta("preventUpdate",!r),!0}return i&&a.setMeta("preventUpdate",!r),o.insertContentAt({from:0,to:c.content.size},e,{parseOptions:n,errorOnInvalidContent:t??s.options.enableContentCheck})};function bP(e,t){const r=Ho(t,e.schema),{from:n,to:s,empty:a}=e.selection,i=[];a?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,s,c=>{i.push(...c.marks)});const o=i.find(c=>c.type.name===r.name);return o?{...o.attrs}:{}}function wP(e,t){const r=new gF(e);return t.forEach(n=>{n.steps.forEach(s=>{r.step(s)})}),r}function Vhe(e){for(let t=0;t<e.edgeCount;t+=1){const{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function qhe(e,t,r){const n=[];return e.nodesBetween(t.from,t.to,(s,a)=>{r(s)&&n.push({node:s,pos:a})}),n}function Whe(e,t){for(let r=e.depth;r>0;r-=1){const n=e.node(r);if(t(n))return{pos:r>0?e.before(r):0,start:e.start(r),depth:r,node:n}}}function U1(e){return t=>Whe(t.$from,e)}function ht(e,t,r){return e.config[t]===void 0&&e.parent?ht(e.parent,t,r):typeof e.config[t]=="function"?e.config[t].bind({...r,parent:e.parent?ht(e.parent,t,r):null}):e.config[t]}function oN(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},n=ht(t,"addExtensions",r);return n?[t,...oN(n())]:t}).flat(10)}function lN(e,t){const r=mu.fromSchema(t).serializeFragment(e),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(r),s.innerHTML}function _P(e){return typeof e=="function"}function rr(e,t=void 0,...r){return _P(e)?t?e.bind(t)(...r):e(...r):e}function $he(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Hf(e){const t=e.filter(s=>s.type==="extension"),r=e.filter(s=>s.type==="node"),n=e.filter(s=>s.type==="mark");return{baseExtensions:t,nodeExtensions:r,markExtensions:n}}function EP(e){const t=[],{nodeExtensions:r,markExtensions:n}=Hf(e),s=[...r,...n],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(i=>{const o={name:i.name,options:i.options,storage:i.storage,extensions:s},c=ht(i,"addGlobalAttributes",o);if(!c)return;c().forEach(h=>{h.types.forEach(p=>{Object.entries(h.attributes).forEach(([x,g])=>{t.push({type:p,name:x,attribute:{...a,...g}})})})})}),s.forEach(i=>{const o={name:i.name,options:i.options,storage:i.storage},c=ht(i,"addAttributes",o);if(!c)return;const f=c();Object.entries(f).forEach(([h,p])=>{const x={...a,...p};typeof(x==null?void 0:x.default)=="function"&&(x.default=x.default()),x!=null&&x.isRequired&&(x==null?void 0:x.default)===void 0&&delete x.default,t.push({type:i.name,name:h,attribute:x})})}),t}function yn(...e){return e.filter(t=>!!t).reduce((t,r)=>{const n={...t};return Object.entries(r).forEach(([s,a])=>{if(!n[s]){n[s]=a;return}if(s==="class"){const o=a?String(a).split(" "):[],c=n[s]?n[s].split(" "):[],f=o.filter(h=>!c.includes(h));n[s]=[...c,...f].join(" ")}else if(s==="style"){const o=a?a.split(";").map(h=>h.trim()).filter(Boolean):[],c=n[s]?n[s].split(";").map(h=>h.trim()).filter(Boolean):[],f=new Map;c.forEach(h=>{const[p,x]=h.split(":").map(g=>g.trim());f.set(p,x)}),o.forEach(h=>{const[p,x]=h.split(":").map(g=>g.trim());f.set(p,x)}),n[s]=Array.from(f.entries()).map(([h,p])=>`${h}: ${p}`).join("; ")}else n[s]=a}),n},{})}function j0(e,t){return t.filter(r=>r.type===e.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(e.attrs)||{}:{[r.name]:e.attrs[r.name]}).reduce((r,n)=>yn(r,n),{})}function Ghe(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function BR(e,t){return"style"in e?e:{...e,getAttrs:r=>{const n=e.getAttrs?e.getAttrs(r):e.attrs;if(n===!1)return!1;const s=t.reduce((a,i)=>{const o=i.attribute.parseHTML?i.attribute.parseHTML(r):Ghe(r.getAttribute(i.name));return o==null?a:{...a,[i.name]:o}},{});return{...n,...s}}}}function UR(e){return Object.fromEntries(Object.entries(e).filter(([t,r])=>t==="attrs"&&$he(r)?!1:r!=null))}function zR(e){var t,r;const n={};return!((t=e==null?void 0:e.attribute)!=null&&t.isRequired)&&"default"in((e==null?void 0:e.attribute)||{})&&(n.default=e.attribute.default),((r=e==null?void 0:e.attribute)==null?void 0:r.validate)!==void 0&&(n.validate=e.attribute.validate),[e.name,n]}function Khe(e,t){var r;const n=EP(e),{nodeExtensions:s,markExtensions:a}=Hf(e),i=(r=s.find(f=>ht(f,"topNode")))==null?void 0:r.name,o=Object.fromEntries(s.map(f=>{const h=n.filter(_=>_.type===f.name),p={name:f.name,options:f.options,storage:f.storage,editor:t},x=e.reduce((_,S)=>{const E=ht(S,"extendNodeSchema",p);return{..._,...E?E(f):{}}},{}),g=UR({...x,content:rr(ht(f,"content",p)),marks:rr(ht(f,"marks",p)),group:rr(ht(f,"group",p)),inline:rr(ht(f,"inline",p)),atom:rr(ht(f,"atom",p)),selectable:rr(ht(f,"selectable",p)),draggable:rr(ht(f,"draggable",p)),code:rr(ht(f,"code",p)),whitespace:rr(ht(f,"whitespace",p)),linebreakReplacement:rr(ht(f,"linebreakReplacement",p)),defining:rr(ht(f,"defining",p)),isolating:rr(ht(f,"isolating",p)),attrs:Object.fromEntries(h.map(zR))}),v=rr(ht(f,"parseHTML",p));v&&(g.parseDOM=v.map(_=>BR(_,h)));const y=ht(f,"renderHTML",p);y&&(g.toDOM=_=>y({node:_,HTMLAttributes:j0(_,h)}));const w=ht(f,"renderText",p);return w&&(g.toText=w),[f.name,g]})),c=Object.fromEntries(a.map(f=>{const h=n.filter(w=>w.type===f.name),p={name:f.name,options:f.options,storage:f.storage,editor:t},x=e.reduce((w,_)=>{const S=ht(_,"extendMarkSchema",p);return{...w,...S?S(f):{}}},{}),g=UR({...x,inclusive:rr(ht(f,"inclusive",p)),excludes:rr(ht(f,"excludes",p)),group:rr(ht(f,"group",p)),spanning:rr(ht(f,"spanning",p)),code:rr(ht(f,"code",p)),attrs:Object.fromEntries(h.map(zR))}),v=rr(ht(f,"parseHTML",p));v&&(g.parseDOM=v.map(w=>BR(w,h)));const y=ht(f,"renderHTML",p);return y&&(g.toDOM=w=>y({mark:w,HTMLAttributes:j0(w,h)})),[f.name,g]}));return new tF({topNode:i,nodes:o,marks:c})}function Xhe(e){const t=e.filter((r,n)=>e.indexOf(r)!==n);return Array.from(new Set(t))}function Eg(e){return e.sort((r,n)=>{const s=ht(r,"priority")||100,a=ht(n,"priority")||100;return s>a?-1:s<a?1:0})}function SP(e){const t=Eg(oN(e)),r=Xhe(t.map(n=>n.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),t}function NP(e,t,r){const{from:n,to:s}=t,{blockSeparator:a=`

`,textSerializers:i={}}=r||{};let o="";return e.nodesBetween(n,s,(c,f,h,p)=>{var x;c.isBlock&&f>n&&(o+=a);const g=i==null?void 0:i[c.type.name];if(g)return h&&(o+=g({node:c,pos:f,parent:h,index:p,range:t})),!1;c.isText&&(o+=(x=c==null?void 0:c.text)==null?void 0:x.slice(Math.max(n,f)-f,s-f))}),o}function Yhe(e,t){const r={from:0,to:e.content.size};return NP(e,r,t)}function TP(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,r])=>[t,r.spec.toText]))}function Jhe(e,t){const r=gn(t,e.schema),{from:n,to:s}=e.selection,a=[];e.doc.nodesBetween(n,s,o=>{a.push(o)});const i=a.reverse().find(o=>o.type.name===r.name);return i?{...i.attrs}:{}}function kP(e,t){const r=B1(typeof t=="string"?t:t.name,e.schema);return r==="node"?Jhe(e,t):r==="mark"?bP(e,t):{}}function Zhe(e,t=JSON.stringify){const r={};return e.filter(n=>{const s=t(n);return Object.prototype.hasOwnProperty.call(r,s)?!1:r[s]=!0})}function Qhe(e){const t=Zhe(e);return t.length===1?t:t.filter((r,n)=>!t.filter((a,i)=>i!==n).some(a=>r.oldRange.from>=a.oldRange.from&&r.oldRange.to<=a.oldRange.to&&r.newRange.from>=a.newRange.from&&r.newRange.to<=a.newRange.to))}function AP(e){const{mapping:t,steps:r}=e,n=[];return t.maps.forEach((s,a)=>{const i=[];if(s.ranges.length)s.forEach((o,c)=>{i.push({from:o,to:c})});else{const{from:o,to:c}=r[a];if(o===void 0||c===void 0)return;i.push({from:o,to:c})}i.forEach(({from:o,to:c})=>{const f=t.slice(a).map(o,-1),h=t.slice(a).map(c),p=t.invert().map(f,-1),x=t.invert().map(h);n.push({oldRange:{from:p,to:x},newRange:{from:f,to:h}})})}),Qhe(n)}function cN(e,t,r){const n=[];return e===t?r.resolve(e).marks().forEach(s=>{const a=r.resolve(e),i=iN(a,s.type);i&&n.push({mark:s,...i})}):r.nodesBetween(e,t,(s,a)=>{!s||(s==null?void 0:s.nodeSize)===void 0||n.push(...s.marks.map(i=>({from:a,to:a+s.nodeSize,mark:i})))}),n}var e0e=(e,t,r,n=20)=>{const s=e.doc.resolve(r);let a=n,i=null;for(;a>0&&i===null;){const o=s.node(a);(o==null?void 0:o.type.name)===t?i=o:a-=1}return[i,a]};function ex(e,t){return t.nodes[e]||t.marks[e]||null}function Mx(e,t,r){return Object.fromEntries(Object.entries(r).filter(([n])=>{const s=e.find(a=>a.type===t&&a.name===n);return s?s.attribute.keepOnSplit:!1}))}var t0e=(e,t=500)=>{let r="";const n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,(s,a,i,o)=>{var c,f;const h=((f=(c=s.type.spec).toText)==null?void 0:f.call(c,{node:s,pos:a,parent:i,index:o}))||s.textContent||"%leaf%";r+=s.isAtom&&!s.isText?h:h.slice(0,Math.max(0,n-a))}),r};function Q_(e,t,r={}){const{empty:n,ranges:s}=e.selection,a=t?Ho(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter(p=>a?a.name===p.type.name:!0).find(p=>wg(p.attrs,r,{strict:!1}));let i=0;const o=[];if(s.forEach(({$from:p,$to:x})=>{const g=p.pos,v=x.pos;e.doc.nodesBetween(g,v,(y,w)=>{if(!y.isText&&!y.marks.length)return;const _=Math.max(g,w),S=Math.min(v,w+y.nodeSize),E=S-_;i+=E,o.push(...y.marks.map(N=>({mark:N,from:_,to:S})))})}),i===0)return!1;const c=o.filter(p=>a?a.name===p.mark.type.name:!0).filter(p=>wg(p.mark.attrs,r,{strict:!1})).reduce((p,x)=>p+x.to-x.from,0),f=o.filter(p=>a?p.mark.type!==a&&p.mark.type.excludes(a):!0).reduce((p,x)=>p+x.to-x.from,0);return(c>0?c+f:c)>=i}function r0e(e,t,r={}){if(!t)return ql(e,null,r)||Q_(e,null,r);const n=B1(t,e.schema);return n==="node"?ql(e,t,r):n==="mark"?Q_(e,t,r):!1}var n0e=(e,t)=>{const{$from:r,$to:n,$anchor:s}=e.selection;if(t){const a=U1(o=>o.type.name===t)(e.selection);if(!a)return!1;const i=e.doc.resolve(a.pos+1);return s.pos+1===i.end()}return!(n.parentOffset<n.parent.nodeSize-2||r.pos!==n.pos)},s0e=e=>{const{$from:t,$to:r}=e.selection;return!(t.parentOffset>0||t.pos!==r.pos)};function HR(e,t){return Array.isArray(t)?t.some(r=>(typeof r=="string"?r:r.name)===e.name):t}function VR(e,t){const{nodeExtensions:r}=Hf(t),n=r.find(i=>i.name===e);if(!n)return!1;const s={name:n.name,options:n.options,storage:n.storage},a=rr(ht(n,"group",s));return typeof a!="string"?!1:a.split(" ").includes("list")}function z1(e,{checkChildren:t=!0,ignoreWhitespace:r=!1}={}){var n;if(r){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((n=e.text)!=null?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let s=!0;return e.content.forEach(a=>{s!==!1&&(z1(a,{ignoreWhitespace:r,checkChildren:t})||(s=!1))}),s}return!1}function CP(e){return e instanceof xt}var RP=class jP{constructor(t){this.position=t}static fromJSON(t){return new jP(t.position)}toJSON(){return{position:this.position}}};function a0e(e,t){const r=t.mapping.mapResult(e.position);return{position:new RP(r.pos),mapResult:r}}function i0e(e){return new RP(e)}function o0e(e,t,r){var n;const{selection:s}=t;let a=null;if(xP(s)&&(a=s.$cursor),a){const o=(n=e.storedMarks)!=null?n:a.marks();return a.parent.type.allowsMarkType(r)&&(!!r.isInSet(o)||!o.some(f=>f.type.excludes(r)))}const{ranges:i}=s;return i.some(({$from:o,$to:c})=>{let f=o.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(r):!1;return e.doc.nodesBetween(o.pos,c.pos,(h,p,x)=>{if(f)return!1;if(h.isInline){const g=!x||x.type.allowsMarkType(r),v=!!r.isInSet(h.marks)||!h.marks.some(y=>y.type.excludes(r));f=g&&v}return!f}),f})}var l0e=(e,t={})=>({tr:r,state:n,dispatch:s})=>{const{selection:a}=r,{empty:i,ranges:o}=a,c=Ho(e,n.schema);if(s)if(i){const f=bP(n,c);r.addStoredMark(c.create({...f,...t}))}else o.forEach(f=>{const h=f.$from.pos,p=f.$to.pos;n.doc.nodesBetween(h,p,(x,g)=>{const v=Math.max(g,h),y=Math.min(g+x.nodeSize,p);x.marks.find(_=>_.type===c)?x.marks.forEach(_=>{c===_.type&&r.addMark(v,y,c.create({..._.attrs,...t}))}):r.addMark(v,y,c.create(t))})});return o0e(n,r,c)},c0e=(e,t)=>({tr:r})=>(r.setMeta(e,t),!0),u0e=(e,t={})=>({state:r,dispatch:n,chain:s})=>{const a=gn(e,r.schema);let i;return r.selection.$anchor.sameParent(r.selection.$head)&&(i=r.selection.$anchor.parent.attrs),a.isTextblock?s().command(({commands:o})=>rR(a,{...i,...t})(r)?!0:o.clearNodes()).command(({state:o})=>rR(a,{...i,...t})(o,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},f0e=e=>({tr:t,dispatch:r})=>{if(r){const{doc:n}=t,s=Ac(e,0,n.content.size),a=xt.create(n,s);t.setSelection(a)}return!0},d0e=(e,t)=>({tr:r,state:n,dispatch:s})=>{const{selection:a}=n;let i,o;return typeof t=="number"?(i=t,o=t):t&&"from"in t&&"to"in t?(i=t.from,o=t.to):(i=a.from,o=a.to),s&&r.doc.nodesBetween(i,o,(c,f)=>{c.isText||r.setNodeMarkup(f,void 0,{...c.attrs,dir:e})}),!0},h0e=e=>({tr:t,dispatch:r})=>{if(r){const{doc:n}=t,{from:s,to:a}=typeof e=="number"?{from:e,to:e}:e,i=St.atStart(n).from,o=St.atEnd(n).to,c=Ac(s,i,o),f=Ac(a,i,o),h=St.create(n,c,f);t.setSelection(h)}return!0},p0e=e=>({state:t,dispatch:r})=>{const n=gn(e,t.schema);return ofe(n)(t,r)};function qR(e,t){const r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(r){const n=r.filter(s=>t==null?void 0:t.includes(s.type.name));e.tr.ensureMarks(n)}}var m0e=({keepMarks:e=!0}={})=>({tr:t,state:r,dispatch:n,editor:s})=>{const{selection:a,doc:i}=t,{$from:o,$to:c}=a,f=s.extensionManager.attributes,h=Mx(f,o.node().type.name,o.node().attrs);if(a instanceof xt&&a.node.isBlock)return!o.parentOffset||!Do(i,o.pos)?!1:(n&&(e&&qR(r,s.extensionManager.splittableMarks),t.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;const p=c.parentOffset===c.parent.content.size,x=o.depth===0?void 0:Vhe(o.node(-1).contentMatchAt(o.indexAfter(-1)));let g=p&&x?[{type:x,attrs:h}]:void 0,v=Do(t.doc,t.mapping.map(o.pos),1,g);if(!g&&!v&&Do(t.doc,t.mapping.map(o.pos),1,x?[{type:x}]:void 0)&&(v=!0,g=x?[{type:x,attrs:h}]:void 0),n){if(v&&(a instanceof St&&t.deleteSelection(),t.split(t.mapping.map(o.pos),1,g),x&&!p&&!o.parentOffset&&o.parent.type!==x)){const y=t.mapping.map(o.before()),w=t.doc.resolve(y);o.node(-1).canReplaceWith(w.index(),w.index()+1,x)&&t.setNodeMarkup(t.mapping.map(o.before()),x)}e&&qR(r,s.extensionManager.splittableMarks),t.scrollIntoView()}return v},x0e=(e,t={})=>({tr:r,state:n,dispatch:s,editor:a})=>{var i;const o=gn(e,n.schema),{$from:c,$to:f}=n.selection,h=n.selection.node;if(h&&h.isBlock||c.depth<2||!c.sameParent(f))return!1;const p=c.node(-1);if(p.type!==o)return!1;const x=a.extensionManager.attributes;if(c.parent.content.size===0&&c.node(-1).childCount===c.indexAfter(-1)){if(c.depth===2||c.node(-3).type!==o||c.index(-2)!==c.node(-2).childCount-1)return!1;if(s){let _=Ge.empty;const S=c.index(-1)?1:c.index(-2)?2:3;for(let V=c.depth-S;V>=c.depth-3;V-=1)_=Ge.from(c.node(V).copy(_));const E=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,N={...Mx(x,c.node().type.name,c.node().attrs),...t},k=((i=o.contentMatch.defaultType)==null?void 0:i.createAndFill(N))||void 0;_=_.append(Ge.from(o.createAndFill(null,k)||void 0));const O=c.before(c.depth-(S-1));r.replace(O,c.after(-E),new it(_,4-S,0));let R=-1;r.doc.nodesBetween(O,r.doc.content.size,(V,I)=>{if(R>-1)return!1;V.isTextblock&&V.content.size===0&&(R=I+1)}),R>-1&&r.setSelection(St.near(r.doc.resolve(R))),r.scrollIntoView()}return!0}const g=f.pos===c.end()?p.contentMatchAt(0).defaultType:null,v={...Mx(x,p.type.name,p.attrs),...t},y={...Mx(x,c.node().type.name,c.node().attrs),...t};r.delete(c.pos,f.pos);const w=g?[{type:o,attrs:v},{type:g,attrs:y}]:[{type:o,attrs:v}];if(!Do(r.doc,c.pos,2))return!1;if(s){const{selection:_,storedMarks:S}=n,{splittableMarks:E}=a.extensionManager,N=S||_.$to.parentOffset&&_.$from.marks();if(r.split(c.pos,2,w).scrollIntoView(),!N||!s)return!0;const k=N.filter(O=>E.includes(O.type.name));r.ensureMarks(k)}return!0},tw=(e,t)=>{const r=U1(i=>i.type===t)(e.selection);if(!r)return!0;const n=e.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(n===void 0)return!0;const s=e.doc.nodeAt(n);return r.node.type===(s==null?void 0:s.type)&&Xl(e.doc,r.pos)&&e.join(r.pos),!0},rw=(e,t)=>{const r=U1(i=>i.type===t)(e.selection);if(!r)return!0;const n=e.doc.resolve(r.start).after(r.depth);if(n===void 0)return!0;const s=e.doc.nodeAt(n);return r.node.type===(s==null?void 0:s.type)&&Xl(e.doc,n)&&e.join(n),!0},g0e=(e,t,r,n={})=>({editor:s,tr:a,state:i,dispatch:o,chain:c,commands:f,can:h})=>{const{extensions:p,splittableMarks:x}=s.extensionManager,g=gn(e,i.schema),v=gn(t,i.schema),{selection:y,storedMarks:w}=i,{$from:_,$to:S}=y,E=_.blockRange(S),N=w||y.$to.parentOffset&&y.$from.marks();if(!E)return!1;const k=U1(O=>VR(O.type.name,p))(y);if(E.depth>=1&&k&&E.depth-k.depth<=1){if(k.node.type===g)return f.liftListItem(v);if(VR(k.node.type.name,p)&&g.validContent(k.node.content)&&o)return c().command(()=>(a.setNodeMarkup(k.pos,g),!0)).command(()=>tw(a,g)).command(()=>rw(a,g)).run()}return!r||!N||!o?c().command(()=>h().wrapInList(g,n)?!0:f.clearNodes()).wrapInList(g,n).command(()=>tw(a,g)).command(()=>rw(a,g)).run():c().command(()=>{const O=h().wrapInList(g,n),R=N.filter(V=>x.includes(V.type.name));return a.ensureMarks(R),O?!0:f.clearNodes()}).wrapInList(g,n).command(()=>tw(a,g)).command(()=>rw(a,g)).run()},y0e=(e,t={},r={})=>({state:n,commands:s})=>{const{extendEmptyMarkRange:a=!1}=r,i=Ho(e,n.schema);return Q_(n,i,t)?s.unsetMark(i,{extendEmptyMarkRange:a}):s.setMark(i,t)},v0e=(e,t,r={})=>({state:n,commands:s})=>{const a=gn(e,n.schema),i=gn(t,n.schema),o=ql(n,a,r);let c;return n.selection.$anchor.sameParent(n.selection.$head)&&(c=n.selection.$anchor.parent.attrs),o?s.setNode(i,c):s.setNode(a,{...c,...r})},b0e=(e,t={})=>({state:r,commands:n})=>{const s=gn(e,r.schema);return ql(r,s,t)?n.lift(s):n.wrapIn(s,t)},w0e=()=>({state:e,dispatch:t})=>{const r=e.plugins;for(let n=0;n<r.length;n+=1){const s=r[n];let a;if(s.spec.isInputRules&&(a=s.getState(e))){if(t){const i=e.tr,o=a.transform;for(let c=o.steps.length-1;c>=0;c-=1)i.step(o.steps[c].invert(o.docs[c]));if(a.text){const c=i.doc.resolve(a.from).marks();i.replaceWith(a.from,a.to,e.schema.text(a.text,c))}else i.delete(a.from,a.to)}return!0}}return!1},_0e=()=>({tr:e,dispatch:t})=>{const{selection:r}=e,{empty:n,ranges:s}=r;return n||t&&s.forEach(a=>{e.removeMark(a.$from.pos,a.$to.pos)}),!0},E0e=(e,t={})=>({tr:r,state:n,dispatch:s})=>{var a;const{extendEmptyMarkRange:i=!1}=t,{selection:o}=r,c=Ho(e,n.schema),{$from:f,empty:h,ranges:p}=o;if(!s)return!0;if(h&&i){let{from:x,to:g}=o;const v=(a=f.marks().find(w=>w.type===c))==null?void 0:a.attrs,y=iN(f,c,v);y&&(x=y.from,g=y.to),r.removeMark(x,g,c)}else p.forEach(x=>{r.removeMark(x.$from.pos,x.$to.pos,c)});return r.removeStoredMark(c),!0},S0e=e=>({tr:t,state:r,dispatch:n})=>{const{selection:s}=r;let a,i;return typeof e=="number"?(a=e,i=e):e&&"from"in e&&"to"in e?(a=e.from,i=e.to):(a=s.from,i=s.to),n&&t.doc.nodesBetween(a,i,(o,c)=>{if(o.isText)return;const f={...o.attrs};delete f.dir,t.setNodeMarkup(c,void 0,f)}),!0},N0e=(e,t={})=>({tr:r,state:n,dispatch:s})=>{let a=null,i=null;const o=B1(typeof e=="string"?e:e.name,n.schema);if(!o)return!1;o==="node"&&(a=gn(e,n.schema)),o==="mark"&&(i=Ho(e,n.schema));let c=!1;return r.selection.ranges.forEach(f=>{const h=f.$from.pos,p=f.$to.pos;let x,g,v,y;r.selection.empty?n.doc.nodesBetween(h,p,(w,_)=>{a&&a===w.type&&(c=!0,v=Math.max(_,h),y=Math.min(_+w.nodeSize,p),x=_,g=w)}):n.doc.nodesBetween(h,p,(w,_)=>{_<h&&a&&a===w.type&&(c=!0,v=Math.max(_,h),y=Math.min(_+w.nodeSize,p),x=_,g=w),_>=h&&_<=p&&(a&&a===w.type&&(c=!0,s&&r.setNodeMarkup(_,void 0,{...w.attrs,...t})),i&&w.marks.length&&w.marks.forEach(S=>{if(i===S.type&&(c=!0,s)){const E=Math.max(_,h),N=Math.min(_+w.nodeSize,p);r.addMark(E,N,i.create({...S.attrs,...t}))}}))}),g&&(x!==void 0&&s&&r.setNodeMarkup(x,void 0,{...g.attrs,...t}),i&&g.marks.length&&g.marks.forEach(w=>{i===w.type&&s&&r.addMark(v,y,i.create({...w.attrs,...t}))}))}),c},T0e=(e,t={})=>({state:r,dispatch:n})=>{const s=gn(e,r.schema);return efe(s,t)(r,n)},k0e=(e,t={})=>({state:r,dispatch:n})=>{const s=gn(e,r.schema);return tfe(s,t)(r,n)},A0e=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(n=>n.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(n=>n!==t):delete this.callbacks[e]),this}once(e,t){const r=(...n)=>{this.off(e,r),t.apply(this,n)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}},H1=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=(t=e.undoable)!=null?t:!0}},C0e=(e,t)=>{if(aN(t))return t.exec(e);const r=t(e);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=e,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function tx(e){var t;const{editor:r,from:n,to:s,text:a,rules:i,plugin:o}=e,{view:c}=r;if(c.composing)return!1;const f=c.state.doc.resolve(n);if(f.parent.type.spec.code||(t=f.nodeBefore||f.nodeAfter)!=null&&t.marks.find(x=>x.type.spec.code))return!1;let h=!1;const p=t0e(f)+a;return i.forEach(x=>{if(h)return;const g=C0e(p,x.find);if(!g)return;const v=c.state.tr,y=P1({state:c.state,transaction:v}),w={from:n-(g[0].length-a.length),to:s},{commands:_,chain:S,can:E}=new L1({editor:r,state:y});x.handler({state:y,range:w,match:g,commands:_,chain:S,can:E})===null||!v.steps.length||(x.undoable&&v.setMeta(o,{transform:v,from:n,to:s,text:a}),c.dispatch(v),h=!0)}),h}function R0e(e){const{editor:t,rules:r}=e,n=new Fr({state:{init(){return null},apply(s,a,i){const o=s.getMeta(n);if(o)return o;const c=s.getMeta("applyInputRules");return!!c&&setTimeout(()=>{let{text:h}=c;typeof h=="string"?h=h:h=lN(Ge.from(h),i.schema);const{from:p}=c,x=p+h.length;tx({editor:t,from:p,to:x,text:h,rules:r,plugin:n})}),s.selectionSet||s.docChanged?null:a}},props:{handleTextInput(s,a,i,o){return tx({editor:t,from:a,to:i,text:o,rules:r,plugin:n})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:a}=s.state.selection;a&&tx({editor:t,from:a.pos,to:a.pos,text:"",rules:r,plugin:n})}),!1)},handleKeyDown(s,a){if(a.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?tx({editor:t,from:i.pos,to:i.pos,text:`
`,rules:r,plugin:n}):!1}},isInputRules:!0});return n}function j0e(e){return Object.prototype.toString.call(e).slice(8,-1)}function rx(e){return j0e(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function OP(e,t){const r={...e};return rx(e)&&rx(t)&&Object.keys(t).forEach(n=>{rx(t[n])&&rx(e[n])?r[n]=OP(e[n],t[n]):r[n]=t[n]}),r}var uN=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...e},this.name=this.config.name}get options(){return{...rr(ht(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...rr(ht(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(e={}){const t=this.extend({...this.config,addOptions:()=>OP(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new this.constructor({...this.config,...e});return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},xu=class DP extends uN{constructor(){super(...arguments),this.type="mark"}static create(t={}){const r=typeof t=="function"?t():t;return new DP(r)}static handleExit({editor:t,mark:r}){const{tr:n}=t.state,s=t.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(f=>(f==null?void 0:f.type.name)===r.name))return!1;const c=i.find(f=>(f==null?void 0:f.type.name)===r.name);return c&&n.removeStoredMark(c),n.insertText(" ",s.pos),t.view.dispatch(n),!0}return!1}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}};function O0e(e){return typeof e=="number"}var D0e=class{constructor(e){this.find=e.find,this.handler=e.handler}},I0e=(e,t,r)=>{if(aN(t))return[...e.matchAll(t)];const n=t(e,r);return n?n.map(s=>{const a=[s.text];return a.index=s.index,a.input=e,a.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(s.replaceWith)),a}):[]};function M0e(e){const{editor:t,state:r,from:n,to:s,rule:a,pasteEvent:i,dropEvent:o}=e,{commands:c,chain:f,can:h}=new L1({editor:t,state:r}),p=[];return r.doc.nodesBetween(n,s,(g,v)=>{var y,w,_,S,E;if((w=(y=g.type)==null?void 0:y.spec)!=null&&w.code||!(g.isText||g.isTextblock||g.isInline))return;const N=(E=(S=(_=g.content)==null?void 0:_.size)!=null?S:g.nodeSize)!=null?E:0,k=Math.max(n,v),O=Math.min(s,v+N);if(k>=O)return;const R=g.isText?g.text||"":g.textBetween(k-v,O-v,void 0,"");I0e(R,a.find,i).forEach(I=>{if(I.index===void 0)return;const Z=k+I.index+1,ce=Z+I[0].length,F={from:r.tr.mapping.map(Z),to:r.tr.mapping.map(ce)},X=a.handler({state:r,range:F,match:I,commands:c,chain:f,can:h,pasteEvent:i,dropEvent:o});p.push(X)})}),p.every(g=>g!==null)}var nx=null,F0e=e=>{var t;const r=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=r.clipboardData)==null||t.setData("text/html",e),r};function P0e(e){const{editor:t,rules:r}=e;let n=null,s=!1,a=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}const c=({state:h,from:p,to:x,rule:g,pasteEvt:v})=>{const y=h.tr,w=P1({state:h,transaction:y});if(!(!M0e({editor:t,state:w,from:Math.max(p-1,0),to:x.b-1,rule:g,pasteEvent:v,dropEvent:o})||!y.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,y}};return r.map(h=>new Fr({view(p){const x=v=>{var y;n=(y=p.dom.parentElement)!=null&&y.contains(v.target)?p.dom.parentElement:null,n&&(nx=t)},g=()=>{nx&&(nx=null)};return window.addEventListener("dragstart",x),window.addEventListener("dragend",g),{destroy(){window.removeEventListener("dragstart",x),window.removeEventListener("dragend",g)}}},props:{handleDOMEvents:{drop:(p,x)=>{if(a=n===p.dom.parentElement,o=x,!a){const g=nx;g!=null&&g.isEditable&&setTimeout(()=>{const v=g.state.selection;v&&g.commands.deleteRange({from:v.from,to:v.to})},10)}return!1},paste:(p,x)=>{var g;const v=(g=x.clipboardData)==null?void 0:g.getData("text/html");return i=x,s=!!(v!=null&&v.includes("data-pm-slice")),!1}}},appendTransaction:(p,x,g)=>{const v=p[0],y=v.getMeta("uiEvent")==="paste"&&!s,w=v.getMeta("uiEvent")==="drop"&&!a,_=v.getMeta("applyPasteRules"),S=!!_;if(!y&&!w&&!S)return;if(S){let{text:k}=_;typeof k=="string"?k=k:k=lN(Ge.from(k),g.schema);const{from:O}=_,R=O+k.length,V=F0e(k);return c({rule:h,state:g,from:O,to:{b:R},pasteEvt:V})}const E=x.doc.content.findDiffStart(g.doc.content),N=x.doc.content.findDiffEnd(g.doc.content);if(!(!O0e(E)||!N||E===N.b))return c({rule:h,state:g,from:E,to:N,pasteEvt:i})}}))}var V1=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=e,this.extensions=SP(e),this.schema=Khe(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:ex(t.name,this.schema)},n=ht(t,"addCommands",r);return n?{...e,...n()}:e},{})}get plugins(){const{editor:e}=this;return Eg([...this.extensions].reverse()).flatMap(n=>{const s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:ex(n.name,this.schema)},a=[],i=ht(n,"addKeyboardShortcuts",s);let o={};if(n.type==="mark"&&ht(n,"exitable",s)&&(o.ArrowRight=()=>xu.handleExit({editor:e,mark:n})),i){const x=Object.fromEntries(Object.entries(i()).map(([g,v])=>[g,()=>v({editor:e})]));o={...o,...x}}const c=Jde(o);a.push(c);const f=ht(n,"addInputRules",s);if(HR(n,e.options.enableInputRules)&&f){const x=f();if(x&&x.length){const g=R0e({editor:e,rules:x}),v=Array.isArray(g)?g:[g];a.push(...v)}}const h=ht(n,"addPasteRules",s);if(HR(n,e.options.enablePasteRules)&&h){const x=h();if(x&&x.length){const g=P0e({editor:e,rules:x});a.push(...g)}}const p=ht(n,"addProseMirrorPlugins",s);if(p){const x=p();a.push(...x)}return a})}get attributes(){return EP(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Hf(this.extensions);return Object.fromEntries(t.filter(r=>!!ht(r,"addNodeView")).map(r=>{const n=this.attributes.filter(c=>c.type===r.name),s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:gn(r.name,this.schema)},a=ht(r,"addNodeView",s);if(!a)return[];const i=a();if(!i)return[];const o=(c,f,h,p,x)=>{const g=j0(c,n);return i({node:c,view:f,getPos:h,decorations:p,innerDecorations:x,editor:e,extension:r,HTMLAttributes:g})};return[r.name,o]}))}dispatchTransaction(e){const{editor:t}=this;return Eg([...this.extensions].reverse()).reduceRight((n,s)=>{const a={name:s.name,options:s.options,storage:this.editor.extensionStorage[s.name],editor:t,type:ex(s.name,this.schema)},i=ht(s,"dispatchTransaction",a);return i?o=>{i.call(a,{transaction:o,next:n})}:n},e)}get markViews(){const{editor:e}=this,{markExtensions:t}=Hf(this.extensions);return Object.fromEntries(t.filter(r=>!!ht(r,"addMarkView")).map(r=>{const n=this.attributes.filter(o=>o.type===r.name),s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:Ho(r.name,this.schema)},a=ht(r,"addMarkView",s);if(!a)return[];const i=(o,c,f)=>{const h=j0(o,n);return a()({mark:o,view:c,inline:f,editor:e,extension:r,HTMLAttributes:h,updateAttributes:p=>{J0e(o,e,p)}})};return[r.name,i]}))}setupExtensions(){const e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(t=>[t.name,t.storage])),e.forEach(t=>{var r;const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:ex(t.name,this.schema)};t.type==="mark"&&((r=rr(ht(t,"keepOnSplit",n)))==null||r)&&this.splittableMarks.push(t.name);const s=ht(t,"onBeforeCreate",n),a=ht(t,"onCreate",n),i=ht(t,"onUpdate",n),o=ht(t,"onSelectionUpdate",n),c=ht(t,"onTransaction",n),f=ht(t,"onFocus",n),h=ht(t,"onBlur",n),p=ht(t,"onDestroy",n);s&&this.editor.on("beforeCreate",s),a&&this.editor.on("create",a),i&&this.editor.on("update",i),o&&this.editor.on("selectionUpdate",o),c&&this.editor.on("transaction",c),f&&this.editor.on("focus",f),h&&this.editor.on("blur",h),p&&this.editor.on("destroy",p)})}};V1.resolve=SP;V1.sort=Eg;V1.flatten=oN;var L0e={};sN(L0e,{ClipboardTextSerializer:()=>MP,Commands:()=>FP,Delete:()=>PP,Drop:()=>LP,Editable:()=>BP,FocusEvents:()=>zP,Keymap:()=>HP,Paste:()=>VP,Tabindex:()=>qP,TextDirection:()=>WP,focusEventsPluginKey:()=>UP});var en=class IP extends uN{constructor(){super(...arguments),this.type="extension"}static create(t={}){const r=typeof t=="function"?t():t;return new IP(r)}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}},MP=en.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Fr({key:new Nn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:r}=e,{doc:n,selection:s}=t,{ranges:a}=s,i=Math.min(...a.map(h=>h.$from.pos)),o=Math.max(...a.map(h=>h.$to.pos)),c=TP(r);return NP(n,{from:i,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}}),FP=en.create({name:"commands",addCommands(){return{...pP}}}),PP=en.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var r,n,s;const a=()=>{var i,o,c,f;if((f=(c=(o=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:o.filterTransaction)==null?void 0:c.call(o,e))!=null?f:e.getMeta("y-sync$"))return;const h=wP(e.before,[e,...t]);AP(h).forEach(g=>{h.mapping.mapResult(g.oldRange.from).deletedAfter&&h.mapping.mapResult(g.oldRange.to).deletedBefore&&h.before.nodesBetween(g.oldRange.from,g.oldRange.to,(v,y)=>{const w=y+v.nodeSize-2,_=g.oldRange.from<=y&&w<=g.oldRange.to;this.editor.emit("delete",{type:"node",node:v,from:y,to:w,newFrom:h.mapping.map(y),newTo:h.mapping.map(w),deletedRange:g.oldRange,newRange:g.newRange,partial:!_,editor:this.editor,transaction:e,combinedTransform:h})})});const x=h.mapping;h.steps.forEach((g,v)=>{var y,w;if(g instanceof oi){const _=x.slice(v).map(g.from,-1),S=x.slice(v).map(g.to),E=x.invert().map(_,-1),N=x.invert().map(S),k=(y=h.doc.nodeAt(_-1))==null?void 0:y.marks.some(R=>R.eq(g.mark)),O=(w=h.doc.nodeAt(S))==null?void 0:w.marks.some(R=>R.eq(g.mark));this.editor.emit("delete",{type:"mark",mark:g.mark,from:g.from,to:g.to,deletedRange:{from:E,to:N},newRange:{from:_,to:S},partial:!!(O||k),editor:this.editor,transaction:e,combinedTransform:h})}})};(s=(n=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:n.async)==null||s?setTimeout(a,0):a()}}),LP=en.create({name:"drop",addProseMirrorPlugins(){return[new Fr({key:new Nn("tiptapDrop"),props:{handleDrop:(e,t,r,n)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:r,moved:n})}}})]}}),BP=en.create({name:"editable",addProseMirrorPlugins(){return[new Fr({key:new Nn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),UP=new Nn("focusEvents"),zP=en.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new Fr({key:UP,props:{handleDOMEvents:{focus:(t,r)=>{e.isFocused=!0;const n=e.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,r)=>{e.isFocused=!1;const n=e.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),HP=en.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:o})=>{const{selection:c,doc:f}=o,{empty:h,$anchor:p}=c,{pos:x,parent:g}=p,v=p.parent.isTextblock&&x>0?o.doc.resolve(x-1):p,y=v.parent.type.spec.isolating,w=p.pos-p.parentOffset,_=y&&v.parent.childCount===1?w===p.pos:It.atStart(f).from===x;return!h||!g.type.isTextblock||g.textContent.length||!_||_&&p.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},s={...n},a={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return _g()||vP()?a:s},addProseMirrorPlugins(){return[new Fr({key:new Nn("clearDocument"),appendTransaction:(e,t,r)=>{if(e.some(y=>y.getMeta("composition")))return;const n=e.some(y=>y.docChanged)&&!t.doc.eq(r.doc),s=e.some(y=>y.getMeta("preventClearDocument"));if(!n||s)return;const{empty:a,from:i,to:o}=t.selection,c=It.atStart(t.doc).from,f=It.atEnd(t.doc).to;if(a||!(i===c&&o===f)||!z1(r.doc))return;const x=r.tr,g=P1({state:r,transaction:x}),{commands:v}=new L1({editor:this.editor,state:g});if(v.clearNodes(),!!x.steps.length)return x}})]}}),VP=en.create({name:"paste",addProseMirrorPlugins(){return[new Fr({key:new Nn("tiptapPaste"),props:{handlePaste:(e,t,r)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:r})}}})]}}),qP=en.create({name:"tabindex",addProseMirrorPlugins(){return[new Fr({key:new Nn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),WP=en.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:e}=Hf(this.extensions);return[{types:e.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{const r=t.getAttribute("dir");return r&&(r==="ltr"||r==="rtl"||r==="auto")?r:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new Fr({key:new Nn("textDirection"),props:{attributes:()=>{const e=this.options.direction;return e?{dir:e}:{}}}})]}}),B0e=class Oh{constructor(t,r,n=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=r,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let r=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}r=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:r,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),r=this.resolvedPos.doc.resolve(t);return new Oh(r,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new Oh(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new Oh(t,this.editor)}get children(){const t=[];return this.node.content.forEach((r,n)=>{const s=r.isBlock&&!r.isTextblock,a=r.isAtom&&!r.isText,i=r.isInline,o=this.pos+n+(a?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const c=this.resolvedPos.doc.resolve(o);if(!s&&!i&&c.depth<=this.depth)return;const f=new Oh(c,this.editor,s,s||i?r:null);s&&(f.actualDepth=this.depth+1),t.push(f)}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,r={}){let n=null,s=this.parent;for(;s&&!n;){if(s.node.type.name===t)if(Object.keys(r).length>0){const a=s.node.attrs,i=Object.keys(r);for(let o=0;o<i.length;o+=1){const c=i[o];if(a[c]!==r[c])break}}else n=s;s=s.parent}return n}querySelector(t,r={}){return this.querySelectorAll(t,r,!0)[0]||null}querySelectorAll(t,r={},n=!1){let s=[];if(!this.children||this.children.length===0)return s;const a=Object.keys(r);return this.children.forEach(i=>{n&&s.length>0||(i.node.type.name===t&&a.every(c=>r[c]===i.node.attrs[c])&&s.push(i),!(n&&s.length>0)&&(s=s.concat(i.querySelectorAll(t,r,n))))}),s}setAttribute(t){const{tr:r}=this.editor.state;r.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(r)}},U0e=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function z0e(e,t,r){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute("data-tiptap-style",""),s.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(s),s}var H0e=class extends A0e{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:a0e,createMappablePosition:i0e},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:s,moved:a})=>this.options.onDrop(n,s,a)),this.on("paste",({event:n,slice:s})=>this.options.onPaste(n,s)),this.on("delete",this.options.onDelete);const t=this.createDoc(),r=gP(t,this.options.autofocus);this.editorState=pf.create({doc:t,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;e!=null&&e.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=z0e(U0e,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){const r=_P(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(s=>{const a=typeof s=="string"?`${s}$`:s.key;r=r.filter(i=>!i.key.startsWith(a))}),t.length===r.length)return;const n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[BP,MP.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:t.blockSeparator}),FP,zP,HP,qP,LP,VP,PP,WP.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new V1(n,this)}createCommandManager(){this.commandManager=new L1({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=Z_(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),e=Z_(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){const{editorProps:t,enableExtensionDispatchTransaction:r}=this.options,n=t.dispatchTransaction||this.dispatchTransaction.bind(this),s=r?this.extensionManager.dispatchTransaction(n):n;this.editorView=new dP(e,{...t,attributes:{role:"textbox",...t==null?void 0:t.attributes},dispatchTransaction:s,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(f=>{var h;return(h=this.capturedTransaction)==null?void 0:h.step(f)});return}const{state:t,transactions:r}=this.state.applyTransaction(e),n=!this.state.selection.eq(t.selection),s=r.includes(e),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!s)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:r.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=r.findLast(f=>f.getMeta("focus")||f.getMeta("blur")),o=i==null?void 0:i.getMeta("focus"),c=i==null?void 0:i.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:i}),c&&this.emit("blur",{editor:this,event:c.event,transaction:i}),!(e.getMeta("preventUpdate")||!r.some(f=>f.docChanged)||a.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:r.slice(1)})}getAttributes(e){return kP(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,n=typeof e=="string"?t:e;return r0e(this.state,r,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return lN(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return Yhe(this.state.doc,{blockSeparator:t,textSerializers:{...TP(this.schema),...r}})}get isEmpty(){return z1(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return(t=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?t:!0}$node(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new B0e(t,this)}get $doc(){return this.$pos(0)}};function Vf(e){return new H1({find:e.find,handler:({state:t,range:r,match:n})=>{const s=rr(e.getAttributes,void 0,n);if(s===!1||s===null)return null;const{tr:a}=t,i=n[n.length-1],o=n[0];if(i){const c=o.search(/\S/),f=r.from+o.indexOf(i),h=f+i.length;if(cN(r.from,r.to,t.doc).filter(g=>g.mark.type.excluded.find(y=>y===e.type&&y!==g.mark.type)).filter(g=>g.to>f).length)return null;h<r.to&&a.delete(h,r.to),f>r.from&&a.delete(r.from+c,f);const x=r.from+c+i.length;a.addMark(r.from+c,x,e.type.create(s||{})),a.removeStoredMark(e.type)}},undoable:e.undoable})}function V0e(e){return new H1({find:e.find,handler:({state:t,range:r,match:n})=>{const s=rr(e.getAttributes,void 0,n)||{},{tr:a}=t,i=r.from;let o=r.to;const c=e.type.create(s);if(n[1]){const f=n[0].lastIndexOf(n[1]);let h=i+f;h>o?h=o:o=h+n[1].length;const p=n[0][n[0].length-1];a.insertText(p,i+n[0].length-1),a.replaceWith(h,o,c)}else if(n[0]){const f=e.type.isInline?i:i-1;a.insert(f,e.type.create(s)).delete(a.mapping.map(i),a.mapping.map(o))}a.scrollIntoView()},undoable:e.undoable})}function eE(e){return new H1({find:e.find,handler:({state:t,range:r,match:n})=>{const s=t.doc.resolve(r.from),a=rr(e.getAttributes,void 0,n)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;t.tr.delete(r.from,r.to).setBlockType(r.from,r.from,e.type,a)},undoable:e.undoable})}function qf(e){return new H1({find:e.find,handler:({state:t,range:r,match:n,chain:s})=>{const a=rr(e.getAttributes,void 0,n)||{},i=t.tr.delete(r.from,r.to),c=i.doc.resolve(r.from).blockRange(),f=c&&HS(c,e.type,a);if(!f)return null;if(i.wrap(c,f),e.keepMarks&&e.editor){const{selection:p,storedMarks:x}=t,{splittableMarks:g}=e.editor.extensionManager,v=x||p.$to.parentOffset&&p.$from.marks();if(v){const y=v.filter(w=>g.includes(w.type.name));i.ensureMarks(y)}}if(e.keepAttributes){const p=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(p,a).run()}const h=i.doc.resolve(r.from-1).nodeBefore;h&&h.type===e.type&&Xl(i.doc,r.from-1)&&(!e.joinPredicate||e.joinPredicate(n,h))&&i.join(r.from-1)},undoable:e.undoable})}function q0e(e,t){const{selection:r}=e,{$from:n}=r;if(r instanceof xt){const a=n.index();return n.parent.canReplaceWith(a,a+1,t)}let s=n.depth;for(;s>=0;){const a=n.index(s);if(n.node(s).contentMatchAt(a).matchType(t))return!0;s-=1}return!1}var W0e={};sN(W0e,{createAtomBlockMarkdownSpec:()=>$0e,createBlockMarkdownSpec:()=>G0e,createInlineMarkdownSpec:()=>Y0e,parseAttributes:()=>fN,parseIndentedBlocks:()=>tE,renderNestedMarkdownContent:()=>hN,serializeAttributes:()=>dN});function fN(e){if(!(e!=null&&e.trim()))return{};const t={},r=[],n=e.replace(/["']([^"']*)["']/g,f=>(r.push(f),`__QUOTED_${r.length-1}__`)),s=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const f=s.map(h=>h.trim().slice(1));t.class=f.join(" ")}const a=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);a&&(t.id=a[1]);const i=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(i)).forEach(([,f,h])=>{var p;const x=parseInt(((p=h.match(/__QUOTED_(\d+)__/))==null?void 0:p[1])||"0",10),g=r[x];g&&(t[f]=g.slice(1,-1))});const c=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return c&&c.split(/\s+/).filter(Boolean).forEach(h=>{h.match(/^[a-zA-Z][\w-]*$/)&&(t[h]=!0)}),t}function dN(e){if(!e||Object.keys(e).length===0)return"";const t=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(n=>t.push(`.${n}`)),e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([r,n])=>{r==="class"||r==="id"||(n===!0?t.push(r):n!==!1&&n!=null&&t.push(`${r}="${String(n)}"`))}),t.join(" ")}function $0e(e){const{nodeName:t,name:r,parseAttributes:n=fN,serializeAttributes:s=dN,defaultAttributes:a={},requiredAttributes:i=[],allowedAttributes:o}=e,c=r||t,f=h=>{if(!o)return h;const p={};return o.forEach(x=>{x in h&&(p[x]=h[x])}),p};return{parseMarkdown:(h,p)=>{const x={...a,...h.attributes};return p.createNode(t,x,[])},markdownTokenizer:{name:t,level:"block",start(h){var p;const x=new RegExp(`^:::${c}(?:\\s|$)`,"m"),g=(p=h.match(x))==null?void 0:p.index;return g!==void 0?g:-1},tokenize(h,p,x){const g=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),v=h.match(g);if(!v)return;const y=v[1]||"",w=n(y);if(!i.find(S=>!(S in w)))return{type:t,raw:v[0],attributes:w}}},renderMarkdown:h=>{const p=f(h.attrs||{}),x=s(p),g=x?` {${x}}`:"";return`:::${c}${g} :::`}}}function G0e(e){const{nodeName:t,name:r,getContent:n,parseAttributes:s=fN,serializeAttributes:a=dN,defaultAttributes:i={},content:o="block",allowedAttributes:c}=e,f=r||t,h=p=>{if(!c)return p;const x={};return c.forEach(g=>{g in p&&(x[g]=p[g])}),x};return{parseMarkdown:(p,x)=>{let g;if(n){const y=n(p);g=typeof y=="string"?[{type:"text",text:y}]:y}else o==="block"?g=x.parseChildren(p.tokens||[]):g=x.parseInline(p.tokens||[]);const v={...i,...p.attributes};return x.createNode(t,v,g)},markdownTokenizer:{name:t,level:"block",start(p){var x;const g=new RegExp(`^:::${f}`,"m"),v=(x=p.match(g))==null?void 0:x.index;return v!==void 0?v:-1},tokenize(p,x,g){var v;const y=new RegExp(`^:::${f}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),w=p.match(y);if(!w)return;const[_,S=""]=w,E=s(S);let N=1;const k=_.length;let O="";const R=/^:::([\w-]*)(\s.*)?/gm,V=p.slice(k);for(R.lastIndex=0;;){const I=R.exec(V);if(I===null)break;const Z=I.index,ce=I[1];if(!((v=I[2])!=null&&v.endsWith(":::"))){if(ce)N+=1;else if(N-=1,N===0){const F=V.slice(0,Z);O=F.trim();const X=p.slice(0,k+Z+I[0].length);let P=[];if(O)if(o==="block")for(P=g.blockTokens(F),P.forEach(ie=>{ie.text&&(!ie.tokens||ie.tokens.length===0)&&(ie.tokens=g.inlineTokens(ie.text))});P.length>0;){const ie=P[P.length-1];if(ie.type==="paragraph"&&(!ie.text||ie.text.trim()===""))P.pop();else break}else P=g.inlineTokens(O);return{type:t,raw:X,attributes:E,content:O,tokens:P}}}}}},renderMarkdown:(p,x)=>{const g=h(p.attrs||{}),v=a(g),y=v?` {${v}}`:"",w=x.renderChildren(p.content||[],`

`);return`:::${f}${y}

${w}

:::`}}}function K0e(e){if(!e.trim())return{};const t={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(e);for(;n!==null;){const[,s,a,i]=n;t[s]=a||i,n=r.exec(e)}return t}function X0e(e){return Object.entries(e).filter(([,t])=>t!=null).map(([t,r])=>`${t}="${r}"`).join(" ")}function Y0e(e){const{nodeName:t,name:r,getContent:n,parseAttributes:s=K0e,serializeAttributes:a=X0e,defaultAttributes:i={},selfClosing:o=!1,allowedAttributes:c}=e,f=r||t,h=x=>{if(!c)return x;const g={};return c.forEach(v=>{const y=typeof v=="string"?v:v.name,w=typeof v=="string"?void 0:v.skipIfDefault;if(y in x){const _=x[y];if(w!==void 0&&_===w)return;g[y]=_}}),g},p=f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(x,g)=>{const v={...i,...x.attributes};if(o)return g.createNode(t,v);const y=n?n(x):x.content||"";return y?g.createNode(t,v,[g.createTextNode(y)]):g.createNode(t,v,[])},markdownTokenizer:{name:t,level:"inline",start(x){const g=o?new RegExp(`\\[${p}\\s*[^\\]]*\\]`):new RegExp(`\\[${p}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${p}\\]`),v=x.match(g),y=v==null?void 0:v.index;return y!==void 0?y:-1},tokenize(x,g,v){const y=o?new RegExp(`^\\[${p}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${p}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${p}\\]`),w=x.match(y);if(!w)return;let _="",S="";if(o){const[,N]=w;S=N}else{const[,N,k]=w;S=N,_=k||""}const E=s(S.trim());return{type:t,raw:w[0],content:_.trim(),attributes:E}}},renderMarkdown:x=>{let g="";n?g=n(x):x.content&&x.content.length>0&&(g=x.content.filter(_=>_.type==="text").map(_=>_.text).join(""));const v=h(x.attrs||{}),y=a(v),w=y?` ${y}`:"";return o?`[${f}${w}]`:`[${f}${w}]${g}[/${f}]`}}}function tE(e,t,r){var n,s,a,i;const o=e.split(`
`),c=[];let f="",h=0;const p=t.baseIndentSize||2;for(;h<o.length;){const x=o[h],g=x.match(t.itemPattern);if(!g){if(c.length>0)break;if(x.trim()===""){h+=1,f=`${f}${x}
`;continue}else return}const v=t.extractItemData(g),{indentLevel:y,mainContent:w}=v;f=`${f}${x}
`;const _=[w];for(h+=1;h<o.length;){const k=o[h];if(k.trim()===""){const R=o.slice(h+1).findIndex(Z=>Z.trim()!=="");if(R===-1)break;if((((s=(n=o[h+1+R].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:s.length)||0)>y){_.push(k),f=`${f}${k}
`,h+=1;continue}else break}if((((i=(a=k.match(/^(\s*)/))==null?void 0:a[1])==null?void 0:i.length)||0)>y)_.push(k),f=`${f}${k}
`,h+=1;else break}let S;const E=_.slice(1);if(E.length>0){const k=E.map(O=>O.slice(y+p)).join(`
`);k.trim()&&(t.customNestedParser?S=t.customNestedParser(k):S=r.blockTokens(k))}const N=t.createToken(v,S);c.push(N)}if(c.length!==0)return{items:c,raw:f}}function hN(e,t,r,n){if(!e||!Array.isArray(e.content))return"";const s=typeof r=="function"?r(n):r,[a,...i]=e.content,o=t.renderChildren([a]),c=[`${s}${o}`];return i&&i.length>0&&i.forEach(f=>{const h=t.renderChildren([f]);if(h){const p=h.split(`
`).map(x=>x?t.indent(x):"").join(`
`);c.push(p)}}),c.join(`
`)}function J0e(e,t,r={}){const{state:n}=t,{doc:s,tr:a}=n,i=e;s.descendants((o,c)=>{const f=a.mapping.map(c),h=a.mapping.map(c)+o.nodeSize;let p=null;if(o.marks.forEach(g=>{if(g!==i)return!1;p=g}),!p)return;let x=!1;if(Object.keys(r).forEach(g=>{r[g]!==p.attrs[g]&&(x=!0)}),x){const g=e.type.create({...e.attrs,...r});a.removeMark(f,h,e.type),a.addMark(f,h,g)}}),a.docChanged&&t.view.dispatch(a)}var da=class $P extends uN{constructor(){super(...arguments),this.type="node"}static create(t={}){const r=typeof t=="function"?t():t;return new $P(r)}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}};function iu(e){return new D0e({find:e.find,handler:({state:t,range:r,match:n,pasteEvent:s})=>{const a=rr(e.getAttributes,void 0,n,s);if(a===!1||a===null)return null;const{tr:i}=t,o=n[n.length-1],c=n[0];let f=r.to;if(o){const h=c.search(/\S/),p=r.from+c.indexOf(o),x=p+o.length;if(cN(r.from,r.to,t.doc).filter(v=>v.mark.type.excluded.find(w=>w===e.type&&w!==v.mark.type)).filter(v=>v.to>p).length)return null;x<r.to&&i.delete(x,r.to),p>r.from&&i.delete(r.from+h,p),f=r.from+h+o.length,i.addMark(r.from+h,f,e.type.create(a||{})),i.removeStoredMark(e.type)}}})}const{getOwnPropertyNames:Z0e,getOwnPropertySymbols:Q0e}=Object,{hasOwnProperty:epe}=Object.prototype;function nw(e,t){return function(n,s,a){return e(n,s,a)&&t(n,s,a)}}function sx(e){return function(r,n,s){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,s);const{cache:a}=s,i=a.get(r),o=a.get(n);if(i&&o)return i===n&&o===r;a.set(r,n),a.set(n,r);const c=e(r,n,s);return a.delete(r),a.delete(n),c}}function tpe(e){return e!=null?e[Symbol.toStringTag]:void 0}function WR(e){return Z0e(e).concat(Q0e(e))}const rpe=Object.hasOwn||((e,t)=>epe.call(e,t));function gu(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const npe="__v",spe="__o",ape="_owner",{getOwnPropertyDescriptor:$R,keys:GR}=Object;function ipe(e,t){return e.byteLength===t.byteLength&&Sg(new Uint8Array(e),new Uint8Array(t))}function ope(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function lpe(e,t){return e.byteLength===t.byteLength&&Sg(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function cpe(e,t){return gu(e.getTime(),t.getTime())}function upe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function fpe(e,t){return e===t}function KR(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const s=new Array(n),a=e.entries();let i,o,c=0;for(;(i=a.next())&&!i.done;){const f=t.entries();let h=!1,p=0;for(;(o=f.next())&&!o.done;){if(s[p]){p++;continue}const x=i.value,g=o.value;if(r.equals(x[0],g[0],c,p,e,t,r)&&r.equals(x[1],g[1],x[0],g[0],e,t,r)){h=s[p]=!0;break}p++}if(!h)return!1;c++}return!0}const dpe=gu;function hpe(e,t,r){const n=GR(e);let s=n.length;if(GR(t).length!==s)return!1;for(;s-- >0;)if(!GP(e,t,r,n[s]))return!1;return!0}function xh(e,t,r){const n=WR(e);let s=n.length;if(WR(t).length!==s)return!1;let a,i,o;for(;s-- >0;)if(a=n[s],!GP(e,t,r,a)||(i=$R(e,a),o=$R(t,a),(i||o)&&(!i||!o||i.configurable!==o.configurable||i.enumerable!==o.enumerable||i.writable!==o.writable)))return!1;return!0}function ppe(e,t){return gu(e.valueOf(),t.valueOf())}function mpe(e,t){return e.source===t.source&&e.flags===t.flags}function XR(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const s=new Array(n),a=e.values();let i,o;for(;(i=a.next())&&!i.done;){const c=t.values();let f=!1,h=0;for(;(o=c.next())&&!o.done;){if(!s[h]&&r.equals(i.value,o.value,i.value,o.value,e,t,r)){f=s[h]=!0;break}h++}if(!f)return!1}return!0}function Sg(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function xpe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function GP(e,t,r,n){return(n===ape||n===spe||n===npe)&&(e.$$typeof||t.$$typeof)?!0:rpe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const gpe="[object ArrayBuffer]",ype="[object Arguments]",vpe="[object Boolean]",bpe="[object DataView]",wpe="[object Date]",_pe="[object Error]",Epe="[object Map]",Spe="[object Number]",Npe="[object Object]",Tpe="[object RegExp]",kpe="[object Set]",Ape="[object String]",Cpe={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},Rpe="[object URL]",jpe=Object.prototype.toString;function Ope({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:s,areFunctionsEqual:a,areMapsEqual:i,areNumbersEqual:o,areObjectsEqual:c,arePrimitiveWrappersEqual:f,areRegExpsEqual:h,areSetsEqual:p,areTypedArraysEqual:x,areUrlsEqual:g,unknownTagComparators:v}){return function(w,_,S){if(w===_)return!0;if(w==null||_==null)return!1;const E=typeof w;if(E!==typeof _)return!1;if(E!=="object")return E==="number"?o(w,_,S):E==="function"?a(w,_,S):!1;const N=w.constructor;if(N!==_.constructor)return!1;if(N===Object)return c(w,_,S);if(Array.isArray(w))return t(w,_,S);if(N===Date)return n(w,_,S);if(N===RegExp)return h(w,_,S);if(N===Map)return i(w,_,S);if(N===Set)return p(w,_,S);const k=jpe.call(w);if(k===wpe)return n(w,_,S);if(k===Tpe)return h(w,_,S);if(k===Epe)return i(w,_,S);if(k===kpe)return p(w,_,S);if(k===Npe)return typeof w.then!="function"&&typeof _.then!="function"&&c(w,_,S);if(k===Rpe)return g(w,_,S);if(k===_pe)return s(w,_,S);if(k===ype)return c(w,_,S);if(Cpe[k])return x(w,_,S);if(k===gpe)return e(w,_,S);if(k===bpe)return r(w,_,S);if(k===vpe||k===Spe||k===Ape)return f(w,_,S);if(v){let O=v[k];if(!O){const R=tpe(w);R&&(O=v[R])}if(O)return O(w,_,S)}return!1}}function Dpe({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:ipe,areArraysEqual:r?xh:ope,areDataViewsEqual:lpe,areDatesEqual:cpe,areErrorsEqual:upe,areFunctionsEqual:fpe,areMapsEqual:r?nw(KR,xh):KR,areNumbersEqual:dpe,areObjectsEqual:r?xh:hpe,arePrimitiveWrappersEqual:ppe,areRegExpsEqual:mpe,areSetsEqual:r?nw(XR,xh):XR,areTypedArraysEqual:r?nw(Sg,xh):Sg,areUrlsEqual:xpe,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const s=sx(n.areArraysEqual),a=sx(n.areMapsEqual),i=sx(n.areObjectsEqual),o=sx(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:s,areMapsEqual:a,areObjectsEqual:i,areSetsEqual:o})}return n}function Ipe(e){return function(t,r,n,s,a,i,o){return e(t,r,o)}}function Mpe({circular:e,comparator:t,createState:r,equals:n,strict:s}){if(r)return function(o,c){const{cache:f=e?new WeakMap:void 0,meta:h}=r();return t(o,c,{cache:f,equals:n,meta:h,strict:s})};if(e)return function(o,c){return t(o,c,{cache:new WeakMap,equals:n,meta:void 0,strict:s})};const a={cache:void 0,equals:n,meta:void 0,strict:s};return function(o,c){return t(o,c,a)}}const Fpe=Jl();Jl({strict:!0});Jl({circular:!0});Jl({circular:!0,strict:!0});Jl({createInternalComparator:()=>gu});Jl({strict:!0,createInternalComparator:()=>gu});Jl({circular:!0,createInternalComparator:()=>gu});Jl({circular:!0,createInternalComparator:()=>gu,strict:!0});function Jl(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:s=!1}=e,a=Dpe(e),i=Ope(a),o=r?r(i):Ipe(i);return Mpe({circular:t,comparator:i,createState:n,equals:o,strict:s})}var sw={exports:{}},aw={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YR;function Ppe(){if(YR)return aw;YR=1;var e=I0(),t=LM();function r(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var n=typeof Object.is=="function"?Object.is:r,s=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,c=e.useDebugValue;return aw.useSyncExternalStoreWithSelector=function(f,h,p,x,g){var v=a(null);if(v.current===null){var y={hasValue:!1,value:null};v.current=y}else y=v.current;v=o(function(){function _(O){if(!S){if(S=!0,E=O,O=x(O),g!==void 0&&y.hasValue){var R=y.value;if(g(R,O))return N=R}return N=O}if(R=N,n(E,O))return R;var V=x(O);return g!==void 0&&g(R,V)?(E=O,R):(E=O,N=V)}var S=!1,E,N,k=p===void 0?null:p;return[function(){return _(h())},k===null?void 0:function(){return _(k())}]},[h,p,x,g]);var w=s(f,v[0],v[1]);return i(function(){y.hasValue=!0,y.value=w},[w]),c(w),w},aw}var JR;function Lpe(){return JR||(JR=1,sw.exports=Ppe()),sw.exports}var Bpe=Lpe(),Upe=(...e)=>t=>{e.forEach(r=>{typeof r=="function"?r(t):r&&(r.current=t)})},zpe=({contentComponent:e})=>{const t=BM.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return d.jsx(d.Fragment,{children:Object.values(t)})};function Hpe(){const e=new Set;let t={};return{subscribe(r){return e.add(r),()=>{e.delete(r)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(r,n){t={...t,[r]:B8.createPortal(n.reactElement,n.element,r)},e.forEach(s=>s())},removeRenderer(r){const n={...t};delete n[r],t=n,e.forEach(s=>s())}}}var Vpe=class extends We.Component{constructor(e){var t;super(e),this.editorContentRef=We.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((t=e.editor)!=null&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var e;const t=this.props.editor;if(t&&!t.isDestroyed&&((e=t.view.dom)!=null&&e.parentNode)){if(t.contentComponent)return;const r=this.editorContentRef.current;r.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:r}),t.contentComponent=Hpe(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var e;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!((e=t.view.dom)!=null&&e.parentNode))return;const r=document.createElement("div");r.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:r})}catch{}}}render(){const{editor:e,innerRef:t,...r}=this.props;return d.jsxs(d.Fragment,{children:[d.jsx("div",{ref:Upe(t,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&d.jsx(zpe,{contentComponent:e.contentComponent})]})}},qpe=ne.forwardRef((e,t)=>{const r=We.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[e.editor]);return We.createElement(Vpe,{key:r,innerRef:t,...e})}),KP=We.memo(qpe),Wpe=typeof window<"u"?ne.useLayoutEffect:ne.useEffect,$pe=class{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(n=>n())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}};function Gpe(e){var t;const[r]=ne.useState(()=>new $pe(e.editor)),n=Bpe.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,e.selector,(t=e.equalityFn)!=null?t:Fpe);return Wpe(()=>r.watch(e.editor),[e.editor,r]),ne.useDebugValue(n),n}var Kpe=!1,rE=typeof window>"u",Xpe=rE||!!(typeof window<"u"&&window.next),Ype=class XP{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(r=>r())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?rE||Xpe?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const t={...this.options.current,onBeforeCreate:(...n)=>{var s,a;return(a=(s=this.options.current).onBeforeCreate)==null?void 0:a.call(s,...n)},onBlur:(...n)=>{var s,a;return(a=(s=this.options.current).onBlur)==null?void 0:a.call(s,...n)},onCreate:(...n)=>{var s,a;return(a=(s=this.options.current).onCreate)==null?void 0:a.call(s,...n)},onDestroy:(...n)=>{var s,a;return(a=(s=this.options.current).onDestroy)==null?void 0:a.call(s,...n)},onFocus:(...n)=>{var s,a;return(a=(s=this.options.current).onFocus)==null?void 0:a.call(s,...n)},onSelectionUpdate:(...n)=>{var s,a;return(a=(s=this.options.current).onSelectionUpdate)==null?void 0:a.call(s,...n)},onTransaction:(...n)=>{var s,a;return(a=(s=this.options.current).onTransaction)==null?void 0:a.call(s,...n)},onUpdate:(...n)=>{var s,a;return(a=(s=this.options.current).onUpdate)==null?void 0:a.call(s,...n)},onContentError:(...n)=>{var s,a;return(a=(s=this.options.current).onContentError)==null?void 0:a.call(s,...n)},onDrop:(...n)=>{var s,a;return(a=(s=this.options.current).onDrop)==null?void 0:a.call(s,...n)},onPaste:(...n)=>{var s,a;return(a=(s=this.options.current).onPaste)==null?void 0:a.call(s,...n)},onDelete:(...n)=>{var s,a;return(a=(s=this.options.current).onDelete)==null?void 0:a.call(s,...n)}};return new H0e(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}static compareOptions(t,r){return Object.keys(t).every(n=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)?!0:n==="extensions"&&t.extensions&&r.extensions?t.extensions.length!==r.extensions.length?!1:t.extensions.every((s,a)=>{var i;return s===((i=r.extensions)==null?void 0:i[a])}):t[n]===r[n])}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?XP.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((n,s)=>n===t[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,r=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){r&&r.setOptions(this.options.current);return}r&&!r.isDestroyed&&(r.destroy(),this.instanceId===t&&this.setEditor(null))},1)}};function Jpe(e={},t=[]){const r=ne.useRef(e);r.current=e;const[n]=ne.useState(()=>new Ype(r)),s=BM.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return ne.useDebugValue(s),ne.useEffect(n.onRender(t)),Gpe({editor:s,selector:({transactionNumber:a})=>e.shouldRerenderOnTransaction===!1||e.shouldRerenderOnTransaction===void 0?null:e.immediatelyRender&&a===0?0:a+1}),s}var YP=ne.createContext({editor:null});YP.Consumer;var Zpe=ne.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),Qpe=()=>ne.useContext(Zpe);We.forwardRef((e,t)=>{const{onDragStart:r}=Qpe(),n=e.as||"div";return d.jsx(n,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...e.style}})});We.createContext({markViewContentRef:()=>{}});var pN=ne.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});pN.displayName="TiptapContext";var eme=()=>ne.useContext(pN);function JP({editor:e,instance:t,children:r}){const n=e??t;if(!n)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const s=ne.useMemo(()=>({editor:n}),[n]),a=ne.useMemo(()=>({editor:n}),[n]);return d.jsx(YP.Provider,{value:a,children:d.jsx(pN.Provider,{value:s,children:r})})}JP.displayName="Tiptap";function ZP({...e}){const{editor:t}=eme();return d.jsx(KP,{editor:t,...e})}ZP.displayName="Tiptap.Content";Object.assign(JP,{Content:ZP});var Ng=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);const{children:r,...n}=t??{};if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,r]},tme=/^\s*>\s$/,rme=da.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return Ng("blockquote",{...yn(this.options.HTMLAttributes,e),children:Ng("slot",{})})},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";const r=">",n=[];return e.content.forEach(s=>{const o=t.renderChildren([s]).split(`
`).map(c=>c.trim()===""?r:`${r} ${c}`);n.push(o.join(`
`))}),n.join(`
${r}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[qf({find:tme,type:this.type})]}}),nme=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,sme=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,ame=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,ime=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,ome=xu.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return Ng("strong",{...yn(this.options.HTMLAttributes,e),children:Ng("slot",{})})},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Vf({find:nme,type:this.type}),Vf({find:ame,type:this.type})]},addPasteRules(){return[iu({find:sme,type:this.type}),iu({find:ime,type:this.type})]}}),lme=/(^|[^`])`([^`]+)`(?!`)$/,cme=/(^|[^`])`([^`]+)`(?!`)/g,ume=xu.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Vf({find:lme,type:this.type})]},addPasteRules(){return[iu({find:cme,type:this.type})]}}),iw=4,fme=/^```([a-z]+)?[\s\n]$/,dme=/^~~~([a-z]+)?[\s\n]$/,hme=da.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:iw,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:r}=this.options;if(!r)return null;const a=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(i=>i.startsWith(r)).map(i=>i.replace(r,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",yn(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var r;return((r=e.raw)==null?void 0:r.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var r;let n="";const s=((r=e.attrs)==null?void 0:r.language)||"";return e.content?n=[`\`\`\`${s}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${s}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,r=t.pos===1;return!e||t.parent.type.name!==this.name?!1:r||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:iw,{state:n}=e,{selection:s}=n,{$from:a,empty:i}=s;if(a.parent.type!==this.type)return!1;const o=" ".repeat(r);return i?e.commands.insertContent(o):e.commands.command(({tr:c})=>{const{from:f,to:h}=s,g=n.doc.textBetween(f,h,`
`,`
`).split(`
`).map(v=>o+v).join(`
`);return c.replaceWith(f,h,n.schema.text(g)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:iw,{state:n}=e,{selection:s}=n,{$from:a,empty:i}=s;return a.parent.type!==this.type?!1:i?e.commands.command(({tr:o})=>{var c;const{pos:f}=a,h=a.start(),p=a.end(),g=n.doc.textBetween(h,p,`
`,`
`).split(`
`);let v=0,y=0;const w=f-h;for(let O=0;O<g.length;O+=1){if(y+g[O].length>=w){v=O;break}y+=g[O].length+1}const S=((c=g[v].match(/^ */))==null?void 0:c[0])||"",E=Math.min(S.length,r);if(E===0)return!0;let N=h;for(let O=0;O<v;O+=1)N+=g[O].length+1;return o.delete(N,N+E),f-N<=E&&o.setSelection(St.create(o.doc,N)),!0}):e.commands.command(({tr:o})=>{const{from:c,to:f}=s,x=n.doc.textBetween(c,f,`
`,`
`).split(`
`).map(g=>{var v;const y=((v=g.match(/^ */))==null?void 0:v[0])||"",w=Math.min(y.length,r);return g.slice(w)}).join(`
`);return o.replaceWith(c,f,n.schema.text(x)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:r}=t,{$from:n,empty:s}=r;if(!s||n.parent.type!==this.type)return!1;const a=n.parentOffset===n.parent.nodeSize-2,i=n.parent.textContent.endsWith(`

`);return!a||!i?!1:e.chain().command(({tr:o})=>(o.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:r,doc:n}=t,{$from:s,empty:a}=r;if(!a||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const o=s.after();return o===void 0?!1:n.nodeAt(o)?e.commands.command(({tr:f})=>(f.setSelection(It.near(n.resolve(o))),!0)):e.commands.exitCode()}}},addInputRules(){return[eE({find:fme,type:this.type,getAttributes:e=>({language:e[1]})}),eE({find:dme,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Fr({key:new Nn("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const r=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),s=n?JSON.parse(n):void 0,a=s==null?void 0:s.mode;if(!r||!a)return!1;const{tr:i,schema:o}=e.state,c=o.text(r.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:a},c)),i.selection.$from.parent.type!==this.type&&i.setSelection(St.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),pme=da.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`

`):""}),mme=da.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",yn(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:r,editor:n})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:s,storedMarks:a}=r;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:o}=n.extensionManager,c=a||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:f,dispatch:h})=>{if(h&&c&&i){const p=c.filter(x=>o.includes(x.type.name));f.ensureMarks(p)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),xme=da.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,yn(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var r;const n=(r=e.attrs)!=null&&r.level?parseInt(e.attrs.level,10):1,s="#".repeat(n);return e.content?`${s} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>eE({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),gme=da.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",yn(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!q0e(t,t.schema.nodes[this.name]))return!1;const{selection:r}=t,{$to:n}=r,s=e();return CP(r)?s.insertContentAt(n.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:a,tr:i,dispatch:o})=>{if(o){const{$to:c}=i.selection,f=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?i.setSelection(St.create(i.doc,c.pos+1)):c.nodeAfter.isBlock?i.setSelection(xt.create(i.doc,c.pos)):i.setSelection(St.create(i.doc,c.pos));else{const h=a.schema.nodes[this.options.nextNodeType]||c.parent.type.contentMatch.defaultType,p=h==null?void 0:h.create();p&&(i.insert(f,p),i.setSelection(St.create(i.doc,f+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[V0e({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),yme=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,vme=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,bme=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,wme=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,_me=xu.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",yn(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Vf({find:yme,type:this.type}),Vf({find:bme,type:this.type})]},addPasteRules(){return[iu({find:vme,type:this.type}),iu({find:wme,type:this.type})]}});const Eme="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Sme="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",nE="numeric",sE="ascii",aE="alpha",Xh="asciinumeric",Dh="alphanumeric",iE="domain",QP="emoji",Nme="scheme",Tme="slashscheme",ow="whitespace";function kme(e,t){return e in t||(t[e]=[]),t[e]}function Cc(e,t,r){t[nE]&&(t[Xh]=!0,t[Dh]=!0),t[sE]&&(t[Xh]=!0,t[aE]=!0),t[Xh]&&(t[Dh]=!0),t[aE]&&(t[Dh]=!0),t[Dh]&&(t[iE]=!0),t[QP]&&(t[iE]=!0);for(const n in t){const s=kme(n,r);s.indexOf(e)<0&&s.push(e)}}function Ame(e,t){const r={};for(const n in t)t[n].indexOf(e)>=0&&(r[n]=!0);return r}function Ps(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}Ps.groups={};Ps.prototype={accepts(){return!!this.t},go(e){const t=this,r=t.j[e];if(r)return r;for(let n=0;n<t.jr.length;n++){const s=t.jr[n][0],a=t.jr[n][1];if(a&&s.test(e))return a}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,r,n){for(let s=0;s<e.length;s++)this.tt(e[s],t,r,n)},tr(e,t,r,n){n=n||Ps.groups;let s;return t&&t.j?s=t:(s=new Ps(t),r&&n&&Cc(t,r,n)),this.jr.push([e,s]),s},ts(e,t,r,n){let s=this;const a=e.length;if(!a)return s;for(let i=0;i<a-1;i++)s=s.tt(e[i]);return s.tt(e[a-1],t,r,n)},tt(e,t,r,n){n=n||Ps.groups;const s=this;if(t&&t.j)return s.j[e]=t,t;const a=t;let i,o=s.go(e);if(o?(i=new Ps,Object.assign(i.j,o.j),i.jr.push.apply(i.jr,o.jr),i.jd=o.jd,i.t=o.t):i=new Ps,a){if(n)if(i.t&&typeof i.t=="string"){const c=Object.assign(Ame(i.t,n),r);Cc(a,c,n)}else r&&Cc(a,r,n);i.t=a}return s.j[e]=i,i}};const Ot=(e,t,r,n,s)=>e.ta(t,r,n,s),Br=(e,t,r,n,s)=>e.tr(t,r,n,s),ZR=(e,t,r,n,s)=>e.ts(t,r,n,s),Je=(e,t,r,n,s)=>e.tt(t,r,n,s),yo="WORD",oE="UWORD",eL="ASCIINUMERICAL",tL="ALPHANUMERICAL",O0="LOCALHOST",lE="TLD",cE="UTLD",Fx="SCHEME",uf="SLASH_SCHEME",mN="NUM",uE="WS",xN="NL",Yh="OPENBRACE",Jh="CLOSEBRACE",Tg="OPENBRACKET",kg="CLOSEBRACKET",Ag="OPENPAREN",Cg="CLOSEPAREN",Rg="OPENANGLEBRACKET",jg="CLOSEANGLEBRACKET",Og="FULLWIDTHLEFTPAREN",Dg="FULLWIDTHRIGHTPAREN",Ig="LEFTCORNERBRACKET",Mg="RIGHTCORNERBRACKET",Fg="LEFTWHITECORNERBRACKET",Pg="RIGHTWHITECORNERBRACKET",Lg="FULLWIDTHLESSTHAN",Bg="FULLWIDTHGREATERTHAN",Ug="AMPERSAND",zg="APOSTROPHE",Hg="ASTERISK",wl="AT",Vg="BACKSLASH",qg="BACKTICK",Wg="CARET",Nl="COLON",gN="COMMA",$g="DOLLAR",ji="DOT",Gg="EQUALS",yN="EXCLAMATION",Ra="HYPHEN",Zh="PERCENT",Kg="PIPE",Xg="PLUS",Yg="POUND",Qh="QUERY",vN="QUOTE",rL="FULLWIDTHMIDDLEDOT",bN="SEMI",Oi="SLASH",e0="TILDE",Jg="UNDERSCORE",nL="EMOJI",Zg="SYM";var sL=Object.freeze({__proto__:null,ALPHANUMERICAL:tL,AMPERSAND:Ug,APOSTROPHE:zg,ASCIINUMERICAL:eL,ASTERISK:Hg,AT:wl,BACKSLASH:Vg,BACKTICK:qg,CARET:Wg,CLOSEANGLEBRACKET:jg,CLOSEBRACE:Jh,CLOSEBRACKET:kg,CLOSEPAREN:Cg,COLON:Nl,COMMA:gN,DOLLAR:$g,DOT:ji,EMOJI:nL,EQUALS:Gg,EXCLAMATION:yN,FULLWIDTHGREATERTHAN:Bg,FULLWIDTHLEFTPAREN:Og,FULLWIDTHLESSTHAN:Lg,FULLWIDTHMIDDLEDOT:rL,FULLWIDTHRIGHTPAREN:Dg,HYPHEN:Ra,LEFTCORNERBRACKET:Ig,LEFTWHITECORNERBRACKET:Fg,LOCALHOST:O0,NL:xN,NUM:mN,OPENANGLEBRACKET:Rg,OPENBRACE:Yh,OPENBRACKET:Tg,OPENPAREN:Ag,PERCENT:Zh,PIPE:Kg,PLUS:Xg,POUND:Yg,QUERY:Qh,QUOTE:vN,RIGHTCORNERBRACKET:Mg,RIGHTWHITECORNERBRACKET:Pg,SCHEME:Fx,SEMI:bN,SLASH:Oi,SLASH_SCHEME:uf,SYM:Zg,TILDE:e0,TLD:lE,UNDERSCORE:Jg,UTLD:cE,UWORD:oE,WORD:yo,WS:uE});const po=/[a-z]/,gh=new RegExp("\\p{L}","u"),lw=new RegExp("\\p{Emoji}","u"),mo=/\d/,cw=/\s/,QR="\r",uw=`
`,Cme="",Rme="",fw="";let ax=null,ix=null;function jme(e=[]){const t={};Ps.groups=t;const r=new Ps;ax==null&&(ax=e6(Eme)),ix==null&&(ix=e6(Sme)),Je(r,"'",zg),Je(r,"{",Yh),Je(r,"}",Jh),Je(r,"[",Tg),Je(r,"]",kg),Je(r,"(",Ag),Je(r,")",Cg),Je(r,"<",Rg),Je(r,">",jg),Je(r,"",Og),Je(r,"",Dg),Je(r,"",Ig),Je(r,"",Mg),Je(r,"",Fg),Je(r,"",Pg),Je(r,"",Lg),Je(r,"",Bg),Je(r,"&",Ug),Je(r,"*",Hg),Je(r,"@",wl),Je(r,"`",qg),Je(r,"^",Wg),Je(r,":",Nl),Je(r,",",gN),Je(r,"$",$g),Je(r,".",ji),Je(r,"=",Gg),Je(r,"!",yN),Je(r,"-",Ra),Je(r,"%",Zh),Je(r,"|",Kg),Je(r,"+",Xg),Je(r,"#",Yg),Je(r,"?",Qh),Je(r,'"',vN),Je(r,"/",Oi),Je(r,";",bN),Je(r,"~",e0),Je(r,"_",Jg),Je(r,"\\",Vg),Je(r,"",rL);const n=Br(r,mo,mN,{[nE]:!0});Br(n,mo,n);const s=Br(n,po,eL,{[Xh]:!0}),a=Br(n,gh,tL,{[Dh]:!0}),i=Br(r,po,yo,{[sE]:!0});Br(i,mo,s),Br(i,po,i),Br(s,mo,s),Br(s,po,s);const o=Br(r,gh,oE,{[aE]:!0});Br(o,po),Br(o,mo,a),Br(o,gh,o),Br(a,mo,a),Br(a,po),Br(a,gh,a);const c=Je(r,uw,xN,{[ow]:!0}),f=Je(r,QR,uE,{[ow]:!0}),h=Br(r,cw,uE,{[ow]:!0});Je(r,fw,h),Je(f,uw,c),Je(f,fw,h),Br(f,cw,h),Je(h,QR),Je(h,uw),Br(h,cw,h),Je(h,fw,h);const p=Br(r,lw,nL,{[QP]:!0});Je(p,"#"),Br(p,lw,p),Je(p,Cme,p);const x=Je(p,Rme);Je(x,"#"),Br(x,lw,p);const g=[[po,i],[mo,s]],v=[[po,null],[gh,o],[mo,a]];for(let y=0;y<ax.length;y++)gl(r,ax[y],lE,yo,g);for(let y=0;y<ix.length;y++)gl(r,ix[y],cE,oE,v);Cc(lE,{tld:!0,ascii:!0},t),Cc(cE,{utld:!0,alpha:!0},t),gl(r,"file",Fx,yo,g),gl(r,"mailto",Fx,yo,g),gl(r,"http",uf,yo,g),gl(r,"https",uf,yo,g),gl(r,"ftp",uf,yo,g),gl(r,"ftps",uf,yo,g),Cc(Fx,{scheme:!0,ascii:!0},t),Cc(uf,{slashscheme:!0,ascii:!0},t),e=e.sort((y,w)=>y[0]>w[0]?1:-1);for(let y=0;y<e.length;y++){const w=e[y][0],S=e[y][1]?{[Nme]:!0}:{[Tme]:!0};w.indexOf("-")>=0?S[iE]=!0:po.test(w)?mo.test(w)?S[Xh]=!0:S[sE]=!0:S[nE]=!0,ZR(r,w,w,S)}return ZR(r,"localhost",O0,{ascii:!0}),r.jd=new Ps(Zg),{start:r,tokens:Object.assign({groups:t},sL)}}function aL(e,t){const r=Ome(t.replace(/[A-Z]/g,o=>o.toLowerCase())),n=r.length,s=[];let a=0,i=0;for(;i<n;){let o=e,c=null,f=0,h=null,p=-1,x=-1;for(;i<n&&(c=o.go(r[i]));)o=c,o.accepts()?(p=0,x=0,h=o):p>=0&&(p+=r[i].length,x++),f+=r[i].length,a+=r[i].length,i++;a-=p,i-=x,f-=p,s.push({t:h.t,v:t.slice(a-f,a),s:a-f,e:a})}return s}function Ome(e){const t=[],r=e.length;let n=0;for(;n<r;){let s=e.charCodeAt(n),a,i=s<55296||s>56319||n+1===r||(a=e.charCodeAt(n+1))<56320||a>57343?e[n]:e.slice(n,n+2);t.push(i),n+=i.length}return t}function gl(e,t,r,n,s){let a;const i=t.length;for(let o=0;o<i-1;o++){const c=t[o];e.j[c]?a=e.j[c]:(a=new Ps(n),a.jr=s.slice(),e.j[c]=a),e=a}return a=new Ps(r),a.jr=s.slice(),e.j[t[i-1]]=a,a}function e6(e){const t=[],r=[];let n=0,s="0123456789";for(;n<e.length;){let a=0;for(;s.indexOf(e[n+a])>=0;)a++;if(a>0){t.push(r.join(""));for(let i=parseInt(e.substring(n,n+a),10);i>0;i--)r.pop();n+=a}else r.push(e[n]),n++}return t}const D0={defaultProtocol:"http",events:null,format:t6,formatHref:t6,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function wN(e,t=null){let r=Object.assign({},D0);e&&(r=Object.assign(r,e instanceof wN?e.o:e));const n=r.ignoreTags,s=[];for(let a=0;a<n.length;a++)s.push(n[a].toUpperCase());this.o=r,t&&(this.defaultRender=t),this.ignoreTags=s}wN.prototype={o:D0,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,t,r){const n=t!=null;let s=this.o[e];return s&&(typeof s=="object"?(s=r.t in s?s[r.t]:D0[e],typeof s=="function"&&n&&(s=s(t,r))):typeof s=="function"&&n&&(s=s(t,r.t,r)),s)},getObj(e,t,r){let n=this.o[e];return typeof n=="function"&&t!=null&&(n=n(t,r.t,r)),n},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function t6(e){return e}function iL(e,t){this.t="token",this.v=e,this.tk=t}iL.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),r=e.get("truncate",t,this),n=e.get("format",t,this);return r&&n.length>r?n.substring(0,r)+"":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=D0.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,r=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",r,this),s=e.get("tagName",r,t),a=this.toFormattedString(e),i={},o=e.get("className",r,t),c=e.get("target",r,t),f=e.get("rel",r,t),h=e.getObj("attributes",r,t),p=e.getObj("events",r,t);return i.href=n,o&&(i.class=o),c&&(i.target=c),f&&(i.rel=f),h&&Object.assign(i,h),{tagName:s,attributes:i,content:a,eventListeners:p}}};function q1(e,t){class r extends iL{constructor(s,a){super(s,a),this.t=e}}for(const n in t)r.prototype[n]=t[n];return r.t=e,r}const r6=q1("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),n6=q1("text"),Dme=q1("nl"),ox=q1("url",{isLink:!0,toHref(e=D0.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==O0&&e[1].t===Nl}}),Na=e=>new Ps(e);function Ime({groups:e}){const t=e.domain.concat([Ug,Hg,wl,Vg,qg,Wg,$g,Gg,Ra,mN,Zh,Kg,Xg,Yg,Oi,Zg,e0,Jg]),r=[zg,Nl,gN,ji,yN,Zh,Qh,vN,bN,Rg,jg,Yh,Jh,kg,Tg,Ag,Cg,Og,Dg,Ig,Mg,Fg,Pg,Lg,Bg],n=[Ug,zg,Hg,Vg,qg,Wg,$g,Gg,Ra,Yh,Jh,Zh,Kg,Xg,Yg,Qh,Oi,Zg,e0,Jg],s=Na(),a=Je(s,e0);Ot(a,n,a),Ot(a,e.domain,a);const i=Na(),o=Na(),c=Na();Ot(s,e.domain,i),Ot(s,e.scheme,o),Ot(s,e.slashscheme,c),Ot(i,n,a),Ot(i,e.domain,i);const f=Je(i,wl);Je(a,wl,f),Je(o,wl,f),Je(c,wl,f);const h=Je(a,ji);Ot(h,n,a),Ot(h,e.domain,a);const p=Na();Ot(f,e.domain,p),Ot(p,e.domain,p);const x=Je(p,ji);Ot(x,e.domain,p);const g=Na(r6);Ot(x,e.tld,g),Ot(x,e.utld,g),Je(f,O0,g);const v=Je(p,Ra);Je(v,Ra,v),Ot(v,e.domain,p),Ot(g,e.domain,p),Je(g,ji,x),Je(g,Ra,v);const y=Je(g,Nl);Ot(y,e.numeric,r6);const w=Je(i,Ra),_=Je(i,ji);Je(w,Ra,w),Ot(w,e.domain,i),Ot(_,n,a),Ot(_,e.domain,i);const S=Na(ox);Ot(_,e.tld,S),Ot(_,e.utld,S),Ot(S,e.domain,i),Ot(S,n,a),Je(S,ji,_),Je(S,Ra,w),Je(S,wl,f);const E=Je(S,Nl),N=Na(ox);Ot(E,e.numeric,N);const k=Na(ox),O=Na();Ot(k,t,k),Ot(k,r,O),Ot(O,t,k),Ot(O,r,O),Je(S,Oi,k),Je(N,Oi,k);const R=Je(o,Nl),V=Je(c,Nl),I=Je(V,Oi),Z=Je(I,Oi);Ot(o,e.domain,i),Je(o,ji,_),Je(o,Ra,w),Ot(c,e.domain,i),Je(c,ji,_),Je(c,Ra,w),Ot(R,e.domain,k),Je(R,Oi,k),Je(R,Qh,k),Ot(Z,e.domain,k),Ot(Z,t,k),Je(Z,Oi,k);const ce=[[Yh,Jh],[Tg,kg],[Ag,Cg],[Rg,jg],[Og,Dg],[Ig,Mg],[Fg,Pg],[Lg,Bg]];for(let F=0;F<ce.length;F++){const[X,P]=ce[F],ie=Je(k,X);Je(O,X,ie),Je(ie,P,k);const te=Na(ox);Ot(ie,t,te);const Y=Na();Ot(ie,r),Ot(te,t,te),Ot(te,r,Y),Ot(Y,t,te),Ot(Y,r,Y),Je(te,P,k),Je(Y,P,k)}return Je(s,O0,S),Je(s,xN,Dme),{start:s,tokens:sL}}function Mme(e,t,r){let n=r.length,s=0,a=[],i=[];for(;s<n;){let o=e,c=null,f=null,h=0,p=null,x=-1;for(;s<n&&!(c=o.go(r[s].t));)i.push(r[s++]);for(;s<n&&(f=c||o.go(r[s].t));)c=null,o=f,o.accepts()?(x=0,p=o):x>=0&&x++,s++,h++;if(x<0)s-=h,s<n&&(i.push(r[s]),s++);else{i.length>0&&(a.push(dw(n6,t,i)),i=[]),s-=x,h-=x;const g=p.t,v=r.slice(s-h,s);a.push(dw(g,t,v))}}return i.length>0&&a.push(dw(n6,t,i)),a}function dw(e,t,r){const n=r[0].s,s=r[r.length-1].e,a=t.slice(n,s);return new e(a,r)}const Fme=typeof console<"u"&&console&&console.warn||(()=>{}),Pme="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Er={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Lme(){return Ps.groups={},Er.scanner=null,Er.parser=null,Er.tokenQueue=[],Er.pluginQueue=[],Er.customSchemes=[],Er.initialized=!1,Er}function s6(e,t=!1){if(Er.initialized&&Fme(`linkifyjs: already initialized - will not register custom scheme "${e}" ${Pme}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Er.customSchemes.push([e,t])}function Bme(){Er.scanner=jme(Er.customSchemes);for(let e=0;e<Er.tokenQueue.length;e++)Er.tokenQueue[e][1]({scanner:Er.scanner});Er.parser=Ime(Er.scanner.tokens);for(let e=0;e<Er.pluginQueue.length;e++)Er.pluginQueue[e][1]({scanner:Er.scanner,parser:Er.parser});return Er.initialized=!0,Er}function _N(e){return Er.initialized||Bme(),Mme(Er.parser.start,e,aL(Er.scanner.start,e))}_N.scan=aL;function oL(e,t=null,r=null){if(t&&typeof t=="object"){if(r)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);r=t,t=null}const n=new wN(r),s=_N(e),a=[];for(let i=0;i<s.length;i++){const o=s[i];o.isLink&&(!t||o.t===t)&&n.check(o)&&a.push(o.toFormattedObject(n))}return a}var EN="[\0- -\u2029]",Ume=new RegExp(EN),zme=new RegExp(`${EN}$`),Hme=new RegExp(EN,"g");function Vme(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function qme(e){return new Fr({key:new Nn("autolink"),appendTransaction:(t,r,n)=>{const s=t.some(f=>f.docChanged)&&!r.doc.eq(n.doc),a=t.some(f=>f.getMeta("preventAutolink"));if(!s||a)return;const{tr:i}=n,o=wP(r.doc,[...t]);if(AP(o).forEach(({newRange:f})=>{const h=qhe(n.doc,f,g=>g.isTextblock);let p,x;if(h.length>1)p=h[0],x=n.doc.textBetween(p.pos,p.pos+p.node.nodeSize,void 0," ");else if(h.length){const g=n.doc.textBetween(f.from,f.to," "," ");if(!zme.test(g))return;p=h[0],x=n.doc.textBetween(p.pos,f.to,void 0," ")}if(p&&x){const g=x.split(Ume).filter(Boolean);if(g.length<=0)return!1;const v=g[g.length-1],y=p.pos+x.lastIndexOf(v);if(!v)return!1;const w=_N(v).map(_=>_.toObject(e.defaultProtocol));if(!Vme(w))return!1;w.filter(_=>_.isLink).map(_=>({..._,from:y+_.start+1,to:y+_.end+1})).filter(_=>n.schema.marks.code?!n.doc.rangeHasMark(_.from,_.to,n.schema.marks.code):!0).filter(_=>e.validate(_.value)).filter(_=>e.shouldAutoLink(_.value)).forEach(_=>{cN(_.from,_.to,n.doc).some(S=>S.mark.type===e.type)||i.addMark(_.from,_.to,e.type.create({href:_.href}))})}}),!!i.steps.length)return i}})}function Wme(e){return new Fr({key:new Nn("handleClickLink"),props:{handleClick:(t,r,n)=>{var s,a;if(n.button!==0||!t.editable)return!1;let i=null;if(n.target instanceof HTMLAnchorElement)i=n.target;else{const c=n.target;if(!c)return!1;const f=e.editor.view.dom;i=c.closest("a"),i&&!f.contains(i)&&(i=null)}if(!i)return!1;let o=!1;if(e.enableClickSelection&&(o=e.editor.commands.extendMarkRange(e.type.name)),e.openOnClick){const c=kP(t.state,e.type.name),f=(s=i.href)!=null?s:c.href,h=(a=i.target)!=null?a:c.target;f&&(window.open(f,h),o=!0)}return o}}})}function $me(e){return new Fr({key:new Nn("handlePasteLink"),props:{handlePaste:(t,r,n)=>{const{shouldAutoLink:s}=e,{state:a}=t,{selection:i}=a,{empty:o}=i;if(o)return!1;let c="";n.content.forEach(h=>{c+=h.textContent});const f=oL(c,{defaultProtocol:e.defaultProtocol}).find(h=>h.isLink&&h.value===c);return!c||!f||s!==void 0&&!s(f.value)?!1:e.editor.commands.setMark(e.type,{href:f.href})}}})}function gc(e,t){const r=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(n=>{const s=typeof n=="string"?n:n.scheme;s&&r.push(s)}),!e||e.replace(Hme,"").match(new RegExp(`^(?:(?:${r.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var lL=xu.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){s6(e);return}s6(e.scheme,e.optionalSlashes)})},onDestroy(){Lme()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!gc(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>{const t=/^[a-z][a-z0-9+.-]*:\/\//i.test(e),r=/^[a-z][a-z0-9+.-]*:/i.test(e);if(t||r&&!e.includes("@"))return!0;const s=(e.includes("@")?e.split("@").pop():e).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(s)||!/\./.test(s))}}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:r=>!!gc(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!gc(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",yn(this.options.HTMLAttributes,e),0]:["a",yn(this.options.HTMLAttributes,{...e,href:""}),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var r,n,s,a;const i=(n=(r=e.attrs)==null?void 0:r.href)!=null?n:"",o=(a=(s=e.attrs)==null?void 0:s.title)!=null?a:"",c=t.renderChildren(e);return o?`[${c}](${i} "${o}")`:`[${c}](${i})`},addCommands(){return{setLink:e=>({chain:t})=>{const{href:r}=e;return this.options.isAllowedUri(r,{defaultValidate:n=>!!gc(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{const{href:r}=e||{};return r&&!this.options.isAllowedUri(r,{defaultValidate:n=>!!gc(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[iu({find:e=>{const t=[];if(e){const{protocols:r,defaultProtocol:n}=this.options,s=oL(e).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:i=>!!gc(i,r),protocols:r,defaultProtocol:n}));s.length&&s.forEach(a=>{this.options.shouldAutoLink(a.value)&&t.push({text:a.value,data:{href:a.href},index:a.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:r}=this.options;return this.options.autolink&&e.push(qme({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:s=>!!gc(s,t),protocols:t,defaultProtocol:r}),shouldAutoLink:this.options.shouldAutoLink})),e.push(Wme({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push($me({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),Gme=lL,Kme=Object.defineProperty,Xme=(e,t)=>{for(var r in t)Kme(e,r,{get:t[r],enumerable:!0})},Yme="listItem",a6="textStyle",i6=/^\s*([-+*])\s$/,cL=da.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Yme,this.editor.getAttributes(a6)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=qf({find:i6,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=qf({find:i6,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(a6),editor:this.editor})),[e]}}),uL=da.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if(e.type!=="list_item")return[];let r=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(s=>s.type==="paragraph"))r=t.parseChildren(e.tokens);else{const s=e.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(r=[{type:"paragraph",content:t.parseInline(s.tokens)}],e.tokens.length>1){const i=e.tokens.slice(1),o=t.parseChildren(i);r.push(...o)}}else r=t.parseChildren(e.tokens)}return r.length===0&&(r=[{type:"paragraph",content:[]}]),{type:"listItem",content:r}},renderMarkdown:(e,t,r)=>hN(e,t,n=>{var s,a;return n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${(((a=(s=n.meta)==null?void 0:s.parentAttrs)==null?void 0:a.start)||1)+n.index}. `:"- "},r),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Jme={};Xme(Jme,{findListItemPos:()=>up,getNextListDepth:()=>SN,handleBackspace:()=>fE,handleDelete:()=>dE,hasListBefore:()=>fL,hasListItemAfter:()=>Zme,hasListItemBefore:()=>dL,listItemHasSubList:()=>hL,nextListIsDeeper:()=>pL,nextListIsHigher:()=>mL});var up=(e,t)=>{const{$from:r}=t.selection,n=gn(e,t.schema);let s=null,a=r.depth,i=r.pos,o=null;for(;a>0&&o===null;)s=r.node(a),s.type===n?o=a:(a-=1,i-=1);return o===null?null:{$pos:t.doc.resolve(i),depth:o}},SN=(e,t)=>{const r=up(e,t);if(!r)return!1;const[,n]=e0e(t,e,r.$pos.pos+4);return n},fL=(e,t,r)=>{const{$anchor:n}=e.selection,s=Math.max(0,n.pos-2),a=e.doc.resolve(s).node();return!(!a||!r.includes(a.type.name))},dL=(e,t)=>{var r;const{$anchor:n}=t.selection,s=t.doc.resolve(n.pos-2);return!(s.index()===0||((r=s.nodeBefore)==null?void 0:r.type.name)!==e)},hL=(e,t,r)=>{if(!r)return!1;const n=gn(e,t.schema);let s=!1;return r.descendants(a=>{a.type===n&&(s=!0)}),s},fE=(e,t,r)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!ql(e.state,t)&&fL(e.state,t,r)){const{$anchor:o}=e.state.selection,c=e.state.doc.resolve(o.before()-1),f=[];c.node().descendants((x,g)=>{x.type.name===t&&f.push({node:x,pos:g})});const h=f.at(-1);if(!h)return!1;const p=e.state.doc.resolve(c.start()+h.pos+1);return e.chain().cut({from:o.start()-1,to:o.end()+1},p.end()).joinForward().run()}if(!ql(e.state,t)||!s0e(e.state))return!1;const n=up(t,e.state);if(!n)return!1;const a=e.state.doc.resolve(n.$pos.pos-2).node(n.depth),i=hL(t,e.state,a);return dL(t,e.state)&&!i?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},pL=(e,t)=>{const r=SN(e,t),n=up(e,t);return!n||!r?!1:r>n.depth},mL=(e,t)=>{const r=SN(e,t),n=up(e,t);return!n||!r?!1:r<n.depth},dE=(e,t)=>{if(!ql(e.state,t)||!n0e(e.state,t))return!1;const{selection:r}=e.state,{$from:n,$to:s}=r;return!r.empty&&n.sameParent(s)?!1:pL(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():mL(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},Zme=(e,t)=>{var r;const{$anchor:n}=t.selection,s=t.doc.resolve(n.pos-n.parentOffset-2);return!(s.index()===s.parent.childCount-1||((r=s.nodeAfter)==null?void 0:r.type.name)!==e)},xL=en.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r})=>{e.state.schema.nodes[r]!==void 0&&dE(e,r)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r})=>{e.state.schema.nodes[r]!==void 0&&dE(e,r)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{e.state.schema.nodes[r]!==void 0&&fE(e,r,n)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{e.state.schema.nodes[r]!==void 0&&fE(e,r,n)&&(t=!0)}),t}}}}),o6=/^(\s*)(\d+)\.\s+(.*)$/,Qme=/^\s/;function exe(e){const t=[];let r=0,n=0;for(;r<e.length;){const s=e[r],a=s.match(o6);if(!a)break;const[,i,o,c]=a,f=i.length;let h=c,p=r+1;const x=[s];for(;p<e.length;){const g=e[p];if(g.match(o6))break;if(g.trim()==="")x.push(g),h+=`
`,p+=1;else if(g.match(Qme))x.push(g),h+=`
${g.slice(f+2)}`,p+=1;else break}t.push({indent:f,number:parseInt(o,10),content:h.trim(),raw:x.join(`
`)}),n=p,r=p}return[t,n]}function gL(e,t,r){var n;const s=[];let a=0;for(;a<e.length;){const i=e[a];if(i.indent===t){const o=i.content.split(`
`),c=((n=o[0])==null?void 0:n.trim())||"",f=[];c&&f.push({type:"paragraph",raw:c,tokens:r.inlineTokens(c)});const h=o.slice(1).join(`
`).trim();if(h){const g=r.blockTokens(h);f.push(...g)}let p=a+1;const x=[];for(;p<e.length&&e[p].indent>t;)x.push(e[p]),p+=1;if(x.length>0){const g=Math.min(...x.map(y=>y.indent)),v=gL(x,g,r);f.push({type:"list",ordered:!0,start:x[0].number,items:v,raw:x.map(y=>y.raw).join(`
`)})}s.push({type:"list_item",raw:i.raw,tokens:f}),a=p}else a+=1}return s}function txe(e,t){return e.map(r=>{if(r.type!=="list_item")return t.parseChildren([r])[0];const n=[];return r.tokens&&r.tokens.length>0&&r.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")n.push(...t.parseChildren([s]));else if(s.type==="text"&&s.tokens){const a=t.parseChildren([s]);n.push({type:"paragraph",content:a})}else{const a=t.parseChildren([s]);a.length>0&&n.push(...a)}}),{type:"listItem",content:n}})}var rxe="listItem",l6="textStyle",c6=/^(\d+)\.\s$/,yL=da.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...r}=e;return t===1?["ol",yn(this.options.HTMLAttributes,r),0]:["ol",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if(e.type!=="list"||!e.ordered)return[];const r=e.start||1,n=e.items?txe(e.items,t):[];return r!==1?{type:"orderedList",attrs:{start:r},content:n}:{type:"orderedList",content:n}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{const t=e.match(/^(\s*)(\d+)\.\s+/),r=t==null?void 0:t.index;return r!==void 0?r:-1},tokenize:(e,t,r)=>{var n;const s=e.split(`
`),[a,i]=exe(s);if(a.length===0)return;const o=gL(a,0,r);return o.length===0?void 0:{type:"list",ordered:!0,start:((n=a[0])==null?void 0:n.number)||1,items:o,raw:s.slice(0,i).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(rxe,this.editor.getAttributes(l6)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=qf({find:c6,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=qf({find:c6,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(l6)}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1],editor:this.editor})),[e]}}),nxe=/^\s*(\[([( |x])?\])\s$/,sxe=da.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",yn(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{const r=[];if(e.tokens&&e.tokens.length>0?r.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?r.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):r.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){const n=t.parseChildren(e.nestedTokens);r.push(...n)}return t.createNode("taskItem",{checked:e.checked||!1},r)},renderMarkdown:(e,t)=>{var r;const s=`- [${(r=e.attrs)!=null&&r.checked?"x":" "}] `;return hN(e,t,s)},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...e,Tab:()=>this.editor.commands.sinkListItem(this.name)}:e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:r,editor:n})=>{const s=document.createElement("li"),a=document.createElement("label"),i=document.createElement("span"),o=document.createElement("input"),c=document.createElement("div"),f=p=>{var x,g;o.ariaLabel=((g=(x=this.options.a11y)==null?void 0:x.checkboxLabel)==null?void 0:g.call(x,p,o.checked))||`Task item checkbox for ${p.textContent||"empty task item"}`};f(e),a.contentEditable="false",o.type="checkbox",o.addEventListener("mousedown",p=>p.preventDefault()),o.addEventListener("change",p=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){o.checked=!o.checked;return}const{checked:x}=p.target;n.isEditable&&typeof r=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:g})=>{const v=r();if(typeof v!="number")return!1;const y=g.doc.nodeAt(v);return g.setNodeMarkup(v,void 0,{...y==null?void 0:y.attrs,checked:x}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,x)||(o.checked=!o.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([p,x])=>{s.setAttribute(p,x)}),s.dataset.checked=e.attrs.checked,o.checked=e.attrs.checked,a.append(o,i),s.append(a,c),Object.entries(t).forEach(([p,x])=>{s.setAttribute(p,x)});let h=new Set(Object.keys(t));return{dom:s,contentDOM:c,update:p=>{if(p.type!==this.type)return!1;s.dataset.checked=p.attrs.checked,o.checked=p.attrs.checked,f(p);const x=n.extensionManager.attributes,g=j0(p,x),v=new Set(Object.keys(g)),y=this.options.HTMLAttributes;return h.forEach(w=>{v.has(w)||(w in y?s.setAttribute(w,y[w]):s.removeAttribute(w))}),Object.entries(g).forEach(([w,_])=>{_==null?w in y?s.setAttribute(w,y[w]):s.removeAttribute(w):s.setAttribute(w,_)}),h=v,!0}}}},addInputRules(){return[qf({find:nxe,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),axe=da.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",yn(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;const r=(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return r!==void 0?r:-1},tokenize(e,t,r){const n=a=>{const i=tE(a,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,c)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:r.inlineTokens(o.mainContent),nestedTokens:c}),customNestedParser:n},r);return i?[{type:"taskList",raw:i.raw,items:i.items}]:r.blockTokens(a)},s=tE(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,i)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:r.inlineTokens(a.mainContent),nestedTokens:i}),customNestedParser:n},r);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});en.create({name:"listKit",addExtensions(){const e=[];return this.options.bulletList!==!1&&e.push(cL.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(uL.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(xL.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(yL.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(sxe.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(axe.configure(this.options.taskList)),e}});var u6="&nbsp;",ixe="",oxe=da.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",yn(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{const r=e.tokens||[];if(r.length===1&&r[0].type==="image")return t.parseChildren([r[0]]);const n=t.parseInline(r);return n.length===1&&n[0].type==="text"&&(n[0].text===u6||n[0].text===ixe)?t.createNode("paragraph",void 0,[]):t.createNode("paragraph",void 0,n)},renderMarkdown:(e,t)=>{if(!e)return"";const r=Array.isArray(e.content)?e.content:[];return r.length===0?u6:t.renderChildren(r)},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),lxe=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,cxe=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,uxe=xu.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Vf({find:lxe,type:this.type})]},addPasteRules(){return[iu({find:cxe,type:this.type})]}}),fxe=da.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),vL=xu.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",yn(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown(e,t){return`++${t.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,t,r){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!s)return;const a=s[2].trim();return{type:"underline",raw:s[0],text:a,tokens:r.inlineTokens(a)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),dxe=vL;function hxe(e={}){return new Fr({view(t){return new pxe(t,e)}})}class pxe{constructor(t,r){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let a=i=>{this[s](i)};return t.dom.addEventListener(s,a),{name:s,handler:a}})}destroy(){this.handlers.forEach(({name:t,handler:r})=>this.editorView.dom.removeEventListener(t,r))}update(t,r){this.cursorPos!=null&&r.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),r=!t.parent.inlineContent,n,s=this.editorView.dom,a=s.getBoundingClientRect(),i=a.width/s.offsetWidth,o=a.height/s.offsetHeight;if(r){let p=t.nodeBefore,x=t.nodeAfter;if(p||x){let g=this.editorView.nodeDOM(this.cursorPos-(p?p.nodeSize:0));if(g){let v=g.getBoundingClientRect(),y=p?v.bottom:v.top;p&&x&&(y=(y+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*o;n={left:v.left,right:v.right,top:y-w,bottom:y+w}}}}if(!n){let p=this.editorView.coordsAtPos(this.cursorPos),x=this.width/2*i;n={left:p.left-x,right:p.left+x,top:p.top,bottom:p.bottom}}let c=this.editorView.dom.offsetParent;this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let f,h;if(!c||c==document.body&&getComputedStyle(c).position=="static")f=-pageXOffset,h=-pageYOffset;else{let p=c.getBoundingClientRect(),x=p.width/c.offsetWidth,g=p.height/c.offsetHeight;f=p.left-c.scrollLeft*x,h=p.top-c.scrollTop*g}this.element.style.left=(n.left-f)/i+"px",this.element.style.top=(n.top-h)/o+"px",this.element.style.width=(n.right-n.left)/i+"px",this.element.style.height=(n.bottom-n.top)/o+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),s=n&&n.type.spec.disableDropCursor,a=typeof s=="function"?s(this.editorView,r,t):s;if(r&&!a){let i=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=dF(this.editorView.state.doc,i,this.editorView.dragging.slice);o!=null&&(i=o)}this.setCursor(i),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}class Vr extends It{constructor(t){super(t,t)}map(t,r){let n=t.resolve(r.map(this.head));return Vr.valid(n)?new Vr(n):It.near(n)}content(){return it.empty}eq(t){return t instanceof Vr&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Vr(t.resolve(r.pos))}getBookmark(){return new NN(this.anchor)}static valid(t){let r=t.parent;if(r.isTextblock||!mxe(t)||!xxe(t))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let s=r.contentMatchAt(t.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(t,r,n=!1){e:for(;;){if(!n&&Vr.valid(t))return t;let s=t.pos,a=null;for(let i=t.depth;;i--){let o=t.node(i);if(r>0?t.indexAfter(i)<o.childCount:t.index(i)>0){a=o.child(r>0?t.indexAfter(i):t.index(i)-1);break}else if(i==0)return null;s+=r;let c=t.doc.resolve(s);if(Vr.valid(c))return c}for(;;){let i=r>0?a.firstChild:a.lastChild;if(!i){if(a.isAtom&&!a.isText&&!xt.isSelectable(a)){t=t.doc.resolve(s+a.nodeSize*r),n=!1;continue e}break}a=i,s+=r;let o=t.doc.resolve(s);if(Vr.valid(o))return o}return null}}}Vr.prototype.visible=!1;Vr.findFrom=Vr.findGapCursorFrom;It.jsonID("gapcursor",Vr);class NN{constructor(t){this.pos=t}map(t){return new NN(t.map(this.pos))}resolve(t){let r=t.resolve(this.pos);return Vr.valid(r)?new Vr(r):It.near(r)}}function bL(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function mxe(e){for(let t=e.depth;t>=0;t--){let r=e.index(t),n=e.node(t);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let s=n.child(r-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||bL(s.type))return!0;if(s.inlineContent)return!1}}return!0}function xxe(e){for(let t=e.depth;t>=0;t--){let r=e.indexAfter(t),n=e.node(t);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let s=n.child(r);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||bL(s.type))return!0;if(s.inlineContent)return!1}}return!0}function gxe(){return new Fr({props:{decorations:wxe,createSelectionBetween(e,t,r){return t.pos==r.pos&&Vr.valid(r)?new Vr(r):null},handleClick:vxe,handleKeyDown:yxe,handleDOMEvents:{beforeinput:bxe}}})}const yxe=hP({ArrowLeft:lx("horiz",-1),ArrowRight:lx("horiz",1),ArrowUp:lx("vert",-1),ArrowDown:lx("vert",1)});function lx(e,t){const r=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(n,s,a){let i=n.selection,o=t>0?i.$to:i.$from,c=i.empty;if(i instanceof St){if(!a.endOfTextblock(r)||o.depth==0)return!1;c=!1,o=n.doc.resolve(t>0?o.after():o.before())}let f=Vr.findGapCursorFrom(o,t,c);return f?(s&&s(n.tr.setSelection(new Vr(f))),!0):!1}}function vxe(e,t,r){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!Vr.valid(n))return!1;let s=e.posAtCoords({left:r.clientX,top:r.clientY});return s&&s.inside>-1&&xt.isSelectable(e.state.doc.nodeAt(s.inside))?!1:(e.dispatch(e.state.tr.setSelection(new Vr(n))),!0)}function bxe(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof Vr))return!1;let{$from:r}=e.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let s=Ge.empty;for(let i=n.length-1;i>=0;i--)s=Ge.from(n[i].createAndFill(null,s));let a=e.state.tr.replace(r.pos,r.pos,new it(s,0,0));return a.setSelection(St.near(a.doc.resolve(r.pos+1))),e.dispatch(a),!1}function wxe(e){if(!(e.selection instanceof Vr))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Or.create(e.doc,[ws.widget(e.selection.head,t,{key:"gapcursor"})])}var Qg=200,Pn=function(){};Pn.prototype.append=function(t){return t.length?(t=Pn.from(t),!this.length&&t||t.length<Qg&&this.leafAppend(t)||this.length<Qg&&t.leafPrepend(this)||this.appendInner(t)):this};Pn.prototype.prepend=function(t){return t.length?Pn.from(t).append(this):this};Pn.prototype.appendInner=function(t){return new _xe(this,t)};Pn.prototype.slice=function(t,r){return t===void 0&&(t=0),r===void 0&&(r=this.length),t>=r?Pn.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,r))};Pn.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};Pn.prototype.forEach=function(t,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(t,r,n,0):this.forEachInvertedInner(t,r,n,0)};Pn.prototype.map=function(t,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var s=[];return this.forEach(function(a,i){return s.push(t(a,i))},r,n),s};Pn.from=function(t){return t instanceof Pn?t:t&&t.length?new wL(t):Pn.empty};var wL=(function(e){function t(n){e.call(this),this.values=n}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(s,a){return s==0&&a==this.length?this:new t(this.values.slice(s,a))},t.prototype.getInner=function(s){return this.values[s]},t.prototype.forEachInner=function(s,a,i,o){for(var c=a;c<i;c++)if(s(this.values[c],o+c)===!1)return!1},t.prototype.forEachInvertedInner=function(s,a,i,o){for(var c=a-1;c>=i;c--)if(s(this.values[c],o+c)===!1)return!1},t.prototype.leafAppend=function(s){if(this.length+s.length<=Qg)return new t(this.values.concat(s.flatten()))},t.prototype.leafPrepend=function(s){if(this.length+s.length<=Qg)return new t(s.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(t.prototype,r),t})(Pn);Pn.empty=new wL([]);var _xe=(function(e){function t(r,n){e.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},t.prototype.forEachInner=function(n,s,a,i){var o=this.left.length;if(s<o&&this.left.forEachInner(n,s,Math.min(a,o),i)===!1||a>o&&this.right.forEachInner(n,Math.max(s-o,0),Math.min(this.length,a)-o,i+o)===!1)return!1},t.prototype.forEachInvertedInner=function(n,s,a,i){var o=this.left.length;if(s>o&&this.right.forEachInvertedInner(n,s-o,Math.max(a,o)-o,i+o)===!1||a<o&&this.left.forEachInvertedInner(n,Math.min(s,o),a,i)===!1)return!1},t.prototype.sliceInner=function(n,s){if(n==0&&s==this.length)return this;var a=this.left.length;return s<=a?this.left.slice(n,s):n>=a?this.right.slice(n-a,s-a):this.left.slice(n,a).append(this.right.slice(0,s-a))},t.prototype.leafAppend=function(n){var s=this.right.leafAppend(n);if(s)return new t(this.left,s)},t.prototype.leafPrepend=function(n){var s=this.left.leafPrepend(n);if(s)return new t(s,this.right)},t.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new t(this.left,new t(this.right,n)):new t(this,n)},t})(Pn);const Exe=500;class ni{constructor(t,r){this.items=t,this.eventCount=r}popEvent(t,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let s,a;r&&(s=this.remapping(n,this.items.length),a=s.maps.length);let i=t.tr,o,c,f=[],h=[];return this.items.forEach((p,x)=>{if(!p.step){s||(s=this.remapping(n,x+1),a=s.maps.length),a--,h.push(p);return}if(s){h.push(new yl(p.map));let g=p.step.map(s.slice(a)),v;g&&i.maybeStep(g).doc&&(v=i.mapping.maps[i.mapping.maps.length-1],f.push(new yl(v,void 0,void 0,f.length+h.length))),a--,v&&s.appendMap(v,a)}else i.maybeStep(p.step);if(p.selection)return o=s?p.selection.map(s.slice(a)):p.selection,c=new ni(this.items.slice(0,n).append(h.reverse().concat(f)),this.eventCount-1),!1},this.items.length,0),{remaining:c,transform:i,selection:o}}addTransform(t,r,n,s){let a=[],i=this.eventCount,o=this.items,c=!s&&o.length?o.get(o.length-1):null;for(let h=0;h<t.steps.length;h++){let p=t.steps[h].invert(t.docs[h]),x=new yl(t.mapping.maps[h],p,r),g;(g=c&&c.merge(x))&&(x=g,h?a.pop():o=o.slice(0,o.length-1)),a.push(x),r&&(i++,r=void 0),s||(c=x)}let f=i-n.depth;return f>Nxe&&(o=Sxe(o,f),i-=f),new ni(o.append(a),i)}remapping(t,r){let n=new N0;return this.items.forEach((s,a)=>{let i=s.mirrorOffset!=null&&a-s.mirrorOffset>=t?n.maps.length-s.mirrorOffset:void 0;n.appendMap(s.map,i)},t,r),n}addMaps(t){return this.eventCount==0?this:new ni(this.items.append(t.map(r=>new yl(r))),this.eventCount)}rebased(t,r){if(!this.eventCount)return this;let n=[],s=Math.max(0,this.items.length-r),a=t.mapping,i=t.steps.length,o=this.eventCount;this.items.forEach(x=>{x.selection&&o--},s);let c=r;this.items.forEach(x=>{let g=a.getMirror(--c);if(g==null)return;i=Math.min(i,g);let v=a.maps[g];if(x.step){let y=t.steps[g].invert(t.docs[g]),w=x.selection&&x.selection.map(a.slice(c+1,g));w&&o++,n.push(new yl(v,y,w))}else n.push(new yl(v))},s);let f=[];for(let x=r;x<i;x++)f.push(new yl(a.maps[x]));let h=this.items.slice(0,s).append(f).append(n),p=new ni(h,o);return p.emptyItemCount()>Exe&&(p=p.compress(this.items.length-n.length)),p}emptyItemCount(){let t=0;return this.items.forEach(r=>{r.step||t++}),t}compress(t=this.items.length){let r=this.remapping(0,t),n=r.maps.length,s=[],a=0;return this.items.forEach((i,o)=>{if(o>=t)s.push(i),i.selection&&a++;else if(i.step){let c=i.step.map(r.slice(n)),f=c&&c.getMap();if(n--,f&&r.appendMap(f,n),c){let h=i.selection&&i.selection.map(r.slice(n));h&&a++;let p=new yl(f.invert(),c,h),x,g=s.length-1;(x=s.length&&s[g].merge(p))?s[g]=x:s.push(p)}}else i.map&&n--},this.items.length,0),new ni(Pn.from(s.reverse()),a)}}ni.empty=new ni(Pn.empty,0);function Sxe(e,t){let r;return e.forEach((n,s)=>{if(n.selection&&t--==0)return r=s,!1}),e.slice(r)}let yl=class _L{constructor(t,r,n,s){this.map=t,this.step=r,this.selection=n,this.mirrorOffset=s}merge(t){if(this.step&&t.step&&!t.selection){let r=t.step.merge(this.step);if(r)return new _L(r.getMap().invert(),r,this.selection)}}};class _l{constructor(t,r,n,s,a){this.done=t,this.undone=r,this.prevRanges=n,this.prevTime=s,this.prevComposition=a}}const Nxe=20;function Txe(e,t,r,n){let s=r.getMeta(Vc),a;if(s)return s.historyState;r.getMeta(Cxe)&&(e=new _l(e.done,e.undone,null,0,-1));let i=r.getMeta("appendedTransaction");if(r.steps.length==0)return e;if(i&&i.getMeta(Vc))return i.getMeta(Vc).redo?new _l(e.done.addTransform(r,void 0,n,Px(t)),e.undone,f6(r.mapping.maps),e.prevTime,e.prevComposition):new _l(e.done,e.undone.addTransform(r,void 0,n,Px(t)),null,e.prevTime,e.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(i&&i.getMeta("addToHistory")===!1)){let o=r.getMeta("composition"),c=e.prevTime==0||!i&&e.prevComposition!=o&&(e.prevTime<(r.time||0)-n.newGroupDelay||!kxe(r,e.prevRanges)),f=i?hw(e.prevRanges,r.mapping):f6(r.mapping.maps);return new _l(e.done.addTransform(r,c?t.selection.getBookmark():void 0,n,Px(t)),ni.empty,f,r.time,o??e.prevComposition)}else return(a=r.getMeta("rebased"))?new _l(e.done.rebased(r,a),e.undone.rebased(r,a),hw(e.prevRanges,r.mapping),e.prevTime,e.prevComposition):new _l(e.done.addMaps(r.mapping.maps),e.undone.addMaps(r.mapping.maps),hw(e.prevRanges,r.mapping),e.prevTime,e.prevComposition)}function kxe(e,t){if(!t)return!1;if(!e.docChanged)return!0;let r=!1;return e.mapping.maps[0].forEach((n,s)=>{for(let a=0;a<t.length;a+=2)n<=t[a+1]&&s>=t[a]&&(r=!0)}),r}function f6(e){let t=[];for(let r=e.length-1;r>=0&&t.length==0;r--)e[r].forEach((n,s,a,i)=>t.push(a,i));return t}function hw(e,t){if(!e)return null;let r=[];for(let n=0;n<e.length;n+=2){let s=t.map(e[n],1),a=t.map(e[n+1],-1);s<=a&&r.push(s,a)}return r}function Axe(e,t,r){let n=Px(t),s=Vc.get(t).spec.config,a=(r?e.undone:e.done).popEvent(t,n);if(!a)return null;let i=a.selection.resolve(a.transform.doc),o=(r?e.done:e.undone).addTransform(a.transform,t.selection.getBookmark(),s,n),c=new _l(r?o:a.remaining,r?a.remaining:o,null,0,-1);return a.transform.setSelection(i).setMeta(Vc,{redo:r,historyState:c})}let pw=!1,d6=null;function Px(e){let t=e.plugins;if(d6!=t){pw=!1,d6=t;for(let r=0;r<t.length;r++)if(t[r].spec.historyPreserveItems){pw=!0;break}}return pw}const Vc=new Nn("history"),Cxe=new Nn("closeHistory");function Rxe(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new Fr({key:Vc,state:{init(){return new _l(ni.empty,ni.empty,null,0,-1)},apply(t,r,n){return Txe(r,n,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,r){let n=r.inputType,s=n=="historyUndo"?SL:n=="historyRedo"?NL:null;return!s||!t.editable?!1:(r.preventDefault(),s(t.state,t.dispatch))}}}})}function EL(e,t){return(r,n)=>{let s=Vc.getState(r);if(!s||(e?s.undone:s.done).eventCount==0)return!1;if(n){let a=Axe(s,r,e);a&&n(t?a.scrollIntoView():a)}return!0}}const SL=EL(!1,!0),NL=EL(!0,!0);en.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc;if(((e==null?void 0:e.mode)||this.options.mode)==="textSize"){const n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc,r=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let e=!1;return[new Fr({key:new Nn("characterCount"),appendTransaction:(t,r,n)=>{if(e)return;const s=this.options.limit;if(s==null||s===0){e=!0;return}const a=this.storage.characters({node:n.doc});if(a>s){const i=a-s,o=0,c=i;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const f=n.tr.deleteRange(o,c);return e=!0,f}e=!0},filterTransaction:(t,r)=>{const n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;const s=this.storage.characters({node:r.doc}),a=this.storage.characters({node:t.doc});if(a<=n||s>n&&a>n&&a<=s)return!0;if(s>n&&a>n&&a>s||!t.getMeta("paste"))return!1;const o=t.selection.$head.pos,c=a-n,f=o-c,h=o;return t.deleteRange(f,h),!(this.storage.characters({node:t.doc})>n)}})]}});var jxe=en.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[hxe(this.options)]}});en.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Fr({key:new Nn("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:s}=t,a=[];if(!r||!n)return Or.create(e,[]);let i=0;this.options.mode==="deepest"&&e.descendants((c,f)=>{if(c.isText)return;if(!(s>=f&&s<=f+c.nodeSize-1))return!1;i+=1});let o=0;return e.descendants((c,f)=>{if(c.isText||!(s>=f&&s<=f+c.nodeSize-1))return!1;if(o+=1,this.options.mode==="deepest"&&i-o>0||this.options.mode==="shallowest"&&o>1)return this.options.mode==="deepest";a.push(ws.node(f,f+c.nodeSize,{class:this.options.className}))}),Or.create(e,a)}}})]}});var Oxe=en.create({name:"gapCursor",addProseMirrorPlugins(){return[gxe()]},extendNodeSchema(e){var t;const r={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=rr(ht(e,"allowGapCursor",r)))!=null?t:null}}}),h6="placeholder";function Dxe(e){return e.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}en.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:h6,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const e=this.options.dataAttribute?`data-${Dxe(this.options.dataAttribute)}`:`data-${h6}`;return[new Fr({key:new Nn("placeholder"),props:{decorations:({doc:t,selection:r})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=r,a=[];if(!n)return null;const i=this.editor.isEmpty;return t.descendants((o,c)=>{const f=s>=c&&s<=c+o.nodeSize,h=!o.isLeaf&&z1(o);if((f||!this.options.showOnlyCurrent)&&h){const p=[this.options.emptyNodeClass];i&&p.push(this.options.emptyEditorClass);const x=ws.node(c,c+o.nodeSize,{class:p.join(" "),[e]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:c,hasAnchor:f}):this.options.placeholder});a.push(x)}return this.options.includeChildren}),Or.create(t,a)}}})]}});en.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new Fr({key:new Nn("selection"),props:{decorations(r){return r.selection.empty||e.isFocused||!e.isEditable||CP(r.selection)||e.view.dragging?null:Or.create(r.doc,[ws.inline(r.selection.from,r.selection.to,{class:t.className})])}}})]}});function p6({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||(t==null?void 0:t.type)===e}var Ixe=en.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;const t=new Nn(this.name),r=this.options.node||((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(r).includes(s.name));return[new Fr({key:t,appendTransaction:(s,a,i)=>{const{doc:o,tr:c,schema:f}=i,h=t.getState(i),p=o.content.size,x=f.nodes[r];if(h)return c.insert(p,x.create())},state:{init:(s,a)=>{const i=a.tr.doc.lastChild;return!p6({node:i,types:n})},apply:(s,a)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return a;const i=s.doc.lastChild;return!p6({node:i,types:n})}}})]}}),Mxe=en.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>SL(e,t),redo:()=>({state:e,dispatch:t})=>NL(e,t)}},addProseMirrorPlugins(){return[Rxe(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Fxe=en.create({name:"starterKit",addExtensions(){var e,t,r,n;const s=[];return this.options.bold!==!1&&s.push(ome.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(rme.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(cL.configure(this.options.bulletList)),this.options.code!==!1&&s.push(ume.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(hme.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(pme.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(jxe.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(Oxe.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(mme.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(xme.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(Mxe.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(gme.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(_me.configure(this.options.italic)),this.options.listItem!==!1&&s.push(uL.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(xL.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&s.push(lL.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&s.push(yL.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(oxe.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(uxe.configure(this.options.strike)),this.options.text!==!1&&s.push(fxe.configure(this.options.text)),this.options.underline!==!1&&s.push(vL.configure((r=this.options)==null?void 0:r.underline)),this.options.trailingNode!==!1&&s.push(Ixe.configure((n=this.options)==null?void 0:n.trailingNode)),s}}),Pxe=Fxe;const Lxe=({editor:e})=>{if(!e)return null;const t=r=>`
    p-2 rounded-lg transition-all
    ${r?"bg-blue-100 text-blue-600 shadow-inner":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}
  `;return d.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 bg-white border-b border-slate-200 sticky top-0 z-10 transition-shadow duration-300",children:[d.jsx("button",{onClick:()=>e.chain().focus().toggleBold().run(),className:t(e.isActive("bold")),title:"Bold",children:d.jsx(TK,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().toggleItalic().run(),className:t(e.isActive("italic")),title:"Italic",children:d.jsx(yX,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().toggleUnderline().run(),className:t(e.isActive("underline")),title:"Underline",children:d.jsx(dY,{size:18})}),d.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),d.jsx("button",{onClick:()=>e.chain().focus().toggleHeading({level:1}).run(),className:t(e.isActive("heading",{level:1})),title:"Heading 1",children:d.jsx(cX,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().toggleHeading({level:2}).run(),className:t(e.isActive("heading",{level:2})),title:"Heading 2",children:d.jsx(fX,{size:18})}),d.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),d.jsx("button",{onClick:()=>e.chain().focus().toggleBulletList().run(),className:t(e.isActive("bulletList")),title:"Bullet List",children:d.jsx(TX,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().toggleOrderedList().run(),className:t(e.isActive("orderedList")),title:"Ordered List",children:d.jsx(SX,{size:18})}),d.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),d.jsx("button",{onClick:()=>e.chain().focus().undo().run(),disabled:!e.can().undo(),className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100 disabled:opacity-30",title:"Undo",children:d.jsx(GX,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().redo().run(),disabled:!e.can().redo(),className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100 disabled:opacity-30",title:"Redo",children:d.jsx(XX,{size:18})})]})},Bxe=({content:e,onChange:t,editable:r=!0})=>{const n=Jpe({extensions:[Pxe,dxe,Gme.configure({openOnClick:!1})],content:e,editable:r,onUpdate:({editor:s})=>{t(s.getJSON(),s.getHTML())},editorProps:{attributes:{class:"prose prose-slate max-w-none focus:outline-none min-h-[700px] p-16 text-slate-800 leading-normal tiptap-editor",style:"font-family: 'Times New Roman', serif; font-size: 11pt;"}}});return We.useEffect(()=>{n&&n.setEditable(r)},[n,r]),d.jsxs("div",{className:"w-full bg-white border border-slate-200 overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-300",children:[d.jsx("style",{children:`
                .tiptap-editor p {
                    margin-top: 0 !important;
                    margin-bottom: 1.25em !important;
                    line-height: 1.6 !important;
                }
                .tiptap-editor ul {
                    list-style-type: disc !important;
                    margin-bottom: 1.25em !important;
                    padding-left: 1.5em !important;
                }
                .tiptap-editor ol {
                    list-style-type: decimal !important;
                    margin-bottom: 1.25em !important;
                    padding-left: 1.5em !important;
                }
                .tiptap-editor li p {
                    margin-bottom: 0.5em !important;
                }
                .tiptap-editor h1 { margin-bottom: 0.5em !important; }
                .tiptap-editor h2 { margin-bottom: 0.5em !important; }
                `}),r&&d.jsx(Lxe,{editor:n}),d.jsx("div",{className:"bg-slate-50/50 p-4 min-h-[800px] flex justify-center overflow-y-auto",children:d.jsx("div",{className:"bg-white border border-slate-200 w-full max-w-[850px] min-h-[1100px] animate-fade-in ring-1 ring-slate-900/5",children:d.jsx(KP,{editor:n})})})]})};var Uxe=Object.defineProperty,zxe=Object.defineProperties,Hxe=Object.getOwnPropertyDescriptors,m6=Object.getOwnPropertySymbols,Vxe=Object.prototype.hasOwnProperty,qxe=Object.prototype.propertyIsEnumerable,hE=(e,t,r)=>t in e?Uxe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Dt=(e,t)=>{for(var r in t||(t={}))Vxe.call(t,r)&&hE(e,r,t[r]);if(m6)for(var r of m6(t))qxe.call(t,r)&&hE(e,r,t[r]);return e},Lo=(e,t)=>zxe(e,Hxe(t)),Pe=(e,t,r)=>hE(e,typeof t!="symbol"?t+"":t,r),Wxe=(e,t,r)=>new Promise((n,s)=>{var a=c=>{try{o(r.next(c))}catch(f){s(f)}},i=c=>{try{o(r.throw(c))}catch(f){s(f)}},o=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,i);o((r=r.apply(e,t)).next())});class e1{constructor(t){Pe(this,"rootKey"),this.rootKey=t}}const $xe=Object.seal({});class Be extends e1{constructor(t){super(t),Pe(this,"root"),this.root=new Array}prepForXml(t){var r;t.stack.push(this);const n=this.root.map(s=>s instanceof e1?s.prepForXml(t):s).filter(s=>s!==void 0);return t.stack.pop(),{[this.rootKey]:n.length?n.length===1&&((r=n[0])!=null&&r._attr)?n[0]:n:$xe}}addChildElement(t){return this.root.push(t),this}}class W1 extends Be{prepForXml(t){const r=super.prepForXml(t);if(r&&(typeof r[this.rootKey]!="object"||Object.keys(r[this.rootKey]).length))return r}}class ut extends e1{constructor(t){super("_attr"),Pe(this,"xmlKeys"),this.root=t}prepForXml(t){const r={};return Object.entries(this.root).forEach(([n,s])=>{if(s!==void 0){const a=this.xmlKeys&&this.xmlKeys[n]||n;r[a]=s}}),{_attr:r}}}class fp extends e1{constructor(t){super("_attr"),this.root=t}prepForXml(t){return{_attr:Object.values(this.root).filter(({value:n})=>n!==void 0).reduce((n,{key:s,value:a})=>Lo(Dt({},n),{[s]:a}),{})}}}class tn extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Pi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function TN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var mw={},cx={exports:{}},x6;function kN(){if(x6)return cx.exports;x6=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(k,O,R){return Function.prototype.apply.call(k,O,R)},r;e&&typeof e.ownKeys=="function"?r=e.ownKeys:Object.getOwnPropertySymbols?r=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:r=function(k){return Object.getOwnPropertyNames(k)};function n(N){console&&console.warn&&console.warn(N)}var s=Number.isNaN||function(k){return k!==k};function a(){a.init.call(this)}cx.exports=a,cx.exports.once=_,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var i=10;function o(N){if(typeof N!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof N)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(N){if(typeof N!="number"||N<0||s(N))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+N+".");i=N}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function c(N){return N._maxListeners===void 0?a.defaultMaxListeners:N._maxListeners}a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(k){for(var O=[],R=1;R<arguments.length;R++)O.push(arguments[R]);var V=k==="error",I=this._events;if(I!==void 0)V=V&&I.error===void 0;else if(!V)return!1;if(V){var Z;if(O.length>0&&(Z=O[0]),Z instanceof Error)throw Z;var ce=new Error("Unhandled error."+(Z?" ("+Z.message+")":""));throw ce.context=Z,ce}var F=I[k];if(F===void 0)return!1;if(typeof F=="function")t(F,this,O);else for(var X=F.length,P=v(F,X),R=0;R<X;++R)t(P[R],this,O);return!0};function f(N,k,O,R){var V,I,Z;if(o(O),I=N._events,I===void 0?(I=N._events=Object.create(null),N._eventsCount=0):(I.newListener!==void 0&&(N.emit("newListener",k,O.listener?O.listener:O),I=N._events),Z=I[k]),Z===void 0)Z=I[k]=O,++N._eventsCount;else if(typeof Z=="function"?Z=I[k]=R?[O,Z]:[Z,O]:R?Z.unshift(O):Z.push(O),V=c(N),V>0&&Z.length>V&&!Z.warned){Z.warned=!0;var ce=new Error("Possible EventEmitter memory leak detected. "+Z.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");ce.name="MaxListenersExceededWarning",ce.emitter=N,ce.type=k,ce.count=Z.length,n(ce)}return N}a.prototype.addListener=function(k,O){return f(this,k,O,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(k,O){return f(this,k,O,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(N,k,O){var R={fired:!1,wrapFn:void 0,target:N,type:k,listener:O},V=h.bind(R);return V.listener=O,R.wrapFn=V,V}a.prototype.once=function(k,O){return o(O),this.on(k,p(this,k,O)),this},a.prototype.prependOnceListener=function(k,O){return o(O),this.prependListener(k,p(this,k,O)),this},a.prototype.removeListener=function(k,O){var R,V,I,Z,ce;if(o(O),V=this._events,V===void 0)return this;if(R=V[k],R===void 0)return this;if(R===O||R.listener===O)--this._eventsCount===0?this._events=Object.create(null):(delete V[k],V.removeListener&&this.emit("removeListener",k,R.listener||O));else if(typeof R!="function"){for(I=-1,Z=R.length-1;Z>=0;Z--)if(R[Z]===O||R[Z].listener===O){ce=R[Z].listener,I=Z;break}if(I<0)return this;I===0?R.shift():y(R,I),R.length===1&&(V[k]=R[0]),V.removeListener!==void 0&&this.emit("removeListener",k,ce||O)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(k){var O,R,V;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[k]),this;if(arguments.length===0){var I=Object.keys(R),Z;for(V=0;V<I.length;++V)Z=I[V],Z!=="removeListener"&&this.removeAllListeners(Z);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(O=R[k],typeof O=="function")this.removeListener(k,O);else if(O!==void 0)for(V=O.length-1;V>=0;V--)this.removeListener(k,O[V]);return this};function x(N,k,O){var R=N._events;if(R===void 0)return[];var V=R[k];return V===void 0?[]:typeof V=="function"?O?[V.listener||V]:[V]:O?w(V):v(V,V.length)}a.prototype.listeners=function(k){return x(this,k,!0)},a.prototype.rawListeners=function(k){return x(this,k,!1)},a.listenerCount=function(N,k){return typeof N.listenerCount=="function"?N.listenerCount(k):g.call(N,k)},a.prototype.listenerCount=g;function g(N){var k=this._events;if(k!==void 0){var O=k[N];if(typeof O=="function")return 1;if(O!==void 0)return O.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function v(N,k){for(var O=new Array(k),R=0;R<k;++R)O[R]=N[R];return O}function y(N,k){for(;k+1<N.length;k++)N[k]=N[k+1];N.pop()}function w(N){for(var k=new Array(N.length),O=0;O<k.length;++O)k[O]=N[O].listener||N[O];return k}function _(N,k){return new Promise(function(O,R){function V(Z){N.removeListener(k,I),R(Z)}function I(){typeof N.removeListener=="function"&&N.removeListener("error",V),O([].slice.call(arguments))}E(N,k,I,{once:!0}),k!=="error"&&S(N,V,{once:!0})})}function S(N,k,O){typeof N.on=="function"&&E(N,"error",k,O)}function E(N,k,O,R){if(typeof N.on=="function")R.once?N.once(k,O):N.on(k,O);else if(typeof N.addEventListener=="function")N.addEventListener(k,function V(I){R.once&&N.removeEventListener(k,V),O(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof N)}return cx.exports}var ux={exports:{}},g6;function Zl(){return g6||(g6=1,typeof Object.create=="function"?ux.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:ux.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}}),ux.exports}function Gxe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var TL={exports:{}},rn=TL.exports={},Di,Ii;function pE(){throw new Error("setTimeout has not been defined")}function mE(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Di=setTimeout:Di=pE}catch{Di=pE}try{typeof clearTimeout=="function"?Ii=clearTimeout:Ii=mE}catch{Ii=mE}})();function kL(e){if(Di===setTimeout)return setTimeout(e,0);if((Di===pE||!Di)&&setTimeout)return Di=setTimeout,setTimeout(e,0);try{return Di(e,0)}catch{try{return Di.call(null,e,0)}catch{return Di.call(this,e,0)}}}function Kxe(e){if(Ii===clearTimeout)return clearTimeout(e);if((Ii===mE||!Ii)&&clearTimeout)return Ii=clearTimeout,clearTimeout(e);try{return Ii(e)}catch{try{return Ii.call(null,e)}catch{return Ii.call(this,e)}}}var To=[],wf=!1,Rc,Lx=-1;function Xxe(){!wf||!Rc||(wf=!1,Rc.length?To=Rc.concat(To):Lx=-1,To.length&&AL())}function AL(){if(!wf){var e=kL(Xxe);wf=!0;for(var t=To.length;t;){for(Rc=To,To=[];++Lx<t;)Rc&&Rc[Lx].run();Lx=-1,t=To.length}Rc=null,wf=!1,Kxe(e)}}rn.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];To.push(new CL(e,t)),To.length===1&&!wf&&kL(AL)};function CL(e,t){this.fun=e,this.array=t}CL.prototype.run=function(){this.fun.apply(null,this.array)};rn.title="browser";rn.browser=!0;rn.env={};rn.argv=[];rn.version="";rn.versions={};function Vo(){}rn.on=Vo;rn.addListener=Vo;rn.once=Vo;rn.off=Vo;rn.removeListener=Vo;rn.removeAllListeners=Vo;rn.emit=Vo;rn.prependListener=Vo;rn.prependOnceListener=Vo;rn.listeners=function(e){return[]};rn.binding=function(e){throw new Error("process.binding is not supported")};rn.cwd=function(){return"/"};rn.chdir=function(e){throw new Error("process.chdir is not supported")};rn.umask=function(){return 0};var Yxe=TL.exports;const Mt=Gxe(Yxe);var xw,y6;function RL(){return y6||(y6=1,xw=kN().EventEmitter),xw}var gw={},yh={},v6;function Jxe(){if(v6)return yh;v6=1,yh.byteLength=o,yh.toByteArray=f,yh.fromByteArray=x;for(var e=[],t=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=n.length;s<a;++s)e[s]=n[s],t[n.charCodeAt(s)]=s;t[45]=62,t[95]=63;function i(g){var v=g.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=g.indexOf("=");y===-1&&(y=v);var w=y===v?0:4-y%4;return[y,w]}function o(g){var v=i(g),y=v[0],w=v[1];return(y+w)*3/4-w}function c(g,v,y){return(v+y)*3/4-y}function f(g){var v,y=i(g),w=y[0],_=y[1],S=new r(c(g,w,_)),E=0,N=_>0?w-4:w,k;for(k=0;k<N;k+=4)v=t[g.charCodeAt(k)]<<18|t[g.charCodeAt(k+1)]<<12|t[g.charCodeAt(k+2)]<<6|t[g.charCodeAt(k+3)],S[E++]=v>>16&255,S[E++]=v>>8&255,S[E++]=v&255;return _===2&&(v=t[g.charCodeAt(k)]<<2|t[g.charCodeAt(k+1)]>>4,S[E++]=v&255),_===1&&(v=t[g.charCodeAt(k)]<<10|t[g.charCodeAt(k+1)]<<4|t[g.charCodeAt(k+2)]>>2,S[E++]=v>>8&255,S[E++]=v&255),S}function h(g){return e[g>>18&63]+e[g>>12&63]+e[g>>6&63]+e[g&63]}function p(g,v,y){for(var w,_=[],S=v;S<y;S+=3)w=(g[S]<<16&16711680)+(g[S+1]<<8&65280)+(g[S+2]&255),_.push(h(w));return _.join("")}function x(g){for(var v,y=g.length,w=y%3,_=[],S=16383,E=0,N=y-w;E<N;E+=S)_.push(p(g,E,E+S>N?N:E+S));return w===1?(v=g[y-1],_.push(e[v>>2]+e[v<<4&63]+"==")):w===2&&(v=(g[y-2]<<8)+g[y-1],_.push(e[v>>10]+e[v>>4&63]+e[v<<2&63]+"=")),_.join("")}return yh}var fx={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var b6;function Zxe(){return b6||(b6=1,fx.read=function(e,t,r,n,s){var a,i,o=s*8-n-1,c=(1<<o)-1,f=c>>1,h=-7,p=r?s-1:0,x=r?-1:1,g=e[t+p];for(p+=x,a=g&(1<<-h)-1,g>>=-h,h+=o;h>0;a=a*256+e[t+p],p+=x,h-=8);for(i=a&(1<<-h)-1,a>>=-h,h+=n;h>0;i=i*256+e[t+p],p+=x,h-=8);if(a===0)a=1-f;else{if(a===c)return i?NaN:(g?-1:1)*(1/0);i=i+Math.pow(2,n),a=a-f}return(g?-1:1)*i*Math.pow(2,a-n)},fx.write=function(e,t,r,n,s,a){var i,o,c,f=a*8-s-1,h=(1<<f)-1,p=h>>1,x=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:a-1,v=n?1:-1,y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,i=h):(i=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-i))<1&&(i--,c*=2),i+p>=1?t+=x/c:t+=x*Math.pow(2,1-p),t*c>=2&&(i++,c/=2),i+p>=h?(o=0,i=h):i+p>=1?(o=(t*c-1)*Math.pow(2,s),i=i+p):(o=t*Math.pow(2,p-1)*Math.pow(2,s),i=0));s>=8;e[r+g]=o&255,g+=v,o/=256,s-=8);for(i=i<<s|o,f+=s;f>0;e[r+g]=i&255,g+=v,i/=256,f-=8);e[r+g-v]|=y*128}),fx}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var w6;function $1(){return w6||(w6=1,(function(e){var t=Jxe(),r=Zxe(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=S,e.INSPECT_MAX_BYTES=50;var s=2147483647;e.kMaxLength=s,o.TYPED_ARRAY_SUPPORT=a(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{var M=new Uint8Array(1),A={foo:function(){return 42}};return Object.setPrototypeOf(A,Uint8Array.prototype),Object.setPrototypeOf(M,A),M.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function i(M){if(M>s)throw new RangeError('The value "'+M+'" is invalid for option "size"');var A=new Uint8Array(M);return Object.setPrototypeOf(A,o.prototype),A}function o(M,A,j){if(typeof M=="number"){if(typeof A=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(M)}return c(M,A,j)}o.poolSize=8192;function c(M,A,j){if(typeof M=="string")return x(M,A);if(ArrayBuffer.isView(M))return v(M);if(M==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M);if(be(M,ArrayBuffer)||M&&be(M.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(be(M,SharedArrayBuffer)||M&&be(M.buffer,SharedArrayBuffer)))return y(M,A,j);if(typeof M=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var H=M.valueOf&&M.valueOf();if(H!=null&&H!==M)return o.from(H,A,j);var ue=w(M);if(ue)return ue;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof M[Symbol.toPrimitive]=="function")return o.from(M[Symbol.toPrimitive]("string"),A,j);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M)}o.from=function(M,A,j){return c(M,A,j)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function f(M){if(typeof M!="number")throw new TypeError('"size" argument must be of type number');if(M<0)throw new RangeError('The value "'+M+'" is invalid for option "size"')}function h(M,A,j){return f(M),M<=0?i(M):A!==void 0?typeof j=="string"?i(M).fill(A,j):i(M).fill(A):i(M)}o.alloc=function(M,A,j){return h(M,A,j)};function p(M){return f(M),i(M<0?0:_(M)|0)}o.allocUnsafe=function(M){return p(M)},o.allocUnsafeSlow=function(M){return p(M)};function x(M,A){if((typeof A!="string"||A==="")&&(A="utf8"),!o.isEncoding(A))throw new TypeError("Unknown encoding: "+A);var j=E(M,A)|0,H=i(j),ue=H.write(M,A);return ue!==j&&(H=H.slice(0,ue)),H}function g(M){for(var A=M.length<0?0:_(M.length)|0,j=i(A),H=0;H<A;H+=1)j[H]=M[H]&255;return j}function v(M){if(be(M,Uint8Array)){var A=new Uint8Array(M);return y(A.buffer,A.byteOffset,A.byteLength)}return g(M)}function y(M,A,j){if(A<0||M.byteLength<A)throw new RangeError('"offset" is outside of buffer bounds');if(M.byteLength<A+(j||0))throw new RangeError('"length" is outside of buffer bounds');var H;return A===void 0&&j===void 0?H=new Uint8Array(M):j===void 0?H=new Uint8Array(M,A):H=new Uint8Array(M,A,j),Object.setPrototypeOf(H,o.prototype),H}function w(M){if(o.isBuffer(M)){var A=_(M.length)|0,j=i(A);return j.length===0||M.copy(j,0,0,A),j}if(M.length!==void 0)return typeof M.length!="number"||z(M.length)?i(0):g(M);if(M.type==="Buffer"&&Array.isArray(M.data))return g(M.data)}function _(M){if(M>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return M|0}function S(M){return+M!=M&&(M=0),o.alloc(+M)}o.isBuffer=function(A){return A!=null&&A._isBuffer===!0&&A!==o.prototype},o.compare=function(A,j){if(be(A,Uint8Array)&&(A=o.from(A,A.offset,A.byteLength)),be(j,Uint8Array)&&(j=o.from(j,j.offset,j.byteLength)),!o.isBuffer(A)||!o.isBuffer(j))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(A===j)return 0;for(var H=A.length,ue=j.length,ye=0,pe=Math.min(H,ue);ye<pe;++ye)if(A[ye]!==j[ye]){H=A[ye],ue=j[ye];break}return H<ue?-1:ue<H?1:0},o.isEncoding=function(A){switch(String(A).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(A,j){if(!Array.isArray(A))throw new TypeError('"list" argument must be an Array of Buffers');if(A.length===0)return o.alloc(0);var H;if(j===void 0)for(j=0,H=0;H<A.length;++H)j+=A[H].length;var ue=o.allocUnsafe(j),ye=0;for(H=0;H<A.length;++H){var pe=A[H];if(be(pe,Uint8Array))ye+pe.length>ue.length?o.from(pe).copy(ue,ye):Uint8Array.prototype.set.call(ue,pe,ye);else if(o.isBuffer(pe))pe.copy(ue,ye);else throw new TypeError('"list" argument must be an Array of Buffers');ye+=pe.length}return ue};function E(M,A){if(o.isBuffer(M))return M.length;if(ArrayBuffer.isView(M)||be(M,ArrayBuffer))return M.byteLength;if(typeof M!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof M);var j=M.length,H=arguments.length>2&&arguments[2]===!0;if(!H&&j===0)return 0;for(var ue=!1;;)switch(A){case"ascii":case"latin1":case"binary":return j;case"utf8":case"utf-8":return L(M).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j*2;case"hex":return j>>>1;case"base64":return ee(M).length;default:if(ue)return H?-1:L(M).length;A=(""+A).toLowerCase(),ue=!0}}o.byteLength=E;function N(M,A,j){var H=!1;if((A===void 0||A<0)&&(A=0),A>this.length||((j===void 0||j>this.length)&&(j=this.length),j<=0)||(j>>>=0,A>>>=0,j<=A))return"";for(M||(M="utf8");;)switch(M){case"hex":return oe(this,A,j);case"utf8":case"utf-8":return P(this,A,j);case"ascii":return Y(this,A,j);case"latin1":case"binary":return ve(this,A,j);case"base64":return X(this,A,j);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ee(this,A,j);default:if(H)throw new TypeError("Unknown encoding: "+M);M=(M+"").toLowerCase(),H=!0}}o.prototype._isBuffer=!0;function k(M,A,j){var H=M[A];M[A]=M[j],M[j]=H}o.prototype.swap16=function(){var A=this.length;if(A%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var j=0;j<A;j+=2)k(this,j,j+1);return this},o.prototype.swap32=function(){var A=this.length;if(A%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var j=0;j<A;j+=4)k(this,j,j+3),k(this,j+1,j+2);return this},o.prototype.swap64=function(){var A=this.length;if(A%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var j=0;j<A;j+=8)k(this,j,j+7),k(this,j+1,j+6),k(this,j+2,j+5),k(this,j+3,j+4);return this},o.prototype.toString=function(){var A=this.length;return A===0?"":arguments.length===0?P(this,0,A):N.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(A){if(!o.isBuffer(A))throw new TypeError("Argument must be a Buffer");return this===A?!0:o.compare(this,A)===0},o.prototype.inspect=function(){var A="",j=e.INSPECT_MAX_BYTES;return A=this.toString("hex",0,j).replace(/(.{2})/g,"$1 ").trim(),this.length>j&&(A+=" ... "),"<Buffer "+A+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(A,j,H,ue,ye){if(be(A,Uint8Array)&&(A=o.from(A,A.offset,A.byteLength)),!o.isBuffer(A))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof A);if(j===void 0&&(j=0),H===void 0&&(H=A?A.length:0),ue===void 0&&(ue=0),ye===void 0&&(ye=this.length),j<0||H>A.length||ue<0||ye>this.length)throw new RangeError("out of range index");if(ue>=ye&&j>=H)return 0;if(ue>=ye)return-1;if(j>=H)return 1;if(j>>>=0,H>>>=0,ue>>>=0,ye>>>=0,this===A)return 0;for(var pe=ye-ue,Ne=H-j,De=Math.min(pe,Ne),Fe=this.slice(ue,ye),Ke=A.slice(j,H),st=0;st<De;++st)if(Fe[st]!==Ke[st]){pe=Fe[st],Ne=Ke[st];break}return pe<Ne?-1:Ne<pe?1:0};function O(M,A,j,H,ue){if(M.length===0)return-1;if(typeof j=="string"?(H=j,j=0):j>2147483647?j=2147483647:j<-2147483648&&(j=-2147483648),j=+j,z(j)&&(j=ue?0:M.length-1),j<0&&(j=M.length+j),j>=M.length){if(ue)return-1;j=M.length-1}else if(j<0)if(ue)j=0;else return-1;if(typeof A=="string"&&(A=o.from(A,H)),o.isBuffer(A))return A.length===0?-1:R(M,A,j,H,ue);if(typeof A=="number")return A=A&255,typeof Uint8Array.prototype.indexOf=="function"?ue?Uint8Array.prototype.indexOf.call(M,A,j):Uint8Array.prototype.lastIndexOf.call(M,A,j):R(M,[A],j,H,ue);throw new TypeError("val must be string, number or Buffer")}function R(M,A,j,H,ue){var ye=1,pe=M.length,Ne=A.length;if(H!==void 0&&(H=String(H).toLowerCase(),H==="ucs2"||H==="ucs-2"||H==="utf16le"||H==="utf-16le")){if(M.length<2||A.length<2)return-1;ye=2,pe/=2,Ne/=2,j/=2}function De(Gt,dt){return ye===1?Gt[dt]:Gt.readUInt16BE(dt*ye)}var Fe;if(ue){var Ke=-1;for(Fe=j;Fe<pe;Fe++)if(De(M,Fe)===De(A,Ke===-1?0:Fe-Ke)){if(Ke===-1&&(Ke=Fe),Fe-Ke+1===Ne)return Ke*ye}else Ke!==-1&&(Fe-=Fe-Ke),Ke=-1}else for(j+Ne>pe&&(j=pe-Ne),Fe=j;Fe>=0;Fe--){for(var st=!0,at=0;at<Ne;at++)if(De(M,Fe+at)!==De(A,at)){st=!1;break}if(st)return Fe}return-1}o.prototype.includes=function(A,j,H){return this.indexOf(A,j,H)!==-1},o.prototype.indexOf=function(A,j,H){return O(this,A,j,H,!0)},o.prototype.lastIndexOf=function(A,j,H){return O(this,A,j,H,!1)};function V(M,A,j,H){j=Number(j)||0;var ue=M.length-j;H?(H=Number(H),H>ue&&(H=ue)):H=ue;var ye=A.length;H>ye/2&&(H=ye/2);for(var pe=0;pe<H;++pe){var Ne=parseInt(A.substr(pe*2,2),16);if(z(Ne))return pe;M[j+pe]=Ne}return pe}function I(M,A,j,H){return B(L(A,M.length-j),M,j,H)}function Z(M,A,j,H){return B(se(A),M,j,H)}function ce(M,A,j,H){return B(ee(A),M,j,H)}function F(M,A,j,H){return B(Q(A,M.length-j),M,j,H)}o.prototype.write=function(A,j,H,ue){if(j===void 0)ue="utf8",H=this.length,j=0;else if(H===void 0&&typeof j=="string")ue=j,H=this.length,j=0;else if(isFinite(j))j=j>>>0,isFinite(H)?(H=H>>>0,ue===void 0&&(ue="utf8")):(ue=H,H=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ye=this.length-j;if((H===void 0||H>ye)&&(H=ye),A.length>0&&(H<0||j<0)||j>this.length)throw new RangeError("Attempt to write outside buffer bounds");ue||(ue="utf8");for(var pe=!1;;)switch(ue){case"hex":return V(this,A,j,H);case"utf8":case"utf-8":return I(this,A,j,H);case"ascii":case"latin1":case"binary":return Z(this,A,j,H);case"base64":return ce(this,A,j,H);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,A,j,H);default:if(pe)throw new TypeError("Unknown encoding: "+ue);ue=(""+ue).toLowerCase(),pe=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function X(M,A,j){return A===0&&j===M.length?t.fromByteArray(M):t.fromByteArray(M.slice(A,j))}function P(M,A,j){j=Math.min(M.length,j);for(var H=[],ue=A;ue<j;){var ye=M[ue],pe=null,Ne=ye>239?4:ye>223?3:ye>191?2:1;if(ue+Ne<=j){var De,Fe,Ke,st;switch(Ne){case 1:ye<128&&(pe=ye);break;case 2:De=M[ue+1],(De&192)===128&&(st=(ye&31)<<6|De&63,st>127&&(pe=st));break;case 3:De=M[ue+1],Fe=M[ue+2],(De&192)===128&&(Fe&192)===128&&(st=(ye&15)<<12|(De&63)<<6|Fe&63,st>2047&&(st<55296||st>57343)&&(pe=st));break;case 4:De=M[ue+1],Fe=M[ue+2],Ke=M[ue+3],(De&192)===128&&(Fe&192)===128&&(Ke&192)===128&&(st=(ye&15)<<18|(De&63)<<12|(Fe&63)<<6|Ke&63,st>65535&&st<1114112&&(pe=st))}}pe===null?(pe=65533,Ne=1):pe>65535&&(pe-=65536,H.push(pe>>>10&1023|55296),pe=56320|pe&1023),H.push(pe),ue+=Ne}return te(H)}var ie=4096;function te(M){var A=M.length;if(A<=ie)return String.fromCharCode.apply(String,M);for(var j="",H=0;H<A;)j+=String.fromCharCode.apply(String,M.slice(H,H+=ie));return j}function Y(M,A,j){var H="";j=Math.min(M.length,j);for(var ue=A;ue<j;++ue)H+=String.fromCharCode(M[ue]&127);return H}function ve(M,A,j){var H="";j=Math.min(M.length,j);for(var ue=A;ue<j;++ue)H+=String.fromCharCode(M[ue]);return H}function oe(M,A,j){var H=M.length;(!A||A<0)&&(A=0),(!j||j<0||j>H)&&(j=H);for(var ue="",ye=A;ye<j;++ye)ue+=he[M[ye]];return ue}function Ee(M,A,j){for(var H=M.slice(A,j),ue="",ye=0;ye<H.length-1;ye+=2)ue+=String.fromCharCode(H[ye]+H[ye+1]*256);return ue}o.prototype.slice=function(A,j){var H=this.length;A=~~A,j=j===void 0?H:~~j,A<0?(A+=H,A<0&&(A=0)):A>H&&(A=H),j<0?(j+=H,j<0&&(j=0)):j>H&&(j=H),j<A&&(j=A);var ue=this.subarray(A,j);return Object.setPrototypeOf(ue,o.prototype),ue};function K(M,A,j){if(M%1!==0||M<0)throw new RangeError("offset is not uint");if(M+A>j)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(A,j,H){A=A>>>0,j=j>>>0,H||K(A,j,this.length);for(var ue=this[A],ye=1,pe=0;++pe<j&&(ye*=256);)ue+=this[A+pe]*ye;return ue},o.prototype.readUintBE=o.prototype.readUIntBE=function(A,j,H){A=A>>>0,j=j>>>0,H||K(A,j,this.length);for(var ue=this[A+--j],ye=1;j>0&&(ye*=256);)ue+=this[A+--j]*ye;return ue},o.prototype.readUint8=o.prototype.readUInt8=function(A,j){return A=A>>>0,j||K(A,1,this.length),this[A]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(A,j){return A=A>>>0,j||K(A,2,this.length),this[A]|this[A+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(A,j){return A=A>>>0,j||K(A,2,this.length),this[A]<<8|this[A+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(A,j){return A=A>>>0,j||K(A,4,this.length),(this[A]|this[A+1]<<8|this[A+2]<<16)+this[A+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(A,j){return A=A>>>0,j||K(A,4,this.length),this[A]*16777216+(this[A+1]<<16|this[A+2]<<8|this[A+3])},o.prototype.readIntLE=function(A,j,H){A=A>>>0,j=j>>>0,H||K(A,j,this.length);for(var ue=this[A],ye=1,pe=0;++pe<j&&(ye*=256);)ue+=this[A+pe]*ye;return ye*=128,ue>=ye&&(ue-=Math.pow(2,8*j)),ue},o.prototype.readIntBE=function(A,j,H){A=A>>>0,j=j>>>0,H||K(A,j,this.length);for(var ue=j,ye=1,pe=this[A+--ue];ue>0&&(ye*=256);)pe+=this[A+--ue]*ye;return ye*=128,pe>=ye&&(pe-=Math.pow(2,8*j)),pe},o.prototype.readInt8=function(A,j){return A=A>>>0,j||K(A,1,this.length),this[A]&128?(255-this[A]+1)*-1:this[A]},o.prototype.readInt16LE=function(A,j){A=A>>>0,j||K(A,2,this.length);var H=this[A]|this[A+1]<<8;return H&32768?H|4294901760:H},o.prototype.readInt16BE=function(A,j){A=A>>>0,j||K(A,2,this.length);var H=this[A+1]|this[A]<<8;return H&32768?H|4294901760:H},o.prototype.readInt32LE=function(A,j){return A=A>>>0,j||K(A,4,this.length),this[A]|this[A+1]<<8|this[A+2]<<16|this[A+3]<<24},o.prototype.readInt32BE=function(A,j){return A=A>>>0,j||K(A,4,this.length),this[A]<<24|this[A+1]<<16|this[A+2]<<8|this[A+3]},o.prototype.readFloatLE=function(A,j){return A=A>>>0,j||K(A,4,this.length),r.read(this,A,!0,23,4)},o.prototype.readFloatBE=function(A,j){return A=A>>>0,j||K(A,4,this.length),r.read(this,A,!1,23,4)},o.prototype.readDoubleLE=function(A,j){return A=A>>>0,j||K(A,8,this.length),r.read(this,A,!0,52,8)},o.prototype.readDoubleBE=function(A,j){return A=A>>>0,j||K(A,8,this.length),r.read(this,A,!1,52,8)};function D(M,A,j,H,ue,ye){if(!o.isBuffer(M))throw new TypeError('"buffer" argument must be a Buffer instance');if(A>ue||A<ye)throw new RangeError('"value" argument is out of bounds');if(j+H>M.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(A,j,H,ue){if(A=+A,j=j>>>0,H=H>>>0,!ue){var ye=Math.pow(2,8*H)-1;D(this,A,j,H,ye,0)}var pe=1,Ne=0;for(this[j]=A&255;++Ne<H&&(pe*=256);)this[j+Ne]=A/pe&255;return j+H},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(A,j,H,ue){if(A=+A,j=j>>>0,H=H>>>0,!ue){var ye=Math.pow(2,8*H)-1;D(this,A,j,H,ye,0)}var pe=H-1,Ne=1;for(this[j+pe]=A&255;--pe>=0&&(Ne*=256);)this[j+pe]=A/Ne&255;return j+H},o.prototype.writeUint8=o.prototype.writeUInt8=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,1,255,0),this[j]=A&255,j+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,2,65535,0),this[j]=A&255,this[j+1]=A>>>8,j+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,2,65535,0),this[j]=A>>>8,this[j+1]=A&255,j+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,4,4294967295,0),this[j+3]=A>>>24,this[j+2]=A>>>16,this[j+1]=A>>>8,this[j]=A&255,j+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,4,4294967295,0),this[j]=A>>>24,this[j+1]=A>>>16,this[j+2]=A>>>8,this[j+3]=A&255,j+4},o.prototype.writeIntLE=function(A,j,H,ue){if(A=+A,j=j>>>0,!ue){var ye=Math.pow(2,8*H-1);D(this,A,j,H,ye-1,-ye)}var pe=0,Ne=1,De=0;for(this[j]=A&255;++pe<H&&(Ne*=256);)A<0&&De===0&&this[j+pe-1]!==0&&(De=1),this[j+pe]=(A/Ne>>0)-De&255;return j+H},o.prototype.writeIntBE=function(A,j,H,ue){if(A=+A,j=j>>>0,!ue){var ye=Math.pow(2,8*H-1);D(this,A,j,H,ye-1,-ye)}var pe=H-1,Ne=1,De=0;for(this[j+pe]=A&255;--pe>=0&&(Ne*=256);)A<0&&De===0&&this[j+pe+1]!==0&&(De=1),this[j+pe]=(A/Ne>>0)-De&255;return j+H},o.prototype.writeInt8=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,1,127,-128),A<0&&(A=255+A+1),this[j]=A&255,j+1},o.prototype.writeInt16LE=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,2,32767,-32768),this[j]=A&255,this[j+1]=A>>>8,j+2},o.prototype.writeInt16BE=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,2,32767,-32768),this[j]=A>>>8,this[j+1]=A&255,j+2},o.prototype.writeInt32LE=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,4,2147483647,-2147483648),this[j]=A&255,this[j+1]=A>>>8,this[j+2]=A>>>16,this[j+3]=A>>>24,j+4},o.prototype.writeInt32BE=function(A,j,H){return A=+A,j=j>>>0,H||D(this,A,j,4,2147483647,-2147483648),A<0&&(A=4294967295+A+1),this[j]=A>>>24,this[j+1]=A>>>16,this[j+2]=A>>>8,this[j+3]=A&255,j+4};function q(M,A,j,H,ue,ye){if(j+H>M.length)throw new RangeError("Index out of range");if(j<0)throw new RangeError("Index out of range")}function W(M,A,j,H,ue){return A=+A,j=j>>>0,ue||q(M,A,j,4),r.write(M,A,j,H,23,4),j+4}o.prototype.writeFloatLE=function(A,j,H){return W(this,A,j,!0,H)},o.prototype.writeFloatBE=function(A,j,H){return W(this,A,j,!1,H)};function J(M,A,j,H,ue){return A=+A,j=j>>>0,ue||q(M,A,j,8),r.write(M,A,j,H,52,8),j+8}o.prototype.writeDoubleLE=function(A,j,H){return J(this,A,j,!0,H)},o.prototype.writeDoubleBE=function(A,j,H){return J(this,A,j,!1,H)},o.prototype.copy=function(A,j,H,ue){if(!o.isBuffer(A))throw new TypeError("argument should be a Buffer");if(H||(H=0),!ue&&ue!==0&&(ue=this.length),j>=A.length&&(j=A.length),j||(j=0),ue>0&&ue<H&&(ue=H),ue===H||A.length===0||this.length===0)return 0;if(j<0)throw new RangeError("targetStart out of bounds");if(H<0||H>=this.length)throw new RangeError("Index out of range");if(ue<0)throw new RangeError("sourceEnd out of bounds");ue>this.length&&(ue=this.length),A.length-j<ue-H&&(ue=A.length-j+H);var ye=ue-H;return this===A&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(j,H,ue):Uint8Array.prototype.set.call(A,this.subarray(H,ue),j),ye},o.prototype.fill=function(A,j,H,ue){if(typeof A=="string"){if(typeof j=="string"?(ue=j,j=0,H=this.length):typeof H=="string"&&(ue=H,H=this.length),ue!==void 0&&typeof ue!="string")throw new TypeError("encoding must be a string");if(typeof ue=="string"&&!o.isEncoding(ue))throw new TypeError("Unknown encoding: "+ue);if(A.length===1){var ye=A.charCodeAt(0);(ue==="utf8"&&ye<128||ue==="latin1")&&(A=ye)}}else typeof A=="number"?A=A&255:typeof A=="boolean"&&(A=Number(A));if(j<0||this.length<j||this.length<H)throw new RangeError("Out of range index");if(H<=j)return this;j=j>>>0,H=H===void 0?this.length:H>>>0,A||(A=0);var pe;if(typeof A=="number")for(pe=j;pe<H;++pe)this[pe]=A;else{var Ne=o.isBuffer(A)?A:o.from(A,ue),De=Ne.length;if(De===0)throw new TypeError('The value "'+A+'" is invalid for argument "value"');for(pe=0;pe<H-j;++pe)this[pe+j]=Ne[pe%De]}return this};var re=/[^+/0-9A-Za-z-_]/g;function U(M){if(M=M.split("=")[0],M=M.trim().replace(re,""),M.length<2)return"";for(;M.length%4!==0;)M=M+"=";return M}function L(M,A){A=A||1/0;for(var j,H=M.length,ue=null,ye=[],pe=0;pe<H;++pe){if(j=M.charCodeAt(pe),j>55295&&j<57344){if(!ue){if(j>56319){(A-=3)>-1&&ye.push(239,191,189);continue}else if(pe+1===H){(A-=3)>-1&&ye.push(239,191,189);continue}ue=j;continue}if(j<56320){(A-=3)>-1&&ye.push(239,191,189),ue=j;continue}j=(ue-55296<<10|j-56320)+65536}else ue&&(A-=3)>-1&&ye.push(239,191,189);if(ue=null,j<128){if((A-=1)<0)break;ye.push(j)}else if(j<2048){if((A-=2)<0)break;ye.push(j>>6|192,j&63|128)}else if(j<65536){if((A-=3)<0)break;ye.push(j>>12|224,j>>6&63|128,j&63|128)}else if(j<1114112){if((A-=4)<0)break;ye.push(j>>18|240,j>>12&63|128,j>>6&63|128,j&63|128)}else throw new Error("Invalid code point")}return ye}function se(M){for(var A=[],j=0;j<M.length;++j)A.push(M.charCodeAt(j)&255);return A}function Q(M,A){for(var j,H,ue,ye=[],pe=0;pe<M.length&&!((A-=2)<0);++pe)j=M.charCodeAt(pe),H=j>>8,ue=j%256,ye.push(ue),ye.push(H);return ye}function ee(M){return t.toByteArray(U(M))}function B(M,A,j,H){for(var ue=0;ue<H&&!(ue+j>=A.length||ue>=M.length);++ue)A[ue+j]=M[ue];return ue}function be(M,A){return M instanceof A||M!=null&&M.constructor!=null&&M.constructor.name!=null&&M.constructor.name===A.name}function z(M){return M!==M}var he=(function(){for(var M="0123456789abcdef",A=new Array(256),j=0;j<16;++j)for(var H=j*16,ue=0;ue<16;++ue)A[H+ue]=M[j]+M[ue];return A})()})(gw)),gw}var yw={},vw={},bw,_6;function jL(){return _6||(_6=1,bw=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;t[r]=s;for(var a in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,r);if(o.value!==s||o.enumerable!==!0)return!1}return!0}),bw}var ww,E6;function AN(){if(E6)return ww;E6=1;var e=jL();return ww=function(){return e()&&!!Symbol.toStringTag},ww}var _w,S6;function OL(){return S6||(S6=1,_w=Object),_w}var Ew,N6;function Qxe(){return N6||(N6=1,Ew=Error),Ew}var Sw,T6;function ege(){return T6||(T6=1,Sw=EvalError),Sw}var Nw,k6;function tge(){return k6||(k6=1,Nw=RangeError),Nw}var Tw,A6;function rge(){return A6||(A6=1,Tw=ReferenceError),Tw}var kw,C6;function DL(){return C6||(C6=1,kw=SyntaxError),kw}var Aw,R6;function dp(){return R6||(R6=1,Aw=TypeError),Aw}var Cw,j6;function nge(){return j6||(j6=1,Cw=URIError),Cw}var Rw,O6;function sge(){return O6||(O6=1,Rw=Math.abs),Rw}var jw,D6;function age(){return D6||(D6=1,jw=Math.floor),jw}var Ow,I6;function ige(){return I6||(I6=1,Ow=Math.max),Ow}var Dw,M6;function oge(){return M6||(M6=1,Dw=Math.min),Dw}var Iw,F6;function lge(){return F6||(F6=1,Iw=Math.pow),Iw}var Mw,P6;function cge(){return P6||(P6=1,Mw=Math.round),Mw}var Fw,L6;function uge(){return L6||(L6=1,Fw=Number.isNaN||function(t){return t!==t}),Fw}var Pw,B6;function fge(){if(B6)return Pw;B6=1;var e=uge();return Pw=function(r){return e(r)||r===0?r:r<0?-1:1},Pw}var Lw,U6;function dge(){return U6||(U6=1,Lw=Object.getOwnPropertyDescriptor),Lw}var Bw,z6;function hp(){if(z6)return Bw;z6=1;var e=dge();if(e)try{e([],"length")}catch{e=null}return Bw=e,Bw}var Uw,H6;function G1(){if(H6)return Uw;H6=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return Uw=e,Uw}var zw,V6;function hge(){if(V6)return zw;V6=1;var e=typeof Symbol<"u"&&Symbol,t=jL();return zw=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},zw}var Hw,q6;function IL(){return q6||(q6=1,Hw=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Hw}var Vw,W6;function ML(){if(W6)return Vw;W6=1;var e=OL();return Vw=e.getPrototypeOf||null,Vw}var qw,$6;function pge(){if($6)return qw;$6=1;var e="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,r=Math.max,n="[object Function]",s=function(c,f){for(var h=[],p=0;p<c.length;p+=1)h[p]=c[p];for(var x=0;x<f.length;x+=1)h[x+c.length]=f[x];return h},a=function(c,f){for(var h=[],p=f,x=0;p<c.length;p+=1,x+=1)h[x]=c[p];return h},i=function(o,c){for(var f="",h=0;h<o.length;h+=1)f+=o[h],h+1<o.length&&(f+=c);return f};return qw=function(c){var f=this;if(typeof f!="function"||t.apply(f)!==n)throw new TypeError(e+f);for(var h=a(arguments,1),p,x=function(){if(this instanceof p){var _=f.apply(this,s(h,arguments));return Object(_)===_?_:this}return f.apply(c,s(h,arguments))},g=r(0,f.length-h.length),v=[],y=0;y<g;y++)v[y]="$"+y;if(p=Function("binder","return function ("+i(v,",")+"){ return binder.apply(this,arguments); }")(x),f.prototype){var w=function(){};w.prototype=f.prototype,p.prototype=new w,w.prototype=null}return p},qw}var Ww,G6;function pp(){if(G6)return Ww;G6=1;var e=pge();return Ww=Function.prototype.bind||e,Ww}var $w,K6;function CN(){return K6||(K6=1,$w=Function.prototype.call),$w}var Gw,X6;function FL(){return X6||(X6=1,Gw=Function.prototype.apply),Gw}var Kw,Y6;function mge(){return Y6||(Y6=1,Kw=typeof Reflect<"u"&&Reflect&&Reflect.apply),Kw}var Xw,J6;function xge(){if(J6)return Xw;J6=1;var e=pp(),t=FL(),r=CN(),n=mge();return Xw=n||e.call(r,t),Xw}var Yw,Z6;function gge(){if(Z6)return Yw;Z6=1;var e=pp(),t=dp(),r=CN(),n=xge();return Yw=function(a){if(a.length<1||typeof a[0]!="function")throw new t("a function is required");return n(e,r,a)},Yw}var Jw,Q6;function yge(){if(Q6)return Jw;Q6=1;var e=gge(),t=hp(),r;try{r=[].__proto__===Array.prototype}catch(i){if(!i||typeof i!="object"||!("code"in i)||i.code!=="ERR_PROTO_ACCESS")throw i}var n=!!r&&t&&t(Object.prototype,"__proto__"),s=Object,a=s.getPrototypeOf;return Jw=n&&typeof n.get=="function"?e([n.get]):typeof a=="function"?(function(o){return a(o==null?o:s(o))}):!1,Jw}var Zw,ej;function vge(){if(ej)return Zw;ej=1;var e=IL(),t=ML(),r=yge();return Zw=e?function(s){return e(s)}:t?function(s){if(!s||typeof s!="object"&&typeof s!="function")throw new TypeError("getProto: not an object");return t(s)}:r?function(s){return r(s)}:null,Zw}var Qw,tj;function bge(){if(tj)return Qw;tj=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=pp();return Qw=r.call(e,t),Qw}var e2,rj;function RN(){if(rj)return e2;rj=1;var e,t=OL(),r=Qxe(),n=ege(),s=tge(),a=rge(),i=DL(),o=dp(),c=nge(),f=sge(),h=age(),p=ige(),x=oge(),g=lge(),v=cge(),y=fge(),w=Function,_=function(se){try{return w('"use strict"; return ('+se+").constructor;")()}catch{}},S=hp(),E=G1(),N=function(){throw new o},k=S?(function(){try{return arguments.callee,N}catch{try{return S(arguments,"callee").get}catch{return N}}})():N,O=hge()(),R=vge(),V=ML(),I=IL(),Z=FL(),ce=CN(),F={},X=typeof Uint8Array>"u"||!R?e:R(Uint8Array),P={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":O&&R?R([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":F,"%AsyncGenerator%":F,"%AsyncGeneratorFunction%":F,"%AsyncIteratorPrototype%":F,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":w,"%GeneratorFunction%":F,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":O&&R?R(R([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!O||!R?e:R(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":S,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":s,"%ReferenceError%":a,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!O||!R?e:R(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":O&&R?R(""[Symbol.iterator]()):e,"%Symbol%":O?Symbol:e,"%SyntaxError%":i,"%ThrowTypeError%":k,"%TypedArray%":X,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":c,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":ce,"%Function.prototype.apply%":Z,"%Object.defineProperty%":E,"%Object.getPrototypeOf%":V,"%Math.abs%":f,"%Math.floor%":h,"%Math.max%":p,"%Math.min%":x,"%Math.pow%":g,"%Math.round%":v,"%Math.sign%":y,"%Reflect.getPrototypeOf%":I};if(R)try{null.error}catch(se){var ie=R(R(se));P["%Error.prototype%"]=ie}var te=function se(Q){var ee;if(Q==="%AsyncFunction%")ee=_("async function () {}");else if(Q==="%GeneratorFunction%")ee=_("function* () {}");else if(Q==="%AsyncGeneratorFunction%")ee=_("async function* () {}");else if(Q==="%AsyncGenerator%"){var B=se("%AsyncGeneratorFunction%");B&&(ee=B.prototype)}else if(Q==="%AsyncIteratorPrototype%"){var be=se("%AsyncGenerator%");be&&R&&(ee=R(be.prototype))}return P[Q]=ee,ee},Y={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ve=pp(),oe=bge(),Ee=ve.call(ce,Array.prototype.concat),K=ve.call(Z,Array.prototype.splice),D=ve.call(ce,String.prototype.replace),q=ve.call(ce,String.prototype.slice),W=ve.call(ce,RegExp.prototype.exec),J=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,re=/\\(\\)?/g,U=function(Q){var ee=q(Q,0,1),B=q(Q,-1);if(ee==="%"&&B!=="%")throw new i("invalid intrinsic syntax, expected closing `%`");if(B==="%"&&ee!=="%")throw new i("invalid intrinsic syntax, expected opening `%`");var be=[];return D(Q,J,function(z,he,M,A){be[be.length]=M?D(A,re,"$1"):he||z}),be},L=function(Q,ee){var B=Q,be;if(oe(Y,B)&&(be=Y[B],B="%"+be[0]+"%"),oe(P,B)){var z=P[B];if(z===F&&(z=te(B)),typeof z>"u"&&!ee)throw new o("intrinsic "+Q+" exists, but is not available. Please file an issue!");return{alias:be,name:B,value:z}}throw new i("intrinsic "+Q+" does not exist!")};return e2=function(Q,ee){if(typeof Q!="string"||Q.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof ee!="boolean")throw new o('"allowMissing" argument must be a boolean');if(W(/^%?[^%]*%?$/,Q)===null)throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var B=U(Q),be=B.length>0?B[0]:"",z=L("%"+be+"%",ee),he=z.name,M=z.value,A=!1,j=z.alias;j&&(be=j[0],K(B,Ee([0,1],j)));for(var H=1,ue=!0;H<B.length;H+=1){var ye=B[H],pe=q(ye,0,1),Ne=q(ye,-1);if((pe==='"'||pe==="'"||pe==="`"||Ne==='"'||Ne==="'"||Ne==="`")&&pe!==Ne)throw new i("property names with quotes must have matching quotes");if((ye==="constructor"||!ue)&&(A=!0),be+="."+ye,he="%"+be+"%",oe(P,he))M=P[he];else if(M!=null){if(!(ye in M)){if(!ee)throw new o("base intrinsic for "+Q+" exists, but the property is not available.");return}if(S&&H+1>=B.length){var De=S(M,ye);ue=!!De,ue&&"get"in De&&!("originalValue"in De.get)?M=De.get:M=M[ye]}else ue=oe(M,ye),M=M[ye];ue&&!A&&(P[he]=M)}}return M},e2}var t2={exports:{}},r2,nj;function wge(){if(nj)return r2;nj=1;var e=G1(),t=DL(),r=dp(),n=hp();return r2=function(a,i,o){if(!a||typeof a!="object"&&typeof a!="function")throw new r("`obj` must be an object or a function`");if(typeof i!="string"&&typeof i!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,f=arguments.length>4?arguments[4]:null,h=arguments.length>5?arguments[5]:null,p=arguments.length>6?arguments[6]:!1,x=!!n&&n(a,i);if(e)e(a,i,{configurable:h===null&&x?x.configurable:!h,enumerable:c===null&&x?x.enumerable:!c,value:o,writable:f===null&&x?x.writable:!f});else if(p||!c&&!f&&!h)a[i]=o;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},r2}var n2,sj;function _ge(){if(sj)return n2;sj=1;var e=G1(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},n2=t,n2}var s2,aj;function Ege(){if(aj)return s2;aj=1;var e=RN(),t=wge(),r=_ge()(),n=hp(),s=dp(),a=e("%Math.floor%");return s2=function(o,c){if(typeof o!="function")throw new s("`fn` is not a function");if(typeof c!="number"||c<0||c>4294967295||a(c)!==c)throw new s("`length` must be a positive 32-bit integer");var f=arguments.length>2&&!!arguments[2],h=!0,p=!0;if("length"in o&&n){var x=n(o,"length");x&&!x.configurable&&(h=!1),x&&!x.writable&&(p=!1)}return(h||p||!f)&&(r?t(o,"length",c,!0,!0):t(o,"length",c)),o},s2}var ij;function PL(){return ij||(ij=1,(function(e){var t=pp(),r=RN(),n=Ege(),s=dp(),a=r("%Function.prototype.apply%"),i=r("%Function.prototype.call%"),o=r("%Reflect.apply%",!0)||t.call(i,a),c=G1(),f=r("%Math.max%");e.exports=function(x){if(typeof x!="function")throw new s("a function is required");var g=o(t,i,arguments);return n(g,1+f(0,x.length-(arguments.length-1)),!0)};var h=function(){return o(t,a,arguments)};c?c(e.exports,"apply",{value:h}):e.exports.apply=h})(t2)),t2.exports}var a2,oj;function LL(){if(oj)return a2;oj=1;var e=RN(),t=PL(),r=t(e("String.prototype.indexOf"));return a2=function(s,a){var i=e(s,!!a);return typeof i=="function"&&r(s,".prototype.")>-1?t(i):i},a2}var i2,lj;function Sge(){if(lj)return i2;lj=1;var e=AN()(),t=LL(),r=t("Object.prototype.toString"),n=function(o){return e&&o&&typeof o=="object"&&Symbol.toStringTag in o?!1:r(o)==="[object Arguments]"},s=function(o){return n(o)?!0:o!==null&&typeof o=="object"&&typeof o.length=="number"&&o.length>=0&&r(o)!=="[object Array]"&&r(o.callee)==="[object Function]"},a=(function(){return n(arguments)})();return n.isLegacyArguments=s,i2=a?n:s,i2}var o2,cj;function Nge(){if(cj)return o2;cj=1;var e=Object.prototype.toString,t=Function.prototype.toString,r=/^\s*(?:function)?\*/,n=AN()(),s=Object.getPrototypeOf,a=function(){if(!n)return!1;try{return Function("return function*() {}")()}catch{}},i;return o2=function(c){if(typeof c!="function")return!1;if(r.test(t.call(c)))return!0;if(!n){var f=e.call(c);return f==="[object GeneratorFunction]"}if(!s)return!1;if(typeof i>"u"){var h=a();i=h?s(h):!1}return s(c)===i},o2}var l2,uj;function Tge(){if(uj)return l2;uj=1;var e=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,n;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw n}}),n={},t(function(){throw 42},null,r)}catch(S){S!==n&&(t=null)}else t=null;var s=/^\s*class\b/,a=function(E){try{var N=e.call(E);return s.test(N)}catch{return!1}},i=function(E){try{return a(E)?!1:(e.call(E),!0)}catch{return!1}},o=Object.prototype.toString,c="[object Object]",f="[object Function]",h="[object GeneratorFunction]",p="[object HTMLAllCollection]",x="[object HTML document.all class]",g="[object HTMLCollection]",v=typeof Symbol=="function"&&!!Symbol.toStringTag,y=!(0 in[,]),w=function(){return!1};if(typeof document=="object"){var _=document.all;o.call(_)===o.call(document.all)&&(w=function(E){if((y||!E)&&(typeof E>"u"||typeof E=="object"))try{var N=o.call(E);return(N===p||N===x||N===g||N===c)&&E("")==null}catch{}return!1})}return l2=t?function(E){if(w(E))return!0;if(!E||typeof E!="function"&&typeof E!="object")return!1;try{t(E,null,r)}catch(N){if(N!==n)return!1}return!a(E)&&i(E)}:function(E){if(w(E))return!0;if(!E||typeof E!="function"&&typeof E!="object")return!1;if(v)return i(E);if(a(E))return!1;var N=o.call(E);return N!==f&&N!==h&&!/^\[object HTML/.test(N)?!1:i(E)},l2}var c2,fj;function kge(){if(fj)return c2;fj=1;var e=Tge(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty,n=function(c,f,h){for(var p=0,x=c.length;p<x;p++)r.call(c,p)&&(h==null?f(c[p],p,c):f.call(h,c[p],p,c))},s=function(c,f,h){for(var p=0,x=c.length;p<x;p++)h==null?f(c.charAt(p),p,c):f.call(h,c.charAt(p),p,c)},a=function(c,f,h){for(var p in c)r.call(c,p)&&(h==null?f(c[p],p,c):f.call(h,c[p],p,c))},i=function(c,f,h){if(!e(f))throw new TypeError("iterator must be a function");var p;arguments.length>=3&&(p=h),t.call(c)==="[object Array]"?n(c,f,p):typeof c=="string"?s(c,f,p):a(c,f,p)};return c2=i,c2}var u2,dj;function Age(){return dj||(dj=1,u2=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),u2}var f2,hj;function Cge(){if(hj)return f2;hj=1;var e=Age(),t=typeof globalThis>"u"?Pi:globalThis;return f2=function(){for(var n=[],s=0;s<e.length;s++)typeof t[e[s]]=="function"&&(n[n.length]=e[s]);return n},f2}var d2,pj;function BL(){if(pj)return d2;pj=1;var e=kge(),t=Cge(),r=PL(),n=LL(),s=hp(),a=n("Object.prototype.toString"),i=AN()(),o=typeof globalThis>"u"?Pi:globalThis,c=t(),f=n("String.prototype.slice"),h=Object.getPrototypeOf,p=n("Array.prototype.indexOf",!0)||function(w,_){for(var S=0;S<w.length;S+=1)if(w[S]===_)return S;return-1},x={__proto__:null};i&&s&&h?e(c,function(y){var w=new o[y];if(Symbol.toStringTag in w){var _=h(w),S=s(_,Symbol.toStringTag);if(!S){var E=h(_);S=s(E,Symbol.toStringTag)}x["$"+y]=r(S.get)}}):e(c,function(y){var w=new o[y],_=w.slice||w.set;_&&(x["$"+y]=r(_))});var g=function(w){var _=!1;return e(x,function(S,E){if(!_)try{"$"+S(w)===E&&(_=f(E,1))}catch{}}),_},v=function(w){var _=!1;return e(x,function(S,E){if(!_)try{S(w),_=f(E,1)}catch{}}),_};return d2=function(w){if(!w||typeof w!="object")return!1;if(!i){var _=f(a(w),8,-1);return p(c,_)>-1?_:_!=="Object"?!1:v(w)}return s?g(w):null},d2}var h2,mj;function Rge(){if(mj)return h2;mj=1;var e=BL();return h2=function(r){return!!e(r)},h2}var xj;function jge(){return xj||(xj=1,(function(e){var t=Sge(),r=Nge(),n=BL(),s=Rge();function a(H){return H.call.bind(H)}var i=typeof BigInt<"u",o=typeof Symbol<"u",c=a(Object.prototype.toString),f=a(Number.prototype.valueOf),h=a(String.prototype.valueOf),p=a(Boolean.prototype.valueOf);if(i)var x=a(BigInt.prototype.valueOf);if(o)var g=a(Symbol.prototype.valueOf);function v(H,ue){if(typeof H!="object")return!1;try{return ue(H),!0}catch{return!1}}e.isArgumentsObject=t,e.isGeneratorFunction=r,e.isTypedArray=s;function y(H){return typeof Promise<"u"&&H instanceof Promise||H!==null&&typeof H=="object"&&typeof H.then=="function"&&typeof H.catch=="function"}e.isPromise=y;function w(H){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(H):s(H)||q(H)}e.isArrayBufferView=w;function _(H){return n(H)==="Uint8Array"}e.isUint8Array=_;function S(H){return n(H)==="Uint8ClampedArray"}e.isUint8ClampedArray=S;function E(H){return n(H)==="Uint16Array"}e.isUint16Array=E;function N(H){return n(H)==="Uint32Array"}e.isUint32Array=N;function k(H){return n(H)==="Int8Array"}e.isInt8Array=k;function O(H){return n(H)==="Int16Array"}e.isInt16Array=O;function R(H){return n(H)==="Int32Array"}e.isInt32Array=R;function V(H){return n(H)==="Float32Array"}e.isFloat32Array=V;function I(H){return n(H)==="Float64Array"}e.isFloat64Array=I;function Z(H){return n(H)==="BigInt64Array"}e.isBigInt64Array=Z;function ce(H){return n(H)==="BigUint64Array"}e.isBigUint64Array=ce;function F(H){return c(H)==="[object Map]"}F.working=typeof Map<"u"&&F(new Map);function X(H){return typeof Map>"u"?!1:F.working?F(H):H instanceof Map}e.isMap=X;function P(H){return c(H)==="[object Set]"}P.working=typeof Set<"u"&&P(new Set);function ie(H){return typeof Set>"u"?!1:P.working?P(H):H instanceof Set}e.isSet=ie;function te(H){return c(H)==="[object WeakMap]"}te.working=typeof WeakMap<"u"&&te(new WeakMap);function Y(H){return typeof WeakMap>"u"?!1:te.working?te(H):H instanceof WeakMap}e.isWeakMap=Y;function ve(H){return c(H)==="[object WeakSet]"}ve.working=typeof WeakSet<"u"&&ve(new WeakSet);function oe(H){return ve(H)}e.isWeakSet=oe;function Ee(H){return c(H)==="[object ArrayBuffer]"}Ee.working=typeof ArrayBuffer<"u"&&Ee(new ArrayBuffer);function K(H){return typeof ArrayBuffer>"u"?!1:Ee.working?Ee(H):H instanceof ArrayBuffer}e.isArrayBuffer=K;function D(H){return c(H)==="[object DataView]"}D.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&D(new DataView(new ArrayBuffer(1),0,1));function q(H){return typeof DataView>"u"?!1:D.working?D(H):H instanceof DataView}e.isDataView=q;var W=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function J(H){return c(H)==="[object SharedArrayBuffer]"}function re(H){return typeof W>"u"?!1:(typeof J.working>"u"&&(J.working=J(new W)),J.working?J(H):H instanceof W)}e.isSharedArrayBuffer=re;function U(H){return c(H)==="[object AsyncFunction]"}e.isAsyncFunction=U;function L(H){return c(H)==="[object Map Iterator]"}e.isMapIterator=L;function se(H){return c(H)==="[object Set Iterator]"}e.isSetIterator=se;function Q(H){return c(H)==="[object Generator]"}e.isGeneratorObject=Q;function ee(H){return c(H)==="[object WebAssembly.Module]"}e.isWebAssemblyCompiledModule=ee;function B(H){return v(H,f)}e.isNumberObject=B;function be(H){return v(H,h)}e.isStringObject=be;function z(H){return v(H,p)}e.isBooleanObject=z;function he(H){return i&&v(H,x)}e.isBigIntObject=he;function M(H){return o&&v(H,g)}e.isSymbolObject=M;function A(H){return B(H)||be(H)||z(H)||he(H)||M(H)}e.isBoxedPrimitive=A;function j(H){return typeof Uint8Array<"u"&&(K(H)||re(H))}e.isAnyArrayBuffer=j,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(H){Object.defineProperty(e,H,{enumerable:!1,value:function(){throw new Error(H+" is not supported in userland")}})})})(vw)),vw}var p2,gj;function Oge(){return gj||(gj=1,p2=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),p2}var yj;function UL(){return yj||(yj=1,(function(e){var t=Object.getOwnPropertyDescriptors||function(q){for(var W=Object.keys(q),J={},re=0;re<W.length;re++)J[W[re]]=Object.getOwnPropertyDescriptor(q,W[re]);return J},r=/%[sdj%]/g;e.format=function(D){if(!k(D)){for(var q=[],W=0;W<arguments.length;W++)q.push(i(arguments[W]));return q.join(" ")}for(var W=1,J=arguments,re=J.length,U=String(D).replace(r,function(se){if(se==="%%")return"%";if(W>=re)return se;switch(se){case"%s":return String(J[W++]);case"%d":return Number(J[W++]);case"%j":try{return JSON.stringify(J[W++])}catch{return"[Circular]"}default:return se}}),L=J[W];W<re;L=J[++W])S(L)||!I(L)?U+=" "+L:U+=" "+i(L);return U},e.deprecate=function(D,q){if(typeof Mt<"u"&&Mt.noDeprecation===!0)return D;if(typeof Mt>"u")return function(){return e.deprecate(D,q).apply(this,arguments)};var W=!1;function J(){if(!W){if(Mt.throwDeprecation)throw new Error(q);Mt.traceDeprecation?console.trace(q):console.error(q),W=!0}return D.apply(this,arguments)}return J};var n={},s=/^$/;if(Mt.env.NODE_DEBUG){var a=Mt.env.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+a+"$","i")}e.debuglog=function(D){if(D=D.toUpperCase(),!n[D])if(s.test(D)){var q=Mt.pid;n[D]=function(){var W=e.format.apply(e,arguments);console.error("%s %d: %s",D,q,W)}}else n[D]=function(){};return n[D]};function i(D,q){var W={seen:[],stylize:c};return arguments.length>=3&&(W.depth=arguments[2]),arguments.length>=4&&(W.colors=arguments[3]),_(q)?W.showHidden=q:q&&e._extend(W,q),R(W.showHidden)&&(W.showHidden=!1),R(W.depth)&&(W.depth=2),R(W.colors)&&(W.colors=!1),R(W.customInspect)&&(W.customInspect=!0),W.colors&&(W.stylize=o),h(W,D,W.depth)}e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function o(D,q){var W=i.styles[q];return W?"\x1B["+i.colors[W][0]+"m"+D+"\x1B["+i.colors[W][1]+"m":D}function c(D,q){return D}function f(D){var q={};return D.forEach(function(W,J){q[W]=!0}),q}function h(D,q,W){if(D.customInspect&&q&&F(q.inspect)&&q.inspect!==e.inspect&&!(q.constructor&&q.constructor.prototype===q)){var J=q.inspect(W,D);return k(J)||(J=h(D,J,W)),J}var re=p(D,q);if(re)return re;var U=Object.keys(q),L=f(U);if(D.showHidden&&(U=Object.getOwnPropertyNames(q)),ce(q)&&(U.indexOf("message")>=0||U.indexOf("description")>=0))return x(q);if(U.length===0){if(F(q)){var se=q.name?": "+q.name:"";return D.stylize("[Function"+se+"]","special")}if(V(q))return D.stylize(RegExp.prototype.toString.call(q),"regexp");if(Z(q))return D.stylize(Date.prototype.toString.call(q),"date");if(ce(q))return x(q)}var Q="",ee=!1,B=["{","}"];if(w(q)&&(ee=!0,B=["[","]"]),F(q)){var be=q.name?": "+q.name:"";Q=" [Function"+be+"]"}if(V(q)&&(Q=" "+RegExp.prototype.toString.call(q)),Z(q)&&(Q=" "+Date.prototype.toUTCString.call(q)),ce(q)&&(Q=" "+x(q)),U.length===0&&(!ee||q.length==0))return B[0]+Q+B[1];if(W<0)return V(q)?D.stylize(RegExp.prototype.toString.call(q),"regexp"):D.stylize("[Object]","special");D.seen.push(q);var z;return ee?z=g(D,q,W,L,U):z=U.map(function(he){return v(D,q,W,L,he,ee)}),D.seen.pop(),y(z,Q,B)}function p(D,q){if(R(q))return D.stylize("undefined","undefined");if(k(q)){var W="'"+JSON.stringify(q).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return D.stylize(W,"string")}if(N(q))return D.stylize(""+q,"number");if(_(q))return D.stylize(""+q,"boolean");if(S(q))return D.stylize("null","null")}function x(D){return"["+Error.prototype.toString.call(D)+"]"}function g(D,q,W,J,re){for(var U=[],L=0,se=q.length;L<se;++L)ve(q,String(L))?U.push(v(D,q,W,J,String(L),!0)):U.push("");return re.forEach(function(Q){Q.match(/^\d+$/)||U.push(v(D,q,W,J,Q,!0))}),U}function v(D,q,W,J,re,U){var L,se,Q;if(Q=Object.getOwnPropertyDescriptor(q,re)||{value:q[re]},Q.get?Q.set?se=D.stylize("[Getter/Setter]","special"):se=D.stylize("[Getter]","special"):Q.set&&(se=D.stylize("[Setter]","special")),ve(J,re)||(L="["+re+"]"),se||(D.seen.indexOf(Q.value)<0?(S(W)?se=h(D,Q.value,null):se=h(D,Q.value,W-1),se.indexOf(`
`)>-1&&(U?se=se.split(`
`).map(function(ee){return"  "+ee}).join(`
`).slice(2):se=`
`+se.split(`
`).map(function(ee){return"   "+ee}).join(`
`))):se=D.stylize("[Circular]","special")),R(L)){if(U&&re.match(/^\d+$/))return se;L=JSON.stringify(""+re),L.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(L=L.slice(1,-1),L=D.stylize(L,"name")):(L=L.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),L=D.stylize(L,"string"))}return L+": "+se}function y(D,q,W){var J=D.reduce(function(re,U){return U.indexOf(`
`)>=0,re+U.replace(/\u001b\[\d\d?m/g,"").length+1},0);return J>60?W[0]+(q===""?"":q+`
 `)+" "+D.join(`,
  `)+" "+W[1]:W[0]+q+" "+D.join(", ")+" "+W[1]}e.types=jge();function w(D){return Array.isArray(D)}e.isArray=w;function _(D){return typeof D=="boolean"}e.isBoolean=_;function S(D){return D===null}e.isNull=S;function E(D){return D==null}e.isNullOrUndefined=E;function N(D){return typeof D=="number"}e.isNumber=N;function k(D){return typeof D=="string"}e.isString=k;function O(D){return typeof D=="symbol"}e.isSymbol=O;function R(D){return D===void 0}e.isUndefined=R;function V(D){return I(D)&&P(D)==="[object RegExp]"}e.isRegExp=V,e.types.isRegExp=V;function I(D){return typeof D=="object"&&D!==null}e.isObject=I;function Z(D){return I(D)&&P(D)==="[object Date]"}e.isDate=Z,e.types.isDate=Z;function ce(D){return I(D)&&(P(D)==="[object Error]"||D instanceof Error)}e.isError=ce,e.types.isNativeError=ce;function F(D){return typeof D=="function"}e.isFunction=F;function X(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"||typeof D=="symbol"||typeof D>"u"}e.isPrimitive=X,e.isBuffer=Oge();function P(D){return Object.prototype.toString.call(D)}function ie(D){return D<10?"0"+D.toString(10):D.toString(10)}var te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Y(){var D=new Date,q=[ie(D.getHours()),ie(D.getMinutes()),ie(D.getSeconds())].join(":");return[D.getDate(),te[D.getMonth()],q].join(" ")}e.log=function(){console.log("%s - %s",Y(),e.format.apply(e,arguments))},e.inherits=Zl(),e._extend=function(D,q){if(!q||!I(q))return D;for(var W=Object.keys(q),J=W.length;J--;)D[W[J]]=q[W[J]];return D};function ve(D,q){return Object.prototype.hasOwnProperty.call(D,q)}var oe=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;e.promisify=function(q){if(typeof q!="function")throw new TypeError('The "original" argument must be of type Function');if(oe&&q[oe]){var W=q[oe];if(typeof W!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(W,oe,{value:W,enumerable:!1,writable:!1,configurable:!0}),W}function W(){for(var J,re,U=new Promise(function(Q,ee){J=Q,re=ee}),L=[],se=0;se<arguments.length;se++)L.push(arguments[se]);L.push(function(Q,ee){Q?re(Q):J(ee)});try{q.apply(this,L)}catch(Q){re(Q)}return U}return Object.setPrototypeOf(W,Object.getPrototypeOf(q)),oe&&Object.defineProperty(W,oe,{value:W,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(W,t(q))},e.promisify.custom=oe;function Ee(D,q){if(!D){var W=new Error("Promise was rejected with a falsy value");W.reason=D,D=W}return q(D)}function K(D){if(typeof D!="function")throw new TypeError('The "original" argument must be of type Function');function q(){for(var W=[],J=0;J<arguments.length;J++)W.push(arguments[J]);var re=W.pop();if(typeof re!="function")throw new TypeError("The last argument must be of type Function");var U=this,L=function(){return re.apply(U,arguments)};D.apply(this,W).then(function(se){Mt.nextTick(L.bind(null,null,se))},function(se){Mt.nextTick(Ee.bind(null,se,L))})}return Object.setPrototypeOf(q,Object.getPrototypeOf(D)),Object.defineProperties(q,t(D)),q}e.callbackify=K})(yw)),yw}var m2,vj;function Dge(){if(vj)return m2;vj=1;function e(x,g){var v=Object.keys(x);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(x);g&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(x,w).enumerable})),v.push.apply(v,y)}return v}function t(x){for(var g=1;g<arguments.length;g++){var v=arguments[g]!=null?arguments[g]:{};g%2?e(Object(v),!0).forEach(function(y){r(x,y,v[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(v)):e(Object(v)).forEach(function(y){Object.defineProperty(x,y,Object.getOwnPropertyDescriptor(v,y))})}return x}function r(x,g,v){return g in x?Object.defineProperty(x,g,{value:v,enumerable:!0,configurable:!0,writable:!0}):x[g]=v,x}function n(x,g){if(!(x instanceof g))throw new TypeError("Cannot call a class as a function")}function s(x,g){for(var v=0;v<g.length;v++){var y=g[v];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}function a(x,g,v){return g&&s(x.prototype,g),x}var i=$1(),o=i.Buffer,c=UL(),f=c.inspect,h=f&&f.custom||"inspect";function p(x,g,v){o.prototype.copy.call(x,g,v)}return m2=(function(){function x(){n(this,x),this.head=null,this.tail=null,this.length=0}return a(x,[{key:"push",value:function(v){var y={data:v,next:null};this.length>0?this.tail.next=y:this.head=y,this.tail=y,++this.length}},{key:"unshift",value:function(v){var y={data:v,next:this.head};this.length===0&&(this.tail=y),this.head=y,++this.length}},{key:"shift",value:function(){if(this.length!==0){var v=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,v}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(v){if(this.length===0)return"";for(var y=this.head,w=""+y.data;y=y.next;)w+=v+y.data;return w}},{key:"concat",value:function(v){if(this.length===0)return o.alloc(0);for(var y=o.allocUnsafe(v>>>0),w=this.head,_=0;w;)p(w.data,y,_),_+=w.data.length,w=w.next;return y}},{key:"consume",value:function(v,y){var w;return v<this.head.data.length?(w=this.head.data.slice(0,v),this.head.data=this.head.data.slice(v)):v===this.head.data.length?w=this.shift():w=y?this._getString(v):this._getBuffer(v),w}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(v){var y=this.head,w=1,_=y.data;for(v-=_.length;y=y.next;){var S=y.data,E=v>S.length?S.length:v;if(E===S.length?_+=S:_+=S.slice(0,v),v-=E,v===0){E===S.length?(++w,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=S.slice(E));break}++w}return this.length-=w,_}},{key:"_getBuffer",value:function(v){var y=o.allocUnsafe(v),w=this.head,_=1;for(w.data.copy(y),v-=w.data.length;w=w.next;){var S=w.data,E=v>S.length?S.length:v;if(S.copy(y,y.length-v,0,E),v-=E,v===0){E===S.length?(++_,w.next?this.head=w.next:this.head=this.tail=null):(this.head=w,w.data=S.slice(E));break}++_}return this.length-=_,y}},{key:h,value:function(v,y){return f(this,t({},y,{depth:0,customInspect:!1}))}}]),x})(),m2}var x2,bj;function zL(){if(bj)return x2;bj=1;function e(i,o){var c=this,f=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return f||h?(o?o(i):i&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Mt.nextTick(s,this,i)):Mt.nextTick(s,this,i)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,function(p){!o&&p?c._writableState?c._writableState.errorEmitted?Mt.nextTick(r,c):(c._writableState.errorEmitted=!0,Mt.nextTick(t,c,p)):Mt.nextTick(t,c,p):o?(Mt.nextTick(r,c),o(p)):Mt.nextTick(r,c)}),this)}function t(i,o){s(i,o),r(i)}function r(i){i._writableState&&!i._writableState.emitClose||i._readableState&&!i._readableState.emitClose||i.emit("close")}function n(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function s(i,o){i.emit("error",o)}function a(i,o){var c=i._readableState,f=i._writableState;c&&c.autoDestroy||f&&f.autoDestroy?i.destroy(o):i.emit("error",o)}return x2={destroy:e,undestroy:n,errorOrDestroy:a},x2}var g2={},wj;function gd(){if(wj)return g2;wj=1;function e(o,c){o.prototype=Object.create(c.prototype),o.prototype.constructor=o,o.__proto__=c}var t={};function r(o,c,f){f||(f=Error);function h(x,g,v){return typeof c=="string"?c:c(x,g,v)}var p=(function(x){e(g,x);function g(v,y,w){return x.call(this,h(v,y,w))||this}return g})(f);p.prototype.name=f.name,p.prototype.code=o,t[o]=p}function n(o,c){if(Array.isArray(o)){var f=o.length;return o=o.map(function(h){return String(h)}),f>2?"one of ".concat(c," ").concat(o.slice(0,f-1).join(", "),", or ")+o[f-1]:f===2?"one of ".concat(c," ").concat(o[0]," or ").concat(o[1]):"of ".concat(c," ").concat(o[0])}else return"of ".concat(c," ").concat(String(o))}function s(o,c,f){return o.substr(0,c.length)===c}function a(o,c,f){return(f===void 0||f>o.length)&&(f=o.length),o.substring(f-c.length,f)===c}function i(o,c,f){return typeof f!="number"&&(f=0),f+c.length>o.length?!1:o.indexOf(c,f)!==-1}return r("ERR_INVALID_OPT_VALUE",function(o,c){return'The value "'+c+'" is invalid for option "'+o+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(o,c,f){var h;typeof c=="string"&&s(c,"not ")?(h="must not be",c=c.replace(/^not /,"")):h="must be";var p;if(a(o," argument"))p="The ".concat(o," ").concat(h," ").concat(n(c,"type"));else{var x=i(o,".")?"property":"argument";p='The "'.concat(o,'" ').concat(x," ").concat(h," ").concat(n(c,"type"))}return p+=". Received type ".concat(typeof f),p},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(o){return"The "+o+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(o){return"Cannot call "+o+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(o){return"Unknown encoding: "+o},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),g2.codes=t,g2}var y2,_j;function HL(){if(_j)return y2;_j=1;var e=gd().codes.ERR_INVALID_OPT_VALUE;function t(n,s,a){return n.highWaterMark!=null?n.highWaterMark:s?n[a]:null}function r(n,s,a,i){var o=t(s,i,a);if(o!=null){if(!(isFinite(o)&&Math.floor(o)===o)||o<0){var c=i?a:"highWaterMark";throw new e(c,o)}return Math.floor(o)}return n.objectMode?16:16*1024}return y2={getHighWaterMark:r},y2}var v2,Ej;function Ige(){if(Ej)return v2;Ej=1,v2=e;function e(r,n){if(t("noDeprecation"))return r;var s=!1;function a(){if(!s){if(t("throwDeprecation"))throw new Error(n);t("traceDeprecation")?console.trace(n):console.warn(n),s=!0}return r.apply(this,arguments)}return a}function t(r){try{if(!Pi.localStorage)return!1}catch{return!1}var n=Pi.localStorage[r];return n==null?!1:String(n).toLowerCase()==="true"}return v2}var b2,Sj;function VL(){if(Sj)return b2;Sj=1,b2=V;function e(re){var U=this;this.next=null,this.entry=null,this.finish=function(){J(U,re)}}var t;V.WritableState=O;var r={deprecate:Ige()},n=RL(),s=$1().Buffer,a=Pi.Uint8Array||function(){};function i(re){return s.from(re)}function o(re){return s.isBuffer(re)||re instanceof a}var c=zL(),f=HL(),h=f.getHighWaterMark,p=gd().codes,x=p.ERR_INVALID_ARG_TYPE,g=p.ERR_METHOD_NOT_IMPLEMENTED,v=p.ERR_MULTIPLE_CALLBACK,y=p.ERR_STREAM_CANNOT_PIPE,w=p.ERR_STREAM_DESTROYED,_=p.ERR_STREAM_NULL_VALUES,S=p.ERR_STREAM_WRITE_AFTER_END,E=p.ERR_UNKNOWN_ENCODING,N=c.errorOrDestroy;Zl()(V,n);function k(){}function O(re,U,L){t=t||Wf(),re=re||{},typeof L!="boolean"&&(L=U instanceof t),this.objectMode=!!re.objectMode,L&&(this.objectMode=this.objectMode||!!re.writableObjectMode),this.highWaterMark=h(this,re,"writableHighWaterMark",L),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var se=re.decodeStrings===!1;this.decodeStrings=!se,this.defaultEncoding=re.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Q){te(U,Q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=re.emitClose!==!1,this.autoDestroy=!!re.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}O.prototype.getBuffer=function(){for(var U=this.bufferedRequest,L=[];U;)L.push(U),U=U.next;return L},(function(){try{Object.defineProperty(O.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var R;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(R=Function.prototype[Symbol.hasInstance],Object.defineProperty(V,Symbol.hasInstance,{value:function(U){return R.call(this,U)?!0:this!==V?!1:U&&U._writableState instanceof O}})):R=function(U){return U instanceof this};function V(re){t=t||Wf();var U=this instanceof t;if(!U&&!R.call(V,this))return new V(re);this._writableState=new O(re,this,U),this.writable=!0,re&&(typeof re.write=="function"&&(this._write=re.write),typeof re.writev=="function"&&(this._writev=re.writev),typeof re.destroy=="function"&&(this._destroy=re.destroy),typeof re.final=="function"&&(this._final=re.final)),n.call(this)}V.prototype.pipe=function(){N(this,new y)};function I(re,U){var L=new S;N(re,L),Mt.nextTick(U,L)}function Z(re,U,L,se){var Q;return L===null?Q=new _:typeof L!="string"&&!U.objectMode&&(Q=new x("chunk",["string","Buffer"],L)),Q?(N(re,Q),Mt.nextTick(se,Q),!1):!0}V.prototype.write=function(re,U,L){var se=this._writableState,Q=!1,ee=!se.objectMode&&o(re);return ee&&!s.isBuffer(re)&&(re=i(re)),typeof U=="function"&&(L=U,U=null),ee?U="buffer":U||(U=se.defaultEncoding),typeof L!="function"&&(L=k),se.ending?I(this,L):(ee||Z(this,se,re,L))&&(se.pendingcb++,Q=F(this,se,ee,re,U,L)),Q},V.prototype.cork=function(){this._writableState.corked++},V.prototype.uncork=function(){var re=this._writableState;re.corked&&(re.corked--,!re.writing&&!re.corked&&!re.bufferProcessing&&re.bufferedRequest&&oe(this,re))},V.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=U.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((U+"").toLowerCase())>-1))throw new E(U);return this._writableState.defaultEncoding=U,this},Object.defineProperty(V.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ce(re,U,L){return!re.objectMode&&re.decodeStrings!==!1&&typeof U=="string"&&(U=s.from(U,L)),U}Object.defineProperty(V.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function F(re,U,L,se,Q,ee){if(!L){var B=ce(U,se,Q);se!==B&&(L=!0,Q="buffer",se=B)}var be=U.objectMode?1:se.length;U.length+=be;var z=U.length<U.highWaterMark;if(z||(U.needDrain=!0),U.writing||U.corked){var he=U.lastBufferedRequest;U.lastBufferedRequest={chunk:se,encoding:Q,isBuf:L,callback:ee,next:null},he?he.next=U.lastBufferedRequest:U.bufferedRequest=U.lastBufferedRequest,U.bufferedRequestCount+=1}else X(re,U,!1,be,se,Q,ee);return z}function X(re,U,L,se,Q,ee,B){U.writelen=se,U.writecb=B,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new w("write")):L?re._writev(Q,U.onwrite):re._write(Q,ee,U.onwrite),U.sync=!1}function P(re,U,L,se,Q){--U.pendingcb,L?(Mt.nextTick(Q,se),Mt.nextTick(q,re,U),re._writableState.errorEmitted=!0,N(re,se)):(Q(se),re._writableState.errorEmitted=!0,N(re,se),q(re,U))}function ie(re){re.writing=!1,re.writecb=null,re.length-=re.writelen,re.writelen=0}function te(re,U){var L=re._writableState,se=L.sync,Q=L.writecb;if(typeof Q!="function")throw new v;if(ie(L),U)P(re,L,se,U,Q);else{var ee=Ee(L)||re.destroyed;!ee&&!L.corked&&!L.bufferProcessing&&L.bufferedRequest&&oe(re,L),se?Mt.nextTick(Y,re,L,ee,Q):Y(re,L,ee,Q)}}function Y(re,U,L,se){L||ve(re,U),U.pendingcb--,se(),q(re,U)}function ve(re,U){U.length===0&&U.needDrain&&(U.needDrain=!1,re.emit("drain"))}function oe(re,U){U.bufferProcessing=!0;var L=U.bufferedRequest;if(re._writev&&L&&L.next){var se=U.bufferedRequestCount,Q=new Array(se),ee=U.corkedRequestsFree;ee.entry=L;for(var B=0,be=!0;L;)Q[B]=L,L.isBuf||(be=!1),L=L.next,B+=1;Q.allBuffers=be,X(re,U,!0,U.length,Q,"",ee.finish),U.pendingcb++,U.lastBufferedRequest=null,ee.next?(U.corkedRequestsFree=ee.next,ee.next=null):U.corkedRequestsFree=new e(U),U.bufferedRequestCount=0}else{for(;L;){var z=L.chunk,he=L.encoding,M=L.callback,A=U.objectMode?1:z.length;if(X(re,U,!1,A,z,he,M),L=L.next,U.bufferedRequestCount--,U.writing)break}L===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=L,U.bufferProcessing=!1}V.prototype._write=function(re,U,L){L(new g("_write()"))},V.prototype._writev=null,V.prototype.end=function(re,U,L){var se=this._writableState;return typeof re=="function"?(L=re,re=null,U=null):typeof U=="function"&&(L=U,U=null),re!=null&&this.write(re,U),se.corked&&(se.corked=1,this.uncork()),se.ending||W(this,se,L),this},Object.defineProperty(V.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Ee(re){return re.ending&&re.length===0&&re.bufferedRequest===null&&!re.finished&&!re.writing}function K(re,U){re._final(function(L){U.pendingcb--,L&&N(re,L),U.prefinished=!0,re.emit("prefinish"),q(re,U)})}function D(re,U){!U.prefinished&&!U.finalCalled&&(typeof re._final=="function"&&!U.destroyed?(U.pendingcb++,U.finalCalled=!0,Mt.nextTick(K,re,U)):(U.prefinished=!0,re.emit("prefinish")))}function q(re,U){var L=Ee(U);if(L&&(D(re,U),U.pendingcb===0&&(U.finished=!0,re.emit("finish"),U.autoDestroy))){var se=re._readableState;(!se||se.autoDestroy&&se.endEmitted)&&re.destroy()}return L}function W(re,U,L){U.ending=!0,q(re,U),L&&(U.finished?Mt.nextTick(L):re.once("finish",L)),U.ended=!0,re.writable=!1}function J(re,U,L){var se=re.entry;for(re.entry=null;se;){var Q=se.callback;U.pendingcb--,Q(L),se=se.next}U.corkedRequestsFree.next=re}return Object.defineProperty(V.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(U){this._writableState&&(this._writableState.destroyed=U)}}),V.prototype.destroy=c.destroy,V.prototype._undestroy=c.undestroy,V.prototype._destroy=function(re,U){U(re)},b2}var w2,Nj;function Wf(){if(Nj)return w2;Nj=1;var e=Object.keys||function(f){var h=[];for(var p in f)h.push(p);return h};w2=i;var t=qL(),r=VL();Zl()(i,t);for(var n=e(r.prototype),s=0;s<n.length;s++){var a=n[s];i.prototype[a]||(i.prototype[a]=r.prototype[a])}function i(f){if(!(this instanceof i))return new i(f);t.call(this,f),r.call(this,f),this.allowHalfOpen=!0,f&&(f.readable===!1&&(this.readable=!1),f.writable===!1&&(this.writable=!1),f.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o)))}Object.defineProperty(i.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(i.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(i.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function o(){this._writableState.ended||Mt.nextTick(c,this)}function c(f){f.end()}return Object.defineProperty(i.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(h){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=h,this._writableState.destroyed=h)}}),w2}var _2={},dx={exports:{}},Tj;function Mge(){return Tj||(Tj=1,(function(e,t){var r=$1(),n=r.Buffer;function s(i,o){for(var c in i)o[c]=i[c]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(s(r,t),t.Buffer=a);function a(i,o,c){return n(i,o,c)}s(n,a),a.from=function(i,o,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return n(i,o,c)},a.alloc=function(i,o,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var f=n(i);return o!==void 0?typeof c=="string"?f.fill(o,c):f.fill(o):f.fill(0),f},a.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n(i)},a.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(i)}})(dx,dx.exports)),dx.exports}var kj;function xE(){if(kj)return _2;kj=1;var e=Mge().Buffer,t=e.isEncoding||function(_){switch(_=""+_,_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(_){if(!_)return"utf8";for(var S;;)switch(_){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return _;default:if(S)return;_=(""+_).toLowerCase(),S=!0}}function n(_){var S=r(_);if(typeof S!="string"&&(e.isEncoding===t||!t(_)))throw new Error("Unknown encoding: "+_);return S||_}_2.StringDecoder=s;function s(_){this.encoding=n(_);var S;switch(this.encoding){case"utf16le":this.text=p,this.end=x,S=4;break;case"utf8":this.fillLast=c,S=4;break;case"base64":this.text=g,this.end=v,S=3;break;default:this.write=y,this.end=w;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(S)}s.prototype.write=function(_){if(_.length===0)return"";var S,E;if(this.lastNeed){if(S=this.fillLast(_),S===void 0)return"";E=this.lastNeed,this.lastNeed=0}else E=0;return E<_.length?S?S+this.text(_,E):this.text(_,E):S||""},s.prototype.end=h,s.prototype.text=f,s.prototype.fillLast=function(_){if(this.lastNeed<=_.length)return _.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,this.lastTotal-this.lastNeed,0,_.length),this.lastNeed-=_.length};function a(_){return _<=127?0:_>>5===6?2:_>>4===14?3:_>>3===30?4:_>>6===2?-1:-2}function i(_,S,E){var N=S.length-1;if(N<E)return 0;var k=a(S[N]);return k>=0?(k>0&&(_.lastNeed=k-1),k):--N<E||k===-2?0:(k=a(S[N]),k>=0?(k>0&&(_.lastNeed=k-2),k):--N<E||k===-2?0:(k=a(S[N]),k>=0?(k>0&&(k===2?k=0:_.lastNeed=k-3),k):0))}function o(_,S,E){if((S[0]&192)!==128)return _.lastNeed=0,"";if(_.lastNeed>1&&S.length>1){if((S[1]&192)!==128)return _.lastNeed=1,"";if(_.lastNeed>2&&S.length>2&&(S[2]&192)!==128)return _.lastNeed=2,""}}function c(_){var S=this.lastTotal-this.lastNeed,E=o(this,_);if(E!==void 0)return E;if(this.lastNeed<=_.length)return _.copy(this.lastChar,S,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,S,0,_.length),this.lastNeed-=_.length}function f(_,S){var E=i(this,_,S);if(!this.lastNeed)return _.toString("utf8",S);this.lastTotal=E;var N=_.length-(E-this.lastNeed);return _.copy(this.lastChar,0,N),_.toString("utf8",S,N)}function h(_){var S=_&&_.length?this.write(_):"";return this.lastNeed?S+"":S}function p(_,S){if((_.length-S)%2===0){var E=_.toString("utf16le",S);if(E){var N=E.charCodeAt(E.length-1);if(N>=55296&&N<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1],E.slice(0,-1)}return E}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=_[_.length-1],_.toString("utf16le",S,_.length-1)}function x(_){var S=_&&_.length?this.write(_):"";if(this.lastNeed){var E=this.lastTotal-this.lastNeed;return S+this.lastChar.toString("utf16le",0,E)}return S}function g(_,S){var E=(_.length-S)%3;return E===0?_.toString("base64",S):(this.lastNeed=3-E,this.lastTotal=3,E===1?this.lastChar[0]=_[_.length-1]:(this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1]),_.toString("base64",S,_.length-E))}function v(_){var S=_&&_.length?this.write(_):"";return this.lastNeed?S+this.lastChar.toString("base64",0,3-this.lastNeed):S}function y(_){return _.toString(this.encoding)}function w(_){return _&&_.length?this.write(_):""}return _2}var E2,Aj;function jN(){if(Aj)return E2;Aj=1;var e=gd().codes.ERR_STREAM_PREMATURE_CLOSE;function t(a){var i=!1;return function(){if(!i){i=!0;for(var o=arguments.length,c=new Array(o),f=0;f<o;f++)c[f]=arguments[f];a.apply(this,c)}}}function r(){}function n(a){return a.setHeader&&typeof a.abort=="function"}function s(a,i,o){if(typeof i=="function")return s(a,null,i);i||(i={}),o=t(o||r);var c=i.readable||i.readable!==!1&&a.readable,f=i.writable||i.writable!==!1&&a.writable,h=function(){a.writable||x()},p=a._writableState&&a._writableState.finished,x=function(){f=!1,p=!0,c||o.call(a)},g=a._readableState&&a._readableState.endEmitted,v=function(){c=!1,g=!0,f||o.call(a)},y=function(E){o.call(a,E)},w=function(){var E;if(c&&!g)return(!a._readableState||!a._readableState.ended)&&(E=new e),o.call(a,E);if(f&&!p)return(!a._writableState||!a._writableState.ended)&&(E=new e),o.call(a,E)},_=function(){a.req.on("finish",x)};return n(a)?(a.on("complete",x),a.on("abort",w),a.req?_():a.on("request",_)):f&&!a._writableState&&(a.on("end",h),a.on("close",h)),a.on("end",v),a.on("finish",x),i.error!==!1&&a.on("error",y),a.on("close",w),function(){a.removeListener("complete",x),a.removeListener("abort",w),a.removeListener("request",_),a.req&&a.req.removeListener("finish",x),a.removeListener("end",h),a.removeListener("close",h),a.removeListener("finish",x),a.removeListener("end",v),a.removeListener("error",y),a.removeListener("close",w)}}return E2=s,E2}var S2,Cj;function Fge(){if(Cj)return S2;Cj=1;var e;function t(_,S,E){return S in _?Object.defineProperty(_,S,{value:E,enumerable:!0,configurable:!0,writable:!0}):_[S]=E,_}var r=jN(),n=Symbol("lastResolve"),s=Symbol("lastReject"),a=Symbol("error"),i=Symbol("ended"),o=Symbol("lastPromise"),c=Symbol("handlePromise"),f=Symbol("stream");function h(_,S){return{value:_,done:S}}function p(_){var S=_[n];if(S!==null){var E=_[f].read();E!==null&&(_[o]=null,_[n]=null,_[s]=null,S(h(E,!1)))}}function x(_){Mt.nextTick(p,_)}function g(_,S){return function(E,N){_.then(function(){if(S[i]){E(h(void 0,!0));return}S[c](E,N)},N)}}var v=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((e={get stream(){return this[f]},next:function(){var S=this,E=this[a];if(E!==null)return Promise.reject(E);if(this[i])return Promise.resolve(h(void 0,!0));if(this[f].destroyed)return new Promise(function(R,V){Mt.nextTick(function(){S[a]?V(S[a]):R(h(void 0,!0))})});var N=this[o],k;if(N)k=new Promise(g(N,this));else{var O=this[f].read();if(O!==null)return Promise.resolve(h(O,!1));k=new Promise(this[c])}return this[o]=k,k}},t(e,Symbol.asyncIterator,function(){return this}),t(e,"return",function(){var S=this;return new Promise(function(E,N){S[f].destroy(null,function(k){if(k){N(k);return}E(h(void 0,!0))})})}),e),v),w=function(S){var E,N=Object.create(y,(E={},t(E,f,{value:S,writable:!0}),t(E,n,{value:null,writable:!0}),t(E,s,{value:null,writable:!0}),t(E,a,{value:null,writable:!0}),t(E,i,{value:S._readableState.endEmitted,writable:!0}),t(E,c,{value:function(O,R){var V=N[f].read();V?(N[o]=null,N[n]=null,N[s]=null,O(h(V,!1))):(N[n]=O,N[s]=R)},writable:!0}),E));return N[o]=null,r(S,function(k){if(k&&k.code!=="ERR_STREAM_PREMATURE_CLOSE"){var O=N[s];O!==null&&(N[o]=null,N[n]=null,N[s]=null,O(k)),N[a]=k;return}var R=N[n];R!==null&&(N[o]=null,N[n]=null,N[s]=null,R(h(void 0,!0))),N[i]=!0}),S.on("readable",x.bind(null,N)),N};return S2=w,S2}var N2,Rj;function Pge(){return Rj||(Rj=1,N2=function(){throw new Error("Readable.from is not available in the browser")}),N2}var T2,jj;function qL(){if(jj)return T2;jj=1,T2=I;var e;I.ReadableState=V,kN().EventEmitter;var t=function(B,be){return B.listeners(be).length},r=RL(),n=$1().Buffer,s=Pi.Uint8Array||function(){};function a(ee){return n.from(ee)}function i(ee){return n.isBuffer(ee)||ee instanceof s}var o=UL(),c;o&&o.debuglog?c=o.debuglog("stream"):c=function(){};var f=Dge(),h=zL(),p=HL(),x=p.getHighWaterMark,g=gd().codes,v=g.ERR_INVALID_ARG_TYPE,y=g.ERR_STREAM_PUSH_AFTER_EOF,w=g.ERR_METHOD_NOT_IMPLEMENTED,_=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,S,E,N;Zl()(I,r);var k=h.errorOrDestroy,O=["error","close","destroy","pause","resume"];function R(ee,B,be){if(typeof ee.prependListener=="function")return ee.prependListener(B,be);!ee._events||!ee._events[B]?ee.on(B,be):Array.isArray(ee._events[B])?ee._events[B].unshift(be):ee._events[B]=[be,ee._events[B]]}function V(ee,B,be){e=e||Wf(),ee=ee||{},typeof be!="boolean"&&(be=B instanceof e),this.objectMode=!!ee.objectMode,be&&(this.objectMode=this.objectMode||!!ee.readableObjectMode),this.highWaterMark=x(this,ee,"readableHighWaterMark",be),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=ee.emitClose!==!1,this.autoDestroy=!!ee.autoDestroy,this.destroyed=!1,this.defaultEncoding=ee.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ee.encoding&&(S||(S=xE().StringDecoder),this.decoder=new S(ee.encoding),this.encoding=ee.encoding)}function I(ee){if(e=e||Wf(),!(this instanceof I))return new I(ee);var B=this instanceof e;this._readableState=new V(ee,this,B),this.readable=!0,ee&&(typeof ee.read=="function"&&(this._read=ee.read),typeof ee.destroy=="function"&&(this._destroy=ee.destroy)),r.call(this)}Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(B){this._readableState&&(this._readableState.destroyed=B)}}),I.prototype.destroy=h.destroy,I.prototype._undestroy=h.undestroy,I.prototype._destroy=function(ee,B){B(ee)},I.prototype.push=function(ee,B){var be=this._readableState,z;return be.objectMode?z=!0:typeof ee=="string"&&(B=B||be.defaultEncoding,B!==be.encoding&&(ee=n.from(ee,B),B=""),z=!0),Z(this,ee,B,!1,z)},I.prototype.unshift=function(ee){return Z(this,ee,null,!0,!1)};function Z(ee,B,be,z,he){c("readableAddChunk",B);var M=ee._readableState;if(B===null)M.reading=!1,te(ee,M);else{var A;if(he||(A=F(M,B)),A)k(ee,A);else if(M.objectMode||B&&B.length>0)if(typeof B!="string"&&!M.objectMode&&Object.getPrototypeOf(B)!==n.prototype&&(B=a(B)),z)M.endEmitted?k(ee,new _):ce(ee,M,B,!0);else if(M.ended)k(ee,new y);else{if(M.destroyed)return!1;M.reading=!1,M.decoder&&!be?(B=M.decoder.write(B),M.objectMode||B.length!==0?ce(ee,M,B,!1):oe(ee,M)):ce(ee,M,B,!1)}else z||(M.reading=!1,oe(ee,M))}return!M.ended&&(M.length<M.highWaterMark||M.length===0)}function ce(ee,B,be,z){B.flowing&&B.length===0&&!B.sync?(B.awaitDrain=0,ee.emit("data",be)):(B.length+=B.objectMode?1:be.length,z?B.buffer.unshift(be):B.buffer.push(be),B.needReadable&&Y(ee)),oe(ee,B)}function F(ee,B){var be;return!i(B)&&typeof B!="string"&&B!==void 0&&!ee.objectMode&&(be=new v("chunk",["string","Buffer","Uint8Array"],B)),be}I.prototype.isPaused=function(){return this._readableState.flowing===!1},I.prototype.setEncoding=function(ee){S||(S=xE().StringDecoder);var B=new S(ee);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var be=this._readableState.buffer.head,z="";be!==null;)z+=B.write(be.data),be=be.next;return this._readableState.buffer.clear(),z!==""&&this._readableState.buffer.push(z),this._readableState.length=z.length,this};var X=1073741824;function P(ee){return ee>=X?ee=X:(ee--,ee|=ee>>>1,ee|=ee>>>2,ee|=ee>>>4,ee|=ee>>>8,ee|=ee>>>16,ee++),ee}function ie(ee,B){return ee<=0||B.length===0&&B.ended?0:B.objectMode?1:ee!==ee?B.flowing&&B.length?B.buffer.head.data.length:B.length:(ee>B.highWaterMark&&(B.highWaterMark=P(ee)),ee<=B.length?ee:B.ended?B.length:(B.needReadable=!0,0))}I.prototype.read=function(ee){c("read",ee),ee=parseInt(ee,10);var B=this._readableState,be=ee;if(ee!==0&&(B.emittedReadable=!1),ee===0&&B.needReadable&&((B.highWaterMark!==0?B.length>=B.highWaterMark:B.length>0)||B.ended))return c("read: emitReadable",B.length,B.ended),B.length===0&&B.ended?L(this):Y(this),null;if(ee=ie(ee,B),ee===0&&B.ended)return B.length===0&&L(this),null;var z=B.needReadable;c("need readable",z),(B.length===0||B.length-ee<B.highWaterMark)&&(z=!0,c("length less than watermark",z)),B.ended||B.reading?(z=!1,c("reading or ended",z)):z&&(c("do read"),B.reading=!0,B.sync=!0,B.length===0&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(ee=ie(be,B)));var he;return ee>0?he=U(ee,B):he=null,he===null?(B.needReadable=B.length<=B.highWaterMark,ee=0):(B.length-=ee,B.awaitDrain=0),B.length===0&&(B.ended||(B.needReadable=!0),be!==ee&&B.ended&&L(this)),he!==null&&this.emit("data",he),he};function te(ee,B){if(c("onEofChunk"),!B.ended){if(B.decoder){var be=B.decoder.end();be&&be.length&&(B.buffer.push(be),B.length+=B.objectMode?1:be.length)}B.ended=!0,B.sync?Y(ee):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,ve(ee)))}}function Y(ee){var B=ee._readableState;c("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(c("emitReadable",B.flowing),B.emittedReadable=!0,Mt.nextTick(ve,ee))}function ve(ee){var B=ee._readableState;c("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(ee.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,re(ee)}function oe(ee,B){B.readingMore||(B.readingMore=!0,Mt.nextTick(Ee,ee,B))}function Ee(ee,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&B.length===0);){var be=B.length;if(c("maybeReadMore read 0"),ee.read(0),be===B.length)break}B.readingMore=!1}I.prototype._read=function(ee){k(this,new w("_read()"))},I.prototype.pipe=function(ee,B){var be=this,z=this._readableState;switch(z.pipesCount){case 0:z.pipes=ee;break;case 1:z.pipes=[z.pipes,ee];break;default:z.pipes.push(ee);break}z.pipesCount+=1,c("pipe count=%d opts=%j",z.pipesCount,B);var he=(!B||B.end!==!1)&&ee!==Mt.stdout&&ee!==Mt.stderr,M=he?j:Ke;z.endEmitted?Mt.nextTick(M):be.once("end",M),ee.on("unpipe",A);function A(st,at){c("onunpipe"),st===be&&at&&at.hasUnpiped===!1&&(at.hasUnpiped=!0,ye())}function j(){c("onend"),ee.end()}var H=K(be);ee.on("drain",H);var ue=!1;function ye(){c("cleanup"),ee.removeListener("close",De),ee.removeListener("finish",Fe),ee.removeListener("drain",H),ee.removeListener("error",Ne),ee.removeListener("unpipe",A),be.removeListener("end",j),be.removeListener("end",Ke),be.removeListener("data",pe),ue=!0,z.awaitDrain&&(!ee._writableState||ee._writableState.needDrain)&&H()}be.on("data",pe);function pe(st){c("ondata");var at=ee.write(st);c("dest.write",at),at===!1&&((z.pipesCount===1&&z.pipes===ee||z.pipesCount>1&&Q(z.pipes,ee)!==-1)&&!ue&&(c("false write response, pause",z.awaitDrain),z.awaitDrain++),be.pause())}function Ne(st){c("onerror",st),Ke(),ee.removeListener("error",Ne),t(ee,"error")===0&&k(ee,st)}R(ee,"error",Ne);function De(){ee.removeListener("finish",Fe),Ke()}ee.once("close",De);function Fe(){c("onfinish"),ee.removeListener("close",De),Ke()}ee.once("finish",Fe);function Ke(){c("unpipe"),be.unpipe(ee)}return ee.emit("pipe",be),z.flowing||(c("pipe resume"),be.resume()),ee};function K(ee){return function(){var be=ee._readableState;c("pipeOnDrain",be.awaitDrain),be.awaitDrain&&be.awaitDrain--,be.awaitDrain===0&&t(ee,"data")&&(be.flowing=!0,re(ee))}}I.prototype.unpipe=function(ee){var B=this._readableState,be={hasUnpiped:!1};if(B.pipesCount===0)return this;if(B.pipesCount===1)return ee&&ee!==B.pipes?this:(ee||(ee=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,ee&&ee.emit("unpipe",this,be),this);if(!ee){var z=B.pipes,he=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var M=0;M<he;M++)z[M].emit("unpipe",this,{hasUnpiped:!1});return this}var A=Q(B.pipes,ee);return A===-1?this:(B.pipes.splice(A,1),B.pipesCount-=1,B.pipesCount===1&&(B.pipes=B.pipes[0]),ee.emit("unpipe",this,be),this)},I.prototype.on=function(ee,B){var be=r.prototype.on.call(this,ee,B),z=this._readableState;return ee==="data"?(z.readableListening=this.listenerCount("readable")>0,z.flowing!==!1&&this.resume()):ee==="readable"&&!z.endEmitted&&!z.readableListening&&(z.readableListening=z.needReadable=!0,z.flowing=!1,z.emittedReadable=!1,c("on readable",z.length,z.reading),z.length?Y(this):z.reading||Mt.nextTick(q,this)),be},I.prototype.addListener=I.prototype.on,I.prototype.removeListener=function(ee,B){var be=r.prototype.removeListener.call(this,ee,B);return ee==="readable"&&Mt.nextTick(D,this),be},I.prototype.removeAllListeners=function(ee){var B=r.prototype.removeAllListeners.apply(this,arguments);return(ee==="readable"||ee===void 0)&&Mt.nextTick(D,this),B};function D(ee){var B=ee._readableState;B.readableListening=ee.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:ee.listenerCount("data")>0&&ee.resume()}function q(ee){c("readable nexttick read 0"),ee.read(0)}I.prototype.resume=function(){var ee=this._readableState;return ee.flowing||(c("resume"),ee.flowing=!ee.readableListening,W(this,ee)),ee.paused=!1,this};function W(ee,B){B.resumeScheduled||(B.resumeScheduled=!0,Mt.nextTick(J,ee,B))}function J(ee,B){c("resume",B.reading),B.reading||ee.read(0),B.resumeScheduled=!1,ee.emit("resume"),re(ee),B.flowing&&!B.reading&&ee.read(0)}I.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function re(ee){var B=ee._readableState;for(c("flow",B.flowing);B.flowing&&ee.read()!==null;);}I.prototype.wrap=function(ee){var B=this,be=this._readableState,z=!1;ee.on("end",function(){if(c("wrapped end"),be.decoder&&!be.ended){var A=be.decoder.end();A&&A.length&&B.push(A)}B.push(null)}),ee.on("data",function(A){if(c("wrapped data"),be.decoder&&(A=be.decoder.write(A)),!(be.objectMode&&A==null)&&!(!be.objectMode&&(!A||!A.length))){var j=B.push(A);j||(z=!0,ee.pause())}});for(var he in ee)this[he]===void 0&&typeof ee[he]=="function"&&(this[he]=(function(j){return function(){return ee[j].apply(ee,arguments)}})(he));for(var M=0;M<O.length;M++)ee.on(O[M],this.emit.bind(this,O[M]));return this._read=function(A){c("wrapped _read",A),z&&(z=!1,ee.resume())},this},typeof Symbol=="function"&&(I.prototype[Symbol.asyncIterator]=function(){return E===void 0&&(E=Fge()),E(this)}),Object.defineProperty(I.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(I.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(I.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),I._fromList=U,Object.defineProperty(I.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function U(ee,B){if(B.length===0)return null;var be;return B.objectMode?be=B.buffer.shift():!ee||ee>=B.length?(B.decoder?be=B.buffer.join(""):B.buffer.length===1?be=B.buffer.first():be=B.buffer.concat(B.length),B.buffer.clear()):be=B.buffer.consume(ee,B.decoder),be}function L(ee){var B=ee._readableState;c("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,Mt.nextTick(se,B,ee))}function se(ee,B){if(c("endReadableNT",ee.endEmitted,ee.length),!ee.endEmitted&&ee.length===0&&(ee.endEmitted=!0,B.readable=!1,B.emit("end"),ee.autoDestroy)){var be=B._writableState;(!be||be.autoDestroy&&be.finished)&&B.destroy()}}typeof Symbol=="function"&&(I.from=function(ee,B){return N===void 0&&(N=Pge()),N(I,ee,B)});function Q(ee,B){for(var be=0,z=ee.length;be<z;be++)if(ee[be]===B)return be;return-1}return T2}var k2,Oj;function WL(){if(Oj)return k2;Oj=1,k2=o;var e=gd().codes,t=e.ERR_METHOD_NOT_IMPLEMENTED,r=e.ERR_MULTIPLE_CALLBACK,n=e.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=e.ERR_TRANSFORM_WITH_LENGTH_0,a=Wf();Zl()(o,a);function i(h,p){var x=this._transformState;x.transforming=!1;var g=x.writecb;if(g===null)return this.emit("error",new r);x.writechunk=null,x.writecb=null,p!=null&&this.push(p),g(h);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function o(h){if(!(this instanceof o))return new o(h);a.call(this,h),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",c)}function c(){var h=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(p,x){f(h,p,x)}):f(this,null,null)}o.prototype.push=function(h,p){return this._transformState.needTransform=!1,a.prototype.push.call(this,h,p)},o.prototype._transform=function(h,p,x){x(new t("_transform()"))},o.prototype._write=function(h,p,x){var g=this._transformState;if(g.writecb=x,g.writechunk=h,g.writeencoding=p,!g.transforming){var v=this._readableState;(g.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},o.prototype._read=function(h){var p=this._transformState;p.writechunk!==null&&!p.transforming?(p.transforming=!0,this._transform(p.writechunk,p.writeencoding,p.afterTransform)):p.needTransform=!0},o.prototype._destroy=function(h,p){a.prototype._destroy.call(this,h,function(x){p(x)})};function f(h,p,x){if(p)return h.emit("error",p);if(x!=null&&h.push(x),h._writableState.length)throw new s;if(h._transformState.transforming)throw new n;return h.push(null)}return k2}var A2,Dj;function Lge(){if(Dj)return A2;Dj=1,A2=t;var e=WL();Zl()(t,e);function t(r){if(!(this instanceof t))return new t(r);e.call(this,r)}return t.prototype._transform=function(r,n,s){s(null,r)},A2}var C2,Ij;function Bge(){if(Ij)return C2;Ij=1;var e;function t(x){var g=!1;return function(){g||(g=!0,x.apply(void 0,arguments))}}var r=gd().codes,n=r.ERR_MISSING_ARGS,s=r.ERR_STREAM_DESTROYED;function a(x){if(x)throw x}function i(x){return x.setHeader&&typeof x.abort=="function"}function o(x,g,v,y){y=t(y);var w=!1;x.on("close",function(){w=!0}),e===void 0&&(e=jN()),e(x,{readable:g,writable:v},function(S){if(S)return y(S);w=!0,y()});var _=!1;return function(S){if(!w&&!_){if(_=!0,i(x))return x.abort();if(typeof x.destroy=="function")return x.destroy();y(S||new s("pipe"))}}}function c(x){x()}function f(x,g){return x.pipe(g)}function h(x){return!x.length||typeof x[x.length-1]!="function"?a:x.pop()}function p(){for(var x=arguments.length,g=new Array(x),v=0;v<x;v++)g[v]=arguments[v];var y=h(g);if(Array.isArray(g[0])&&(g=g[0]),g.length<2)throw new n("streams");var w,_=g.map(function(S,E){var N=E<g.length-1,k=E>0;return o(S,N,k,function(O){w||(w=O),O&&_.forEach(c),!N&&(_.forEach(c),y(w))})});return g.reduce(f)}return C2=p,C2}var R2,Mj;function ON(){if(Mj)return R2;Mj=1,R2=r;var e=kN().EventEmitter,t=Zl();t(r,e),r.Readable=qL(),r.Writable=VL(),r.Duplex=Wf(),r.Transform=WL(),r.PassThrough=Lge(),r.finished=jN(),r.pipeline=Bge(),r.Stream=r;function r(){e.call(this)}return r.prototype.pipe=function(n,s){var a=this;function i(g){n.writable&&n.write(g)===!1&&a.pause&&a.pause()}a.on("data",i);function o(){a.readable&&a.resume&&a.resume()}n.on("drain",o),!n._isStdio&&(!s||s.end!==!1)&&(a.on("end",f),a.on("close",h));var c=!1;function f(){c||(c=!0,n.end())}function h(){c||(c=!0,typeof n.destroy=="function"&&n.destroy())}function p(g){if(x(),e.listenerCount(this,"error")===0)throw g}a.on("error",p),n.on("error",p);function x(){a.removeListener("data",i),n.removeListener("drain",o),a.removeListener("end",f),a.removeListener("close",h),a.removeListener("error",p),n.removeListener("error",p),a.removeListener("end",x),a.removeListener("close",x),n.removeListener("close",x)}return a.on("end",x),a.on("close",x),n.on("close",x),n.emit("pipe",a),n},R2}var Fj;function Uge(){return Fj||(Fj=1,(function(e){(function(t){t.parser=function(U,L){return new n(U,L)},t.SAXParser=n,t.SAXStream=h,t.createStream=f,t.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(U,L){if(!(this instanceof n))return new n(U,L);var se=this;a(se),se.q=se.c="",se.bufferCheckPosition=t.MAX_BUFFER_LENGTH,se.opt=L||{},se.opt.lowercase=se.opt.lowercase||se.opt.lowercasetags,se.looseCase=se.opt.lowercase?"toLowerCase":"toUpperCase",se.tags=[],se.closed=se.closedRoot=se.sawRoot=!1,se.tag=se.error=null,se.strict=!!U,se.noscript=!!(U||se.opt.noscript),se.state=I.BEGIN,se.strictEntities=se.opt.strictEntities,se.ENTITIES=se.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),se.attribList=[],se.opt.xmlns&&(se.ns=Object.create(y)),se.trackPosition=se.opt.position!==!1,se.trackPosition&&(se.position=se.line=se.column=0),ce(se,"onready")}Object.create||(Object.create=function(U){function L(){}L.prototype=U;var se=new L;return se}),Object.keys||(Object.keys=function(U){var L=[];for(var se in U)U.hasOwnProperty(se)&&L.push(se);return L});function s(U){for(var L=Math.max(t.MAX_BUFFER_LENGTH,10),se=0,Q=0,ee=r.length;Q<ee;Q++){var B=U[r[Q]].length;if(B>L)switch(r[Q]){case"textNode":X(U);break;case"cdata":F(U,"oncdata",U.cdata),U.cdata="";break;case"script":F(U,"onscript",U.script),U.script="";break;default:ie(U,"Max buffer length exceeded: "+r[Q])}se=Math.max(se,B)}var be=t.MAX_BUFFER_LENGTH-se;U.bufferCheckPosition=be+U.position}function a(U){for(var L=0,se=r.length;L<se;L++)U[r[L]]=""}function i(U){X(U),U.cdata!==""&&(F(U,"oncdata",U.cdata),U.cdata=""),U.script!==""&&(F(U,"onscript",U.script),U.script="")}n.prototype={end:function(){te(this)},write:re,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){i(this)}};var o;try{o=ON().Stream}catch{o=function(){}}var c=t.EVENTS.filter(function(U){return U!=="error"&&U!=="end"});function f(U,L){return new h(U,L)}function h(U,L){if(!(this instanceof h))return new h(U,L);o.apply(this),this._parser=new n(U,L),this.writable=!0,this.readable=!0;var se=this;this._parser.onend=function(){se.emit("end")},this._parser.onerror=function(Q){se.emit("error",Q),se._parser.error=null},this._decoder=null,c.forEach(function(Q){Object.defineProperty(se,"on"+Q,{get:function(){return se._parser["on"+Q]},set:function(ee){if(!ee)return se.removeAllListeners(Q),se._parser["on"+Q]=ee,ee;se.on(Q,ee)},enumerable:!0,configurable:!1})})}h.prototype=Object.create(o.prototype,{constructor:{value:h}}),h.prototype.write=function(U){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(U)){if(!this._decoder){var L=xE().StringDecoder;this._decoder=new L("utf8")}U=this._decoder.write(U)}return this._parser.write(U.toString()),this.emit("data",U),!0},h.prototype.end=function(U){return U&&U.length&&this.write(U),this._parser.end(),!0},h.prototype.on=function(U,L){var se=this;return!se._parser["on"+U]&&c.indexOf(U)!==-1&&(se._parser["on"+U]=function(){var Q=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);Q.splice(0,0,U),se.emit.apply(se,Q)}),o.prototype.on.call(se,U,L)};var p="[CDATA[",x="DOCTYPE",g="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/2000/xmlns/",y={xml:g,xmlns:v},w=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,S=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,E=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function N(U){return U===" "||U===`
`||U==="\r"||U==="	"}function k(U){return U==='"'||U==="'"}function O(U){return U===">"||N(U)}function R(U,L){return U.test(L)}function V(U,L){return!R(U,L)}var I=0;t.STATE={BEGIN:I++,BEGIN_WHITESPACE:I++,TEXT:I++,TEXT_ENTITY:I++,OPEN_WAKA:I++,SGML_DECL:I++,SGML_DECL_QUOTED:I++,DOCTYPE:I++,DOCTYPE_QUOTED:I++,DOCTYPE_DTD:I++,DOCTYPE_DTD_QUOTED:I++,COMMENT_STARTING:I++,COMMENT:I++,COMMENT_ENDING:I++,COMMENT_ENDED:I++,CDATA:I++,CDATA_ENDING:I++,CDATA_ENDING_2:I++,PROC_INST:I++,PROC_INST_BODY:I++,PROC_INST_ENDING:I++,OPEN_TAG:I++,OPEN_TAG_SLASH:I++,ATTRIB:I++,ATTRIB_NAME:I++,ATTRIB_NAME_SAW_WHITE:I++,ATTRIB_VALUE:I++,ATTRIB_VALUE_QUOTED:I++,ATTRIB_VALUE_CLOSED:I++,ATTRIB_VALUE_UNQUOTED:I++,ATTRIB_VALUE_ENTITY_Q:I++,ATTRIB_VALUE_ENTITY_U:I++,CLOSE_TAG:I++,CLOSE_TAG_SAW_WHITE:I++,SCRIPT:I++,SCRIPT_ENDING:I++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(U){var L=t.ENTITIES[U],se=typeof L=="number"?String.fromCharCode(L):L;t.ENTITIES[U]=se});for(var Z in t.STATE)t.STATE[t.STATE[Z]]=Z;I=t.STATE;function ce(U,L,se){U[L]&&U[L](se)}function F(U,L,se){U.textNode&&X(U),ce(U,L,se)}function X(U){U.textNode=P(U.opt,U.textNode),U.textNode&&ce(U,"ontext",U.textNode),U.textNode=""}function P(U,L){return U.trim&&(L=L.trim()),U.normalize&&(L=L.replace(/\s+/g," ")),L}function ie(U,L){return X(U),U.trackPosition&&(L+=`
Line: `+U.line+`
Column: `+U.column+`
Char: `+U.c),L=new Error(L),U.error=L,ce(U,"onerror",L),U}function te(U){return U.sawRoot&&!U.closedRoot&&Y(U,"Unclosed root tag"),U.state!==I.BEGIN&&U.state!==I.BEGIN_WHITESPACE&&U.state!==I.TEXT&&ie(U,"Unexpected end"),X(U),U.c="",U.closed=!0,ce(U,"onend"),n.call(U,U.strict,U.opt),U}function Y(U,L){if(typeof U!="object"||!(U instanceof n))throw new Error("bad call to strictFail");U.strict&&ie(U,L)}function ve(U){U.strict||(U.tagName=U.tagName[U.looseCase]());var L=U.tags[U.tags.length-1]||U,se=U.tag={name:U.tagName,attributes:{}};U.opt.xmlns&&(se.ns=L.ns),U.attribList.length=0,F(U,"onopentagstart",se)}function oe(U,L){var se=U.indexOf(":"),Q=se<0?["",U]:U.split(":"),ee=Q[0],B=Q[1];return L&&U==="xmlns"&&(ee="xmlns",B=""),{prefix:ee,local:B}}function Ee(U){if(U.strict||(U.attribName=U.attribName[U.looseCase]()),U.attribList.indexOf(U.attribName)!==-1||U.tag.attributes.hasOwnProperty(U.attribName)){U.attribName=U.attribValue="";return}if(U.opt.xmlns){var L=oe(U.attribName,!0),se=L.prefix,Q=L.local;if(se==="xmlns")if(Q==="xml"&&U.attribValue!==g)Y(U,"xml: prefix must be bound to "+g+`
Actual: `+U.attribValue);else if(Q==="xmlns"&&U.attribValue!==v)Y(U,"xmlns: prefix must be bound to "+v+`
Actual: `+U.attribValue);else{var ee=U.tag,B=U.tags[U.tags.length-1]||U;ee.ns===B.ns&&(ee.ns=Object.create(B.ns)),ee.ns[Q]=U.attribValue}U.attribList.push([U.attribName,U.attribValue])}else U.tag.attributes[U.attribName]=U.attribValue,F(U,"onattribute",{name:U.attribName,value:U.attribValue});U.attribName=U.attribValue=""}function K(U,L){if(U.opt.xmlns){var se=U.tag,Q=oe(U.tagName);se.prefix=Q.prefix,se.local=Q.local,se.uri=se.ns[Q.prefix]||"",se.prefix&&!se.uri&&(Y(U,"Unbound namespace prefix: "+JSON.stringify(U.tagName)),se.uri=Q.prefix);var ee=U.tags[U.tags.length-1]||U;se.ns&&ee.ns!==se.ns&&Object.keys(se.ns).forEach(function(pe){F(U,"onopennamespace",{prefix:pe,uri:se.ns[pe]})});for(var B=0,be=U.attribList.length;B<be;B++){var z=U.attribList[B],he=z[0],M=z[1],A=oe(he,!0),j=A.prefix,H=A.local,ue=j===""?"":se.ns[j]||"",ye={name:he,value:M,prefix:j,local:H,uri:ue};j&&j!=="xmlns"&&!ue&&(Y(U,"Unbound namespace prefix: "+JSON.stringify(j)),ye.uri=j),U.tag.attributes[he]=ye,F(U,"onattribute",ye)}U.attribList.length=0}U.tag.isSelfClosing=!!L,U.sawRoot=!0,U.tags.push(U.tag),F(U,"onopentag",U.tag),L||(!U.noscript&&U.tagName.toLowerCase()==="script"?U.state=I.SCRIPT:U.state=I.TEXT,U.tag=null,U.tagName=""),U.attribName=U.attribValue="",U.attribList.length=0}function D(U){if(!U.tagName){Y(U,"Weird empty close tag."),U.textNode+="</>",U.state=I.TEXT;return}if(U.script){if(U.tagName!=="script"){U.script+="</"+U.tagName+">",U.tagName="",U.state=I.SCRIPT;return}F(U,"onscript",U.script),U.script=""}var L=U.tags.length,se=U.tagName;U.strict||(se=se[U.looseCase]());for(var Q=se;L--;){var ee=U.tags[L];if(ee.name!==Q)Y(U,"Unexpected close tag");else break}if(L<0){Y(U,"Unmatched closing tag: "+U.tagName),U.textNode+="</"+U.tagName+">",U.state=I.TEXT;return}U.tagName=se;for(var B=U.tags.length;B-- >L;){var be=U.tag=U.tags.pop();U.tagName=U.tag.name,F(U,"onclosetag",U.tagName);var z={};for(var he in be.ns)z[he]=be.ns[he];var M=U.tags[U.tags.length-1]||U;U.opt.xmlns&&be.ns!==M.ns&&Object.keys(be.ns).forEach(function(A){var j=be.ns[A];F(U,"onclosenamespace",{prefix:A,uri:j})})}L===0&&(U.closedRoot=!0),U.tagName=U.attribValue=U.attribName="",U.attribList.length=0,U.state=I.TEXT}function q(U){var L=U.entity,se=L.toLowerCase(),Q,ee="";return U.ENTITIES[L]?U.ENTITIES[L]:U.ENTITIES[se]?U.ENTITIES[se]:(L=se,L.charAt(0)==="#"&&(L.charAt(1)==="x"?(L=L.slice(2),Q=parseInt(L,16),ee=Q.toString(16)):(L=L.slice(1),Q=parseInt(L,10),ee=Q.toString(10))),L=L.replace(/^0+/,""),isNaN(Q)||ee.toLowerCase()!==L?(Y(U,"Invalid character entity"),"&"+U.entity+";"):String.fromCodePoint(Q))}function W(U,L){L==="<"?(U.state=I.OPEN_WAKA,U.startTagPosition=U.position):N(L)||(Y(U,"Non-whitespace before first tag."),U.textNode=L,U.state=I.TEXT)}function J(U,L){var se="";return L<U.length&&(se=U.charAt(L)),se}function re(U){var L=this;if(this.error)throw this.error;if(L.closed)return ie(L,"Cannot write after close. Assign an onready handler.");if(U===null)return te(L);typeof U=="object"&&(U=U.toString());for(var se=0,Q="";Q=J(U,se++),L.c=Q,!!Q;)switch(L.trackPosition&&(L.position++,Q===`
`?(L.line++,L.column=0):L.column++),L.state){case I.BEGIN:if(L.state=I.BEGIN_WHITESPACE,Q==="\uFEFF")continue;W(L,Q);continue;case I.BEGIN_WHITESPACE:W(L,Q);continue;case I.TEXT:if(L.sawRoot&&!L.closedRoot){for(var ee=se-1;Q&&Q!=="<"&&Q!=="&";)Q=J(U,se++),Q&&L.trackPosition&&(L.position++,Q===`
`?(L.line++,L.column=0):L.column++);L.textNode+=U.substring(ee,se-1)}Q==="<"&&!(L.sawRoot&&L.closedRoot&&!L.strict)?(L.state=I.OPEN_WAKA,L.startTagPosition=L.position):(!N(Q)&&(!L.sawRoot||L.closedRoot)&&Y(L,"Text data outside of root node."),Q==="&"?L.state=I.TEXT_ENTITY:L.textNode+=Q);continue;case I.SCRIPT:Q==="<"?L.state=I.SCRIPT_ENDING:L.script+=Q;continue;case I.SCRIPT_ENDING:Q==="/"?L.state=I.CLOSE_TAG:(L.script+="<"+Q,L.state=I.SCRIPT);continue;case I.OPEN_WAKA:if(Q==="!")L.state=I.SGML_DECL,L.sgmlDecl="";else if(!N(Q))if(R(w,Q))L.state=I.OPEN_TAG,L.tagName=Q;else if(Q==="/")L.state=I.CLOSE_TAG,L.tagName="";else if(Q==="?")L.state=I.PROC_INST,L.procInstName=L.procInstBody="";else{if(Y(L,"Unencoded <"),L.startTagPosition+1<L.position){var B=L.position-L.startTagPosition;Q=new Array(B).join(" ")+Q}L.textNode+="<"+Q,L.state=I.TEXT}continue;case I.SGML_DECL:(L.sgmlDecl+Q).toUpperCase()===p?(F(L,"onopencdata"),L.state=I.CDATA,L.sgmlDecl="",L.cdata=""):L.sgmlDecl+Q==="--"?(L.state=I.COMMENT,L.comment="",L.sgmlDecl=""):(L.sgmlDecl+Q).toUpperCase()===x?(L.state=I.DOCTYPE,(L.doctype||L.sawRoot)&&Y(L,"Inappropriately located doctype declaration"),L.doctype="",L.sgmlDecl=""):Q===">"?(F(L,"onsgmldeclaration",L.sgmlDecl),L.sgmlDecl="",L.state=I.TEXT):(k(Q)&&(L.state=I.SGML_DECL_QUOTED),L.sgmlDecl+=Q);continue;case I.SGML_DECL_QUOTED:Q===L.q&&(L.state=I.SGML_DECL,L.q=""),L.sgmlDecl+=Q;continue;case I.DOCTYPE:Q===">"?(L.state=I.TEXT,F(L,"ondoctype",L.doctype),L.doctype=!0):(L.doctype+=Q,Q==="["?L.state=I.DOCTYPE_DTD:k(Q)&&(L.state=I.DOCTYPE_QUOTED,L.q=Q));continue;case I.DOCTYPE_QUOTED:L.doctype+=Q,Q===L.q&&(L.q="",L.state=I.DOCTYPE);continue;case I.DOCTYPE_DTD:L.doctype+=Q,Q==="]"?L.state=I.DOCTYPE:k(Q)&&(L.state=I.DOCTYPE_DTD_QUOTED,L.q=Q);continue;case I.DOCTYPE_DTD_QUOTED:L.doctype+=Q,Q===L.q&&(L.state=I.DOCTYPE_DTD,L.q="");continue;case I.COMMENT:Q==="-"?L.state=I.COMMENT_ENDING:L.comment+=Q;continue;case I.COMMENT_ENDING:Q==="-"?(L.state=I.COMMENT_ENDED,L.comment=P(L.opt,L.comment),L.comment&&F(L,"oncomment",L.comment),L.comment=""):(L.comment+="-"+Q,L.state=I.COMMENT);continue;case I.COMMENT_ENDED:Q!==">"?(Y(L,"Malformed comment"),L.comment+="--"+Q,L.state=I.COMMENT):L.state=I.TEXT;continue;case I.CDATA:Q==="]"?L.state=I.CDATA_ENDING:L.cdata+=Q;continue;case I.CDATA_ENDING:Q==="]"?L.state=I.CDATA_ENDING_2:(L.cdata+="]"+Q,L.state=I.CDATA);continue;case I.CDATA_ENDING_2:Q===">"?(L.cdata&&F(L,"oncdata",L.cdata),F(L,"onclosecdata"),L.cdata="",L.state=I.TEXT):Q==="]"?L.cdata+="]":(L.cdata+="]]"+Q,L.state=I.CDATA);continue;case I.PROC_INST:Q==="?"?L.state=I.PROC_INST_ENDING:N(Q)?L.state=I.PROC_INST_BODY:L.procInstName+=Q;continue;case I.PROC_INST_BODY:if(!L.procInstBody&&N(Q))continue;Q==="?"?L.state=I.PROC_INST_ENDING:L.procInstBody+=Q;continue;case I.PROC_INST_ENDING:Q===">"?(F(L,"onprocessinginstruction",{name:L.procInstName,body:L.procInstBody}),L.procInstName=L.procInstBody="",L.state=I.TEXT):(L.procInstBody+="?"+Q,L.state=I.PROC_INST_BODY);continue;case I.OPEN_TAG:R(_,Q)?L.tagName+=Q:(ve(L),Q===">"?K(L):Q==="/"?L.state=I.OPEN_TAG_SLASH:(N(Q)||Y(L,"Invalid character in tag name"),L.state=I.ATTRIB));continue;case I.OPEN_TAG_SLASH:Q===">"?(K(L,!0),D(L)):(Y(L,"Forward-slash in opening tag not followed by >"),L.state=I.ATTRIB);continue;case I.ATTRIB:if(N(Q))continue;Q===">"?K(L):Q==="/"?L.state=I.OPEN_TAG_SLASH:R(w,Q)?(L.attribName=Q,L.attribValue="",L.state=I.ATTRIB_NAME):Y(L,"Invalid attribute name");continue;case I.ATTRIB_NAME:Q==="="?L.state=I.ATTRIB_VALUE:Q===">"?(Y(L,"Attribute without value"),L.attribValue=L.attribName,Ee(L),K(L)):N(Q)?L.state=I.ATTRIB_NAME_SAW_WHITE:R(_,Q)?L.attribName+=Q:Y(L,"Invalid attribute name");continue;case I.ATTRIB_NAME_SAW_WHITE:if(Q==="=")L.state=I.ATTRIB_VALUE;else{if(N(Q))continue;Y(L,"Attribute without value"),L.tag.attributes[L.attribName]="",L.attribValue="",F(L,"onattribute",{name:L.attribName,value:""}),L.attribName="",Q===">"?K(L):R(w,Q)?(L.attribName=Q,L.state=I.ATTRIB_NAME):(Y(L,"Invalid attribute name"),L.state=I.ATTRIB)}continue;case I.ATTRIB_VALUE:if(N(Q))continue;k(Q)?(L.q=Q,L.state=I.ATTRIB_VALUE_QUOTED):(Y(L,"Unquoted attribute value"),L.state=I.ATTRIB_VALUE_UNQUOTED,L.attribValue=Q);continue;case I.ATTRIB_VALUE_QUOTED:if(Q!==L.q){Q==="&"?L.state=I.ATTRIB_VALUE_ENTITY_Q:L.attribValue+=Q;continue}Ee(L),L.q="",L.state=I.ATTRIB_VALUE_CLOSED;continue;case I.ATTRIB_VALUE_CLOSED:N(Q)?L.state=I.ATTRIB:Q===">"?K(L):Q==="/"?L.state=I.OPEN_TAG_SLASH:R(w,Q)?(Y(L,"No whitespace between attributes"),L.attribName=Q,L.attribValue="",L.state=I.ATTRIB_NAME):Y(L,"Invalid attribute name");continue;case I.ATTRIB_VALUE_UNQUOTED:if(!O(Q)){Q==="&"?L.state=I.ATTRIB_VALUE_ENTITY_U:L.attribValue+=Q;continue}Ee(L),Q===">"?K(L):L.state=I.ATTRIB;continue;case I.CLOSE_TAG:if(L.tagName)Q===">"?D(L):R(_,Q)?L.tagName+=Q:L.script?(L.script+="</"+L.tagName,L.tagName="",L.state=I.SCRIPT):(N(Q)||Y(L,"Invalid tagname in closing tag"),L.state=I.CLOSE_TAG_SAW_WHITE);else{if(N(Q))continue;V(w,Q)?L.script?(L.script+="</"+Q,L.state=I.SCRIPT):Y(L,"Invalid tagname in closing tag."):L.tagName=Q}continue;case I.CLOSE_TAG_SAW_WHITE:if(N(Q))continue;Q===">"?D(L):Y(L,"Invalid characters in closing tag");continue;case I.TEXT_ENTITY:case I.ATTRIB_VALUE_ENTITY_Q:case I.ATTRIB_VALUE_ENTITY_U:var be,z;switch(L.state){case I.TEXT_ENTITY:be=I.TEXT,z="textNode";break;case I.ATTRIB_VALUE_ENTITY_Q:be=I.ATTRIB_VALUE_QUOTED,z="attribValue";break;case I.ATTRIB_VALUE_ENTITY_U:be=I.ATTRIB_VALUE_UNQUOTED,z="attribValue";break}Q===";"?(L[z]+=q(L),L.entity="",L.state=be):R(L.entity.length?E:S,Q)?L.entity+=Q:(Y(L,"Invalid character in entity name"),L[z]+="&"+L.entity+Q,L.entity="",L.state=be);continue;default:throw new Error(L,"Unknown state: "+L.state)}return L.position>=L.bufferCheckPosition&&s(L),L}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||(function(){var U=String.fromCharCode,L=Math.floor,se=function(){var Q=16384,ee=[],B,be,z=-1,he=arguments.length;if(!he)return"";for(var M="";++z<he;){var A=Number(arguments[z]);if(!isFinite(A)||A<0||A>1114111||L(A)!==A)throw RangeError("Invalid code point: "+A);A<=65535?ee.push(A):(A-=65536,B=(A>>10)+55296,be=A%1024+56320,ee.push(B,be)),(z+1===he||ee.length>Q)&&(M+=U.apply(null,ee),ee.length=0)}return M};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:se,configurable:!0,writable:!0}):String.fromCodePoint=se})()})(e)})(mw)),mw}var j2,Pj;function DN(){return Pj||(Pj=1,j2={isArray:function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)==="[object Array]"}}),j2}var O2,Lj;function IN(){if(Lj)return O2;Lj=1;var e=DN().isArray;return O2={copyOptions:function(t){var r,n={};for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n},ensureFlagExists:function(t,r){(!(t in r)||typeof r[t]!="boolean")&&(r[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||typeof t.spaces!="number"&&typeof t.spaces!="string")&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){(!("alwaysArray"in t)||typeof t.alwaysArray!="boolean"&&!e(t.alwaysArray))&&(t.alwaysArray=!1)},ensureKeyExists:function(t,r){(!(t+"Key"in r)||typeof r[t+"Key"]!="string")&&(r[t+"Key"]=r.compact?"_"+t:t)},checkFnExists:function(t,r){return t+"Fn"in r}},O2}var D2,Bj;function $L(){if(Bj)return D2;Bj=1;var e=Uge(),t=IN(),r=DN().isArray,n,s;function a(_){return n=t.copyOptions(_),t.ensureFlagExists("ignoreDeclaration",n),t.ensureFlagExists("ignoreInstruction",n),t.ensureFlagExists("ignoreAttributes",n),t.ensureFlagExists("ignoreText",n),t.ensureFlagExists("ignoreComment",n),t.ensureFlagExists("ignoreCdata",n),t.ensureFlagExists("ignoreDoctype",n),t.ensureFlagExists("compact",n),t.ensureFlagExists("alwaysChildren",n),t.ensureFlagExists("addParent",n),t.ensureFlagExists("trim",n),t.ensureFlagExists("nativeType",n),t.ensureFlagExists("nativeTypeAttributes",n),t.ensureFlagExists("sanitize",n),t.ensureFlagExists("instructionHasAttributes",n),t.ensureFlagExists("captureSpacesBetweenElements",n),t.ensureAlwaysArrayExists(n),t.ensureKeyExists("declaration",n),t.ensureKeyExists("instruction",n),t.ensureKeyExists("attributes",n),t.ensureKeyExists("text",n),t.ensureKeyExists("comment",n),t.ensureKeyExists("cdata",n),t.ensureKeyExists("doctype",n),t.ensureKeyExists("type",n),t.ensureKeyExists("name",n),t.ensureKeyExists("elements",n),t.ensureKeyExists("parent",n),t.checkFnExists("doctype",n),t.checkFnExists("instruction",n),t.checkFnExists("cdata",n),t.checkFnExists("comment",n),t.checkFnExists("text",n),t.checkFnExists("instructionName",n),t.checkFnExists("elementName",n),t.checkFnExists("attributeName",n),t.checkFnExists("attributeValue",n),t.checkFnExists("attributes",n),n}function i(_){var S=Number(_);if(!isNaN(S))return S;var E=_.toLowerCase();return E==="true"?!0:E==="false"?!1:_}function o(_,S){var E;if(n.compact){if(!s[n[_+"Key"]]&&(r(n.alwaysArray)?n.alwaysArray.indexOf(n[_+"Key"])!==-1:n.alwaysArray)&&(s[n[_+"Key"]]=[]),s[n[_+"Key"]]&&!r(s[n[_+"Key"]])&&(s[n[_+"Key"]]=[s[n[_+"Key"]]]),_+"Fn"in n&&typeof S=="string"&&(S=n[_+"Fn"](S,s)),_==="instruction"&&("instructionFn"in n||"instructionNameFn"in n)){for(E in S)if(S.hasOwnProperty(E))if("instructionFn"in n)S[E]=n.instructionFn(S[E],E,s);else{var N=S[E];delete S[E],S[n.instructionNameFn(E,N,s)]=N}}r(s[n[_+"Key"]])?s[n[_+"Key"]].push(S):s[n[_+"Key"]]=S}else{s[n.elementsKey]||(s[n.elementsKey]=[]);var k={};if(k[n.typeKey]=_,_==="instruction"){for(E in S)if(S.hasOwnProperty(E))break;k[n.nameKey]="instructionNameFn"in n?n.instructionNameFn(E,S,s):E,n.instructionHasAttributes?(k[n.attributesKey]=S[E][n.attributesKey],"instructionFn"in n&&(k[n.attributesKey]=n.instructionFn(k[n.attributesKey],E,s))):("instructionFn"in n&&(S[E]=n.instructionFn(S[E],E,s)),k[n.instructionKey]=S[E])}else _+"Fn"in n&&(S=n[_+"Fn"](S,s)),k[n[_+"Key"]]=S;n.addParent&&(k[n.parentKey]=s),s[n.elementsKey].push(k)}}function c(_){if("attributesFn"in n&&_&&(_=n.attributesFn(_,s)),(n.trim||"attributeValueFn"in n||"attributeNameFn"in n||n.nativeTypeAttributes)&&_){var S;for(S in _)if(_.hasOwnProperty(S)&&(n.trim&&(_[S]=_[S].trim()),n.nativeTypeAttributes&&(_[S]=i(_[S])),"attributeValueFn"in n&&(_[S]=n.attributeValueFn(_[S],S,s)),"attributeNameFn"in n)){var E=_[S];delete _[S],_[n.attributeNameFn(S,_[S],s)]=E}}return _}function f(_){var S={};if(_.body&&(_.name.toLowerCase()==="xml"||n.instructionHasAttributes)){for(var E=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,N;(N=E.exec(_.body))!==null;)S[N[1]]=N[2]||N[3]||N[4];S=c(S)}if(_.name.toLowerCase()==="xml"){if(n.ignoreDeclaration)return;s[n.declarationKey]={},Object.keys(S).length&&(s[n.declarationKey][n.attributesKey]=S),n.addParent&&(s[n.declarationKey][n.parentKey]=s)}else{if(n.ignoreInstruction)return;n.trim&&(_.body=_.body.trim());var k={};n.instructionHasAttributes&&Object.keys(S).length?(k[_.name]={},k[_.name][n.attributesKey]=S):k[_.name]=_.body,o("instruction",k)}}function h(_,S){var E;if(typeof _=="object"&&(S=_.attributes,_=_.name),S=c(S),"elementNameFn"in n&&(_=n.elementNameFn(_,s)),n.compact){if(E={},!n.ignoreAttributes&&S&&Object.keys(S).length){E[n.attributesKey]={};var N;for(N in S)S.hasOwnProperty(N)&&(E[n.attributesKey][N]=S[N])}!(_ in s)&&(r(n.alwaysArray)?n.alwaysArray.indexOf(_)!==-1:n.alwaysArray)&&(s[_]=[]),s[_]&&!r(s[_])&&(s[_]=[s[_]]),r(s[_])?s[_].push(E):s[_]=E}else s[n.elementsKey]||(s[n.elementsKey]=[]),E={},E[n.typeKey]="element",E[n.nameKey]=_,!n.ignoreAttributes&&S&&Object.keys(S).length&&(E[n.attributesKey]=S),n.alwaysChildren&&(E[n.elementsKey]=[]),s[n.elementsKey].push(E);E[n.parentKey]=s,s=E}function p(_){n.ignoreText||!_.trim()&&!n.captureSpacesBetweenElements||(n.trim&&(_=_.trim()),n.nativeType&&(_=i(_)),n.sanitize&&(_=_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),o("text",_))}function x(_){n.ignoreComment||(n.trim&&(_=_.trim()),o("comment",_))}function g(_){var S=s[n.parentKey];n.addParent||delete s[n.parentKey],s=S}function v(_){n.ignoreCdata||(n.trim&&(_=_.trim()),o("cdata",_))}function y(_){n.ignoreDoctype||(_=_.replace(/^ /,""),n.trim&&(_=_.trim()),o("doctype",_))}function w(_){_.note=_}return D2=function(_,S){var E=e.parser(!0,{}),N={};if(s=N,n=a(S),E.opt={strictEntities:!0},E.onopentag=h,E.ontext=p,E.oncomment=x,E.onclosetag=g,E.onerror=w,E.oncdata=v,E.ondoctype=y,E.onprocessinginstruction=f,E.write(_).close(),N[n.elementsKey]){var k=N[n.elementsKey];delete N[n.elementsKey],N[n.elementsKey]=k,delete N.text}return N},D2}var I2,Uj;function zge(){if(Uj)return I2;Uj=1;var e=IN(),t=$L();function r(n){var s=e.copyOptions(n);return e.ensureSpacesExists(s),s}return I2=function(n,s){var a,i,o,c;return a=r(s),i=t(n,a),c="compact"in a&&a.compact?"_parent":"parent","addParent"in a&&a.addParent?o=JSON.stringify(i,function(f,h){return f===c?"_":h},a.spaces):o=JSON.stringify(i,null,a.spaces),o.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},I2}var M2,zj;function GL(){if(zj)return M2;zj=1;var e=IN(),t=DN().isArray,r,n;function s(E){var N=e.copyOptions(E);return e.ensureFlagExists("ignoreDeclaration",N),e.ensureFlagExists("ignoreInstruction",N),e.ensureFlagExists("ignoreAttributes",N),e.ensureFlagExists("ignoreText",N),e.ensureFlagExists("ignoreComment",N),e.ensureFlagExists("ignoreCdata",N),e.ensureFlagExists("ignoreDoctype",N),e.ensureFlagExists("compact",N),e.ensureFlagExists("indentText",N),e.ensureFlagExists("indentCdata",N),e.ensureFlagExists("indentAttributes",N),e.ensureFlagExists("indentInstruction",N),e.ensureFlagExists("fullTagEmptyElement",N),e.ensureFlagExists("noQuotesForNativeAttributes",N),e.ensureSpacesExists(N),typeof N.spaces=="number"&&(N.spaces=Array(N.spaces+1).join(" ")),e.ensureKeyExists("declaration",N),e.ensureKeyExists("instruction",N),e.ensureKeyExists("attributes",N),e.ensureKeyExists("text",N),e.ensureKeyExists("comment",N),e.ensureKeyExists("cdata",N),e.ensureKeyExists("doctype",N),e.ensureKeyExists("type",N),e.ensureKeyExists("name",N),e.ensureKeyExists("elements",N),e.checkFnExists("doctype",N),e.checkFnExists("instruction",N),e.checkFnExists("cdata",N),e.checkFnExists("comment",N),e.checkFnExists("text",N),e.checkFnExists("instructionName",N),e.checkFnExists("elementName",N),e.checkFnExists("attributeName",N),e.checkFnExists("attributeValue",N),e.checkFnExists("attributes",N),e.checkFnExists("fullTagEmptyElement",N),N}function a(E,N,k){return(!k&&E.spaces?`
`:"")+Array(N+1).join(E.spaces)}function i(E,N,k){if(N.ignoreAttributes)return"";"attributesFn"in N&&(E=N.attributesFn(E,n,r));var O,R,V,I,Z=[];for(O in E)E.hasOwnProperty(O)&&E[O]!==null&&E[O]!==void 0&&(I=N.noQuotesForNativeAttributes&&typeof E[O]!="string"?"":'"',R=""+E[O],R=R.replace(/"/g,"&quot;"),V="attributeNameFn"in N?N.attributeNameFn(O,R,n,r):O,Z.push(N.spaces&&N.indentAttributes?a(N,k+1,!1):" "),Z.push(V+"="+I+("attributeValueFn"in N?N.attributeValueFn(R,O,n,r):R)+I));return E&&Object.keys(E).length&&N.spaces&&N.indentAttributes&&Z.push(a(N,k,!1)),Z.join("")}function o(E,N,k){return r=E,n="xml",N.ignoreDeclaration?"":"<?xml"+i(E[N.attributesKey],N,k)+"?>"}function c(E,N,k){if(N.ignoreInstruction)return"";var O;for(O in E)if(E.hasOwnProperty(O))break;var R="instructionNameFn"in N?N.instructionNameFn(O,E[O],n,r):O;if(typeof E[O]=="object")return r=E,n=R,"<?"+R+i(E[O][N.attributesKey],N,k)+"?>";var V=E[O]?E[O]:"";return"instructionFn"in N&&(V=N.instructionFn(V,O,n,r)),"<?"+R+(V?" "+V:"")+"?>"}function f(E,N){return N.ignoreComment?"":"<!--"+("commentFn"in N?N.commentFn(E,n,r):E)+"-->"}function h(E,N){return N.ignoreCdata?"":"<![CDATA["+("cdataFn"in N?N.cdataFn(E,n,r):E.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function p(E,N){return N.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in N?N.doctypeFn(E,n,r):E)+">"}function x(E,N){return N.ignoreText?"":(E=""+E,E=E.replace(/&amp;/g,"&"),E=E.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in N?N.textFn(E,n,r):E)}function g(E,N){var k;if(E.elements&&E.elements.length)for(k=0;k<E.elements.length;++k)switch(E.elements[k][N.typeKey]){case"text":if(N.indentText)return!0;break;case"cdata":if(N.indentCdata)return!0;break;case"instruction":if(N.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function v(E,N,k){r=E,n=E.name;var O=[],R="elementNameFn"in N?N.elementNameFn(E.name,E):E.name;O.push("<"+R),E[N.attributesKey]&&O.push(i(E[N.attributesKey],N,k));var V=E[N.elementsKey]&&E[N.elementsKey].length||E[N.attributesKey]&&E[N.attributesKey]["xml:space"]==="preserve";return V||("fullTagEmptyElementFn"in N?V=N.fullTagEmptyElementFn(E.name,E):V=N.fullTagEmptyElement),V?(O.push(">"),E[N.elementsKey]&&E[N.elementsKey].length&&(O.push(y(E[N.elementsKey],N,k+1)),r=E,n=E.name),O.push(N.spaces&&g(E,N)?`
`+Array(k+1).join(N.spaces):""),O.push("</"+R+">")):O.push("/>"),O.join("")}function y(E,N,k,O){return E.reduce(function(R,V){var I=a(N,k,O&&!R);switch(V.type){case"element":return R+I+v(V,N,k);case"comment":return R+I+f(V[N.commentKey],N);case"doctype":return R+I+p(V[N.doctypeKey],N);case"cdata":return R+(N.indentCdata?I:"")+h(V[N.cdataKey],N);case"text":return R+(N.indentText?I:"")+x(V[N.textKey],N);case"instruction":var Z={};return Z[V[N.nameKey]]=V[N.attributesKey]?V:V[N.instructionKey],R+(N.indentInstruction?I:"")+c(Z,N,k)}},"")}function w(E,N,k){var O;for(O in E)if(E.hasOwnProperty(O))switch(O){case N.parentKey:case N.attributesKey:break;case N.textKey:if(N.indentText||k)return!0;break;case N.cdataKey:if(N.indentCdata||k)return!0;break;case N.instructionKey:if(N.indentInstruction||k)return!0;break;case N.doctypeKey:case N.commentKey:return!0;default:return!0}return!1}function _(E,N,k,O,R){r=E,n=N;var V="elementNameFn"in k?k.elementNameFn(N,E):N;if(typeof E>"u"||E===null||E==="")return"fullTagEmptyElementFn"in k&&k.fullTagEmptyElementFn(N,E)||k.fullTagEmptyElement?"<"+V+"></"+V+">":"<"+V+"/>";var I=[];if(N){if(I.push("<"+V),typeof E!="object")return I.push(">"+x(E,k)+"</"+V+">"),I.join("");E[k.attributesKey]&&I.push(i(E[k.attributesKey],k,O));var Z=w(E,k,!0)||E[k.attributesKey]&&E[k.attributesKey]["xml:space"]==="preserve";if(Z||("fullTagEmptyElementFn"in k?Z=k.fullTagEmptyElementFn(N,E):Z=k.fullTagEmptyElement),Z)I.push(">");else return I.push("/>"),I.join("")}return I.push(S(E,k,O+1,!1)),r=E,n=N,N&&I.push((R?a(k,O,!1):"")+"</"+V+">"),I.join("")}function S(E,N,k,O){var R,V,I,Z=[];for(V in E)if(E.hasOwnProperty(V))for(I=t(E[V])?E[V]:[E[V]],R=0;R<I.length;++R){switch(V){case N.declarationKey:Z.push(o(I[R],N,k));break;case N.instructionKey:Z.push((N.indentInstruction?a(N,k,O):"")+c(I[R],N,k));break;case N.attributesKey:case N.parentKey:break;case N.textKey:Z.push((N.indentText?a(N,k,O):"")+x(I[R],N));break;case N.cdataKey:Z.push((N.indentCdata?a(N,k,O):"")+h(I[R],N));break;case N.doctypeKey:Z.push(a(N,k,O)+p(I[R],N));break;case N.commentKey:Z.push(a(N,k,O)+f(I[R],N));break;default:Z.push(a(N,k,O)+_(I[R],V,N,k,w(I[R],N)))}O=O&&!Z.length}return Z.join("")}return M2=function(E,N){N=s(N);var k=[];return r=E,n="_root_",N.compact?k.push(S(E,N,0,!0)):(E[N.declarationKey]&&k.push(o(E[N.declarationKey],N,0)),E[N.elementsKey]&&E[N.elementsKey].length&&k.push(y(E[N.elementsKey],N,0,!k.length))),k.join("")},M2}var F2,Hj;function Hge(){if(Hj)return F2;Hj=1;var e=GL();return F2=function(t,r){t instanceof Buffer&&(t=t.toString());var n=null;if(typeof t=="string")try{n=JSON.parse(t)}catch{throw new Error("The JSON structure is invalid")}else n=t;return e(n,r)},F2}var P2,Vj;function Vge(){if(Vj)return P2;Vj=1;var e=$L(),t=zge(),r=GL(),n=Hge();return P2={xml2js:e,xml2json:t,js2xml:r,json2xml:n},P2}var KL=Vge();const MN=e=>{switch(e.type){case void 0:case"element":const t=new Wge(e.name,e.attributes),r=e.elements||[];for(const n of r){const s=MN(n);s!==void 0&&t.push(s)}return t;case"text":return e.text;default:return}};class qge extends ut{}class Wge extends Be{static fromXmlString(t){const r=KL.xml2js(t,{compact:!1});return MN(r)}constructor(t,r){super(t),r&&this.root.push(new qge(r))}push(t){this.root.push(t)}}class $ge extends Be{constructor(t){super(""),this._attr=t}prepForXml(t){return{_attr:this._attr}}}class XL extends Be{constructor(t,r){super(t),r&&(this.root=r.root)}}const qs=e=>{if(isNaN(e))throw new Error(`Invalid value '${e}' specified. Must be an integer.`);return Math.floor(e)},K1=e=>{const t=qs(e);if(t<0)throw new Error(`Invalid value '${e}' specified. Must be a positive integer.`);return t},YL=(e,t)=>{const r=t*2;if(e.length!==r||isNaN(+`0x${e}`))throw new Error(`Invalid hex value '${e}'. Expected ${r} digit hex value`);return e},qj=e=>YL(e,1),JL=e=>{const t=e.slice(-2),r=e.substring(0,e.length-2);return`${Number(r)}${t}`},ZL=e=>{const t=JL(e);if(parseFloat(t)<0)throw new Error(`Invalid value '${t}' specified. Expected a positive number.`);return t},$f=e=>{if(e==="auto")return e;const t=e.charAt(0)==="#"?e.substring(1):e;return YL(t,3)},jc=e=>typeof e=="string"?JL(e):qs(e),Gge=e=>typeof e=="string"?ZL(e):K1(e),si=e=>typeof e=="string"?ZL(e):K1(e),Kge=K1,Xge=K1,Yge=e=>e.toISOString();class $e extends Be{constructor(t,r=!0){super(t),r!==!0&&this.root.push(new tn({val:r}))}}class L2 extends Be{constructor(t,r){super(t),this.root.push(new tn({val:Gge(r)}))}}class _f extends Be{constructor(t,r){super(t),this.root.push(new tn({val:r}))}}const vh=(e,t)=>new ir({name:e,attributes:{value:{key:"w:val",value:t}}});class t0 extends Be{constructor(t,r){super(t),this.root.push(new tn({val:r}))}}class yc extends Be{constructor(t,r){super(t),this.root.push(r)}}class ir extends Be{constructor({name:t,attributes:r,children:n}){super(t),r&&this.root.push(new fp(r)),n&&this.root.push(...n)}}const Oa={START:"start",CENTER:"center",END:"end",BOTH:"both",MEDIUM_KASHIDA:"mediumKashida",DISTRIBUTE:"distribute",NUM_TAB:"numTab",HIGH_KASHIDA:"highKashida",LOW_KASHIDA:"lowKashida",THAI_DISTRIBUTE:"thaiDistribute",LEFT:"left",RIGHT:"right",JUSTIFIED:"both"};class Jge extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class Zge extends Be{constructor(t){super("w:jc"),this.root.push(new Jge({val:t}))}}class zr extends Be{constructor(t,{color:r,size:n,space:s,style:a}){super(t),this.root.push(new Qge({style:a,color:r===void 0?void 0:$f(r),size:n===void 0?void 0:Kge(n),space:s===void 0?void 0:Xge(s)}))}}class Qge extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const FN={SINGLE:"single",NONE:"none"};class e1e extends W1{constructor(t){super("w:pBdr"),t.top&&this.root.push(new zr("w:top",t.top)),t.bottom&&this.root.push(new zr("w:bottom",t.bottom)),t.left&&this.root.push(new zr("w:left",t.left)),t.right&&this.root.push(new zr("w:right",t.right))}}class t1e extends Be{constructor(){super("w:pBdr");const t=new zr("w:bottom",{color:"auto",space:1,style:FN.SINGLE,size:6});this.root.push(t)}}class r1e extends Be{constructor({start:t,end:r,left:n,right:s,hanging:a,firstLine:i}){super("w:ind"),this.root.push(new fp({start:{key:"w:start",value:t===void 0?void 0:jc(t)},end:{key:"w:end",value:r===void 0?void 0:jc(r)},left:{key:"w:left",value:n===void 0?void 0:jc(n)},right:{key:"w:right",value:s===void 0?void 0:jc(s)},hanging:{key:"w:hanging",value:a===void 0?void 0:si(a)},firstLine:{key:"w:firstLine",value:i===void 0?void 0:si(i)}}))}}let n1e=class extends Be{constructor(){super("w:br")}};const PN={BEGIN:"begin",END:"end",SEPARATE:"separate"};class LN extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class hx extends Be{constructor(t){super("w:fldChar"),this.root.push(new LN({type:PN.BEGIN,dirty:t}))}}class px extends Be{constructor(t){super("w:fldChar"),this.root.push(new LN({type:PN.SEPARATE,dirty:t}))}}class mx extends Be{constructor(t){super("w:fldChar"),this.root.push(new LN({type:PN.END,dirty:t}))}}const Gf={DEFAULT:"default",PRESERVE:"preserve"};class Kf extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{space:"xml:space"})}}class s1e extends Be{constructor(){super("w:instrText"),this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push("PAGE")}}class a1e extends Be{constructor(){super("w:instrText"),this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push("NUMPAGES")}}class i1e extends Be{constructor(){super("w:instrText"),this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push("SECTIONPAGES")}}class o1e extends Be{constructor(){super("w:instrText"),this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push("SECTION")}}class l1e extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class QL extends Be{constructor({fill:t,color:r,type:n}){super("w:shd"),this.root.push(new l1e({fill:t===void 0?void 0:$f(t),color:r===void 0?void 0:$f(r),type:n}))}}class c1e extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const u1e={DOT:"dot"};class f1e extends Be{constructor(t){super("w:em"),this.root.push(new tn({val:t}))}}class d1e extends f1e{constructor(t=u1e.DOT){super(t)}}class h1e extends Be{constructor(t){super("w:spacing"),this.root.push(new tn({val:jc(t)}))}}class p1e extends Be{constructor(t){super("w:color"),this.root.push(new tn({val:$f(t)}))}}class m1e extends Be{constructor(t){super("w:highlight"),this.root.push(new tn({val:t}))}}class x1e extends Be{constructor(t){super("w:highlightCs"),this.root.push(new tn({val:t}))}}const g1e=e=>new ir({name:"w:lang",attributes:{value:{key:"w:val",value:e.value},eastAsia:{key:"w:eastAsia",value:e.eastAsia},bidirectional:{key:"w:bidi",value:e.bidirectional}}});class Wj extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class B2 extends Be{constructor(t,r){if(super("w:rFonts"),typeof t=="string"){const n=t;this.root.push(new Wj({ascii:n,cs:n,eastAsia:n,hAnsi:n,hint:r}))}else{const n=t;this.root.push(new Wj(n))}}}let eB=class extends Be{constructor(t){super("w:vertAlign"),this.root.push(new tn({val:t}))}};class y1e extends eB{constructor(){super("superscript")}}class v1e extends eB{constructor(){super("subscript")}}const tB={SINGLE:"single"};class b1e extends Be{constructor(t=tB.SINGLE,r){super("w:u"),this.root.push(new tn({val:t,color:r===void 0?void 0:$f(r)}))}}class yu extends W1{constructor(t){var r,n;if(super("w:rPr"),!t)return;t.style&&this.push(new _f("w:rStyle",t.style)),t.font&&(typeof t.font=="string"?this.push(new B2(t.font)):"name"in t.font?this.push(new B2(t.font.name,t.font.hint)):this.push(new B2(t.font))),t.bold!==void 0&&this.push(new $e("w:b",t.bold)),(t.boldComplexScript===void 0&&t.bold!==void 0||t.boldComplexScript)&&this.push(new $e("w:bCs",(r=t.boldComplexScript)!=null?r:t.bold)),t.italics!==void 0&&this.push(new $e("w:i",t.italics)),(t.italicsComplexScript===void 0&&t.italics!==void 0||t.italicsComplexScript)&&this.push(new $e("w:iCs",(n=t.italicsComplexScript)!=null?n:t.italics)),t.smallCaps!==void 0?this.push(new $e("w:smallCaps",t.smallCaps)):t.allCaps!==void 0&&this.push(new $e("w:caps",t.allCaps)),t.strike!==void 0&&this.push(new $e("w:strike",t.strike)),t.doubleStrike!==void 0&&this.push(new $e("w:dstrike",t.doubleStrike)),t.emboss!==void 0&&this.push(new $e("w:emboss",t.emboss)),t.imprint!==void 0&&this.push(new $e("w:imprint",t.imprint)),t.noProof!==void 0&&this.push(new $e("w:noProof",t.noProof)),t.snapToGrid!==void 0&&this.push(new $e("w:snapToGrid",t.snapToGrid)),t.vanish&&this.push(new $e("w:vanish",t.vanish)),t.color&&this.push(new p1e(t.color)),t.characterSpacing&&this.push(new h1e(t.characterSpacing)),t.scale!==void 0&&this.push(new t0("w:w",t.scale)),t.kern&&this.push(new L2("w:kern",t.kern)),t.position&&this.push(new _f("w:position",t.position)),t.size!==void 0&&this.push(new L2("w:sz",t.size));const s=t.sizeComplexScript===void 0||t.sizeComplexScript===!0?t.size:t.sizeComplexScript;s&&this.push(new L2("w:szCs",s)),t.highlight&&this.push(new m1e(t.highlight));const a=t.highlightComplexScript===void 0||t.highlightComplexScript===!0?t.highlight:t.highlightComplexScript;a&&this.push(new x1e(a)),t.underline&&this.push(new b1e(t.underline.type,t.underline.color)),t.effect&&this.push(new _f("w:effect",t.effect)),t.border&&this.push(new zr("w:bdr",t.border)),t.shading&&this.push(new QL(t.shading)),t.subScript&&this.push(new v1e),t.superScript&&this.push(new y1e),t.rightToLeft!==void 0&&this.push(new $e("w:rtl",t.rightToLeft)),t.emphasisMark&&this.push(new d1e(t.emphasisMark.type)),t.language&&this.push(g1e(t.language)),t.specVanish&&this.push(new $e("w:specVanish",t.vanish)),t.math&&this.push(new $e("w:oMath",t.math)),t.revision&&this.push(new w1e(t.revision))}push(t){this.root.push(t)}}class w1e extends Be{constructor(t){super("w:rPrChange"),this.root.push(new c1e({id:t.id,author:t.author,date:t.date})),this.addChildElement(new yu(t))}}class $j extends Be{constructor(t){var r;super("w:t"),typeof t=="string"?(this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push(t)):(this.root.push(new Kf({space:(r=t.space)!=null?r:Gf.DEFAULT})),this.root.push(t.text))}}const xx={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class mp extends Be{constructor(t){if(super("w:r"),Pe(this,"properties"),this.properties=new yu(t),this.root.push(this.properties),t.break)for(let r=0;r<t.break;r++)this.root.push(new n1e);if(t.children)for(const r of t.children){if(typeof r=="string"){switch(r){case xx.CURRENT:this.root.push(new hx),this.root.push(new s1e),this.root.push(new px),this.root.push(new mx);break;case xx.TOTAL_PAGES:this.root.push(new hx),this.root.push(new a1e),this.root.push(new px),this.root.push(new mx);break;case xx.TOTAL_PAGES_IN_SECTION:this.root.push(new hx),this.root.push(new i1e),this.root.push(new px),this.root.push(new mx);break;case xx.CURRENT_SECTION:this.root.push(new hx),this.root.push(new o1e),this.root.push(new px),this.root.push(new mx);break;default:this.root.push(new $j(r));break}continue}this.root.push(r)}else t.text!==void 0&&this.root.push(new $j(t.text))}}class Ec extends mp{constructor(t){super(typeof t=="string"?{text:t}:t)}}var U2={},dr={},z2,Gj;function xp(){if(Gj)return z2;Gj=1,z2=e;function e(t,r){if(!t)throw new Error(r||"Assertion failed")}return e.equal=function(r,n,s){if(r!=n)throw new Error(s||"Assertion failed: "+r+" != "+n)},z2}var Kj;function $i(){if(Kj)return dr;Kj=1;var e=xp(),t=Zl();dr.inherits=t;function r(F,X){return(F.charCodeAt(X)&64512)!==55296||X<0||X+1>=F.length?!1:(F.charCodeAt(X+1)&64512)===56320}function n(F,X){if(Array.isArray(F))return F.slice();if(!F)return[];var P=[];if(typeof F=="string")if(X){if(X==="hex")for(F=F.replace(/[^a-z0-9]+/ig,""),F.length%2!==0&&(F="0"+F),te=0;te<F.length;te+=2)P.push(parseInt(F[te]+F[te+1],16))}else for(var ie=0,te=0;te<F.length;te++){var Y=F.charCodeAt(te);Y<128?P[ie++]=Y:Y<2048?(P[ie++]=Y>>6|192,P[ie++]=Y&63|128):r(F,te)?(Y=65536+((Y&1023)<<10)+(F.charCodeAt(++te)&1023),P[ie++]=Y>>18|240,P[ie++]=Y>>12&63|128,P[ie++]=Y>>6&63|128,P[ie++]=Y&63|128):(P[ie++]=Y>>12|224,P[ie++]=Y>>6&63|128,P[ie++]=Y&63|128)}else for(te=0;te<F.length;te++)P[te]=F[te]|0;return P}dr.toArray=n;function s(F){for(var X="",P=0;P<F.length;P++)X+=o(F[P].toString(16));return X}dr.toHex=s;function a(F){var X=F>>>24|F>>>8&65280|F<<8&16711680|(F&255)<<24;return X>>>0}dr.htonl=a;function i(F,X){for(var P="",ie=0;ie<F.length;ie++){var te=F[ie];X==="little"&&(te=a(te)),P+=c(te.toString(16))}return P}dr.toHex32=i;function o(F){return F.length===1?"0"+F:F}dr.zero2=o;function c(F){return F.length===7?"0"+F:F.length===6?"00"+F:F.length===5?"000"+F:F.length===4?"0000"+F:F.length===3?"00000"+F:F.length===2?"000000"+F:F.length===1?"0000000"+F:F}dr.zero8=c;function f(F,X,P,ie){var te=P-X;e(te%4===0);for(var Y=new Array(te/4),ve=0,oe=X;ve<Y.length;ve++,oe+=4){var Ee;ie==="big"?Ee=F[oe]<<24|F[oe+1]<<16|F[oe+2]<<8|F[oe+3]:Ee=F[oe+3]<<24|F[oe+2]<<16|F[oe+1]<<8|F[oe],Y[ve]=Ee>>>0}return Y}dr.join32=f;function h(F,X){for(var P=new Array(F.length*4),ie=0,te=0;ie<F.length;ie++,te+=4){var Y=F[ie];X==="big"?(P[te]=Y>>>24,P[te+1]=Y>>>16&255,P[te+2]=Y>>>8&255,P[te+3]=Y&255):(P[te+3]=Y>>>24,P[te+2]=Y>>>16&255,P[te+1]=Y>>>8&255,P[te]=Y&255)}return P}dr.split32=h;function p(F,X){return F>>>X|F<<32-X}dr.rotr32=p;function x(F,X){return F<<X|F>>>32-X}dr.rotl32=x;function g(F,X){return F+X>>>0}dr.sum32=g;function v(F,X,P){return F+X+P>>>0}dr.sum32_3=v;function y(F,X,P,ie){return F+X+P+ie>>>0}dr.sum32_4=y;function w(F,X,P,ie,te){return F+X+P+ie+te>>>0}dr.sum32_5=w;function _(F,X,P,ie){var te=F[X],Y=F[X+1],ve=ie+Y>>>0,oe=(ve<ie?1:0)+P+te;F[X]=oe>>>0,F[X+1]=ve}dr.sum64=_;function S(F,X,P,ie){var te=X+ie>>>0,Y=(te<X?1:0)+F+P;return Y>>>0}dr.sum64_hi=S;function E(F,X,P,ie){var te=X+ie;return te>>>0}dr.sum64_lo=E;function N(F,X,P,ie,te,Y,ve,oe){var Ee=0,K=X;K=K+ie>>>0,Ee+=K<X?1:0,K=K+Y>>>0,Ee+=K<Y?1:0,K=K+oe>>>0,Ee+=K<oe?1:0;var D=F+P+te+ve+Ee;return D>>>0}dr.sum64_4_hi=N;function k(F,X,P,ie,te,Y,ve,oe){var Ee=X+ie+Y+oe;return Ee>>>0}dr.sum64_4_lo=k;function O(F,X,P,ie,te,Y,ve,oe,Ee,K){var D=0,q=X;q=q+ie>>>0,D+=q<X?1:0,q=q+Y>>>0,D+=q<Y?1:0,q=q+oe>>>0,D+=q<oe?1:0,q=q+K>>>0,D+=q<K?1:0;var W=F+P+te+ve+Ee+D;return W>>>0}dr.sum64_5_hi=O;function R(F,X,P,ie,te,Y,ve,oe,Ee,K){var D=X+ie+Y+oe+K;return D>>>0}dr.sum64_5_lo=R;function V(F,X,P){var ie=X<<32-P|F>>>P;return ie>>>0}dr.rotr64_hi=V;function I(F,X,P){var ie=F<<32-P|X>>>P;return ie>>>0}dr.rotr64_lo=I;function Z(F,X,P){return F>>>P}dr.shr64_hi=Z;function ce(F,X,P){var ie=F<<32-P|X>>>P;return ie>>>0}return dr.shr64_lo=ce,dr}var H2={},Xj;function gp(){if(Xj)return H2;Xj=1;var e=$i(),t=xp();function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return H2.BlockHash=r,r.prototype.update=function(s,a){if(s=e.toArray(s,a),this.pending?this.pending=this.pending.concat(s):this.pending=s,this.pendingTotal+=s.length,this.pending.length>=this._delta8){s=this.pending;var i=s.length%this._delta8;this.pending=s.slice(s.length-i,s.length),this.pending.length===0&&(this.pending=null),s=e.join32(s,0,s.length-i,this.endian);for(var o=0;o<s.length;o+=this._delta32)this._update(s,o,o+this._delta32)}return this},r.prototype.digest=function(s){return this.update(this._pad()),t(this.pending===null),this._digest(s)},r.prototype._pad=function(){var s=this.pendingTotal,a=this._delta8,i=a-(s+this.padLength)%a,o=new Array(i+this.padLength);o[0]=128;for(var c=1;c<i;c++)o[c]=0;if(s<<=3,this.endian==="big"){for(var f=8;f<this.padLength;f++)o[c++]=0;o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=s>>>24&255,o[c++]=s>>>16&255,o[c++]=s>>>8&255,o[c++]=s&255}else for(o[c++]=s&255,o[c++]=s>>>8&255,o[c++]=s>>>16&255,o[c++]=s>>>24&255,o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=0,f=8;f<this.padLength;f++)o[c++]=0;return o},H2}var vc={},Ai={},Yj;function rB(){if(Yj)return Ai;Yj=1;var e=$i(),t=e.rotr32;function r(h,p,x,g){if(h===0)return n(p,x,g);if(h===1||h===3)return a(p,x,g);if(h===2)return s(p,x,g)}Ai.ft_1=r;function n(h,p,x){return h&p^~h&x}Ai.ch32=n;function s(h,p,x){return h&p^h&x^p&x}Ai.maj32=s;function a(h,p,x){return h^p^x}Ai.p32=a;function i(h){return t(h,2)^t(h,13)^t(h,22)}Ai.s0_256=i;function o(h){return t(h,6)^t(h,11)^t(h,25)}Ai.s1_256=o;function c(h){return t(h,7)^t(h,18)^h>>>3}Ai.g0_256=c;function f(h){return t(h,17)^t(h,19)^h>>>10}return Ai.g1_256=f,Ai}var V2,Jj;function _1e(){if(Jj)return V2;Jj=1;var e=$i(),t=gp(),r=rB(),n=e.rotl32,s=e.sum32,a=e.sum32_5,i=r.ft_1,o=t.BlockHash,c=[1518500249,1859775393,2400959708,3395469782];function f(){if(!(this instanceof f))return new f;o.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return e.inherits(f,o),V2=f,f.blockSize=512,f.outSize=160,f.hmacStrength=80,f.padLength=64,f.prototype._update=function(p,x){for(var g=this.W,v=0;v<16;v++)g[v]=p[x+v];for(;v<g.length;v++)g[v]=n(g[v-3]^g[v-8]^g[v-14]^g[v-16],1);var y=this.h[0],w=this.h[1],_=this.h[2],S=this.h[3],E=this.h[4];for(v=0;v<g.length;v++){var N=~~(v/20),k=a(n(y,5),i(N,w,_,S),E,g[v],c[N]);E=S,S=_,_=n(w,30),w=y,y=k}this.h[0]=s(this.h[0],y),this.h[1]=s(this.h[1],w),this.h[2]=s(this.h[2],_),this.h[3]=s(this.h[3],S),this.h[4]=s(this.h[4],E)},f.prototype._digest=function(p){return p==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},V2}var q2,Zj;function nB(){if(Zj)return q2;Zj=1;var e=$i(),t=gp(),r=rB(),n=xp(),s=e.sum32,a=e.sum32_4,i=e.sum32_5,o=r.ch32,c=r.maj32,f=r.s0_256,h=r.s1_256,p=r.g0_256,x=r.g1_256,g=t.BlockHash,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y(){if(!(this instanceof y))return new y;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=v,this.W=new Array(64)}return e.inherits(y,g),q2=y,y.blockSize=512,y.outSize=256,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(_,S){for(var E=this.W,N=0;N<16;N++)E[N]=_[S+N];for(;N<E.length;N++)E[N]=a(x(E[N-2]),E[N-7],p(E[N-15]),E[N-16]);var k=this.h[0],O=this.h[1],R=this.h[2],V=this.h[3],I=this.h[4],Z=this.h[5],ce=this.h[6],F=this.h[7];for(n(this.k.length===E.length),N=0;N<E.length;N++){var X=i(F,h(I),o(I,Z,ce),this.k[N],E[N]),P=s(f(k),c(k,O,R));F=ce,ce=Z,Z=I,I=s(V,X),V=R,R=O,O=k,k=s(X,P)}this.h[0]=s(this.h[0],k),this.h[1]=s(this.h[1],O),this.h[2]=s(this.h[2],R),this.h[3]=s(this.h[3],V),this.h[4]=s(this.h[4],I),this.h[5]=s(this.h[5],Z),this.h[6]=s(this.h[6],ce),this.h[7]=s(this.h[7],F)},y.prototype._digest=function(_){return _==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},q2}var W2,Qj;function E1e(){if(Qj)return W2;Qj=1;var e=$i(),t=nB();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return e.inherits(r,t),W2=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(s){return s==="hex"?e.toHex32(this.h.slice(0,7),"big"):e.split32(this.h.slice(0,7),"big")},W2}var $2,eO;function sB(){if(eO)return $2;eO=1;var e=$i(),t=gp(),r=xp(),n=e.rotr64_hi,s=e.rotr64_lo,a=e.shr64_hi,i=e.shr64_lo,o=e.sum64,c=e.sum64_hi,f=e.sum64_lo,h=e.sum64_4_hi,p=e.sum64_4_lo,x=e.sum64_5_hi,g=e.sum64_5_lo,v=t.BlockHash,y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function w(){if(!(this instanceof w))return new w;v.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=y,this.W=new Array(160)}e.inherits(w,v),$2=w,w.blockSize=1024,w.outSize=512,w.hmacStrength=192,w.padLength=128,w.prototype._prepareBlock=function(P,ie){for(var te=this.W,Y=0;Y<32;Y++)te[Y]=P[ie+Y];for(;Y<te.length;Y+=2){var ve=ce(te[Y-4],te[Y-3]),oe=F(te[Y-4],te[Y-3]),Ee=te[Y-14],K=te[Y-13],D=I(te[Y-30],te[Y-29]),q=Z(te[Y-30],te[Y-29]),W=te[Y-32],J=te[Y-31];te[Y]=h(ve,oe,Ee,K,D,q,W,J),te[Y+1]=p(ve,oe,Ee,K,D,q,W,J)}},w.prototype._update=function(P,ie){this._prepareBlock(P,ie);var te=this.W,Y=this.h[0],ve=this.h[1],oe=this.h[2],Ee=this.h[3],K=this.h[4],D=this.h[5],q=this.h[6],W=this.h[7],J=this.h[8],re=this.h[9],U=this.h[10],L=this.h[11],se=this.h[12],Q=this.h[13],ee=this.h[14],B=this.h[15];r(this.k.length===te.length);for(var be=0;be<te.length;be+=2){var z=ee,he=B,M=R(J,re),A=V(J,re),j=_(J,re,U,L,se),H=S(J,re,U,L,se,Q),ue=this.k[be],ye=this.k[be+1],pe=te[be],Ne=te[be+1],De=x(z,he,M,A,j,H,ue,ye,pe,Ne),Fe=g(z,he,M,A,j,H,ue,ye,pe,Ne);z=k(Y,ve),he=O(Y,ve),M=E(Y,ve,oe,Ee,K),A=N(Y,ve,oe,Ee,K,D);var Ke=c(z,he,M,A),st=f(z,he,M,A);ee=se,B=Q,se=U,Q=L,U=J,L=re,J=c(q,W,De,Fe),re=f(W,W,De,Fe),q=K,W=D,K=oe,D=Ee,oe=Y,Ee=ve,Y=c(De,Fe,Ke,st),ve=f(De,Fe,Ke,st)}o(this.h,0,Y,ve),o(this.h,2,oe,Ee),o(this.h,4,K,D),o(this.h,6,q,W),o(this.h,8,J,re),o(this.h,10,U,L),o(this.h,12,se,Q),o(this.h,14,ee,B)},w.prototype._digest=function(P){return P==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")};function _(X,P,ie,te,Y){var ve=X&ie^~X&Y;return ve<0&&(ve+=4294967296),ve}function S(X,P,ie,te,Y,ve){var oe=P&te^~P&ve;return oe<0&&(oe+=4294967296),oe}function E(X,P,ie,te,Y){var ve=X&ie^X&Y^ie&Y;return ve<0&&(ve+=4294967296),ve}function N(X,P,ie,te,Y,ve){var oe=P&te^P&ve^te&ve;return oe<0&&(oe+=4294967296),oe}function k(X,P){var ie=n(X,P,28),te=n(P,X,2),Y=n(P,X,7),ve=ie^te^Y;return ve<0&&(ve+=4294967296),ve}function O(X,P){var ie=s(X,P,28),te=s(P,X,2),Y=s(P,X,7),ve=ie^te^Y;return ve<0&&(ve+=4294967296),ve}function R(X,P){var ie=n(X,P,14),te=n(X,P,18),Y=n(P,X,9),ve=ie^te^Y;return ve<0&&(ve+=4294967296),ve}function V(X,P){var ie=s(X,P,14),te=s(X,P,18),Y=s(P,X,9),ve=ie^te^Y;return ve<0&&(ve+=4294967296),ve}function I(X,P){var ie=n(X,P,1),te=n(X,P,8),Y=a(X,P,7),ve=ie^te^Y;return ve<0&&(ve+=4294967296),ve}function Z(X,P){var ie=s(X,P,1),te=s(X,P,8),Y=i(X,P,7),ve=ie^te^Y;return ve<0&&(ve+=4294967296),ve}function ce(X,P){var ie=n(X,P,19),te=n(P,X,29),Y=a(X,P,6),ve=ie^te^Y;return ve<0&&(ve+=4294967296),ve}function F(X,P){var ie=s(X,P,19),te=s(P,X,29),Y=i(X,P,6),ve=ie^te^Y;return ve<0&&(ve+=4294967296),ve}return $2}var G2,tO;function S1e(){if(tO)return G2;tO=1;var e=$i(),t=sB();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return e.inherits(r,t),G2=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(s){return s==="hex"?e.toHex32(this.h.slice(0,12),"big"):e.split32(this.h.slice(0,12),"big")},G2}var rO;function N1e(){return rO||(rO=1,vc.sha1=_1e(),vc.sha224=E1e(),vc.sha256=nB(),vc.sha384=S1e(),vc.sha512=sB()),vc}var K2={},nO;function T1e(){if(nO)return K2;nO=1;var e=$i(),t=gp(),r=e.rotl32,n=e.sum32,s=e.sum32_3,a=e.sum32_4,i=t.BlockHash;function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}e.inherits(o,i),K2.ripemd160=o,o.blockSize=512,o.outSize=160,o.hmacStrength=192,o.padLength=64,o.prototype._update=function(w,_){for(var S=this.h[0],E=this.h[1],N=this.h[2],k=this.h[3],O=this.h[4],R=S,V=E,I=N,Z=k,ce=O,F=0;F<80;F++){var X=n(r(a(S,c(F,E,N,k),w[p[F]+_],f(F)),g[F]),O);S=O,O=k,k=r(N,10),N=E,E=X,X=n(r(a(R,c(79-F,V,I,Z),w[x[F]+_],h(F)),v[F]),ce),R=ce,ce=Z,Z=r(I,10),I=V,V=X}X=s(this.h[1],N,Z),this.h[1]=s(this.h[2],k,ce),this.h[2]=s(this.h[3],O,R),this.h[3]=s(this.h[4],S,V),this.h[4]=s(this.h[0],E,I),this.h[0]=X},o.prototype._digest=function(w){return w==="hex"?e.toHex32(this.h,"little"):e.split32(this.h,"little")};function c(y,w,_,S){return y<=15?w^_^S:y<=31?w&_|~w&S:y<=47?(w|~_)^S:y<=63?w&S|_&~S:w^(_|~S)}function f(y){return y<=15?0:y<=31?1518500249:y<=47?1859775393:y<=63?2400959708:2840853838}function h(y){return y<=15?1352829926:y<=31?1548603684:y<=47?1836072691:y<=63?2053994217:0}var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],x=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],v=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return K2}var X2,sO;function k1e(){if(sO)return X2;sO=1;var e=$i(),t=xp();function r(n,s,a){if(!(this instanceof r))return new r(n,s,a);this.Hash=n,this.blockSize=n.blockSize/8,this.outSize=n.outSize/8,this.inner=null,this.outer=null,this._init(e.toArray(s,a))}return X2=r,r.prototype._init=function(s){s.length>this.blockSize&&(s=new this.Hash().update(s).digest()),t(s.length<=this.blockSize);for(var a=s.length;a<this.blockSize;a++)s.push(0);for(a=0;a<s.length;a++)s[a]^=54;for(this.inner=new this.Hash().update(s),a=0;a<s.length;a++)s[a]^=106;this.outer=new this.Hash().update(s)},r.prototype.update=function(s,a){return this.inner.update(s,a),this},r.prototype.digest=function(s){return this.outer.update(this.inner.digest()),this.outer.digest(s)},X2}var aO;function A1e(){return aO||(aO=1,(function(e){var t=e;t.utils=$i(),t.common=gp(),t.sha=N1e(),t.ripemd=T1e(),t.hmac=k1e(),t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(U2)),U2}var C1e=A1e();const R1e=TN(C1e);let j1e="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",O1e=(e,t=21)=>(r=t)=>{let n="",s=r|0;for(;s--;)n+=e[Math.random()*e.length|0];return n},D1e=(e=21)=>{let t="",r=e|0;for(;r--;)t+=j1e[Math.random()*64|0];return t};const ri=e=>Math.floor(e*72*20),X1=(e=0)=>{let t=e;return()=>++t},I1e=()=>X1(),M1e=()=>X1(1),F1e=()=>X1(),P1e=()=>X1(),L1e=()=>D1e().toLowerCase(),iO=e=>R1e.sha1().update(e instanceof ArrayBuffer?new Uint8Array(e):e).digest("hex"),bh=e=>O1e("1234567890abcdef",e)(),B1e=()=>`${bh(8)}-${bh(4)}-${bh(4)}-${bh(4)}-${bh(12)}`,U1e={PAGE:"page"},z1e={PAGE:"page"},H1e=()=>new ir({name:"wp:simplePos",attributes:{x:{key:"x",value:0},y:{key:"y",value:0}}}),aB=e=>new ir({name:"wp:align",children:[e]}),iB=e=>new ir({name:"wp:posOffset",children:[e.toString()]}),V1e=({relative:e,align:t,offset:r})=>new ir({name:"wp:positionH",attributes:{relativeFrom:{key:"relativeFrom",value:e??U1e.PAGE}},children:[(()=>{if(t)return aB(t);if(r!==void 0)return iB(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]}),q1e=({relative:e,align:t,offset:r})=>new ir({name:"wp:positionV",attributes:{relativeFrom:{key:"relativeFrom",value:e??z1e.PAGE}},children:[(()=>{if(t)return aB(t);if(r!==void 0)return iB(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]});class W1e extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{uri:"uri"})}}const $1e=e=>new ir({name:"asvg:svgBlip",attributes:{asvg:{key:"xmlns:asvg",value:"http://schemas.microsoft.com/office/drawing/2016/SVG/main"},embed:{key:"r:embed",value:`rId{${e.fileName}}`}}}),G1e=e=>new ir({name:"a:ext",attributes:{uri:{key:"uri",value:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"}},children:[$1e(e)]}),K1e=e=>new ir({name:"a:extLst",children:[G1e(e)]}),X1e=e=>new ir({name:"a:blip",attributes:{embed:{key:"r:embed",value:`rId{${e.type==="svg"?e.fallback.fileName:e.fileName}}`},cstate:{key:"cstate",value:"none"}},children:e.type==="svg"?[K1e(e)]:[]});class Y1e extends Be{constructor(){super("a:srcRect")}}class J1e extends Be{constructor(){super("a:fillRect")}}class Z1e extends Be{constructor(){super("a:stretch"),this.root.push(new J1e)}}class Q1e extends Be{constructor(t){super("pic:blipFill"),this.root.push(X1e(t)),this.root.push(new Y1e),this.root.push(new Z1e)}}class eye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"})}}class tye extends Be{constructor(){super("a:picLocks"),this.root.push(new eye({noChangeAspect:1,noChangeArrowheads:1}))}}class rye extends Be{constructor(){super("pic:cNvPicPr"),this.root.push(new tye)}}const oB=(e,t)=>new ir({name:"a:hlinkClick",attributes:Lo(Dt({},t?{xmlns:{key:"xmlns:a",value:"http://schemas.openxmlformats.org/drawingml/2006/main"}}:{}),{id:{key:"r:id",value:`rId${e}`}})});class nye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"id",name:"name",descr:"descr"})}}class sye extends Be{constructor(){super("pic:cNvPr"),this.root.push(new nye({id:0,name:"",descr:""}))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const n=t.stack[r];if(n instanceof BN){this.root.push(oB(n.linkId,!1));break}}return super.prepForXml(t)}}class aye extends Be{constructor(){super("pic:nvPicPr"),this.root.push(new sye),this.root.push(new rye)}}class iye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns:pic"})}}class oye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{cx:"cx",cy:"cy"})}}class lye extends Be{constructor(t,r){super("a:ext"),Pe(this,"attributes"),this.attributes=new oye({cx:t,cy:r}),this.root.push(this.attributes)}}class cye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{x:"x",y:"y"})}}class uye extends Be{constructor(){super("a:off"),this.root.push(new cye({x:0,y:0}))}}class fye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"})}}class dye extends Be{constructor(t){var r,n;super("a:xfrm"),Pe(this,"extents"),this.root.push(new fye({flipVertical:(r=t.flip)==null?void 0:r.vertical,flipHorizontal:(n=t.flip)==null?void 0:n.horizontal,rotation:t.rotation})),this.extents=new lye(t.emus.x,t.emus.y),this.root.push(new uye),this.root.push(this.extents)}}const lB=()=>new ir({name:"a:noFill"}),hye=e=>new ir({name:"a:srgbClr",attributes:{value:{key:"val",value:e.value}}}),pye=e=>new ir({name:"a:schemeClr",attributes:{value:{key:"val",value:e.value}}}),oO=e=>new ir({name:"a:solidFill",children:[e.type==="rgb"?hye(e):pye(e)]}),mye=e=>new ir({name:"a:ln",attributes:{width:{key:"w",value:e.width},cap:{key:"cap",value:e.cap},compoundLine:{key:"cmpd",value:e.compoundLine},align:{key:"algn",value:e.align}},children:[e.type==="noFill"?lB():e.solidFillType==="rgb"?oO({type:"rgb",value:e.value}):oO({type:"scheme",value:e.value})]});class xye extends Be{constructor(){super("a:avLst")}}class gye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{prst:"prst"})}}class yye extends Be{constructor(){super("a:prstGeom"),this.root.push(new gye({prst:"rect"})),this.root.push(new xye)}}class vye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{bwMode:"bwMode"})}}class bye extends Be{constructor({outline:t,transform:r}){super("pic:spPr"),Pe(this,"form"),this.root.push(new vye({bwMode:"auto"})),this.form=new dye(r),this.root.push(this.form),this.root.push(new yye),t&&(this.root.push(lB()),this.root.push(mye(t)))}}class wye extends Be{constructor({mediaData:t,transform:r,outline:n}){super("pic:pic"),this.root.push(new iye({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new aye),this.root.push(new Q1e(t)),this.root.push(new bye({transform:r,outline:n}))}}class _ye extends Be{constructor({mediaData:t,transform:r,outline:n}){super("a:graphicData"),Pe(this,"pic"),this.root.push(new W1e({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new wye({mediaData:t,transform:r,outline:n}),this.root.push(this.pic)}}class Eye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{a:"xmlns:a"})}}class cB extends Be{constructor({mediaData:t,transform:r,outline:n}){super("a:graphic"),Pe(this,"data"),this.root.push(new Eye({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new _ye({mediaData:t,transform:r,outline:n}),this.root.push(this.data)}}const gx={NONE:0,SQUARE:1,TIGHT:2,TOP_AND_BOTTOM:3},Sye={BOTH_SIDES:"bothSides"};class lO extends Be{constructor(){super("wp:wrapNone")}}class Nye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"})}}class Tye extends Be{constructor(t,r={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new Nye({wrapText:t.side||Sye.BOTH_SIDES,distT:r.top,distB:r.bottom,distL:r.left,distR:r.right}))}}class kye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class Aye extends Be{constructor(t={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new kye({distT:t.top,distB:t.bottom}))}}class Cye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class Rye extends Be{constructor(t={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new Cye({distT:t.top,distB:t.bottom}))}}class uB extends Be{constructor({name:t,description:r,title:n}={name:"",description:"",title:""}){super("wp:docPr"),Pe(this,"docPropertiesUniqueNumericId",F1e());const s={id:{key:"id",value:this.docPropertiesUniqueNumericId()},name:{key:"name",value:t}};r!=null&&(s.description={key:"descr",value:r}),n!=null&&(s.title={key:"title",value:n}),this.root.push(new fp(s))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const n=t.stack[r];if(n instanceof BN){this.root.push(oB(n.linkId,!0));break}}return super.prepForXml(t)}}const fB=({top:e,right:t,bottom:r,left:n})=>new ir({name:"wp:effectExtent",attributes:{top:{key:"t",value:e},right:{key:"r",value:t},bottom:{key:"b",value:r},left:{key:"l",value:n}}}),dB=({x:e,y:t})=>new ir({name:"wp:extent",attributes:{x:{key:"cx",value:e},y:{key:"cy",value:t}}});class jye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"})}}class Oye extends Be{constructor(){super("a:graphicFrameLocks"),this.root.push(new jye({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}}const hB=()=>new ir({name:"wp:cNvGraphicFramePr",children:[new Oye]});class Dye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"})}}class Iye extends Be{constructor({mediaData:t,transform:r,drawingOptions:n}){super("wp:anchor");const s=Dt({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},n.floating);if(this.root.push(new Dye({distT:s.margins&&s.margins.top||0,distB:s.margins&&s.margins.bottom||0,distL:s.margins&&s.margins.left||0,distR:s.margins&&s.margins.right||0,simplePos:"0",allowOverlap:s.allowOverlap===!0?"1":"0",behindDoc:s.behindDocument===!0?"1":"0",locked:s.lockAnchor===!0?"1":"0",layoutInCell:s.layoutInCell===!0?"1":"0",relativeHeight:s.zIndex?s.zIndex:r.emus.y})),this.root.push(H1e()),this.root.push(V1e(s.horizontalPosition)),this.root.push(q1e(s.verticalPosition)),this.root.push(dB({x:r.emus.x,y:r.emus.y})),this.root.push(fB({top:0,right:0,bottom:0,left:0})),n.floating!==void 0&&n.floating.wrap!==void 0)switch(n.floating.wrap.type){case gx.SQUARE:this.root.push(new Tye(n.floating.wrap,n.floating.margins));break;case gx.TIGHT:this.root.push(new Aye(n.floating.margins));break;case gx.TOP_AND_BOTTOM:this.root.push(new Rye(n.floating.margins));break;case gx.NONE:default:this.root.push(new lO)}else this.root.push(new lO);this.root.push(new uB(n.docProperties)),this.root.push(hB()),this.root.push(new cB({mediaData:t,transform:r,outline:n.outline}))}}const Mye=({mediaData:e,transform:t,docProperties:r,outline:n})=>{var s,a,i,o;return new ir({name:"wp:inline",attributes:{distanceTop:{key:"distT",value:0},distanceBottom:{key:"distB",value:0},distanceLeft:{key:"distL",value:0},distanceRight:{key:"distR",value:0}},children:[dB({x:t.emus.x,y:t.emus.y}),fB(n?{top:((s=n.width)!=null?s:9525)*2,right:((a=n.width)!=null?a:9525)*2,bottom:((i=n.width)!=null?i:9525)*2,left:((o=n.width)!=null?o:9525)*2}:{top:0,right:0,bottom:0,left:0}),new uB(r),hB(),new cB({mediaData:e,transform:t,outline:n})]})};class Fye extends Be{constructor(t,r={}){super("w:drawing"),r.floating?this.root.push(new Iye({mediaData:t,transform:t.transformation,drawingOptions:r})):this.root.push(Mye({mediaData:t,transform:t.transformation,docProperties:r.docProperties,outline:r.outline}))}}const Pye=e=>{if(typeof atob=="function"){const t=";base64,",r=e.indexOf(t),n=r===-1?0:r+t.length;return new Uint8Array(atob(e.substring(n)).split("").map(s=>s.charCodeAt(0)))}else{const t=require("buffer");return new t.Buffer(e,"base64")}},Lye=e=>typeof e=="string"?Pye(e):e,Y2=(e,t)=>({data:Lye(e.data),fileName:t,transformation:{pixels:{x:Math.round(e.transformation.width),y:Math.round(e.transformation.height)},emus:{x:Math.round(e.transformation.width*9525),y:Math.round(e.transformation.height*9525)},flip:e.transformation.flip,rotation:e.transformation.rotation?e.transformation.rotation*6e4:void 0}});class Bye extends mp{constructor(t){super({}),Pe(this,"imageData");const n=`${iO(t.data)}.${t.type}`;this.imageData=t.type==="svg"?Lo(Dt({type:t.type},Y2(t,n)),{fallback:Dt({type:t.fallback.type},Y2(Lo(Dt({},t.fallback),{transformation:t.transformation}),`${iO(t.fallback.data)}.${t.fallback.type}`))}):Dt({type:t.type},Y2(t,n));const s=new Fye(this.imageData,{floating:t.floating,docProperties:t.altText,outline:t.outline});this.root.push(s)}prepForXml(t){return t.file.Media.addImage(this.imageData.fileName,this.imageData),this.imageData.type==="svg"&&t.file.Media.addImage(this.imageData.fallback.fileName,this.imageData.fallback),super.prepForXml(t)}}class Uye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns"})}}class zye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const Hye={EXTERNAL:"External"};class Vye extends Be{constructor(t,r,n,s){super("Relationship"),this.root.push(new zye({id:t,type:r,target:n,targetMode:s}))}}class vu extends Be{constructor(){super("Relationships"),this.root.push(new Uye({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(t,r,n,s){const a=new Vye(`rId${t}`,r,n,s);return this.root.push(a),a}get RelationshipCount(){return this.root.length-1}}class qye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class Wye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class $ye extends Be{constructor({id:t,initials:r,author:n,date:s=new Date,children:a}){super("w:comment"),this.root.push(new qye({id:t,initials:r,author:n,date:s.toISOString()}));for(const i of a)this.root.push(i)}}class Gye extends Be{constructor({children:t}){super("w:comments"),Pe(this,"relationships"),this.root.push(new Wye({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const r of t)this.root.push(new $ye(r));this.relationships=new vu}get Relationships(){return this.relationships}}class Kye extends Be{constructor(){super("w:pageBreakBefore")}}const gE={AUTO:"auto"};class Xye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule",beforeAutoSpacing:"w:beforeAutospacing",afterAutoSpacing:"w:afterAutospacing"})}}class Yye extends Be{constructor(t){super("w:spacing"),this.root.push(new Xye(t))}}let yx=class extends Be{constructor(t){super("w:pStyle"),this.root.push(new tn({val:t}))}};class Jye extends Be{constructor(t){super("w:tabs");for(const r of t)this.root.push(new Qye(r))}}const cO={LEFT:"left",RIGHT:"right"};class Zye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class Qye extends Be{constructor({type:t,position:r,leader:n}){super("w:tab"),this.root.push(new Zye({val:t,pos:r,leader:n}))}}class J2 extends Be{constructor(t,r){super("w:numPr"),this.root.push(new eve(r)),this.root.push(new tve(t))}}class eve extends Be{constructor(t){if(super("w:ilvl"),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new tn({val:t}))}}class tve extends Be{constructor(t){super("w:numId"),this.root.push(new tn({val:typeof t=="string"?`{${t}}`:t}))}}class rve extends Be{constructor(){super(...arguments),Pe(this,"fileChild",Symbol())}}class nve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class BN extends Be{constructor(t,r,n){super("w:hyperlink"),Pe(this,"linkId"),this.linkId=r;const s={history:1,anchor:n||void 0,id:n?void 0:`rId${this.linkId}`},a=new nve(s);this.root.push(a),t.forEach(i=>{this.root.push(i)})}}class sve extends Be{constructor(t){super("w:externalHyperlink"),this.options=t}}class ave extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class ive extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"w:id"})}}class ove{constructor(t){Pe(this,"bookmarkUniqueNumericId",P1e()),Pe(this,"start"),Pe(this,"children"),Pe(this,"end");const r=this.bookmarkUniqueNumericId();this.start=new lve(t.id,r),this.children=t.children,this.end=new cve(r)}}class lve extends Be{constructor(t,r){super("w:bookmarkStart");const n=new ave({name:t,id:r});this.root.push(n)}}class cve extends Be{constructor(t){super("w:bookmarkEnd");const r=new ive({id:t});this.root.push(r)}}class uve extends Be{constructor(t){super("w:outlineLvl"),this.level=t,this.root.push(new tn({val:t}))}}const fve={TOP:"top",CENTER:"center",BOTTOM:"bottom"};Lo(Dt({},fve),{BOTH:"both"});class dve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{verticalAlign:"w:val"})}}class hve extends Be{constructor(t){super("w:vAlign"),this.root.push(new dve({verticalAlign:t}))}}class pve extends Be{constructor({space:t,count:r,separate:n,equalWidth:s,children:a}){super("w:cols"),this.root.push(new fp({space:{key:"w:space",value:t===void 0?void 0:si(t)},count:{key:"w:num",value:r===void 0?void 0:qs(r)},separate:{key:"w:sep",value:n},equalWidth:{key:"w:equalWidth",value:s}})),!s&&a&&a.forEach(i=>this.addChildElement(i))}}const mve=({type:e,linePitch:t,charSpace:r})=>new ir({name:"w:docGrid",attributes:{type:{key:"w:type",value:e},linePitch:{key:"w:linePitch",value:qs(t)},charSpace:{key:"w:charSpace",value:r?qs(r):void 0}}}),Ef={DEFAULT:"default",FIRST:"first",EVEN:"even"};class xve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const uO={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class Z2 extends Be{constructor(t,r){super(t),this.root.push(new xve({type:r.type||Ef.DEFAULT,id:`rId${r.id}`}))}}const gve=({countBy:e,start:t,restart:r,distance:n})=>new ir({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:e===void 0?void 0:qs(e)},start:{key:"w:start",value:t===void 0?void 0:qs(t)},restart:{key:"w:restart",value:r},distance:{key:"w:distance",value:n===void 0?void 0:si(n)}}});class fO extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class yve extends W1{constructor(t){if(super("w:pgBorders"),!t)return this;t.pageBorders?this.root.push(new fO({display:t.pageBorders.display,offsetFrom:t.pageBorders.offsetFrom,zOrder:t.pageBorders.zOrder})):this.root.push(new fO({})),t.pageBorderTop&&this.root.push(new zr("w:top",t.pageBorderTop)),t.pageBorderLeft&&this.root.push(new zr("w:left",t.pageBorderLeft)),t.pageBorderBottom&&this.root.push(new zr("w:bottom",t.pageBorderBottom)),t.pageBorderRight&&this.root.push(new zr("w:right",t.pageBorderRight))}}class vve extends Be{constructor(t,r,n,s,a,i,o){super("w:pgMar"),this.root.push(new fp({top:{key:"w:top",value:jc(t)},right:{key:"w:right",value:si(r)},bottom:{key:"w:bottom",value:jc(n)},left:{key:"w:left",value:si(s)},header:{key:"w:header",value:si(a)},footer:{key:"w:footer",value:si(i)},gutter:{key:"w:gutter",value:si(o)}}))}}class bve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class wve extends Be{constructor({start:t,formatType:r,separator:n}){super("w:pgNumType"),this.root.push(new bve({start:t===void 0?void 0:qs(t),formatType:r,separator:n}))}}const yE={PORTRAIT:"portrait",LANDSCAPE:"landscape"},_ve=({width:e,height:t,orientation:r,code:n})=>{const s=si(e),a=si(t);return new ir({name:"w:pgSz",attributes:{width:{key:"w:w",value:r===yE.LANDSCAPE?a:s},height:{key:"w:h",value:r===yE.LANDSCAPE?s:a},orientation:{key:"w:orient",value:r},code:{key:"w:code",value:n}}})};class Eve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class Sve extends Be{constructor(t){super("w:textDirection"),this.root.push(new Eve({val:t}))}}class Nve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class Tve extends Be{constructor(t){super("w:type"),this.root.push(new Nve({val:t}))}}const bc={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},Q2={WIDTH:11906,HEIGHT:16838,ORIENTATION:yE.PORTRAIT};class kve extends Be{constructor({page:{size:{width:t=Q2.WIDTH,height:r=Q2.HEIGHT,orientation:n=Q2.ORIENTATION}={},margin:{top:s=bc.TOP,right:a=bc.RIGHT,bottom:i=bc.BOTTOM,left:o=bc.LEFT,header:c=bc.HEADER,footer:f=bc.FOOTER,gutter:h=bc.GUTTER}={},pageNumbers:p={},borders:x,textDirection:g}={},grid:{linePitch:v=360,charSpace:y,type:w}={},headerWrapperGroup:_={},footerWrapperGroup:S={},lineNumbers:E,titlePage:N,verticalAlign:k,column:O,type:R}={}){super("w:sectPr"),this.addHeaderFooterGroup(uO.HEADER,_),this.addHeaderFooterGroup(uO.FOOTER,S),R&&this.root.push(new Tve(R)),this.root.push(_ve({width:t,height:r,orientation:n})),this.root.push(new vve(s,a,i,o,c,f,h)),x&&this.root.push(new yve(x)),E&&this.root.push(gve(E)),this.root.push(new wve(p)),O&&this.root.push(new pve(O)),k&&this.root.push(new hve(k)),N!==void 0&&this.root.push(new $e("w:titlePg",N)),g&&this.root.push(new Sve(g)),this.root.push(mve({linePitch:v,charSpace:y,type:w}))}addHeaderFooterGroup(t,r){r.default&&this.root.push(new Z2(t,{type:Ef.DEFAULT,id:r.default.View.ReferenceId})),r.first&&this.root.push(new Z2(t,{type:Ef.FIRST,id:r.first.View.ReferenceId})),r.even&&this.root.push(new Z2(t,{type:Ef.EVEN,id:r.even.View.ReferenceId}))}}class Ave extends Be{constructor(){super("w:body"),Pe(this,"sections",[])}addSection(t){const r=this.sections.pop();this.root.push(this.createSectionParagraph(r)),this.sections.push(new kve(t))}prepForXml(t){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(t)}push(t){this.root.push(t)}createSectionParagraph(t){const r=new Oc({}),n=new Xf({});return n.push(t),r.addChildElement(n),r}}const dO={wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"};class Y1 extends ut{constructor(t,r){super(Dt({Ignorable:r},Object.fromEntries(t.map(n=>[n,dO[n]])))),Pe(this,"xmlKeys",Dt({Ignorable:"mc:Ignorable"},Object.fromEntries(Object.keys(dO).map(n=>[n,`xmlns:${n}`]))))}}class Cve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class Rve extends Be{constructor(t){super("w:background"),this.root.push(new Cve({color:t.color===void 0?void 0:$f(t.color),themeColor:t.themeColor,themeShade:t.themeShade===void 0?void 0:qj(t.themeShade),themeTint:t.themeTint===void 0?void 0:qj(t.themeTint)}))}}class jve extends Be{constructor(t){super("w:document"),Pe(this,"body"),this.root.push(new Y1(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps","cx","cx1","cx2","cx3","cx4","cx5","cx6","cx7","cx8","aink","am3d","w16cex","w16cid","w16","w16sdtdh","w16se"],"w14 w15 wp14")),this.body=new Ave,t.background&&this.root.push(new Rve(t.background)),this.root.push(this.body)}add(t){return this.body.push(t),this}get Body(){return this.body}}class pB{constructor(t){Pe(this,"document"),Pe(this,"relationships"),this.document=new jve(t),this.relationships=new vu}get View(){return this.document}get Relationships(){return this.relationships}}class Ove extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class Dve extends Be{constructor(){super("w:wordWrap"),this.root.push(new Ove({val:0}))}}const Ive=e=>{var t,r;return new ir({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:e.anchorLock},dropCap:{key:"w:dropCap",value:e.dropCap},width:{key:"w:w",value:e.width},height:{key:"w:h",value:e.height},x:{key:"w:x",value:e.position?e.position.x:void 0},y:{key:"w:y",value:e.position?e.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:e.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:e.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(t=e.space)==null?void 0:t.horizontal},spaceVertical:{key:"w:vSpace",value:(r=e.space)==null?void 0:r.vertical},rule:{key:"w:hRule",value:e.rule},alignmentX:{key:"w:xAlign",value:e.alignment?e.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:e.alignment?e.alignment.y:void 0},lines:{key:"w:lines",value:e.lines},wrap:{key:"w:wrap",value:e.wrap}}})};class Xf extends W1{constructor(t){var r,n;if(super("w:pPr"),Pe(this,"numberingReferences",[]),!t)return this;t.heading&&this.push(new yx(t.heading)),t.bullet&&this.push(new yx("ListParagraph")),t.numbering&&!t.style&&!t.heading&&(t.numbering.custom||this.push(new yx("ListParagraph"))),t.style&&this.push(new yx(t.style)),t.keepNext!==void 0&&this.push(new $e("w:keepNext",t.keepNext)),t.keepLines!==void 0&&this.push(new $e("w:keepLines",t.keepLines)),t.pageBreakBefore&&this.push(new Kye),t.frame&&this.push(Ive(t.frame)),t.widowControl!==void 0&&this.push(new $e("w:widowControl",t.widowControl)),t.bullet&&this.push(new J2(1,t.bullet.level)),t.numbering?(this.numberingReferences.push({reference:t.numbering.reference,instance:(r=t.numbering.instance)!=null?r:0}),this.push(new J2(`${t.numbering.reference}-${(n=t.numbering.instance)!=null?n:0}`,t.numbering.level))):t.numbering===!1&&this.push(new J2(0,0)),t.border&&this.push(new e1e(t.border)),t.thematicBreak&&this.push(new t1e),t.shading&&this.push(new QL(t.shading)),t.wordWrap&&this.push(new Dve),t.overflowPunctuation&&this.push(new $e("w:overflowPunct",t.overflowPunctuation));const s=[...t.rightTabStop!==void 0?[{type:cO.RIGHT,position:t.rightTabStop}]:[],...t.tabStops?t.tabStops:[],...t.leftTabStop!==void 0?[{type:cO.LEFT,position:t.leftTabStop}]:[]];s.length>0&&this.push(new Jye(s)),t.bidirectional!==void 0&&this.push(new $e("w:bidi",t.bidirectional)),t.spacing&&this.push(new Yye(t.spacing)),t.indent&&this.push(new r1e(t.indent)),t.contextualSpacing!==void 0&&this.push(new $e("w:contextualSpacing",t.contextualSpacing)),t.alignment&&this.push(new Zge(t.alignment)),t.outlineLevel!==void 0&&this.push(new uve(t.outlineLevel)),t.suppressLineNumbers!==void 0&&this.push(new $e("w:suppressLineNumbers",t.suppressLineNumbers)),t.autoSpaceEastAsianText!==void 0&&this.push(new $e("w:autoSpaceDN",t.autoSpaceEastAsianText)),t.run&&this.push(new yu(t.run))}push(t){this.root.push(t)}prepForXml(t){if(t.viewWrapper instanceof pB)for(const r of this.numberingReferences)t.file.Numbering.createConcreteNumberingInstance(r.reference,r.instance);return super.prepForXml(t)}}class Oc extends rve{constructor(t){if(super("w:p"),Pe(this,"properties"),typeof t=="string")return this.properties=new Xf({}),this.root.push(this.properties),this.root.push(new Ec(t)),this;if(this.properties=new Xf(t),this.root.push(this.properties),t.text&&this.root.push(new Ec(t.text)),t.children)for(const r of t.children){if(r instanceof ove){this.root.push(r.start);for(const n of r.children)this.root.push(n);this.root.push(r.end);continue}this.root.push(r)}}prepForXml(t){for(const r of this.root)if(r instanceof sve){const n=this.root.indexOf(r),s=new BN(r.options.children,L1e());t.viewWrapper.Relationships.createRelationship(s.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",r.options.link,Hye.EXTERNAL),this.root[n]=s}return super.prepForXml(t)}addRunToFront(t){return this.root.splice(1,0,t),this}}const sf={style:FN.NONE,size:0,color:"auto"},af={style:FN.SINGLE,size:4,color:"auto"};class Mve extends Be{constructor(t){super("w:tblBorders"),t.top?this.root.push(new zr("w:top",t.top)):this.root.push(new zr("w:top",af)),t.left?this.root.push(new zr("w:left",t.left)):this.root.push(new zr("w:left",af)),t.bottom?this.root.push(new zr("w:bottom",t.bottom)):this.root.push(new zr("w:bottom",af)),t.right?this.root.push(new zr("w:right",t.right)):this.root.push(new zr("w:right",af)),t.insideHorizontal?this.root.push(new zr("w:insideH",t.insideHorizontal)):this.root.push(new zr("w:insideH",af)),t.insideVertical?this.root.push(new zr("w:insideV",t.insideVertical)):this.root.push(new zr("w:insideV",af))}}Pe(Mve,"NONE",{top:sf,bottom:sf,left:sf,right:sf,insideHorizontal:sf,insideVertical:sf});class Fve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class Pve extends Be{constructor(){super("Properties"),this.root.push(new Fve({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class Lve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns"})}}class Bve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class xo extends Be{constructor(t,r){super("Default"),this.root.push(new Bve({contentType:t,extension:r}))}}class Uve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class Ta extends Be{constructor(t,r){super("Override"),this.root.push(new Uve({contentType:t,partName:r}))}}class zve extends Be{constructor(){super("Types"),this.root.push(new Lve({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new xo("image/png","png")),this.root.push(new xo("image/jpeg","jpeg")),this.root.push(new xo("image/jpeg","jpg")),this.root.push(new xo("image/bmp","bmp")),this.root.push(new xo("image/gif","gif")),this.root.push(new xo("image/svg+xml","svg")),this.root.push(new xo("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new xo("application/xml","xml")),this.root.push(new xo("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new Ta("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(t){this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${t}.xml`))}addHeader(t){this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${t}.xml`))}}class Hve extends Be{constructor(t){super("cp:coreProperties"),this.root.push(new Y1(["cp","dc","dcterms","dcmitype","xsi"])),t.title&&this.root.push(new yc("dc:title",t.title)),t.subject&&this.root.push(new yc("dc:subject",t.subject)),t.creator&&this.root.push(new yc("dc:creator",t.creator)),t.keywords&&this.root.push(new yc("cp:keywords",t.keywords)),t.description&&this.root.push(new yc("dc:description",t.description)),t.lastModifiedBy&&this.root.push(new yc("cp:lastModifiedBy",t.lastModifiedBy)),t.revision&&this.root.push(new yc("cp:revision",String(t.revision))),this.root.push(new hO("dcterms:created")),this.root.push(new hO("dcterms:modified"))}}class Vve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"xsi:type"})}}class hO extends Be{constructor(t){super(t),this.root.push(new Vve({type:"dcterms:W3CDTF"})),this.root.push(Yge(new Date))}}class qve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class Wve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class $ve extends Be{constructor(t,r){super("property"),this.root.push(new Wve({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t.toString(),name:r.name})),this.root.push(new Gve(r.value))}}class Gve extends Be{constructor(t){super("vt:lpwstr"),this.root.push(t)}}class Kve extends Be{constructor(t){super("Properties"),Pe(this,"nextId"),Pe(this,"properties",[]),this.root.push(new qve({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const r of t)this.addCustomProperty(r)}prepForXml(t){return this.properties.forEach(r=>this.root.push(r)),super.prepForXml(t)}addCustomProperty(t){this.properties.push(new $ve(this.nextId++,t))}}const vx=({id:e,fontKey:t,subsetted:r},n)=>new ir({name:n,attributes:Dt({id:{key:"r:id",value:e}},t?{fontKey:{key:"w:fontKey",value:`{${t}}`}}:{}),children:[...r?[new $e("w:subsetted",r)]:[]]}),Xve=({name:e,altName:t,panose1:r,charset:n,family:s,notTrueType:a,pitch:i,sig:o,embedRegular:c,embedBold:f,embedItalic:h,embedBoldItalic:p})=>new ir({name:"w:font",attributes:{name:{key:"w:name",value:e}},children:[...t?[vh("w:altName",t)]:[],...r?[vh("w:panose1",r)]:[],...n?[vh("w:charset",n)]:[],vh("w:family",s),...a?[new $e("w:notTrueType",a)]:[],vh("w:pitch",i),...o?[new ir({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:o.usb0},usb1:{key:"w:usb1",value:o.usb1},usb2:{key:"w:usb2",value:o.usb2},usb3:{key:"w:usb3",value:o.usb3},csb0:{key:"w:csb0",value:o.csb0},csb1:{key:"w:csb1",value:o.csb1}}})]:[],...c?[vx(c,"w:embedRegular")]:[],...f?[vx(f,"w:embedBold")]:[],...h?[vx(h,"w:embedItalic")]:[],...p?[vx(p,"w:embedBoldItalic")]:[]]}),Yve=({name:e,index:t,fontKey:r,characterSet:n})=>Xve({name:e,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:n,family:"auto",pitch:"variable",embedRegular:{fontKey:r,id:`rId${t}`}}),Jve=e=>new ir({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:e.map((t,r)=>Yve({name:t.name,index:r+1,fontKey:t.fontKey}))});class Zve{constructor(t){Pe(this,"fontTable"),Pe(this,"relationships"),Pe(this,"fontOptionsWithKey",[]),this.options=t,this.fontOptionsWithKey=t.map(r=>Lo(Dt({},r),{fontKey:B1e()})),this.fontTable=Jve(this.fontOptionsWithKey),this.relationships=new vu;for(let r=0;r<t.length;r++)this.relationships.createRelationship(r+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${t[r].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class Qve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let ebe=class extends XL{constructor(t,r){super("w:ftr",r),Pe(this,"refId"),this.refId=t,r||this.root.push(new Qve({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class tbe{constructor(t,r,n){Pe(this,"footer"),Pe(this,"relationships"),this.media=t,this.footer=new ebe(r,n),this.relationships=new vu}add(t){this.footer.add(t)}addChildElement(t){this.footer.addChildElement(t)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class rbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class nbe extends Be{constructor(){super("w:footnoteRef")}}class sbe extends mp{constructor(){super({style:"FootnoteReference"}),this.root.push(new nbe)}}const pO={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class e_ extends Be{constructor(t){super("w:footnote"),this.root.push(new rbe({type:t.type,id:t.id}));for(let r=0;r<t.children.length;r++){const n=t.children[r];r===0&&n.addRunToFront(new sbe),this.root.push(n)}}}class abe extends Be{constructor(){super("w:continuationSeparator")}}class ibe extends mp{constructor(){super({}),this.root.push(new abe)}}class obe extends Be{constructor(){super("w:separator")}}class lbe extends mp{constructor(){super({}),this.root.push(new obe)}}class cbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class ube extends Be{constructor(){super("w:footnotes"),this.root.push(new cbe({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new e_({id:-1,type:pO.SEPERATOR,children:[new Oc({spacing:{after:0,line:240,lineRule:gE.AUTO},children:[new lbe]})]});this.root.push(t);const r=new e_({id:0,type:pO.CONTINUATION_SEPERATOR,children:[new Oc({spacing:{after:0,line:240,lineRule:gE.AUTO},children:[new ibe]})]});this.root.push(r)}createFootNote(t,r){const n=new e_({id:t,children:r});this.root.push(n)}}class fbe{constructor(){Pe(this,"footnotess"),Pe(this,"relationships"),this.footnotess=new ube,this.relationships=new vu}get View(){return this.footnotess}get Relationships(){return this.relationships}}class dbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let hbe=class extends XL{constructor(t,r){super("w:hdr",r),Pe(this,"refId"),this.refId=t,r||this.root.push(new dbe({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class pbe{constructor(t,r,n){Pe(this,"header"),Pe(this,"relationships"),this.media=t,this.header=new hbe(r,n),this.relationships=new vu}add(t){return this.header.add(t),this}addChildElement(t){this.header.addChildElement(t)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class mbe{constructor(){Pe(this,"map"),this.map=new Map}addImage(t,r){this.map.set(t,r)}get Array(){return Array.from(this.map.values())}}const go={BULLET:"bullet"};class xbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class gbe extends Be{constructor(t){super("w:numFmt"),this.root.push(new tn({val:t}))}}class ybe extends Be{constructor(t){super("w:lvlText"),this.root.push(new tn({val:t}))}}class vbe extends Be{constructor(t){super("w:lvlJc"),this.root.push(new tn({val:t}))}}class bbe extends Be{constructor(t){super("w:suff"),this.root.push(new tn({val:t}))}}class wbe extends Be{constructor(){super("w:isLgl")}}class _be extends Be{constructor({level:t,format:r,text:n,alignment:s=Oa.START,start:a=1,style:i,suffix:o,isLegalNumberingStyle:c}){if(super("w:lvl"),Pe(this,"paragraphProperties"),Pe(this,"runProperties"),this.root.push(new t0("w:start",qs(a))),r&&this.root.push(new gbe(r)),o&&this.root.push(new bbe(o)),c&&this.root.push(new wbe),n&&this.root.push(new ybe(n)),this.root.push(new vbe(s)),this.paragraphProperties=new Xf(i&&i.paragraph),this.runProperties=new yu(i&&i.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new xbe({ilvl:qs(t),tentative:1}))}}class Ebe extends _be{}class Sbe extends Be{constructor(t){super("w:multiLevelType"),this.root.push(new tn({val:t}))}}class Nbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class mO extends Be{constructor(t,r){super("w:abstractNum"),Pe(this,"id"),this.root.push(new Nbe({abstractNumId:qs(t),restartNumberingAfterBreak:0})),this.root.push(new Sbe("hybridMultilevel")),this.id=t;for(const n of r)this.root.push(new Ebe(n))}}class Tbe extends Be{constructor(t){super("w:abstractNumId"),this.root.push(new tn({val:t}))}}class kbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{numId:"w:numId"})}}class xO extends Be{constructor(t){if(super("w:num"),Pe(this,"numId"),Pe(this,"reference"),Pe(this,"instance"),this.numId=t.numId,this.reference=t.reference,this.instance=t.instance,this.root.push(new kbe({numId:qs(t.numId)})),this.root.push(new Tbe(qs(t.abstractNumId))),t.overrideLevels&&t.overrideLevels.length)for(const r of t.overrideLevels)this.root.push(new Cbe(r.num,r.start))}}class Abe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{ilvl:"w:ilvl"})}}class Cbe extends Be{constructor(t,r){super("w:lvlOverride"),this.root.push(new Abe({ilvl:t})),r!==void 0&&this.root.push(new jbe(r))}}class Rbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class jbe extends Be{constructor(t){super("w:startOverride"),this.root.push(new Rbe({val:t}))}}class Obe extends Be{constructor(t){super("w:numbering"),Pe(this,"abstractNumberingMap",new Map),Pe(this,"concreteNumberingMap",new Map),Pe(this,"referenceConfigMap",new Map),Pe(this,"abstractNumUniqueNumericId",I1e()),Pe(this,"concreteNumUniqueNumericId",M1e()),this.root.push(new Y1(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps"],"w14 w15 wp14"));const r=new mO(this.abstractNumUniqueNumericId(),[{level:0,format:go.BULLET,text:"",alignment:Oa.LEFT,style:{paragraph:{indent:{left:ri(.5),hanging:ri(.25)}}}},{level:1,format:go.BULLET,text:"",alignment:Oa.LEFT,style:{paragraph:{indent:{left:ri(1),hanging:ri(.25)}}}},{level:2,format:go.BULLET,text:"",alignment:Oa.LEFT,style:{paragraph:{indent:{left:2160,hanging:ri(.25)}}}},{level:3,format:go.BULLET,text:"",alignment:Oa.LEFT,style:{paragraph:{indent:{left:2880,hanging:ri(.25)}}}},{level:4,format:go.BULLET,text:"",alignment:Oa.LEFT,style:{paragraph:{indent:{left:3600,hanging:ri(.25)}}}},{level:5,format:go.BULLET,text:"",alignment:Oa.LEFT,style:{paragraph:{indent:{left:4320,hanging:ri(.25)}}}},{level:6,format:go.BULLET,text:"",alignment:Oa.LEFT,style:{paragraph:{indent:{left:5040,hanging:ri(.25)}}}},{level:7,format:go.BULLET,text:"",alignment:Oa.LEFT,style:{paragraph:{indent:{left:5760,hanging:ri(.25)}}}},{level:8,format:go.BULLET,text:"",alignment:Oa.LEFT,style:{paragraph:{indent:{left:6480,hanging:ri(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new xO({numId:1,abstractNumId:r.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",r);for(const n of t.config)this.abstractNumberingMap.set(n.reference,new mO(this.abstractNumUniqueNumericId(),n.levels)),this.referenceConfigMap.set(n.reference,n.levels)}prepForXml(t){for(const r of this.abstractNumberingMap.values())this.root.push(r);for(const r of this.concreteNumberingMap.values())this.root.push(r);return super.prepForXml(t)}createConcreteNumberingInstance(t,r){const n=this.abstractNumberingMap.get(t);if(!n)return;const s=`${t}-${r}`;if(this.concreteNumberingMap.has(s))return;const a=this.referenceConfigMap.get(t),i=a&&a[0].start,o={numId:this.concreteNumUniqueNumericId(),abstractNumId:n.id,reference:t,instance:r,overrideLevels:[i&&Number.isInteger(i)?{num:0,start:i}:{num:0,start:1}]};this.concreteNumberingMap.set(s,new xO(o))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class Dbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class Ibe extends Be{constructor(t){super("w:compatSetting"),this.root.push(new Dbe({version:t,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class Mbe extends Be{constructor(t){super("w:compat"),t.version&&this.root.push(new Ibe(t.version)),t.useSingleBorderforContiguousCells&&this.root.push(new $e("w:useSingleBorderforContiguousCells",t.useSingleBorderforContiguousCells)),t.wordPerfectJustification&&this.root.push(new $e("w:wpJustification",t.wordPerfectJustification)),t.noTabStopForHangingIndent&&this.root.push(new $e("w:noTabHangInd",t.noTabStopForHangingIndent)),t.noLeading&&this.root.push(new $e("w:noLeading",t.noLeading)),t.spaceForUnderline&&this.root.push(new $e("w:spaceForUL",t.spaceForUnderline)),t.noColumnBalance&&this.root.push(new $e("w:noColumnBalance",t.noColumnBalance)),t.balanceSingleByteDoubleByteWidth&&this.root.push(new $e("w:balanceSingleByteDoubleByteWidth",t.balanceSingleByteDoubleByteWidth)),t.noExtraLineSpacing&&this.root.push(new $e("w:noExtraLineSpacing",t.noExtraLineSpacing)),t.doNotLeaveBackslashAlone&&this.root.push(new $e("w:doNotLeaveBackslashAlone",t.doNotLeaveBackslashAlone)),t.underlineTrailingSpaces&&this.root.push(new $e("w:ulTrailSpace",t.underlineTrailingSpaces)),t.doNotExpandShiftReturn&&this.root.push(new $e("w:doNotExpandShiftReturn",t.doNotExpandShiftReturn)),t.spacingInWholePoints&&this.root.push(new $e("w:spacingInWholePoints",t.spacingInWholePoints)),t.lineWrapLikeWord6&&this.root.push(new $e("w:lineWrapLikeWord6",t.lineWrapLikeWord6)),t.printBodyTextBeforeHeader&&this.root.push(new $e("w:printBodyTextBeforeHeader",t.printBodyTextBeforeHeader)),t.printColorsBlack&&this.root.push(new $e("w:printColBlack",t.printColorsBlack)),t.spaceWidth&&this.root.push(new $e("w:wpSpaceWidth",t.spaceWidth)),t.showBreaksInFrames&&this.root.push(new $e("w:showBreaksInFrames",t.showBreaksInFrames)),t.subFontBySize&&this.root.push(new $e("w:subFontBySize",t.subFontBySize)),t.suppressBottomSpacing&&this.root.push(new $e("w:suppressBottomSpacing",t.suppressBottomSpacing)),t.suppressTopSpacing&&this.root.push(new $e("w:suppressTopSpacing",t.suppressTopSpacing)),t.suppressSpacingAtTopOfPage&&this.root.push(new $e("w:suppressSpacingAtTopOfPage",t.suppressSpacingAtTopOfPage)),t.suppressTopSpacingWP&&this.root.push(new $e("w:suppressTopSpacingWP",t.suppressTopSpacingWP)),t.suppressSpBfAfterPgBrk&&this.root.push(new $e("w:suppressSpBfAfterPgBrk",t.suppressSpBfAfterPgBrk)),t.swapBordersFacingPages&&this.root.push(new $e("w:swapBordersFacingPages",t.swapBordersFacingPages)),t.convertMailMergeEsc&&this.root.push(new $e("w:convMailMergeEsc",t.convertMailMergeEsc)),t.truncateFontHeightsLikeWP6&&this.root.push(new $e("w:truncateFontHeightsLikeWP6",t.truncateFontHeightsLikeWP6)),t.macWordSmallCaps&&this.root.push(new $e("w:mwSmallCaps",t.macWordSmallCaps)),t.usePrinterMetrics&&this.root.push(new $e("w:usePrinterMetrics",t.usePrinterMetrics)),t.doNotSuppressParagraphBorders&&this.root.push(new $e("w:doNotSuppressParagraphBorders",t.doNotSuppressParagraphBorders)),t.wrapTrailSpaces&&this.root.push(new $e("w:wrapTrailSpaces",t.wrapTrailSpaces)),t.footnoteLayoutLikeWW8&&this.root.push(new $e("w:footnoteLayoutLikeWW8",t.footnoteLayoutLikeWW8)),t.shapeLayoutLikeWW8&&this.root.push(new $e("w:shapeLayoutLikeWW8",t.shapeLayoutLikeWW8)),t.alignTablesRowByRow&&this.root.push(new $e("w:alignTablesRowByRow",t.alignTablesRowByRow)),t.forgetLastTabAlignment&&this.root.push(new $e("w:forgetLastTabAlignment",t.forgetLastTabAlignment)),t.adjustLineHeightInTable&&this.root.push(new $e("w:adjustLineHeightInTable",t.adjustLineHeightInTable)),t.autoSpaceLikeWord95&&this.root.push(new $e("w:autoSpaceLikeWord95",t.autoSpaceLikeWord95)),t.noSpaceRaiseLower&&this.root.push(new $e("w:noSpaceRaiseLower",t.noSpaceRaiseLower)),t.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new $e("w:doNotUseHTMLParagraphAutoSpacing",t.doNotUseHTMLParagraphAutoSpacing)),t.layoutRawTableWidth&&this.root.push(new $e("w:layoutRawTableWidth",t.layoutRawTableWidth)),t.layoutTableRowsApart&&this.root.push(new $e("w:layoutTableRowsApart",t.layoutTableRowsApart)),t.useWord97LineBreakRules&&this.root.push(new $e("w:useWord97LineBreakRules",t.useWord97LineBreakRules)),t.doNotBreakWrappedTables&&this.root.push(new $e("w:doNotBreakWrappedTables",t.doNotBreakWrappedTables)),t.doNotSnapToGridInCell&&this.root.push(new $e("w:doNotSnapToGridInCell",t.doNotSnapToGridInCell)),t.selectFieldWithFirstOrLastCharacter&&this.root.push(new $e("w:selectFldWithFirstOrLastChar",t.selectFieldWithFirstOrLastCharacter)),t.applyBreakingRules&&this.root.push(new $e("w:applyBreakingRules",t.applyBreakingRules)),t.doNotWrapTextWithPunctuation&&this.root.push(new $e("w:doNotWrapTextWithPunct",t.doNotWrapTextWithPunctuation)),t.doNotUseEastAsianBreakRules&&this.root.push(new $e("w:doNotUseEastAsianBreakRules",t.doNotUseEastAsianBreakRules)),t.useWord2002TableStyleRules&&this.root.push(new $e("w:useWord2002TableStyleRules",t.useWord2002TableStyleRules)),t.growAutofit&&this.root.push(new $e("w:growAutofit",t.growAutofit)),t.useFELayout&&this.root.push(new $e("w:useFELayout",t.useFELayout)),t.useNormalStyleForList&&this.root.push(new $e("w:useNormalStyleForList",t.useNormalStyleForList)),t.doNotUseIndentAsNumberingTabStop&&this.root.push(new $e("w:doNotUseIndentAsNumberingTabStop",t.doNotUseIndentAsNumberingTabStop)),t.useAlternateEastAsianLineBreakRules&&this.root.push(new $e("w:useAltKinsokuLineBreakRules",t.useAlternateEastAsianLineBreakRules)),t.allowSpaceOfSameStyleInTable&&this.root.push(new $e("w:allowSpaceOfSameStyleInTable",t.allowSpaceOfSameStyleInTable)),t.doNotSuppressIndentation&&this.root.push(new $e("w:doNotSuppressIndentation",t.doNotSuppressIndentation)),t.doNotAutofitConstrainedTables&&this.root.push(new $e("w:doNotAutofitConstrainedTables",t.doNotAutofitConstrainedTables)),t.autofitToFirstFixedWidthCell&&this.root.push(new $e("w:autofitToFirstFixedWidthCell",t.autofitToFirstFixedWidthCell)),t.underlineTabInNumberingList&&this.root.push(new $e("w:underlineTabInNumList",t.underlineTabInNumberingList)),t.displayHangulFixedWidth&&this.root.push(new $e("w:displayHangulFixedWidth",t.displayHangulFixedWidth)),t.splitPgBreakAndParaMark&&this.root.push(new $e("w:splitPgBreakAndParaMark",t.splitPgBreakAndParaMark)),t.doNotVerticallyAlignCellWithSp&&this.root.push(new $e("w:doNotVertAlignCellWithSp",t.doNotVerticallyAlignCellWithSp)),t.doNotBreakConstrainedForcedTable&&this.root.push(new $e("w:doNotBreakConstrainedForcedTable",t.doNotBreakConstrainedForcedTable)),t.ignoreVerticalAlignmentInTextboxes&&this.root.push(new $e("w:doNotVertAlignInTxbx",t.ignoreVerticalAlignmentInTextboxes)),t.useAnsiKerningPairs&&this.root.push(new $e("w:useAnsiKerningPairs",t.useAnsiKerningPairs)),t.cachedColumnBalance&&this.root.push(new $e("w:cachedColBalance",t.cachedColumnBalance))}}class Fbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class Pbe extends Be{constructor(t){var r,n,s,a,i,o,c,f;super("w:settings"),this.root.push(new Fbe({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new $e("w:displayBackgroundShape",!0)),t.trackRevisions!==void 0&&this.root.push(new $e("w:trackRevisions",t.trackRevisions)),t.evenAndOddHeaders!==void 0&&this.root.push(new $e("w:evenAndOddHeaders",t.evenAndOddHeaders)),t.updateFields!==void 0&&this.root.push(new $e("w:updateFields",t.updateFields)),t.defaultTabStop!==void 0&&this.root.push(new t0("w:defaultTabStop",t.defaultTabStop)),((r=t.hyphenation)==null?void 0:r.autoHyphenation)!==void 0&&this.root.push(new $e("w:autoHyphenation",t.hyphenation.autoHyphenation)),((n=t.hyphenation)==null?void 0:n.hyphenationZone)!==void 0&&this.root.push(new t0("w:hyphenationZone",t.hyphenation.hyphenationZone)),((s=t.hyphenation)==null?void 0:s.consecutiveHyphenLimit)!==void 0&&this.root.push(new t0("w:consecutiveHyphenLimit",t.hyphenation.consecutiveHyphenLimit)),((a=t.hyphenation)==null?void 0:a.doNotHyphenateCaps)!==void 0&&this.root.push(new $e("w:doNotHyphenateCaps",t.hyphenation.doNotHyphenateCaps)),this.root.push(new Mbe(Lo(Dt({},(i=t.compatibility)!=null?i:{}),{version:(f=(c=(o=t.compatibility)==null?void 0:o.version)!=null?c:t.compatibilityModeVersion)!=null?f:15})))}}class mB extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class Lbe extends Be{constructor(t){super("w:name"),this.root.push(new mB({val:t}))}}class Bbe extends Be{constructor(t){super("w:uiPriority"),this.root.push(new mB({val:qs(t)}))}}class Ube extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class xB extends Be{constructor(t,r){super("w:style"),this.root.push(new Ube(t)),r.name&&this.root.push(new Lbe(r.name)),r.basedOn&&this.root.push(new _f("w:basedOn",r.basedOn)),r.next&&this.root.push(new _f("w:next",r.next)),r.link&&this.root.push(new _f("w:link",r.link)),r.uiPriority!==void 0&&this.root.push(new Bbe(r.uiPriority)),r.semiHidden!==void 0&&this.root.push(new $e("w:semiHidden",r.semiHidden)),r.unhideWhenUsed!==void 0&&this.root.push(new $e("w:unhideWhenUsed",r.unhideWhenUsed)),r.quickFormat!==void 0&&this.root.push(new $e("w:qFormat",r.quickFormat))}}class J1 extends xB{constructor(t){super({type:"paragraph",styleId:t.id},t),Pe(this,"paragraphProperties"),Pe(this,"runProperties"),this.paragraphProperties=new Xf(t.paragraph),this.runProperties=new yu(t.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class Z1 extends xB{constructor(t){super({type:"character",styleId:t.id},Dt({uiPriority:99,unhideWhenUsed:!0},t)),Pe(this,"runProperties"),this.runProperties=new yu(t.run),this.root.push(this.runProperties)}}class Ql extends J1{constructor(t){super(Dt({basedOn:"Normal",next:"Normal",quickFormat:!0},t))}}class zbe extends Ql{constructor(t){super(Dt({id:"Title",name:"Title"},t))}}class Hbe extends Ql{constructor(t){super(Dt({id:"Heading1",name:"Heading 1"},t))}}class Vbe extends Ql{constructor(t){super(Dt({id:"Heading2",name:"Heading 2"},t))}}class qbe extends Ql{constructor(t){super(Dt({id:"Heading3",name:"Heading 3"},t))}}class Wbe extends Ql{constructor(t){super(Dt({id:"Heading4",name:"Heading 4"},t))}}class $be extends Ql{constructor(t){super(Dt({id:"Heading5",name:"Heading 5"},t))}}class Gbe extends Ql{constructor(t){super(Dt({id:"Heading6",name:"Heading 6"},t))}}class Kbe extends Ql{constructor(t){super(Dt({id:"Strong",name:"Strong"},t))}}class Xbe extends J1{constructor(t){super(Dt({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},t))}}class Ybe extends J1{constructor(t){super(Dt({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:gE.AUTO}},run:{size:20}},t))}}class Jbe extends Z1{constructor(t){super(Dt({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},t))}}class Zbe extends Z1{constructor(t){super(Dt({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},t))}}class Qbe extends Z1{constructor(t){super(Dt({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:tB.SINGLE}}},t))}}class vE extends Be{constructor(t){if(super("w:styles"),t.initialStyles&&this.root.push(t.initialStyles),t.importedStyles)for(const r of t.importedStyles)this.root.push(r);if(t.paragraphStyles)for(const r of t.paragraphStyles)this.root.push(new J1(r));if(t.characterStyles)for(const r of t.characterStyles)this.root.push(new Z1(r))}}class ewe extends Be{constructor(t){super("w:pPrDefault"),this.root.push(new Xf(t))}}class twe extends Be{constructor(t){super("w:rPrDefault"),this.root.push(new yu(t))}}class rwe extends Be{constructor(t){super("w:docDefaults"),Pe(this,"runPropertiesDefaults"),Pe(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new twe(t.run),this.paragraphPropertiesDefaults=new ewe(t.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class nwe{newInstance(t){const r=KL.xml2js(t,{compact:!1});let n;for(const i of r.elements||[])i.name==="w:styles"&&(n=i);if(n===void 0)throw new Error("can not find styles element");const s=n.elements||[];return new vE({initialStyles:new $ge(n.attributes),importedStyles:s.map(i=>MN(i))})}}class gO{newInstance(t={}){var r;return{initialStyles:new Y1(["mc","r","w","w14","w15"],"w14 w15"),importedStyles:[new rwe((r=t.document)!=null?r:{}),new zbe(Dt({run:{size:56}},t.title)),new Hbe(Dt({run:{color:"2E74B5",size:32}},t.heading1)),new Vbe(Dt({run:{color:"2E74B5",size:26}},t.heading2)),new qbe(Dt({run:{color:"1F4D78",size:24}},t.heading3)),new Wbe(Dt({run:{color:"2E74B5",italics:!0}},t.heading4)),new $be(Dt({run:{color:"2E74B5"}},t.heading5)),new Gbe(Dt({run:{color:"1F4D78"}},t.heading6)),new Kbe(Dt({run:{bold:!0}},t.strong)),new Xbe(t.listParagraph||{}),new Qbe(t.hyperlink||{}),new Jbe(t.footnoteReference||{}),new Ybe(t.footnoteText||{}),new Zbe(t.footnoteTextChar||{})]}}}let swe=class{constructor(t){Pe(this,"currentRelationshipId",1),Pe(this,"documentWrapper"),Pe(this,"headers",[]),Pe(this,"footers",[]),Pe(this,"coreProperties"),Pe(this,"numbering"),Pe(this,"media"),Pe(this,"fileRelationships"),Pe(this,"footnotesWrapper"),Pe(this,"settings"),Pe(this,"contentTypes"),Pe(this,"customProperties"),Pe(this,"appProperties"),Pe(this,"styles"),Pe(this,"comments"),Pe(this,"fontWrapper");var r,n,s,a,i,o,c,f,h,p,x,g;if(this.coreProperties=new Hve(Lo(Dt({},t),{creator:(r=t.creator)!=null?r:"Un-named",revision:(n=t.revision)!=null?n:1,lastModifiedBy:(s=t.lastModifiedBy)!=null?s:"Un-named"})),this.numbering=new Obe(t.numbering?t.numbering:{config:[]}),this.comments=new Gye((a=t.comments)!=null?a:{children:[]}),this.fileRelationships=new vu,this.customProperties=new Kve((i=t.customProperties)!=null?i:[]),this.appProperties=new Pve,this.footnotesWrapper=new fbe,this.contentTypes=new zve,this.documentWrapper=new pB({background:t.background}),this.settings=new Pbe({compatibilityModeVersion:t.compatabilityModeVersion,compatibility:t.compatibility,evenAndOddHeaders:!!t.evenAndOddHeaderAndFooters,trackRevisions:(o=t.features)==null?void 0:o.trackRevisions,updateFields:(c=t.features)==null?void 0:c.updateFields,defaultTabStop:t.defaultTabStop,hyphenation:{autoHyphenation:(f=t.hyphenation)==null?void 0:f.autoHyphenation,hyphenationZone:(h=t.hyphenation)==null?void 0:h.hyphenationZone,consecutiveHyphenLimit:(p=t.hyphenation)==null?void 0:p.consecutiveHyphenLimit,doNotHyphenateCaps:(x=t.hyphenation)==null?void 0:x.doNotHyphenateCaps}}),this.media=new mbe,t.externalStyles!==void 0){const v=new nwe;this.styles=v.newInstance(t.externalStyles)}else if(t.styles){const y=new gO().newInstance(t.styles.default);this.styles=new vE(Dt(Dt({},y),t.styles))}else{const v=new gO;this.styles=new vE(v.newInstance())}this.addDefaultRelationships();for(const v of t.sections)this.addSection(v);if(t.footnotes)for(const v in t.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(v),t.footnotes[v].children);this.fontWrapper=new Zve((g=t.fonts)!=null?g:[])}addSection({headers:t={},footers:r={},children:n,properties:s}){this.documentWrapper.View.Body.addSection(Lo(Dt({},s),{headerWrapperGroup:{default:t.default?this.createHeader(t.default):void 0,first:t.first?this.createHeader(t.first):void 0,even:t.even?this.createHeader(t.even):void 0},footerWrapperGroup:{default:r.default?this.createFooter(r.default):void 0,first:r.first?this.createFooter(r.first):void 0,even:r.even?this.createFooter(r.even):void 0}}));for(const a of n)this.documentWrapper.View.add(a)}createHeader(t){const r=new pbe(this.media,this.currentRelationshipId++);for(const n of t.options.children)r.add(n);return this.addHeaderToDocument(r),r}createFooter(t){const r=new tbe(this.media,this.currentRelationshipId++);for(const n of t.options.children)r.add(n);return this.addFooterToDocument(r),r}addHeaderToDocument(t,r=Ef.DEFAULT){this.headers.push({header:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(t,r=Ef.DEFAULT){this.footers.push({footer:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(t=>t.header)}get Footers(){return this.footers.map(t=>t.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}};var awe=ON();function bx(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var t_={exports:{}},yO;function iwe(){return yO||(yO=1,(function(e,t){(function(r){e.exports=r()})(function(){return(function r(n,s,a){function i(f,h){if(!s[f]){if(!n[f]){var p=typeof bx=="function"&&bx;if(!h&&p)return p(f,!0);if(o)return o(f,!0);var x=new Error("Cannot find module '"+f+"'");throw x.code="MODULE_NOT_FOUND",x}var g=s[f]={exports:{}};n[f][0].call(g.exports,function(v){var y=n[f][1][v];return i(y||v)},g,g.exports,r,n,s,a)}return s[f].exports}for(var o=typeof bx=="function"&&bx,c=0;c<a.length;c++)i(a[c]);return i})({1:[function(r,n,s){var a=r("./utils"),i=r("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(c){for(var f,h,p,x,g,v,y,w=[],_=0,S=c.length,E=S,N=a.getTypeOf(c)!=="string";_<c.length;)E=S-_,p=N?(f=c[_++],h=_<S?c[_++]:0,_<S?c[_++]:0):(f=c.charCodeAt(_++),h=_<S?c.charCodeAt(_++):0,_<S?c.charCodeAt(_++):0),x=f>>2,g=(3&f)<<4|h>>4,v=1<E?(15&h)<<2|p>>6:64,y=2<E?63&p:64,w.push(o.charAt(x)+o.charAt(g)+o.charAt(v)+o.charAt(y));return w.join("")},s.decode=function(c){var f,h,p,x,g,v,y=0,w=0,_="data:";if(c.substr(0,_.length)===_)throw new Error("Invalid base64 input, it looks like a data url.");var S,E=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===o.charAt(64)&&E--,c.charAt(c.length-2)===o.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=i.uint8array?new Uint8Array(0|E):new Array(0|E);y<c.length;)f=o.indexOf(c.charAt(y++))<<2|(x=o.indexOf(c.charAt(y++)))>>4,h=(15&x)<<4|(g=o.indexOf(c.charAt(y++)))>>2,p=(3&g)<<6|(v=o.indexOf(c.charAt(y++))),S[w++]=f,g!==64&&(S[w++]=h),v!==64&&(S[w++]=p);return S}},{"./support":30,"./utils":32}],2:[function(r,n,s){var a=r("./external"),i=r("./stream/DataWorker"),o=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function f(h,p,x,g,v){this.compressedSize=h,this.uncompressedSize=p,this.crc32=x,this.compression=g,this.compressedContent=v}f.prototype={getContentWorker:function(){var h=new i(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),p=this;return h.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new i(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(h,p,x){return h.pipe(new o).pipe(new c("uncompressedSize")).pipe(p.compressWorker(x)).pipe(new c("compressedSize")).withStreamInfo("compression",p)},n.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,s){var a=r("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},s.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,s){var a=r("./utils"),i=(function(){for(var o,c=[],f=0;f<256;f++){o=f;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;c[f]=o}return c})();n.exports=function(o,c){return o!==void 0&&o.length?a.getTypeOf(o)!=="string"?(function(f,h,p,x){var g=i,v=x+p;f^=-1;for(var y=x;y<v;y++)f=f>>>8^g[255&(f^h[y])];return-1^f})(0|c,o,o.length,0):(function(f,h,p,x){var g=i,v=x+p;f^=-1;for(var y=x;y<v;y++)f=f>>>8^g[255&(f^h.charCodeAt(y))];return-1^f})(0|c,o,o.length,0):0}},{"./utils":32}],5:[function(r,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(r,n,s){var a=null;a=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:a}},{lie:37}],7:[function(r,n,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=r("pako"),o=r("./utils"),c=r("./stream/GenericWorker"),f=a?"uint8array":"array";function h(p,x){c.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=x,this.meta={}}s.magic="\b\0",o.inherits(h,c),h.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(f,p.data),!1)},h.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(x){p.push({data:x,meta:p.meta})}},s.compressWorker=function(p){return new h("Deflate",p)},s.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,s){function a(g,v){var y,w="";for(y=0;y<v;y++)w+=String.fromCharCode(255&g),g>>>=8;return w}function i(g,v,y,w,_,S){var E,N,k=g.file,O=g.compression,R=S!==f.utf8encode,V=o.transformTo("string",S(k.name)),I=o.transformTo("string",f.utf8encode(k.name)),Z=k.comment,ce=o.transformTo("string",S(Z)),F=o.transformTo("string",f.utf8encode(Z)),X=I.length!==k.name.length,P=F.length!==Z.length,ie="",te="",Y="",ve=k.dir,oe=k.date,Ee={crc32:0,compressedSize:0,uncompressedSize:0};v&&!y||(Ee.crc32=g.crc32,Ee.compressedSize=g.compressedSize,Ee.uncompressedSize=g.uncompressedSize);var K=0;v&&(K|=8),R||!X&&!P||(K|=2048);var D=0,q=0;ve&&(D|=16),_==="UNIX"?(q=798,D|=(function(J,re){var U=J;return J||(U=re?16893:33204),(65535&U)<<16})(k.unixPermissions,ve)):(q=20,D|=(function(J){return 63&(J||0)})(k.dosPermissions)),E=oe.getUTCHours(),E<<=6,E|=oe.getUTCMinutes(),E<<=5,E|=oe.getUTCSeconds()/2,N=oe.getUTCFullYear()-1980,N<<=4,N|=oe.getUTCMonth()+1,N<<=5,N|=oe.getUTCDate(),X&&(te=a(1,1)+a(h(V),4)+I,ie+="up"+a(te.length,2)+te),P&&(Y=a(1,1)+a(h(ce),4)+F,ie+="uc"+a(Y.length,2)+Y);var W="";return W+=`
\0`,W+=a(K,2),W+=O.magic,W+=a(E,2),W+=a(N,2),W+=a(Ee.crc32,4),W+=a(Ee.compressedSize,4),W+=a(Ee.uncompressedSize,4),W+=a(V.length,2),W+=a(ie.length,2),{fileRecord:p.LOCAL_FILE_HEADER+W+V+ie,dirRecord:p.CENTRAL_FILE_HEADER+a(q,2)+W+a(ce.length,2)+"\0\0\0\0"+a(D,4)+a(w,4)+V+ie+ce}}var o=r("../utils"),c=r("../stream/GenericWorker"),f=r("../utf8"),h=r("../crc32"),p=r("../signature");function x(g,v,y,w){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=y,this.encodeFileName=w,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(x,c),x.prototype.push=function(g){var v=g.meta.percent||0,y=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,c.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:y?(v+100*(y-w-1))/y:100}}))},x.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var v=this.streamFiles&&!g.file.dir;if(v){var y=i(g,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(g){this.accumulate=!1;var v=this.streamFiles&&!g.file.dir,y=i(g,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),v)this.push({data:(function(w){return p.DATA_DESCRIPTOR+a(w.crc32,4)+a(w.compressedSize,4)+a(w.uncompressedSize,4)})(g),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var g=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var y=this.bytesWritten-g,w=(function(_,S,E,N,k){var O=o.transformTo("string",k(N));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(_,2)+a(_,2)+a(S,4)+a(E,4)+a(O.length,2)+O})(this.dirRecords.length,y,g,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(g){this._sources.push(g);var v=this;return g.on("data",function(y){v.processChunk(y)}),g.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),g.on("error",function(y){v.error(y)}),this},x.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},x.prototype.error=function(g){var v=this._sources;if(!c.prototype.error.call(this,g))return!1;for(var y=0;y<v.length;y++)try{v[y].error(g)}catch{}return!0},x.prototype.lock=function(){c.prototype.lock.call(this);for(var g=this._sources,v=0;v<g.length;v++)g[v].lock()},n.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,s){var a=r("../compressions"),i=r("./ZipFileWorker");s.generateWorker=function(o,c,f){var h=new i(c.streamFiles,f,c.platform,c.encodeFileName),p=0;try{o.forEach(function(x,g){p++;var v=(function(S,E){var N=S||E,k=a[N];if(!k)throw new Error(N+" is not a valid compression method !");return k})(g.options.compression,c.compression),y=g.options.compressionOptions||c.compressionOptions||{},w=g.dir,_=g.date;g._compressWorker(v,y).withStreamInfo("file",{name:x,dir:w,date:_,comment:g.comment||"",unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions}).pipe(h)}),h.entriesCount=p}catch(x){h.error(x)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,s){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new a;for(var o in this)typeof this[o]!="function"&&(i[o]=this[o]);return i}}(a.prototype=r("./object")).loadAsync=r("./load"),a.support=r("./support"),a.defaults=r("./defaults"),a.version="3.10.1",a.loadAsync=function(i,o){return new a().loadAsync(i,o)},a.external=r("./external"),n.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,s){var a=r("./utils"),i=r("./external"),o=r("./utf8"),c=r("./zipEntries"),f=r("./stream/Crc32Probe"),h=r("./nodejsUtils");function p(x){return new i.Promise(function(g,v){var y=x.decompressed.getContentWorker().pipe(new f);y.on("error",function(w){v(w)}).on("end",function(){y.streamInfo.crc32!==x.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}n.exports=function(x,g){var v=this;return g=a.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),h.isNode&&h.isStream(x)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",x,!0,g.optimizedBinaryString,g.base64).then(function(y){var w=new c(g);return w.load(y),w}).then(function(y){var w=[i.Promise.resolve(y)],_=y.files;if(g.checkCRC32)for(var S=0;S<_.length;S++)w.push(p(_[S]));return i.Promise.all(w)}).then(function(y){for(var w=y.shift(),_=w.files,S=0;S<_.length;S++){var E=_[S],N=E.fileNameStr,k=a.resolve(E.fileNameStr);v.file(k,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:g.createFolders}),E.dir||(v.file(k).unsafeOriginalName=N)}return w.zipComment.length&&(v.comment=w.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,s){var a=r("../utils"),i=r("../stream/GenericWorker");function o(c,f){i.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(f)}a.inherits(o,i),o.prototype._bindStream=function(c){var f=this;(this._stream=c).pause(),c.on("data",function(h){f.push({data:h,meta:{percent:0}})}).on("error",function(h){f.isPaused?this.generatedError=h:f.error(h)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,s){var a=r("readable-stream").Readable;function i(o,c,f){a.call(this,c),this._helper=o;var h=this;o.on("data",function(p,x){h.push(p)||h._helper.pause(),f&&f(x)}).on("error",function(p){h.emit("error",p)}).on("end",function(){h.push(null)})}r("../utils").inherits(i,a),i.prototype._read=function(){this._helper.resume()},n.exports=i},{"../utils":32,"readable-stream":16}],14:[function(r,n,s){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,i);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,i)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var i=new Buffer(a);return i.fill(0),i},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(r,n,s){function a(k,O,R){var V,I=o.getTypeOf(O),Z=o.extend(R||{},h);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(k=_(k)),Z.createFolders&&(V=w(k))&&S.call(this,V,!0);var ce=I==="string"&&Z.binary===!1&&Z.base64===!1;R&&R.binary!==void 0||(Z.binary=!ce),(O instanceof p&&O.uncompressedSize===0||Z.dir||!O||O.length===0)&&(Z.base64=!1,Z.binary=!0,O="",Z.compression="STORE",I="string");var F=null;F=O instanceof p||O instanceof c?O:v.isNode&&v.isStream(O)?new y(k,O):o.prepareContent(k,O,Z.binary,Z.optimizedBinaryString,Z.base64);var X=new x(k,F,Z);this.files[k]=X}var i=r("./utf8"),o=r("./utils"),c=r("./stream/GenericWorker"),f=r("./stream/StreamHelper"),h=r("./defaults"),p=r("./compressedObject"),x=r("./zipObject"),g=r("./generate"),v=r("./nodejsUtils"),y=r("./nodejs/NodejsStreamInputAdapter"),w=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var O=k.lastIndexOf("/");return 0<O?k.substring(0,O):""},_=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},S=function(k,O){return O=O!==void 0?O:h.createFolders,k=_(k),this.files[k]||a.call(this,k,null,{dir:!0,createFolders:O}),this.files[k]};function E(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var N={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var O,R,V;for(O in this.files)V=this.files[O],(R=O.slice(this.root.length,O.length))&&O.slice(0,this.root.length)===this.root&&k(R,V)},filter:function(k){var O=[];return this.forEach(function(R,V){k(R,V)&&O.push(V)}),O},file:function(k,O,R){if(arguments.length!==1)return k=this.root+k,a.call(this,k,O,R),this;if(E(k)){var V=k;return this.filter(function(Z,ce){return!ce.dir&&V.test(Z)})}var I=this.files[this.root+k];return I&&!I.dir?I:null},folder:function(k){if(!k)return this;if(E(k))return this.filter(function(I,Z){return Z.dir&&k.test(I)});var O=this.root+k,R=S.call(this,O),V=this.clone();return V.root=R.name,V},remove:function(k){k=this.root+k;var O=this.files[k];if(O||(k.slice(-1)!=="/"&&(k+="/"),O=this.files[k]),O&&!O.dir)delete this.files[k];else for(var R=this.filter(function(I,Z){return Z.name.slice(0,k.length)===k}),V=0;V<R.length;V++)delete this.files[R[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var O,R={};try{if((R=o.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");o.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var V=R.comment||this.comment||"";O=g.generateWorker(this,R,V)}catch(I){(O=new c("error")).error(I)}return new f(O,R.type||"string",R.mimeType)},generateAsync:function(k,O){return this.generateInternalStream(k).accumulate(O)},generateNodeStream:function(k,O){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(O)}};n.exports=N},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,s){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,s){var a=r("./DataReader");function i(o){a.call(this,o);for(var c=0;c<this.data.length;c++)o[c]=255&o[c]}r("../utils").inherits(i,a),i.prototype.byteAt=function(o){return this.data[this.zero+o]},i.prototype.lastIndexOfSignature=function(o){for(var c=o.charCodeAt(0),f=o.charCodeAt(1),h=o.charCodeAt(2),p=o.charCodeAt(3),x=this.length-4;0<=x;--x)if(this.data[x]===c&&this.data[x+1]===f&&this.data[x+2]===h&&this.data[x+3]===p)return x-this.zero;return-1},i.prototype.readAndCheckSignature=function(o){var c=o.charCodeAt(0),f=o.charCodeAt(1),h=o.charCodeAt(2),p=o.charCodeAt(3),x=this.readData(4);return c===x[0]&&f===x[1]&&h===x[2]&&p===x[3]},i.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=i},{"../utils":32,"./DataReader":18}],18:[function(r,n,s){var a=r("../utils");function i(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var c,f=0;for(this.checkOffset(o),c=this.index+o-1;c>=this.index;c--)f=(f<<8)+this.byteAt(c);return this.index+=o,f},readString:function(o){return a.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=i},{"../utils":32}],19:[function(r,n,s){var a=r("./Uint8ArrayReader");function i(o){a.call(this,o)}r("../utils").inherits(i,a),i.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,s){var a=r("./DataReader");function i(o){a.call(this,o)}r("../utils").inherits(i,a),i.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},i.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},i.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},i.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=i},{"../utils":32,"./DataReader":18}],21:[function(r,n,s){var a=r("./ArrayReader");function i(o){a.call(this,o)}r("../utils").inherits(i,a),i.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,s){var a=r("../utils"),i=r("../support"),o=r("./ArrayReader"),c=r("./StringReader"),f=r("./NodeBufferReader"),h=r("./Uint8ArrayReader");n.exports=function(p){var x=a.getTypeOf(p);return a.checkSupport(x),x!=="string"||i.uint8array?x==="nodebuffer"?new f(p):i.uint8array?new h(a.transformTo("uint8array",p)):new o(a.transformTo("array",p)):new c(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,s){var a=r("./GenericWorker"),i=r("../utils");function o(c){a.call(this,"ConvertWorker to "+c),this.destType=c}i.inherits(o,a),o.prototype.processChunk=function(c){this.push({data:i.transformTo(this.destType,c.data),meta:c.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,s){var a=r("./GenericWorker"),i=r("../crc32");function o(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(o,a),o.prototype.processChunk=function(c){this.streamInfo.crc32=i(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,s){var a=r("../utils"),i=r("./GenericWorker");function o(c){i.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}a.inherits(o,i),o.prototype.processChunk=function(c){if(c){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+c.data.length}i.prototype.processChunk.call(this,c)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,s){var a=r("../utils"),i=r("./GenericWorker");function o(c){i.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(h){f.dataIsReady=!0,f.data=h,f.max=h&&h.length||0,f.type=a.getTypeOf(h),f.isPaused||f._tickAndRepeat()},function(h){f.error(h)})}a.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,f);break;case"uint8array":c=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":c=this.data.slice(this.index,f)}return this.index=f,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,s){function a(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,o){return this._listeners[i].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,o){if(this._listeners[i])for(var c=0;c<this._listeners[i].length;c++)this._listeners[i][c].call(this,o)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var o=this;return i.on("data",function(c){o.processChunk(c)}),i.on("end",function(){o.end()}),i.on("error",function(c){o.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,o){return this.extraStreamInfo[i]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},n.exports=a},{}],29:[function(r,n,s){var a=r("../utils"),i=r("./ConvertWorker"),o=r("./GenericWorker"),c=r("../base64"),f=r("../support"),h=r("../external"),p=null;if(f.nodestream)try{p=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function x(v,y){return new h.Promise(function(w,_){var S=[],E=v._internalType,N=v._outputType,k=v._mimeType;v.on("data",function(O,R){S.push(O),y&&y(R)}).on("error",function(O){S=[],_(O)}).on("end",function(){try{var O=(function(R,V,I){switch(R){case"blob":return a.newBlob(a.transformTo("arraybuffer",V),I);case"base64":return c.encode(V);default:return a.transformTo(R,V)}})(N,(function(R,V){var I,Z=0,ce=null,F=0;for(I=0;I<V.length;I++)F+=V[I].length;switch(R){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(ce=new Uint8Array(F),I=0;I<V.length;I++)ce.set(V[I],Z),Z+=V[I].length;return ce;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+R+"'")}})(E,S),k);w(O)}catch(R){_(R)}S=[]}).resume()})}function g(v,y,w){var _=y;switch(y){case"blob":case"arraybuffer":_="uint8array";break;case"base64":_="string"}try{this._internalType=_,this._outputType=y,this._mimeType=w,a.checkSupport(_),this._worker=v.pipe(new i(_)),v.lock()}catch(S){this._worker=new o("error"),this._worker.error(S)}}g.prototype={accumulate:function(v){return x(this,v)},on:function(v,y){var w=this;return v==="data"?this._worker.on(v,function(_){y.call(w,_.data,_.meta)}):this._worker.on(v,function(){a.delay(y,arguments,w)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},v)}},n.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var a=new ArrayBuffer(0);try{s.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(a),s.blob=i.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!r("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,s){for(var a=r("./utils"),i=r("./support"),o=r("./nodejsUtils"),c=r("./stream/GenericWorker"),f=new Array(256),h=0;h<256;h++)f[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;f[254]=f[254]=1;function p(){c.call(this,"utf-8 decode"),this.leftOver=null}function x(){c.call(this,"utf-8 encode")}s.utf8encode=function(g){return i.nodebuffer?o.newBufferFrom(g,"utf-8"):(function(v){var y,w,_,S,E,N=v.length,k=0;for(S=0;S<N;S++)(64512&(w=v.charCodeAt(S)))==55296&&S+1<N&&(64512&(_=v.charCodeAt(S+1)))==56320&&(w=65536+(w-55296<<10)+(_-56320),S++),k+=w<128?1:w<2048?2:w<65536?3:4;for(y=i.uint8array?new Uint8Array(k):new Array(k),S=E=0;E<k;S++)(64512&(w=v.charCodeAt(S)))==55296&&S+1<N&&(64512&(_=v.charCodeAt(S+1)))==56320&&(w=65536+(w-55296<<10)+(_-56320),S++),w<128?y[E++]=w:(w<2048?y[E++]=192|w>>>6:(w<65536?y[E++]=224|w>>>12:(y[E++]=240|w>>>18,y[E++]=128|w>>>12&63),y[E++]=128|w>>>6&63),y[E++]=128|63&w);return y})(g)},s.utf8decode=function(g){return i.nodebuffer?a.transformTo("nodebuffer",g).toString("utf-8"):(function(v){var y,w,_,S,E=v.length,N=new Array(2*E);for(y=w=0;y<E;)if((_=v[y++])<128)N[w++]=_;else if(4<(S=f[_]))N[w++]=65533,y+=S-1;else{for(_&=S===2?31:S===3?15:7;1<S&&y<E;)_=_<<6|63&v[y++],S--;1<S?N[w++]=65533:_<65536?N[w++]=_:(_-=65536,N[w++]=55296|_>>10&1023,N[w++]=56320|1023&_)}return N.length!==w&&(N.subarray?N=N.subarray(0,w):N.length=w),a.applyFromCharCode(N)})(g=a.transformTo(i.uint8array?"uint8array":"array",g))},a.inherits(p,c),p.prototype.processChunk=function(g){var v=a.transformTo(i.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var y=v;(v=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),v.set(y,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var w=(function(S,E){var N;for((E=E||S.length)>S.length&&(E=S.length),N=E-1;0<=N&&(192&S[N])==128;)N--;return N<0||N===0?E:N+f[S[N]]>E?N:E})(v),_=v;w!==v.length&&(i.uint8array?(_=v.subarray(0,w),this.leftOver=v.subarray(w,v.length)):(_=v.slice(0,w),this.leftOver=v.slice(w,v.length))),this.push({data:s.utf8decode(_),meta:g.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=p,a.inherits(x,c),x.prototype.processChunk=function(g){this.push({data:s.utf8encode(g.data),meta:g.meta})},s.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,s){var a=r("./support"),i=r("./base64"),o=r("./nodejsUtils"),c=r("./external");function f(y){return y}function h(y,w){for(var _=0;_<y.length;++_)w[_]=255&y.charCodeAt(_);return w}r("setimmediate"),s.newBlob=function(y,w){s.checkSupport("blob");try{return new Blob([y],{type:w})}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return _.append(y),_.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(y,w,_){var S=[],E=0,N=y.length;if(N<=_)return String.fromCharCode.apply(null,y);for(;E<N;)w==="array"||w==="nodebuffer"?S.push(String.fromCharCode.apply(null,y.slice(E,Math.min(E+_,N)))):S.push(String.fromCharCode.apply(null,y.subarray(E,Math.min(E+_,N)))),E+=_;return S.join("")},stringifyByChar:function(y){for(var w="",_=0;_<y.length;_++)w+=String.fromCharCode(y[_]);return w},applyCanBeUsed:{uint8array:(function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function x(y){var w=65536,_=s.getTypeOf(y),S=!0;if(_==="uint8array"?S=p.applyCanBeUsed.uint8array:_==="nodebuffer"&&(S=p.applyCanBeUsed.nodebuffer),S)for(;1<w;)try{return p.stringifyByChunk(y,_,w)}catch{w=Math.floor(w/2)}return p.stringifyByChar(y)}function g(y,w){for(var _=0;_<y.length;_++)w[_]=y[_];return w}s.applyFromCharCode=x;var v={};v.string={string:f,array:function(y){return h(y,new Array(y.length))},arraybuffer:function(y){return v.string.uint8array(y).buffer},uint8array:function(y){return h(y,new Uint8Array(y.length))},nodebuffer:function(y){return h(y,o.allocBuffer(y.length))}},v.array={string:x,array:f,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(y)}},v.arraybuffer={string:function(y){return x(new Uint8Array(y))},array:function(y){return g(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:f,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(new Uint8Array(y))}},v.uint8array={string:x,array:function(y){return g(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:f,nodebuffer:function(y){return o.newBufferFrom(y)}},v.nodebuffer={string:x,array:function(y){return g(y,new Array(y.length))},arraybuffer:function(y){return v.nodebuffer.uint8array(y).buffer},uint8array:function(y){return g(y,new Uint8Array(y.length))},nodebuffer:f},s.transformTo=function(y,w){if(w=w||"",!y)return w;s.checkSupport(y);var _=s.getTypeOf(w);return v[_][y](w)},s.resolve=function(y){for(var w=y.split("/"),_=[],S=0;S<w.length;S++){var E=w[S];E==="."||E===""&&S!==0&&S!==w.length-1||(E===".."?_.pop():_.push(E))}return _.join("/")},s.getTypeOf=function(y){return typeof y=="string"?"string":Object.prototype.toString.call(y)==="[object Array]"?"array":a.nodebuffer&&o.isBuffer(y)?"nodebuffer":a.uint8array&&y instanceof Uint8Array?"uint8array":a.arraybuffer&&y instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(y){if(!a[y.toLowerCase()])throw new Error(y+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(y){var w,_,S="";for(_=0;_<(y||"").length;_++)S+="\\x"+((w=y.charCodeAt(_))<16?"0":"")+w.toString(16).toUpperCase();return S},s.delay=function(y,w,_){setImmediate(function(){y.apply(_||null,w||[])})},s.inherits=function(y,w){function _(){}_.prototype=w.prototype,y.prototype=new _},s.extend=function(){var y,w,_={};for(y=0;y<arguments.length;y++)for(w in arguments[y])Object.prototype.hasOwnProperty.call(arguments[y],w)&&_[w]===void 0&&(_[w]=arguments[y][w]);return _},s.prepareContent=function(y,w,_,S,E){return c.Promise.resolve(w).then(function(N){return a.blob&&(N instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(N))!==-1)&&typeof FileReader<"u"?new c.Promise(function(k,O){var R=new FileReader;R.onload=function(V){k(V.target.result)},R.onerror=function(V){O(V.target.error)},R.readAsArrayBuffer(N)}):N}).then(function(N){var k=s.getTypeOf(N);return k?(k==="arraybuffer"?N=s.transformTo("uint8array",N):k==="string"&&(E?N=i.decode(N):_&&S!==!0&&(N=(function(O){return h(O,a.uint8array?new Uint8Array(O.length):new Array(O.length))})(N))),N):c.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,s){var a=r("./reader/readerFor"),i=r("./utils"),o=r("./signature"),c=r("./zipEntry"),f=r("./support");function h(p){this.files=[],this.loadOptions=p}h.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var x=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(x)+", expected "+i.pretty(p)+")")}},isSignature:function(p,x){var g=this.reader.index;this.reader.setIndex(p);var v=this.reader.readString(4)===x;return this.reader.setIndex(g),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),x=f.uint8array?"uint8array":"array",g=i.transformTo(x,p);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,x,g,v=this.zip64EndOfCentralSize-44;0<v;)p=this.reader.readInt(2),x=this.reader.readInt(4),g=this.reader.readData(x),this.zip64ExtensibleData[p]={id:p,length:x,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,x;for(p=0;p<this.files.length;p++)x=this.files[p],this.reader.setIndex(x.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),x.readLocalPart(this.reader),x.handleUTF8(),x.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(p=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var x=p;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);var v=x-g;if(0<v)this.isSignature(x,o.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(p){this.reader=a(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,s){var a=r("./reader/readerFor"),i=r("./utils"),o=r("./compressedObject"),c=r("./crc32"),f=r("./utf8"),h=r("./compressions"),p=r("./support");function x(g,v){this.options=g,this.loadOptions=v}x.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(g){var v,y;if(g.skip(22),this.fileNameLength=g.readInt(2),y=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=(function(w){for(var _ in h)if(Object.prototype.hasOwnProperty.call(h,_)&&h[_].magic===w)return h[_];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,v,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var v=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(v),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),g==0&&(this.dosPermissions=63&this.externalFileAttributes),g==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=a(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var v,y,w,_=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<_;)v=g.readInt(2),y=g.readInt(2),w=g.readData(y),this.extraFields[v]={id:v,length:y,value:w};g.setIndex(_)},handleUTF8:function(){var g=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var y=i.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var _=i.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(_)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var v=a(g.value);return v.readInt(1)!==1||c(this.fileName)!==v.readInt(4)?null:f.utf8decode(v.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var v=a(g.value);return v.readInt(1)!==1||c(this.fileComment)!==v.readInt(4)?null:f.utf8decode(v.readData(g.length-5))}return null}},n.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,s){function a(v,y,w){this.name=v,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=y,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var i=r("./stream/StreamHelper"),o=r("./stream/DataWorker"),c=r("./utf8"),f=r("./compressedObject"),h=r("./stream/GenericWorker");a.prototype={internalStream:function(v){var y=null,w="string";try{if(!v)throw new Error("No output type specified.");var _=(w=v.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),y=this._decompressWorker();var S=!this._dataBinary;S&&!_&&(y=y.pipe(new c.Utf8EncodeWorker)),!S&&_&&(y=y.pipe(new c.Utf8DecodeWorker))}catch(E){(y=new h("error")).error(E)}return new i(y,w,"")},async:function(v,y){return this.internalStream(v).accumulate(y)},nodeStream:function(v,y){return this.internalStream(v||"nodebuffer").toNodejsStream(y)},_compressWorker:function(v,y){if(this._data instanceof f&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new c.Utf8EncodeWorker)),f.createWorkerFrom(w,v,y)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof h?this._data:new o(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],x=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<p.length;g++)a.prototype[p[g]]=x;n.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,s){(function(a){var i,o,c=a.MutationObserver||a.WebKitMutationObserver;if(c){var f=0,h=new c(v),p=a.document.createTextNode("");h.observe(p,{characterData:!0}),i=function(){p.data=f=++f%2}}else if(a.setImmediate||a.MessageChannel===void 0)i="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var y=a.document.createElement("script");y.onreadystatechange=function(){v(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},a.document.documentElement.appendChild(y)}:function(){setTimeout(v,0)};else{var x=new a.MessageChannel;x.port1.onmessage=v,i=function(){x.port2.postMessage(0)}}var g=[];function v(){var y,w;o=!0;for(var _=g.length;_;){for(w=g,g=[],y=-1;++y<_;)w[y]();_=g.length}o=!1}n.exports=function(y){g.push(y)!==1||o||i()}}).call(this,typeof Pi<"u"?Pi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,s){var a=r("immediate");function i(){}var o={},c=["REJECTED"],f=["FULFILLED"],h=["PENDING"];function p(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,_!==i&&y(this,_)}function x(_,S,E){this.promise=_,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function g(_,S,E){a(function(){var N;try{N=S(E)}catch(k){return o.reject(_,k)}N===_?o.reject(_,new TypeError("Cannot resolve promise with itself")):o.resolve(_,N)})}function v(_){var S=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof S=="function")return function(){S.apply(_,arguments)}}function y(_,S){var E=!1;function N(R){E||(E=!0,o.reject(_,R))}function k(R){E||(E=!0,o.resolve(_,R))}var O=w(function(){S(k,N)});O.status==="error"&&N(O.value)}function w(_,S){var E={};try{E.value=_(S),E.status="success"}catch(N){E.status="error",E.value=N}return E}(n.exports=p).prototype.finally=function(_){if(typeof _!="function")return this;var S=this.constructor;return this.then(function(E){return S.resolve(_()).then(function(){return E})},function(E){return S.resolve(_()).then(function(){throw E})})},p.prototype.catch=function(_){return this.then(null,_)},p.prototype.then=function(_,S){if(typeof _!="function"&&this.state===f||typeof S!="function"&&this.state===c)return this;var E=new this.constructor(i);return this.state!==h?g(E,this.state===f?_:S,this.outcome):this.queue.push(new x(E,_,S)),E},x.prototype.callFulfilled=function(_){o.resolve(this.promise,_)},x.prototype.otherCallFulfilled=function(_){g(this.promise,this.onFulfilled,_)},x.prototype.callRejected=function(_){o.reject(this.promise,_)},x.prototype.otherCallRejected=function(_){g(this.promise,this.onRejected,_)},o.resolve=function(_,S){var E=w(v,S);if(E.status==="error")return o.reject(_,E.value);var N=E.value;if(N)y(_,N);else{_.state=f,_.outcome=S;for(var k=-1,O=_.queue.length;++k<O;)_.queue[k].callFulfilled(S)}return _},o.reject=function(_,S){_.state=c,_.outcome=S;for(var E=-1,N=_.queue.length;++E<N;)_.queue[E].callRejected(S);return _},p.resolve=function(_){return _ instanceof this?_:o.resolve(new this(i),_)},p.reject=function(_){var S=new this(i);return o.reject(S,_)},p.all=function(_){var S=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=_.length,N=!1;if(!E)return this.resolve([]);for(var k=new Array(E),O=0,R=-1,V=new this(i);++R<E;)I(_[R],R);return V;function I(Z,ce){S.resolve(Z).then(function(F){k[ce]=F,++O!==E||N||(N=!0,o.resolve(V,k))},function(F){N||(N=!0,o.reject(V,F))})}},p.race=function(_){var S=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=_.length,N=!1;if(!E)return this.resolve([]);for(var k=-1,O=new this(i);++k<E;)R=_[k],S.resolve(R).then(function(V){N||(N=!0,o.resolve(O,V))},function(V){N||(N=!0,o.reject(O,V))});var R;return O}},{immediate:36}],38:[function(r,n,s){var a={};(0,r("./lib/utils/common").assign)(a,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,s){var a=r("./zlib/deflate"),i=r("./utils/common"),o=r("./utils/strings"),c=r("./zlib/messages"),f=r("./zlib/zstream"),h=Object.prototype.toString,p=0,x=-1,g=0,v=8;function y(_){if(!(this instanceof y))return new y(_);this.options=i.assign({level:x,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},_||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var E=a.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(E!==p)throw new Error(c[E]);if(S.header&&a.deflateSetHeader(this.strm,S.header),S.dictionary){var N;if(N=typeof S.dictionary=="string"?o.string2buf(S.dictionary):h.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(E=a.deflateSetDictionary(this.strm,N))!==p)throw new Error(c[E]);this._dict_set=!0}}function w(_,S){var E=new y(S);if(E.push(_,!0),E.err)throw E.msg||c[E.err];return E.result}y.prototype.push=function(_,S){var E,N,k=this.strm,O=this.options.chunkSize;if(this.ended)return!1;N=S===~~S?S:S===!0?4:0,typeof _=="string"?k.input=o.string2buf(_):h.call(_)==="[object ArrayBuffer]"?k.input=new Uint8Array(_):k.input=_,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new i.Buf8(O),k.next_out=0,k.avail_out=O),(E=a.deflate(k,N))!==1&&E!==p)return this.onEnd(E),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||N!==4&&N!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(i.shrinkBuf(k.output,k.next_out))):this.onData(i.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&E!==1);return N===4?(E=a.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===p):N!==2||(this.onEnd(p),!(k.avail_out=0))},y.prototype.onData=function(_){this.chunks.push(_)},y.prototype.onEnd=function(_){_===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},s.Deflate=y,s.deflate=w,s.deflateRaw=function(_,S){return(S=S||{}).raw=!0,w(_,S)},s.gzip=function(_,S){return(S=S||{}).gzip=!0,w(_,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,s){var a=r("./zlib/inflate"),i=r("./utils/common"),o=r("./utils/strings"),c=r("./zlib/constants"),f=r("./zlib/messages"),h=r("./zlib/zstream"),p=r("./zlib/gzheader"),x=Object.prototype.toString;function g(y){if(!(this instanceof g))return new g(y);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},y||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||y&&y.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&(15&w.windowBits)==0&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var _=a.inflateInit2(this.strm,w.windowBits);if(_!==c.Z_OK)throw new Error(f[_]);this.header=new p,a.inflateGetHeader(this.strm,this.header)}function v(y,w){var _=new g(w);if(_.push(y,!0),_.err)throw _.msg||f[_.err];return _.result}g.prototype.push=function(y,w){var _,S,E,N,k,O,R=this.strm,V=this.options.chunkSize,I=this.options.dictionary,Z=!1;if(this.ended)return!1;S=w===~~w?w:w===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof y=="string"?R.input=o.binstring2buf(y):x.call(y)==="[object ArrayBuffer]"?R.input=new Uint8Array(y):R.input=y,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new i.Buf8(V),R.next_out=0,R.avail_out=V),(_=a.inflate(R,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&I&&(O=typeof I=="string"?o.string2buf(I):x.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,_=a.inflateSetDictionary(this.strm,O)),_===c.Z_BUF_ERROR&&Z===!0&&(_=c.Z_OK,Z=!1),_!==c.Z_STREAM_END&&_!==c.Z_OK)return this.onEnd(_),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&_!==c.Z_STREAM_END&&(R.avail_in!==0||S!==c.Z_FINISH&&S!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=o.utf8border(R.output,R.next_out),N=R.next_out-E,k=o.buf2string(R.output,E),R.next_out=N,R.avail_out=V-N,N&&i.arraySet(R.output,R.output,E,N,0),this.onData(k)):this.onData(i.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(Z=!0)}while((0<R.avail_in||R.avail_out===0)&&_!==c.Z_STREAM_END);return _===c.Z_STREAM_END&&(S=c.Z_FINISH),S===c.Z_FINISH?(_=a.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===c.Z_OK):S!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(R.avail_out=0))},g.prototype.onData=function(y){this.chunks.push(y)},g.prototype.onEnd=function(y){y===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},s.Inflate=g,s.inflate=v,s.inflateRaw=function(y,w){return(w=w||{}).raw=!0,v(y,w)},s.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(c){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var h=f.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var p in h)h.hasOwnProperty(p)&&(c[p]=h[p])}}return c},s.shrinkBuf=function(c,f){return c.length===f?c:c.subarray?c.subarray(0,f):(c.length=f,c)};var i={arraySet:function(c,f,h,p,x){if(f.subarray&&c.subarray)c.set(f.subarray(h,h+p),x);else for(var g=0;g<p;g++)c[x+g]=f[h+g]},flattenChunks:function(c){var f,h,p,x,g,v;for(f=p=0,h=c.length;f<h;f++)p+=c[f].length;for(v=new Uint8Array(p),f=x=0,h=c.length;f<h;f++)g=c[f],v.set(g,x),x+=g.length;return v}},o={arraySet:function(c,f,h,p,x){for(var g=0;g<p;g++)c[x+g]=f[h+g]},flattenChunks:function(c){return[].concat.apply([],c)}};s.setTyped=function(c){c?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,i)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(a)},{}],42:[function(r,n,s){var a=r("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var c=new a.Buf8(256),f=0;f<256;f++)c[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function h(p,x){if(x<65537&&(p.subarray&&o||!p.subarray&&i))return String.fromCharCode.apply(null,a.shrinkBuf(p,x));for(var g="",v=0;v<x;v++)g+=String.fromCharCode(p[v]);return g}c[254]=c[254]=1,s.string2buf=function(p){var x,g,v,y,w,_=p.length,S=0;for(y=0;y<_;y++)(64512&(g=p.charCodeAt(y)))==55296&&y+1<_&&(64512&(v=p.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),y++),S+=g<128?1:g<2048?2:g<65536?3:4;for(x=new a.Buf8(S),y=w=0;w<S;y++)(64512&(g=p.charCodeAt(y)))==55296&&y+1<_&&(64512&(v=p.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),y++),g<128?x[w++]=g:(g<2048?x[w++]=192|g>>>6:(g<65536?x[w++]=224|g>>>12:(x[w++]=240|g>>>18,x[w++]=128|g>>>12&63),x[w++]=128|g>>>6&63),x[w++]=128|63&g);return x},s.buf2binstring=function(p){return h(p,p.length)},s.binstring2buf=function(p){for(var x=new a.Buf8(p.length),g=0,v=x.length;g<v;g++)x[g]=p.charCodeAt(g);return x},s.buf2string=function(p,x){var g,v,y,w,_=x||p.length,S=new Array(2*_);for(g=v=0;g<_;)if((y=p[g++])<128)S[v++]=y;else if(4<(w=c[y]))S[v++]=65533,g+=w-1;else{for(y&=w===2?31:w===3?15:7;1<w&&g<_;)y=y<<6|63&p[g++],w--;1<w?S[v++]=65533:y<65536?S[v++]=y:(y-=65536,S[v++]=55296|y>>10&1023,S[v++]=56320|1023&y)}return h(S,v)},s.utf8border=function(p,x){var g;for((x=x||p.length)>p.length&&(x=p.length),g=x-1;0<=g&&(192&p[g])==128;)g--;return g<0||g===0?x:g+c[p[g]]>x?g:x}},{"./common":41}],43:[function(r,n,s){n.exports=function(a,i,o,c){for(var f=65535&a|0,h=a>>>16&65535|0,p=0;o!==0;){for(o-=p=2e3<o?2e3:o;h=h+(f=f+i[c++]|0)|0,--p;);f%=65521,h%=65521}return f|h<<16|0}},{}],44:[function(r,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,s){var a=(function(){for(var i,o=[],c=0;c<256;c++){i=c;for(var f=0;f<8;f++)i=1&i?3988292384^i>>>1:i>>>1;o[c]=i}return o})();n.exports=function(i,o,c,f){var h=a,p=f+c;i^=-1;for(var x=f;x<p;x++)i=i>>>8^h[255&(i^o[x])];return-1^i}},{}],46:[function(r,n,s){var a,i=r("../utils/common"),o=r("./trees"),c=r("./adler32"),f=r("./crc32"),h=r("./messages"),p=0,x=4,g=0,v=-2,y=-1,w=4,_=2,S=8,E=9,N=286,k=30,O=19,R=2*N+1,V=15,I=3,Z=258,ce=Z+I+1,F=42,X=113,P=1,ie=2,te=3,Y=4;function ve(z,he){return z.msg=h[he],he}function oe(z){return(z<<1)-(4<z?9:0)}function Ee(z){for(var he=z.length;0<=--he;)z[he]=0}function K(z){var he=z.state,M=he.pending;M>z.avail_out&&(M=z.avail_out),M!==0&&(i.arraySet(z.output,he.pending_buf,he.pending_out,M,z.next_out),z.next_out+=M,he.pending_out+=M,z.total_out+=M,z.avail_out-=M,he.pending-=M,he.pending===0&&(he.pending_out=0))}function D(z,he){o._tr_flush_block(z,0<=z.block_start?z.block_start:-1,z.strstart-z.block_start,he),z.block_start=z.strstart,K(z.strm)}function q(z,he){z.pending_buf[z.pending++]=he}function W(z,he){z.pending_buf[z.pending++]=he>>>8&255,z.pending_buf[z.pending++]=255&he}function J(z,he){var M,A,j=z.max_chain_length,H=z.strstart,ue=z.prev_length,ye=z.nice_match,pe=z.strstart>z.w_size-ce?z.strstart-(z.w_size-ce):0,Ne=z.window,De=z.w_mask,Fe=z.prev,Ke=z.strstart+Z,st=Ne[H+ue-1],at=Ne[H+ue];z.prev_length>=z.good_match&&(j>>=2),ye>z.lookahead&&(ye=z.lookahead);do if(Ne[(M=he)+ue]===at&&Ne[M+ue-1]===st&&Ne[M]===Ne[H]&&Ne[++M]===Ne[H+1]){H+=2,M++;do;while(Ne[++H]===Ne[++M]&&Ne[++H]===Ne[++M]&&Ne[++H]===Ne[++M]&&Ne[++H]===Ne[++M]&&Ne[++H]===Ne[++M]&&Ne[++H]===Ne[++M]&&Ne[++H]===Ne[++M]&&Ne[++H]===Ne[++M]&&H<Ke);if(A=Z-(Ke-H),H=Ke-Z,ue<A){if(z.match_start=he,ye<=(ue=A))break;st=Ne[H+ue-1],at=Ne[H+ue]}}while((he=Fe[he&De])>pe&&--j!=0);return ue<=z.lookahead?ue:z.lookahead}function re(z){var he,M,A,j,H,ue,ye,pe,Ne,De,Fe=z.w_size;do{if(j=z.window_size-z.lookahead-z.strstart,z.strstart>=Fe+(Fe-ce)){for(i.arraySet(z.window,z.window,Fe,Fe,0),z.match_start-=Fe,z.strstart-=Fe,z.block_start-=Fe,he=M=z.hash_size;A=z.head[--he],z.head[he]=Fe<=A?A-Fe:0,--M;);for(he=M=Fe;A=z.prev[--he],z.prev[he]=Fe<=A?A-Fe:0,--M;);j+=Fe}if(z.strm.avail_in===0)break;if(ue=z.strm,ye=z.window,pe=z.strstart+z.lookahead,Ne=j,De=void 0,De=ue.avail_in,Ne<De&&(De=Ne),M=De===0?0:(ue.avail_in-=De,i.arraySet(ye,ue.input,ue.next_in,De,pe),ue.state.wrap===1?ue.adler=c(ue.adler,ye,De,pe):ue.state.wrap===2&&(ue.adler=f(ue.adler,ye,De,pe)),ue.next_in+=De,ue.total_in+=De,De),z.lookahead+=M,z.lookahead+z.insert>=I)for(H=z.strstart-z.insert,z.ins_h=z.window[H],z.ins_h=(z.ins_h<<z.hash_shift^z.window[H+1])&z.hash_mask;z.insert&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[H+I-1])&z.hash_mask,z.prev[H&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=H,H++,z.insert--,!(z.lookahead+z.insert<I)););}while(z.lookahead<ce&&z.strm.avail_in!==0)}function U(z,he){for(var M,A;;){if(z.lookahead<ce){if(re(z),z.lookahead<ce&&he===p)return P;if(z.lookahead===0)break}if(M=0,z.lookahead>=I&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+I-1])&z.hash_mask,M=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),M!==0&&z.strstart-M<=z.w_size-ce&&(z.match_length=J(z,M)),z.match_length>=I)if(A=o._tr_tally(z,z.strstart-z.match_start,z.match_length-I),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=I){for(z.match_length--;z.strstart++,z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+I-1])&z.hash_mask,M=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart,--z.match_length!=0;);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+1])&z.hash_mask;else A=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(A&&(D(z,!1),z.strm.avail_out===0))return P}return z.insert=z.strstart<I-1?z.strstart:I-1,he===x?(D(z,!0),z.strm.avail_out===0?te:Y):z.last_lit&&(D(z,!1),z.strm.avail_out===0)?P:ie}function L(z,he){for(var M,A,j;;){if(z.lookahead<ce){if(re(z),z.lookahead<ce&&he===p)return P;if(z.lookahead===0)break}if(M=0,z.lookahead>=I&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+I-1])&z.hash_mask,M=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=I-1,M!==0&&z.prev_length<z.max_lazy_match&&z.strstart-M<=z.w_size-ce&&(z.match_length=J(z,M),z.match_length<=5&&(z.strategy===1||z.match_length===I&&4096<z.strstart-z.match_start)&&(z.match_length=I-1)),z.prev_length>=I&&z.match_length<=z.prev_length){for(j=z.strstart+z.lookahead-I,A=o._tr_tally(z,z.strstart-1-z.prev_match,z.prev_length-I),z.lookahead-=z.prev_length-1,z.prev_length-=2;++z.strstart<=j&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+I-1])&z.hash_mask,M=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),--z.prev_length!=0;);if(z.match_available=0,z.match_length=I-1,z.strstart++,A&&(D(z,!1),z.strm.avail_out===0))return P}else if(z.match_available){if((A=o._tr_tally(z,0,z.window[z.strstart-1]))&&D(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return P}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(A=o._tr_tally(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<I-1?z.strstart:I-1,he===x?(D(z,!0),z.strm.avail_out===0?te:Y):z.last_lit&&(D(z,!1),z.strm.avail_out===0)?P:ie}function se(z,he,M,A,j){this.good_length=z,this.max_lazy=he,this.nice_length=M,this.max_chain=A,this.func=j}function Q(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*R),this.dyn_dtree=new i.Buf16(2*(2*k+1)),this.bl_tree=new i.Buf16(2*(2*O+1)),Ee(this.dyn_ltree),Ee(this.dyn_dtree),Ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(V+1),this.heap=new i.Buf16(2*N+1),Ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*N+1),Ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ee(z){var he;return z&&z.state?(z.total_in=z.total_out=0,z.data_type=_,(he=z.state).pending=0,he.pending_out=0,he.wrap<0&&(he.wrap=-he.wrap),he.status=he.wrap?F:X,z.adler=he.wrap===2?0:1,he.last_flush=p,o._tr_init(he),g):ve(z,v)}function B(z){var he=ee(z);return he===g&&(function(M){M.window_size=2*M.w_size,Ee(M.head),M.max_lazy_match=a[M.level].max_lazy,M.good_match=a[M.level].good_length,M.nice_match=a[M.level].nice_length,M.max_chain_length=a[M.level].max_chain,M.strstart=0,M.block_start=0,M.lookahead=0,M.insert=0,M.match_length=M.prev_length=I-1,M.match_available=0,M.ins_h=0})(z.state),he}function be(z,he,M,A,j,H){if(!z)return v;var ue=1;if(he===y&&(he=6),A<0?(ue=0,A=-A):15<A&&(ue=2,A-=16),j<1||E<j||M!==S||A<8||15<A||he<0||9<he||H<0||w<H)return ve(z,v);A===8&&(A=9);var ye=new Q;return(z.state=ye).strm=z,ye.wrap=ue,ye.gzhead=null,ye.w_bits=A,ye.w_size=1<<ye.w_bits,ye.w_mask=ye.w_size-1,ye.hash_bits=j+7,ye.hash_size=1<<ye.hash_bits,ye.hash_mask=ye.hash_size-1,ye.hash_shift=~~((ye.hash_bits+I-1)/I),ye.window=new i.Buf8(2*ye.w_size),ye.head=new i.Buf16(ye.hash_size),ye.prev=new i.Buf16(ye.w_size),ye.lit_bufsize=1<<j+6,ye.pending_buf_size=4*ye.lit_bufsize,ye.pending_buf=new i.Buf8(ye.pending_buf_size),ye.d_buf=1*ye.lit_bufsize,ye.l_buf=3*ye.lit_bufsize,ye.level=he,ye.strategy=H,ye.method=M,B(z)}a=[new se(0,0,0,0,function(z,he){var M=65535;for(M>z.pending_buf_size-5&&(M=z.pending_buf_size-5);;){if(z.lookahead<=1){if(re(z),z.lookahead===0&&he===p)return P;if(z.lookahead===0)break}z.strstart+=z.lookahead,z.lookahead=0;var A=z.block_start+M;if((z.strstart===0||z.strstart>=A)&&(z.lookahead=z.strstart-A,z.strstart=A,D(z,!1),z.strm.avail_out===0)||z.strstart-z.block_start>=z.w_size-ce&&(D(z,!1),z.strm.avail_out===0))return P}return z.insert=0,he===x?(D(z,!0),z.strm.avail_out===0?te:Y):(z.strstart>z.block_start&&(D(z,!1),z.strm.avail_out),P)}),new se(4,4,8,4,U),new se(4,5,16,8,U),new se(4,6,32,32,U),new se(4,4,16,16,L),new se(8,16,32,32,L),new se(8,16,128,128,L),new se(8,32,128,256,L),new se(32,128,258,1024,L),new se(32,258,258,4096,L)],s.deflateInit=function(z,he){return be(z,he,S,15,8,0)},s.deflateInit2=be,s.deflateReset=B,s.deflateResetKeep=ee,s.deflateSetHeader=function(z,he){return z&&z.state?z.state.wrap!==2?v:(z.state.gzhead=he,g):v},s.deflate=function(z,he){var M,A,j,H;if(!z||!z.state||5<he||he<0)return z?ve(z,v):v;if(A=z.state,!z.output||!z.input&&z.avail_in!==0||A.status===666&&he!==x)return ve(z,z.avail_out===0?-5:v);if(A.strm=z,M=A.last_flush,A.last_flush=he,A.status===F)if(A.wrap===2)z.adler=0,q(A,31),q(A,139),q(A,8),A.gzhead?(q(A,(A.gzhead.text?1:0)+(A.gzhead.hcrc?2:0)+(A.gzhead.extra?4:0)+(A.gzhead.name?8:0)+(A.gzhead.comment?16:0)),q(A,255&A.gzhead.time),q(A,A.gzhead.time>>8&255),q(A,A.gzhead.time>>16&255),q(A,A.gzhead.time>>24&255),q(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),q(A,255&A.gzhead.os),A.gzhead.extra&&A.gzhead.extra.length&&(q(A,255&A.gzhead.extra.length),q(A,A.gzhead.extra.length>>8&255)),A.gzhead.hcrc&&(z.adler=f(z.adler,A.pending_buf,A.pending,0)),A.gzindex=0,A.status=69):(q(A,0),q(A,0),q(A,0),q(A,0),q(A,0),q(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),q(A,3),A.status=X);else{var ue=S+(A.w_bits-8<<4)<<8;ue|=(2<=A.strategy||A.level<2?0:A.level<6?1:A.level===6?2:3)<<6,A.strstart!==0&&(ue|=32),ue+=31-ue%31,A.status=X,W(A,ue),A.strstart!==0&&(W(A,z.adler>>>16),W(A,65535&z.adler)),z.adler=1}if(A.status===69)if(A.gzhead.extra){for(j=A.pending;A.gzindex<(65535&A.gzhead.extra.length)&&(A.pending!==A.pending_buf_size||(A.gzhead.hcrc&&A.pending>j&&(z.adler=f(z.adler,A.pending_buf,A.pending-j,j)),K(z),j=A.pending,A.pending!==A.pending_buf_size));)q(A,255&A.gzhead.extra[A.gzindex]),A.gzindex++;A.gzhead.hcrc&&A.pending>j&&(z.adler=f(z.adler,A.pending_buf,A.pending-j,j)),A.gzindex===A.gzhead.extra.length&&(A.gzindex=0,A.status=73)}else A.status=73;if(A.status===73)if(A.gzhead.name){j=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>j&&(z.adler=f(z.adler,A.pending_buf,A.pending-j,j)),K(z),j=A.pending,A.pending===A.pending_buf_size)){H=1;break}H=A.gzindex<A.gzhead.name.length?255&A.gzhead.name.charCodeAt(A.gzindex++):0,q(A,H)}while(H!==0);A.gzhead.hcrc&&A.pending>j&&(z.adler=f(z.adler,A.pending_buf,A.pending-j,j)),H===0&&(A.gzindex=0,A.status=91)}else A.status=91;if(A.status===91)if(A.gzhead.comment){j=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>j&&(z.adler=f(z.adler,A.pending_buf,A.pending-j,j)),K(z),j=A.pending,A.pending===A.pending_buf_size)){H=1;break}H=A.gzindex<A.gzhead.comment.length?255&A.gzhead.comment.charCodeAt(A.gzindex++):0,q(A,H)}while(H!==0);A.gzhead.hcrc&&A.pending>j&&(z.adler=f(z.adler,A.pending_buf,A.pending-j,j)),H===0&&(A.status=103)}else A.status=103;if(A.status===103&&(A.gzhead.hcrc?(A.pending+2>A.pending_buf_size&&K(z),A.pending+2<=A.pending_buf_size&&(q(A,255&z.adler),q(A,z.adler>>8&255),z.adler=0,A.status=X)):A.status=X),A.pending!==0){if(K(z),z.avail_out===0)return A.last_flush=-1,g}else if(z.avail_in===0&&oe(he)<=oe(M)&&he!==x)return ve(z,-5);if(A.status===666&&z.avail_in!==0)return ve(z,-5);if(z.avail_in!==0||A.lookahead!==0||he!==p&&A.status!==666){var ye=A.strategy===2?(function(pe,Ne){for(var De;;){if(pe.lookahead===0&&(re(pe),pe.lookahead===0)){if(Ne===p)return P;break}if(pe.match_length=0,De=o._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++,De&&(D(pe,!1),pe.strm.avail_out===0))return P}return pe.insert=0,Ne===x?(D(pe,!0),pe.strm.avail_out===0?te:Y):pe.last_lit&&(D(pe,!1),pe.strm.avail_out===0)?P:ie})(A,he):A.strategy===3?(function(pe,Ne){for(var De,Fe,Ke,st,at=pe.window;;){if(pe.lookahead<=Z){if(re(pe),pe.lookahead<=Z&&Ne===p)return P;if(pe.lookahead===0)break}if(pe.match_length=0,pe.lookahead>=I&&0<pe.strstart&&(Fe=at[Ke=pe.strstart-1])===at[++Ke]&&Fe===at[++Ke]&&Fe===at[++Ke]){st=pe.strstart+Z;do;while(Fe===at[++Ke]&&Fe===at[++Ke]&&Fe===at[++Ke]&&Fe===at[++Ke]&&Fe===at[++Ke]&&Fe===at[++Ke]&&Fe===at[++Ke]&&Fe===at[++Ke]&&Ke<st);pe.match_length=Z-(st-Ke),pe.match_length>pe.lookahead&&(pe.match_length=pe.lookahead)}if(pe.match_length>=I?(De=o._tr_tally(pe,1,pe.match_length-I),pe.lookahead-=pe.match_length,pe.strstart+=pe.match_length,pe.match_length=0):(De=o._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++),De&&(D(pe,!1),pe.strm.avail_out===0))return P}return pe.insert=0,Ne===x?(D(pe,!0),pe.strm.avail_out===0?te:Y):pe.last_lit&&(D(pe,!1),pe.strm.avail_out===0)?P:ie})(A,he):a[A.level].func(A,he);if(ye!==te&&ye!==Y||(A.status=666),ye===P||ye===te)return z.avail_out===0&&(A.last_flush=-1),g;if(ye===ie&&(he===1?o._tr_align(A):he!==5&&(o._tr_stored_block(A,0,0,!1),he===3&&(Ee(A.head),A.lookahead===0&&(A.strstart=0,A.block_start=0,A.insert=0))),K(z),z.avail_out===0))return A.last_flush=-1,g}return he!==x?g:A.wrap<=0?1:(A.wrap===2?(q(A,255&z.adler),q(A,z.adler>>8&255),q(A,z.adler>>16&255),q(A,z.adler>>24&255),q(A,255&z.total_in),q(A,z.total_in>>8&255),q(A,z.total_in>>16&255),q(A,z.total_in>>24&255)):(W(A,z.adler>>>16),W(A,65535&z.adler)),K(z),0<A.wrap&&(A.wrap=-A.wrap),A.pending!==0?g:1)},s.deflateEnd=function(z){var he;return z&&z.state?(he=z.state.status)!==F&&he!==69&&he!==73&&he!==91&&he!==103&&he!==X&&he!==666?ve(z,v):(z.state=null,he===X?ve(z,-3):g):v},s.deflateSetDictionary=function(z,he){var M,A,j,H,ue,ye,pe,Ne,De=he.length;if(!z||!z.state||(H=(M=z.state).wrap)===2||H===1&&M.status!==F||M.lookahead)return v;for(H===1&&(z.adler=c(z.adler,he,De,0)),M.wrap=0,De>=M.w_size&&(H===0&&(Ee(M.head),M.strstart=0,M.block_start=0,M.insert=0),Ne=new i.Buf8(M.w_size),i.arraySet(Ne,he,De-M.w_size,M.w_size,0),he=Ne,De=M.w_size),ue=z.avail_in,ye=z.next_in,pe=z.input,z.avail_in=De,z.next_in=0,z.input=he,re(M);M.lookahead>=I;){for(A=M.strstart,j=M.lookahead-(I-1);M.ins_h=(M.ins_h<<M.hash_shift^M.window[A+I-1])&M.hash_mask,M.prev[A&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=A,A++,--j;);M.strstart=A,M.lookahead=I-1,re(M)}return M.strstart+=M.lookahead,M.block_start=M.strstart,M.insert=M.lookahead,M.lookahead=0,M.match_length=M.prev_length=I-1,M.match_available=0,z.next_in=ye,z.input=pe,z.avail_in=ue,M.wrap=H,g},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,s){n.exports=function(a,i){var o,c,f,h,p,x,g,v,y,w,_,S,E,N,k,O,R,V,I,Z,ce,F,X,P,ie;o=a.state,c=a.next_in,P=a.input,f=c+(a.avail_in-5),h=a.next_out,ie=a.output,p=h-(i-a.avail_out),x=h+(a.avail_out-257),g=o.dmax,v=o.wsize,y=o.whave,w=o.wnext,_=o.window,S=o.hold,E=o.bits,N=o.lencode,k=o.distcode,O=(1<<o.lenbits)-1,R=(1<<o.distbits)-1;e:do{E<15&&(S+=P[c++]<<E,E+=8,S+=P[c++]<<E,E+=8),V=N[S&O];t:for(;;){if(S>>>=I=V>>>24,E-=I,(I=V>>>16&255)===0)ie[h++]=65535&V;else{if(!(16&I)){if((64&I)==0){V=N[(65535&V)+(S&(1<<I)-1)];continue t}if(32&I){o.mode=12;break e}a.msg="invalid literal/length code",o.mode=30;break e}Z=65535&V,(I&=15)&&(E<I&&(S+=P[c++]<<E,E+=8),Z+=S&(1<<I)-1,S>>>=I,E-=I),E<15&&(S+=P[c++]<<E,E+=8,S+=P[c++]<<E,E+=8),V=k[S&R];r:for(;;){if(S>>>=I=V>>>24,E-=I,!(16&(I=V>>>16&255))){if((64&I)==0){V=k[(65535&V)+(S&(1<<I)-1)];continue r}a.msg="invalid distance code",o.mode=30;break e}if(ce=65535&V,E<(I&=15)&&(S+=P[c++]<<E,(E+=8)<I&&(S+=P[c++]<<E,E+=8)),g<(ce+=S&(1<<I)-1)){a.msg="invalid distance too far back",o.mode=30;break e}if(S>>>=I,E-=I,(I=h-p)<ce){if(y<(I=ce-I)&&o.sane){a.msg="invalid distance too far back",o.mode=30;break e}if(X=_,(F=0)===w){if(F+=v-I,I<Z){for(Z-=I;ie[h++]=_[F++],--I;);F=h-ce,X=ie}}else if(w<I){if(F+=v+w-I,(I-=w)<Z){for(Z-=I;ie[h++]=_[F++],--I;);if(F=0,w<Z){for(Z-=I=w;ie[h++]=_[F++],--I;);F=h-ce,X=ie}}}else if(F+=w-I,I<Z){for(Z-=I;ie[h++]=_[F++],--I;);F=h-ce,X=ie}for(;2<Z;)ie[h++]=X[F++],ie[h++]=X[F++],ie[h++]=X[F++],Z-=3;Z&&(ie[h++]=X[F++],1<Z&&(ie[h++]=X[F++]))}else{for(F=h-ce;ie[h++]=ie[F++],ie[h++]=ie[F++],ie[h++]=ie[F++],2<(Z-=3););Z&&(ie[h++]=ie[F++],1<Z&&(ie[h++]=ie[F++]))}break}}break}}while(c<f&&h<x);c-=Z=E>>3,S&=(1<<(E-=Z<<3))-1,a.next_in=c,a.next_out=h,a.avail_in=c<f?f-c+5:5-(c-f),a.avail_out=h<x?x-h+257:257-(h-x),o.hold=S,o.bits=E}},{}],49:[function(r,n,s){var a=r("../utils/common"),i=r("./adler32"),o=r("./crc32"),c=r("./inffast"),f=r("./inftrees"),h=1,p=2,x=0,g=-2,v=1,y=852,w=592;function _(F){return(F>>>24&255)+(F>>>8&65280)+((65280&F)<<8)+((255&F)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(F){var X;return F&&F.state?(X=F.state,F.total_in=F.total_out=X.total=0,F.msg="",X.wrap&&(F.adler=1&X.wrap),X.mode=v,X.last=0,X.havedict=0,X.dmax=32768,X.head=null,X.hold=0,X.bits=0,X.lencode=X.lendyn=new a.Buf32(y),X.distcode=X.distdyn=new a.Buf32(w),X.sane=1,X.back=-1,x):g}function N(F){var X;return F&&F.state?((X=F.state).wsize=0,X.whave=0,X.wnext=0,E(F)):g}function k(F,X){var P,ie;return F&&F.state?(ie=F.state,X<0?(P=0,X=-X):(P=1+(X>>4),X<48&&(X&=15)),X&&(X<8||15<X)?g:(ie.window!==null&&ie.wbits!==X&&(ie.window=null),ie.wrap=P,ie.wbits=X,N(F))):g}function O(F,X){var P,ie;return F?(ie=new S,(F.state=ie).window=null,(P=k(F,X))!==x&&(F.state=null),P):g}var R,V,I=!0;function Z(F){if(I){var X;for(R=new a.Buf32(512),V=new a.Buf32(32),X=0;X<144;)F.lens[X++]=8;for(;X<256;)F.lens[X++]=9;for(;X<280;)F.lens[X++]=7;for(;X<288;)F.lens[X++]=8;for(f(h,F.lens,0,288,R,0,F.work,{bits:9}),X=0;X<32;)F.lens[X++]=5;f(p,F.lens,0,32,V,0,F.work,{bits:5}),I=!1}F.lencode=R,F.lenbits=9,F.distcode=V,F.distbits=5}function ce(F,X,P,ie){var te,Y=F.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new a.Buf8(Y.wsize)),ie>=Y.wsize?(a.arraySet(Y.window,X,P-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize):(ie<(te=Y.wsize-Y.wnext)&&(te=ie),a.arraySet(Y.window,X,P-ie,te,Y.wnext),(ie-=te)?(a.arraySet(Y.window,X,P-ie,ie,0),Y.wnext=ie,Y.whave=Y.wsize):(Y.wnext+=te,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=te))),0}s.inflateReset=N,s.inflateReset2=k,s.inflateResetKeep=E,s.inflateInit=function(F){return O(F,15)},s.inflateInit2=O,s.inflate=function(F,X){var P,ie,te,Y,ve,oe,Ee,K,D,q,W,J,re,U,L,se,Q,ee,B,be,z,he,M,A,j=0,H=new a.Buf8(4),ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return g;(P=F.state).mode===12&&(P.mode=13),ve=F.next_out,te=F.output,Ee=F.avail_out,Y=F.next_in,ie=F.input,oe=F.avail_in,K=P.hold,D=P.bits,q=oe,W=Ee,he=x;e:for(;;)switch(P.mode){case v:if(P.wrap===0){P.mode=13;break}for(;D<16;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if(2&P.wrap&&K===35615){H[P.check=0]=255&K,H[1]=K>>>8&255,P.check=o(P.check,H,2,0),D=K=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&K)<<8)+(K>>8))%31){F.msg="incorrect header check",P.mode=30;break}if((15&K)!=8){F.msg="unknown compression method",P.mode=30;break}if(D-=4,z=8+(15&(K>>>=4)),P.wbits===0)P.wbits=z;else if(z>P.wbits){F.msg="invalid window size",P.mode=30;break}P.dmax=1<<z,F.adler=P.check=1,P.mode=512&K?10:12,D=K=0;break;case 2:for(;D<16;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if(P.flags=K,(255&P.flags)!=8){F.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){F.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=K>>8&1),512&P.flags&&(H[0]=255&K,H[1]=K>>>8&255,P.check=o(P.check,H,2,0)),D=K=0,P.mode=3;case 3:for(;D<32;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}P.head&&(P.head.time=K),512&P.flags&&(H[0]=255&K,H[1]=K>>>8&255,H[2]=K>>>16&255,H[3]=K>>>24&255,P.check=o(P.check,H,4,0)),D=K=0,P.mode=4;case 4:for(;D<16;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}P.head&&(P.head.xflags=255&K,P.head.os=K>>8),512&P.flags&&(H[0]=255&K,H[1]=K>>>8&255,P.check=o(P.check,H,2,0)),D=K=0,P.mode=5;case 5:if(1024&P.flags){for(;D<16;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}P.length=K,P.head&&(P.head.extra_len=K),512&P.flags&&(H[0]=255&K,H[1]=K>>>8&255,P.check=o(P.check,H,2,0)),D=K=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(oe<(J=P.length)&&(J=oe),J&&(P.head&&(z=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),a.arraySet(P.head.extra,ie,Y,J,z)),512&P.flags&&(P.check=o(P.check,ie,J,Y)),oe-=J,Y+=J,P.length-=J),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(oe===0)break e;for(J=0;z=ie[Y+J++],P.head&&z&&P.length<65536&&(P.head.name+=String.fromCharCode(z)),z&&J<oe;);if(512&P.flags&&(P.check=o(P.check,ie,J,Y)),oe-=J,Y+=J,z)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(oe===0)break e;for(J=0;z=ie[Y+J++],P.head&&z&&P.length<65536&&(P.head.comment+=String.fromCharCode(z)),z&&J<oe;);if(512&P.flags&&(P.check=o(P.check,ie,J,Y)),oe-=J,Y+=J,z)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;D<16;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if(K!==(65535&P.check)){F.msg="header crc mismatch",P.mode=30;break}D=K=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),F.adler=P.check=0,P.mode=12;break;case 10:for(;D<32;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}F.adler=P.check=_(K),D=K=0,P.mode=11;case 11:if(P.havedict===0)return F.next_out=ve,F.avail_out=Ee,F.next_in=Y,F.avail_in=oe,P.hold=K,P.bits=D,2;F.adler=P.check=1,P.mode=12;case 12:if(X===5||X===6)break e;case 13:if(P.last){K>>>=7&D,D-=7&D,P.mode=27;break}for(;D<3;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}switch(P.last=1&K,D-=1,3&(K>>>=1)){case 0:P.mode=14;break;case 1:if(Z(P),P.mode=20,X!==6)break;K>>>=2,D-=2;break e;case 2:P.mode=17;break;case 3:F.msg="invalid block type",P.mode=30}K>>>=2,D-=2;break;case 14:for(K>>>=7&D,D-=7&D;D<32;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if((65535&K)!=(K>>>16^65535)){F.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&K,D=K=0,P.mode=15,X===6)break e;case 15:P.mode=16;case 16:if(J=P.length){if(oe<J&&(J=oe),Ee<J&&(J=Ee),J===0)break e;a.arraySet(te,ie,Y,J,ve),oe-=J,Y+=J,Ee-=J,ve+=J,P.length-=J;break}P.mode=12;break;case 17:for(;D<14;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if(P.nlen=257+(31&K),K>>>=5,D-=5,P.ndist=1+(31&K),K>>>=5,D-=5,P.ncode=4+(15&K),K>>>=4,D-=4,286<P.nlen||30<P.ndist){F.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;D<3;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}P.lens[ue[P.have++]]=7&K,K>>>=3,D-=3}for(;P.have<19;)P.lens[ue[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,M={bits:P.lenbits},he=f(0,P.lens,0,19,P.lencode,0,P.work,M),P.lenbits=M.bits,he){F.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;se=(j=P.lencode[K&(1<<P.lenbits)-1])>>>16&255,Q=65535&j,!((L=j>>>24)<=D);){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if(Q<16)K>>>=L,D-=L,P.lens[P.have++]=Q;else{if(Q===16){for(A=L+2;D<A;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if(K>>>=L,D-=L,P.have===0){F.msg="invalid bit length repeat",P.mode=30;break}z=P.lens[P.have-1],J=3+(3&K),K>>>=2,D-=2}else if(Q===17){for(A=L+3;D<A;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}D-=L,z=0,J=3+(7&(K>>>=L)),K>>>=3,D-=3}else{for(A=L+7;D<A;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}D-=L,z=0,J=11+(127&(K>>>=L)),K>>>=7,D-=7}if(P.have+J>P.nlen+P.ndist){F.msg="invalid bit length repeat",P.mode=30;break}for(;J--;)P.lens[P.have++]=z}}if(P.mode===30)break;if(P.lens[256]===0){F.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,M={bits:P.lenbits},he=f(h,P.lens,0,P.nlen,P.lencode,0,P.work,M),P.lenbits=M.bits,he){F.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,M={bits:P.distbits},he=f(p,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,M),P.distbits=M.bits,he){F.msg="invalid distances set",P.mode=30;break}if(P.mode=20,X===6)break e;case 20:P.mode=21;case 21:if(6<=oe&&258<=Ee){F.next_out=ve,F.avail_out=Ee,F.next_in=Y,F.avail_in=oe,P.hold=K,P.bits=D,c(F,W),ve=F.next_out,te=F.output,Ee=F.avail_out,Y=F.next_in,ie=F.input,oe=F.avail_in,K=P.hold,D=P.bits,P.mode===12&&(P.back=-1);break}for(P.back=0;se=(j=P.lencode[K&(1<<P.lenbits)-1])>>>16&255,Q=65535&j,!((L=j>>>24)<=D);){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if(se&&(240&se)==0){for(ee=L,B=se,be=Q;se=(j=P.lencode[be+((K&(1<<ee+B)-1)>>ee)])>>>16&255,Q=65535&j,!(ee+(L=j>>>24)<=D);){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}K>>>=ee,D-=ee,P.back+=ee}if(K>>>=L,D-=L,P.back+=L,P.length=Q,se===0){P.mode=26;break}if(32&se){P.back=-1,P.mode=12;break}if(64&se){F.msg="invalid literal/length code",P.mode=30;break}P.extra=15&se,P.mode=22;case 22:if(P.extra){for(A=P.extra;D<A;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}P.length+=K&(1<<P.extra)-1,K>>>=P.extra,D-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;se=(j=P.distcode[K&(1<<P.distbits)-1])>>>16&255,Q=65535&j,!((L=j>>>24)<=D);){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if((240&se)==0){for(ee=L,B=se,be=Q;se=(j=P.distcode[be+((K&(1<<ee+B)-1)>>ee)])>>>16&255,Q=65535&j,!(ee+(L=j>>>24)<=D);){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}K>>>=ee,D-=ee,P.back+=ee}if(K>>>=L,D-=L,P.back+=L,64&se){F.msg="invalid distance code",P.mode=30;break}P.offset=Q,P.extra=15&se,P.mode=24;case 24:if(P.extra){for(A=P.extra;D<A;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}P.offset+=K&(1<<P.extra)-1,K>>>=P.extra,D-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){F.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(Ee===0)break e;if(J=W-Ee,P.offset>J){if((J=P.offset-J)>P.whave&&P.sane){F.msg="invalid distance too far back",P.mode=30;break}re=J>P.wnext?(J-=P.wnext,P.wsize-J):P.wnext-J,J>P.length&&(J=P.length),U=P.window}else U=te,re=ve-P.offset,J=P.length;for(Ee<J&&(J=Ee),Ee-=J,P.length-=J;te[ve++]=U[re++],--J;);P.length===0&&(P.mode=21);break;case 26:if(Ee===0)break e;te[ve++]=P.length,Ee--,P.mode=21;break;case 27:if(P.wrap){for(;D<32;){if(oe===0)break e;oe--,K|=ie[Y++]<<D,D+=8}if(W-=Ee,F.total_out+=W,P.total+=W,W&&(F.adler=P.check=P.flags?o(P.check,te,W,ve-W):i(P.check,te,W,ve-W)),W=Ee,(P.flags?K:_(K))!==P.check){F.msg="incorrect data check",P.mode=30;break}D=K=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;D<32;){if(oe===0)break e;oe--,K+=ie[Y++]<<D,D+=8}if(K!==(4294967295&P.total)){F.msg="incorrect length check",P.mode=30;break}D=K=0}P.mode=29;case 29:he=1;break e;case 30:he=-3;break e;case 31:return-4;case 32:default:return g}return F.next_out=ve,F.avail_out=Ee,F.next_in=Y,F.avail_in=oe,P.hold=K,P.bits=D,(P.wsize||W!==F.avail_out&&P.mode<30&&(P.mode<27||X!==4))&&ce(F,F.output,F.next_out,W-F.avail_out)?(P.mode=31,-4):(q-=F.avail_in,W-=F.avail_out,F.total_in+=q,F.total_out+=W,P.total+=W,P.wrap&&W&&(F.adler=P.check=P.flags?o(P.check,te,W,F.next_out-W):i(P.check,te,W,F.next_out-W)),F.data_type=P.bits+(P.last?64:0)+(P.mode===12?128:0)+(P.mode===20||P.mode===15?256:0),(q==0&&W===0||X===4)&&he===x&&(he=-5),he)},s.inflateEnd=function(F){if(!F||!F.state)return g;var X=F.state;return X.window&&(X.window=null),F.state=null,x},s.inflateGetHeader=function(F,X){var P;return F&&F.state?(2&(P=F.state).wrap)==0?g:((P.head=X).done=!1,x):g},s.inflateSetDictionary=function(F,X){var P,ie=X.length;return F&&F.state?(P=F.state).wrap!==0&&P.mode!==11?g:P.mode===11&&i(1,X,ie,0)!==P.check?-3:ce(F,X,ie,ie)?(P.mode=31,-4):(P.havedict=1,x):g},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,s){var a=r("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(h,p,x,g,v,y,w,_){var S,E,N,k,O,R,V,I,Z,ce=_.bits,F=0,X=0,P=0,ie=0,te=0,Y=0,ve=0,oe=0,Ee=0,K=0,D=null,q=0,W=new a.Buf16(16),J=new a.Buf16(16),re=null,U=0;for(F=0;F<=15;F++)W[F]=0;for(X=0;X<g;X++)W[p[x+X]]++;for(te=ce,ie=15;1<=ie&&W[ie]===0;ie--);if(ie<te&&(te=ie),ie===0)return v[y++]=20971520,v[y++]=20971520,_.bits=1,0;for(P=1;P<ie&&W[P]===0;P++);for(te<P&&(te=P),F=oe=1;F<=15;F++)if(oe<<=1,(oe-=W[F])<0)return-1;if(0<oe&&(h===0||ie!==1))return-1;for(J[1]=0,F=1;F<15;F++)J[F+1]=J[F]+W[F];for(X=0;X<g;X++)p[x+X]!==0&&(w[J[p[x+X]]++]=X);if(R=h===0?(D=re=w,19):h===1?(D=i,q-=257,re=o,U-=257,256):(D=c,re=f,-1),F=P,O=y,ve=X=K=0,N=-1,k=(Ee=1<<(Y=te))-1,h===1&&852<Ee||h===2&&592<Ee)return 1;for(;;){for(V=F-ve,Z=w[X]<R?(I=0,w[X]):w[X]>R?(I=re[U+w[X]],D[q+w[X]]):(I=96,0),S=1<<F-ve,P=E=1<<Y;v[O+(K>>ve)+(E-=S)]=V<<24|I<<16|Z|0,E!==0;);for(S=1<<F-1;K&S;)S>>=1;if(S!==0?(K&=S-1,K+=S):K=0,X++,--W[F]==0){if(F===ie)break;F=p[x+w[X]]}if(te<F&&(K&k)!==N){for(ve===0&&(ve=te),O+=P,oe=1<<(Y=F-ve);Y+ve<ie&&!((oe-=W[Y+ve])<=0);)Y++,oe<<=1;if(Ee+=1<<Y,h===1&&852<Ee||h===2&&592<Ee)return 1;v[N=K&k]=te<<24|Y<<16|O-y|0}}return K!==0&&(v[O+K]=F-ve<<24|64<<16|0),_.bits=te,0}},{"../utils/common":41}],51:[function(r,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,s){var a=r("../utils/common"),i=0,o=1;function c(j){for(var H=j.length;0<=--H;)j[H]=0}var f=0,h=29,p=256,x=p+1+h,g=30,v=19,y=2*x+1,w=15,_=16,S=7,E=256,N=16,k=17,O=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=new Array(2*(x+2));c(ce);var F=new Array(2*g);c(F);var X=new Array(512);c(X);var P=new Array(256);c(P);var ie=new Array(h);c(ie);var te,Y,ve,oe=new Array(g);function Ee(j,H,ue,ye,pe){this.static_tree=j,this.extra_bits=H,this.extra_base=ue,this.elems=ye,this.max_length=pe,this.has_stree=j&&j.length}function K(j,H){this.dyn_tree=j,this.max_code=0,this.stat_desc=H}function D(j){return j<256?X[j]:X[256+(j>>>7)]}function q(j,H){j.pending_buf[j.pending++]=255&H,j.pending_buf[j.pending++]=H>>>8&255}function W(j,H,ue){j.bi_valid>_-ue?(j.bi_buf|=H<<j.bi_valid&65535,q(j,j.bi_buf),j.bi_buf=H>>_-j.bi_valid,j.bi_valid+=ue-_):(j.bi_buf|=H<<j.bi_valid&65535,j.bi_valid+=ue)}function J(j,H,ue){W(j,ue[2*H],ue[2*H+1])}function re(j,H){for(var ue=0;ue|=1&j,j>>>=1,ue<<=1,0<--H;);return ue>>>1}function U(j,H,ue){var ye,pe,Ne=new Array(w+1),De=0;for(ye=1;ye<=w;ye++)Ne[ye]=De=De+ue[ye-1]<<1;for(pe=0;pe<=H;pe++){var Fe=j[2*pe+1];Fe!==0&&(j[2*pe]=re(Ne[Fe]++,Fe))}}function L(j){var H;for(H=0;H<x;H++)j.dyn_ltree[2*H]=0;for(H=0;H<g;H++)j.dyn_dtree[2*H]=0;for(H=0;H<v;H++)j.bl_tree[2*H]=0;j.dyn_ltree[2*E]=1,j.opt_len=j.static_len=0,j.last_lit=j.matches=0}function se(j){8<j.bi_valid?q(j,j.bi_buf):0<j.bi_valid&&(j.pending_buf[j.pending++]=j.bi_buf),j.bi_buf=0,j.bi_valid=0}function Q(j,H,ue,ye){var pe=2*H,Ne=2*ue;return j[pe]<j[Ne]||j[pe]===j[Ne]&&ye[H]<=ye[ue]}function ee(j,H,ue){for(var ye=j.heap[ue],pe=ue<<1;pe<=j.heap_len&&(pe<j.heap_len&&Q(H,j.heap[pe+1],j.heap[pe],j.depth)&&pe++,!Q(H,ye,j.heap[pe],j.depth));)j.heap[ue]=j.heap[pe],ue=pe,pe<<=1;j.heap[ue]=ye}function B(j,H,ue){var ye,pe,Ne,De,Fe=0;if(j.last_lit!==0)for(;ye=j.pending_buf[j.d_buf+2*Fe]<<8|j.pending_buf[j.d_buf+2*Fe+1],pe=j.pending_buf[j.l_buf+Fe],Fe++,ye===0?J(j,pe,H):(J(j,(Ne=P[pe])+p+1,H),(De=R[Ne])!==0&&W(j,pe-=ie[Ne],De),J(j,Ne=D(--ye),ue),(De=V[Ne])!==0&&W(j,ye-=oe[Ne],De)),Fe<j.last_lit;);J(j,E,H)}function be(j,H){var ue,ye,pe,Ne=H.dyn_tree,De=H.stat_desc.static_tree,Fe=H.stat_desc.has_stree,Ke=H.stat_desc.elems,st=-1;for(j.heap_len=0,j.heap_max=y,ue=0;ue<Ke;ue++)Ne[2*ue]!==0?(j.heap[++j.heap_len]=st=ue,j.depth[ue]=0):Ne[2*ue+1]=0;for(;j.heap_len<2;)Ne[2*(pe=j.heap[++j.heap_len]=st<2?++st:0)]=1,j.depth[pe]=0,j.opt_len--,Fe&&(j.static_len-=De[2*pe+1]);for(H.max_code=st,ue=j.heap_len>>1;1<=ue;ue--)ee(j,Ne,ue);for(pe=Ke;ue=j.heap[1],j.heap[1]=j.heap[j.heap_len--],ee(j,Ne,1),ye=j.heap[1],j.heap[--j.heap_max]=ue,j.heap[--j.heap_max]=ye,Ne[2*pe]=Ne[2*ue]+Ne[2*ye],j.depth[pe]=(j.depth[ue]>=j.depth[ye]?j.depth[ue]:j.depth[ye])+1,Ne[2*ue+1]=Ne[2*ye+1]=pe,j.heap[1]=pe++,ee(j,Ne,1),2<=j.heap_len;);j.heap[--j.heap_max]=j.heap[1],(function(at,Gt){var dt,Lt,pr,vt,or,Tn,lr=Gt.dyn_tree,qo=Gt.max_code,mi=Gt.stat_desc.static_tree,xs=Gt.stat_desc.has_stree,Ya=Gt.stat_desc.extra_bits,Ja=Gt.stat_desc.extra_base,gs=Gt.stat_desc.max_length,nn=0;for(vt=0;vt<=w;vt++)at.bl_count[vt]=0;for(lr[2*at.heap[at.heap_max]+1]=0,dt=at.heap_max+1;dt<y;dt++)gs<(vt=lr[2*lr[2*(Lt=at.heap[dt])+1]+1]+1)&&(vt=gs,nn++),lr[2*Lt+1]=vt,qo<Lt||(at.bl_count[vt]++,or=0,Ja<=Lt&&(or=Ya[Lt-Ja]),Tn=lr[2*Lt],at.opt_len+=Tn*(vt+or),xs&&(at.static_len+=Tn*(mi[2*Lt+1]+or)));if(nn!==0){do{for(vt=gs-1;at.bl_count[vt]===0;)vt--;at.bl_count[vt]--,at.bl_count[vt+1]+=2,at.bl_count[gs]--,nn-=2}while(0<nn);for(vt=gs;vt!==0;vt--)for(Lt=at.bl_count[vt];Lt!==0;)qo<(pr=at.heap[--dt])||(lr[2*pr+1]!==vt&&(at.opt_len+=(vt-lr[2*pr+1])*lr[2*pr],lr[2*pr+1]=vt),Lt--)}})(j,H),U(Ne,st,j.bl_count)}function z(j,H,ue){var ye,pe,Ne=-1,De=H[1],Fe=0,Ke=7,st=4;for(De===0&&(Ke=138,st=3),H[2*(ue+1)+1]=65535,ye=0;ye<=ue;ye++)pe=De,De=H[2*(ye+1)+1],++Fe<Ke&&pe===De||(Fe<st?j.bl_tree[2*pe]+=Fe:pe!==0?(pe!==Ne&&j.bl_tree[2*pe]++,j.bl_tree[2*N]++):Fe<=10?j.bl_tree[2*k]++:j.bl_tree[2*O]++,Ne=pe,st=(Fe=0)===De?(Ke=138,3):pe===De?(Ke=6,3):(Ke=7,4))}function he(j,H,ue){var ye,pe,Ne=-1,De=H[1],Fe=0,Ke=7,st=4;for(De===0&&(Ke=138,st=3),ye=0;ye<=ue;ye++)if(pe=De,De=H[2*(ye+1)+1],!(++Fe<Ke&&pe===De)){if(Fe<st)for(;J(j,pe,j.bl_tree),--Fe!=0;);else pe!==0?(pe!==Ne&&(J(j,pe,j.bl_tree),Fe--),J(j,N,j.bl_tree),W(j,Fe-3,2)):Fe<=10?(J(j,k,j.bl_tree),W(j,Fe-3,3)):(J(j,O,j.bl_tree),W(j,Fe-11,7));Ne=pe,st=(Fe=0)===De?(Ke=138,3):pe===De?(Ke=6,3):(Ke=7,4)}}c(oe);var M=!1;function A(j,H,ue,ye){W(j,(f<<1)+(ye?1:0),3),(function(pe,Ne,De,Fe){se(pe),q(pe,De),q(pe,~De),a.arraySet(pe.pending_buf,pe.window,Ne,De,pe.pending),pe.pending+=De})(j,H,ue)}s._tr_init=function(j){M||((function(){var H,ue,ye,pe,Ne,De=new Array(w+1);for(pe=ye=0;pe<h-1;pe++)for(ie[pe]=ye,H=0;H<1<<R[pe];H++)P[ye++]=pe;for(P[ye-1]=pe,pe=Ne=0;pe<16;pe++)for(oe[pe]=Ne,H=0;H<1<<V[pe];H++)X[Ne++]=pe;for(Ne>>=7;pe<g;pe++)for(oe[pe]=Ne<<7,H=0;H<1<<V[pe]-7;H++)X[256+Ne++]=pe;for(ue=0;ue<=w;ue++)De[ue]=0;for(H=0;H<=143;)ce[2*H+1]=8,H++,De[8]++;for(;H<=255;)ce[2*H+1]=9,H++,De[9]++;for(;H<=279;)ce[2*H+1]=7,H++,De[7]++;for(;H<=287;)ce[2*H+1]=8,H++,De[8]++;for(U(ce,x+1,De),H=0;H<g;H++)F[2*H+1]=5,F[2*H]=re(H,5);te=new Ee(ce,R,p+1,x,w),Y=new Ee(F,V,0,g,w),ve=new Ee(new Array(0),I,0,v,S)})(),M=!0),j.l_desc=new K(j.dyn_ltree,te),j.d_desc=new K(j.dyn_dtree,Y),j.bl_desc=new K(j.bl_tree,ve),j.bi_buf=0,j.bi_valid=0,L(j)},s._tr_stored_block=A,s._tr_flush_block=function(j,H,ue,ye){var pe,Ne,De=0;0<j.level?(j.strm.data_type===2&&(j.strm.data_type=(function(Fe){var Ke,st=4093624447;for(Ke=0;Ke<=31;Ke++,st>>>=1)if(1&st&&Fe.dyn_ltree[2*Ke]!==0)return i;if(Fe.dyn_ltree[18]!==0||Fe.dyn_ltree[20]!==0||Fe.dyn_ltree[26]!==0)return o;for(Ke=32;Ke<p;Ke++)if(Fe.dyn_ltree[2*Ke]!==0)return o;return i})(j)),be(j,j.l_desc),be(j,j.d_desc),De=(function(Fe){var Ke;for(z(Fe,Fe.dyn_ltree,Fe.l_desc.max_code),z(Fe,Fe.dyn_dtree,Fe.d_desc.max_code),be(Fe,Fe.bl_desc),Ke=v-1;3<=Ke&&Fe.bl_tree[2*Z[Ke]+1]===0;Ke--);return Fe.opt_len+=3*(Ke+1)+5+5+4,Ke})(j),pe=j.opt_len+3+7>>>3,(Ne=j.static_len+3+7>>>3)<=pe&&(pe=Ne)):pe=Ne=ue+5,ue+4<=pe&&H!==-1?A(j,H,ue,ye):j.strategy===4||Ne===pe?(W(j,2+(ye?1:0),3),B(j,ce,F)):(W(j,4+(ye?1:0),3),(function(Fe,Ke,st,at){var Gt;for(W(Fe,Ke-257,5),W(Fe,st-1,5),W(Fe,at-4,4),Gt=0;Gt<at;Gt++)W(Fe,Fe.bl_tree[2*Z[Gt]+1],3);he(Fe,Fe.dyn_ltree,Ke-1),he(Fe,Fe.dyn_dtree,st-1)})(j,j.l_desc.max_code+1,j.d_desc.max_code+1,De+1),B(j,j.dyn_ltree,j.dyn_dtree)),L(j),ye&&se(j)},s._tr_tally=function(j,H,ue){return j.pending_buf[j.d_buf+2*j.last_lit]=H>>>8&255,j.pending_buf[j.d_buf+2*j.last_lit+1]=255&H,j.pending_buf[j.l_buf+j.last_lit]=255&ue,j.last_lit++,H===0?j.dyn_ltree[2*ue]++:(j.matches++,H--,j.dyn_ltree[2*(P[ue]+p+1)]++,j.dyn_dtree[2*D(H)]++),j.last_lit===j.lit_bufsize-1},s._tr_align=function(j){W(j,2,3),J(j,E,ce),(function(H){H.bi_valid===16?(q(H,H.bi_buf),H.bi_buf=0,H.bi_valid=0):8<=H.bi_valid&&(H.pending_buf[H.pending++]=255&H.bi_buf,H.bi_buf>>=8,H.bi_valid-=8)})(j)}},{"../utils/common":41}],53:[function(r,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,s){(function(a){(function(i,o){if(!i.setImmediate){var c,f,h,p,x=1,g={},v=!1,y=i.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(i);w=w&&w.setTimeout?w:i,c={}.toString.call(i.process)==="[object process]"?function(N){Mt.nextTick(function(){S(N)})}:(function(){if(i.postMessage&&!i.importScripts){var N=!0,k=i.onmessage;return i.onmessage=function(){N=!1},i.postMessage("","*"),i.onmessage=k,N}})()?(p="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",E,!1):i.attachEvent("onmessage",E),function(N){i.postMessage(p+N,"*")}):i.MessageChannel?((h=new MessageChannel).port1.onmessage=function(N){S(N.data)},function(N){h.port2.postMessage(N)}):y&&"onreadystatechange"in y.createElement("script")?(f=y.documentElement,function(N){var k=y.createElement("script");k.onreadystatechange=function(){S(N),k.onreadystatechange=null,f.removeChild(k),k=null},f.appendChild(k)}):function(N){setTimeout(S,0,N)},w.setImmediate=function(N){typeof N!="function"&&(N=new Function(""+N));for(var k=new Array(arguments.length-1),O=0;O<k.length;O++)k[O]=arguments[O+1];var R={callback:N,args:k};return g[x]=R,c(x),x++},w.clearImmediate=_}function _(N){delete g[N]}function S(N){if(v)setTimeout(S,0,N);else{var k=g[N];if(k){v=!0;try{(function(O){var R=O.callback,V=O.args;switch(V.length){case 0:R();break;case 1:R(V[0]);break;case 2:R(V[0],V[1]);break;case 3:R(V[0],V[1],V[2]);break;default:R.apply(o,V)}})(k)}finally{_(N),v=!1}}}}function E(N){N.source===i&&typeof N.data=="string"&&N.data.indexOf(p)===0&&S(+N.data.slice(p.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof Pi<"u"?Pi:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(t_)),t_.exports}var owe=iwe();const lwe=TN(owe);var wh={exports:{}},r_,vO;function cwe(){if(vO)return r_;vO=1;var e={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function t(r){return r&&r.replace?r.replace(/([&"<>'])/g,function(n,s){return e[s]}):r}return r_=t,r_}var bO;function uwe(){if(bO)return wh.exports;bO=1;var e=cwe(),t=ON().Stream,r="    ";function n(f,h){typeof h!="object"&&(h={indent:h});var p=h.stream?new t:null,x="",g=!1,v=h.indent?h.indent===!0?r:h.indent:"",y=!0;function w(k){y?Mt.nextTick(k):k()}function _(k,O){if(O!==void 0&&(x+=O),k&&!g&&(p=p||new t,g=!0),k&&g){var R=x;w(function(){p.emit("data",R)}),x=""}}function S(k,O){o(_,i(k,v,v?1:0),O)}function E(){if(p){var k=x;w(function(){p.emit("data",k),p.emit("end"),p.readable=!1,p.emit("close")})}}function N(k){var O=k.encoding||"UTF-8",R={version:"1.0",encoding:O};k.standalone&&(R.standalone=k.standalone),S({"?xml":{_attr:R}}),x=x.replace("/>","?>")}return w(function(){y=!1}),h.declaration&&N(h.declaration),f&&f.forEach?f.forEach(function(k,O){var R;O+1===f.length&&(R=E),S(k,R)}):S(f,E),p?(p.readable=!0,p):x}function s(){var f=Array.prototype.slice.call(arguments),h={_elem:i(f)};return h.push=function(p){if(!this.append)throw new Error("not assigned to a parent!");var x=this,g=this._elem.indent;o(this.append,i(p,g,this._elem.icount+(g?1:0)),function(){x.append(!0)})},h.close=function(p){p!==void 0&&this.push(p),this.end&&this.end()},h}function a(f,h){return new Array(h||0).join(f||"")}function i(f,h,p){p=p||0;var x=a(h,p),g,v=f,y=!1;if(typeof f=="object"){var w=Object.keys(f);if(g=w[0],v=f[g],v&&v._elem)return v._elem.name=g,v._elem.icount=p,v._elem.indent=h,v._elem.indents=x,v._elem.interrupt=v,v._elem}var _=[],S=[],E;function N(k){var O=Object.keys(k);O.forEach(function(R){_.push(c(R,k[R]))})}switch(typeof v){case"object":if(v===null)break;v._attr&&N(v._attr),v._cdata&&S.push(("<![CDATA["+v._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),v.forEach&&(E=!1,S.push(""),v.forEach(function(k){if(typeof k=="object"){var O=Object.keys(k)[0];O=="_attr"?N(k._attr):S.push(i(k,h,p+1))}else S.pop(),E=!0,S.push(e(k))}),E||S.push(""));break;default:S.push(e(v))}return{name:g,interrupt:y,attributes:_,content:S,icount:p,indents:x,indent:h}}function o(f,h,p){if(typeof h!="object")return f(!1,h);var x=h.interrupt?1:h.content.length;function g(){for(;h.content.length;){var y=h.content.shift();if(y!==void 0){if(v(y))return;o(f,y)}}f(!1,(x>1?h.indents:"")+(h.name?"</"+h.name+">":"")+(h.indent&&!p?`
`:"")),p&&p()}function v(y){return y.interrupt?(y.interrupt.append=f,y.interrupt.end=g,y.interrupt=!1,f(!0),!0):!1}if(f(!1,h.indents+(h.name?"<"+h.name:"")+(h.attributes.length?" "+h.attributes.join(" "):"")+(x?h.name?">":"":h.name?"/>":"")+(h.indent&&x>1?`
`:"")),!x)return f(!1,h.indent?`
`:"");v(h)||g()}function c(f,h){return f+'="'+e(h)+'"'}return wh.exports=n,wh.exports.element=wh.exports.Element=s,wh.exports}var fwe=uwe();const Ur=TN(fwe),_h=0,n_=32,dwe=32,hwe=(e,t)=>{const r=t.replace(/-/g,"");if(r.length!==dwe)throw new Error(`Error: Cannot extract GUID from font filename: ${t}`);const s=r.replace(/(..)/g,"$1 ").trim().split(" ").map(c=>parseInt(c,16));s.reverse();const i=e.slice(_h,n_).map((c,f)=>c^s[f%s.length]),o=new Uint8Array(_h+i.length+Math.max(0,e.length-n_));return o.set(e.slice(0,_h)),o.set(i,_h),o.set(e.slice(n_),_h+i.length),o};class pwe{format(t,r={stack:[]}){const n=t.prepForXml(r);if(n)return n;throw Error("XMLComponent did not format correctly")}}class mwe{replace(t,r,n){let s=t;return r.forEach((a,i)=>{s=s.replace(new RegExp(`{${a.fileName}}`,"g"),(n+i).toString())}),s}getMediaData(t,r){return r.Array.filter(n=>t.search(`{${n.fileName}}`)>0)}}class xwe{replace(t,r){let n=t;for(const s of r)n=n.replace(new RegExp(`{${s.reference}-${s.instance}}`,"g"),s.numId.toString());return n}}class gwe{constructor(){Pe(this,"formatter"),Pe(this,"imageReplacer"),Pe(this,"numberingReplacer"),this.formatter=new pwe,this.imageReplacer=new mwe,this.numberingReplacer=new xwe}compile(t,r,n=[]){const s=new lwe,a=this.xmlifyFile(t,r),i=new Map(Object.entries(a));for(const[,o]of i)if(Array.isArray(o))for(const c of o)s.file(c.path,c.data);else s.file(o.path,o.data);for(const o of n)s.file(o.path,o.data);for(const o of t.Media.Array)o.type!=="svg"?s.file(`word/media/${o.fileName}`,o.data):(s.file(`word/media/${o.fileName}`,o.data),s.file(`word/media/${o.fallback.fileName}`,o.fallback.data));for(const{data:o,name:c,fontKey:f}of t.FontTable.fontOptionsWithKey){const[h]=c.split(".");s.file(`word/fonts/${h}.odttf`,hwe(o,f))}return s}xmlifyFile(t,r){const n=t.Document.Relationships.RelationshipCount+1,s=Ur(this.formatter.format(t.Document.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),a=t.Comments.Relationships.RelationshipCount+1,i=Ur(this.formatter.format(t.Comments,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=this.imageReplacer.getMediaData(s,t.Media),c=this.imageReplacer.getMediaData(i,t.Media);return{Relationships:{data:(o.forEach((f,h)=>{t.Document.Relationships.createRelationship(n+h,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${f.fileName}`)}),t.Document.Relationships.createRelationship(t.Document.Relationships.RelationshipCount+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable","fontTable.xml"),Ur(this.formatter.format(t.Document.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const f=this.imageReplacer.replace(s,o,n);return this.numberingReplacer.replace(f,t.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const f=Ur(this.formatter.format(t.Styles,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(f,t.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:Ur(this.formatter.format(t.CoreProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:Ur(this.formatter.format(t.Numbering,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:Ur(this.formatter.format(t.FileRelationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:t.Headers.map((f,h)=>{const p=Ur(this.formatter.format(f.View,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(p,t.Media).forEach((g,v)=>{f.Relationships.createRelationship(v,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${g.fileName}`)}),{data:Ur(this.formatter.format(f.Relationships,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${h+1}.xml.rels`}}),FooterRelationships:t.Footers.map((f,h)=>{const p=Ur(this.formatter.format(f.View,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(p,t.Media).forEach((g,v)=>{f.Relationships.createRelationship(v,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${g.fileName}`)}),{data:Ur(this.formatter.format(f.Relationships,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${h+1}.xml.rels`}}),Headers:t.Headers.map((f,h)=>{const p=Ur(this.formatter.format(f.View,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),x=this.imageReplacer.getMediaData(p,t.Media),g=this.imageReplacer.replace(p,x,0);return{data:this.numberingReplacer.replace(g,t.Numbering.ConcreteNumbering),path:`word/header${h+1}.xml`}}),Footers:t.Footers.map((f,h)=>{const p=Ur(this.formatter.format(f.View,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),x=this.imageReplacer.getMediaData(p,t.Media),g=this.imageReplacer.replace(p,x,0);return{data:this.numberingReplacer.replace(g,t.Numbering.ConcreteNumbering),path:`word/footer${h+1}.xml`}}),ContentTypes:{data:Ur(this.formatter.format(t.ContentTypes,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:Ur(this.formatter.format(t.CustomProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:Ur(this.formatter.format(t.AppProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:Ur(this.formatter.format(t.FootNotes.View,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:Ur(this.formatter.format(t.FootNotes.Relationships,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:Ur(this.formatter.format(t.Settings,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:(()=>{const f=this.imageReplacer.replace(i,c,a);return this.numberingReplacer.replace(f,t.Numbering.ConcreteNumbering)})(),path:"word/comments.xml"},CommentsRelationships:{data:(c.forEach((f,h)=>{t.Comments.Relationships.createRelationship(a+h,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${f.fileName}`)}),Ur(this.formatter.format(t.Comments.Relationships,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/comments.xml.rels"},FontTable:{data:Ur(this.formatter.format(t.FontTable.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:Ur(this.formatter.format(t.FontTable.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const ywe={WITH_2_BLANKS:"  "},wO=e=>e===!0?ywe.WITH_2_BLANKS:e===!1?void 0:e,gB=class ff{static pack(t,r,n){return Wxe(this,arguments,function*(s,a,i,o=[]){return this.compiler.compile(s,wO(i),o).generateAsync({type:a,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toString(t,r,n=[]){return ff.pack(t,"string",r,n)}static toBuffer(t,r,n=[]){return ff.pack(t,"nodebuffer",r,n)}static toBase64String(t,r,n=[]){return ff.pack(t,"base64",r,n)}static toBlob(t,r,n=[]){return ff.pack(t,"blob",r,n)}static toArrayBuffer(t,r,n=[]){return ff.pack(t,"arraybuffer",r,n)}static toStream(t,r,n=[]){const s=new awe.Stream;return this.compiler.compile(t,wO(r),n).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(i=>{s.emit("data",i),s.emit("end")}),s}};Pe(gB,"compiler",new gwe);let vwe=gB;var Bx={exports:{}},bwe=Bx.exports,_O;function wwe(){return _O||(_O=1,(function(e,t){(function(r,n){n()})(bwe,function(){function r(f,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}function n(f,h,p){var x=new XMLHttpRequest;x.open("GET",f),x.responseType="blob",x.onload=function(){c(x.response,h,p)},x.onerror=function(){console.error("could not download file")},x.send()}function s(f){var h=new XMLHttpRequest;h.open("HEAD",f,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function a(f){try{f.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),f.dispatchEvent(h)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Cm=="object"&&Cm.global===Cm?Cm:void 0,o=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(f,h,p){var x=i.URL||i.webkitURL,g=document.createElement("a");h=h||f.name||"download",g.download=h,g.rel="noopener",typeof f=="string"?(g.href=f,g.origin===location.origin?a(g):s(g.href)?n(f,h,p):a(g,g.target="_blank")):(g.href=x.createObjectURL(f),setTimeout(function(){x.revokeObjectURL(g.href)},4e4),setTimeout(function(){a(g)},0))}:"msSaveOrOpenBlob"in navigator?function(f,h,p){if(h=h||f.name||"download",typeof f!="string")navigator.msSaveOrOpenBlob(r(f,p),h);else if(s(f))n(f,h,p);else{var x=document.createElement("a");x.href=f,x.target="_blank",setTimeout(function(){a(x)})}}:function(f,h,p,x){if(x=x||open("","_blank"),x&&(x.document.title=x.document.body.innerText="downloading..."),typeof f=="string")return n(f,h,p);var g=f.type==="application/octet-stream",v=/constructor/i.test(i.HTMLElement)||i.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||g&&v||o)&&typeof FileReader<"u"){var w=new FileReader;w.onloadend=function(){var E=w.result;E=y?E:E.replace(/^data:[^;]*;/,"data:attachment/file;"),x?x.location.href=E:location=E,x=null},w.readAsDataURL(f)}else{var _=i.URL||i.webkitURL,S=_.createObjectURL(f);x?x.location=S:location.href=S,x=null,setTimeout(function(){_.revokeObjectURL(S)},4e4)}});i.saveAs=c.saveAs=c,e.exports=c})})(Bx)),Bx.exports}var _we=wwe();const Ewe=async(e,t)=>{var i;const r=[];try{const c=await(await fetch(t.logoUrl)).arrayBuffer();r.push(new Oc({children:[new Bye({data:c,transformation:{width:120,height:60}})],alignment:Oa.RIGHT}))}catch(o){console.error("Failed to load logo for DOCX",o)}const n=o=>{var c;if(o.type==="paragraph"){const f=(o.content||[]).map(h=>{var p,x,g;return h.type==="text"?new Ec({text:h.text,bold:(p=h.marks)==null?void 0:p.some(v=>v.type==="bold"),italics:(x=h.marks)==null?void 0:x.some(v=>v.type==="italic"),underline:(g=h.marks)!=null&&g.some(v=>v.type==="underline")?{}:void 0,font:"Times New Roman",size:24}):h.type==="hardBreak"?new Ec({break:1}):null}).filter(Boolean);r.push(new Oc({children:f,spacing:{after:240,line:360}}))}else if(o.type==="bulletList"||o.type==="orderedList")(c=o.content)==null||c.forEach(f=>{var h;f.type==="listItem"&&((h=f.content)==null||h.forEach(p=>{if(p.type==="paragraph"){const x=(p.content||[]).map(g=>{var v,y,w;return g.type==="text"?new Ec({text:g.text,bold:(v=g.marks)==null?void 0:v.some(_=>_.type==="bold"),italics:(y=g.marks)==null?void 0:y.some(_=>_.type==="italic"),underline:(w=g.marks)!=null&&w.some(_=>_.type==="underline")?{}:void 0,font:"Times New Roman",size:24}):g.type==="hardBreak"?new Ec({break:1}):null}).filter(Boolean);r.push(new Oc({children:x,bullet:o.type==="bulletList"?{level:0}:void 0,numbering:o.type==="orderedList"?{reference:"primary-numbering",level:0}:void 0,spacing:{after:120,line:360}}))}}))});else if(o.type==="heading"){const f=(o.content||[]).map(h=>h.type==="text"?new Ec({text:h.text,bold:!0,font:"Times New Roman",size:32-o.attrs.level*2}):null).filter(Boolean);r.push(new Oc({children:f,spacing:{before:240,after:120}}))}};(i=e.content)==null||i.forEach(n);const s=new swe({numbering:{config:[{reference:"primary-numbering",levels:[{level:0,format:"lowerLetter",text:"%1)",alignment:Oa.LEFT}]}]},sections:[{children:r}]}),a=await vwe.toBlob(s);_we.saveAs(a,`${t.fileName}.docx`)},Swe=()=>{const{documentConfig:e,formData:t,setCurrentStep:r,validationErrors:n,resetWorkflow:s}=C1(),a=ne.useRef(null),[i,o]=ne.useState(!1),[c,f]=ne.useState(!1),[h,p]=ne.useState(!1),[x,g]=ne.useState(!1),[v,y]=ne.useState(!1),[w,_]=ne.useState(null),[S,E]=ne.useState(""),[N,k]=ne.useState(!1),[O,R]=ne.useState(!1);We.useEffect(()=>{const F=setTimeout(()=>{a.current&&(E(a.current.innerHTML),k(!0))},100);return()=>clearTimeout(F)},[]);const V={bg:"#f5f7f9",fg:"#1b2531",muted:"#627383",border:"#d9e0e8",destructive:"#df3a3a",secondaryBg:"#f8fafc"};if(!e)return null;const I=n.length===0,Z=async()=>{if(w){p(!0);try{await Ewe(w,{logoUrl:"/logo.png",fileName:e.name}),y(!0)}catch(F){console.error("Download failed",F)}finally{p(!1)}}},ce=()=>{v?g(!0):Z()};return d.jsxs("div",{className:"min-h-screen p-6 lg:p-10 animate-fade-in",style:{backgroundColor:V.bg},children:[d.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10 animate-slide-up",children:d.jsxs("div",{className:"space-y-1",children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight",style:{color:V.fg},children:"Document Preview"}),d.jsx("p",{className:"font-medium",style:{color:V.muted},children:"Review your generated content and field values before final export."})]})}),!I&&d.jsxs("div",{className:"flex items-center gap-4 p-4 mb-8 rounded-2xl border animate-slide-up",style:{backgroundColor:`${V.destructive}0D`,borderColor:`${V.destructive}40`},children:[d.jsx("div",{className:"p-2 rounded-xl bg-white shadow-sm",children:d.jsx(v1,{className:"w-5 h-5",style:{color:V.destructive},strokeWidth:2.5})}),d.jsx("span",{className:"text-sm font-bold",style:{color:V.fg},children:"Warning: Some required fields are missing or invalid. Please fix them before generating."})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start",children:[d.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl shadow-sm border border-transparent overflow-hidden animate-slide-up",children:[d.jsx("div",{className:"px-6 py-7.5 border-b",style:{backgroundColor:V.secondaryBg,borderColor:V.border},children:d.jsx("h3",{className:"text-sm font-black uppercase tracking-widest",style:{color:V.muted},children:"Field Summary"})}),d.jsx("div",{className:"p-6 max-h-[1155px] overflow-y-auto",children:d.jsx("div",{className:"space-y-4",children:e.fields.map(F=>d.jsxs("div",{className:"group",children:[d.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest mb-1",style:{color:V.muted},children:F.label}),d.jsx("p",{className:"text-sm font-bold truncate",style:{color:V.fg},children:t[F.id]||d.jsx("span",{className:"opacity-30",children:""})}),d.jsx("div",{className:"h-px w-full mt-3",style:{backgroundColor:V.bg}})]},F.id))})})]}),d.jsxs("div",{className:"lg:col-span-3 bg-white rounded-2xl shadow-sm border border-transparent overflow-hidden animate-slide-up",children:[d.jsxs("div",{className:"px-8 py-5 border-b flex items-center justify-between gap-3",style:{backgroundColor:V.secondaryBg,borderColor:V.border},children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(La,{className:"w-5 h-5 text-[#3399cc]"}),d.jsx("h3",{className:"text-sm font-black uppercase tracking-widest",style:{color:V.muted},children:"Preview"})]}),d.jsx("button",{onClick:()=>R(!O),className:`flex items-center gap-2 px-5 py-2.5 rounded-xl border transition-all active:scale-95 font-bold text-sm shadow-sm
            ${O?"btn-primary":"bg-white text-slate-600 border-slate-300 hover:bg-slate-50 hover:text-slate-900"}`,children:O?d.jsxs(d.Fragment,{children:[d.jsx(us,{className:"w-4 h-4"}),"Done"]}):d.jsxs(d.Fragment,{children:[d.jsx(BX,{className:"w-4 h-4"}),"Edit"]})})]}),d.jsxs("div",{className:"p-0 bg-slate-100/50 relative",children:[!N&&d.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/50 backdrop-blur-sm",children:d.jsxs("div",{className:"flex flex-col items-center gap-3",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#24548f]"}),d.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Preparing Editor..."})]})}),d.jsx("div",{ref:a,className:"hidden",children:d.jsx(Wce,{documentId:e.id,data:{...t,submissionDate:new Date().toLocaleDateString("en-US"),gsaOfficeCityStateZip:`${t.gsaOfficeCity||""}, ${t.gsaOfficeState||""} ${t.gsaOfficeZip||""}`}})}),N&&S&&d.jsx(Bxe,{content:S,onChange:F=>_(F),editable:O})]})]})]}),d.jsxs("div",{className:"mt-10 flex items-center justify-between pb-10 animate-slide-up",children:[c?d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("button",{onClick:s,className:"px-6 py-3 rounded-xl border border-slate-200 text-slate-600 font-bold hover:bg-slate-50 transition-colors flex items-center gap-2",children:[d.jsx(La,{className:"w-4 h-4",strokeWidth:3}),"Generate Another"]}),d.jsxs("div",{className:"flex items-center gap-2 text-green-600 font-bold animate-fade-in px-4 py-2 bg-green-50 rounded-lg border border-green-200",children:[d.jsx(us,{className:"w-5 h-5"}),d.jsx("span",{children:"Document Ready!"})]})]}):d.jsxs("button",{onClick:()=>r("form-entry"),className:"flex items-center gap-2 px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-600 text-sm font-bold transition-all hover:bg-slate-50 active:scale-95 shadow-sm hover:text-slate-900",children:[d.jsx(Es,{className:"w-4 h-4",strokeWidth:3}),"Back to Form"]}),d.jsx("button",{onClick:()=>c?ce():o(!0),disabled:h||O,className:"btn-primary",children:h?"Processing...":d.jsxs(d.Fragment,{children:[d.jsx(Rf,{className:"w-4 h-4",strokeWidth:3}),c?"Download Final DOCX":"Generate Document"]})})]}),i&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6 space-y-5 animate-in fade-in zoom-in",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(us,{className:"w-6 h-6 text-[#3399cc]"}),d.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Ready to generate?"})]}),d.jsx("p",{className:"text-sm text-slate-600",children:"Please ensure all field values are accurate. This will finalize the formatting and prepare your download."}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[d.jsx("button",{className:"px-4 py-2 rounded-xl text-sm font-semibold text-slate-600 hover:bg-slate-100 transition-colors",onClick:()=>o(!1),children:"Cancel"}),d.jsx("button",{className:"px-4 py-2 rounded-xl text-sm font-semibold bg-[#3399cc] text-white hover:bg-[#287ab0] transition-colors",onClick:()=>{f(!0),o(!1)},children:"Confirm & Finalize"})]})]})}),x&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6 space-y-5 animate-in fade-in zoom-in",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Rf,{className:"w-6 h-6 text-amber-500"}),d.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Download Again?"})]}),d.jsx("p",{className:"text-sm text-slate-600",children:"You have already downloaded this document recently. Would you like to download a new copy?"}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[d.jsx("button",{className:"px-4 py-2 rounded-xl text-sm font-semibold text-slate-600 hover:bg-slate-100 transition-colors",onClick:()=>g(!1),children:"Cancel"}),d.jsx("button",{className:"px-4 py-2 rounded-xl text-sm font-semibold bg-amber-500 text-white hover:bg-amber-600 transition-colors",onClick:()=>{g(!1),Z()},children:"Yes, Download Again"})]})]})})]})},Nwe=(e,t)=>{switch(e){case"addition":return console.log("adedd"),d.jsx(MM,{data:t});case"deletion":return d.jsx(FM,{data:t});case"price-increase-epa":return d.jsx(PM,{data:t});default:return null}},Twe=()=>{const e=Ln(),{documentConfig:t,formData:r,generateDocument:n,addToHistory:s,resetWorkflow:a,setCurrentStep:i}=C1(),[o,c]=ne.useState(!1),[f,h]=ne.useState(null),[p,x]=ne.useState(null),[g,v]=ne.useState(!1),y=ne.useRef(null);if(!t)return null;const w=IM(t.id),_=async()=>{c(!0),await new Promise(O=>setTimeout(O,2e3));const k=n();x(k),s(k),c(!1)},S=async k=>{if(!(!p||!t)){h(k);try{wn.success(`${k.toUpperCase()} downloaded successfully!`)}catch(O){console.error(O),wn.error(`Failed to download ${k.toUpperCase()}`)}finally{h(null)}}},E=()=>{navigator.clipboard.writeText("Share link copied"),alert("Share link copied to clipboard!")},N=()=>{a(),e("/documents")};return d.jsxs("div",{className:"animate-fade-in max-w-3xl mx-auto",children:[d.jsx("div",{id:"document-preview-content",ref:y,className:"fixed left-[-9999px] top-0 w-[794px] bg-white text-black",children:w&&Nwe(w,{...r,...p})}),d.jsxs("div",{className:"mb-8 text-center",children:[d.jsx("h2",{className:"text-2xl font-semibold mb-2",children:p?"Document Generated":"Generate Document"}),d.jsx("p",{className:"text-muted-foreground",children:p?"Your document has been successfully created.":"Confirm generation to create your document files."})]}),p?d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"border border-green-300 bg-green-50 rounded-lg p-6 flex items-center gap-4",children:[d.jsx(us,{className:"w-6 h-6 text-green-600"}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-green-700",children:"Document Successfully Generated"}),d.jsx("p",{className:"text-sm text-green-600",children:"Ready for download and distribution."})]})]}),d.jsxs("div",{className:"border rounded-lg p-6",children:[d.jsx("h3",{className:"font-semibold mb-4",children:"Document Details"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(cD,{className:"w-4 h-4"}),p.id]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(La,{className:"w-4 h-4"}),p.version]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Y0,{className:"w-4 h-4"}),p.generatedBy]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Bi,{className:"w-4 h-4"}),new Date(p.generatedAt).toLocaleString()]})]}),d.jsxs("div",{className:"mt-4",children:["Status:"," ",d.jsx("span",{className:"font-medium",children:g?"Approved":"Generated"})]})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[d.jsxs("button",{onClick:()=>S("pdf"),disabled:f!==null,className:"border rounded py-4 flex flex-col items-center gap-2",children:[f==="pdf"?d.jsx(ar,{className:"animate-spin"}):d.jsx(Rf,{}),"Download PDF"]}),d.jsxs("button",{onClick:()=>S("doc"),disabled:f!==null,className:"border rounded py-4 flex flex-col items-center gap-2",children:[f==="doc"?d.jsx(ar,{className:"animate-spin"}):d.jsx(Rf,{}),"Download DOC"]}),d.jsxs("button",{onClick:E,className:"border rounded py-4 flex flex-col items-center gap-2",children:[d.jsx(tY,{}),"Share"]})]}),d.jsxs("div",{className:"border-t border-slate-200 pt-6 mt-6",children:[d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Would you like to generate another document?"}),d.jsx("p",{className:"text-sm text-slate-500",children:"You can create additional modification documents or return to the dashboard"})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[d.jsxs("button",{onClick:N,className:"flex items-center justify-center gap-2 bg-[#3399cc] hover:bg-[#2980b9] text-white rounded-lg px-6 py-3 font-semibold transition-all shadow-md hover:shadow-lg",children:[d.jsx(La,{className:"w-5 h-5"}),"Generate Another Document"]}),d.jsxs("button",{onClick:()=>e("/analysis-history"),className:"flex items-center justify-center gap-2 bg-white hover:bg-slate-50 text-slate-700 border border-slate-300 rounded-lg px-6 py-3 font-semibold transition-all",children:[d.jsx(us,{className:"w-5 h-5"}),"Done"]})]})]})]}):d.jsxs("div",{className:"border rounded-lg p-8 text-center",children:[d.jsx("div",{className:"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-6",children:d.jsx(La,{className:"w-10 h-10 text-primary"})}),d.jsx("h3",{className:"text-xl font-semibold mb-6",children:t.name}),d.jsxs("div",{className:"flex justify-center gap-4",children:[d.jsxs("button",{onClick:()=>i("preview"),className:"flex items-center gap-2 border rounded px-5 py-2",children:[d.jsx(Es,{className:"w-4 h-4"}),"Back to Preview"]}),d.jsx("button",{onClick:_,disabled:o,className:`flex items-center gap-2 text-white rounded px-6 py-2 transition-all ${o?"bg-slate-400 cursor-not-allowed":"bg-[#3399cc] hover:bg-[#2980b9] shadow-md hover:shadow-lg"}`,children:o?d.jsxs(d.Fragment,{children:[d.jsx(ar,{className:"w-4 h-4 animate-spin"}),"Generating..."]}):d.jsxs(d.Fragment,{children:[d.jsx(JK,{className:"w-4 h-4"}),"Generate Document"]})})]})]})]})},kwe=()=>{const{currentStep:e,selectedDocumentType:t,loadDocumentConfig:r,setCurrentStep:n,analysisSummary:s}=C1(),[a]=aK(),i=a.get("job_id");ne.useEffect(()=>{!t&&Ox.length>0&&(r(Ox[0].id,i||void 0),n("form-entry"))},[t,r,i,n]);const o=h=>{r(h,i||void 0),n("form-entry")},f=!i||!t||!s?null:{"add-product":Number(s.products_added||0),"delete-product":Number(s.products_deleted||0),"price-increase":Number(s.price_increased||0),"price-decrease":Number(s.price_decreased||0),"description-change":Number(s.description_changed||0)}[t]===0?`No ${{"add-product":"additions","delete-product":"deletions","price-increase":"price increases","price-decrease":"price decreases","description-change":"description changes"}[t]||"modifications"} were detected in the analysis for this document type.`:null;return e==="preview"?d.jsx(Swe,{}):e==="generate"?d.jsx(Twe,{}):d.jsx("div",{className:"min-h-screen bg-slate-50/50 p-6 lg:p-10 space-y-8 animate-fade-in",children:d.jsxs("div",{className:"mx-auto  space-y-10",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:"Generate Documents"}),d.jsx("p",{className:"text-slate-500 font-medium",children:"Select a document type to pre-fill and generate"})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:Ox.map(h=>d.jsx(zce,{config:h,isSelected:t===h.id,onSelect:()=>o(h.id),variant:"horizontal"},h.id))}),d.jsx("div",{className:"pt-2",children:e==="load-config"?d.jsxs("div",{className:"py-20 text-center bg-white rounded-3xl border border-slate-200",children:[d.jsx(ar,{className:"w-8 h-8 animate-spin m-auto text-[#24548f]"}),d.jsx("p",{className:"mt-4 text-slate-500 font-medium",children:"Loading configuration..."})]}):f?d.jsxs("div",{className:"py-24 text-center bg-white rounded-3xl border border-slate-200 shadow-sm animate-fade-in",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No Modifications Found"}),d.jsx("p",{className:"text-slate-500 font-medium max-w-md m-auto px-6 whitespace-pre-line",children:f})]}):d.jsx(Hce,{})})]})})};function Awe({onDownloadHistory:e}){return d.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-12 mx-auto",children:d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"Analysis History"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"View and manage all past price list analyses"})]})})}function Cwe({searchQuery:e,setSearchQuery:t,clientFilter:r,setClientFilter:n,statusFilter:s,setStatusFilter:a,dateFrom:i,setDateFrom:o,dateTo:c,setDateTo:f,clientOptions:h,onClearFilters:p}){return d.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-slate-200",children:[d.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(iX,{className:"w-4 h-4 text-[#3399cc]"}),d.jsx("h2",{className:"text-sm font-bold text-slate-800",children:"Filters"})]}),d.jsx("button",{onClick:p,className:"text-sm font-semibold text-[#3399cc] hover:underline",children:"Clear all"})]}),d.jsx("div",{className:"p-6",children:d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Search"}),d.jsxs("div",{className:"relative",children:[d.jsx(Wl,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsx("input",{value:e,onChange:x=>t(x.target.value),placeholder:"Search by ID, client, or contract...",className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium"})]})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Client"}),d.jsxs("div",{className:"relative",children:[d.jsx(In,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsxs("select",{value:r,onChange:x=>n(x.target.value),className:"w-full text-slate-500 appearance-none pl-11 pr-10 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium",children:[d.jsx("option",{value:"All",children:"All Clients"}),h.map(x=>d.jsx("option",{value:x,children:x},x))]}),d.jsx(i0,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Status"}),d.jsxs("div",{className:"relative",children:[d.jsx(us,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsxs("select",{value:s,onChange:x=>a(x.target.value),className:"w-full text-slate-500 appearance-none pl-11 pr-10 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium",children:[d.jsx("option",{value:"All",children:"All Status"}),d.jsx("option",{value:"pending",children:"Pending"}),d.jsx("option",{value:"approved",children:"Approved"}),d.jsx("option",{value:"rejected",children:"Rejected"})]}),d.jsx(i0,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Date Range"}),d.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[d.jsx("div",{className:"relative flex-1",children:d.jsx("input",{type:"date",value:i?i.toISOString().split("T")[0]:"",onChange:x=>o(x.target.value?new Date(x.target.value):void 0),className:"w-full text-slate-500 px-4 pr-3 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium"})}),d.jsx("div",{className:"relative flex-1",children:d.jsx("input",{type:"date",value:c?c.toISOString().split("T")[0]:"",onChange:x=>f(x.target.value?new Date(x.target.value):void 0),className:"w-full text-slate-500 px-4 pr-3 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium"})})]})]})]})})]})}function EO({summary:e,hasModifications:t}){return d.jsxs("div",{className:"flex items-center gap-2 text-xs flex-wrap",children:[e.additions>0&&d.jsxs("span",{className:"flex items-center gap-1 text-emerald-600 font-bold",children:[d.jsx(ud,{className:"w-3 h-3"}),e.additions]}),e.deletions>0&&d.jsxs("span",{className:"flex items-center gap-1 text-rose-500 font-bold",children:[d.jsx(XE,{className:"w-3 h-3"}),e.deletions]}),e.priceIncreases>0&&d.jsxs("span",{className:"flex items-center gap-1 text-amber-600 font-bold",children:[d.jsx(Xc,{className:"w-3 h-3"}),e.priceIncreases]}),e.priceDecreases>0&&d.jsxs("span",{className:"flex items-center gap-1 text-blue-600 font-bold",children:[d.jsx(fd,{className:"w-3 h-3"}),e.priceDecreases]}),e.descriptionChanges>0&&d.jsxs("span",{className:"flex items-center gap-1 text-indigo-600 font-bold",children:[d.jsx(ou,{className:"w-3 h-3"}),e.descriptionChanges]}),!t&&d.jsx("span",{className:"text-slate-400 text-xs italic",children:"No modifications"})]})}function SO({item:e,updatingId:t,onUpdateStatus:r,onClose:n}){const s=Ln(),a=i=>{s(`/documents?job_id=${i}`)};return d.jsxs("div",{className:"absolute right-12 top-4 w-48 bg-white border border-slate-200 rounded-xl shadow-xl z-50 py-2 animate-in fade-in zoom-in duration-100",onClick:i=>i.stopPropagation(),children:[d.jsxs("button",{onClick:i=>{i.stopPropagation(),s(`/analyses/${e.job_id}`)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-slate-700 hover:bg-slate-50 transition-colors font-medium",children:[d.jsx(Co,{className:"w-4 h-4 text-slate-400"}),"View Details"]}),d.jsxs("button",{onClick:i=>{i.stopPropagation(),a(e.job_id)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-slate-700 hover:bg-slate-50 transition-colors font-medium",children:[d.jsx(La,{className:"w-4 h-4 text-slate-400"}),"Generate Docs"]}),lu(e.status)==="pending"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"my-1 border-t border-slate-100"}),d.jsxs("button",{onClick:i=>{i.stopPropagation(),r(e.job_id,"approve"),n()},disabled:t===e.job_id,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-emerald-600 hover:bg-emerald-50 transition-colors font-semibold disabled:opacity-50",children:[t===e.job_id?d.jsx(ar,{className:"w-4 h-4 animate-spin"}):d.jsx(us,{className:"w-4 h-4"}),"Approve Analysis"]}),d.jsxs("button",{onClick:i=>{i.stopPropagation(),r(e.job_id,"reject"),n()},disabled:t===e.job_id,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-rose-600 hover:bg-rose-50 transition-colors font-semibold disabled:opacity-50",children:[t===e.job_id?d.jsx(ar,{className:"w-4 h-4 animate-spin"}):d.jsx(Cf,{className:"w-4 h-4"}),"Reject Analysis"]})]})]})}function NO({currentPage:e,setCurrentPage:t,totalItems:r,itemsPerPage:n,startIndex:s}){const a=Math.ceil(r/n);return d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:s+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(s+n,r)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:r})," ","analyses"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:e===1,onClick:()=>t(e-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Es,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:(()=>{const i=[];for(let c=1;c<=a;c++)c===1||c===a||c>=e-1&&c<=e+1?i.push(c):i[i.length-1]!=="..."&&i.push("...");return i.map((c,f)=>d.jsx(We.Fragment,{children:c==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>t(Number(c)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                      ${e===c?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:c})},f))})()}),d.jsx("button",{disabled:e===a,onClick:()=>t(e+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})}const TO=e=>e?new Date(e).toLocaleTimeString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}):"",Rwe=e=>{const t={additions:0,deletions:0,priceIncreases:0,priceDecreases:0,descriptionChanges:0};return!e||!Array.isArray(e)||e.forEach(r=>{switch(r.action_type){case"NEW_PRODUCT":t.additions++;break;case"REMOVED_PRODUCT":t.deletions++;break;case"PRICE_INCREASE":t.priceIncreases++;break;case"PRICE_DECREASE":t.priceDecreases++;break;case"DESCRIPTION_CHANGE":t.descriptionChanges++;break}}),t},kO=e=>{const t=lu(e);if(t==="unknown")return d.jsx("span",{className:`${If} bg-slate-100 text-slate-700 border-slate-200`,children:"Unknown"});const{label:r,styles:n,icon:s}=Z0[t];return d.jsxs("span",{className:`${If} ${n}`,children:[d.jsx(s,{className:"w-3 h-3 stroke-[2.5px]"}),d.jsx("span",{className:"hidden sm:inline",children:r})]})};function jwe({analysisHistory:e,loading:t,currentPage:r,setCurrentPage:n,itemsPerPage:s,sortConfig:a,onSort:i,statusFilter:o,clientFilter:c,searchQuery:f,dateFrom:h,dateTo:p,updatingId:x,onUpdateStatus:g}){const v=Ln(),[y,w]=ne.useState(null);ne.useEffect(()=>{const k=()=>w(null);return window.addEventListener("click",k),()=>window.removeEventListener("click",k)},[]);const _=[...e].filter(k=>{var X,P,ie,te;const O=f.toLowerCase(),R=!O||((X=k.job_id)==null?void 0:X.toString().includes(O))||((P=k.client)==null?void 0:P.toLowerCase().includes(O))||((ie=k.user)==null?void 0:ie.toLowerCase().includes(O))||((te=k.contract_number)==null?void 0:te.toLowerCase().includes(O)),V=c==="All"||k.client===c,I=o==="All"||lu(k.status)===o,Z=new Date(k.created_time).getTime(),ce=!h||Z>=new Date(h).getTime(),F=!p||Z<=new Date(p).getTime();return R&&V&&I&&ce&&F}).sort((k,O)=>{if(a.key==="date"){const R=new Date(k.created_time).getTime(),V=new Date(O.created_time).getTime();return a.direction==="asc"?R-V:V-R}return 0}),S=_.length,E=(r-1)*s,N=_.slice(E,E+s);return d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200",children:[d.jsxs("div",{className:"hidden lg:block",children:[d.jsx("div",{className:"",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Analysis ID"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Client"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Modifications"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider cursor-pointer select-none",onClick:()=>i("date"),children:d.jsxs("div",{className:"flex items-center gap-1",children:["Date & Time",a.key==="date"&&(a.direction==="asc"?d.jsx(SK,{className:"w-3 h-3 stroke-[2.5px] text-slate-400"}):d.jsx(bK,{className:"w-3 h-3 text-slate-400"}))]})}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Analyzed By"}),d.jsx("th",{className:"text-right px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{children:t?d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading Analysis History..."})]})})}):N.length===0?d.jsx("tr",{children:d.jsxs("td",{colSpan:7,className:"p-12 text-center",children:[d.jsx(La,{className:"w-12 h-12 mx-auto text-slate-300 mb-4"}),d.jsx("p",{className:"text-lg font-bold text-slate-800 mb-2",children:"No analyses found"}),d.jsx("p",{className:"text-slate-500",children:"Try adjusting your search query"})]})}):N.map(k=>{const O=k.summary.additions>0||k.summary.deletions>0||k.summary.priceIncreases>0||k.summary.priceDecreases>0||k.summary.descriptionChanges>0;return d.jsxs("tr",{onClick:()=>v(`/analyses/${k.job_id}`),className:"cursor-pointer group border-b border-slate-50 hover:bg-slate-50/50 transition-colors",children:[d.jsx("td",{className:"p-4",children:d.jsxs("span",{className:"font-bold text-slate-800 text-sm group-hover:text-[#38A1DB] transition-colors",children:["ANAL-JOB-",k.job_id]})}),d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-blue-600/10",children:d.jsx(In,{className:"h-4 w-4 text-[#24578f]"})}),d.jsxs("div",{className:"leading-tight",children:[d.jsx("span",{className:"block font-semibold text-slate-800",children:k.client||""}),d.jsxs("span",{className:"text-xs font-medium text-slate-500",children:["(",k.contract_number||"No Contract",")"]})]})]})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"text-slate-500 font-medium text-sm",children:kO(k.status)})}),d.jsx("td",{className:"p-4",children:d.jsx(EO,{summary:k.summary,hasModifications:O})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[d.jsx(Bi,{className:"w-3.5 h-3.5 text-slate-400"}),d.jsx("div",{className:"leading-tight",children:d.jsx("div",{className:"text-sm font-medium",children:TO(k.created_time)})})]})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"px-2 text-slate-500 text-sm transition-colors",children:k.user})}),d.jsx("td",{className:"p-4 relative",children:d.jsxs("div",{className:"flex justify-end",children:[d.jsx("button",{onClick:R=>{R.stopPropagation(),w(y===k.job_id?null:k.job_id)},className:"p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-500",children:d.jsx(Ll,{className:"w-5 h-5"})}),y===k.job_id&&d.jsx(SO,{item:k,updatingId:x,onUpdateStatus:g,onClose:()=>w(null)})]})})]},k.job_id)})})]})}),S>s&&d.jsx(NO,{currentPage:r,setCurrentPage:n,totalItems:S,itemsPerPage:s,startIndex:E})]}),d.jsxs("div",{className:"block lg:hidden",children:[t?d.jsx("div",{className:"py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading Analysis History..."})]})}):N.length===0?d.jsxs("div",{className:"p-12 text-center",children:[d.jsx(La,{className:"w-12 h-12 mx-auto text-slate-300 mb-4"}),d.jsx("p",{className:"text-lg font-bold text-slate-800 mb-2",children:"No analyses found"}),d.jsx("p",{className:"text-slate-500",children:"Try adjusting your search query"})]}):d.jsx("div",{className:"divide-y divide-slate-100",children:N.map(k=>{const O=k.summary.additions>0||k.summary.deletions>0||k.summary.priceIncreases>0||k.summary.priceDecreases>0||k.summary.descriptionChanges>0;return d.jsxs("div",{onClick:()=>v(`/analyses/${k.job_id}`),className:"p-4 hover:bg-slate-50/50 transition-colors cursor-pointer",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"font-bold text-slate-800 text-sm mb-1",children:["ANAL-JOB-",k.job_id]}),d.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[d.jsx(Bi,{className:"w-3 h-3"}),d.jsx("span",{children:TO(k.created_time)})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[kO(k.status),d.jsx("button",{onClick:R=>{R.stopPropagation(),w(y===k.job_id?null:k.job_id)},className:"p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-500",children:d.jsx(Ll,{className:"w-5 h-5"})}),y===k.job_id&&d.jsx(SO,{item:k,updatingId:x,onUpdateStatus:g,onClose:()=>w(null)})]})]}),d.jsx("div",{className:"flex items-center gap-3 mb-3",children:d.jsxs("div",{className:"leading-tight min-w-0 flex-1",children:[d.jsx("div",{className:"font-semibold text-slate-800 truncate",children:k.client||""}),d.jsx("div",{className:"text-xs font-medium text-slate-500 truncate",children:k.contract_number||"No Contract"})]})}),d.jsx("div",{className:"mb-2",children:d.jsx(EO,{summary:k.summary,hasModifications:O})}),d.jsxs("div",{className:"text-xs text-slate-500",children:["Analyzed by ",d.jsx("span",{className:"font-medium text-slate-700",children:k.user})]})]},k.job_id)})}),S>s&&d.jsx("div",{className:"border-t border-slate-100",children:d.jsx(NO,{currentPage:r,setCurrentPage:n,totalItems:S,itemsPerPage:s,startIndex:E})})]})]})}const Owe=async()=>(await zt.get("/jobs")).data,Dwe=async e=>(await zt.post(`/jobs/${e}/status?action=approve`)).data,Iwe=async e=>(await zt.post(`/jobs/${e}/status?action=reject`)).data;function Mwe(){const e=Ln(),[t,r]=ne.useState(""),[n,s]=ne.useState("All"),[a,i]=ne.useState("All"),[o,c]=ne.useState(void 0),[f,h]=ne.useState(void 0),[p,x]=ne.useState(1),g=10,[v,y]=ne.useState([]),[w,_]=ne.useState(null),[S,E]=ne.useState(!0),[N,k]=ne.useState({key:"date",direction:"desc"}),O=Array.from(new Set(v.map(F=>F.client).filter(Boolean))),R=async()=>{try{E(!0);const X=(await Owe()).map(P=>({...P,summary:Rwe(P.modifications_actions)}));y(X)}catch(F){console.error("Failed to fetch analysis history:",F),wn.error("Failed to load analysis history")}finally{E(!1)}};ne.useEffect(()=>{R()},[]),ne.useEffect(()=>{x(1)},[t,a,o,f]);const V=async(F,X)=>{var P,ie;try{_(F),X==="approve"?await Dwe(F):await Iwe(F),wn.success(`Analysis ${X==="approve"?"approved":"rejected"} successfully`),y(te=>te.map(Y=>Y.job_id===F?{...Y,status:X==="approve"?"approved":"rejected"}:Y))}catch(te){console.error("Status update failed:",te),wn.error(((ie=(P=te.response)==null?void 0:P.data)==null?void 0:ie.detail)||"Failed to update status")}finally{_(null)}},I=F=>{k(X=>X.key===F?{key:F,direction:X.direction==="asc"?"desc":"asc"}:{key:F,direction:"asc"})},Z=()=>{r(""),i("All"),s("All"),c(void 0),h(void 0)},ce=()=>{e("/downloads")};return d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-4 md:p-6 lg:p-10 space-y-6 lg:space-y-10",children:[d.jsx(Awe,{onDownloadHistory:ce}),d.jsx(Cwe,{searchQuery:t,setSearchQuery:r,clientFilter:a,setClientFilter:i,statusFilter:n,setStatusFilter:s,dateFrom:o,setDateFrom:c,dateTo:f,setDateTo:h,clientOptions:O,onClearFilters:Z}),d.jsx(jwe,{analysisHistory:v,loading:S,currentPage:p,setCurrentPage:x,itemsPerPage:g,sortConfig:N,onSort:I,statusFilter:n,clientFilter:a,searchQuery:t,dateFrom:o,dateTo:f,updatingId:w,onUpdateStatus:V})]})}const ea=({className:e})=>d.jsx("div",{className:`animate-pulse bg-slate-200 rounded-md ${e}`});function Fwe(){var v;const e=Ln(),{user:t}=Hi(),[r,n]=ne.useState([]),[s,a]=ne.useState([]),[i,o]=ne.useState(!0),c={bg:"#f5f7f9",fg:"#1b2531",primary:"#24548f",muted:"#627383",border:"#d9e0e8",success:"#33b17d",warning:"#f9ab20",destructive:"#df3a3a",secondaryBg:"#f8fafc"};ne.useEffect(()=>{f()},[]);const f=async()=>{try{o(!0);const[y,w]=await Promise.all([zt.get("clients"),zt.get("jobs")]);n(y.data),a(w.data)}catch(y){console.error("Error fetching data:",y)}finally{o(!1)}},p=(()=>{const y=r.length,w=s.filter(k=>k.status==="approved").length,_=s.filter(k=>k.status==="pending").length,S=s.filter(k=>k.status==="approved").length,E=s.length,N=E>0?(S/(E-_)*100).toFixed(1):"0.0";return{totalClients:y,completedJobs:w,pendingJobs:_,successRate:N}})(),x=[{label:"All Clients",value:p.totalClients.toString(),icon:In},{label:"Analyses Completed",value:p.completedJobs.toString(),icon:Gx},{label:"Pending Reviews",value:p.pendingJobs.toString(),icon:Bi},{label:"Success Rate",value:`${p.successRate}%`,icon:Xc}],g=s.sort((y,w)=>new Date(w.created_time).getTime()-new Date(y.created_time).getTime()).slice(0,5).map(y=>{var w,_,S,E,N;return{id:y.job_id,client:y.client,contract:y.contract_number,status:y.status,add:((w=y.modifications_actions)==null?void 0:w.filter(k=>k.action_type==="NEW_PRODUCT").length)||0,del:((_=y.modifications_actions)==null?void 0:_.filter(k=>k.action_type==="REMOVED_PRODUCT").length)||0,incr:((S=y.modifications_actions)==null?void 0:S.filter(k=>k.action_type==="PRICE_INCREASE").length)||0,decr:((E=y.modifications_actions)==null?void 0:E.filter(k=>k.action_type==="PRICE_DECREASE").length)||0,desc:((N=y.modifications_actions)==null?void 0:N.filter(k=>k.action_type==="DESCRIPTION_CHANGE").length)||0}});return d.jsxs("div",{className:"min-h-screen p-6 lg:p-10 animate-fade-in",style:{backgroundColor:c.bg},children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10 animate-slide-up",children:[d.jsx("div",{className:"space-y-1",children:i?d.jsxs(d.Fragment,{children:[d.jsx(ea,{className:"h-9 w-48 mb-2"}),d.jsx(ea,{className:"h-5 w-64"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("h1",{className:"text-3xl font-extrabold tracking-tight",style:{color:c.fg},children:["Welcome, ",((v=t==null?void 0:t.name)==null?void 0:v.split(" ")[0])||"Guest"]}),d.jsx("p",{className:"font-medium",style:{color:c.muted},children:"Overview of clients and recent analyses."})]})}),!i&&d.jsxs("button",{onClick:()=>e("/pricelist-analysis"),className:"btn-primary",children:[d.jsx(Gx,{className:"w-4 h-4"}),"New Analysis"]})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-slide-up",children:i?Array(4).fill(0).map((y,w)=>d.jsxs("div",{className:"bg-white p-6 rounded-2xl h-32 flex flex-col justify-between",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx(ea,{className:"h-3 w-20"}),d.jsx(ea,{className:"h-10 w-10 rounded-xl"})]}),d.jsx(ea,{className:"h-8 w-12"})]},w)):x.map(y=>d.jsxs("div",{className:"bg-white p-6 flex flex-col justify-between rounded-2xl transition-all hover:shadow-lg ",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",style:{color:c.muted},children:y.label}),d.jsx("div",{className:"p-2.5 rounded-xl",style:{backgroundColor:c.secondaryBg},children:d.jsx(y.icon,{className:"w-5 h-5 text-[#24548f]",strokeWidth:2.5})})]}),d.jsx("div",{children:d.jsx("div",{className:"text-3xl font-black tracking-tighter mb-1",style:{color:c.fg},children:y.value})})]},y.label))}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start",children:[d.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-2xl animate-slide-up shadow-sm ",children:[d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-extrabold",style:{color:c.fg},children:"Recent Analyses"}),d.jsx("p",{className:"text-sm font-medium",style:{color:c.muted},children:"Latest price modifications tracked"})]}),!i&&d.jsx("button",{onClick:()=>e("/analyses"),className:"text-sm font-bold transition-colors",style:{color:c.muted},children:"View all"})]}),d.jsx("div",{className:"space-y-3",children:i?Array(5).fill(0).map((y,w)=>d.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl border border-transparent bg-slate-50/50",children:[d.jsx(ea,{className:"w-12 h-12 rounded-xl shrink-0"}),d.jsxs("div",{className:"flex-1 space-y-2",children:[d.jsx(ea,{className:"h-4 w-32"}),d.jsx(ea,{className:"h-3 w-20"})]}),d.jsxs("div",{className:"hidden sm:flex gap-4",children:[d.jsx(ea,{className:"h-8 w-8"}),d.jsx(ea,{className:"h-8 w-8"}),d.jsx(ea,{className:"h-8 w-8"})]}),d.jsx(ea,{className:"h-6 w-20 rounded-full"})]},w)):d.jsxs(d.Fragment,{children:[g.map(y=>{const w=lu(y.status),_=w==="unknown"?null:Z0[w];return d.jsxs("div",{onClick:()=>e(`/analyses/${y.id}`),className:"group flex items-center gap-4 p-4 rounded-2xl border border-transparent hover:shadow-sm transition-all cursor-pointer",style:{backgroundColor:`${c.bg}80`},children:[d.jsx("div",{className:"w-12 h-12 rounded-xl bg-white border flex items-center justify-center shrink-0 shadow-sm group-hover:scale-105 transition-transform",style:{borderColor:c.border},children:d.jsx(La,{className:"w-5 h-5",style:{color:c.primary}})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:"font-bold truncate",style:{color:c.fg},children:y.client}),d.jsx("p",{className:"text-xs font-bold",style:{color:c.muted},children:y.contract})]}),d.jsxs("div",{className:"hidden sm:flex items-center gap-6 px-4",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:c.muted},children:"Add"}),d.jsxs("p",{className:"text-sm font-black",style:{color:c.success},children:["+",y.add]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:c.muted},children:"Del"}),d.jsxs("p",{className:"text-sm font-black",style:{color:c.destructive},children:["-",y.del]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:c.muted},children:"Incr"}),d.jsxs("p",{className:"flex items-center gap-1 text-amber-600 text-sm font-bold",children:[d.jsx(Xc,{className:"w-3 h-3"}),y.incr]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:c.muted},children:"Decr"}),d.jsxs("p",{className:"flex items-center gap-1 text-blue-600 text-sm font-bold",children:[d.jsx(fd,{className:"w-3 h-3"}),y.decr]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:c.muted},children:"Desc"}),d.jsxs("p",{className:"flex items-center gap-1 text-indigo-600 text-sm font-bold",children:[d.jsx(ou,{className:"w-3 h-3"}),y.desc]})]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("span",{className:`${If} ${_?_.styles:"bg-slate-100 text-slate-700 border-slate-200"}`,children:[_&&d.jsx(_.icon,{className:"w-3 h-3 stroke-[2.5px]"}),d.jsx("span",{children:_?_.label:"Unknown"})]}),d.jsx(Mr,{className:"w-4 h-4",style:{color:c.border}})]})]},y.id)}),g.length===0&&d.jsx("p",{className:"text-center py-8",style:{color:c.muted},children:"No analyses found"})]})})]}),d.jsxs("div",{className:"space-y-8 animate-slide-in-right",children:[d.jsxs("div",{className:"rounded-4xl p-8 shadow-xl text-white",style:{backgroundColor:c.primary},children:[d.jsx("h2",{className:"text-xl font-bold mb-1",children:"Quick Actions"}),d.jsx("p",{className:"text-xs font-medium mb-6 opacity-70",children:"Perform common tasks"}),d.jsx("div",{className:"space-y-3",children:[{label:"Add Client",icon:hD,to:"/clients"},{label:"Upload Product Catalog",icon:Of,to:"/gsa-products/upload"},{label:"View Reports",icon:RK,to:"/analyses"}].map(y=>d.jsxs("button",{onClick:()=>e(y.to),className:"w-full flex items-center gap-3 p-4 rounded-xl transition-all group font-bold text-sm text-left border border-white/10 bg-white/10 hover:bg-white hover:text-slate-900",children:[d.jsx("div",{className:"p-1.5 rounded-lg bg-white/10",children:d.jsx(y.icon,{className:"w-4 h-4"})}),y.label]},y.label))})]}),d.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm ",children:[d.jsx("h3",{className:"text-xs font-black uppercase tracking-widest mb-6",style:{color:c.muted},children:"Clients Overview"}),d.jsx("div",{className:"space-y-5",children:[{label:"Active",key:"approved",color:c.success},{label:"Pending",key:"pending",color:c.warning},{label:"Rejected",key:"rejected",color:c.destructive}].map(y=>d.jsxs("div",{className:"flex items-center justify-between group",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:y.color}}),d.jsx("span",{className:"text-sm font-bold",style:{color:c.fg},children:y.label})]}),i?d.jsx(ea,{className:"h-4 w-6"}):d.jsx("span",{className:"text-sm font-black",style:{color:c.fg},children:r.filter(w=>w.status===y.key).length})]},y.label))})]})]})]})]})}const fn=({className:e})=>d.jsx("div",{className:`animate-pulse bg-slate-200 rounded-md ${e}`});function Pwe(){var E;const e=Ln(),{user:t}=Hi(),[r,n]=ne.useState([]),[s,a]=ne.useState([]),[i,o]=ne.useState([]),[c,f]=ne.useState(!0),[h,p]=ne.useState("users"),x={bg:"#f5f7f9",fg:"#1b2531",primary:"#24548f",muted:"#627383",border:"#d9e0e8",success:"#33b17d",destructive:"#df3a3a",secondaryBg:"#f8fafc"};ne.useEffect(()=>{g()},[]);const g=async()=>{try{f(!0);const[N,k,O]=await Promise.all([zt.get("/users/all"),zt.get("/clients"),zt.get("/jobs")]);n(Array.isArray(N.data)?N.data:[]),a(Array.isArray(k.data)?k.data:[]),o(Array.isArray(O.data)?O.data:[])}catch(N){console.error("Error fetching dashboard data:",N)}finally{f(!1)}},v=r.filter(N=>!N.is_active&&!N.is_deleted).slice(0,2),y=s.filter(N=>N.status==="pending").slice(0,2),w=i.filter(N=>N.status==="pending").length;i.filter(N=>N.status==="approved").length;const _=[{label:"User Requests",value:r.filter(N=>!N.is_active&&!N.is_deleted).length.toString(),icon:hD},{label:"Client Reviews",value:s.filter(N=>N.status==="pending").length.toString(),icon:In},{label:"Pending Analyses",value:w.toString(),icon:Bi},{label:"Active Clients",value:s.filter(N=>N.status==="approved").length.toString(),icon:us}],S=i.sort((N,k)=>new Date(k.created_time).getTime()-new Date(N.created_time).getTime()).slice(0,5).map(N=>{var Z,ce,F,X,P;const k=((Z=N.modifications_actions)==null?void 0:Z.filter(ie=>ie.action_type==="NEW_PRODUCT").length)||0,O=((ce=N.modifications_actions)==null?void 0:ce.filter(ie=>ie.action_type==="REMOVED_PRODUCT").length)||0,R=((F=N.modifications_actions)==null?void 0:F.filter(ie=>ie.action_type==="PRICE_INCREASE").length)||0,V=((X=N.modifications_actions)==null?void 0:X.filter(ie=>ie.action_type==="PRICE_DECREASE").length)||0,I=((P=N.modifications_actions)==null?void 0:P.filter(ie=>ie.action_type==="DESCRIPTION_CHANGE").length)||0;return{id:N.job_id,client:N.client,contract:N.contract_number,status:N.status,add:k,del:O,incr:R,decr:V,desc:I}});return d.jsxs("div",{className:"min-h-screen p-6 lg:p-10 animate-fade-in",style:{backgroundColor:x.bg},children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10 animate-slide-up",children:[d.jsx("div",{className:"space-y-1",children:c?d.jsxs(d.Fragment,{children:[d.jsx(fn,{className:"h-9 w-48 mb-2"}),d.jsx(fn,{className:"h-5 w-64"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("h1",{className:"text-3xl font-extrabold tracking-tight",style:{color:x.fg},children:["Welcome, ",((E=t==null?void 0:t.name)==null?void 0:E.split(" ")[0])||"Guest"]}),d.jsx("p",{className:"font-medium",style:{color:x.muted},children:"Overview of platform users and recent analyses."})]})}),!c&&d.jsxs("button",{onClick:()=>e("/pricelist-analysis"),className:"btn-primary",children:[d.jsx(Gx,{className:"w-4 h-4"}),"New Analysis"]})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-slide-up",children:c?Array(4).fill(0).map((N,k)=>d.jsxs("div",{className:"bg-white p-6 rounded-2xl h-32 flex flex-col justify-between",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx(fn,{className:"h-3 w-20"}),d.jsx(fn,{className:"h-10 w-10 rounded-xl"})]}),d.jsx(fn,{className:"h-8 w-12"})]},k)):_.map(N=>d.jsxs("div",{className:"bg-white p-6 flex flex-col justify-between rounded-2xl transition-all hover:shadow-lg ",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",style:{color:x.muted},children:N.label}),d.jsx("div",{className:"p-2.5 rounded-xl",style:{backgroundColor:x.secondaryBg},children:d.jsx(N.icon,{className:"w-5 h-5 text-[#24548f]",strokeWidth:2.5})})]}),d.jsx("div",{children:d.jsx("div",{className:"text-3xl font-black tracking-tighter mb-1",style:{color:x.fg},children:N.value})})]},N.label))}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start",children:[d.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-2xl animate-slide-up shadow-sm ",children:[d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-extrabold",style:{color:x.fg},children:"Recent Analyses"}),d.jsx("p",{className:"text-sm font-medium",style:{color:x.muted},children:"Latest price modifications tracked"})]}),!c&&d.jsx("button",{onClick:()=>e("/analyses"),className:"text-sm font-bold transition-colors",style:{color:x.muted},children:"View all"})]}),d.jsx("div",{className:"space-y-3",children:c?Array(5).fill(0).map((N,k)=>d.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl border border-transparent bg-slate-50/50",children:[d.jsx(fn,{className:"w-12 h-12 rounded-xl shrink-0"}),d.jsxs("div",{className:"flex-1 space-y-2",children:[d.jsx(fn,{className:"h-4 w-32"}),d.jsx(fn,{className:"h-3 w-20"})]}),d.jsxs("div",{className:"hidden sm:flex gap-4",children:[d.jsx(fn,{className:"h-8 w-8"}),d.jsx(fn,{className:"h-8 w-8"}),d.jsx(fn,{className:"h-8 w-8"})]}),d.jsx(fn,{className:"h-6 w-20 rounded-full"})]},k)):d.jsxs(d.Fragment,{children:[S.map(N=>{const k=lu(N.status),O=k==="unknown"?null:Z0[k];return d.jsxs("div",{onClick:()=>e(`/analyses/${N.id}`),className:"group flex items-center gap-4 p-4 rounded-2xl border border-transparent hover:shadow-sm transition-all cursor-pointer",style:{backgroundColor:`${x.bg}80`},children:[d.jsx("div",{className:"w-12 h-12 rounded-xl bg-white border flex items-center justify-center shrink-0 shadow-sm group-hover:scale-105 transition-transform",style:{borderColor:x.border},children:d.jsx(La,{className:"w-5 h-5",style:{color:x.primary}})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:"font-bold truncate",style:{color:x.fg},children:N.client}),d.jsx("p",{className:"text-xs font-bold",style:{color:x.muted},children:N.contract})]}),d.jsxs("div",{className:"hidden sm:flex items-center gap-6 px-4",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:x.muted},children:"Add"}),d.jsxs("p",{className:"text-sm font-black",style:{color:x.success},children:["+",N.add]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:x.muted},children:"Del"}),d.jsxs("p",{className:"text-sm font-black",style:{color:x.destructive},children:["-",N.del]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:x.muted},children:"Incr"}),d.jsxs("p",{className:"flex items-center gap-1 text-amber-600 text-sm font-bold",children:[d.jsx(Xc,{className:"w-3 h-3"}),N.incr]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:x.muted},children:"Decr"}),d.jsxs("p",{className:"flex items-center gap-1 text-blue-600 text-sm font-bold",children:[d.jsx(fd,{className:"w-3 h-3"}),N.decr]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:x.muted},children:"Desc"}),d.jsxs("p",{className:"flex items-center gap-1 text-indigo-600 text-sm font-bold",children:[d.jsx(ou,{className:"w-3 h-3"}),N.desc]})]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("span",{className:`${If} ${O?O.styles:"bg-slate-100 text-slate-700 border-slate-200"}`,children:[O&&d.jsx(O.icon,{className:"w-3 h-3 stroke-[2.5px]"}),d.jsx("span",{children:O?O.label:"Unknown"})]}),d.jsx(Mr,{className:"w-4 h-4",style:{color:x.border}})]})]},N.id)}),S.length===0&&d.jsx("p",{className:"text-center py-8",style:{color:x.muted},children:"No analyses found"})]})})]}),d.jsxs("div",{className:"space-y-8",children:[d.jsxs("div",{className:"rounded-4xl p-8 shadow-xl text-white",style:{backgroundColor:x.primary},children:[d.jsx("h2",{className:"text-xl font-bold mb-1",children:"Quick Actions"}),d.jsx("p",{className:"text-xs font-medium mb-6 opacity-70",children:"Perform common tasks"}),d.jsx("div",{className:"space-y-3",children:[{label:"Add Client",icon:In,to:"/clients"},{label:"Manage Contracts",icon:lD,to:"/contracts"},{label:"Upload Product Catalog",icon:Of,to:"/gsa-products/upload"}].map(N=>d.jsxs("button",{onClick:()=>e(N.to),className:"w-full flex items-center gap-3 p-4 rounded-xl transition-all group font-bold text-sm text-left border border-white/10 bg-white/10 hover:bg-white hover:text-slate-900",children:[d.jsx("div",{className:"p-1.5 rounded-lg bg-white/10",children:d.jsx(N.icon,{className:"w-4 h-4"})}),N.label]},N.label))})]}),d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[d.jsxs("div",{className:"flex border-b border-slate-50",children:[d.jsxs("button",{onClick:()=>p("users"),className:`flex-1 py-4 text-[10px] font-black uppercase tracking-widest transition-all relative ${h==="users"?"text-[#24548f]":"text-slate-400 hover:text-slate-600"}`,children:["User Approvals",!c&&v.length>0&&d.jsx("span",{className:"ml-2 bg-blue-50 text-[#24548f] px-1.5 py-0.5 rounded-md text-[9px]",children:v.length}),h==="users"&&d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#24548f]"})]}),d.jsxs("button",{onClick:()=>p("clients"),className:`flex-1 py-4 text-[10px] font-black uppercase tracking-widest transition-all relative ${h==="clients"?"text-emerald-600":"text-slate-400 hover:text-slate-600"}`,children:["Client Reviews",!c&&y.length>0&&d.jsx("span",{className:"ml-2 bg-emerald-50 text-emerald-600 px-1.5 py-0.5 rounded-md text-[9px]",children:y.length}),h==="clients"&&d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]})]}),d.jsx("div",{className:"p-6",children:c?d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(fn,{className:"w-8 h-8 rounded-lg"}),d.jsxs("div",{className:"space-y-1",children:[d.jsx(fn,{className:"h-3 w-24"}),d.jsx(fn,{className:"h-2 w-16"})]})]}),d.jsx(fn,{className:"w-4 h-4"})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(fn,{className:"w-8 h-8 rounded-lg"}),d.jsxs("div",{className:"space-y-1",children:[d.jsx(fn,{className:"h-3 w-20"}),d.jsx(fn,{className:"h-2 w-12"})]})]}),d.jsx(fn,{className:"w-4 h-4"})]})]}):h==="users"?d.jsxs("div",{className:"space-y-4 animate-fade-in",children:[v.map(N=>d.jsxs("div",{className:"flex items-center justify-between group",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-[10px] font-bold text-slate-500",children:N.name.charAt(0)}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-800",children:N.name}),d.jsx("p",{className:"text-[10px] text-slate-400",children:new Date(N.created_time).toLocaleDateString()})]})]}),d.jsx("button",{onClick:()=>e("/user-activation"),className:"p-1.5 hover:bg-blue-50 rounded-lg transition-colors text-[#24548f]",children:d.jsx(Mr,{className:"w-4 h-4"})})]},N.user_id)),v.length===0&&d.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center",children:[d.jsx("div",{className:"w-10 h-10 bg-slate-50 rounded-full flex items-center justify-center mb-2",children:d.jsx(Kx,{className:"w-5 h-5 text-slate-300"})}),d.jsx("p",{className:"text-[11px] text-slate-400 italic",children:"No pending user requests"})]})]}):d.jsxs("div",{className:"space-y-4 animate-fade-in",children:[y.map(N=>d.jsxs("div",{className:"flex items-center justify-between group",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-50 flex items-center justify-center text-emerald-600",children:d.jsx(In,{className:"w-4 h-4"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-800",children:N.company_name}),d.jsx("p",{className:"text-[10px] text-slate-400",children:"Review Required"})]})]}),d.jsx("button",{onClick:()=>e("/client-activation"),className:"p-1.5 hover:bg-emerald-50 rounded-lg transition-colors text-emerald-600",children:d.jsx(Mr,{className:"w-4 h-4"})})]},N.client_id)),y.length===0&&d.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center",children:[d.jsx("div",{className:"w-10 h-10 bg-slate-50 rounded-full flex items-center justify-center mb-2",children:d.jsx(In,{className:"w-5 h-5 text-slate-300"})}),d.jsx("p",{className:"text-[11px] text-slate-400 italic",children:"No pending client reviews"})]})]})}),d.jsx("div",{className:"px-6 py-2.5 bg-slate-50/50 border-t border-slate-100",children:d.jsx("button",{onClick:()=>e(h==="users"?"/user-activation":"/client-activation"),className:"w-full text-center text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-[#24548f] transition-colors",children:"View All"})})]})]})]})]})}function Lwe(){const{user:e}=Hi();if(!e)return null;if(!e||!e.is_active||e.is_deleted)return d.jsx("div",{className:"p-10 text-center text-red-600 font-bold",children:"Access denied"});switch(e.role){case"admin":return d.jsx(Pwe,{});case"user":default:return d.jsx(Fwe,{})}}const Eh=7;function Bwe(){const{jobId:e}=J8(),t=Ln(),[r,n]=ne.useState(!0),[s,a]=ne.useState(null),[i,o]=ne.useState("additions"),[c,f]=ne.useState(1);ne.useEffect(()=>{(async()=>{try{n(!0);const R=await zt.get(`/jobs/${e}`);a(R.data)}finally{n(!1)}})()},[e]);const h=ne.useMemo(()=>{const O={additions:[],deletions:[],priceIncreases:[],priceDecreases:[],descriptionChanges:[]};if(!(s!=null&&s.modifications_actions))return O;for(const R of s.modifications_actions)switch(R.action_type){case"NEW_PRODUCT":O.additions.push(R);break;case"REMOVED_PRODUCT":O.deletions.push(R);break;case"PRICE_INCREASE":O.priceIncreases.push(R);break;case"PRICE_DECREASE":O.priceDecreases.push(R);break;case"DESCRIPTION_CHANGE":O.descriptionChanges.push(R);break}return O},[s]),p=h[i]||[],x=p.length,g=Math.ceil(x/Eh),v=(c-1)*Eh,y=p.slice(v,v+Eh),w=i==="descriptionChanges",_=i==="priceIncreases"||i==="priceDecreases",S=i==="additions"||i==="deletions";if(r)return d.jsxs("div",{className:"py-120 text-center",children:[d.jsx(ar,{className:"w-10 h-10 animate-spin mx-auto text-[#24578f]"}),d.jsx("p",{className:"mt-4 text-slate-500",children:"Fetching modification details..."})]});if(!s)return d.jsx("div",{className:"py-20 text-center text-slate-500",children:"Analysis not found"});const E=[{id:"additions",label:"Additions",icon:ud,variant:"emerald",count:h.additions.length},{id:"deletions",label:"Deletions",icon:XE,variant:"red",count:h.deletions.length},{id:"priceIncreases",label:"Increases",icon:Xc,variant:"amber",count:h.priceIncreases.length},{id:"priceDecreases",label:"Decreases",icon:fd,variant:"cyan",count:h.priceDecreases.length},{id:"descriptionChanges",label:"Descriptions",icon:ou,variant:"blue",count:h.descriptionChanges.length}],N=({label:O,value:R,icon:V,variant:I="blue"})=>{const ce={emerald:{bg:"bg-emerald-50",text:"text-emerald-600",border:"border-emerald-100",iconBg:"bg-emerald-100/50"},red:{bg:"bg-red-50",text:"text-red-600",border:"border-red-100",iconBg:"bg-red-100/50"},amber:{bg:"bg-amber-50",text:"text-amber-600",border:"border-amber-100",iconBg:"bg-amber-100/50"},cyan:{bg:"bg-cyan-50",text:"text-[#3399cc]",border:"border-cyan-100",iconBg:"bg-cyan-100/50"},blue:{bg:"bg-blue-50",text:"text-blue-600",border:"border-blue-100",iconBg:"bg-blue-100/50"}}[I];return d.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm h-full hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`w-12 h-12 rounded-2xl ${ce.iconBg} flex items-center justify-center ${ce.text}`,children:We.cloneElement(V,{size:20})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-2xl font-bold text-slate-900 tabular-nums leading-none",children:R.toLocaleString()}),d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mt-1.5",children:O})]})]})})},k=O=>{const R=[];if(O<=7){for(let Z=1;Z<=O;Z++)R.push(Z);return R}R.push(1),c>4&&R.push("...");const V=Math.max(2,c-1),I=Math.min(O-1,c+1);for(let Z=V;Z<=I;Z++)R.push(Z);return c<O-3&&R.push("..."),R.push(O),R};return d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-6 lg:p-10 space-y-10",children:[d.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-12 mx-auto",children:d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"Analysis Details"}),d.jsxs("p",{className:"text-slate-500 font-medium mt-1",children:["Review the analysis results of ANAL-JOB-",e]})]})}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:E.map(O=>d.jsx(N,{label:O.label,value:O.count,icon:d.jsx(O.icon,{className:"w-4 h-4"}),variant:O.variant},O.id))}),d.jsxs("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden",children:[d.jsxs("div",{className:"px-6 py-5 border-b border-slate-100 flex items-center justify-between gap-4",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Analysis Results"}),d.jsxs("button",{onClick:()=>OM(e,h),className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-slate-50 text-slate-700 text-sm font-bold border border-slate-200 hover:bg-slate-100 transition-all",children:[d.jsx(Rf,{size:16})," Export All"]})]}),d.jsx("div",{className:"px-6 pt-4",children:d.jsx("div",{className:"bg-slate-100/80 p-1 rounded-2xl flex items-center w-full ",children:E.map(O=>d.jsxs("button",{onClick:()=>{o(O.id),f(1)},className:`flex-1 flex items-center justify-center gap-2 py-2.5 rounded-xl text-sm font-bold transition-all
                         ${i===O.id?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(O.icon,{size:14,className:i===O.id?`text-${O.variant}-600`:""}),O.label]},O.id))})}),d.jsx("div",{className:"p-6",children:d.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden",children:d.jsxs("table",{className:"w-full text-sm table-fixed",children:[d.jsx("thead",{className:"bg-slate-50/50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Part Number"}),d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Product Name"}),w&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Old Description"}),d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"New Description"})]}),_&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"Old Price"}),d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"New Price"})]}),S&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Description"}),d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"Price"})]})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-100",children:[y.map((O,R)=>d.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[d.jsx("td",{className:"p-3 font-mono text-xs text-slate-500",children:O.manufacturer_part_number||"N/A"}),d.jsx("td",{className:"p-3 font-medium text-slate-900",children:O.product_name||"Unknown Product"}),w&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-xs text-slate-400 truncate max-w-60",children:O.old_description||"-"}),d.jsx("td",{className:"p-3 text-xs text-slate-700",children:O.new_description||"-"})]}),_&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-right text-slate-400 tabular-nums",children:O.old_price?`$${Number(O.old_price).toLocaleString()}`:"-"}),d.jsx("td",{className:"p-3 text-right font-bold text-slate-900 tabular-nums",children:O.new_price?`$${Number(O.new_price).toLocaleString()}`:"-"})]}),S&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-xs text-slate-700 truncate max-w-60",children:O.description||O.new_description||"-"}),d.jsx("td",{className:"p-3 text-right font-bold text-slate-900 tabular-nums",children:O.price??O.new_price?`$${Number(O.price??O.new_price).toLocaleString()}`:"-"})]})]},R)),p.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:4,className:"p-10 text-center text-slate-400 italic",children:"No modifications found for this category."})})]})]})})}),x>Eh&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:v+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(v+Eh,x)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:x})," ","results"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:c===1,onClick:()=>f(c-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Es,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:k(g).map((O,R)=>O==="..."?d.jsx("span",{className:"min-w-9 h-9 flex items-center justify-center text-slate-400 font-bold",children:""},R):d.jsx("button",{onClick:()=>f(O),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
        ${c===O?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:O},R))}),d.jsx("button",{disabled:c===g,onClick:()=>f(c+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})]}),d.jsxs("div",{className:"flex justify-between items-center pt-4",children:[d.jsx("button",{onClick:()=>t(-1),className:"px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-700 font-bold hover:bg-slate-50 transition-all shadow-sm",children:"Back"}),d.jsxs("button",{onClick:()=>t(`/documents?job_id=${e}`),className:"btn-primary",children:["Generate Documents ",d.jsx(a0,{className:"w-4 h-4"})]})]})]})}try{dK.configure(hK)}catch(e){console.warn("Amplify configuration failed.",e)}const Uwe=()=>{const{status:e,isActive:t}=Hi();if(e==="loading")return d.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#f5f7f9]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#24578f]"})});const r=e==="authenticated";return d.jsx(tK,{children:d.jsxs(RG,{children:[d.jsx(Rr,{path:"/login",element:r?t?d.jsx(El,{to:"/dashboard",replace:!0}):d.jsx(El,{to:"/pending-approval",replace:!0}):d.jsx(jY,{})}),d.jsx(Rr,{path:"/signup",element:d.jsx(IY,{})}),d.jsx(Rr,{path:"/forgot-password",element:d.jsx(MY,{})}),d.jsx(Rr,{path:"/pending-approval",element:r?t?d.jsx(El,{to:"/dashboard",replace:!0}):d.jsx(VY,{}):d.jsx(El,{to:"/login",replace:!0})}),d.jsx(Rr,{element:d.jsx(Eb,{isAuthenticated:r}),children:d.jsxs(Rr,{element:d.jsx($Y,{}),children:[d.jsx(Rr,{path:"/dashboard",element:d.jsx(Lwe,{})}),d.jsx(Rr,{path:"/settings",element:d.jsx(zY,{})}),d.jsxs(Rr,{element:d.jsx(Eb,{isAuthenticated:r,allowedRoles:[dn.USER,dn.ADMIN]}),children:[d.jsx(Rr,{path:"/clients",element:d.jsx(rJ,{})}),d.jsx(Rr,{path:"/clients/:clientId/products",element:d.jsx(nJ,{})}),d.jsx(Rr,{path:"/contracts",element:d.jsx(wJ,{})}),d.jsx(Rr,{path:"/pricelist-analysis",element:d.jsx(Ice,{})}),d.jsx(Rr,{path:"/gsa-products",element:d.jsx(Oce,{})}),d.jsx(Rr,{path:"/gsa-products/upload",element:d.jsx(Ece,{})}),d.jsx(Rr,{path:"/documents",element:d.jsx(Bce,{children:d.jsx(kwe,{})})}),d.jsx(Rr,{path:"/analyses",element:d.jsx(Mwe,{})}),d.jsx(Rr,{path:"/analyses/:jobId",element:d.jsx(Bwe,{})})]}),d.jsxs(Rr,{element:d.jsx(Eb,{isAuthenticated:r,allowedRoles:[dn.ADMIN]}),children:[d.jsx(Rr,{path:"/client-activation",element:d.jsx(iJ,{})}),d.jsx(Rr,{path:"/user-activation",element:d.jsx(uJ,{})})]})]})}),d.jsx(Rr,{path:"/",element:d.jsx(El,{to:r?t?"/dashboard":"/pending-approval":"/login",replace:!0})}),d.jsx(Rr,{path:"*",element:d.jsx(HY,{})})]})})},zwe=()=>d.jsxs(j$,{children:[d.jsx(R$,{position:"top-right",richColors:!0}),d.jsx(Uwe,{})]}),yB=document.getElementById("root");if(!yB)throw new Error("Could not find root element to mount to");const Hwe=M7.createRoot(yB);Hwe.render(d.jsx(We.StrictMode,{children:d.jsx(zwe,{})}));
