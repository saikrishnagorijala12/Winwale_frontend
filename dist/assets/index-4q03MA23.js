(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Rm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function SE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ub={exports:{}},lh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AC;function R7(){if(AC)return lh;AC=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,s,a){var i=null;if(a!==void 0&&(i=""+a),s.key!==void 0&&(i=""+s.key),"key"in s){a={};for(var o in s)o!=="key"&&(a[o]=s[o])}else a=s;return s=a.ref,{$$typeof:e,type:n,key:i,ref:s!==void 0?s:null,props:a}}return lh.Fragment=t,lh.jsx=r,lh.jsxs=r,lh}var CC;function O7(){return CC||(CC=1,ub.exports=R7()),ub.exports}var d=O7(),fb={exports:{}},Nt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RC;function j7(){if(RC)return Nt;RC=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),x=Symbol.iterator;function g(K){return K===null||typeof K!="object"?null:(K=x&&K[x]||K["@@iterator"],typeof K=="function"?K:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,w={};function _(K,M,q){this.props=K,this.context=M,this.refs=w,this.updater=q||v}_.prototype.isReactComponent={},_.prototype.setState=function(K,M){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,M,"setState")},_.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function S(){}S.prototype=_.prototype;function E(K,M,q){this.props=K,this.context=M,this.refs=w,this.updater=q||v}var T=E.prototype=new S;T.constructor=E,y(T,_.prototype),T.isPureReactComponent=!0;var k=Array.isArray;function D(){}var O={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function j(K,M,q){var G=q.ref;return{$$typeof:e,type:K,key:M,ref:G!==void 0?G:null,props:q}}function J(K,M){return j(K.type,M,K.props)}function ae(K){return typeof K=="object"&&K!==null&&K.$$typeof===e}function F(K){var M={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(q){return M[q]})}var X=/\/+/g;function P(K,M){return typeof K=="object"&&K!==null&&K.key!=null?F(""+K.key):M.toString(36)}function le(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(D,D):(K.status="pending",K.then(function(M){K.status==="pending"&&(K.status="fulfilled",K.value=M)},function(M){K.status==="pending"&&(K.status="rejected",K.reason=M)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function ee(K,M,q,G,Z){var re=typeof K;(re==="undefined"||re==="boolean")&&(K=null);var L=!1;if(K===null)L=!0;else switch(re){case"bigint":case"string":case"number":L=!0;break;case"object":switch(K.$$typeof){case e:case t:L=!0;break;case h:return L=K._init,ee(L(K._payload),M,q,G,Z)}}if(L)return Z=Z(K),L=G===""?"."+P(K,0):G,k(Z)?(q="",L!=null&&(q=L.replace(X,"$&/")+"/"),ee(Z,M,q,"",function(Q){return Q})):Z!=null&&(ae(Z)&&(Z=J(Z,q+(Z.key==null||K&&K.key===Z.key?"":(""+Z.key).replace(X,"$&/")+"/")+L)),M.push(Z)),1;L=0;var I=G===""?".":G+":";if(k(K))for(var se=0;se<K.length;se++)G=K[se],re=I+P(G,se),L+=ee(G,M,q,re,Z);else if(se=g(K),typeof se=="function")for(K=se.call(K),se=0;!(G=K.next()).done;)G=G.value,re=I+P(G,se++),L+=ee(G,M,q,re,Z);else if(re==="object"){if(typeof K.then=="function")return ee(le(K),M,q,G,Z);throw M=String(K),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.")}return L}function te(K,M,q){if(K==null)return K;var G=[],Z=0;return ee(K,G,"","",function(re){return M.call(q,re,Z++)}),G}function me(K){if(K._status===-1){var M=K._result;M=M(),M.then(function(q){(K._status===0||K._status===-1)&&(K._status=1,K._result=q)},function(q){(K._status===0||K._status===-1)&&(K._status=2,K._result=q)}),K._status===-1&&(K._status=0,K._result=M)}if(K._status===1)return K._result.default;throw K._result}var ie=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var M=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(M))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)},Ee={map:te,forEach:function(K,M,q){te(K,function(){M.apply(this,arguments)},q)},count:function(K){var M=0;return te(K,function(){M++}),M},toArray:function(K){return te(K,function(M){return M})||[]},only:function(K){if(!ae(K))throw Error("React.Children.only expected to receive a single React element child.");return K}};return Nt.Activity=p,Nt.Children=Ee,Nt.Component=_,Nt.Fragment=r,Nt.Profiler=s,Nt.PureComponent=E,Nt.StrictMode=n,Nt.Suspense=c,Nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Nt.__COMPILER_RUNTIME={__proto__:null,c:function(K){return O.H.useMemoCache(K)}},Nt.cache=function(K){return function(){return K.apply(null,arguments)}},Nt.cacheSignal=function(){return null},Nt.cloneElement=function(K,M,q){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var G=y({},K.props),Z=K.key;if(M!=null)for(re in M.key!==void 0&&(Z=""+M.key),M)!z.call(M,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&M.ref===void 0||(G[re]=M[re]);var re=arguments.length-2;if(re===1)G.children=q;else if(1<re){for(var L=Array(re),I=0;I<re;I++)L[I]=arguments[I+2];G.children=L}return j(K.type,Z,G)},Nt.createContext=function(K){return K={$$typeof:i,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:a,_context:K},K},Nt.createElement=function(K,M,q){var G,Z={},re=null;if(M!=null)for(G in M.key!==void 0&&(re=""+M.key),M)z.call(M,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(Z[G]=M[G]);var L=arguments.length-2;if(L===1)Z.children=q;else if(1<L){for(var I=Array(L),se=0;se<L;se++)I[se]=arguments[se+2];Z.children=I}if(K&&K.defaultProps)for(G in L=K.defaultProps,L)Z[G]===void 0&&(Z[G]=L[G]);return j(K,re,Z)},Nt.createRef=function(){return{current:null}},Nt.forwardRef=function(K){return{$$typeof:o,render:K}},Nt.isValidElement=ae,Nt.lazy=function(K){return{$$typeof:h,_payload:{_status:-1,_result:K},_init:me}},Nt.memo=function(K,M){return{$$typeof:f,type:K,compare:M===void 0?null:M}},Nt.startTransition=function(K){var M=O.T,q={};O.T=q;try{var G=K(),Z=O.S;Z!==null&&Z(q,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(D,ie)}catch(re){ie(re)}finally{M!==null&&q.types!==null&&(M.types=q.types),O.T=M}},Nt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Nt.use=function(K){return O.H.use(K)},Nt.useActionState=function(K,M,q){return O.H.useActionState(K,M,q)},Nt.useCallback=function(K,M){return O.H.useCallback(K,M)},Nt.useContext=function(K){return O.H.useContext(K)},Nt.useDebugValue=function(){},Nt.useDeferredValue=function(K,M){return O.H.useDeferredValue(K,M)},Nt.useEffect=function(K,M){return O.H.useEffect(K,M)},Nt.useEffectEvent=function(K){return O.H.useEffectEvent(K)},Nt.useId=function(){return O.H.useId()},Nt.useImperativeHandle=function(K,M,q){return O.H.useImperativeHandle(K,M,q)},Nt.useInsertionEffect=function(K,M){return O.H.useInsertionEffect(K,M)},Nt.useLayoutEffect=function(K,M){return O.H.useLayoutEffect(K,M)},Nt.useMemo=function(K,M){return O.H.useMemo(K,M)},Nt.useOptimistic=function(K,M){return O.H.useOptimistic(K,M)},Nt.useReducer=function(K,M,q){return O.H.useReducer(K,M,q)},Nt.useRef=function(K){return O.H.useRef(K)},Nt.useState=function(K){return O.H.useState(K)},Nt.useSyncExternalStore=function(K,M,q){return O.H.useSyncExternalStore(K,M,q)},Nt.useTransition=function(){return O.H.useTransition()},Nt.version="19.2.4",Nt}var OC;function P0(){return OC||(OC=1,fb.exports=j7()),fb.exports}var ne=P0();const We=SE(ne);var db={exports:{}},ch={},hb={exports:{}},pb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jC;function D7(){return jC||(jC=1,(function(e){function t(ee,te){var me=ee.length;ee.push(te);e:for(;0<me;){var ie=me-1>>>1,Ee=ee[ie];if(0<s(Ee,te))ee[ie]=te,ee[me]=Ee,me=ie;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var te=ee[0],me=ee.pop();if(me!==te){ee[0]=me;e:for(var ie=0,Ee=ee.length,K=Ee>>>1;ie<K;){var M=2*(ie+1)-1,q=ee[M],G=M+1,Z=ee[G];if(0>s(q,me))G<Ee&&0>s(Z,q)?(ee[ie]=Z,ee[G]=me,ie=G):(ee[ie]=q,ee[M]=me,ie=M);else if(G<Ee&&0>s(Z,me))ee[ie]=Z,ee[G]=me,ie=G;else break e}}return te}function s(ee,te){var me=ee.sortIndex-te.sortIndex;return me!==0?me:ee.id-te.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],f=[],h=1,p=null,x=3,g=!1,v=!1,y=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function T(ee){for(var te=r(f);te!==null;){if(te.callback===null)n(f);else if(te.startTime<=ee)n(f),te.sortIndex=te.expirationTime,t(c,te);else break;te=r(f)}}function k(ee){if(y=!1,T(ee),!v)if(r(c)!==null)v=!0,D||(D=!0,F());else{var te=r(f);te!==null&&le(k,te.startTime-ee)}}var D=!1,O=-1,z=5,j=-1;function J(){return w?!0:!(e.unstable_now()-j<z)}function ae(){if(w=!1,D){var ee=e.unstable_now();j=ee;var te=!0;try{e:{v=!1,y&&(y=!1,S(O),O=-1),g=!0;var me=x;try{t:{for(T(ee),p=r(c);p!==null&&!(p.expirationTime>ee&&J());){var ie=p.callback;if(typeof ie=="function"){p.callback=null,x=p.priorityLevel;var Ee=ie(p.expirationTime<=ee);if(ee=e.unstable_now(),typeof Ee=="function"){p.callback=Ee,T(ee),te=!0;break t}p===r(c)&&n(c),T(ee)}else n(c);p=r(c)}if(p!==null)te=!0;else{var K=r(f);K!==null&&le(k,K.startTime-ee),te=!1}}break e}finally{p=null,x=me,g=!1}te=void 0}}finally{te?F():D=!1}}}var F;if(typeof E=="function")F=function(){E(ae)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,P=X.port2;X.port1.onmessage=ae,F=function(){P.postMessage(null)}}else F=function(){_(ae,0)};function le(ee,te){O=_(function(){ee(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_next=function(ee){switch(x){case 1:case 2:case 3:var te=3;break;default:te=x}var me=x;x=te;try{return ee()}finally{x=me}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(ee,te){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var me=x;x=ee;try{return te()}finally{x=me}},e.unstable_scheduleCallback=function(ee,te,me){var ie=e.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?ie+me:ie):me=ie,ee){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=me+Ee,ee={id:h++,callback:te,priorityLevel:ee,startTime:me,expirationTime:Ee,sortIndex:-1},me>ie?(ee.sortIndex=me,t(f,ee),r(c)===null&&ee===r(f)&&(y?(S(O),O=-1):y=!0,le(k,me-ie))):(ee.sortIndex=Ee,t(c,ee),v||g||(v=!0,D||(D=!0,F()))),ee},e.unstable_shouldYield=J,e.unstable_wrapCallback=function(ee){var te=x;return function(){var me=x;x=te;try{return ee.apply(this,arguments)}finally{x=me}}}})(pb)),pb}var DC;function I7(){return DC||(DC=1,hb.exports=D7()),hb.exports}var mb={exports:{}},rs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IC;function M7(){if(IC)return rs;IC=1;var e=P0();function t(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(c,f,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:p==null?null:""+p,children:c,containerInfo:f,implementation:h}}var i=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return rs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,rs.createPortal=function(c,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(c,f,null,h)},rs.flushSync=function(c){var f=i.T,h=n.p;try{if(i.T=null,n.p=2,c)return c()}finally{i.T=f,n.p=h,n.d.f()}},rs.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(c,f))},rs.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},rs.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var h=f.as,p=o(h,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?n.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:x,fetchPriority:g}):h==="script"&&n.d.X(c,{crossOrigin:p,integrity:x,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},rs.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=o(f.as,f.crossOrigin);n.d.M(c,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(c)},rs.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,p=o(h,f.crossOrigin);n.d.L(c,h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},rs.preloadModule=function(c,f){if(typeof c=="string")if(f){var h=o(f.as,f.crossOrigin);n.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(c)},rs.requestFormReset=function(c){n.d.r(c)},rs.unstable_batchedUpdates=function(c,f){return c(f)},rs.useFormState=function(c,f,h){return i.H.useFormState(c,f,h)},rs.useFormStatus=function(){return i.H.useHostTransitionStatus()},rs.version="19.2.4",rs}var MC;function jj(){if(MC)return mb.exports;MC=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),mb.exports=M7(),mb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FC;function F7(){if(FC)return ch;FC=1;var e=I7(),t=P0(),r=jj();function n(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function a(l){var u=l,m=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(m=u.return),l=u.return;while(l)}return u.tag===3?m:null}function i(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function o(l){if(l.tag===31){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function c(l){if(a(l)!==l)throw Error(n(188))}function f(l){var u=l.alternate;if(!u){if(u=a(l),u===null)throw Error(n(188));return u!==l?null:l}for(var m=l,b=u;;){var N=m.return;if(N===null)break;var R=N.alternate;if(R===null){if(b=N.return,b!==null){m=b;continue}break}if(N.child===R.child){for(R=N.child;R;){if(R===m)return c(N),l;if(R===b)return c(N),u;R=R.sibling}throw Error(n(188))}if(m.return!==b.return)m=N,b=R;else{for(var W=!1,ce=N.child;ce;){if(ce===m){W=!0,m=N,b=R;break}if(ce===b){W=!0,b=N,m=R;break}ce=ce.sibling}if(!W){for(ce=R.child;ce;){if(ce===m){W=!0,m=R,b=N;break}if(ce===b){W=!0,b=R,m=N;break}ce=ce.sibling}if(!W)throw Error(n(189))}}if(m.alternate!==b)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?l:u}function h(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(u=h(l),u!==null)return u;l=l.sibling}return null}var p=Object.assign,x=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),S=Symbol.for("react.consumer"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),ae=Symbol.iterator;function F(l){return l===null||typeof l!="object"?null:(l=ae&&l[ae]||l["@@iterator"],typeof l=="function"?l:null)}var X=Symbol.for("react.client.reference");function P(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===X?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case y:return"Fragment";case _:return"Profiler";case w:return"StrictMode";case k:return"Suspense";case D:return"SuspenseList";case j:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case v:return"Portal";case E:return l.displayName||"Context";case S:return(l._context.displayName||"Context")+".Consumer";case T:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case O:return u=l.displayName||null,u!==null?u:P(l.type)||"Memo";case z:u=l._payload,l=l._init;try{return P(l(u))}catch{}}return null}var le=Array.isArray,ee=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},ie=[],Ee=-1;function K(l){return{current:l}}function M(l){0>Ee||(l.current=ie[Ee],ie[Ee]=null,Ee--)}function q(l,u){Ee++,ie[Ee]=l.current,l.current=u}var G=K(null),Z=K(null),re=K(null),L=K(null);function I(l,u){switch(q(re,u),q(Z,l),q(G,null),u.nodeType){case 9:case 11:l=(l=u.documentElement)&&(l=l.namespaceURI)?JA(l):0;break;default:if(l=u.tagName,u=u.namespaceURI)u=JA(u),l=ZA(u,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}M(G),q(G,l)}function se(){M(G),M(Z),M(re)}function Q(l){l.memoizedState!==null&&q(L,l);var u=G.current,m=ZA(u,l.type);u!==m&&(q(Z,l),q(G,m))}function Y(l){Z.current===l&&(M(G),M(Z)),L.current===l&&(M(L),sh._currentValue=me)}var U,we;function B(l){if(U===void 0)try{throw Error()}catch(m){var u=m.stack.trim().match(/\n( *(at )?)/);U=u&&u[1]||"",we=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+U+l+we}var be=!1;function V(l,u){if(!l||be)return"";be=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(u){var Ve=function(){throw Error()};if(Object.defineProperty(Ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ve,[])}catch(Ie){var Oe=Ie}Reflect.construct(l,[],Ve)}else{try{Ve.call()}catch(Ie){Oe=Ie}l.call(Ve.prototype)}}else{try{throw Error()}catch(Ie){Oe=Ie}(Ve=l())&&typeof Ve.catch=="function"&&Ve.catch(function(){})}}catch(Ie){if(Ie&&Oe&&typeof Ie.stack=="string")return[Ie.stack,Oe.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var R=b.DetermineComponentFrameRoot(),W=R[0],ce=R[1];if(W&&ce){var ve=W.split(`
`),Te=ce.split(`
`);for(N=b=0;b<ve.length&&!ve[b].includes("DetermineComponentFrameRoot");)b++;for(;N<Te.length&&!Te[N].includes("DetermineComponentFrameRoot");)N++;if(b===ve.length||N===Te.length)for(b=ve.length-1,N=Te.length-1;1<=b&&0<=N&&ve[b]!==Te[N];)N--;for(;1<=b&&0<=N;b--,N--)if(ve[b]!==Te[N]){if(b!==1||N!==1)do if(b--,N--,0>N||ve[b]!==Te[N]){var Ue=`
`+ve[b].replace(" at new "," at ");return l.displayName&&Ue.includes("<anonymous>")&&(Ue=Ue.replace("<anonymous>",l.displayName)),Ue}while(1<=b&&0<=N);break}}}finally{be=!1,Error.prepareStackTrace=m}return(m=l?l.displayName||l.name:"")?B(m):""}function C(l,u){switch(l.tag){case 26:case 27:case 5:return B(l.type);case 16:return B("Lazy");case 13:return l.child!==u&&u!==null?B("Suspense Fallback"):B("Suspense");case 19:return B("SuspenseList");case 0:case 15:return V(l.type,!1);case 11:return V(l.type.render,!1);case 1:return V(l.type,!0);case 31:return B("Activity");default:return""}}function A(l){try{var u="",m=null;do u+=C(l,m),m=l,l=l.return;while(l);return u}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}var H=Object.prototype.hasOwnProperty,ue=e.unstable_scheduleCallback,ye=e.unstable_cancelCallback,he=e.unstable_shouldYield,ke=e.unstable_requestPaint,De=e.unstable_now,Fe=e.unstable_getCurrentPriorityLevel,$e=e.unstable_ImmediatePriority,rt=e.unstable_UserBlockingPriority,at=e.unstable_NormalPriority,qt=e.unstable_LowPriority,dt=e.unstable_IdlePriority,Bt=e.log,hr=e.unstable_setDisableYieldValue,vt=null,ir=null;function Nn(l){if(typeof Bt=="function"&&hr(l),ir&&typeof ir.setStrictMode=="function")try{ir.setStrictMode(vt,l)}catch{}}var or=Math.clz32?Math.clz32:xs,Vo=Math.log,pi=Math.LN2;function xs(l){return l>>>=0,l===0?32:31-(Vo(l)/pi|0)|0}var Ga=256,Ka=262144,gs=4194304;function nn(l){var u=l&42;if(u!==0)return u;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function wt(l,u,m){var b=l.pendingLanes;if(b===0)return 0;var N=0,R=l.suspendedLanes,W=l.pingedLanes;l=l.warmLanes;var ce=b&134217727;return ce!==0?(b=ce&~R,b!==0?N=nn(b):(W&=ce,W!==0?N=nn(W):m||(m=ce&~l,m!==0&&(N=nn(m))))):(ce=b&~R,ce!==0?N=nn(ce):W!==0?N=nn(W):m||(m=b&~l,m!==0&&(N=nn(m)))),N===0?0:u!==0&&u!==N&&(u&R)===0&&(R=N&-N,m=u&-u,R>=m||R===32&&(m&4194048)!==0)?u:N}function xr(l,u){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&u)===0}function sn(l,u){switch(l){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tn(){var l=gs;return gs<<=1,(gs&62914560)===0&&(gs=4194304),l}function mi(l){for(var u=[],m=0;31>m;m++)u.push(l);return u}function br(l,u){l.pendingLanes|=u,u!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function es(l,u,m,b,N,R){var W=l.pendingLanes;l.pendingLanes=m,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=m,l.entangledLanes&=m,l.errorRecoveryDisabledLanes&=m,l.shellSuspendCounter=0;var ce=l.entanglements,ve=l.expirationTimes,Te=l.hiddenUpdates;for(m=W&~m;0<m;){var Ue=31-or(m),Ve=1<<Ue;ce[Ue]=0,ve[Ue]=-1;var Oe=Te[Ue];if(Oe!==null)for(Te[Ue]=null,Ue=0;Ue<Oe.length;Ue++){var Ie=Oe[Ue];Ie!==null&&(Ie.lane&=-536870913)}m&=~Ve}b!==0&&qi(l,b,0),R!==0&&N===0&&l.tag!==0&&(l.suspendedLanes|=R&~(W&~u))}function qi(l,u,m){l.pendingLanes|=u,l.suspendedLanes&=~u;var b=31-or(u);l.entangledLanes|=u,l.entanglements[b]=l.entanglements[b]|1073741824|m&261930}function kn(l,u){var m=l.entangledLanes|=u;for(l=l.entanglements;m;){var b=31-or(m),N=1<<b;N&u|l[b]&u&&(l[b]|=u),m&=~N}}function ts(l,u){var m=u&-u;return m=(m&42)!==0?1:qo(m),(m&(l.suspendedLanes|u))!==0?0:m}function qo(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function Ws(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function oe(){var l=te.p;return l!==0?l:(l=window.event,l===void 0?32:wC(l.type))}function xe(l,u){var m=te.p;try{return te.p=l,u()}finally{te.p=m}}var fe=Math.random().toString(36).slice(2),de="__reactFiber$"+fe,pe="__reactProps$"+fe,ge="__reactContainer$"+fe,Ae="__reactEvents$"+fe,ze="__reactListeners$"+fe,Ce="__reactHandles$"+fe,Re="__reactResources$"+fe,je="__reactMarker$"+fe;function Xe(l){delete l[de],delete l[pe],delete l[Ae],delete l[ze],delete l[Ce]}function Ze(l){var u=l[de];if(u)return u;for(var m=l.parentNode;m;){if(u=m[ge]||m[de]){if(m=u.alternate,u.child!==null||m!==null&&m.child!==null)for(l=aC(l);l!==null;){if(m=l[de])return m;l=aC(l)}return u}l=m,m=l.parentNode}return null}function st(l){if(l=l[de]||l[ge]){var u=l.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return l}return null}function Ye(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l.stateNode;throw Error(n(33))}function tt(l){var u=l[Re];return u||(u=l[Re]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function ct(l){l[je]=!0}var gr=new Set,yr={};function Cr(l,u){ha(l,u),ha(l+"Capture",u)}function ha(l,u){for(yr[l]=u,l=0;l<u.length;l++)gr.add(u[l])}var tc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wo={},xi={};function bd(l){return H.call(xi,l)?!0:H.call(Wo,l)?!1:tc.test(l)?xi[l]=!0:(Wo[l]=!0,!1)}function ks(l,u,m){if(bd(u))if(m===null)l.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":l.removeAttribute(u);return;case"boolean":var b=u.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){l.removeAttribute(u);return}}l.setAttribute(u,""+m)}}function vp(l,u,m){if(m===null)l.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(u);return}l.setAttribute(u,""+m)}}function Wi(l,u,m,b){if(b===null)l.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(m);return}l.setAttributeNS(u,m,""+b)}}function pa(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function VN(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function EB(l,u,m){var b=Object.getOwnPropertyDescriptor(l.constructor.prototype,u);if(!l.hasOwnProperty(u)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var N=b.get,R=b.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return N.call(this)},set:function(W){m=""+W,R.call(this,W)}}),Object.defineProperty(l,u,{enumerable:b.enumerable}),{getValue:function(){return m},setValue:function(W){m=""+W},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function ny(l){if(!l._valueTracker){var u=VN(l)?"checked":"value";l._valueTracker=EB(l,u,""+l[u])}}function qN(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var m=u.getValue(),b="";return l&&(b=VN(l)?l.checked?"true":"false":l.value),l=b,l!==m?(u.setValue(l),!0):!1}function bp(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var SB=/[\n"\\]/g;function ma(l){return l.replace(SB,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function sy(l,u,m,b,N,R,W,ce){l.name="",W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?l.type=W:l.removeAttribute("type"),u!=null?W==="number"?(u===0&&l.value===""||l.value!=u)&&(l.value=""+pa(u)):l.value!==""+pa(u)&&(l.value=""+pa(u)):W!=="submit"&&W!=="reset"||l.removeAttribute("value"),u!=null?ay(l,W,pa(u)):m!=null?ay(l,W,pa(m)):b!=null&&l.removeAttribute("value"),N==null&&R!=null&&(l.defaultChecked=!!R),N!=null&&(l.checked=N&&typeof N!="function"&&typeof N!="symbol"),ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?l.name=""+pa(ce):l.removeAttribute("name")}function WN(l,u,m,b,N,R,W,ce){if(R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(l.type=R),u!=null||m!=null){if(!(R!=="submit"&&R!=="reset"||u!=null)){ny(l);return}m=m!=null?""+pa(m):"",u=u!=null?""+pa(u):m,ce||u===l.value||(l.value=u),l.defaultValue=u}b=b??N,b=typeof b!="function"&&typeof b!="symbol"&&!!b,l.checked=ce?l.checked:!!b,l.defaultChecked=!!b,W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"&&(l.name=W),ny(l)}function ay(l,u,m){u==="number"&&bp(l.ownerDocument)===l||l.defaultValue===""+m||(l.defaultValue=""+m)}function wu(l,u,m,b){if(l=l.options,u){u={};for(var N=0;N<m.length;N++)u["$"+m[N]]=!0;for(m=0;m<l.length;m++)N=u.hasOwnProperty("$"+l[m].value),l[m].selected!==N&&(l[m].selected=N),N&&b&&(l[m].defaultSelected=!0)}else{for(m=""+pa(m),u=null,N=0;N<l.length;N++){if(l[N].value===m){l[N].selected=!0,b&&(l[N].defaultSelected=!0);return}u!==null||l[N].disabled||(u=l[N])}u!==null&&(u.selected=!0)}}function $N(l,u,m){if(u!=null&&(u=""+pa(u),u!==l.value&&(l.value=u),m==null)){l.defaultValue!==u&&(l.defaultValue=u);return}l.defaultValue=m!=null?""+pa(m):""}function GN(l,u,m,b){if(u==null){if(b!=null){if(m!=null)throw Error(n(92));if(le(b)){if(1<b.length)throw Error(n(93));b=b[0]}m=b}m==null&&(m=""),u=m}m=pa(u),l.defaultValue=m,b=l.textContent,b===m&&b!==""&&b!==null&&(l.value=b),ny(l)}function _u(l,u){if(u){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=u;return}}l.textContent=u}var NB=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function KN(l,u,m){var b=u.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?b?l.setProperty(u,""):u==="float"?l.cssFloat="":l[u]="":b?l.setProperty(u,m):typeof m!="number"||m===0||NB.has(u)?u==="float"?l.cssFloat=m:l[u]=(""+m).trim():l[u]=m+"px"}function XN(l,u,m){if(u!=null&&typeof u!="object")throw Error(n(62));if(l=l.style,m!=null){for(var b in m)!m.hasOwnProperty(b)||u!=null&&u.hasOwnProperty(b)||(b.indexOf("--")===0?l.setProperty(b,""):b==="float"?l.cssFloat="":l[b]="");for(var N in u)b=u[N],u.hasOwnProperty(N)&&m[N]!==b&&KN(l,N,b)}else for(var R in u)u.hasOwnProperty(R)&&KN(l,R,u[R])}function iy(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var TB=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kB=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wp(l){return kB.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}function $i(){}var oy=null;function ly(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Eu=null,Su=null;function YN(l){var u=st(l);if(u&&(l=u.stateNode)){var m=l[pe]||null;e:switch(l=u.stateNode,u.type){case"input":if(sy(l,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),u=m.name,m.type==="radio"&&u!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+ma(""+u)+'"][type="radio"]'),u=0;u<m.length;u++){var b=m[u];if(b!==l&&b.form===l.form){var N=b[pe]||null;if(!N)throw Error(n(90));sy(b,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(u=0;u<m.length;u++)b=m[u],b.form===l.form&&qN(b)}break e;case"textarea":$N(l,m.value,m.defaultValue);break e;case"select":u=m.value,u!=null&&wu(l,!!m.multiple,u,!1)}}}var cy=!1;function JN(l,u,m){if(cy)return l(u,m);cy=!0;try{var b=l(u);return b}finally{if(cy=!1,(Eu!==null||Su!==null)&&(lm(),Eu&&(u=Eu,l=Su,Su=Eu=null,YN(u),l)))for(u=0;u<l.length;u++)YN(l[u])}}function wd(l,u){var m=l.stateNode;if(m===null)return null;var b=m[pe]||null;if(b===null)return null;m=b[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(l=l.type,b=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!b;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(n(231,u,typeof m));return m}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uy=!1;if(Gi)try{var _d={};Object.defineProperty(_d,"passive",{get:function(){uy=!0}}),window.addEventListener("test",_d,_d),window.removeEventListener("test",_d,_d)}catch{uy=!1}var $o=null,fy=null,_p=null;function ZN(){if(_p)return _p;var l,u=fy,m=u.length,b,N="value"in $o?$o.value:$o.textContent,R=N.length;for(l=0;l<m&&u[l]===N[l];l++);var W=m-l;for(b=1;b<=W&&u[m-b]===N[R-b];b++);return _p=N.slice(l,1<b?1-b:void 0)}function Ep(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function Sp(){return!0}function QN(){return!1}function As(l){function u(m,b,N,R,W){this._reactName=m,this._targetInst=N,this.type=b,this.nativeEvent=R,this.target=W,this.currentTarget=null;for(var ce in l)l.hasOwnProperty(ce)&&(m=l[ce],this[ce]=m?m(R):R[ce]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?Sp:QN,this.isPropagationStopped=QN,this}return p(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Sp)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Sp)},persist:function(){},isPersistent:Sp}),u}var rc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Np=As(rc),Ed=p({},rc,{view:0,detail:0}),AB=As(Ed),dy,hy,Sd,Tp=p({},Ed,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:my,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Sd&&(Sd&&l.type==="mousemove"?(dy=l.screenX-Sd.screenX,hy=l.screenY-Sd.screenY):hy=dy=0,Sd=l),dy)},movementY:function(l){return"movementY"in l?l.movementY:hy}}),eT=As(Tp),CB=p({},Tp,{dataTransfer:0}),RB=As(CB),OB=p({},Ed,{relatedTarget:0}),py=As(OB),jB=p({},rc,{animationName:0,elapsedTime:0,pseudoElement:0}),DB=As(jB),IB=p({},rc,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),MB=As(IB),FB=p({},rc,{data:0}),tT=As(FB),PB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},LB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UB(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=BB[l])?!!u[l]:!1}function my(){return UB}var zB=p({},Ed,{key:function(l){if(l.key){var u=PB[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=Ep(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?LB[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:my,charCode:function(l){return l.type==="keypress"?Ep(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Ep(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),HB=As(zB),VB=p({},Tp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rT=As(VB),qB=p({},Ed,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:my}),WB=As(qB),$B=p({},rc,{propertyName:0,elapsedTime:0,pseudoElement:0}),GB=As($B),KB=p({},Tp,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),XB=As(KB),YB=p({},rc,{newState:0,oldState:0}),JB=As(YB),ZB=[9,13,27,32],xy=Gi&&"CompositionEvent"in window,Nd=null;Gi&&"documentMode"in document&&(Nd=document.documentMode);var QB=Gi&&"TextEvent"in window&&!Nd,nT=Gi&&(!xy||Nd&&8<Nd&&11>=Nd),sT=" ",aT=!1;function iT(l,u){switch(l){case"keyup":return ZB.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oT(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Nu=!1;function e9(l,u){switch(l){case"compositionend":return oT(u);case"keypress":return u.which!==32?null:(aT=!0,sT);case"textInput":return l=u.data,l===sT&&aT?null:l;default:return null}}function t9(l,u){if(Nu)return l==="compositionend"||!xy&&iT(l,u)?(l=ZN(),_p=fy=$o=null,Nu=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return nT&&u.locale!=="ko"?null:u.data;default:return null}}var r9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lT(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!r9[l.type]:u==="textarea"}function cT(l,u,m,b){Eu?Su?Su.push(b):Su=[b]:Eu=b,u=mm(u,"onChange"),0<u.length&&(m=new Np("onChange","change",null,m,b),l.push({event:m,listeners:u}))}var Td=null,kd=null;function n9(l){WA(l,0)}function kp(l){var u=Ye(l);if(qN(u))return l}function uT(l,u){if(l==="change")return u}var fT=!1;if(Gi){var gy;if(Gi){var yy="oninput"in document;if(!yy){var dT=document.createElement("div");dT.setAttribute("oninput","return;"),yy=typeof dT.oninput=="function"}gy=yy}else gy=!1;fT=gy&&(!document.documentMode||9<document.documentMode)}function hT(){Td&&(Td.detachEvent("onpropertychange",pT),kd=Td=null)}function pT(l){if(l.propertyName==="value"&&kp(kd)){var u=[];cT(u,kd,l,ly(l)),JN(n9,u)}}function s9(l,u,m){l==="focusin"?(hT(),Td=u,kd=m,Td.attachEvent("onpropertychange",pT)):l==="focusout"&&hT()}function a9(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return kp(kd)}function i9(l,u){if(l==="click")return kp(u)}function o9(l,u){if(l==="input"||l==="change")return kp(u)}function l9(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var $s=typeof Object.is=="function"?Object.is:l9;function Ad(l,u){if($s(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var m=Object.keys(l),b=Object.keys(u);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var N=m[b];if(!H.call(u,N)||!$s(l[N],u[N]))return!1}return!0}function mT(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function xT(l,u){var m=mT(l);l=0;for(var b;m;){if(m.nodeType===3){if(b=l+m.textContent.length,l<=u&&b>=u)return{node:m,offset:u-l};l=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=mT(m)}}function gT(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?gT(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function yT(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var u=bp(l.document);u instanceof l.HTMLIFrameElement;){try{var m=typeof u.contentWindow.location.href=="string"}catch{m=!1}if(m)l=u.contentWindow;else break;u=bp(l.document)}return u}function vy(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}var c9=Gi&&"documentMode"in document&&11>=document.documentMode,Tu=null,by=null,Cd=null,wy=!1;function vT(l,u,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;wy||Tu==null||Tu!==bp(b)||(b=Tu,"selectionStart"in b&&vy(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),Cd&&Ad(Cd,b)||(Cd=b,b=mm(by,"onSelect"),0<b.length&&(u=new Np("onSelect","select",null,u,m),l.push({event:u,listeners:b}),u.target=Tu)))}function nc(l,u){var m={};return m[l.toLowerCase()]=u.toLowerCase(),m["Webkit"+l]="webkit"+u,m["Moz"+l]="moz"+u,m}var ku={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionrun:nc("Transition","TransitionRun"),transitionstart:nc("Transition","TransitionStart"),transitioncancel:nc("Transition","TransitionCancel"),transitionend:nc("Transition","TransitionEnd")},_y={},bT={};Gi&&(bT=document.createElement("div").style,"AnimationEvent"in window||(delete ku.animationend.animation,delete ku.animationiteration.animation,delete ku.animationstart.animation),"TransitionEvent"in window||delete ku.transitionend.transition);function sc(l){if(_y[l])return _y[l];if(!ku[l])return l;var u=ku[l],m;for(m in u)if(u.hasOwnProperty(m)&&m in bT)return _y[l]=u[m];return l}var wT=sc("animationend"),_T=sc("animationiteration"),ET=sc("animationstart"),u9=sc("transitionrun"),f9=sc("transitionstart"),d9=sc("transitioncancel"),ST=sc("transitionend"),NT=new Map,Ey="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ey.push("scrollEnd");function Xa(l,u){NT.set(l,u),Cr(u,[l])}var Ap=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},xa=[],Au=0,Sy=0;function Cp(){for(var l=Au,u=Sy=Au=0;u<l;){var m=xa[u];xa[u++]=null;var b=xa[u];xa[u++]=null;var N=xa[u];xa[u++]=null;var R=xa[u];if(xa[u++]=null,b!==null&&N!==null){var W=b.pending;W===null?N.next=N:(N.next=W.next,W.next=N),b.pending=N}R!==0&&TT(m,N,R)}}function Rp(l,u,m,b){xa[Au++]=l,xa[Au++]=u,xa[Au++]=m,xa[Au++]=b,Sy|=b,l.lanes|=b,l=l.alternate,l!==null&&(l.lanes|=b)}function Ny(l,u,m,b){return Rp(l,u,m,b),Op(l)}function ac(l,u){return Rp(l,null,null,u),Op(l)}function TT(l,u,m){l.lanes|=m;var b=l.alternate;b!==null&&(b.lanes|=m);for(var N=!1,R=l.return;R!==null;)R.childLanes|=m,b=R.alternate,b!==null&&(b.childLanes|=m),R.tag===22&&(l=R.stateNode,l===null||l._visibility&1||(N=!0)),l=R,R=R.return;return l.tag===3?(R=l.stateNode,N&&u!==null&&(N=31-or(m),l=R.hiddenUpdates,b=l[N],b===null?l[N]=[u]:b.push(u),u.lane=m|536870912),R):null}function Op(l){if(50<Jd)throw Jd=0,Iv=null,Error(n(185));for(var u=l.return;u!==null;)l=u,u=l.return;return l.tag===3?l.stateNode:null}var Cu={};function h9(l,u,m,b){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gs(l,u,m,b){return new h9(l,u,m,b)}function Ty(l){return l=l.prototype,!(!l||!l.isReactComponent)}function Ki(l,u){var m=l.alternate;return m===null?(m=Gs(l.tag,u,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=u,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&65011712,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,u=l.dependencies,m.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m.refCleanup=l.refCleanup,m}function kT(l,u){l.flags&=65011714;var m=l.alternate;return m===null?(l.childLanes=0,l.lanes=u,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=m.childLanes,l.lanes=m.lanes,l.child=m.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=m.memoizedProps,l.memoizedState=m.memoizedState,l.updateQueue=m.updateQueue,l.type=m.type,u=m.dependencies,l.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),l}function jp(l,u,m,b,N,R){var W=0;if(b=l,typeof l=="function")Ty(l)&&(W=1);else if(typeof l=="string")W=y7(l,m,G.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case j:return l=Gs(31,m,u,N),l.elementType=j,l.lanes=R,l;case y:return ic(m.children,N,R,u);case w:W=8,N|=24;break;case _:return l=Gs(12,m,u,N|2),l.elementType=_,l.lanes=R,l;case k:return l=Gs(13,m,u,N),l.elementType=k,l.lanes=R,l;case D:return l=Gs(19,m,u,N),l.elementType=D,l.lanes=R,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case E:W=10;break e;case S:W=9;break e;case T:W=11;break e;case O:W=14;break e;case z:W=16,b=null;break e}W=29,m=Error(n(130,l===null?"null":typeof l,"")),b=null}return u=Gs(W,m,u,N),u.elementType=l,u.type=b,u.lanes=R,u}function ic(l,u,m,b){return l=Gs(7,l,b,u),l.lanes=m,l}function ky(l,u,m){return l=Gs(6,l,null,u),l.lanes=m,l}function AT(l){var u=Gs(18,null,null,0);return u.stateNode=l,u}function Ay(l,u,m){return u=Gs(4,l.children!==null?l.children:[],l.key,u),u.lanes=m,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}var CT=new WeakMap;function ga(l,u){if(typeof l=="object"&&l!==null){var m=CT.get(l);return m!==void 0?m:(u={value:l,source:u,stack:A(u)},CT.set(l,u),u)}return{value:l,source:u,stack:A(u)}}var Ru=[],Ou=0,Dp=null,Rd=0,ya=[],va=0,Go=null,gi=1,yi="";function Xi(l,u){Ru[Ou++]=Rd,Ru[Ou++]=Dp,Dp=l,Rd=u}function RT(l,u,m){ya[va++]=gi,ya[va++]=yi,ya[va++]=Go,Go=l;var b=gi;l=yi;var N=32-or(b)-1;b&=~(1<<N),m+=1;var R=32-or(u)+N;if(30<R){var W=N-N%5;R=(b&(1<<W)-1).toString(32),b>>=W,N-=W,gi=1<<32-or(u)+N|m<<N|b,yi=R+l}else gi=1<<R|m<<N|b,yi=l}function Cy(l){l.return!==null&&(Xi(l,1),RT(l,1,0))}function Ry(l){for(;l===Dp;)Dp=Ru[--Ou],Ru[Ou]=null,Rd=Ru[--Ou],Ru[Ou]=null;for(;l===Go;)Go=ya[--va],ya[va]=null,yi=ya[--va],ya[va]=null,gi=ya[--va],ya[va]=null}function OT(l,u){ya[va++]=gi,ya[va++]=yi,ya[va++]=Go,gi=u.id,yi=u.overflow,Go=l}var Pn=null,wr=null,Wt=!1,Ko=null,ba=!1,Oy=Error(n(519));function Xo(l){var u=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Od(ga(u,l)),Oy}function jT(l){var u=l.stateNode,m=l.type,b=l.memoizedProps;switch(u[de]=l,u[pe]=b,m){case"dialog":zt("cancel",u),zt("close",u);break;case"iframe":case"object":case"embed":zt("load",u);break;case"video":case"audio":for(m=0;m<Qd.length;m++)zt(Qd[m],u);break;case"source":zt("error",u);break;case"img":case"image":case"link":zt("error",u),zt("load",u);break;case"details":zt("toggle",u);break;case"input":zt("invalid",u),WN(u,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0);break;case"select":zt("invalid",u);break;case"textarea":zt("invalid",u),GN(u,b.value,b.defaultValue,b.children)}m=b.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||u.textContent===""+m||b.suppressHydrationWarning===!0||XA(u.textContent,m)?(b.popover!=null&&(zt("beforetoggle",u),zt("toggle",u)),b.onScroll!=null&&zt("scroll",u),b.onScrollEnd!=null&&zt("scrollend",u),b.onClick!=null&&(u.onclick=$i),u=!0):u=!1,u||Xo(l,!0)}function DT(l){for(Pn=l.return;Pn;)switch(Pn.tag){case 5:case 31:case 13:ba=!1;return;case 27:case 3:ba=!0;return;default:Pn=Pn.return}}function ju(l){if(l!==Pn)return!1;if(!Wt)return DT(l),Wt=!0,!1;var u=l.tag,m;if((m=u!==3&&u!==27)&&((m=u===5)&&(m=l.type,m=!(m!=="form"&&m!=="button")||Xv(l.type,l.memoizedProps)),m=!m),m&&wr&&Xo(l),DT(l),u===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));wr=sC(l)}else if(u===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));wr=sC(l)}else u===27?(u=wr,cl(l.type)?(l=eb,eb=null,wr=l):wr=u):wr=Pn?_a(l.stateNode.nextSibling):null;return!0}function oc(){wr=Pn=null,Wt=!1}function jy(){var l=Ko;return l!==null&&(js===null?js=l:js.push.apply(js,l),Ko=null),l}function Od(l){Ko===null?Ko=[l]:Ko.push(l)}var Dy=K(null),lc=null,Yi=null;function Yo(l,u,m){q(Dy,u._currentValue),u._currentValue=m}function Ji(l){l._currentValue=Dy.current,M(Dy)}function Iy(l,u,m){for(;l!==null;){var b=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,b!==null&&(b.childLanes|=u)):b!==null&&(b.childLanes&u)!==u&&(b.childLanes|=u),l===m)break;l=l.return}}function My(l,u,m,b){var N=l.child;for(N!==null&&(N.return=l);N!==null;){var R=N.dependencies;if(R!==null){var W=N.child;R=R.firstContext;e:for(;R!==null;){var ce=R;R=N;for(var ve=0;ve<u.length;ve++)if(ce.context===u[ve]){R.lanes|=m,ce=R.alternate,ce!==null&&(ce.lanes|=m),Iy(R.return,m,l),b||(W=null);break e}R=ce.next}}else if(N.tag===18){if(W=N.return,W===null)throw Error(n(341));W.lanes|=m,R=W.alternate,R!==null&&(R.lanes|=m),Iy(W,m,l),W=null}else W=N.child;if(W!==null)W.return=N;else for(W=N;W!==null;){if(W===l){W=null;break}if(N=W.sibling,N!==null){N.return=W.return,W=N;break}W=W.return}N=W}}function Du(l,u,m,b){l=null;for(var N=u,R=!1;N!==null;){if(!R){if((N.flags&524288)!==0)R=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var W=N.alternate;if(W===null)throw Error(n(387));if(W=W.memoizedProps,W!==null){var ce=N.type;$s(N.pendingProps.value,W.value)||(l!==null?l.push(ce):l=[ce])}}else if(N===L.current){if(W=N.alternate,W===null)throw Error(n(387));W.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(l!==null?l.push(sh):l=[sh])}N=N.return}l!==null&&My(u,l,m,b),u.flags|=262144}function Ip(l){for(l=l.firstContext;l!==null;){if(!$s(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function cc(l){lc=l,Yi=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Ln(l){return IT(lc,l)}function Mp(l,u){return lc===null&&cc(l),IT(l,u)}function IT(l,u){var m=u._currentValue;if(u={context:u,memoizedValue:m,next:null},Yi===null){if(l===null)throw Error(n(308));Yi=u,l.dependencies={lanes:0,firstContext:u},l.flags|=524288}else Yi=Yi.next=u;return m}var p9=typeof AbortController<"u"?AbortController:function(){var l=[],u=this.signal={aborted:!1,addEventListener:function(m,b){l.push(b)}};this.abort=function(){u.aborted=!0,l.forEach(function(m){return m()})}},m9=e.unstable_scheduleCallback,x9=e.unstable_NormalPriority,an={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fy(){return{controller:new p9,data:new Map,refCount:0}}function jd(l){l.refCount--,l.refCount===0&&m9(x9,function(){l.controller.abort()})}var Dd=null,Py=0,Iu=0,Mu=null;function g9(l,u){if(Dd===null){var m=Dd=[];Py=0,Iu=Uv(),Mu={status:"pending",value:void 0,then:function(b){m.push(b)}}}return Py++,u.then(MT,MT),u}function MT(){if(--Py===0&&Dd!==null){Mu!==null&&(Mu.status="fulfilled");var l=Dd;Dd=null,Iu=0,Mu=null;for(var u=0;u<l.length;u++)(0,l[u])()}}function y9(l,u){var m=[],b={status:"pending",value:null,reason:null,then:function(N){m.push(N)}};return l.then(function(){b.status="fulfilled",b.value=u;for(var N=0;N<m.length;N++)(0,m[N])(u)},function(N){for(b.status="rejected",b.reason=N,N=0;N<m.length;N++)(0,m[N])(void 0)}),b}var FT=ee.S;ee.S=function(l,u){vA=De(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&g9(l,u),FT!==null&&FT(l,u)};var uc=K(null);function Ly(){var l=uc.current;return l!==null?l:pr.pooledCache}function Fp(l,u){u===null?q(uc,uc.current):q(uc,u.pool)}function PT(){var l=Ly();return l===null?null:{parent:an._currentValue,pool:l}}var Fu=Error(n(460)),By=Error(n(474)),Pp=Error(n(542)),Lp={then:function(){}};function LT(l){return l=l.status,l==="fulfilled"||l==="rejected"}function BT(l,u,m){switch(m=l[m],m===void 0?l.push(u):m!==u&&(u.then($i,$i),u=m),u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,zT(l),l;default:if(typeof u.status=="string")u.then($i,$i);else{if(l=pr,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=u,l.status="pending",l.then(function(b){if(u.status==="pending"){var N=u;N.status="fulfilled",N.value=b}},function(b){if(u.status==="pending"){var N=u;N.status="rejected",N.reason=b}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,zT(l),l}throw dc=u,Fu}}function fc(l){try{var u=l._init;return u(l._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(dc=m,Fu):m}}var dc=null;function UT(){if(dc===null)throw Error(n(459));var l=dc;return dc=null,l}function zT(l){if(l===Fu||l===Pp)throw Error(n(483))}var Pu=null,Id=0;function Bp(l){var u=Id;return Id+=1,Pu===null&&(Pu=[]),BT(Pu,l,u)}function Md(l,u){u=u.props.ref,l.ref=u!==void 0?u:null}function Up(l,u){throw u.$$typeof===x?Error(n(525)):(l=Object.prototype.toString.call(u),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l)))}function HT(l){function u(Se,_e){if(l){var Ne=Se.deletions;Ne===null?(Se.deletions=[_e],Se.flags|=16):Ne.push(_e)}}function m(Se,_e){if(!l)return null;for(;_e!==null;)u(Se,_e),_e=_e.sibling;return null}function b(Se){for(var _e=new Map;Se!==null;)Se.key!==null?_e.set(Se.key,Se):_e.set(Se.index,Se),Se=Se.sibling;return _e}function N(Se,_e){return Se=Ki(Se,_e),Se.index=0,Se.sibling=null,Se}function R(Se,_e,Ne){return Se.index=Ne,l?(Ne=Se.alternate,Ne!==null?(Ne=Ne.index,Ne<_e?(Se.flags|=67108866,_e):Ne):(Se.flags|=67108866,_e)):(Se.flags|=1048576,_e)}function W(Se){return l&&Se.alternate===null&&(Se.flags|=67108866),Se}function ce(Se,_e,Ne,He){return _e===null||_e.tag!==6?(_e=ky(Ne,Se.mode,He),_e.return=Se,_e):(_e=N(_e,Ne),_e.return=Se,_e)}function ve(Se,_e,Ne,He){var pt=Ne.type;return pt===y?Ue(Se,_e,Ne.props.children,He,Ne.key):_e!==null&&(_e.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===z&&fc(pt)===_e.type)?(_e=N(_e,Ne.props),Md(_e,Ne),_e.return=Se,_e):(_e=jp(Ne.type,Ne.key,Ne.props,null,Se.mode,He),Md(_e,Ne),_e.return=Se,_e)}function Te(Se,_e,Ne,He){return _e===null||_e.tag!==4||_e.stateNode.containerInfo!==Ne.containerInfo||_e.stateNode.implementation!==Ne.implementation?(_e=Ay(Ne,Se.mode,He),_e.return=Se,_e):(_e=N(_e,Ne.children||[]),_e.return=Se,_e)}function Ue(Se,_e,Ne,He,pt){return _e===null||_e.tag!==7?(_e=ic(Ne,Se.mode,He,pt),_e.return=Se,_e):(_e=N(_e,Ne),_e.return=Se,_e)}function Ve(Se,_e,Ne){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return _e=ky(""+_e,Se.mode,Ne),_e.return=Se,_e;if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case g:return Ne=jp(_e.type,_e.key,_e.props,null,Se.mode,Ne),Md(Ne,_e),Ne.return=Se,Ne;case v:return _e=Ay(_e,Se.mode,Ne),_e.return=Se,_e;case z:return _e=fc(_e),Ve(Se,_e,Ne)}if(le(_e)||F(_e))return _e=ic(_e,Se.mode,Ne,null),_e.return=Se,_e;if(typeof _e.then=="function")return Ve(Se,Bp(_e),Ne);if(_e.$$typeof===E)return Ve(Se,Mp(Se,_e),Ne);Up(Se,_e)}return null}function Oe(Se,_e,Ne,He){var pt=_e!==null?_e.key:null;if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return pt!==null?null:ce(Se,_e,""+Ne,He);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case g:return Ne.key===pt?ve(Se,_e,Ne,He):null;case v:return Ne.key===pt?Te(Se,_e,Ne,He):null;case z:return Ne=fc(Ne),Oe(Se,_e,Ne,He)}if(le(Ne)||F(Ne))return pt!==null?null:Ue(Se,_e,Ne,He,null);if(typeof Ne.then=="function")return Oe(Se,_e,Bp(Ne),He);if(Ne.$$typeof===E)return Oe(Se,_e,Mp(Se,Ne),He);Up(Se,Ne)}return null}function Ie(Se,_e,Ne,He,pt){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return Se=Se.get(Ne)||null,ce(_e,Se,""+He,pt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case g:return Se=Se.get(He.key===null?Ne:He.key)||null,ve(_e,Se,He,pt);case v:return Se=Se.get(He.key===null?Ne:He.key)||null,Te(_e,Se,He,pt);case z:return He=fc(He),Ie(Se,_e,Ne,He,pt)}if(le(He)||F(He))return Se=Se.get(Ne)||null,Ue(_e,Se,He,pt,null);if(typeof He.then=="function")return Ie(Se,_e,Ne,Bp(He),pt);if(He.$$typeof===E)return Ie(Se,_e,Ne,Mp(_e,He),pt);Up(_e,He)}return null}function ot(Se,_e,Ne,He){for(var pt=null,Kt=null,ft=_e,Rt=_e=0,Vt=null;ft!==null&&Rt<Ne.length;Rt++){ft.index>Rt?(Vt=ft,ft=null):Vt=ft.sibling;var Xt=Oe(Se,ft,Ne[Rt],He);if(Xt===null){ft===null&&(ft=Vt);break}l&&ft&&Xt.alternate===null&&u(Se,ft),_e=R(Xt,_e,Rt),Kt===null?pt=Xt:Kt.sibling=Xt,Kt=Xt,ft=Vt}if(Rt===Ne.length)return m(Se,ft),Wt&&Xi(Se,Rt),pt;if(ft===null){for(;Rt<Ne.length;Rt++)ft=Ve(Se,Ne[Rt],He),ft!==null&&(_e=R(ft,_e,Rt),Kt===null?pt=ft:Kt.sibling=ft,Kt=ft);return Wt&&Xi(Se,Rt),pt}for(ft=b(ft);Rt<Ne.length;Rt++)Vt=Ie(ft,Se,Rt,Ne[Rt],He),Vt!==null&&(l&&Vt.alternate!==null&&ft.delete(Vt.key===null?Rt:Vt.key),_e=R(Vt,_e,Rt),Kt===null?pt=Vt:Kt.sibling=Vt,Kt=Vt);return l&&ft.forEach(function(pl){return u(Se,pl)}),Wt&&Xi(Se,Rt),pt}function gt(Se,_e,Ne,He){if(Ne==null)throw Error(n(151));for(var pt=null,Kt=null,ft=_e,Rt=_e=0,Vt=null,Xt=Ne.next();ft!==null&&!Xt.done;Rt++,Xt=Ne.next()){ft.index>Rt?(Vt=ft,ft=null):Vt=ft.sibling;var pl=Oe(Se,ft,Xt.value,He);if(pl===null){ft===null&&(ft=Vt);break}l&&ft&&pl.alternate===null&&u(Se,ft),_e=R(pl,_e,Rt),Kt===null?pt=pl:Kt.sibling=pl,Kt=pl,ft=Vt}if(Xt.done)return m(Se,ft),Wt&&Xi(Se,Rt),pt;if(ft===null){for(;!Xt.done;Rt++,Xt=Ne.next())Xt=Ve(Se,Xt.value,He),Xt!==null&&(_e=R(Xt,_e,Rt),Kt===null?pt=Xt:Kt.sibling=Xt,Kt=Xt);return Wt&&Xi(Se,Rt),pt}for(ft=b(ft);!Xt.done;Rt++,Xt=Ne.next())Xt=Ie(ft,Se,Rt,Xt.value,He),Xt!==null&&(l&&Xt.alternate!==null&&ft.delete(Xt.key===null?Rt:Xt.key),_e=R(Xt,_e,Rt),Kt===null?pt=Xt:Kt.sibling=Xt,Kt=Xt);return l&&ft.forEach(function(C7){return u(Se,C7)}),Wt&&Xi(Se,Rt),pt}function ur(Se,_e,Ne,He){if(typeof Ne=="object"&&Ne!==null&&Ne.type===y&&Ne.key===null&&(Ne=Ne.props.children),typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case g:e:{for(var pt=Ne.key;_e!==null;){if(_e.key===pt){if(pt=Ne.type,pt===y){if(_e.tag===7){m(Se,_e.sibling),He=N(_e,Ne.props.children),He.return=Se,Se=He;break e}}else if(_e.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===z&&fc(pt)===_e.type){m(Se,_e.sibling),He=N(_e,Ne.props),Md(He,Ne),He.return=Se,Se=He;break e}m(Se,_e);break}else u(Se,_e);_e=_e.sibling}Ne.type===y?(He=ic(Ne.props.children,Se.mode,He,Ne.key),He.return=Se,Se=He):(He=jp(Ne.type,Ne.key,Ne.props,null,Se.mode,He),Md(He,Ne),He.return=Se,Se=He)}return W(Se);case v:e:{for(pt=Ne.key;_e!==null;){if(_e.key===pt)if(_e.tag===4&&_e.stateNode.containerInfo===Ne.containerInfo&&_e.stateNode.implementation===Ne.implementation){m(Se,_e.sibling),He=N(_e,Ne.children||[]),He.return=Se,Se=He;break e}else{m(Se,_e);break}else u(Se,_e);_e=_e.sibling}He=Ay(Ne,Se.mode,He),He.return=Se,Se=He}return W(Se);case z:return Ne=fc(Ne),ur(Se,_e,Ne,He)}if(le(Ne))return ot(Se,_e,Ne,He);if(F(Ne)){if(pt=F(Ne),typeof pt!="function")throw Error(n(150));return Ne=pt.call(Ne),gt(Se,_e,Ne,He)}if(typeof Ne.then=="function")return ur(Se,_e,Bp(Ne),He);if(Ne.$$typeof===E)return ur(Se,_e,Mp(Se,Ne),He);Up(Se,Ne)}return typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint"?(Ne=""+Ne,_e!==null&&_e.tag===6?(m(Se,_e.sibling),He=N(_e,Ne),He.return=Se,Se=He):(m(Se,_e),He=ky(Ne,Se.mode,He),He.return=Se,Se=He),W(Se)):m(Se,_e)}return function(Se,_e,Ne,He){try{Id=0;var pt=ur(Se,_e,Ne,He);return Pu=null,pt}catch(ft){if(ft===Fu||ft===Pp)throw ft;var Kt=Gs(29,ft,null,Se.mode);return Kt.lanes=He,Kt.return=Se,Kt}finally{}}}var hc=HT(!0),VT=HT(!1),Jo=!1;function Uy(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zy(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function Zo(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function Qo(l,u,m){var b=l.updateQueue;if(b===null)return null;if(b=b.shared,(Jt&2)!==0){var N=b.pending;return N===null?u.next=u:(u.next=N.next,N.next=u),b.pending=u,u=Op(l),TT(l,null,m),u}return Rp(l,b,u,m),Op(l)}function Fd(l,u,m){if(u=u.updateQueue,u!==null&&(u=u.shared,(m&4194048)!==0)){var b=u.lanes;b&=l.pendingLanes,m|=b,u.lanes=m,kn(l,m)}}function Hy(l,u){var m=l.updateQueue,b=l.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var N=null,R=null;if(m=m.firstBaseUpdate,m!==null){do{var W={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};R===null?N=R=W:R=R.next=W,m=m.next}while(m!==null);R===null?N=R=u:R=R.next=u}else N=R=u;m={baseState:b.baseState,firstBaseUpdate:N,lastBaseUpdate:R,shared:b.shared,callbacks:b.callbacks},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=u:l.next=u,m.lastBaseUpdate=u}var Vy=!1;function Pd(){if(Vy){var l=Mu;if(l!==null)throw l}}function Ld(l,u,m,b){Vy=!1;var N=l.updateQueue;Jo=!1;var R=N.firstBaseUpdate,W=N.lastBaseUpdate,ce=N.shared.pending;if(ce!==null){N.shared.pending=null;var ve=ce,Te=ve.next;ve.next=null,W===null?R=Te:W.next=Te,W=ve;var Ue=l.alternate;Ue!==null&&(Ue=Ue.updateQueue,ce=Ue.lastBaseUpdate,ce!==W&&(ce===null?Ue.firstBaseUpdate=Te:ce.next=Te,Ue.lastBaseUpdate=ve))}if(R!==null){var Ve=N.baseState;W=0,Ue=Te=ve=null,ce=R;do{var Oe=ce.lane&-536870913,Ie=Oe!==ce.lane;if(Ie?(Ht&Oe)===Oe:(b&Oe)===Oe){Oe!==0&&Oe===Iu&&(Vy=!0),Ue!==null&&(Ue=Ue.next={lane:0,tag:ce.tag,payload:ce.payload,callback:null,next:null});e:{var ot=l,gt=ce;Oe=u;var ur=m;switch(gt.tag){case 1:if(ot=gt.payload,typeof ot=="function"){Ve=ot.call(ur,Ve,Oe);break e}Ve=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=gt.payload,Oe=typeof ot=="function"?ot.call(ur,Ve,Oe):ot,Oe==null)break e;Ve=p({},Ve,Oe);break e;case 2:Jo=!0}}Oe=ce.callback,Oe!==null&&(l.flags|=64,Ie&&(l.flags|=8192),Ie=N.callbacks,Ie===null?N.callbacks=[Oe]:Ie.push(Oe))}else Ie={lane:Oe,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},Ue===null?(Te=Ue=Ie,ve=Ve):Ue=Ue.next=Ie,W|=Oe;if(ce=ce.next,ce===null){if(ce=N.shared.pending,ce===null)break;Ie=ce,ce=Ie.next,Ie.next=null,N.lastBaseUpdate=Ie,N.shared.pending=null}}while(!0);Ue===null&&(ve=Ve),N.baseState=ve,N.firstBaseUpdate=Te,N.lastBaseUpdate=Ue,R===null&&(N.shared.lanes=0),sl|=W,l.lanes=W,l.memoizedState=Ve}}function qT(l,u){if(typeof l!="function")throw Error(n(191,l));l.call(u)}function WT(l,u){var m=l.callbacks;if(m!==null)for(l.callbacks=null,l=0;l<m.length;l++)qT(m[l],u)}var Lu=K(null),zp=K(0);function $T(l,u){l=io,q(zp,l),q(Lu,u),io=l|u.baseLanes}function qy(){q(zp,io),q(Lu,Lu.current)}function Wy(){io=zp.current,M(Lu),M(zp)}var Ks=K(null),wa=null;function el(l){var u=l.alternate;q($r,$r.current&1),q(Ks,l),wa===null&&(u===null||Lu.current!==null||u.memoizedState!==null)&&(wa=l)}function $y(l){q($r,$r.current),q(Ks,l),wa===null&&(wa=l)}function GT(l){l.tag===22?(q($r,$r.current),q(Ks,l),wa===null&&(wa=l)):tl()}function tl(){q($r,$r.current),q(Ks,Ks.current)}function Xs(l){M(Ks),wa===l&&(wa=null),M($r)}var $r=K(0);function Hp(l){for(var u=l;u!==null;){if(u.tag===13){var m=u.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||Zv(m)||Qv(m)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Zi=0,kt=null,lr=null,on=null,Vp=!1,Bu=!1,pc=!1,qp=0,Bd=0,Uu=null,v9=0;function Pr(){throw Error(n(321))}function Gy(l,u){if(u===null)return!1;for(var m=0;m<u.length&&m<l.length;m++)if(!$s(l[m],u[m]))return!1;return!0}function Ky(l,u,m,b,N,R){return Zi=R,kt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,ee.H=l===null||l.memoizedState===null?Rk:cv,pc=!1,R=m(b,N),pc=!1,Bu&&(R=XT(u,m,b,N)),KT(l),R}function KT(l){ee.H=Hd;var u=lr!==null&&lr.next!==null;if(Zi=0,on=lr=kt=null,Vp=!1,Bd=0,Uu=null,u)throw Error(n(300));l===null||ln||(l=l.dependencies,l!==null&&Ip(l)&&(ln=!0))}function XT(l,u,m,b){kt=l;var N=0;do{if(Bu&&(Uu=null),Bd=0,Bu=!1,25<=N)throw Error(n(301));if(N+=1,on=lr=null,l.updateQueue!=null){var R=l.updateQueue;R.lastEffect=null,R.events=null,R.stores=null,R.memoCache!=null&&(R.memoCache.index=0)}ee.H=Ok,R=u(m,b)}while(Bu);return R}function b9(){var l=ee.H,u=l.useState()[0];return u=typeof u.then=="function"?Ud(u):u,l=l.useState()[0],(lr!==null?lr.memoizedState:null)!==l&&(kt.flags|=1024),u}function Xy(){var l=qp!==0;return qp=0,l}function Yy(l,u,m){u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~m}function Jy(l){if(Vp){for(l=l.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}Vp=!1}Zi=0,on=lr=kt=null,Bu=!1,Bd=qp=0,Uu=null}function ys(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?kt.memoizedState=on=l:on=on.next=l,on}function Gr(){if(lr===null){var l=kt.alternate;l=l!==null?l.memoizedState:null}else l=lr.next;var u=on===null?kt.memoizedState:on.next;if(u!==null)on=u,lr=l;else{if(l===null)throw kt.alternate===null?Error(n(467)):Error(n(310));lr=l,l={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},on===null?kt.memoizedState=on=l:on=on.next=l}return on}function Wp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ud(l){var u=Bd;return Bd+=1,Uu===null&&(Uu=[]),l=BT(Uu,l,u),u=kt,(on===null?u.memoizedState:on.next)===null&&(u=u.alternate,ee.H=u===null||u.memoizedState===null?Rk:cv),l}function $p(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Ud(l);if(l.$$typeof===E)return Ln(l)}throw Error(n(438,String(l)))}function Zy(l){var u=null,m=kt.updateQueue;if(m!==null&&(u=m.memoCache),u==null){var b=kt.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(u={data:b.data.map(function(N){return N.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),m===null&&(m=Wp(),kt.updateQueue=m),m.memoCache=u,m=u.data[u.index],m===void 0)for(m=u.data[u.index]=Array(l),b=0;b<l;b++)m[b]=J;return u.index++,m}function Qi(l,u){return typeof u=="function"?u(l):u}function Gp(l){var u=Gr();return Qy(u,lr,l)}function Qy(l,u,m){var b=l.queue;if(b===null)throw Error(n(311));b.lastRenderedReducer=m;var N=l.baseQueue,R=b.pending;if(R!==null){if(N!==null){var W=N.next;N.next=R.next,R.next=W}u.baseQueue=N=R,b.pending=null}if(R=l.baseState,N===null)l.memoizedState=R;else{u=N.next;var ce=W=null,ve=null,Te=u,Ue=!1;do{var Ve=Te.lane&-536870913;if(Ve!==Te.lane?(Ht&Ve)===Ve:(Zi&Ve)===Ve){var Oe=Te.revertLane;if(Oe===0)ve!==null&&(ve=ve.next={lane:0,revertLane:0,gesture:null,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null}),Ve===Iu&&(Ue=!0);else if((Zi&Oe)===Oe){Te=Te.next,Oe===Iu&&(Ue=!0);continue}else Ve={lane:0,revertLane:Te.revertLane,gesture:null,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null},ve===null?(ce=ve=Ve,W=R):ve=ve.next=Ve,kt.lanes|=Oe,sl|=Oe;Ve=Te.action,pc&&m(R,Ve),R=Te.hasEagerState?Te.eagerState:m(R,Ve)}else Oe={lane:Ve,revertLane:Te.revertLane,gesture:Te.gesture,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null},ve===null?(ce=ve=Oe,W=R):ve=ve.next=Oe,kt.lanes|=Ve,sl|=Ve;Te=Te.next}while(Te!==null&&Te!==u);if(ve===null?W=R:ve.next=ce,!$s(R,l.memoizedState)&&(ln=!0,Ue&&(m=Mu,m!==null)))throw m;l.memoizedState=R,l.baseState=W,l.baseQueue=ve,b.lastRenderedState=R}return N===null&&(b.lanes=0),[l.memoizedState,b.dispatch]}function ev(l){var u=Gr(),m=u.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=l;var b=m.dispatch,N=m.pending,R=u.memoizedState;if(N!==null){m.pending=null;var W=N=N.next;do R=l(R,W.action),W=W.next;while(W!==N);$s(R,u.memoizedState)||(ln=!0),u.memoizedState=R,u.baseQueue===null&&(u.baseState=R),m.lastRenderedState=R}return[R,b]}function YT(l,u,m){var b=kt,N=Gr(),R=Wt;if(R){if(m===void 0)throw Error(n(407));m=m()}else m=u();var W=!$s((lr||N).memoizedState,m);if(W&&(N.memoizedState=m,ln=!0),N=N.queue,nv(QT.bind(null,b,N,l),[l]),N.getSnapshot!==u||W||on!==null&&on.memoizedState.tag&1){if(b.flags|=2048,zu(9,{destroy:void 0},ZT.bind(null,b,N,m,u),null),pr===null)throw Error(n(349));R||(Zi&127)!==0||JT(b,u,m)}return m}function JT(l,u,m){l.flags|=16384,l={getSnapshot:u,value:m},u=kt.updateQueue,u===null?(u=Wp(),kt.updateQueue=u,u.stores=[l]):(m=u.stores,m===null?u.stores=[l]:m.push(l))}function ZT(l,u,m,b){u.value=m,u.getSnapshot=b,ek(u)&&tk(l)}function QT(l,u,m){return m(function(){ek(u)&&tk(l)})}function ek(l){var u=l.getSnapshot;l=l.value;try{var m=u();return!$s(l,m)}catch{return!0}}function tk(l){var u=ac(l,2);u!==null&&Ds(u,l,2)}function tv(l){var u=ys();if(typeof l=="function"){var m=l;if(l=m(),pc){Nn(!0);try{m()}finally{Nn(!1)}}}return u.memoizedState=u.baseState=l,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:l},u}function rk(l,u,m,b){return l.baseState=m,Qy(l,lr,typeof b=="function"?b:Qi)}function w9(l,u,m,b,N){if(Yp(l))throw Error(n(485));if(l=u.action,l!==null){var R={payload:N,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(W){R.listeners.push(W)}};ee.T!==null?m(!0):R.isTransition=!1,b(R),m=u.pending,m===null?(R.next=u.pending=R,nk(u,R)):(R.next=m.next,u.pending=m.next=R)}}function nk(l,u){var m=u.action,b=u.payload,N=l.state;if(u.isTransition){var R=ee.T,W={};ee.T=W;try{var ce=m(N,b),ve=ee.S;ve!==null&&ve(W,ce),sk(l,u,ce)}catch(Te){rv(l,u,Te)}finally{R!==null&&W.types!==null&&(R.types=W.types),ee.T=R}}else try{R=m(N,b),sk(l,u,R)}catch(Te){rv(l,u,Te)}}function sk(l,u,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(b){ak(l,u,b)},function(b){return rv(l,u,b)}):ak(l,u,m)}function ak(l,u,m){u.status="fulfilled",u.value=m,ik(u),l.state=m,u=l.pending,u!==null&&(m=u.next,m===u?l.pending=null:(m=m.next,u.next=m,nk(l,m)))}function rv(l,u,m){var b=l.pending;if(l.pending=null,b!==null){b=b.next;do u.status="rejected",u.reason=m,ik(u),u=u.next;while(u!==b)}l.action=null}function ik(l){l=l.listeners;for(var u=0;u<l.length;u++)(0,l[u])()}function ok(l,u){return u}function lk(l,u){if(Wt){var m=pr.formState;if(m!==null){e:{var b=kt;if(Wt){if(wr){t:{for(var N=wr,R=ba;N.nodeType!==8;){if(!R){N=null;break t}if(N=_a(N.nextSibling),N===null){N=null;break t}}R=N.data,N=R==="F!"||R==="F"?N:null}if(N){wr=_a(N.nextSibling),b=N.data==="F!";break e}}Xo(b)}b=!1}b&&(u=m[0])}}return m=ys(),m.memoizedState=m.baseState=u,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ok,lastRenderedState:u},m.queue=b,m=kk.bind(null,kt,b),b.dispatch=m,b=tv(!1),R=lv.bind(null,kt,!1,b.queue),b=ys(),N={state:u,dispatch:null,action:l,pending:null},b.queue=N,m=w9.bind(null,kt,N,R,m),N.dispatch=m,b.memoizedState=l,[u,m,!1]}function ck(l){var u=Gr();return uk(u,lr,l)}function uk(l,u,m){if(u=Qy(l,u,ok)[0],l=Gp(Qi)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var b=Ud(u)}catch(W){throw W===Fu?Pp:W}else b=u;u=Gr();var N=u.queue,R=N.dispatch;return m!==u.memoizedState&&(kt.flags|=2048,zu(9,{destroy:void 0},_9.bind(null,N,m),null)),[b,R,l]}function _9(l,u){l.action=u}function fk(l){var u=Gr(),m=lr;if(m!==null)return uk(u,m,l);Gr(),u=u.memoizedState,m=Gr();var b=m.queue.dispatch;return m.memoizedState=l,[u,b,!1]}function zu(l,u,m,b){return l={tag:l,create:m,deps:b,inst:u,next:null},u=kt.updateQueue,u===null&&(u=Wp(),kt.updateQueue=u),m=u.lastEffect,m===null?u.lastEffect=l.next=l:(b=m.next,m.next=l,l.next=b,u.lastEffect=l),l}function dk(){return Gr().memoizedState}function Kp(l,u,m,b){var N=ys();kt.flags|=l,N.memoizedState=zu(1|u,{destroy:void 0},m,b===void 0?null:b)}function Xp(l,u,m,b){var N=Gr();b=b===void 0?null:b;var R=N.memoizedState.inst;lr!==null&&b!==null&&Gy(b,lr.memoizedState.deps)?N.memoizedState=zu(u,R,m,b):(kt.flags|=l,N.memoizedState=zu(1|u,R,m,b))}function hk(l,u){Kp(8390656,8,l,u)}function nv(l,u){Xp(2048,8,l,u)}function E9(l){kt.flags|=4;var u=kt.updateQueue;if(u===null)u=Wp(),kt.updateQueue=u,u.events=[l];else{var m=u.events;m===null?u.events=[l]:m.push(l)}}function pk(l){var u=Gr().memoizedState;return E9({ref:u,nextImpl:l}),function(){if((Jt&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}function mk(l,u){return Xp(4,2,l,u)}function xk(l,u){return Xp(4,4,l,u)}function gk(l,u){if(typeof u=="function"){l=l();var m=u(l);return function(){typeof m=="function"?m():u(null)}}if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function yk(l,u,m){m=m!=null?m.concat([l]):null,Xp(4,4,gk.bind(null,u,l),m)}function sv(){}function vk(l,u){var m=Gr();u=u===void 0?null:u;var b=m.memoizedState;return u!==null&&Gy(u,b[1])?b[0]:(m.memoizedState=[l,u],l)}function bk(l,u){var m=Gr();u=u===void 0?null:u;var b=m.memoizedState;if(u!==null&&Gy(u,b[1]))return b[0];if(b=l(),pc){Nn(!0);try{l()}finally{Nn(!1)}}return m.memoizedState=[b,u],b}function av(l,u,m){return m===void 0||(Zi&1073741824)!==0&&(Ht&261930)===0?l.memoizedState=u:(l.memoizedState=m,l=wA(),kt.lanes|=l,sl|=l,m)}function wk(l,u,m,b){return $s(m,u)?m:Lu.current!==null?(l=av(l,m,b),$s(l,u)||(ln=!0),l):(Zi&42)===0||(Zi&1073741824)!==0&&(Ht&261930)===0?(ln=!0,l.memoizedState=m):(l=wA(),kt.lanes|=l,sl|=l,u)}function _k(l,u,m,b,N){var R=te.p;te.p=R!==0&&8>R?R:8;var W=ee.T,ce={};ee.T=ce,lv(l,!1,u,m);try{var ve=N(),Te=ee.S;if(Te!==null&&Te(ce,ve),ve!==null&&typeof ve=="object"&&typeof ve.then=="function"){var Ue=y9(ve,b);zd(l,u,Ue,Zs(l))}else zd(l,u,b,Zs(l))}catch(Ve){zd(l,u,{then:function(){},status:"rejected",reason:Ve},Zs())}finally{te.p=R,W!==null&&ce.types!==null&&(W.types=ce.types),ee.T=W}}function S9(){}function iv(l,u,m,b){if(l.tag!==5)throw Error(n(476));var N=Ek(l).queue;_k(l,N,u,me,m===null?S9:function(){return Sk(l),m(b)})}function Ek(l){var u=l.memoizedState;if(u!==null)return u;u={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:me},next:null};var m={};return u.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:m},next:null},l.memoizedState=u,l=l.alternate,l!==null&&(l.memoizedState=u),u}function Sk(l){var u=Ek(l);u.next===null&&(u=l.alternate.memoizedState),zd(l,u.next.queue,{},Zs())}function ov(){return Ln(sh)}function Nk(){return Gr().memoizedState}function Tk(){return Gr().memoizedState}function N9(l){for(var u=l.return;u!==null;){switch(u.tag){case 24:case 3:var m=Zs();l=Zo(m);var b=Qo(u,l,m);b!==null&&(Ds(b,u,m),Fd(b,u,m)),u={cache:Fy()},l.payload=u;return}u=u.return}}function T9(l,u,m){var b=Zs();m={lane:b,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Yp(l)?Ak(u,m):(m=Ny(l,u,m,b),m!==null&&(Ds(m,l,b),Ck(m,u,b)))}function kk(l,u,m){var b=Zs();zd(l,u,m,b)}function zd(l,u,m,b){var N={lane:b,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(Yp(l))Ak(u,N);else{var R=l.alternate;if(l.lanes===0&&(R===null||R.lanes===0)&&(R=u.lastRenderedReducer,R!==null))try{var W=u.lastRenderedState,ce=R(W,m);if(N.hasEagerState=!0,N.eagerState=ce,$s(ce,W))return Rp(l,u,N,0),pr===null&&Cp(),!1}catch{}finally{}if(m=Ny(l,u,N,b),m!==null)return Ds(m,l,b),Ck(m,u,b),!0}return!1}function lv(l,u,m,b){if(b={lane:2,revertLane:Uv(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},Yp(l)){if(u)throw Error(n(479))}else u=Ny(l,m,b,2),u!==null&&Ds(u,l,2)}function Yp(l){var u=l.alternate;return l===kt||u!==null&&u===kt}function Ak(l,u){Bu=Vp=!0;var m=l.pending;m===null?u.next=u:(u.next=m.next,m.next=u),l.pending=u}function Ck(l,u,m){if((m&4194048)!==0){var b=u.lanes;b&=l.pendingLanes,m|=b,u.lanes=m,kn(l,m)}}var Hd={readContext:Ln,use:$p,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useLayoutEffect:Pr,useInsertionEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useSyncExternalStore:Pr,useId:Pr,useHostTransitionStatus:Pr,useFormState:Pr,useActionState:Pr,useOptimistic:Pr,useMemoCache:Pr,useCacheRefresh:Pr};Hd.useEffectEvent=Pr;var Rk={readContext:Ln,use:$p,useCallback:function(l,u){return ys().memoizedState=[l,u===void 0?null:u],l},useContext:Ln,useEffect:hk,useImperativeHandle:function(l,u,m){m=m!=null?m.concat([l]):null,Kp(4194308,4,gk.bind(null,u,l),m)},useLayoutEffect:function(l,u){return Kp(4194308,4,l,u)},useInsertionEffect:function(l,u){Kp(4,2,l,u)},useMemo:function(l,u){var m=ys();u=u===void 0?null:u;var b=l();if(pc){Nn(!0);try{l()}finally{Nn(!1)}}return m.memoizedState=[b,u],b},useReducer:function(l,u,m){var b=ys();if(m!==void 0){var N=m(u);if(pc){Nn(!0);try{m(u)}finally{Nn(!1)}}}else N=u;return b.memoizedState=b.baseState=N,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:N},b.queue=l,l=l.dispatch=T9.bind(null,kt,l),[b.memoizedState,l]},useRef:function(l){var u=ys();return l={current:l},u.memoizedState=l},useState:function(l){l=tv(l);var u=l.queue,m=kk.bind(null,kt,u);return u.dispatch=m,[l.memoizedState,m]},useDebugValue:sv,useDeferredValue:function(l,u){var m=ys();return av(m,l,u)},useTransition:function(){var l=tv(!1);return l=_k.bind(null,kt,l.queue,!0,!1),ys().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,u,m){var b=kt,N=ys();if(Wt){if(m===void 0)throw Error(n(407));m=m()}else{if(m=u(),pr===null)throw Error(n(349));(Ht&127)!==0||JT(b,u,m)}N.memoizedState=m;var R={value:m,getSnapshot:u};return N.queue=R,hk(QT.bind(null,b,R,l),[l]),b.flags|=2048,zu(9,{destroy:void 0},ZT.bind(null,b,R,m,u),null),m},useId:function(){var l=ys(),u=pr.identifierPrefix;if(Wt){var m=yi,b=gi;m=(b&~(1<<32-or(b)-1)).toString(32)+m,u="_"+u+"R_"+m,m=qp++,0<m&&(u+="H"+m.toString(32)),u+="_"}else m=v9++,u="_"+u+"r_"+m.toString(32)+"_";return l.memoizedState=u},useHostTransitionStatus:ov,useFormState:lk,useActionState:lk,useOptimistic:function(l){var u=ys();u.memoizedState=u.baseState=l;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=m,u=lv.bind(null,kt,!0,m),m.dispatch=u,[l,u]},useMemoCache:Zy,useCacheRefresh:function(){return ys().memoizedState=N9.bind(null,kt)},useEffectEvent:function(l){var u=ys(),m={impl:l};return u.memoizedState=m,function(){if((Jt&2)!==0)throw Error(n(440));return m.impl.apply(void 0,arguments)}}},cv={readContext:Ln,use:$p,useCallback:vk,useContext:Ln,useEffect:nv,useImperativeHandle:yk,useInsertionEffect:mk,useLayoutEffect:xk,useMemo:bk,useReducer:Gp,useRef:dk,useState:function(){return Gp(Qi)},useDebugValue:sv,useDeferredValue:function(l,u){var m=Gr();return wk(m,lr.memoizedState,l,u)},useTransition:function(){var l=Gp(Qi)[0],u=Gr().memoizedState;return[typeof l=="boolean"?l:Ud(l),u]},useSyncExternalStore:YT,useId:Nk,useHostTransitionStatus:ov,useFormState:ck,useActionState:ck,useOptimistic:function(l,u){var m=Gr();return rk(m,lr,l,u)},useMemoCache:Zy,useCacheRefresh:Tk};cv.useEffectEvent=pk;var Ok={readContext:Ln,use:$p,useCallback:vk,useContext:Ln,useEffect:nv,useImperativeHandle:yk,useInsertionEffect:mk,useLayoutEffect:xk,useMemo:bk,useReducer:ev,useRef:dk,useState:function(){return ev(Qi)},useDebugValue:sv,useDeferredValue:function(l,u){var m=Gr();return lr===null?av(m,l,u):wk(m,lr.memoizedState,l,u)},useTransition:function(){var l=ev(Qi)[0],u=Gr().memoizedState;return[typeof l=="boolean"?l:Ud(l),u]},useSyncExternalStore:YT,useId:Nk,useHostTransitionStatus:ov,useFormState:fk,useActionState:fk,useOptimistic:function(l,u){var m=Gr();return lr!==null?rk(m,lr,l,u):(m.baseState=l,[l,m.queue.dispatch])},useMemoCache:Zy,useCacheRefresh:Tk};Ok.useEffectEvent=pk;function uv(l,u,m,b){u=l.memoizedState,m=m(b,u),m=m==null?u:p({},u,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var fv={enqueueSetState:function(l,u,m){l=l._reactInternals;var b=Zs(),N=Zo(b);N.payload=u,m!=null&&(N.callback=m),u=Qo(l,N,b),u!==null&&(Ds(u,l,b),Fd(u,l,b))},enqueueReplaceState:function(l,u,m){l=l._reactInternals;var b=Zs(),N=Zo(b);N.tag=1,N.payload=u,m!=null&&(N.callback=m),u=Qo(l,N,b),u!==null&&(Ds(u,l,b),Fd(u,l,b))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var m=Zs(),b=Zo(m);b.tag=2,u!=null&&(b.callback=u),u=Qo(l,b,m),u!==null&&(Ds(u,l,m),Fd(u,l,m))}};function jk(l,u,m,b,N,R,W){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(b,R,W):u.prototype&&u.prototype.isPureReactComponent?!Ad(m,b)||!Ad(N,R):!0}function Dk(l,u,m,b){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(m,b),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(m,b),u.state!==l&&fv.enqueueReplaceState(u,u.state,null)}function mc(l,u){var m=u;if("ref"in u){m={};for(var b in u)b!=="ref"&&(m[b]=u[b])}if(l=l.defaultProps){m===u&&(m=p({},m));for(var N in l)m[N]===void 0&&(m[N]=l[N])}return m}function Ik(l){Ap(l)}function Mk(l){console.error(l)}function Fk(l){Ap(l)}function Jp(l,u){try{var m=l.onUncaughtError;m(u.value,{componentStack:u.stack})}catch(b){setTimeout(function(){throw b})}}function Pk(l,u,m){try{var b=l.onCaughtError;b(m.value,{componentStack:m.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function dv(l,u,m){return m=Zo(m),m.tag=3,m.payload={element:null},m.callback=function(){Jp(l,u)},m}function Lk(l){return l=Zo(l),l.tag=3,l}function Bk(l,u,m,b){var N=m.type.getDerivedStateFromError;if(typeof N=="function"){var R=b.value;l.payload=function(){return N(R)},l.callback=function(){Pk(u,m,b)}}var W=m.stateNode;W!==null&&typeof W.componentDidCatch=="function"&&(l.callback=function(){Pk(u,m,b),typeof N!="function"&&(al===null?al=new Set([this]):al.add(this));var ce=b.stack;this.componentDidCatch(b.value,{componentStack:ce!==null?ce:""})})}function k9(l,u,m,b,N){if(m.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(u=m.alternate,u!==null&&Du(u,m,N,!0),m=Ks.current,m!==null){switch(m.tag){case 31:case 13:return wa===null?cm():m.alternate===null&&Lr===0&&(Lr=3),m.flags&=-257,m.flags|=65536,m.lanes=N,b===Lp?m.flags|=16384:(u=m.updateQueue,u===null?m.updateQueue=new Set([b]):u.add(b),Pv(l,b,N)),!1;case 22:return m.flags|=65536,b===Lp?m.flags|=16384:(u=m.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([b])},m.updateQueue=u):(m=u.retryQueue,m===null?u.retryQueue=new Set([b]):m.add(b)),Pv(l,b,N)),!1}throw Error(n(435,m.tag))}return Pv(l,b,N),cm(),!1}if(Wt)return u=Ks.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=N,b!==Oy&&(l=Error(n(422),{cause:b}),Od(ga(l,m)))):(b!==Oy&&(u=Error(n(423),{cause:b}),Od(ga(u,m))),l=l.current.alternate,l.flags|=65536,N&=-N,l.lanes|=N,b=ga(b,m),N=dv(l.stateNode,b,N),Hy(l,N),Lr!==4&&(Lr=2)),!1;var R=Error(n(520),{cause:b});if(R=ga(R,m),Yd===null?Yd=[R]:Yd.push(R),Lr!==4&&(Lr=2),u===null)return!0;b=ga(b,m),m=u;do{switch(m.tag){case 3:return m.flags|=65536,l=N&-N,m.lanes|=l,l=dv(m.stateNode,b,l),Hy(m,l),!1;case 1:if(u=m.type,R=m.stateNode,(m.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(al===null||!al.has(R))))return m.flags|=65536,N&=-N,m.lanes|=N,N=Lk(N),Bk(N,l,m,b),Hy(m,N),!1}m=m.return}while(m!==null);return!1}var hv=Error(n(461)),ln=!1;function Bn(l,u,m,b){u.child=l===null?VT(u,null,m,b):hc(u,l.child,m,b)}function Uk(l,u,m,b,N){m=m.render;var R=u.ref;if("ref"in b){var W={};for(var ce in b)ce!=="ref"&&(W[ce]=b[ce])}else W=b;return cc(u),b=Ky(l,u,m,W,R,N),ce=Xy(),l!==null&&!ln?(Yy(l,u,N),eo(l,u,N)):(Wt&&ce&&Cy(u),u.flags|=1,Bn(l,u,b,N),u.child)}function zk(l,u,m,b,N){if(l===null){var R=m.type;return typeof R=="function"&&!Ty(R)&&R.defaultProps===void 0&&m.compare===null?(u.tag=15,u.type=R,Hk(l,u,R,b,N)):(l=jp(m.type,null,b,u,u.mode,N),l.ref=u.ref,l.return=u,u.child=l)}if(R=l.child,!wv(l,N)){var W=R.memoizedProps;if(m=m.compare,m=m!==null?m:Ad,m(W,b)&&l.ref===u.ref)return eo(l,u,N)}return u.flags|=1,l=Ki(R,b),l.ref=u.ref,l.return=u,u.child=l}function Hk(l,u,m,b,N){if(l!==null){var R=l.memoizedProps;if(Ad(R,b)&&l.ref===u.ref)if(ln=!1,u.pendingProps=b=R,wv(l,N))(l.flags&131072)!==0&&(ln=!0);else return u.lanes=l.lanes,eo(l,u,N)}return pv(l,u,m,b,N)}function Vk(l,u,m,b){var N=b.children,R=l!==null?l.memoizedState:null;if(l===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((u.flags&128)!==0){if(R=R!==null?R.baseLanes|m:m,l!==null){for(b=u.child=l.child,N=0;b!==null;)N=N|b.lanes|b.childLanes,b=b.sibling;b=N&~R}else b=0,u.child=null;return qk(l,u,R,m,b)}if((m&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},l!==null&&Fp(u,R!==null?R.cachePool:null),R!==null?$T(u,R):qy(),GT(u);else return b=u.lanes=536870912,qk(l,u,R!==null?R.baseLanes|m:m,m,b)}else R!==null?(Fp(u,R.cachePool),$T(u,R),tl(),u.memoizedState=null):(l!==null&&Fp(u,null),qy(),tl());return Bn(l,u,N,m),u.child}function Vd(l,u){return l!==null&&l.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function qk(l,u,m,b,N){var R=Ly();return R=R===null?null:{parent:an._currentValue,pool:R},u.memoizedState={baseLanes:m,cachePool:R},l!==null&&Fp(u,null),qy(),GT(u),l!==null&&Du(l,u,b,!0),u.childLanes=N,null}function Zp(l,u){return u=em({mode:u.mode,children:u.children},l.mode),u.ref=l.ref,l.child=u,u.return=l,u}function Wk(l,u,m){return hc(u,l.child,null,m),l=Zp(u,u.pendingProps),l.flags|=2,Xs(u),u.memoizedState=null,l}function A9(l,u,m){var b=u.pendingProps,N=(u.flags&128)!==0;if(u.flags&=-129,l===null){if(Wt){if(b.mode==="hidden")return l=Zp(u,b),u.lanes=536870912,Vd(null,l);if($y(u),(l=wr)?(l=nC(l,ba),l=l!==null&&l.data==="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:Go!==null?{id:gi,overflow:yi}:null,retryLane:536870912,hydrationErrors:null},m=AT(l),m.return=u,u.child=m,Pn=u,wr=null)):l=null,l===null)throw Xo(u);return u.lanes=536870912,null}return Zp(u,b)}var R=l.memoizedState;if(R!==null){var W=R.dehydrated;if($y(u),N)if(u.flags&256)u.flags&=-257,u=Wk(l,u,m);else if(u.memoizedState!==null)u.child=l.child,u.flags|=128,u=null;else throw Error(n(558));else if(ln||Du(l,u,m,!1),N=(m&l.childLanes)!==0,ln||N){if(b=pr,b!==null&&(W=ts(b,m),W!==0&&W!==R.retryLane))throw R.retryLane=W,ac(l,W),Ds(b,l,W),hv;cm(),u=Wk(l,u,m)}else l=R.treeContext,wr=_a(W.nextSibling),Pn=u,Wt=!0,Ko=null,ba=!1,l!==null&&OT(u,l),u=Zp(u,b),u.flags|=4096;return u}return l=Ki(l.child,{mode:b.mode,children:b.children}),l.ref=u.ref,u.child=l,l.return=u,l}function Qp(l,u){var m=u.ref;if(m===null)l!==null&&l.ref!==null&&(u.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(n(284));(l===null||l.ref!==m)&&(u.flags|=4194816)}}function pv(l,u,m,b,N){return cc(u),m=Ky(l,u,m,b,void 0,N),b=Xy(),l!==null&&!ln?(Yy(l,u,N),eo(l,u,N)):(Wt&&b&&Cy(u),u.flags|=1,Bn(l,u,m,N),u.child)}function $k(l,u,m,b,N,R){return cc(u),u.updateQueue=null,m=XT(u,b,m,N),KT(l),b=Xy(),l!==null&&!ln?(Yy(l,u,R),eo(l,u,R)):(Wt&&b&&Cy(u),u.flags|=1,Bn(l,u,m,R),u.child)}function Gk(l,u,m,b,N){if(cc(u),u.stateNode===null){var R=Cu,W=m.contextType;typeof W=="object"&&W!==null&&(R=Ln(W)),R=new m(b,R),u.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,R.updater=fv,u.stateNode=R,R._reactInternals=u,R=u.stateNode,R.props=b,R.state=u.memoizedState,R.refs={},Uy(u),W=m.contextType,R.context=typeof W=="object"&&W!==null?Ln(W):Cu,R.state=u.memoizedState,W=m.getDerivedStateFromProps,typeof W=="function"&&(uv(u,m,W,b),R.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(W=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),W!==R.state&&fv.enqueueReplaceState(R,R.state,null),Ld(u,b,R,N),Pd(),R.state=u.memoizedState),typeof R.componentDidMount=="function"&&(u.flags|=4194308),b=!0}else if(l===null){R=u.stateNode;var ce=u.memoizedProps,ve=mc(m,ce);R.props=ve;var Te=R.context,Ue=m.contextType;W=Cu,typeof Ue=="object"&&Ue!==null&&(W=Ln(Ue));var Ve=m.getDerivedStateFromProps;Ue=typeof Ve=="function"||typeof R.getSnapshotBeforeUpdate=="function",ce=u.pendingProps!==ce,Ue||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(ce||Te!==W)&&Dk(u,R,b,W),Jo=!1;var Oe=u.memoizedState;R.state=Oe,Ld(u,b,R,N),Pd(),Te=u.memoizedState,ce||Oe!==Te||Jo?(typeof Ve=="function"&&(uv(u,m,Ve,b),Te=u.memoizedState),(ve=Jo||jk(u,m,ve,b,Oe,Te,W))?(Ue||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(u.flags|=4194308)):(typeof R.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=b,u.memoizedState=Te),R.props=b,R.state=Te,R.context=W,b=ve):(typeof R.componentDidMount=="function"&&(u.flags|=4194308),b=!1)}else{R=u.stateNode,zy(l,u),W=u.memoizedProps,Ue=mc(m,W),R.props=Ue,Ve=u.pendingProps,Oe=R.context,Te=m.contextType,ve=Cu,typeof Te=="object"&&Te!==null&&(ve=Ln(Te)),ce=m.getDerivedStateFromProps,(Te=typeof ce=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(W!==Ve||Oe!==ve)&&Dk(u,R,b,ve),Jo=!1,Oe=u.memoizedState,R.state=Oe,Ld(u,b,R,N),Pd();var Ie=u.memoizedState;W!==Ve||Oe!==Ie||Jo||l!==null&&l.dependencies!==null&&Ip(l.dependencies)?(typeof ce=="function"&&(uv(u,m,ce,b),Ie=u.memoizedState),(Ue=Jo||jk(u,m,Ue,b,Oe,Ie,ve)||l!==null&&l.dependencies!==null&&Ip(l.dependencies))?(Te||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(b,Ie,ve),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(b,Ie,ve)),typeof R.componentDidUpdate=="function"&&(u.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof R.componentDidUpdate!="function"||W===l.memoizedProps&&Oe===l.memoizedState||(u.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||W===l.memoizedProps&&Oe===l.memoizedState||(u.flags|=1024),u.memoizedProps=b,u.memoizedState=Ie),R.props=b,R.state=Ie,R.context=ve,b=Ue):(typeof R.componentDidUpdate!="function"||W===l.memoizedProps&&Oe===l.memoizedState||(u.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||W===l.memoizedProps&&Oe===l.memoizedState||(u.flags|=1024),b=!1)}return R=b,Qp(l,u),b=(u.flags&128)!==0,R||b?(R=u.stateNode,m=b&&typeof m.getDerivedStateFromError!="function"?null:R.render(),u.flags|=1,l!==null&&b?(u.child=hc(u,l.child,null,N),u.child=hc(u,null,m,N)):Bn(l,u,m,N),u.memoizedState=R.state,l=u.child):l=eo(l,u,N),l}function Kk(l,u,m,b){return oc(),u.flags|=256,Bn(l,u,m,b),u.child}var mv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xv(l){return{baseLanes:l,cachePool:PT()}}function gv(l,u,m){return l=l!==null?l.childLanes&~m:0,u&&(l|=Js),l}function Xk(l,u,m){var b=u.pendingProps,N=!1,R=(u.flags&128)!==0,W;if((W=R)||(W=l!==null&&l.memoizedState===null?!1:($r.current&2)!==0),W&&(N=!0,u.flags&=-129),W=(u.flags&32)!==0,u.flags&=-33,l===null){if(Wt){if(N?el(u):tl(),(l=wr)?(l=nC(l,ba),l=l!==null&&l.data!=="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:Go!==null?{id:gi,overflow:yi}:null,retryLane:536870912,hydrationErrors:null},m=AT(l),m.return=u,u.child=m,Pn=u,wr=null)):l=null,l===null)throw Xo(u);return Qv(l)?u.lanes=32:u.lanes=536870912,null}var ce=b.children;return b=b.fallback,N?(tl(),N=u.mode,ce=em({mode:"hidden",children:ce},N),b=ic(b,N,m,null),ce.return=u,b.return=u,ce.sibling=b,u.child=ce,b=u.child,b.memoizedState=xv(m),b.childLanes=gv(l,W,m),u.memoizedState=mv,Vd(null,b)):(el(u),yv(u,ce))}var ve=l.memoizedState;if(ve!==null&&(ce=ve.dehydrated,ce!==null)){if(R)u.flags&256?(el(u),u.flags&=-257,u=vv(l,u,m)):u.memoizedState!==null?(tl(),u.child=l.child,u.flags|=128,u=null):(tl(),ce=b.fallback,N=u.mode,b=em({mode:"visible",children:b.children},N),ce=ic(ce,N,m,null),ce.flags|=2,b.return=u,ce.return=u,b.sibling=ce,u.child=b,hc(u,l.child,null,m),b=u.child,b.memoizedState=xv(m),b.childLanes=gv(l,W,m),u.memoizedState=mv,u=Vd(null,b));else if(el(u),Qv(ce)){if(W=ce.nextSibling&&ce.nextSibling.dataset,W)var Te=W.dgst;W=Te,b=Error(n(419)),b.stack="",b.digest=W,Od({value:b,source:null,stack:null}),u=vv(l,u,m)}else if(ln||Du(l,u,m,!1),W=(m&l.childLanes)!==0,ln||W){if(W=pr,W!==null&&(b=ts(W,m),b!==0&&b!==ve.retryLane))throw ve.retryLane=b,ac(l,b),Ds(W,l,b),hv;Zv(ce)||cm(),u=vv(l,u,m)}else Zv(ce)?(u.flags|=192,u.child=l.child,u=null):(l=ve.treeContext,wr=_a(ce.nextSibling),Pn=u,Wt=!0,Ko=null,ba=!1,l!==null&&OT(u,l),u=yv(u,b.children),u.flags|=4096);return u}return N?(tl(),ce=b.fallback,N=u.mode,ve=l.child,Te=ve.sibling,b=Ki(ve,{mode:"hidden",children:b.children}),b.subtreeFlags=ve.subtreeFlags&65011712,Te!==null?ce=Ki(Te,ce):(ce=ic(ce,N,m,null),ce.flags|=2),ce.return=u,b.return=u,b.sibling=ce,u.child=b,Vd(null,b),b=u.child,ce=l.child.memoizedState,ce===null?ce=xv(m):(N=ce.cachePool,N!==null?(ve=an._currentValue,N=N.parent!==ve?{parent:ve,pool:ve}:N):N=PT(),ce={baseLanes:ce.baseLanes|m,cachePool:N}),b.memoizedState=ce,b.childLanes=gv(l,W,m),u.memoizedState=mv,Vd(l.child,b)):(el(u),m=l.child,l=m.sibling,m=Ki(m,{mode:"visible",children:b.children}),m.return=u,m.sibling=null,l!==null&&(W=u.deletions,W===null?(u.deletions=[l],u.flags|=16):W.push(l)),u.child=m,u.memoizedState=null,m)}function yv(l,u){return u=em({mode:"visible",children:u},l.mode),u.return=l,l.child=u}function em(l,u){return l=Gs(22,l,null,u),l.lanes=0,l}function vv(l,u,m){return hc(u,l.child,null,m),l=yv(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function Yk(l,u,m){l.lanes|=u;var b=l.alternate;b!==null&&(b.lanes|=u),Iy(l.return,u,m)}function bv(l,u,m,b,N,R){var W=l.memoizedState;W===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:N,treeForkCount:R}:(W.isBackwards=u,W.rendering=null,W.renderingStartTime=0,W.last=b,W.tail=m,W.tailMode=N,W.treeForkCount=R)}function Jk(l,u,m){var b=u.pendingProps,N=b.revealOrder,R=b.tail;b=b.children;var W=$r.current,ce=(W&2)!==0;if(ce?(W=W&1|2,u.flags|=128):W&=1,q($r,W),Bn(l,u,b,m),b=Wt?Rd:0,!ce&&l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Yk(l,m,u);else if(l.tag===19)Yk(l,m,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(N){case"forwards":for(m=u.child,N=null;m!==null;)l=m.alternate,l!==null&&Hp(l)===null&&(N=m),m=m.sibling;m=N,m===null?(N=u.child,u.child=null):(N=m.sibling,m.sibling=null),bv(u,!1,N,m,R,b);break;case"backwards":case"unstable_legacy-backwards":for(m=null,N=u.child,u.child=null;N!==null;){if(l=N.alternate,l!==null&&Hp(l)===null){u.child=N;break}l=N.sibling,N.sibling=m,m=N,N=l}bv(u,!0,m,null,R,b);break;case"together":bv(u,!1,null,null,void 0,b);break;default:u.memoizedState=null}return u.child}function eo(l,u,m){if(l!==null&&(u.dependencies=l.dependencies),sl|=u.lanes,(m&u.childLanes)===0)if(l!==null){if(Du(l,u,m,!1),(m&u.childLanes)===0)return null}else return null;if(l!==null&&u.child!==l.child)throw Error(n(153));if(u.child!==null){for(l=u.child,m=Ki(l,l.pendingProps),u.child=m,m.return=u;l.sibling!==null;)l=l.sibling,m=m.sibling=Ki(l,l.pendingProps),m.return=u;m.sibling=null}return u.child}function wv(l,u){return(l.lanes&u)!==0?!0:(l=l.dependencies,!!(l!==null&&Ip(l)))}function C9(l,u,m){switch(u.tag){case 3:I(u,u.stateNode.containerInfo),Yo(u,an,l.memoizedState.cache),oc();break;case 27:case 5:Q(u);break;case 4:I(u,u.stateNode.containerInfo);break;case 10:Yo(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,$y(u),null;break;case 13:var b=u.memoizedState;if(b!==null)return b.dehydrated!==null?(el(u),u.flags|=128,null):(m&u.child.childLanes)!==0?Xk(l,u,m):(el(u),l=eo(l,u,m),l!==null?l.sibling:null);el(u);break;case 19:var N=(l.flags&128)!==0;if(b=(m&u.childLanes)!==0,b||(Du(l,u,m,!1),b=(m&u.childLanes)!==0),N){if(b)return Jk(l,u,m);u.flags|=128}if(N=u.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),q($r,$r.current),b)break;return null;case 22:return u.lanes=0,Vk(l,u,m,u.pendingProps);case 24:Yo(u,an,l.memoizedState.cache)}return eo(l,u,m)}function Zk(l,u,m){if(l!==null)if(l.memoizedProps!==u.pendingProps)ln=!0;else{if(!wv(l,m)&&(u.flags&128)===0)return ln=!1,C9(l,u,m);ln=(l.flags&131072)!==0}else ln=!1,Wt&&(u.flags&1048576)!==0&&RT(u,Rd,u.index);switch(u.lanes=0,u.tag){case 16:e:{var b=u.pendingProps;if(l=fc(u.elementType),u.type=l,typeof l=="function")Ty(l)?(b=mc(l,b),u.tag=1,u=Gk(null,u,l,b,m)):(u.tag=0,u=pv(null,u,l,b,m));else{if(l!=null){var N=l.$$typeof;if(N===T){u.tag=11,u=Uk(null,u,l,b,m);break e}else if(N===O){u.tag=14,u=zk(null,u,l,b,m);break e}}throw u=P(l)||l,Error(n(306,u,""))}}return u;case 0:return pv(l,u,u.type,u.pendingProps,m);case 1:return b=u.type,N=mc(b,u.pendingProps),Gk(l,u,b,N,m);case 3:e:{if(I(u,u.stateNode.containerInfo),l===null)throw Error(n(387));b=u.pendingProps;var R=u.memoizedState;N=R.element,zy(l,u),Ld(u,b,null,m);var W=u.memoizedState;if(b=W.cache,Yo(u,an,b),b!==R.cache&&My(u,[an],m,!0),Pd(),b=W.element,R.isDehydrated)if(R={element:b,isDehydrated:!1,cache:W.cache},u.updateQueue.baseState=R,u.memoizedState=R,u.flags&256){u=Kk(l,u,b,m);break e}else if(b!==N){N=ga(Error(n(424)),u),Od(N),u=Kk(l,u,b,m);break e}else{switch(l=u.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(wr=_a(l.firstChild),Pn=u,Wt=!0,Ko=null,ba=!0,m=VT(u,null,b,m),u.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(oc(),b===N){u=eo(l,u,m);break e}Bn(l,u,b,m)}u=u.child}return u;case 26:return Qp(l,u),l===null?(m=cC(u.type,null,u.pendingProps,null))?u.memoizedState=m:Wt||(m=u.type,l=u.pendingProps,b=xm(re.current).createElement(m),b[de]=u,b[pe]=l,Un(b,m,l),ct(b),u.stateNode=b):u.memoizedState=cC(u.type,l.memoizedProps,u.pendingProps,l.memoizedState),null;case 27:return Q(u),l===null&&Wt&&(b=u.stateNode=iC(u.type,u.pendingProps,re.current),Pn=u,ba=!0,N=wr,cl(u.type)?(eb=N,wr=_a(b.firstChild)):wr=N),Bn(l,u,u.pendingProps.children,m),Qp(l,u),l===null&&(u.flags|=4194304),u.child;case 5:return l===null&&Wt&&((N=b=wr)&&(b=a7(b,u.type,u.pendingProps,ba),b!==null?(u.stateNode=b,Pn=u,wr=_a(b.firstChild),ba=!1,N=!0):N=!1),N||Xo(u)),Q(u),N=u.type,R=u.pendingProps,W=l!==null?l.memoizedProps:null,b=R.children,Xv(N,R)?b=null:W!==null&&Xv(N,W)&&(u.flags|=32),u.memoizedState!==null&&(N=Ky(l,u,b9,null,null,m),sh._currentValue=N),Qp(l,u),Bn(l,u,b,m),u.child;case 6:return l===null&&Wt&&((l=m=wr)&&(m=i7(m,u.pendingProps,ba),m!==null?(u.stateNode=m,Pn=u,wr=null,l=!0):l=!1),l||Xo(u)),null;case 13:return Xk(l,u,m);case 4:return I(u,u.stateNode.containerInfo),b=u.pendingProps,l===null?u.child=hc(u,null,b,m):Bn(l,u,b,m),u.child;case 11:return Uk(l,u,u.type,u.pendingProps,m);case 7:return Bn(l,u,u.pendingProps,m),u.child;case 8:return Bn(l,u,u.pendingProps.children,m),u.child;case 12:return Bn(l,u,u.pendingProps.children,m),u.child;case 10:return b=u.pendingProps,Yo(u,u.type,b.value),Bn(l,u,b.children,m),u.child;case 9:return N=u.type._context,b=u.pendingProps.children,cc(u),N=Ln(N),b=b(N),u.flags|=1,Bn(l,u,b,m),u.child;case 14:return zk(l,u,u.type,u.pendingProps,m);case 15:return Hk(l,u,u.type,u.pendingProps,m);case 19:return Jk(l,u,m);case 31:return A9(l,u,m);case 22:return Vk(l,u,m,u.pendingProps);case 24:return cc(u),b=Ln(an),l===null?(N=Ly(),N===null&&(N=pr,R=Fy(),N.pooledCache=R,R.refCount++,R!==null&&(N.pooledCacheLanes|=m),N=R),u.memoizedState={parent:b,cache:N},Uy(u),Yo(u,an,N)):((l.lanes&m)!==0&&(zy(l,u),Ld(u,null,null,m),Pd()),N=l.memoizedState,R=u.memoizedState,N.parent!==b?(N={parent:b,cache:b},u.memoizedState=N,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=N),Yo(u,an,b)):(b=R.cache,Yo(u,an,b),b!==N.cache&&My(u,[an],m,!0))),Bn(l,u,u.pendingProps.children,m),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function to(l){l.flags|=4}function _v(l,u,m,b,N){if((u=(l.mode&32)!==0)&&(u=!1),u){if(l.flags|=16777216,(N&335544128)===N)if(l.stateNode.complete)l.flags|=8192;else if(NA())l.flags|=8192;else throw dc=Lp,By}else l.flags&=-16777217}function Qk(l,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!pC(u))if(NA())l.flags|=8192;else throw dc=Lp,By}function tm(l,u){u!==null&&(l.flags|=4),l.flags&16384&&(u=l.tag!==22?Tn():536870912,l.lanes|=u,Wu|=u)}function qd(l,u){if(!Wt)switch(l.tailMode){case"hidden":u=l.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:b.sibling=null}}function _r(l){var u=l.alternate!==null&&l.alternate.child===l.child,m=0,b=0;if(u)for(var N=l.child;N!==null;)m|=N.lanes|N.childLanes,b|=N.subtreeFlags&65011712,b|=N.flags&65011712,N.return=l,N=N.sibling;else for(N=l.child;N!==null;)m|=N.lanes|N.childLanes,b|=N.subtreeFlags,b|=N.flags,N.return=l,N=N.sibling;return l.subtreeFlags|=b,l.childLanes=m,u}function R9(l,u,m){var b=u.pendingProps;switch(Ry(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _r(u),null;case 1:return _r(u),null;case 3:return m=u.stateNode,b=null,l!==null&&(b=l.memoizedState.cache),u.memoizedState.cache!==b&&(u.flags|=2048),Ji(an),se(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(l===null||l.child===null)&&(ju(u)?to(u):l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,jy())),_r(u),null;case 26:var N=u.type,R=u.memoizedState;return l===null?(to(u),R!==null?(_r(u),Qk(u,R)):(_r(u),_v(u,N,null,b,m))):R?R!==l.memoizedState?(to(u),_r(u),Qk(u,R)):(_r(u),u.flags&=-16777217):(l=l.memoizedProps,l!==b&&to(u),_r(u),_v(u,N,l,b,m)),null;case 27:if(Y(u),m=re.current,N=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==b&&to(u);else{if(!b){if(u.stateNode===null)throw Error(n(166));return _r(u),null}l=G.current,ju(u)?jT(u):(l=iC(N,b,m),u.stateNode=l,to(u))}return _r(u),null;case 5:if(Y(u),N=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==b&&to(u);else{if(!b){if(u.stateNode===null)throw Error(n(166));return _r(u),null}if(R=G.current,ju(u))jT(u);else{var W=xm(re.current);switch(R){case 1:R=W.createElementNS("http://www.w3.org/2000/svg",N);break;case 2:R=W.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;default:switch(N){case"svg":R=W.createElementNS("http://www.w3.org/2000/svg",N);break;case"math":R=W.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;case"script":R=W.createElement("div"),R.innerHTML="<script><\/script>",R=R.removeChild(R.firstChild);break;case"select":R=typeof b.is=="string"?W.createElement("select",{is:b.is}):W.createElement("select"),b.multiple?R.multiple=!0:b.size&&(R.size=b.size);break;default:R=typeof b.is=="string"?W.createElement(N,{is:b.is}):W.createElement(N)}}R[de]=u,R[pe]=b;e:for(W=u.child;W!==null;){if(W.tag===5||W.tag===6)R.appendChild(W.stateNode);else if(W.tag!==4&&W.tag!==27&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===u)break e;for(;W.sibling===null;){if(W.return===null||W.return===u)break e;W=W.return}W.sibling.return=W.return,W=W.sibling}u.stateNode=R;e:switch(Un(R,N,b),N){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}b&&to(u)}}return _r(u),_v(u,u.type,l===null?null:l.memoizedProps,u.pendingProps,m),null;case 6:if(l&&u.stateNode!=null)l.memoizedProps!==b&&to(u);else{if(typeof b!="string"&&u.stateNode===null)throw Error(n(166));if(l=re.current,ju(u)){if(l=u.stateNode,m=u.memoizedProps,b=null,N=Pn,N!==null)switch(N.tag){case 27:case 5:b=N.memoizedProps}l[de]=u,l=!!(l.nodeValue===m||b!==null&&b.suppressHydrationWarning===!0||XA(l.nodeValue,m)),l||Xo(u,!0)}else l=xm(l).createTextNode(b),l[de]=u,u.stateNode=l}return _r(u),null;case 31:if(m=u.memoizedState,l===null||l.memoizedState!==null){if(b=ju(u),m!==null){if(l===null){if(!b)throw Error(n(318));if(l=u.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(557));l[de]=u}else oc(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;_r(u),l=!1}else m=jy(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=m),l=!0;if(!l)return u.flags&256?(Xs(u),u):(Xs(u),null);if((u.flags&128)!==0)throw Error(n(558))}return _r(u),null;case 13:if(b=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(N=ju(u),b!==null&&b.dehydrated!==null){if(l===null){if(!N)throw Error(n(318));if(N=u.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(n(317));N[de]=u}else oc(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;_r(u),N=!1}else N=jy(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=N),N=!0;if(!N)return u.flags&256?(Xs(u),u):(Xs(u),null)}return Xs(u),(u.flags&128)!==0?(u.lanes=m,u):(m=b!==null,l=l!==null&&l.memoizedState!==null,m&&(b=u.child,N=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(N=b.alternate.memoizedState.cachePool.pool),R=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(R=b.memoizedState.cachePool.pool),R!==N&&(b.flags|=2048)),m!==l&&m&&(u.child.flags|=8192),tm(u,u.updateQueue),_r(u),null);case 4:return se(),l===null&&qv(u.stateNode.containerInfo),_r(u),null;case 10:return Ji(u.type),_r(u),null;case 19:if(M($r),b=u.memoizedState,b===null)return _r(u),null;if(N=(u.flags&128)!==0,R=b.rendering,R===null)if(N)qd(b,!1);else{if(Lr!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(R=Hp(l),R!==null){for(u.flags|=128,qd(b,!1),l=R.updateQueue,u.updateQueue=l,tm(u,l),u.subtreeFlags=0,l=m,m=u.child;m!==null;)kT(m,l),m=m.sibling;return q($r,$r.current&1|2),Wt&&Xi(u,b.treeForkCount),u.child}l=l.sibling}b.tail!==null&&De()>im&&(u.flags|=128,N=!0,qd(b,!1),u.lanes=4194304)}else{if(!N)if(l=Hp(R),l!==null){if(u.flags|=128,N=!0,l=l.updateQueue,u.updateQueue=l,tm(u,l),qd(b,!0),b.tail===null&&b.tailMode==="hidden"&&!R.alternate&&!Wt)return _r(u),null}else 2*De()-b.renderingStartTime>im&&m!==536870912&&(u.flags|=128,N=!0,qd(b,!1),u.lanes=4194304);b.isBackwards?(R.sibling=u.child,u.child=R):(l=b.last,l!==null?l.sibling=R:u.child=R,b.last=R)}return b.tail!==null?(l=b.tail,b.rendering=l,b.tail=l.sibling,b.renderingStartTime=De(),l.sibling=null,m=$r.current,q($r,N?m&1|2:m&1),Wt&&Xi(u,b.treeForkCount),l):(_r(u),null);case 22:case 23:return Xs(u),Wy(),b=u.memoizedState!==null,l!==null?l.memoizedState!==null!==b&&(u.flags|=8192):b&&(u.flags|=8192),b?(m&536870912)!==0&&(u.flags&128)===0&&(_r(u),u.subtreeFlags&6&&(u.flags|=8192)):_r(u),m=u.updateQueue,m!==null&&tm(u,m.retryQueue),m=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),b=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),b!==m&&(u.flags|=2048),l!==null&&M(uc),null;case 24:return m=null,l!==null&&(m=l.memoizedState.cache),u.memoizedState.cache!==m&&(u.flags|=2048),Ji(an),_r(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function O9(l,u){switch(Ry(u),u.tag){case 1:return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return Ji(an),se(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 26:case 27:case 5:return Y(u),null;case 31:if(u.memoizedState!==null){if(Xs(u),u.alternate===null)throw Error(n(340));oc()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 13:if(Xs(u),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(n(340));oc()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return M($r),null;case 4:return se(),null;case 10:return Ji(u.type),null;case 22:case 23:return Xs(u),Wy(),l!==null&&M(uc),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 24:return Ji(an),null;case 25:return null;default:return null}}function eA(l,u){switch(Ry(u),u.tag){case 3:Ji(an),se();break;case 26:case 27:case 5:Y(u);break;case 4:se();break;case 31:u.memoizedState!==null&&Xs(u);break;case 13:Xs(u);break;case 19:M($r);break;case 10:Ji(u.type);break;case 22:case 23:Xs(u),Wy(),l!==null&&M(uc);break;case 24:Ji(an)}}function Wd(l,u){try{var m=u.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var N=b.next;m=N;do{if((m.tag&l)===l){b=void 0;var R=m.create,W=m.inst;b=R(),W.destroy=b}m=m.next}while(m!==N)}}catch(ce){er(u,u.return,ce)}}function rl(l,u,m){try{var b=u.updateQueue,N=b!==null?b.lastEffect:null;if(N!==null){var R=N.next;b=R;do{if((b.tag&l)===l){var W=b.inst,ce=W.destroy;if(ce!==void 0){W.destroy=void 0,N=u;var ve=m,Te=ce;try{Te()}catch(Ue){er(N,ve,Ue)}}}b=b.next}while(b!==R)}}catch(Ue){er(u,u.return,Ue)}}function tA(l){var u=l.updateQueue;if(u!==null){var m=l.stateNode;try{WT(u,m)}catch(b){er(l,l.return,b)}}}function rA(l,u,m){m.props=mc(l.type,l.memoizedProps),m.state=l.memoizedState;try{m.componentWillUnmount()}catch(b){er(l,u,b)}}function $d(l,u){try{var m=l.ref;if(m!==null){switch(l.tag){case 26:case 27:case 5:var b=l.stateNode;break;case 30:b=l.stateNode;break;default:b=l.stateNode}typeof m=="function"?l.refCleanup=m(b):m.current=b}}catch(N){er(l,u,N)}}function vi(l,u){var m=l.ref,b=l.refCleanup;if(m!==null)if(typeof b=="function")try{b()}catch(N){er(l,u,N)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(N){er(l,u,N)}else m.current=null}function nA(l){var u=l.type,m=l.memoizedProps,b=l.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":m.autoFocus&&b.focus();break e;case"img":m.src?b.src=m.src:m.srcSet&&(b.srcset=m.srcSet)}}catch(N){er(l,l.return,N)}}function Ev(l,u,m){try{var b=l.stateNode;Q9(b,l.type,m,u),b[pe]=u}catch(N){er(l,l.return,N)}}function sA(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&cl(l.type)||l.tag===4}function Sv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||sA(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&cl(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Nv(l,u,m){var b=l.tag;if(b===5||b===6)l=l.stateNode,u?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(l,u):(u=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,u.appendChild(l),m=m._reactRootContainer,m!=null||u.onclick!==null||(u.onclick=$i));else if(b!==4&&(b===27&&cl(l.type)&&(m=l.stateNode,u=null),l=l.child,l!==null))for(Nv(l,u,m),l=l.sibling;l!==null;)Nv(l,u,m),l=l.sibling}function rm(l,u,m){var b=l.tag;if(b===5||b===6)l=l.stateNode,u?m.insertBefore(l,u):m.appendChild(l);else if(b!==4&&(b===27&&cl(l.type)&&(m=l.stateNode),l=l.child,l!==null))for(rm(l,u,m),l=l.sibling;l!==null;)rm(l,u,m),l=l.sibling}function aA(l){var u=l.stateNode,m=l.memoizedProps;try{for(var b=l.type,N=u.attributes;N.length;)u.removeAttributeNode(N[0]);Un(u,b,m),u[de]=l,u[pe]=m}catch(R){er(l,l.return,R)}}var ro=!1,cn=!1,Tv=!1,iA=typeof WeakSet=="function"?WeakSet:Set,An=null;function j9(l,u){if(l=l.containerInfo,Gv=Em,l=yT(l),vy(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var N=b.anchorOffset,R=b.focusNode;b=b.focusOffset;try{m.nodeType,R.nodeType}catch{m=null;break e}var W=0,ce=-1,ve=-1,Te=0,Ue=0,Ve=l,Oe=null;t:for(;;){for(var Ie;Ve!==m||N!==0&&Ve.nodeType!==3||(ce=W+N),Ve!==R||b!==0&&Ve.nodeType!==3||(ve=W+b),Ve.nodeType===3&&(W+=Ve.nodeValue.length),(Ie=Ve.firstChild)!==null;)Oe=Ve,Ve=Ie;for(;;){if(Ve===l)break t;if(Oe===m&&++Te===N&&(ce=W),Oe===R&&++Ue===b&&(ve=W),(Ie=Ve.nextSibling)!==null)break;Ve=Oe,Oe=Ve.parentNode}Ve=Ie}m=ce===-1||ve===-1?null:{start:ce,end:ve}}else m=null}m=m||{start:0,end:0}}else m=null;for(Kv={focusedElem:l,selectionRange:m},Em=!1,An=u;An!==null;)if(u=An,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,An=l;else for(;An!==null;){switch(u=An,R=u.alternate,l=u.flags,u.tag){case 0:if((l&4)!==0&&(l=u.updateQueue,l=l!==null?l.events:null,l!==null))for(m=0;m<l.length;m++)N=l[m],N.ref.impl=N.nextImpl;break;case 11:case 15:break;case 1:if((l&1024)!==0&&R!==null){l=void 0,m=u,N=R.memoizedProps,R=R.memoizedState,b=m.stateNode;try{var ot=mc(m.type,N);l=b.getSnapshotBeforeUpdate(ot,R),b.__reactInternalSnapshotBeforeUpdate=l}catch(gt){er(m,m.return,gt)}}break;case 3:if((l&1024)!==0){if(l=u.stateNode.containerInfo,m=l.nodeType,m===9)Jv(l);else if(m===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":Jv(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=u.sibling,l!==null){l.return=u.return,An=l;break}An=u.return}}function oA(l,u,m){var b=m.flags;switch(m.tag){case 0:case 11:case 15:so(l,m),b&4&&Wd(5,m);break;case 1:if(so(l,m),b&4)if(l=m.stateNode,u===null)try{l.componentDidMount()}catch(W){er(m,m.return,W)}else{var N=mc(m.type,u.memoizedProps);u=u.memoizedState;try{l.componentDidUpdate(N,u,l.__reactInternalSnapshotBeforeUpdate)}catch(W){er(m,m.return,W)}}b&64&&tA(m),b&512&&$d(m,m.return);break;case 3:if(so(l,m),b&64&&(l=m.updateQueue,l!==null)){if(u=null,m.child!==null)switch(m.child.tag){case 27:case 5:u=m.child.stateNode;break;case 1:u=m.child.stateNode}try{WT(l,u)}catch(W){er(m,m.return,W)}}break;case 27:u===null&&b&4&&aA(m);case 26:case 5:so(l,m),u===null&&b&4&&nA(m),b&512&&$d(m,m.return);break;case 12:so(l,m);break;case 31:so(l,m),b&4&&uA(l,m);break;case 13:so(l,m),b&4&&fA(l,m),b&64&&(l=m.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(m=z9.bind(null,m),o7(l,m))));break;case 22:if(b=m.memoizedState!==null||ro,!b){u=u!==null&&u.memoizedState!==null||cn,N=ro;var R=cn;ro=b,(cn=u)&&!R?ao(l,m,(m.subtreeFlags&8772)!==0):so(l,m),ro=N,cn=R}break;case 30:break;default:so(l,m)}}function lA(l){var u=l.alternate;u!==null&&(l.alternate=null,lA(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&Xe(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var Rr=null,Cs=!1;function no(l,u,m){for(m=m.child;m!==null;)cA(l,u,m),m=m.sibling}function cA(l,u,m){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(vt,m)}catch{}switch(m.tag){case 26:cn||vi(m,u),no(l,u,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:cn||vi(m,u);var b=Rr,N=Cs;cl(m.type)&&(Rr=m.stateNode,Cs=!1),no(l,u,m),th(m.stateNode),Rr=b,Cs=N;break;case 5:cn||vi(m,u);case 6:if(b=Rr,N=Cs,Rr=null,no(l,u,m),Rr=b,Cs=N,Rr!==null)if(Cs)try{(Rr.nodeType===9?Rr.body:Rr.nodeName==="HTML"?Rr.ownerDocument.body:Rr).removeChild(m.stateNode)}catch(R){er(m,u,R)}else try{Rr.removeChild(m.stateNode)}catch(R){er(m,u,R)}break;case 18:Rr!==null&&(Cs?(l=Rr,tC(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,m.stateNode),Qu(l)):tC(Rr,m.stateNode));break;case 4:b=Rr,N=Cs,Rr=m.stateNode.containerInfo,Cs=!0,no(l,u,m),Rr=b,Cs=N;break;case 0:case 11:case 14:case 15:rl(2,m,u),cn||rl(4,m,u),no(l,u,m);break;case 1:cn||(vi(m,u),b=m.stateNode,typeof b.componentWillUnmount=="function"&&rA(m,u,b)),no(l,u,m);break;case 21:no(l,u,m);break;case 22:cn=(b=cn)||m.memoizedState!==null,no(l,u,m),cn=b;break;default:no(l,u,m)}}function uA(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{Qu(l)}catch(m){er(u,u.return,m)}}}function fA(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{Qu(l)}catch(m){er(u,u.return,m)}}function D9(l){switch(l.tag){case 31:case 13:case 19:var u=l.stateNode;return u===null&&(u=l.stateNode=new iA),u;case 22:return l=l.stateNode,u=l._retryCache,u===null&&(u=l._retryCache=new iA),u;default:throw Error(n(435,l.tag))}}function nm(l,u){var m=D9(l);u.forEach(function(b){if(!m.has(b)){m.add(b);var N=H9.bind(null,l,b);b.then(N,N)}})}function Rs(l,u){var m=u.deletions;if(m!==null)for(var b=0;b<m.length;b++){var N=m[b],R=l,W=u,ce=W;e:for(;ce!==null;){switch(ce.tag){case 27:if(cl(ce.type)){Rr=ce.stateNode,Cs=!1;break e}break;case 5:Rr=ce.stateNode,Cs=!1;break e;case 3:case 4:Rr=ce.stateNode.containerInfo,Cs=!0;break e}ce=ce.return}if(Rr===null)throw Error(n(160));cA(R,W,N),Rr=null,Cs=!1,R=N.alternate,R!==null&&(R.return=null),N.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)dA(u,l),u=u.sibling}var Ya=null;function dA(l,u){var m=l.alternate,b=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:Rs(u,l),Os(l),b&4&&(rl(3,l,l.return),Wd(3,l),rl(5,l,l.return));break;case 1:Rs(u,l),Os(l),b&512&&(cn||m===null||vi(m,m.return)),b&64&&ro&&(l=l.updateQueue,l!==null&&(b=l.callbacks,b!==null&&(m=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=m===null?b:m.concat(b))));break;case 26:var N=Ya;if(Rs(u,l),Os(l),b&512&&(cn||m===null||vi(m,m.return)),b&4){var R=m!==null?m.memoizedState:null;if(b=l.memoizedState,m===null)if(b===null)if(l.stateNode===null){e:{b=l.type,m=l.memoizedProps,N=N.ownerDocument||N;t:switch(b){case"title":R=N.getElementsByTagName("title")[0],(!R||R[je]||R[de]||R.namespaceURI==="http://www.w3.org/2000/svg"||R.hasAttribute("itemprop"))&&(R=N.createElement(b),N.head.insertBefore(R,N.querySelector("head > title"))),Un(R,b,m),R[de]=l,ct(R),b=R;break e;case"link":var W=dC("link","href",N).get(b+(m.href||""));if(W){for(var ce=0;ce<W.length;ce++)if(R=W[ce],R.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&R.getAttribute("rel")===(m.rel==null?null:m.rel)&&R.getAttribute("title")===(m.title==null?null:m.title)&&R.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){W.splice(ce,1);break t}}R=N.createElement(b),Un(R,b,m),N.head.appendChild(R);break;case"meta":if(W=dC("meta","content",N).get(b+(m.content||""))){for(ce=0;ce<W.length;ce++)if(R=W[ce],R.getAttribute("content")===(m.content==null?null:""+m.content)&&R.getAttribute("name")===(m.name==null?null:m.name)&&R.getAttribute("property")===(m.property==null?null:m.property)&&R.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&R.getAttribute("charset")===(m.charSet==null?null:m.charSet)){W.splice(ce,1);break t}}R=N.createElement(b),Un(R,b,m),N.head.appendChild(R);break;default:throw Error(n(468,b))}R[de]=l,ct(R),b=R}l.stateNode=b}else hC(N,l.type,l.stateNode);else l.stateNode=fC(N,b,l.memoizedProps);else R!==b?(R===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):R.count--,b===null?hC(N,l.type,l.stateNode):fC(N,b,l.memoizedProps)):b===null&&l.stateNode!==null&&Ev(l,l.memoizedProps,m.memoizedProps)}break;case 27:Rs(u,l),Os(l),b&512&&(cn||m===null||vi(m,m.return)),m!==null&&b&4&&Ev(l,l.memoizedProps,m.memoizedProps);break;case 5:if(Rs(u,l),Os(l),b&512&&(cn||m===null||vi(m,m.return)),l.flags&32){N=l.stateNode;try{_u(N,"")}catch(ot){er(l,l.return,ot)}}b&4&&l.stateNode!=null&&(N=l.memoizedProps,Ev(l,N,m!==null?m.memoizedProps:N)),b&1024&&(Tv=!0);break;case 6:if(Rs(u,l),Os(l),b&4){if(l.stateNode===null)throw Error(n(162));b=l.memoizedProps,m=l.stateNode;try{m.nodeValue=b}catch(ot){er(l,l.return,ot)}}break;case 3:if(vm=null,N=Ya,Ya=gm(u.containerInfo),Rs(u,l),Ya=N,Os(l),b&4&&m!==null&&m.memoizedState.isDehydrated)try{Qu(u.containerInfo)}catch(ot){er(l,l.return,ot)}Tv&&(Tv=!1,hA(l));break;case 4:b=Ya,Ya=gm(l.stateNode.containerInfo),Rs(u,l),Os(l),Ya=b;break;case 12:Rs(u,l),Os(l);break;case 31:Rs(u,l),Os(l),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,nm(l,b)));break;case 13:Rs(u,l),Os(l),l.child.flags&8192&&l.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(am=De()),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,nm(l,b)));break;case 22:N=l.memoizedState!==null;var ve=m!==null&&m.memoizedState!==null,Te=ro,Ue=cn;if(ro=Te||N,cn=Ue||ve,Rs(u,l),cn=Ue,ro=Te,Os(l),b&8192)e:for(u=l.stateNode,u._visibility=N?u._visibility&-2:u._visibility|1,N&&(m===null||ve||ro||cn||xc(l)),m=null,u=l;;){if(u.tag===5||u.tag===26){if(m===null){ve=m=u;try{if(R=ve.stateNode,N)W=R.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none";else{ce=ve.stateNode;var Ve=ve.memoizedProps.style,Oe=Ve!=null&&Ve.hasOwnProperty("display")?Ve.display:null;ce.style.display=Oe==null||typeof Oe=="boolean"?"":(""+Oe).trim()}}catch(ot){er(ve,ve.return,ot)}}}else if(u.tag===6){if(m===null){ve=u;try{ve.stateNode.nodeValue=N?"":ve.memoizedProps}catch(ot){er(ve,ve.return,ot)}}}else if(u.tag===18){if(m===null){ve=u;try{var Ie=ve.stateNode;N?rC(Ie,!0):rC(ve.stateNode,!1)}catch(ot){er(ve,ve.return,ot)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===l)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;m===u&&(m=null),u=u.return}m===u&&(m=null),u.sibling.return=u.return,u=u.sibling}b&4&&(b=l.updateQueue,b!==null&&(m=b.retryQueue,m!==null&&(b.retryQueue=null,nm(l,m))));break;case 19:Rs(u,l),Os(l),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,nm(l,b)));break;case 30:break;case 21:break;default:Rs(u,l),Os(l)}}function Os(l){var u=l.flags;if(u&2){try{for(var m,b=l.return;b!==null;){if(sA(b)){m=b;break}b=b.return}if(m==null)throw Error(n(160));switch(m.tag){case 27:var N=m.stateNode,R=Sv(l);rm(l,R,N);break;case 5:var W=m.stateNode;m.flags&32&&(_u(W,""),m.flags&=-33);var ce=Sv(l);rm(l,ce,W);break;case 3:case 4:var ve=m.stateNode.containerInfo,Te=Sv(l);Nv(l,Te,ve);break;default:throw Error(n(161))}}catch(Ue){er(l,l.return,Ue)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function hA(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var u=l;hA(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),l=l.sibling}}function so(l,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)oA(l,u.alternate,u),u=u.sibling}function xc(l){for(l=l.child;l!==null;){var u=l;switch(u.tag){case 0:case 11:case 14:case 15:rl(4,u,u.return),xc(u);break;case 1:vi(u,u.return);var m=u.stateNode;typeof m.componentWillUnmount=="function"&&rA(u,u.return,m),xc(u);break;case 27:th(u.stateNode);case 26:case 5:vi(u,u.return),xc(u);break;case 22:u.memoizedState===null&&xc(u);break;case 30:xc(u);break;default:xc(u)}l=l.sibling}}function ao(l,u,m){for(m=m&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var b=u.alternate,N=l,R=u,W=R.flags;switch(R.tag){case 0:case 11:case 15:ao(N,R,m),Wd(4,R);break;case 1:if(ao(N,R,m),b=R,N=b.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Te){er(b,b.return,Te)}if(b=R,N=b.updateQueue,N!==null){var ce=b.stateNode;try{var ve=N.shared.hiddenCallbacks;if(ve!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ve.length;N++)qT(ve[N],ce)}catch(Te){er(b,b.return,Te)}}m&&W&64&&tA(R),$d(R,R.return);break;case 27:aA(R);case 26:case 5:ao(N,R,m),m&&b===null&&W&4&&nA(R),$d(R,R.return);break;case 12:ao(N,R,m);break;case 31:ao(N,R,m),m&&W&4&&uA(N,R);break;case 13:ao(N,R,m),m&&W&4&&fA(N,R);break;case 22:R.memoizedState===null&&ao(N,R,m),$d(R,R.return);break;case 30:break;default:ao(N,R,m)}u=u.sibling}}function kv(l,u){var m=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),l=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(l=u.memoizedState.cachePool.pool),l!==m&&(l!=null&&l.refCount++,m!=null&&jd(m))}function Av(l,u){l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&jd(l))}function Ja(l,u,m,b){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)pA(l,u,m,b),u=u.sibling}function pA(l,u,m,b){var N=u.flags;switch(u.tag){case 0:case 11:case 15:Ja(l,u,m,b),N&2048&&Wd(9,u);break;case 1:Ja(l,u,m,b);break;case 3:Ja(l,u,m,b),N&2048&&(l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&jd(l)));break;case 12:if(N&2048){Ja(l,u,m,b),l=u.stateNode;try{var R=u.memoizedProps,W=R.id,ce=R.onPostCommit;typeof ce=="function"&&ce(W,u.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(ve){er(u,u.return,ve)}}else Ja(l,u,m,b);break;case 31:Ja(l,u,m,b);break;case 13:Ja(l,u,m,b);break;case 23:break;case 22:R=u.stateNode,W=u.alternate,u.memoizedState!==null?R._visibility&2?Ja(l,u,m,b):Gd(l,u):R._visibility&2?Ja(l,u,m,b):(R._visibility|=2,Hu(l,u,m,b,(u.subtreeFlags&10256)!==0||!1)),N&2048&&kv(W,u);break;case 24:Ja(l,u,m,b),N&2048&&Av(u.alternate,u);break;default:Ja(l,u,m,b)}}function Hu(l,u,m,b,N){for(N=N&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var R=l,W=u,ce=m,ve=b,Te=W.flags;switch(W.tag){case 0:case 11:case 15:Hu(R,W,ce,ve,N),Wd(8,W);break;case 23:break;case 22:var Ue=W.stateNode;W.memoizedState!==null?Ue._visibility&2?Hu(R,W,ce,ve,N):Gd(R,W):(Ue._visibility|=2,Hu(R,W,ce,ve,N)),N&&Te&2048&&kv(W.alternate,W);break;case 24:Hu(R,W,ce,ve,N),N&&Te&2048&&Av(W.alternate,W);break;default:Hu(R,W,ce,ve,N)}u=u.sibling}}function Gd(l,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var m=l,b=u,N=b.flags;switch(b.tag){case 22:Gd(m,b),N&2048&&kv(b.alternate,b);break;case 24:Gd(m,b),N&2048&&Av(b.alternate,b);break;default:Gd(m,b)}u=u.sibling}}var Kd=8192;function Vu(l,u,m){if(l.subtreeFlags&Kd)for(l=l.child;l!==null;)mA(l,u,m),l=l.sibling}function mA(l,u,m){switch(l.tag){case 26:Vu(l,u,m),l.flags&Kd&&l.memoizedState!==null&&v7(m,Ya,l.memoizedState,l.memoizedProps);break;case 5:Vu(l,u,m);break;case 3:case 4:var b=Ya;Ya=gm(l.stateNode.containerInfo),Vu(l,u,m),Ya=b;break;case 22:l.memoizedState===null&&(b=l.alternate,b!==null&&b.memoizedState!==null?(b=Kd,Kd=16777216,Vu(l,u,m),Kd=b):Vu(l,u,m));break;default:Vu(l,u,m)}}function xA(l){var u=l.alternate;if(u!==null&&(l=u.child,l!==null)){u.child=null;do u=l.sibling,l.sibling=null,l=u;while(l!==null)}}function Xd(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var b=u[m];An=b,yA(b,l)}xA(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)gA(l),l=l.sibling}function gA(l){switch(l.tag){case 0:case 11:case 15:Xd(l),l.flags&2048&&rl(9,l,l.return);break;case 3:Xd(l);break;case 12:Xd(l);break;case 22:var u=l.stateNode;l.memoizedState!==null&&u._visibility&2&&(l.return===null||l.return.tag!==13)?(u._visibility&=-3,sm(l)):Xd(l);break;default:Xd(l)}}function sm(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var b=u[m];An=b,yA(b,l)}xA(l)}for(l=l.child;l!==null;){switch(u=l,u.tag){case 0:case 11:case 15:rl(8,u,u.return),sm(u);break;case 22:m=u.stateNode,m._visibility&2&&(m._visibility&=-3,sm(u));break;default:sm(u)}l=l.sibling}}function yA(l,u){for(;An!==null;){var m=An;switch(m.tag){case 0:case 11:case 15:rl(8,m,u);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var b=m.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:jd(m.memoizedState.cache)}if(b=m.child,b!==null)b.return=m,An=b;else e:for(m=l;An!==null;){b=An;var N=b.sibling,R=b.return;if(lA(b),b===m){An=null;break e}if(N!==null){N.return=R,An=N;break e}An=R}}}var I9={getCacheForType:function(l){var u=Ln(an),m=u.data.get(l);return m===void 0&&(m=l(),u.data.set(l,m)),m},cacheSignal:function(){return Ln(an).controller.signal}},M9=typeof WeakMap=="function"?WeakMap:Map,Jt=0,pr=null,Ut=null,Ht=0,Qt=0,Ys=null,nl=!1,qu=!1,Cv=!1,io=0,Lr=0,sl=0,gc=0,Rv=0,Js=0,Wu=0,Yd=null,js=null,Ov=!1,am=0,vA=0,im=1/0,om=null,al=null,vn=0,il=null,$u=null,oo=0,jv=0,Dv=null,bA=null,Jd=0,Iv=null;function Zs(){return(Jt&2)!==0&&Ht!==0?Ht&-Ht:ee.T!==null?Uv():oe()}function wA(){if(Js===0)if((Ht&536870912)===0||Wt){var l=Ka;Ka<<=1,(Ka&3932160)===0&&(Ka=262144),Js=l}else Js=536870912;return l=Ks.current,l!==null&&(l.flags|=32),Js}function Ds(l,u,m){(l===pr&&(Qt===2||Qt===9)||l.cancelPendingCommit!==null)&&(Gu(l,0),ol(l,Ht,Js,!1)),br(l,m),((Jt&2)===0||l!==pr)&&(l===pr&&((Jt&2)===0&&(gc|=m),Lr===4&&ol(l,Ht,Js,!1)),bi(l))}function _A(l,u,m){if((Jt&6)!==0)throw Error(n(327));var b=!m&&(u&127)===0&&(u&l.expiredLanes)===0||xr(l,u),N=b?L9(l,u):Fv(l,u,!0),R=b;do{if(N===0){qu&&!b&&ol(l,u,0,!1);break}else{if(m=l.current.alternate,R&&!F9(m)){N=Fv(l,u,!1),R=!1;continue}if(N===2){if(R=u,l.errorRecoveryDisabledLanes&R)var W=0;else W=l.pendingLanes&-536870913,W=W!==0?W:W&536870912?536870912:0;if(W!==0){u=W;e:{var ce=l;N=Yd;var ve=ce.current.memoizedState.isDehydrated;if(ve&&(Gu(ce,W).flags|=256),W=Fv(ce,W,!1),W!==2){if(Cv&&!ve){ce.errorRecoveryDisabledLanes|=R,gc|=R,N=4;break e}R=js,js=N,R!==null&&(js===null?js=R:js.push.apply(js,R))}N=W}if(R=!1,N!==2)continue}}if(N===1){Gu(l,0),ol(l,u,0,!0);break}e:{switch(b=l,R=N,R){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:ol(b,u,Js,!nl);break e;case 2:js=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(N=am+300-De(),10<N)){if(ol(b,u,Js,!nl),wt(b,0,!0)!==0)break e;oo=u,b.timeoutHandle=QA(EA.bind(null,b,m,js,om,Ov,u,Js,gc,Wu,nl,R,"Throttled",-0,0),N);break e}EA(b,m,js,om,Ov,u,Js,gc,Wu,nl,R,null,-0,0)}}break}while(!0);bi(l)}function EA(l,u,m,b,N,R,W,ce,ve,Te,Ue,Ve,Oe,Ie){if(l.timeoutHandle=-1,Ve=u.subtreeFlags,Ve&8192||(Ve&16785408)===16785408){Ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:$i},mA(u,R,Ve);var ot=(R&62914560)===R?am-De():(R&4194048)===R?vA-De():0;if(ot=b7(Ve,ot),ot!==null){oo=R,l.cancelPendingCommit=ot(OA.bind(null,l,u,R,m,b,N,W,ce,ve,Ue,Ve,null,Oe,Ie)),ol(l,R,W,!Te);return}}OA(l,u,R,m,b,N,W,ce,ve)}function F9(l){for(var u=l;;){var m=u.tag;if((m===0||m===11||m===15)&&u.flags&16384&&(m=u.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var b=0;b<m.length;b++){var N=m[b],R=N.getSnapshot;N=N.value;try{if(!$s(R(),N))return!1}catch{return!1}}if(m=u.child,u.subtreeFlags&16384&&m!==null)m.return=u,u=m;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function ol(l,u,m,b){u&=~Rv,u&=~gc,l.suspendedLanes|=u,l.pingedLanes&=~u,b&&(l.warmLanes|=u),b=l.expirationTimes;for(var N=u;0<N;){var R=31-or(N),W=1<<R;b[R]=-1,N&=~W}m!==0&&qi(l,m,u)}function lm(){return(Jt&6)===0?(Zd(0),!1):!0}function Mv(){if(Ut!==null){if(Qt===0)var l=Ut.return;else l=Ut,Yi=lc=null,Jy(l),Pu=null,Id=0,l=Ut;for(;l!==null;)eA(l.alternate,l),l=l.return;Ut=null}}function Gu(l,u){var m=l.timeoutHandle;m!==-1&&(l.timeoutHandle=-1,r7(m)),m=l.cancelPendingCommit,m!==null&&(l.cancelPendingCommit=null,m()),oo=0,Mv(),pr=l,Ut=m=Ki(l.current,null),Ht=u,Qt=0,Ys=null,nl=!1,qu=xr(l,u),Cv=!1,Wu=Js=Rv=gc=sl=Lr=0,js=Yd=null,Ov=!1,(u&8)!==0&&(u|=u&32);var b=l.entangledLanes;if(b!==0)for(l=l.entanglements,b&=u;0<b;){var N=31-or(b),R=1<<N;u|=l[N],b&=~R}return io=u,Cp(),m}function SA(l,u){kt=null,ee.H=Hd,u===Fu||u===Pp?(u=UT(),Qt=3):u===By?(u=UT(),Qt=4):Qt=u===hv?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Ys=u,Ut===null&&(Lr=1,Jp(l,ga(u,l.current)))}function NA(){var l=Ks.current;return l===null?!0:(Ht&4194048)===Ht?wa===null:(Ht&62914560)===Ht||(Ht&536870912)!==0?l===wa:!1}function TA(){var l=ee.H;return ee.H=Hd,l===null?Hd:l}function kA(){var l=ee.A;return ee.A=I9,l}function cm(){Lr=4,nl||(Ht&4194048)!==Ht&&Ks.current!==null||(qu=!0),(sl&134217727)===0&&(gc&134217727)===0||pr===null||ol(pr,Ht,Js,!1)}function Fv(l,u,m){var b=Jt;Jt|=2;var N=TA(),R=kA();(pr!==l||Ht!==u)&&(om=null,Gu(l,u)),u=!1;var W=Lr;e:do try{if(Qt!==0&&Ut!==null){var ce=Ut,ve=Ys;switch(Qt){case 8:Mv(),W=6;break e;case 3:case 2:case 9:case 6:Ks.current===null&&(u=!0);var Te=Qt;if(Qt=0,Ys=null,Ku(l,ce,ve,Te),m&&qu){W=0;break e}break;default:Te=Qt,Qt=0,Ys=null,Ku(l,ce,ve,Te)}}P9(),W=Lr;break}catch(Ue){SA(l,Ue)}while(!0);return u&&l.shellSuspendCounter++,Yi=lc=null,Jt=b,ee.H=N,ee.A=R,Ut===null&&(pr=null,Ht=0,Cp()),W}function P9(){for(;Ut!==null;)AA(Ut)}function L9(l,u){var m=Jt;Jt|=2;var b=TA(),N=kA();pr!==l||Ht!==u?(om=null,im=De()+500,Gu(l,u)):qu=xr(l,u);e:do try{if(Qt!==0&&Ut!==null){u=Ut;var R=Ys;t:switch(Qt){case 1:Qt=0,Ys=null,Ku(l,u,R,1);break;case 2:case 9:if(LT(R)){Qt=0,Ys=null,CA(u);break}u=function(){Qt!==2&&Qt!==9||pr!==l||(Qt=7),bi(l)},R.then(u,u);break e;case 3:Qt=7;break e;case 4:Qt=5;break e;case 7:LT(R)?(Qt=0,Ys=null,CA(u)):(Qt=0,Ys=null,Ku(l,u,R,7));break;case 5:var W=null;switch(Ut.tag){case 26:W=Ut.memoizedState;case 5:case 27:var ce=Ut;if(W?pC(W):ce.stateNode.complete){Qt=0,Ys=null;var ve=ce.sibling;if(ve!==null)Ut=ve;else{var Te=ce.return;Te!==null?(Ut=Te,um(Te)):Ut=null}break t}}Qt=0,Ys=null,Ku(l,u,R,5);break;case 6:Qt=0,Ys=null,Ku(l,u,R,6);break;case 8:Mv(),Lr=6;break e;default:throw Error(n(462))}}B9();break}catch(Ue){SA(l,Ue)}while(!0);return Yi=lc=null,ee.H=b,ee.A=N,Jt=m,Ut!==null?0:(pr=null,Ht=0,Cp(),Lr)}function B9(){for(;Ut!==null&&!he();)AA(Ut)}function AA(l){var u=Zk(l.alternate,l,io);l.memoizedProps=l.pendingProps,u===null?um(l):Ut=u}function CA(l){var u=l,m=u.alternate;switch(u.tag){case 15:case 0:u=$k(m,u,u.pendingProps,u.type,void 0,Ht);break;case 11:u=$k(m,u,u.pendingProps,u.type.render,u.ref,Ht);break;case 5:Jy(u);default:eA(m,u),u=Ut=kT(u,io),u=Zk(m,u,io)}l.memoizedProps=l.pendingProps,u===null?um(l):Ut=u}function Ku(l,u,m,b){Yi=lc=null,Jy(u),Pu=null,Id=0;var N=u.return;try{if(k9(l,N,u,m,Ht)){Lr=1,Jp(l,ga(m,l.current)),Ut=null;return}}catch(R){if(N!==null)throw Ut=N,R;Lr=1,Jp(l,ga(m,l.current)),Ut=null;return}u.flags&32768?(Wt||b===1?l=!0:qu||(Ht&536870912)!==0?l=!1:(nl=l=!0,(b===2||b===9||b===3||b===6)&&(b=Ks.current,b!==null&&b.tag===13&&(b.flags|=16384))),RA(u,l)):um(u)}function um(l){var u=l;do{if((u.flags&32768)!==0){RA(u,nl);return}l=u.return;var m=R9(u.alternate,u,io);if(m!==null){Ut=m;return}if(u=u.sibling,u!==null){Ut=u;return}Ut=u=l}while(u!==null);Lr===0&&(Lr=5)}function RA(l,u){do{var m=O9(l.alternate,l);if(m!==null){m.flags&=32767,Ut=m;return}if(m=l.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!u&&(l=l.sibling,l!==null)){Ut=l;return}Ut=l=m}while(l!==null);Lr=6,Ut=null}function OA(l,u,m,b,N,R,W,ce,ve){l.cancelPendingCommit=null;do fm();while(vn!==0);if((Jt&6)!==0)throw Error(n(327));if(u!==null){if(u===l.current)throw Error(n(177));if(R=u.lanes|u.childLanes,R|=Sy,es(l,m,R,W,ce,ve),l===pr&&(Ut=pr=null,Ht=0),$u=u,il=l,oo=m,jv=R,Dv=N,bA=b,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,V9(at,function(){return FA(),null})):(l.callbackNode=null,l.callbackPriority=0),b=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||b){b=ee.T,ee.T=null,N=te.p,te.p=2,W=Jt,Jt|=4;try{j9(l,u,m)}finally{Jt=W,te.p=N,ee.T=b}}vn=1,jA(),DA(),IA()}}function jA(){if(vn===1){vn=0;var l=il,u=$u,m=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||m){m=ee.T,ee.T=null;var b=te.p;te.p=2;var N=Jt;Jt|=4;try{dA(u,l);var R=Kv,W=yT(l.containerInfo),ce=R.focusedElem,ve=R.selectionRange;if(W!==ce&&ce&&ce.ownerDocument&&gT(ce.ownerDocument.documentElement,ce)){if(ve!==null&&vy(ce)){var Te=ve.start,Ue=ve.end;if(Ue===void 0&&(Ue=Te),"selectionStart"in ce)ce.selectionStart=Te,ce.selectionEnd=Math.min(Ue,ce.value.length);else{var Ve=ce.ownerDocument||document,Oe=Ve&&Ve.defaultView||window;if(Oe.getSelection){var Ie=Oe.getSelection(),ot=ce.textContent.length,gt=Math.min(ve.start,ot),ur=ve.end===void 0?gt:Math.min(ve.end,ot);!Ie.extend&&gt>ur&&(W=ur,ur=gt,gt=W);var Se=xT(ce,gt),_e=xT(ce,ur);if(Se&&_e&&(Ie.rangeCount!==1||Ie.anchorNode!==Se.node||Ie.anchorOffset!==Se.offset||Ie.focusNode!==_e.node||Ie.focusOffset!==_e.offset)){var Ne=Ve.createRange();Ne.setStart(Se.node,Se.offset),Ie.removeAllRanges(),gt>ur?(Ie.addRange(Ne),Ie.extend(_e.node,_e.offset)):(Ne.setEnd(_e.node,_e.offset),Ie.addRange(Ne))}}}}for(Ve=[],Ie=ce;Ie=Ie.parentNode;)Ie.nodeType===1&&Ve.push({element:Ie,left:Ie.scrollLeft,top:Ie.scrollTop});for(typeof ce.focus=="function"&&ce.focus(),ce=0;ce<Ve.length;ce++){var He=Ve[ce];He.element.scrollLeft=He.left,He.element.scrollTop=He.top}}Em=!!Gv,Kv=Gv=null}finally{Jt=N,te.p=b,ee.T=m}}l.current=u,vn=2}}function DA(){if(vn===2){vn=0;var l=il,u=$u,m=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||m){m=ee.T,ee.T=null;var b=te.p;te.p=2;var N=Jt;Jt|=4;try{oA(l,u.alternate,u)}finally{Jt=N,te.p=b,ee.T=m}}vn=3}}function IA(){if(vn===4||vn===3){vn=0,ke();var l=il,u=$u,m=oo,b=bA;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?vn=5:(vn=0,$u=il=null,MA(l,l.pendingLanes));var N=l.pendingLanes;if(N===0&&(al=null),Ws(m),u=u.stateNode,ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(vt,u,void 0,(u.current.flags&128)===128)}catch{}if(b!==null){u=ee.T,N=te.p,te.p=2,ee.T=null;try{for(var R=l.onRecoverableError,W=0;W<b.length;W++){var ce=b[W];R(ce.value,{componentStack:ce.stack})}}finally{ee.T=u,te.p=N}}(oo&3)!==0&&fm(),bi(l),N=l.pendingLanes,(m&261930)!==0&&(N&42)!==0?l===Iv?Jd++:(Jd=0,Iv=l):Jd=0,Zd(0)}}function MA(l,u){(l.pooledCacheLanes&=u)===0&&(u=l.pooledCache,u!=null&&(l.pooledCache=null,jd(u)))}function fm(){return jA(),DA(),IA(),FA()}function FA(){if(vn!==5)return!1;var l=il,u=jv;jv=0;var m=Ws(oo),b=ee.T,N=te.p;try{te.p=32>m?32:m,ee.T=null,m=Dv,Dv=null;var R=il,W=oo;if(vn=0,$u=il=null,oo=0,(Jt&6)!==0)throw Error(n(331));var ce=Jt;if(Jt|=4,gA(R.current),pA(R,R.current,W,m),Jt=ce,Zd(0,!1),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(vt,R)}catch{}return!0}finally{te.p=N,ee.T=b,MA(l,u)}}function PA(l,u,m){u=ga(m,u),u=dv(l.stateNode,u,2),l=Qo(l,u,2),l!==null&&(br(l,2),bi(l))}function er(l,u,m){if(l.tag===3)PA(l,l,m);else for(;u!==null;){if(u.tag===3){PA(u,l,m);break}else if(u.tag===1){var b=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(al===null||!al.has(b))){l=ga(m,l),m=Lk(2),b=Qo(u,m,2),b!==null&&(Bk(m,b,u,l),br(b,2),bi(b));break}}u=u.return}}function Pv(l,u,m){var b=l.pingCache;if(b===null){b=l.pingCache=new M9;var N=new Set;b.set(u,N)}else N=b.get(u),N===void 0&&(N=new Set,b.set(u,N));N.has(m)||(Cv=!0,N.add(m),l=U9.bind(null,l,u,m),u.then(l,l))}function U9(l,u,m){var b=l.pingCache;b!==null&&b.delete(u),l.pingedLanes|=l.suspendedLanes&m,l.warmLanes&=~m,pr===l&&(Ht&m)===m&&(Lr===4||Lr===3&&(Ht&62914560)===Ht&&300>De()-am?(Jt&2)===0&&Gu(l,0):Rv|=m,Wu===Ht&&(Wu=0)),bi(l)}function LA(l,u){u===0&&(u=Tn()),l=ac(l,u),l!==null&&(br(l,u),bi(l))}function z9(l){var u=l.memoizedState,m=0;u!==null&&(m=u.retryLane),LA(l,m)}function H9(l,u){var m=0;switch(l.tag){case 31:case 13:var b=l.stateNode,N=l.memoizedState;N!==null&&(m=N.retryLane);break;case 19:b=l.stateNode;break;case 22:b=l.stateNode._retryCache;break;default:throw Error(n(314))}b!==null&&b.delete(u),LA(l,m)}function V9(l,u){return ue(l,u)}var dm=null,Xu=null,Lv=!1,hm=!1,Bv=!1,ll=0;function bi(l){l!==Xu&&l.next===null&&(Xu===null?dm=Xu=l:Xu=Xu.next=l),hm=!0,Lv||(Lv=!0,W9())}function Zd(l,u){if(!Bv&&hm){Bv=!0;do for(var m=!1,b=dm;b!==null;){if(l!==0){var N=b.pendingLanes;if(N===0)var R=0;else{var W=b.suspendedLanes,ce=b.pingedLanes;R=(1<<31-or(42|l)+1)-1,R&=N&~(W&~ce),R=R&201326741?R&201326741|1:R?R|2:0}R!==0&&(m=!0,HA(b,R))}else R=Ht,R=wt(b,b===pr?R:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(R&3)===0||xr(b,R)||(m=!0,HA(b,R));b=b.next}while(m);Bv=!1}}function q9(){BA()}function BA(){hm=Lv=!1;var l=0;ll!==0&&t7()&&(l=ll);for(var u=De(),m=null,b=dm;b!==null;){var N=b.next,R=UA(b,u);R===0?(b.next=null,m===null?dm=N:m.next=N,N===null&&(Xu=m)):(m=b,(l!==0||(R&3)!==0)&&(hm=!0)),b=N}vn!==0&&vn!==5||Zd(l),ll!==0&&(ll=0)}function UA(l,u){for(var m=l.suspendedLanes,b=l.pingedLanes,N=l.expirationTimes,R=l.pendingLanes&-62914561;0<R;){var W=31-or(R),ce=1<<W,ve=N[W];ve===-1?((ce&m)===0||(ce&b)!==0)&&(N[W]=sn(ce,u)):ve<=u&&(l.expiredLanes|=ce),R&=~ce}if(u=pr,m=Ht,m=wt(l,l===u?m:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),b=l.callbackNode,m===0||l===u&&(Qt===2||Qt===9)||l.cancelPendingCommit!==null)return b!==null&&b!==null&&ye(b),l.callbackNode=null,l.callbackPriority=0;if((m&3)===0||xr(l,m)){if(u=m&-m,u===l.callbackPriority)return u;switch(b!==null&&ye(b),Ws(m)){case 2:case 8:m=rt;break;case 32:m=at;break;case 268435456:m=dt;break;default:m=at}return b=zA.bind(null,l),m=ue(m,b),l.callbackPriority=u,l.callbackNode=m,u}return b!==null&&b!==null&&ye(b),l.callbackPriority=2,l.callbackNode=null,2}function zA(l,u){if(vn!==0&&vn!==5)return l.callbackNode=null,l.callbackPriority=0,null;var m=l.callbackNode;if(fm()&&l.callbackNode!==m)return null;var b=Ht;return b=wt(l,l===pr?b:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),b===0?null:(_A(l,b,u),UA(l,De()),l.callbackNode!=null&&l.callbackNode===m?zA.bind(null,l):null)}function HA(l,u){if(fm())return null;_A(l,u,!0)}function W9(){n7(function(){(Jt&6)!==0?ue($e,q9):BA()})}function Uv(){if(ll===0){var l=Iu;l===0&&(l=Ga,Ga<<=1,(Ga&261888)===0&&(Ga=256)),ll=l}return ll}function VA(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:wp(""+l)}function qA(l,u){var m=u.ownerDocument.createElement("input");return m.name=u.name,m.value=u.value,l.id&&m.setAttribute("form",l.id),u.parentNode.insertBefore(m,u),l=new FormData(l),m.parentNode.removeChild(m),l}function $9(l,u,m,b,N){if(u==="submit"&&m&&m.stateNode===N){var R=VA((N[pe]||null).action),W=b.submitter;W&&(u=(u=W[pe]||null)?VA(u.formAction):W.getAttribute("formAction"),u!==null&&(R=u,W=null));var ce=new Np("action","action",null,b,N);l.push({event:ce,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(ll!==0){var ve=W?qA(N,W):new FormData(N);iv(m,{pending:!0,data:ve,method:N.method,action:R},null,ve)}}else typeof R=="function"&&(ce.preventDefault(),ve=W?qA(N,W):new FormData(N),iv(m,{pending:!0,data:ve,method:N.method,action:R},R,ve))},currentTarget:N}]})}}for(var zv=0;zv<Ey.length;zv++){var Hv=Ey[zv],G9=Hv.toLowerCase(),K9=Hv[0].toUpperCase()+Hv.slice(1);Xa(G9,"on"+K9)}Xa(wT,"onAnimationEnd"),Xa(_T,"onAnimationIteration"),Xa(ET,"onAnimationStart"),Xa("dblclick","onDoubleClick"),Xa("focusin","onFocus"),Xa("focusout","onBlur"),Xa(u9,"onTransitionRun"),Xa(f9,"onTransitionStart"),Xa(d9,"onTransitionCancel"),Xa(ST,"onTransitionEnd"),ha("onMouseEnter",["mouseout","mouseover"]),ha("onMouseLeave",["mouseout","mouseover"]),ha("onPointerEnter",["pointerout","pointerover"]),ha("onPointerLeave",["pointerout","pointerover"]),Cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Cr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),X9=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qd));function WA(l,u){u=(u&4)!==0;for(var m=0;m<l.length;m++){var b=l[m],N=b.event;b=b.listeners;e:{var R=void 0;if(u)for(var W=b.length-1;0<=W;W--){var ce=b[W],ve=ce.instance,Te=ce.currentTarget;if(ce=ce.listener,ve!==R&&N.isPropagationStopped())break e;R=ce,N.currentTarget=Te;try{R(N)}catch(Ue){Ap(Ue)}N.currentTarget=null,R=ve}else for(W=0;W<b.length;W++){if(ce=b[W],ve=ce.instance,Te=ce.currentTarget,ce=ce.listener,ve!==R&&N.isPropagationStopped())break e;R=ce,N.currentTarget=Te;try{R(N)}catch(Ue){Ap(Ue)}N.currentTarget=null,R=ve}}}}function zt(l,u){var m=u[Ae];m===void 0&&(m=u[Ae]=new Set);var b=l+"__bubble";m.has(b)||($A(u,l,2,!1),m.add(b))}function Vv(l,u,m){var b=0;u&&(b|=4),$A(m,l,b,u)}var pm="_reactListening"+Math.random().toString(36).slice(2);function qv(l){if(!l[pm]){l[pm]=!0,gr.forEach(function(m){m!=="selectionchange"&&(X9.has(m)||Vv(m,!1,l),Vv(m,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[pm]||(u[pm]=!0,Vv("selectionchange",!1,u))}}function $A(l,u,m,b){switch(wC(u)){case 2:var N=E7;break;case 8:N=S7;break;default:N=ab}m=N.bind(null,u,m,l),N=void 0,!uy||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(N=!0),b?N!==void 0?l.addEventListener(u,m,{capture:!0,passive:N}):l.addEventListener(u,m,!0):N!==void 0?l.addEventListener(u,m,{passive:N}):l.addEventListener(u,m,!1)}function Wv(l,u,m,b,N){var R=b;if((u&1)===0&&(u&2)===0&&b!==null)e:for(;;){if(b===null)return;var W=b.tag;if(W===3||W===4){var ce=b.stateNode.containerInfo;if(ce===N)break;if(W===4)for(W=b.return;W!==null;){var ve=W.tag;if((ve===3||ve===4)&&W.stateNode.containerInfo===N)return;W=W.return}for(;ce!==null;){if(W=Ze(ce),W===null)return;if(ve=W.tag,ve===5||ve===6||ve===26||ve===27){b=R=W;continue e}ce=ce.parentNode}}b=b.return}JN(function(){var Te=R,Ue=ly(m),Ve=[];e:{var Oe=NT.get(l);if(Oe!==void 0){var Ie=Np,ot=l;switch(l){case"keypress":if(Ep(m)===0)break e;case"keydown":case"keyup":Ie=HB;break;case"focusin":ot="focus",Ie=py;break;case"focusout":ot="blur",Ie=py;break;case"beforeblur":case"afterblur":Ie=py;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ie=eT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ie=RB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ie=WB;break;case wT:case _T:case ET:Ie=DB;break;case ST:Ie=GB;break;case"scroll":case"scrollend":Ie=AB;break;case"wheel":Ie=XB;break;case"copy":case"cut":case"paste":Ie=MB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ie=rT;break;case"toggle":case"beforetoggle":Ie=JB}var gt=(u&4)!==0,ur=!gt&&(l==="scroll"||l==="scrollend"),Se=gt?Oe!==null?Oe+"Capture":null:Oe;gt=[];for(var _e=Te,Ne;_e!==null;){var He=_e;if(Ne=He.stateNode,He=He.tag,He!==5&&He!==26&&He!==27||Ne===null||Se===null||(He=wd(_e,Se),He!=null&&gt.push(eh(_e,He,Ne))),ur)break;_e=_e.return}0<gt.length&&(Oe=new Ie(Oe,ot,null,m,Ue),Ve.push({event:Oe,listeners:gt}))}}if((u&7)===0){e:{if(Oe=l==="mouseover"||l==="pointerover",Ie=l==="mouseout"||l==="pointerout",Oe&&m!==oy&&(ot=m.relatedTarget||m.fromElement)&&(Ze(ot)||ot[ge]))break e;if((Ie||Oe)&&(Oe=Ue.window===Ue?Ue:(Oe=Ue.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,Ie?(ot=m.relatedTarget||m.toElement,Ie=Te,ot=ot?Ze(ot):null,ot!==null&&(ur=a(ot),gt=ot.tag,ot!==ur||gt!==5&&gt!==27&&gt!==6)&&(ot=null)):(Ie=null,ot=Te),Ie!==ot)){if(gt=eT,He="onMouseLeave",Se="onMouseEnter",_e="mouse",(l==="pointerout"||l==="pointerover")&&(gt=rT,He="onPointerLeave",Se="onPointerEnter",_e="pointer"),ur=Ie==null?Oe:Ye(Ie),Ne=ot==null?Oe:Ye(ot),Oe=new gt(He,_e+"leave",Ie,m,Ue),Oe.target=ur,Oe.relatedTarget=Ne,He=null,Ze(Ue)===Te&&(gt=new gt(Se,_e+"enter",ot,m,Ue),gt.target=Ne,gt.relatedTarget=ur,He=gt),ur=He,Ie&&ot)t:{for(gt=Y9,Se=Ie,_e=ot,Ne=0,He=Se;He;He=gt(He))Ne++;He=0;for(var pt=_e;pt;pt=gt(pt))He++;for(;0<Ne-He;)Se=gt(Se),Ne--;for(;0<He-Ne;)_e=gt(_e),He--;for(;Ne--;){if(Se===_e||_e!==null&&Se===_e.alternate){gt=Se;break t}Se=gt(Se),_e=gt(_e)}gt=null}else gt=null;Ie!==null&&GA(Ve,Oe,Ie,gt,!1),ot!==null&&ur!==null&&GA(Ve,ur,ot,gt,!0)}}e:{if(Oe=Te?Ye(Te):window,Ie=Oe.nodeName&&Oe.nodeName.toLowerCase(),Ie==="select"||Ie==="input"&&Oe.type==="file")var Kt=uT;else if(lT(Oe))if(fT)Kt=o9;else{Kt=a9;var ft=s9}else Ie=Oe.nodeName,!Ie||Ie.toLowerCase()!=="input"||Oe.type!=="checkbox"&&Oe.type!=="radio"?Te&&iy(Te.elementType)&&(Kt=uT):Kt=i9;if(Kt&&(Kt=Kt(l,Te))){cT(Ve,Kt,m,Ue);break e}ft&&ft(l,Oe,Te),l==="focusout"&&Te&&Oe.type==="number"&&Te.memoizedProps.value!=null&&ay(Oe,"number",Oe.value)}switch(ft=Te?Ye(Te):window,l){case"focusin":(lT(ft)||ft.contentEditable==="true")&&(Tu=ft,by=Te,Cd=null);break;case"focusout":Cd=by=Tu=null;break;case"mousedown":wy=!0;break;case"contextmenu":case"mouseup":case"dragend":wy=!1,vT(Ve,m,Ue);break;case"selectionchange":if(c9)break;case"keydown":case"keyup":vT(Ve,m,Ue)}var Rt;if(xy)e:{switch(l){case"compositionstart":var Vt="onCompositionStart";break e;case"compositionend":Vt="onCompositionEnd";break e;case"compositionupdate":Vt="onCompositionUpdate";break e}Vt=void 0}else Nu?iT(l,m)&&(Vt="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(Vt="onCompositionStart");Vt&&(nT&&m.locale!=="ko"&&(Nu||Vt!=="onCompositionStart"?Vt==="onCompositionEnd"&&Nu&&(Rt=ZN()):($o=Ue,fy="value"in $o?$o.value:$o.textContent,Nu=!0)),ft=mm(Te,Vt),0<ft.length&&(Vt=new tT(Vt,l,null,m,Ue),Ve.push({event:Vt,listeners:ft}),Rt?Vt.data=Rt:(Rt=oT(m),Rt!==null&&(Vt.data=Rt)))),(Rt=QB?e9(l,m):t9(l,m))&&(Vt=mm(Te,"onBeforeInput"),0<Vt.length&&(ft=new tT("onBeforeInput","beforeinput",null,m,Ue),Ve.push({event:ft,listeners:Vt}),ft.data=Rt)),$9(Ve,l,Te,m,Ue)}WA(Ve,u)})}function eh(l,u,m){return{instance:l,listener:u,currentTarget:m}}function mm(l,u){for(var m=u+"Capture",b=[];l!==null;){var N=l,R=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||R===null||(N=wd(l,m),N!=null&&b.unshift(eh(l,N,R)),N=wd(l,u),N!=null&&b.push(eh(l,N,R))),l.tag===3)return b;l=l.return}return[]}function Y9(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function GA(l,u,m,b,N){for(var R=u._reactName,W=[];m!==null&&m!==b;){var ce=m,ve=ce.alternate,Te=ce.stateNode;if(ce=ce.tag,ve!==null&&ve===b)break;ce!==5&&ce!==26&&ce!==27||Te===null||(ve=Te,N?(Te=wd(m,R),Te!=null&&W.unshift(eh(m,Te,ve))):N||(Te=wd(m,R),Te!=null&&W.push(eh(m,Te,ve)))),m=m.return}W.length!==0&&l.push({event:u,listeners:W})}var J9=/\r\n?/g,Z9=/\u0000|\uFFFD/g;function KA(l){return(typeof l=="string"?l:""+l).replace(J9,`
`).replace(Z9,"")}function XA(l,u){return u=KA(u),KA(l)===u}function cr(l,u,m,b,N,R){switch(m){case"children":typeof b=="string"?u==="body"||u==="textarea"&&b===""||_u(l,b):(typeof b=="number"||typeof b=="bigint")&&u!=="body"&&_u(l,""+b);break;case"className":vp(l,"class",b);break;case"tabIndex":vp(l,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":vp(l,m,b);break;case"style":XN(l,b,R);break;case"data":if(u!=="object"){vp(l,"data",b);break}case"src":case"href":if(b===""&&(u!=="a"||m!=="href")){l.removeAttribute(m);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){l.removeAttribute(m);break}b=wp(""+b),l.setAttribute(m,b);break;case"action":case"formAction":if(typeof b=="function"){l.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof R=="function"&&(m==="formAction"?(u!=="input"&&cr(l,u,"name",N.name,N,null),cr(l,u,"formEncType",N.formEncType,N,null),cr(l,u,"formMethod",N.formMethod,N,null),cr(l,u,"formTarget",N.formTarget,N,null)):(cr(l,u,"encType",N.encType,N,null),cr(l,u,"method",N.method,N,null),cr(l,u,"target",N.target,N,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){l.removeAttribute(m);break}b=wp(""+b),l.setAttribute(m,b);break;case"onClick":b!=null&&(l.onclick=$i);break;case"onScroll":b!=null&&zt("scroll",l);break;case"onScrollEnd":b!=null&&zt("scrollend",l);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(n(61));if(m=b.__html,m!=null){if(N.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"multiple":l.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":l.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){l.removeAttribute("xlink:href");break}m=wp(""+b),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?l.setAttribute(m,""+b):l.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?l.setAttribute(m,""):l.removeAttribute(m);break;case"capture":case"download":b===!0?l.setAttribute(m,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?l.setAttribute(m,b):l.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?l.setAttribute(m,b):l.removeAttribute(m);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?l.removeAttribute(m):l.setAttribute(m,b);break;case"popover":zt("beforetoggle",l),zt("toggle",l),ks(l,"popover",b);break;case"xlinkActuate":Wi(l,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":Wi(l,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":Wi(l,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":Wi(l,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":Wi(l,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":Wi(l,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":Wi(l,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":Wi(l,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":Wi(l,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":ks(l,"is",b);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=TB.get(m)||m,ks(l,m,b))}}function $v(l,u,m,b,N,R){switch(m){case"style":XN(l,b,R);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(n(61));if(m=b.__html,m!=null){if(N.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"children":typeof b=="string"?_u(l,b):(typeof b=="number"||typeof b=="bigint")&&_u(l,""+b);break;case"onScroll":b!=null&&zt("scroll",l);break;case"onScrollEnd":b!=null&&zt("scrollend",l);break;case"onClick":b!=null&&(l.onclick=$i);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!yr.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(N=m.endsWith("Capture"),u=m.slice(2,N?m.length-7:void 0),R=l[pe]||null,R=R!=null?R[m]:null,typeof R=="function"&&l.removeEventListener(u,R,N),typeof b=="function")){typeof R!="function"&&R!==null&&(m in l?l[m]=null:l.hasAttribute(m)&&l.removeAttribute(m)),l.addEventListener(u,b,N);break e}m in l?l[m]=b:b===!0?l.setAttribute(m,""):ks(l,m,b)}}}function Un(l,u,m){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zt("error",l),zt("load",l);var b=!1,N=!1,R;for(R in m)if(m.hasOwnProperty(R)){var W=m[R];if(W!=null)switch(R){case"src":b=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:cr(l,u,R,W,m,null)}}N&&cr(l,u,"srcSet",m.srcSet,m,null),b&&cr(l,u,"src",m.src,m,null);return;case"input":zt("invalid",l);var ce=R=W=N=null,ve=null,Te=null;for(b in m)if(m.hasOwnProperty(b)){var Ue=m[b];if(Ue!=null)switch(b){case"name":N=Ue;break;case"type":W=Ue;break;case"checked":ve=Ue;break;case"defaultChecked":Te=Ue;break;case"value":R=Ue;break;case"defaultValue":ce=Ue;break;case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(n(137,u));break;default:cr(l,u,b,Ue,m,null)}}WN(l,R,ce,ve,Te,W,N,!1);return;case"select":zt("invalid",l),b=W=R=null;for(N in m)if(m.hasOwnProperty(N)&&(ce=m[N],ce!=null))switch(N){case"value":R=ce;break;case"defaultValue":W=ce;break;case"multiple":b=ce;default:cr(l,u,N,ce,m,null)}u=R,m=W,l.multiple=!!b,u!=null?wu(l,!!b,u,!1):m!=null&&wu(l,!!b,m,!0);return;case"textarea":zt("invalid",l),R=N=b=null;for(W in m)if(m.hasOwnProperty(W)&&(ce=m[W],ce!=null))switch(W){case"value":b=ce;break;case"defaultValue":N=ce;break;case"children":R=ce;break;case"dangerouslySetInnerHTML":if(ce!=null)throw Error(n(91));break;default:cr(l,u,W,ce,m,null)}GN(l,b,N,R);return;case"option":for(ve in m)if(m.hasOwnProperty(ve)&&(b=m[ve],b!=null))switch(ve){case"selected":l.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:cr(l,u,ve,b,m,null)}return;case"dialog":zt("beforetoggle",l),zt("toggle",l),zt("cancel",l),zt("close",l);break;case"iframe":case"object":zt("load",l);break;case"video":case"audio":for(b=0;b<Qd.length;b++)zt(Qd[b],l);break;case"image":zt("error",l),zt("load",l);break;case"details":zt("toggle",l);break;case"embed":case"source":case"link":zt("error",l),zt("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Te in m)if(m.hasOwnProperty(Te)&&(b=m[Te],b!=null))switch(Te){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:cr(l,u,Te,b,m,null)}return;default:if(iy(u)){for(Ue in m)m.hasOwnProperty(Ue)&&(b=m[Ue],b!==void 0&&$v(l,u,Ue,b,m,void 0));return}}for(ce in m)m.hasOwnProperty(ce)&&(b=m[ce],b!=null&&cr(l,u,ce,b,m,null))}function Q9(l,u,m,b){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,R=null,W=null,ce=null,ve=null,Te=null,Ue=null;for(Ie in m){var Ve=m[Ie];if(m.hasOwnProperty(Ie)&&Ve!=null)switch(Ie){case"checked":break;case"value":break;case"defaultValue":ve=Ve;default:b.hasOwnProperty(Ie)||cr(l,u,Ie,null,b,Ve)}}for(var Oe in b){var Ie=b[Oe];if(Ve=m[Oe],b.hasOwnProperty(Oe)&&(Ie!=null||Ve!=null))switch(Oe){case"type":R=Ie;break;case"name":N=Ie;break;case"checked":Te=Ie;break;case"defaultChecked":Ue=Ie;break;case"value":W=Ie;break;case"defaultValue":ce=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(n(137,u));break;default:Ie!==Ve&&cr(l,u,Oe,Ie,b,Ve)}}sy(l,W,ce,ve,Te,Ue,R,N);return;case"select":Ie=W=ce=Oe=null;for(R in m)if(ve=m[R],m.hasOwnProperty(R)&&ve!=null)switch(R){case"value":break;case"multiple":Ie=ve;default:b.hasOwnProperty(R)||cr(l,u,R,null,b,ve)}for(N in b)if(R=b[N],ve=m[N],b.hasOwnProperty(N)&&(R!=null||ve!=null))switch(N){case"value":Oe=R;break;case"defaultValue":ce=R;break;case"multiple":W=R;default:R!==ve&&cr(l,u,N,R,b,ve)}u=ce,m=W,b=Ie,Oe!=null?wu(l,!!m,Oe,!1):!!b!=!!m&&(u!=null?wu(l,!!m,u,!0):wu(l,!!m,m?[]:"",!1));return;case"textarea":Ie=Oe=null;for(ce in m)if(N=m[ce],m.hasOwnProperty(ce)&&N!=null&&!b.hasOwnProperty(ce))switch(ce){case"value":break;case"children":break;default:cr(l,u,ce,null,b,N)}for(W in b)if(N=b[W],R=m[W],b.hasOwnProperty(W)&&(N!=null||R!=null))switch(W){case"value":Oe=N;break;case"defaultValue":Ie=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(n(91));break;default:N!==R&&cr(l,u,W,N,b,R)}$N(l,Oe,Ie);return;case"option":for(var ot in m)if(Oe=m[ot],m.hasOwnProperty(ot)&&Oe!=null&&!b.hasOwnProperty(ot))switch(ot){case"selected":l.selected=!1;break;default:cr(l,u,ot,null,b,Oe)}for(ve in b)if(Oe=b[ve],Ie=m[ve],b.hasOwnProperty(ve)&&Oe!==Ie&&(Oe!=null||Ie!=null))switch(ve){case"selected":l.selected=Oe&&typeof Oe!="function"&&typeof Oe!="symbol";break;default:cr(l,u,ve,Oe,b,Ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var gt in m)Oe=m[gt],m.hasOwnProperty(gt)&&Oe!=null&&!b.hasOwnProperty(gt)&&cr(l,u,gt,null,b,Oe);for(Te in b)if(Oe=b[Te],Ie=m[Te],b.hasOwnProperty(Te)&&Oe!==Ie&&(Oe!=null||Ie!=null))switch(Te){case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(n(137,u));break;default:cr(l,u,Te,Oe,b,Ie)}return;default:if(iy(u)){for(var ur in m)Oe=m[ur],m.hasOwnProperty(ur)&&Oe!==void 0&&!b.hasOwnProperty(ur)&&$v(l,u,ur,void 0,b,Oe);for(Ue in b)Oe=b[Ue],Ie=m[Ue],!b.hasOwnProperty(Ue)||Oe===Ie||Oe===void 0&&Ie===void 0||$v(l,u,Ue,Oe,b,Ie);return}}for(var Se in m)Oe=m[Se],m.hasOwnProperty(Se)&&Oe!=null&&!b.hasOwnProperty(Se)&&cr(l,u,Se,null,b,Oe);for(Ve in b)Oe=b[Ve],Ie=m[Ve],!b.hasOwnProperty(Ve)||Oe===Ie||Oe==null&&Ie==null||cr(l,u,Ve,Oe,b,Ie)}function YA(l){switch(l){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function e7(){if(typeof performance.getEntriesByType=="function"){for(var l=0,u=0,m=performance.getEntriesByType("resource"),b=0;b<m.length;b++){var N=m[b],R=N.transferSize,W=N.initiatorType,ce=N.duration;if(R&&ce&&YA(W)){for(W=0,ce=N.responseEnd,b+=1;b<m.length;b++){var ve=m[b],Te=ve.startTime;if(Te>ce)break;var Ue=ve.transferSize,Ve=ve.initiatorType;Ue&&YA(Ve)&&(ve=ve.responseEnd,W+=Ue*(ve<ce?1:(ce-Te)/(ve-Te)))}if(--b,u+=8*(R+W)/(N.duration/1e3),l++,10<l)break}}if(0<l)return u/l/1e6}return navigator.connection&&(l=navigator.connection.downlink,typeof l=="number")?l:5}var Gv=null,Kv=null;function xm(l){return l.nodeType===9?l:l.ownerDocument}function JA(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ZA(l,u){if(l===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&u==="foreignObject"?0:l}function Xv(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Yv=null;function t7(){var l=window.event;return l&&l.type==="popstate"?l===Yv?!1:(Yv=l,!0):(Yv=null,!1)}var QA=typeof setTimeout=="function"?setTimeout:void 0,r7=typeof clearTimeout=="function"?clearTimeout:void 0,eC=typeof Promise=="function"?Promise:void 0,n7=typeof queueMicrotask=="function"?queueMicrotask:typeof eC<"u"?function(l){return eC.resolve(null).then(l).catch(s7)}:QA;function s7(l){setTimeout(function(){throw l})}function cl(l){return l==="head"}function tC(l,u){var m=u,b=0;do{var N=m.nextSibling;if(l.removeChild(m),N&&N.nodeType===8)if(m=N.data,m==="/$"||m==="/&"){if(b===0){l.removeChild(N),Qu(u);return}b--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")b++;else if(m==="html")th(l.ownerDocument.documentElement);else if(m==="head"){m=l.ownerDocument.head,th(m);for(var R=m.firstChild;R;){var W=R.nextSibling,ce=R.nodeName;R[je]||ce==="SCRIPT"||ce==="STYLE"||ce==="LINK"&&R.rel.toLowerCase()==="stylesheet"||m.removeChild(R),R=W}}else m==="body"&&th(l.ownerDocument.body);m=N}while(m);Qu(u)}function rC(l,u){var m=l;l=0;do{var b=m.nextSibling;if(m.nodeType===1?u?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(u?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),b&&b.nodeType===8)if(m=b.data,m==="/$"){if(l===0)break;l--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||l++;m=b}while(m)}function Jv(l){var u=l.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var m=u;switch(u=u.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Jv(m),Xe(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}l.removeChild(m)}}function a7(l,u,m,b){for(;l.nodeType===1;){var N=m;if(l.nodeName.toLowerCase()!==u.toLowerCase()){if(!b&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(b){if(!l[je])switch(u){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(R=l.getAttribute("rel"),R==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(R!==N.rel||l.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||l.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||l.getAttribute("title")!==(N.title==null?null:N.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(R=l.getAttribute("src"),(R!==(N.src==null?null:N.src)||l.getAttribute("type")!==(N.type==null?null:N.type)||l.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&R&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(u==="input"&&l.type==="hidden"){var R=N.name==null?null:""+N.name;if(N.type==="hidden"&&l.getAttribute("name")===R)return l}else return l;if(l=_a(l.nextSibling),l===null)break}return null}function i7(l,u,m){if(u==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!m||(l=_a(l.nextSibling),l===null))return null;return l}function nC(l,u){for(;l.nodeType!==8;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!u||(l=_a(l.nextSibling),l===null))return null;return l}function Zv(l){return l.data==="$?"||l.data==="$~"}function Qv(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState!=="loading"}function o7(l,u){var m=l.ownerDocument;if(l.data==="$~")l._reactRetry=u;else if(l.data!=="$?"||m.readyState!=="loading")u();else{var b=function(){u(),m.removeEventListener("DOMContentLoaded",b)};m.addEventListener("DOMContentLoaded",b),l._reactRetry=b}}function _a(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return l}var eb=null;function sC(l){l=l.nextSibling;for(var u=0;l;){if(l.nodeType===8){var m=l.data;if(m==="/$"||m==="/&"){if(u===0)return _a(l.nextSibling);u--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||u++}l=l.nextSibling}return null}function aC(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(u===0)return l;u--}else m!=="/$"&&m!=="/&"||u++}l=l.previousSibling}return null}function iC(l,u,m){switch(u=xm(m),l){case"html":if(l=u.documentElement,!l)throw Error(n(452));return l;case"head":if(l=u.head,!l)throw Error(n(453));return l;case"body":if(l=u.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function th(l){for(var u=l.attributes;u.length;)l.removeAttributeNode(u[0]);Xe(l)}var Ea=new Map,oC=new Set;function gm(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var lo=te.d;te.d={f:l7,r:c7,D:u7,C:f7,L:d7,m:h7,X:m7,S:p7,M:x7};function l7(){var l=lo.f(),u=lm();return l||u}function c7(l){var u=st(l);u!==null&&u.tag===5&&u.type==="form"?Sk(u):lo.r(l)}var Yu=typeof document>"u"?null:document;function lC(l,u,m){var b=Yu;if(b&&typeof u=="string"&&u){var N=ma(u);N='link[rel="'+l+'"][href="'+N+'"]',typeof m=="string"&&(N+='[crossorigin="'+m+'"]'),oC.has(N)||(oC.add(N),l={rel:l,crossOrigin:m,href:u},b.querySelector(N)===null&&(u=b.createElement("link"),Un(u,"link",l),ct(u),b.head.appendChild(u)))}}function u7(l){lo.D(l),lC("dns-prefetch",l,null)}function f7(l,u){lo.C(l,u),lC("preconnect",l,u)}function d7(l,u,m){lo.L(l,u,m);var b=Yu;if(b&&l&&u){var N='link[rel="preload"][as="'+ma(u)+'"]';u==="image"&&m&&m.imageSrcSet?(N+='[imagesrcset="'+ma(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(N+='[imagesizes="'+ma(m.imageSizes)+'"]')):N+='[href="'+ma(l)+'"]';var R=N;switch(u){case"style":R=Ju(l);break;case"script":R=Zu(l)}Ea.has(R)||(l=p({rel:"preload",href:u==="image"&&m&&m.imageSrcSet?void 0:l,as:u},m),Ea.set(R,l),b.querySelector(N)!==null||u==="style"&&b.querySelector(rh(R))||u==="script"&&b.querySelector(nh(R))||(u=b.createElement("link"),Un(u,"link",l),ct(u),b.head.appendChild(u)))}}function h7(l,u){lo.m(l,u);var m=Yu;if(m&&l){var b=u&&typeof u.as=="string"?u.as:"script",N='link[rel="modulepreload"][as="'+ma(b)+'"][href="'+ma(l)+'"]',R=N;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":R=Zu(l)}if(!Ea.has(R)&&(l=p({rel:"modulepreload",href:l},u),Ea.set(R,l),m.querySelector(N)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(nh(R)))return}b=m.createElement("link"),Un(b,"link",l),ct(b),m.head.appendChild(b)}}}function p7(l,u,m){lo.S(l,u,m);var b=Yu;if(b&&l){var N=tt(b).hoistableStyles,R=Ju(l);u=u||"default";var W=N.get(R);if(!W){var ce={loading:0,preload:null};if(W=b.querySelector(rh(R)))ce.loading=5;else{l=p({rel:"stylesheet",href:l,"data-precedence":u},m),(m=Ea.get(R))&&tb(l,m);var ve=W=b.createElement("link");ct(ve),Un(ve,"link",l),ve._p=new Promise(function(Te,Ue){ve.onload=Te,ve.onerror=Ue}),ve.addEventListener("load",function(){ce.loading|=1}),ve.addEventListener("error",function(){ce.loading|=2}),ce.loading|=4,ym(W,u,b)}W={type:"stylesheet",instance:W,count:1,state:ce},N.set(R,W)}}}function m7(l,u){lo.X(l,u);var m=Yu;if(m&&l){var b=tt(m).hoistableScripts,N=Zu(l),R=b.get(N);R||(R=m.querySelector(nh(N)),R||(l=p({src:l,async:!0},u),(u=Ea.get(N))&&rb(l,u),R=m.createElement("script"),ct(R),Un(R,"link",l),m.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},b.set(N,R))}}function x7(l,u){lo.M(l,u);var m=Yu;if(m&&l){var b=tt(m).hoistableScripts,N=Zu(l),R=b.get(N);R||(R=m.querySelector(nh(N)),R||(l=p({src:l,async:!0,type:"module"},u),(u=Ea.get(N))&&rb(l,u),R=m.createElement("script"),ct(R),Un(R,"link",l),m.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},b.set(N,R))}}function cC(l,u,m,b){var N=(N=re.current)?gm(N):null;if(!N)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(u=Ju(m.href),m=tt(N).hoistableStyles,b=m.get(u),b||(b={type:"style",instance:null,count:0,state:null},m.set(u,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){l=Ju(m.href);var R=tt(N).hoistableStyles,W=R.get(l);if(W||(N=N.ownerDocument||N,W={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},R.set(l,W),(R=N.querySelector(rh(l)))&&!R._p&&(W.instance=R,W.state.loading=5),Ea.has(l)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Ea.set(l,m),R||g7(N,l,m,W.state))),u&&b===null)throw Error(n(528,""));return W}if(u&&b!==null)throw Error(n(529,""));return null;case"script":return u=m.async,m=m.src,typeof m=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Zu(m),m=tt(N).hoistableScripts,b=m.get(u),b||(b={type:"script",instance:null,count:0,state:null},m.set(u,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function Ju(l){return'href="'+ma(l)+'"'}function rh(l){return'link[rel="stylesheet"]['+l+"]"}function uC(l){return p({},l,{"data-precedence":l.precedence,precedence:null})}function g7(l,u,m,b){l.querySelector('link[rel="preload"][as="style"]['+u+"]")?b.loading=1:(u=l.createElement("link"),b.preload=u,u.addEventListener("load",function(){return b.loading|=1}),u.addEventListener("error",function(){return b.loading|=2}),Un(u,"link",m),ct(u),l.head.appendChild(u))}function Zu(l){return'[src="'+ma(l)+'"]'}function nh(l){return"script[async]"+l}function fC(l,u,m){if(u.count++,u.instance===null)switch(u.type){case"style":var b=l.querySelector('style[data-href~="'+ma(m.href)+'"]');if(b)return u.instance=b,ct(b),b;var N=p({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return b=(l.ownerDocument||l).createElement("style"),ct(b),Un(b,"style",N),ym(b,m.precedence,l),u.instance=b;case"stylesheet":N=Ju(m.href);var R=l.querySelector(rh(N));if(R)return u.state.loading|=4,u.instance=R,ct(R),R;b=uC(m),(N=Ea.get(N))&&tb(b,N),R=(l.ownerDocument||l).createElement("link"),ct(R);var W=R;return W._p=new Promise(function(ce,ve){W.onload=ce,W.onerror=ve}),Un(R,"link",b),u.state.loading|=4,ym(R,m.precedence,l),u.instance=R;case"script":return R=Zu(m.src),(N=l.querySelector(nh(R)))?(u.instance=N,ct(N),N):(b=m,(N=Ea.get(R))&&(b=p({},m),rb(b,N)),l=l.ownerDocument||l,N=l.createElement("script"),ct(N),Un(N,"link",b),l.head.appendChild(N),u.instance=N);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(b=u.instance,u.state.loading|=4,ym(b,m.precedence,l));return u.instance}function ym(l,u,m){for(var b=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=b.length?b[b.length-1]:null,R=N,W=0;W<b.length;W++){var ce=b[W];if(ce.dataset.precedence===u)R=ce;else if(R!==N)break}R?R.parentNode.insertBefore(l,R.nextSibling):(u=m.nodeType===9?m.head:m,u.insertBefore(l,u.firstChild))}function tb(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.title==null&&(l.title=u.title)}function rb(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.integrity==null&&(l.integrity=u.integrity)}var vm=null;function dC(l,u,m){if(vm===null){var b=new Map,N=vm=new Map;N.set(m,b)}else N=vm,b=N.get(m),b||(b=new Map,N.set(m,b));if(b.has(l))return b;for(b.set(l,null),m=m.getElementsByTagName(l),N=0;N<m.length;N++){var R=m[N];if(!(R[je]||R[de]||l==="link"&&R.getAttribute("rel")==="stylesheet")&&R.namespaceURI!=="http://www.w3.org/2000/svg"){var W=R.getAttribute(u)||"";W=l+W;var ce=b.get(W);ce?ce.push(R):b.set(W,[R])}}return b}function hC(l,u,m){l=l.ownerDocument||l,l.head.insertBefore(m,u==="title"?l.querySelector("head > title"):null)}function y7(l,u,m){if(m===1||u.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return l=u.disabled,typeof u.precedence=="string"&&l==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function pC(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}function v7(l,u,m,b){if(m.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var N=Ju(b.href),R=u.querySelector(rh(N));if(R){u=R._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(l.count++,l=bm.bind(l),u.then(l,l)),m.state.loading|=4,m.instance=R,ct(R);return}R=u.ownerDocument||u,b=uC(b),(N=Ea.get(N))&&tb(b,N),R=R.createElement("link"),ct(R);var W=R;W._p=new Promise(function(ce,ve){W.onload=ce,W.onerror=ve}),Un(R,"link",b),m.instance=R}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(m,u),(u=m.state.preload)&&(m.state.loading&3)===0&&(l.count++,m=bm.bind(l),u.addEventListener("load",m),u.addEventListener("error",m))}}var nb=0;function b7(l,u){return l.stylesheets&&l.count===0&&_m(l,l.stylesheets),0<l.count||0<l.imgCount?function(m){var b=setTimeout(function(){if(l.stylesheets&&_m(l,l.stylesheets),l.unsuspend){var R=l.unsuspend;l.unsuspend=null,R()}},6e4+u);0<l.imgBytes&&nb===0&&(nb=62500*e7());var N=setTimeout(function(){if(l.waitingForImages=!1,l.count===0&&(l.stylesheets&&_m(l,l.stylesheets),l.unsuspend)){var R=l.unsuspend;l.unsuspend=null,R()}},(l.imgBytes>nb?50:800)+u);return l.unsuspend=m,function(){l.unsuspend=null,clearTimeout(b),clearTimeout(N)}}:null}function bm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)_m(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var wm=null;function _m(l,u){l.stylesheets=null,l.unsuspend!==null&&(l.count++,wm=new Map,u.forEach(w7,l),wm=null,bm.call(l))}function w7(l,u){if(!(u.state.loading&4)){var m=wm.get(l);if(m)var b=m.get(null);else{m=new Map,wm.set(l,m);for(var N=l.querySelectorAll("link[data-precedence],style[data-precedence]"),R=0;R<N.length;R++){var W=N[R];(W.nodeName==="LINK"||W.getAttribute("media")!=="not all")&&(m.set(W.dataset.precedence,W),b=W)}b&&m.set(null,b)}N=u.instance,W=N.getAttribute("data-precedence"),R=m.get(W)||b,R===b&&m.set(null,N),m.set(W,N),this.count++,b=bm.bind(this),N.addEventListener("load",b),N.addEventListener("error",b),R?R.parentNode.insertBefore(N,R.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(N,l.firstChild)),u.state.loading|=4}}var sh={$$typeof:E,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function _7(l,u,m,b,N,R,W,ce,ve){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=mi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mi(0),this.hiddenUpdates=mi(null),this.identifierPrefix=b,this.onUncaughtError=N,this.onCaughtError=R,this.onRecoverableError=W,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ve,this.incompleteTransitions=new Map}function mC(l,u,m,b,N,R,W,ce,ve,Te,Ue,Ve){return l=new _7(l,u,m,W,ve,Te,Ue,Ve,ce),u=1,R===!0&&(u|=24),R=Gs(3,null,null,u),l.current=R,R.stateNode=l,u=Fy(),u.refCount++,l.pooledCache=u,u.refCount++,R.memoizedState={element:b,isDehydrated:m,cache:u},Uy(R),l}function xC(l){return l?(l=Cu,l):Cu}function gC(l,u,m,b,N,R){N=xC(N),b.context===null?b.context=N:b.pendingContext=N,b=Zo(u),b.payload={element:m},R=R===void 0?null:R,R!==null&&(b.callback=R),m=Qo(l,b,u),m!==null&&(Ds(m,l,u),Fd(m,l,u))}function yC(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<u?m:u}}function sb(l,u){yC(l,u),(l=l.alternate)&&yC(l,u)}function vC(l){if(l.tag===13||l.tag===31){var u=ac(l,67108864);u!==null&&Ds(u,l,67108864),sb(l,67108864)}}function bC(l){if(l.tag===13||l.tag===31){var u=Zs();u=qo(u);var m=ac(l,u);m!==null&&Ds(m,l,u),sb(l,u)}}var Em=!0;function E7(l,u,m,b){var N=ee.T;ee.T=null;var R=te.p;try{te.p=2,ab(l,u,m,b)}finally{te.p=R,ee.T=N}}function S7(l,u,m,b){var N=ee.T;ee.T=null;var R=te.p;try{te.p=8,ab(l,u,m,b)}finally{te.p=R,ee.T=N}}function ab(l,u,m,b){if(Em){var N=ib(b);if(N===null)Wv(l,u,b,Sm,m),_C(l,b);else if(T7(N,l,u,m,b))b.stopPropagation();else if(_C(l,b),u&4&&-1<N7.indexOf(l)){for(;N!==null;){var R=st(N);if(R!==null)switch(R.tag){case 3:if(R=R.stateNode,R.current.memoizedState.isDehydrated){var W=nn(R.pendingLanes);if(W!==0){var ce=R;for(ce.pendingLanes|=2,ce.entangledLanes|=2;W;){var ve=1<<31-or(W);ce.entanglements[1]|=ve,W&=~ve}bi(R),(Jt&6)===0&&(im=De()+500,Zd(0))}}break;case 31:case 13:ce=ac(R,2),ce!==null&&Ds(ce,R,2),lm(),sb(R,2)}if(R=ib(b),R===null&&Wv(l,u,b,Sm,m),R===N)break;N=R}N!==null&&b.stopPropagation()}else Wv(l,u,b,null,m)}}function ib(l){return l=ly(l),ob(l)}var Sm=null;function ob(l){if(Sm=null,l=Ze(l),l!==null){var u=a(l);if(u===null)l=null;else{var m=u.tag;if(m===13){if(l=i(u),l!==null)return l;l=null}else if(m===31){if(l=o(u),l!==null)return l;l=null}else if(m===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null)}}return Sm=l,null}function wC(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fe()){case $e:return 2;case rt:return 8;case at:case qt:return 32;case dt:return 268435456;default:return 32}default:return 32}}var lb=!1,ul=null,fl=null,dl=null,ah=new Map,ih=new Map,hl=[],N7="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _C(l,u){switch(l){case"focusin":case"focusout":ul=null;break;case"dragenter":case"dragleave":fl=null;break;case"mouseover":case"mouseout":dl=null;break;case"pointerover":case"pointerout":ah.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":ih.delete(u.pointerId)}}function oh(l,u,m,b,N,R){return l===null||l.nativeEvent!==R?(l={blockedOn:u,domEventName:m,eventSystemFlags:b,nativeEvent:R,targetContainers:[N]},u!==null&&(u=st(u),u!==null&&vC(u)),l):(l.eventSystemFlags|=b,u=l.targetContainers,N!==null&&u.indexOf(N)===-1&&u.push(N),l)}function T7(l,u,m,b,N){switch(u){case"focusin":return ul=oh(ul,l,u,m,b,N),!0;case"dragenter":return fl=oh(fl,l,u,m,b,N),!0;case"mouseover":return dl=oh(dl,l,u,m,b,N),!0;case"pointerover":var R=N.pointerId;return ah.set(R,oh(ah.get(R)||null,l,u,m,b,N)),!0;case"gotpointercapture":return R=N.pointerId,ih.set(R,oh(ih.get(R)||null,l,u,m,b,N)),!0}return!1}function EC(l){var u=Ze(l.target);if(u!==null){var m=a(u);if(m!==null){if(u=m.tag,u===13){if(u=i(m),u!==null){l.blockedOn=u,xe(l.priority,function(){bC(m)});return}}else if(u===31){if(u=o(m),u!==null){l.blockedOn=u,xe(l.priority,function(){bC(m)});return}}else if(u===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Nm(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var m=ib(l.nativeEvent);if(m===null){m=l.nativeEvent;var b=new m.constructor(m.type,m);oy=b,m.target.dispatchEvent(b),oy=null}else return u=st(m),u!==null&&vC(u),l.blockedOn=m,!1;u.shift()}return!0}function SC(l,u,m){Nm(l)&&m.delete(u)}function k7(){lb=!1,ul!==null&&Nm(ul)&&(ul=null),fl!==null&&Nm(fl)&&(fl=null),dl!==null&&Nm(dl)&&(dl=null),ah.forEach(SC),ih.forEach(SC)}function Tm(l,u){l.blockedOn===u&&(l.blockedOn=null,lb||(lb=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,k7)))}var km=null;function NC(l){km!==l&&(km=l,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){km===l&&(km=null);for(var u=0;u<l.length;u+=3){var m=l[u],b=l[u+1],N=l[u+2];if(typeof b!="function"){if(ob(b||m)===null)continue;break}var R=st(m);R!==null&&(l.splice(u,3),u-=3,iv(R,{pending:!0,data:N,method:m.method,action:b},b,N))}}))}function Qu(l){function u(ve){return Tm(ve,l)}ul!==null&&Tm(ul,l),fl!==null&&Tm(fl,l),dl!==null&&Tm(dl,l),ah.forEach(u),ih.forEach(u);for(var m=0;m<hl.length;m++){var b=hl[m];b.blockedOn===l&&(b.blockedOn=null)}for(;0<hl.length&&(m=hl[0],m.blockedOn===null);)EC(m),m.blockedOn===null&&hl.shift();if(m=(l.ownerDocument||l).$$reactFormReplay,m!=null)for(b=0;b<m.length;b+=3){var N=m[b],R=m[b+1],W=N[pe]||null;if(typeof R=="function")W||NC(m);else if(W){var ce=null;if(R&&R.hasAttribute("formAction")){if(N=R,W=R[pe]||null)ce=W.formAction;else if(ob(N)!==null)continue}else ce=W.action;typeof ce=="function"?m[b+1]=ce:(m.splice(b,3),b-=3),NC(m)}}}function TC(){function l(R){R.canIntercept&&R.info==="react-transition"&&R.intercept({handler:function(){return new Promise(function(W){return N=W})},focusReset:"manual",scroll:"manual"})}function u(){N!==null&&(N(),N=null),b||setTimeout(m,20)}function m(){if(!b&&!navigation.transition){var R=navigation.currentEntry;R&&R.url!=null&&navigation.navigate(R.url,{state:R.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var b=!1,N=null;return navigation.addEventListener("navigate",l),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(m,100),function(){b=!0,navigation.removeEventListener("navigate",l),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),N!==null&&(N(),N=null)}}}function cb(l){this._internalRoot=l}Am.prototype.render=cb.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(n(409));var m=u.current,b=Zs();gC(m,b,l,u,null,null)},Am.prototype.unmount=cb.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;gC(l.current,2,null,l,null,null),lm(),u[ge]=null}};function Am(l){this._internalRoot=l}Am.prototype.unstable_scheduleHydration=function(l){if(l){var u=oe();l={blockedOn:null,target:l,priority:u};for(var m=0;m<hl.length&&u!==0&&u<hl[m].priority;m++);hl.splice(m,0,l),m===0&&EC(l)}};var kC=t.version;if(kC!=="19.2.4")throw Error(n(527,kC,"19.2.4"));te.findDOMNode=function(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=f(u),l=l!==null?h(l):null,l=l===null?null:l.stateNode,l};var A7={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cm.isDisabled&&Cm.supportsFiber)try{vt=Cm.inject(A7),ir=Cm}catch{}}return ch.createRoot=function(l,u){if(!s(l))throw Error(n(299));var m=!1,b="",N=Ik,R=Mk,W=Fk;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onUncaughtError!==void 0&&(N=u.onUncaughtError),u.onCaughtError!==void 0&&(R=u.onCaughtError),u.onRecoverableError!==void 0&&(W=u.onRecoverableError)),u=mC(l,1,!1,null,null,m,b,null,N,R,W,TC),l[ge]=u.current,qv(l),new cb(u)},ch.hydrateRoot=function(l,u,m){if(!s(l))throw Error(n(299));var b=!1,N="",R=Ik,W=Mk,ce=Fk,ve=null;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(N=m.identifierPrefix),m.onUncaughtError!==void 0&&(R=m.onUncaughtError),m.onCaughtError!==void 0&&(W=m.onCaughtError),m.onRecoverableError!==void 0&&(ce=m.onRecoverableError),m.formState!==void 0&&(ve=m.formState)),u=mC(l,1,!0,u,m??null,b,N,ve,R,W,ce,TC),u.context=xC(null),m=u.current,b=Zs(),b=qo(b),N=Zo(b),N.callback=null,Qo(m,N,b),m=b,u.current.lanes=m,br(u,m),bi(u),l[ge]=u.current,qv(l),new Am(u)},ch.version="19.2.4",ch}var PC;function P7(){if(PC)return db.exports;PC=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),db.exports=F7(),db.exports}var L7=P7();const B7=SE(L7),U7="Logging",z7="NoHubcallbackProvidedException";var ea;(function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"})(ea||(ea={}));const LC={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class ia{constructor(t,r=ea.WARN){this.name=t,this.level=r,this._pluggables=[]}_padding(t){return t<10?"0"+t:""+t}_ts(){const t=new Date;return[this._padding(t.getMinutes()),this._padding(t.getSeconds())].join(":")+"."+t.getMilliseconds()}configure(t){return t?(this._config=t,this._config):this._config}_log(t,...r){let n=this.level;ia.LOG_LEVEL&&(n=ia.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(n=window.LOG_LEVEL);const s=LC[n];if(!(LC[t]>=s))return;let i=console.log.bind(console);t===ea.ERROR&&console.error&&(i=console.error.bind(console)),t===ea.WARN&&console.warn&&(i=console.warn.bind(console)),ia.BIND_ALL_LOG_LEVELS&&(t===ea.INFO&&console.info&&(i=console.info.bind(console)),t===ea.DEBUG&&console.debug&&(i=console.debug.bind(console)));const o=`[${t}] ${this._ts()} ${this.name}`;let c="";if(r.length===1&&typeof r[0]=="string")c=`${o} - ${r[0]}`,i(c);else if(r.length===1)c=`${o} ${r[0]}`,i(o,r[0]);else if(typeof r[0]=="string"){let f=r.slice(1);f.length===1&&(f=f[0]),c=`${o} - ${r[0]} ${f}`,i(`${o} - ${r[0]}`,f)}else c=`${o} ${r}`,i(o,r);for(const f of this._pluggables){const h={message:c,timestamp:Date.now()};f.pushLogs([h])}}log(...t){this._log(ea.INFO,...t)}info(...t){this._log(ea.INFO,...t)}warn(...t){this._log(ea.WARN,...t)}error(...t){this._log(ea.ERROR,...t)}debug(...t){this._log(ea.DEBUG,...t)}verbose(...t){this._log(ea.VERBOSE,...t)}addPluggable(t){t&&t.getCategoryName()===U7&&(this._pluggables.push(t),t.configure(this._config))}listPluggables(){return this._pluggables}}ia.LOG_LEVEL=null;ia.BIND_ALL_LOG_LEVELS=!1;class zs extends Error{constructor({message:t,name:r,recoverySuggestion:n,underlyingError:s,metadata:a}){if(super(t),this.name=r,this.underlyingError=s,this.recoverySuggestion=n,a){const{extendedRequestId:i,httpStatusCode:o,requestId:c}=a;this.metadata={extendedRequestId:i,httpStatusCode:o,requestId:c}}this.constructor=zs,Object.setPrototypeOf(this,zs.prototype)}}var qc;(function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"})(qc||(qc={}));const NE=(e,t=zs)=>(r,n,s)=>{const{message:a,recoverySuggestion:i}=e[n];if(!r)throw new t({name:n,message:s?`${a} ${s}`:a,recoverySuggestion:i})},Wc=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",uh=new ia("Hub");class Dj{constructor(t){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}_remove(t,r){const n=this.listeners.get(t);if(!n){uh.warn(`No listeners for ${t}`);return}this.listeners.set(t,[...n.filter(({callback:s})=>s!==r)])}dispatch(t,r,n,s){typeof t=="string"&&this.protectedChannels.indexOf(t)>-1&&(s===Wc||uh.warn(`WARNING: ${t} is protected and dispatching on it can have unintended consequences`));const a={channel:t,payload:{...r},source:n,patternInfo:[]};try{this._toListeners(a)}catch(i){uh.error(i)}}listen(t,r,n="noname"){let s;if(typeof r!="function")throw new zs({name:z7,message:"No callback supplied to Hub"});s=r;let a=this.listeners.get(t);return a||(a=[],this.listeners.set(t,a)),a.push({name:n,callback:s}),()=>{this._remove(t,s)}}_toListeners(t){const{channel:r,payload:n}=t,s=this.listeners.get(r);s&&s.forEach(a=>{uh.debug(`Dispatching to ${r} with `,n);try{a.callback(t)}catch(i){uh.error(i)}})}}const Nf=new Dj("__default__"),Ux=new Dj("internal-hub"),H7=()=>{if(typeof window=="object"&&typeof window.crypto=="object")return window.crypto;if(typeof crypto=="object")return crypto;throw new zs({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},V7=()=>{if(typeof window<"u"&&typeof window.btoa=="function")return window.btoa;if(typeof btoa=="function")return btoa;throw new zs({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})},q7=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new zs({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},TE={convert(e,t){let r=e;return t!=null&&t.urlSafe&&(r=r.replace(/-/g,"+").replace(/_/g,"/")),q7()(r)}};var Ii;(function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"})(Ii||(Ii={}));const W7={[Ii.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[Ii.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[Ii.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[Ii.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[Ii.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},kE=NE(W7);function Zt(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,kE(t,Ii.AuthUserPoolException)}function Ij(e){var r,n,s,a,i,o,c,f;const t=!!((n=(r=e==null?void 0:e.loginWith)==null?void 0:r.oauth)!=null&&n.domain)&&!!((a=(s=e==null?void 0:e.loginWith)==null?void 0:s.oauth)!=null&&a.redirectSignOut)&&!!((o=(i=e==null?void 0:e.loginWith)==null?void 0:i.oauth)!=null&&o.redirectSignIn)&&!!((f=(c=e==null?void 0:e.loginWith)==null?void 0:c.oauth)!=null&&f.responseType);kE(t,Ii.OAuthNotConfigureException)}function _x(e){const t=!!(e!=null&&e.identityPoolId);kE(t,Ii.InvalidIdentityPoolIdException)}function $c(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(TE.convert(n).split("").map(i=>`%${`00${i.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),a=JSON.parse(s);return{toString:()=>e,payload:a}}catch{throw new Error("Invalid token payload")}}const Mj=e=>{const t=Reflect.ownKeys(e);for(const r of t){const n=e[r];(n&&typeof n=="object"||typeof n=="function")&&Mj(n)}return Object.freeze(e)},$7=new ia("parseAWSExports"),G7={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},K7=(e={})=>{var G,Z,re,L,I,se;if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new zs({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:r,aws_appsync_graphqlEndpoint:n,aws_appsync_region:s,aws_bots_config:a,aws_cognito_identity_pool_id:i,aws_cognito_sign_up_verification_method:o,aws_cognito_mfa_configuration:c,aws_cognito_mfa_types:f,aws_cognito_password_protection_settings:h,aws_cognito_verification_mechanisms:p,aws_cognito_signup_attributes:x,aws_cognito_social_providers:g,aws_cognito_username_attributes:v,aws_mandatory_sign_in:y,aws_mobile_analytics_app_id:w,aws_mobile_analytics_app_region:_,aws_user_files_s3_bucket:S,aws_user_files_s3_bucket_region:E,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:T,aws_user_pools_id:k,aws_user_pools_web_client_id:D,geo:O,oauth:z,predictions:j,aws_cloud_logic_custom:J,Notifications:ae,modelIntrospection:F}=e,X={};w&&(X.Analytics={Pinpoint:{appId:w,region:_}});const{InAppMessaging:P,Push:le}=ae??{};if(P!=null&&P.AWSPinpoint||le!=null&&le.AWSPinpoint){if(P!=null&&P.AWSPinpoint){const{appId:Q,region:Y}=P.AWSPinpoint;X.Notifications={InAppMessaging:{Pinpoint:{appId:Q,region:Y}}}}if(le!=null&&le.AWSPinpoint){const{appId:Q,region:Y}=le.AWSPinpoint;X.Notifications={...X.Notifications,PushNotification:{Pinpoint:{appId:Q,region:Y}}}}}if(Array.isArray(a)&&(X.Interactions={LexV1:Object.fromEntries(a.map(Q=>[Q.name,Q]))}),n){const Q=G7[r];Q||$7.debug(`Invalid authentication type ${r}. Falling back to IAM.`),X.API={GraphQL:{endpoint:n,apiKey:t,region:s,defaultAuthMode:Q??"iam"}},F&&(X.API.GraphQL.modelIntrospection=F)}const ee=c?{status:c&&c.toLowerCase(),totpEnabled:(f==null?void 0:f.includes("TOTP"))??!1,smsEnabled:(f==null?void 0:f.includes("SMS"))??!1}:void 0,te=h?{minLength:h.passwordPolicyMinLength,requireLowercase:((G=h.passwordPolicyCharacters)==null?void 0:G.includes("REQUIRES_LOWERCASE"))??!1,requireUppercase:((Z=h.passwordPolicyCharacters)==null?void 0:Z.includes("REQUIRES_UPPERCASE"))??!1,requireNumbers:((re=h.passwordPolicyCharacters)==null?void 0:re.includes("REQUIRES_NUMBERS"))??!1,requireSpecialCharacters:((L=h.passwordPolicyCharacters)==null?void 0:L.includes("REQUIRES_SYMBOLS"))??!1}:void 0,ie=Array.from(new Set([...p??[],...x??[]])).reduce((Q,Y)=>({...Q,[Y.toLowerCase()]:{required:!0}}),{}),Ee=(v==null?void 0:v.includes("EMAIL"))??!1,K=(v==null?void 0:v.includes("PHONE_NUMBER"))??!1;(i||k)&&(X.Auth={Cognito:{identityPoolId:i,allowGuestAccess:y!=="enable",signUpVerificationMethod:o,userAttributes:ie,userPoolClientId:D,userPoolId:k,mfa:ee,passwordFormat:te,loginWith:{username:!(Ee||K),email:Ee,phone:K}}});const M=z?Object.keys(z).length>0:!1,q=g?g.length>0:!1;if(X.Auth&&M&&(X.Auth.Cognito.loginWith={...X.Auth.Cognito.loginWith,oauth:{...X7(z),...q&&{providers:Y7(g)}}}),S&&(X.Storage={S3:{bucket:S,region:E,dangerouslyConnectToHttpEndpointForTesting:T}}),O){const{amazon_location_service:Q}=O;X.Geo={LocationService:{maps:Q.maps,geofenceCollections:Q.geofenceCollections,searchIndices:Q.search_indices,region:Q.region}}}if(J&&(X.API={...X.API,REST:J.reduce((Q,Y)=>{const{name:U,endpoint:we,region:B,service:be}=Y;return{...Q,[U]:{endpoint:we,...be?{service:be}:void 0,...B?{region:B}:void 0}}},{})}),j){const{VoiceId:Q}=((se=(I=j==null?void 0:j.convert)==null?void 0:I.speechGenerator)==null?void 0:se.defaults)??{};X.Predictions=Q?{...j,convert:{...j.convert,speechGenerator:{...j.convert.speechGenerator,defaults:{voiceId:Q}}}}:j}return X},BC=e=>(e==null?void 0:e.split(","))??[],X7=({domain:e,scope:t,redirectSignIn:r,redirectSignOut:n,responseType:s})=>({domain:e,scopes:t,redirectSignIn:BC(r),redirectSignOut:BC(n),responseType:s}),Y7=e=>e.map(t=>{const r=t.toLowerCase();return r.charAt(0).toUpperCase()+r.slice(1)}),J7=Symbol("oauth-listener"),zn=[];for(let e=0;e<256;++e)zn.push((e+256).toString(16).slice(1));function Z7(e,t=0){return(zn[e[t+0]]+zn[e[t+1]]+zn[e[t+2]]+zn[e[t+3]]+"-"+zn[e[t+4]]+zn[e[t+5]]+"-"+zn[e[t+6]]+zn[e[t+7]]+"-"+zn[e[t+8]]+zn[e[t+9]]+"-"+zn[e[t+10]]+zn[e[t+11]]+zn[e[t+12]]+zn[e[t+13]]+zn[e[t+14]]+zn[e[t+15]]).toLowerCase()}let xb;const Q7=new Uint8Array(16);function eU(){if(!xb){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");xb=crypto.getRandomValues.bind(crypto)}return xb(Q7)}const tU=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),UC={randomUUID:tU};function rU(e,t,r){var s;if(UC.randomUUID&&!t&&!e)return UC.randomUUID();e=e||{};const n=e.random??((s=e.rng)==null?void 0:s.call(e))??eU();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){if(r=r||0,r<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let a=0;a<16;++a)t[r+a]=n[a];return t}return Z7(n)}function nU(e){const{version:t}=e;return t?t.startsWith("1"):!1}function sU(e){if(!e)return;const{bucket_name:t,aws_region:r,buckets:n}=e;return{S3:{bucket:t,region:r,buckets:n&&mU(n)}}}function aU(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:r,identity_pool_id:n,password_policy:s,mfa_configuration:a,mfa_methods:i,unauthenticated_identities_enabled:o,oauth:c,username_attributes:f,standard_required_attributes:h,groups:p,passwordless_options:x}=e,g={Cognito:{userPoolId:t,userPoolClientId:r,groups:p}};return n&&(g.Cognito={...g.Cognito,identityPoolId:n}),s&&(g.Cognito.passwordFormat={requireLowercase:s.require_lowercase,requireNumbers:s.require_numbers,requireUppercase:s.require_uppercase,requireSpecialCharacters:s.require_symbols,minLength:s.min_length??6}),a&&(g.Cognito.mfa={status:pU(a),smsEnabled:i==null?void 0:i.includes("SMS"),totpEnabled:i==null?void 0:i.includes("TOTP")}),o&&(g.Cognito.allowGuestAccess=o),c&&(g.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:c.response_type==="token"?"token":"code",scopes:c.scopes,providers:hU(c.identity_providers)}}),f&&(g.Cognito.loginWith={...g.Cognito.loginWith,email:f.includes("email"),phone:f.includes("phone_number"),username:f.includes("username")}),h&&(g.Cognito.userAttributes=h.reduce((v,y)=>({...v,[y]:{required:!0}}),{})),x&&(g.Cognito.passwordless={emailOtpEnabled:x.email_otp_enabled,smsOtpEnabled:x.sms_otp_enabled,webAuthn:x.web_authn?{relyingPartyId:x.web_authn.relying_party_id,userVerification:x.web_authn.user_verification}:void 0,preferredChallenge:x.preferred_challenge}),g}function iU(e){if(!(e!=null&&e.amazon_pinpoint))return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}function oU(e){if(!e)return;const{aws_region:t,geofence_collections:r,maps:n,search_indices:s}=e;return{LocationService:{region:t,searchIndices:s,geofenceCollections:r,maps:n}}}function lU(e){if(!e)return;const{aws_region:t,default_authorization_type:r,url:n,api_key:s,model_introspection:a}=e;return{GraphQL:{endpoint:n,defaultAuthMode:Fj(r),region:t,apiKey:s,modelIntrospection:a}}}function cU(e){if(!(e!=null&&e.events))return;const{url:t,aws_region:r,api_key:n,default_authorization_type:s}=e.events;return{Events:{endpoint:t,defaultAuthMode:Fj(s),region:r,apiKey:n}}}function uU(e){if(!e)return;const{aws_region:t,channels:r,amazon_pinpoint_app_id:n}=e,s=r.includes("IN_APP_MESSAGING"),a=r.includes("APNS")||r.includes("FCM");if(!(s||a))return;const i={};return s&&(i.InAppMessaging={Pinpoint:{appId:n,region:t}}),a&&(i.PushNotification={Pinpoint:{appId:n,region:t}}),i}function fU(e){const t={};if(e.storage&&(t.Storage=sU(e.storage)),e.auth&&(t.Auth=aU(e.auth)),e.analytics&&(t.Analytics=iU(e.analytics)),e.geo&&(t.Geo=oU(e.geo)),e.data&&(t.API=lU(e.data)),e.custom){const r=cU(e.custom);r&&"Events"in r&&(t.API={...t.API,...r})}return e.notifications&&(t.Notifications=uU(e.notifications)),t}const dU={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function Fj(e){return dU[e]}const zC={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function hU(e=[]){return e.reduce((t,r)=>(zC[r]!==void 0&&t.push(zC[r]),t),[])}function pU(e){return e==="OPTIONAL"?"optional":e==="REQUIRED"?"on":"off"}function mU(e){const t={};return e.forEach(({name:r,bucket_name:n,aws_region:s,paths:a})=>{if(r in t)throw new Error(`Duplicate friendly name found: ${r}. Name must be unique.`);const i=a?Object.entries(a).reduce((o,[c,f])=>(f!==void 0&&(o[c]=f),o),{}):void 0;t[r]={bucketName:n,region:s,paths:i}}),t}const Pj=e=>Object.keys(e).some(t=>t.startsWith("aws_"))?K7(e):nU(e)?fU(e):e;function xU(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(h){try{f(n.next(h))}catch(p){i(p)}}function c(h){try{f(n.throw(h))}catch(p){i(p)}}function f(h){h.done?a(h.value):s(h.value).then(o,c)}f((n=n.apply(e,t||[])).next())})}function gU(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(f){return function(h){return c([f,h])}}function c(f){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,f[0]&&(r=0)),r;)try{if(n=1,s&&(a=f[0]&2?s.return:f[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,f[1])).done)return a;switch(s=0,a&&(f=[f[0]&2,a.value]),f[0]){case 0:case 1:a=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,s=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!a||f[1]>a[0]&&f[1]<a[3])){r.label=f[1];break}if(f[0]===6&&r.label<a[1]){r.label=a[1],a=f;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(f);break}a[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],s=0}finally{n=a=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var Da=64,yU=32,vU=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),bU=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],wU=Math.pow(2,53)-1,Ex=(function(){function e(){this.state=Int32Array.from(bU),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var r=0,n=t.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>wU)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=t[r++],n--,this.bufferLength===Da&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(r.setUint8(this.bufferLength++,128),n%Da>=Da-8){for(var s=this.bufferLength;s<Da;s++)r.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<Da-8;s++)r.setUint8(s,0);r.setUint32(Da-8,Math.floor(t/4294967296),!0),r.setUint32(Da-4,t),this.hashBuffer(),this.finished=!0}for(var a=new Uint8Array(yU),s=0;s<8;s++)a[s*4]=this.state[s]>>>24&255,a[s*4+1]=this.state[s]>>>16&255,a[s*4+2]=this.state[s]>>>8&255,a[s*4+3]=this.state[s]>>>0&255;return a},e.prototype.hashBuffer=function(){for(var t=this,r=t.buffer,n=t.state,s=n[0],a=n[1],i=n[2],o=n[3],c=n[4],f=n[5],h=n[6],p=n[7],x=0;x<Da;x++){if(x<16)this.temp[x]=(r[x*4]&255)<<24|(r[x*4+1]&255)<<16|(r[x*4+2]&255)<<8|r[x*4+3]&255;else{var g=this.temp[x-2],v=(g>>>17|g<<15)^(g>>>19|g<<13)^g>>>10;g=this.temp[x-15];var y=(g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3;this.temp[x]=(v+this.temp[x-7]|0)+(y+this.temp[x-16]|0)}var w=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&f^~c&h)|0)+(p+(vU[x]+this.temp[x]|0)|0)|0,_=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&a^s&i^a&i)|0;p=h,h=f,f=c,c=o+w|0,o=i,i=a,a=s,s=w+_|0}n[0]+=s,n[1]+=a,n[2]+=i,n[3]+=o,n[4]+=c,n[5]+=f,n[6]+=h,n[7]+=p},e})();const _U=e=>new TextEncoder().encode(e);var EU=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:_U;function Lj(e){return e instanceof Uint8Array?e:typeof e=="string"?EU(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function SU(e){return typeof e=="string"?e.length===0:e.byteLength===0}var zx=(function(){function e(t){this.secret=t,this.hash=new Ex,this.reset()}return e.prototype.update=function(t){if(!(SU(t)||this.error))try{this.hash.update(Lj(t))}catch(r){this.error=r}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return xU(this,void 0,void 0,function(){return gU(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new Ex,this.secret){this.outer=new Ex;var t=NU(this.secret),r=new Uint8Array(Da);r.set(t);for(var n=0;n<Da;n++)t[n]^=54,r[n]^=92;this.hash.update(t),this.outer.update(r);for(var n=0;n<t.byteLength;n++)t[n]=0}},e})();function NU(e){var t=Lj(e);if(t.byteLength>Da){var r=new Ex;r.update(t),t=r.digest()}var n=new Uint8Array(Da);return n.set(t),n}for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`)}var hn;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(hn||(hn={}));var l_;(function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(l_||(l_={}));var HC;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"})(HC||(HC={}));var VC;(function(e){e.Record="1",e.IdentifyUser="2"})(VC||(VC={}));var qC;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(qC||(qC={}));var Ss;(function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"})(Ss||(Ss={}));var WC;(function(e){e.Subscribe="1",e.GraphQl="2"})(WC||(WC={}));var $C;(function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"})($C||($C={}));var GC;(function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"})(GC||(GC={}));var KC;(function(e){e.None="0"})(KC||(KC={}));var XC;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})(XC||(XC={}));var YC;(function(e){e.Subscribe="1"})(YC||(YC={}));var JC;(function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"})(JC||(JC={}));var ZC;(function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"})(ZC||(ZC={}));const TU="6.16.0",r1=()=>typeof global<"u",Yf=()=>typeof window<"u",Bj=()=>typeof document<"u",AE=()=>typeof process<"u",i0=(e,t)=>!!Object.keys(e).find(r=>r.startsWith(t));var QC={};function kU(){const e=n=>n.startsWith("_react")||n.startsWith("__react"),t=n=>Object.keys(n).find(e),r=()=>Array.from(document.querySelectorAll("[id]"));return Bj()&&r().some(t)}function AU(){return AE()&&typeof QC<"u"&&!!Object.keys(QC).find(e=>e.includes("react"))}function CU(){return Yf()&&i0(window,"__VUE")}function RU(){return r1()&&i0(global,"__VUE")}var e4={};function OU(){return Yf()&&i0(window,"__SVELTE")}function jU(){return AE()&&typeof e4<"u"&&!!Object.keys(e4).find(e=>e.includes("svelte"))}function DU(){return Yf()&&window.next&&typeof window.next=="object"}function IU(){return r1()&&(i0(global,"__next")||i0(global,"__NEXT"))}function MU(){return Yf()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function FU(){return r1()&&typeof global.__NUXT_PATHS__<"u"}var t4={};function PU(){const e=!!(Bj()&&document.querySelector("[ng-version]")),t=!!(Yf()&&typeof window.ng<"u");return e||t}function LU(){var e;return AE()&&typeof t4=="object"&&((e=t4.npm_lifecycle_script)==null?void 0:e.startsWith("ng "))||!1}function BU(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function UU(){return r1()&&typeof global.expo<"u"}function zU(){return Yf()}const HU=[{platform:hn.Expo,detectionMethod:UU},{platform:hn.ReactNative,detectionMethod:BU},{platform:hn.NextJs,detectionMethod:DU},{platform:hn.Nuxt,detectionMethod:MU},{platform:hn.Angular,detectionMethod:PU},{platform:hn.React,detectionMethod:kU},{platform:hn.VueJs,detectionMethod:CU},{platform:hn.Svelte,detectionMethod:OU},{platform:hn.WebUnknown,detectionMethod:zU},{platform:hn.NextJsSSR,detectionMethod:IU},{platform:hn.NuxtSSR,detectionMethod:FU},{platform:hn.ReactSSR,detectionMethod:AU},{platform:hn.VueJsSSR,detectionMethod:RU},{platform:hn.AngularSSR,detectionMethod:LU},{platform:hn.SvelteSSR,detectionMethod:jU}];function VU(){var e;return((e=HU.find(t=>t.detectionMethod()))==null?void 0:e.platform)||hn.ServerSideUnknown}let Lh;const gb=[];let c_=!1;const qU=10,WU=10,$U=1e3,Uj=()=>{var e;if(!Lh){if(Lh=VU(),c_)for(;gb.length;)(e=gb.pop())==null||e();else gb.forEach(t=>{t()});r4(hn.ServerSideUnknown,qU),r4(hn.WebUnknown,WU)}return Lh};function GU(){Lh=void 0}function r4(e,t){Lh===e&&!c_&&setTimeout(()=>{GU(),c_=!0,setTimeout(Uj,$U)},t)}const KU={},XU=(e,t)=>{var r,n;return(n=(r=KU[e])==null?void 0:r[t])==null?void 0:n.additionalDetails},YU="aws-amplify",JU=e=>e.replace(/\+.*/,""),ZU=({category:e,action:t}={})=>{const r=[[YU,JU(TU)]];if(e&&r.push([e,t]),r.push(["framework",Uj()]),e&&t){const n=XU(e,t);n&&n.forEach(s=>{r.push(s)})}return r},n1=e=>ZU(e).map(([n,s])=>n&&s?`${n}/${s}`:n).join(" "),zj=()=>typeof window<"u"&&typeof window.document<"u",n4=new ia("Auth");class QU{configure(t,r){var n,s;this.authConfig=t,this.authOptions=r,t&&((n=t.Cognito)!=null&&n.userPoolEndpoint)&&n4.warn(s4("Amazon Cognito User Pool")),t&&((s=t.Cognito)!=null&&s.identityPoolEndpoint)&&n4.warn(s4("Amazon Cognito Identity Pool"))}async fetchAuthSession(t={}){var a,i,o,c,f,h;let r,n;const s=await this.getTokens(t);return s?(n=(i=(a=s.accessToken)==null?void 0:a.payload)==null?void 0:i.sub,r=await((c=(o=this.authOptions)==null?void 0:o.credentialsProvider)==null?void 0:c.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:s,authenticated:!0,forceRefresh:t.forceRefresh}))):r=await((h=(f=this.authOptions)==null?void 0:f.credentialsProvider)==null?void 0:h.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:t.forceRefresh})),{tokens:s,credentials:r==null?void 0:r.credentials,identityId:r==null?void 0:r.identityId,userSub:n}}async clearCredentials(){var t,r;await((r=(t=this.authOptions)==null?void 0:t.credentialsProvider)==null?void 0:r.clearCredentialsAndIdentityId())}async getTokens(t){var r,n;return await((n=(r=this.authOptions)==null?void 0:r.tokenProvider)==null?void 0:n.getTokens(t))??void 0}}const s4=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;class ez{constructor(){this.oAuthListener=void 0,this.isConfigured=!1,this.resourcesConfig={},this.libraryOptions={},this.Auth=new QU}configure(t,r){var s,a,i,o,c;const n=Pj(t);this.resourcesConfig=n,r&&(this.libraryOptions=r),this.resourcesConfig=Mj(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),((s=this.resourcesConfig.Analytics)!=null&&s.Pinpoint||(i=(a=this.resourcesConfig.Notifications)==null?void 0:a.InAppMessaging)!=null&&i.Pinpoint||(c=(o=this.resourcesConfig.Notifications)==null?void 0:o.PushNotification)!=null&&c.Pinpoint)&&console.warn("AWS will end support for Amazon Pinpoint on October 30, 2026. The guidance is to use AWS End User Messaging for push notifications and SMS, Amazon Simple Email Service for sending emails, Amazon Connect for campaigns, journeys, endpoints, and engagement analytics. Pinpoint recommends Amazon Kinesis for event collection and mobile analytics."),Nf.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",Wc),this.notifyOAuthListener(),this.isConfigured=!0}getConfig(){return this.isConfigured||console.warn("Amplify has not been configured. Please call Amplify.configure() before using this service."),this.resourcesConfig}[J7](t){var r,n,s;(n=(r=this.resourcesConfig.Auth)==null?void 0:r.Cognito.loginWith)!=null&&n.oauth?t((s=this.resourcesConfig.Auth)==null?void 0:s.Cognito):this.oAuthListener=t}notifyOAuthListener(){var t,r,n;!((r=(t=this.resourcesConfig.Auth)==null?void 0:t.Cognito.loginWith)!=null&&r.oauth)||!this.oAuthListener||(this.oAuthListener((n=this.resourcesConfig.Auth)==null?void 0:n.Cognito),this.oAuthListener=void 0)}}const Sr=new ez,tz=(e,t)=>e.Auth.fetchAuthSession(t),s1=e=>tz(Sr,e);function Hj(){return Sr.Auth.clearCredentials()}const a1=e=>{const{headers:t,statusCode:r}=e;return{...rz(e)?e.$metadata:{},httpStatusCode:r,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},rz=e=>typeof(e==null?void 0:e.$metadata)=="object",Jf=async e=>{if(!e||e.statusCode<300)return;const t=await L0(e),n=(i=>{const[o]=i.toString().split(/[,:]+/);return o.includes("#")?o.split("#")[1]:o})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),s=t.message??t.Message??"Unknown error",a=new Error(s);return Object.assign(a,{name:n,$metadata:a1(e)})},L0=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:a1(e)})},qs=(e,t,r,n)=>async(s,a)=>{const i={...n,...s},o=await i.endpointResolver(i,a),c=await t(a,o),f=await e(c,{...i});return r(f)},nz=300*1e3;function sz(e=nz){return n=>{const s=2**n*100+100*Math.random();return s>e?!1:s}}const Vj=3,a4="amz-sdk-invocation-id",az="amz-sdk-request",i4=300*1e3,qj=e=>{const r=sz(i4)(e);return r===!1?i4:r},iz=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],oz=e=>!!e&&iz.includes(e),Wj=e=>async(t,r)=>{const n=r??await e(t)??void 0,s=(n==null?void 0:n.code)||(n==null?void 0:n.name),a=t==null?void 0:t.statusCode;return{retryable:fz(r)||uz(a,s)||oz(s)||dz(a,s)}},lz=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],cz=["TimeoutError","RequestTimeout","RequestTimeoutException"],uz=(e,t)=>e===429||!!t&&lz.includes(t),fz=e=>[qc.NetworkError,"ERR_NETWORK"].includes(e==null?void 0:e.name),dz=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&cz.includes(t),$j="cognito-identity",Gj={service:$j,retryDecider:Wj(Jf),computeDelay:qj,cache:"no-store"},hz=({maxAttempts:e=Vj,retryDecider:t,computeDelay:r,abortSignal:n})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(s,a)=>async function(o){let c,f=a.attemptsCount??0,h;const p=()=>{if(h)return o4(h,f),h;throw o4(c,f),c};for(;!(n!=null&&n.aborted)&&f<e;){try{h=await s(o),c=void 0}catch(v){c=v,h=void 0}f=(a.attemptsCount??0)>f?a.attemptsCount??0:f+1,a.attemptsCount=f;const{isCredentialsExpiredError:x,retryable:g}=await t(h,c,a);if(g){if(a.isCredentialsExpired=!!x,!(n!=null&&n.aborted)&&f<e){const v=r(f);await pz(v,n)}continue}else return p()}if(n!=null&&n.aborted)throw new Error("Request aborted.");return p()}},pz=(e,t)=>{if(t!=null&&t.aborted)return Promise.resolve();let r,n;const s=new Promise(a=>{n=a,r=setTimeout(a,e)});return t==null||t.addEventListener("abort",function a(i){clearTimeout(r),t==null||t.removeEventListener("abort",a),n()}),s},o4=(e,t)=>{Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata={...e.$metadata??{},attempts:t})},mz=rU,xz=()=>e=>async function(r){return r.headers[a4]||(r.headers[a4]=mz()),e(r)},gz=({maxAttempts:e=Vj})=>(t,r)=>async function(s){const a=r.attemptsCount??0;return s.headers[az]=`attempt=${a+1}; max=${e}`,t(s)},yz=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>r=>async function(s){if(t.trim().length===0)return await r(s);{const a=e.toLowerCase();return s.headers[a]=s.headers[a]?`${s.headers[a]} ${t}`:t,await r(s)}},CE=(e,t)=>(r,n)=>{const s={};let a=i=>e(i,n);for(let i=t.length-1;i>=0;i--){const o=t[i];a=o(n)(a,s)}return a(r)},yb=e=>{let t;return()=>(t||(t=e()),t)},vz=e=>!["HEAD","GET"].includes(e.toUpperCase()),bz=async({url:e,method:t,headers:r,body:n},{abortSignal:s,cache:a,withCrossDomainCredentials:i})=>{var p;let o;try{o=await fetch(e,{method:t,headers:r,body:vz(t)?n:void 0,signal:s,cache:a,credentials:i?"include":"same-origin"})}catch(x){throw x instanceof TypeError?new zs({name:qc.NetworkError,message:"A network error has occurred.",underlyingError:x}):x}const c={};(p=o.headers)==null||p.forEach((x,g)=>{c[g.toLowerCase()]=x});const f={statusCode:o.status,headers:c,body:null},h=Object.assign(o.body??{},{text:yb(()=>o.text()),blob:yb(()=>o.blob()),json:yb(()=>o.json())});return{...f,body:h}},Kj=CE(bz,[yz,xz,hz,gz]),wz=()=>e=>async function(r){return r.headers["cache-control"]="no-store",e(r)},Xj=CE(Kj,[wz]),Yj=e=>(t,r)=>{const n=_z(e),s=JSON.stringify(t);return Ez(r,n,s)},_z=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),Ez=({url:e},t,r)=>({headers:t,url:e,body:r,method:"POST"}),l4=e=>qs(Xj,Yj("GetCredentialsForIdentity"),Sz,{...Gj,...e,userAgentValue:n1()}),Sz=async e=>{if(e.statusCode>=300)throw await Jf(e);const t=await L0(e);return{IdentityId:t.IdentityId,Credentials:Nz(t.Credentials),$metadata:a1(e)}},Nz=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(e*1e3)}),Tz=e=>qs(Xj,Yj("GetId"),kz,{...Gj,...e,userAgentValue:n1()}),kz=async e=>{if(e.statusCode>=300)throw await Jf(e);return{IdentityId:(await L0(e)).IdentityId,$metadata:a1(e)}},Jj={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Az={partitions:[Jj,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},Zj=e=>{const{partitions:t}=Az;for(const{regions:r,outputs:n,regionRegex:s}of t){const a=new RegExp(s);if(r.includes(e)||a.test(e))return n.dnsSuffix}return Jj.outputs.dnsSuffix},B0=URL,Cz=({region:e})=>({url:new B0(`https://${$j}.${e}.${Zj(e)}`)});class Th extends zs{constructor(){super({name:qc.PlatformNotSupported,message:"Function not supported on current platform"})}}class Qj{constructor(t){this.storage=t}async setItem(t,r){if(!this.storage)throw new Th;this.storage.setItem(t,r)}async getItem(t){if(!this.storage)throw new Th;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new Th;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new Th;this.storage.clear()}}class e8{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,r){this.storage.set(t,r)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}const t8=new ia("CoreStorageUtils"),Rz=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{t8.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new e8},r8=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return t8.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new e8}};class Oz extends Qj{constructor(){super(Rz())}}class jz extends Qj{constructor(){super(r8())}}class Dz{constructor(t){this._storage=t}get storage(){if(!this._storage)throw new Th;return this._storage}setItem(t,r){this.storage.setItem(t,r)}getItem(t){return this.storage.getItem(t)}removeItem(t){this.storage.removeItem(t)}clear(){this.storage.clear()}}class Iz extends Dz{constructor(){super(r8())}}/*! js-cookie v3.0.5 | MIT */function Om(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var Mz={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function u_(e,t){function r(s,a,i){if(!(typeof document>"u")){i=Om({},t,i),typeof i.expires=="number"&&(i.expires=new Date(Date.now()+i.expires*864e5)),i.expires&&(i.expires=i.expires.toUTCString()),s=encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var c in i)i[c]&&(o+="; "+c,i[c]!==!0&&(o+="="+i[c].split(";")[0]));return document.cookie=s+"="+e.write(a,s)+o}}function n(s){if(!(typeof document>"u"||arguments.length&&!s)){for(var a=document.cookie?document.cookie.split("; "):[],i={},o=0;o<a.length;o++){var c=a[o].split("="),f=c.slice(1).join("=");try{var h=decodeURIComponent(c[0]);if(i[h]=e.read(f,h),s===h)break}catch{}}return s?i[s]:i}}return Object.create({set:r,get:n,remove:function(s,a){r(s,"",Om({},a,{expires:-1}))},withAttributes:function(s){return u_(this.converter,Om({},this.attributes,s))},withConverter:function(s){return u_(Om({},this.converter,s),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var jm=u_(Mz,{path:"/"});class Fz{constructor(t={}){const{path:r,domain:n,expires:s,sameSite:a,secure:i}=t;if(this.domain=n,this.path=r||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?s:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?i:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!a||!["strict","lax","none"].includes(a))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(a==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=a}}async setItem(t,r){jm.set(t,r,this.getData())}async getItem(t){return jm.get(t)??null}async removeItem(t){jm.remove(t,this.getData())}async clear(){const t=jm.get(),r=Object.keys(t).map(n=>this.removeItem(n));await Promise.all(r)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const U0=new Oz;new jz;const yo=new Iz,Pz=e=>{let t;return async(...r)=>t||(t=new Promise((n,s)=>{e(...r).then(a=>{n(a)}).catch(a=>{s(a)}).finally(()=>{t=void 0})}),t)};function c4({expiresAt:e,clockDrift:t,tolerance:r=5e3}){return Date.now()+t+r>e}const Lz=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:r="",model:n="",architecture:s="",fullVersionList:a=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]),i=a.map(c=>`${c.brand}/${c.version}`).join(";");return[t,r,s,n,t,i].filter(c=>c).join(" ")||navigator.userAgent};function Bz(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}const o0={convert(e,t={urlSafe:!1,skipPadding:!1}){const r=typeof e=="string"?e:Bz(e);let n=V7()(r);return t.urlSafe&&(n=n.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(n=n.replace(/=/g,"")),n}};function Uz(){return H7().getRandomValues(new Uint32Array(1))[0]}function zz(e){const{words:t}=e,{sigBytes:r}=e,n=[];for(let s=0;s<r;s++){const a=t[s>>>2]>>>24-s%4*8&255;n.push((a>>>4).toString(16)),n.push((a&15).toString(16))}return n.join("")}class RE{constructor(t,r){this.words=[];let n=t;n=this.words=n||[],r!==void 0?this.sigBytes=r:this.sigBytes=n.length*4}random(t){const r=[];for(let n=0;n<t;n+=4)r.push(Uz());return new RE(r,t)}toString(){return zz(this)}}var At;(function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword",e.InvalidPreferredChallenge="InvalidPreferredChallenge"})(At||(At={}));const n8={[At.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[At.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[At.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[At.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[At.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[At.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[At.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[At.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[At.EmptySignInPassword]:{message:"password is required to signIn"},[At.EmptySignInUsername]:{message:"username is required to signIn"},[At.EmptySignUpPassword]:{message:"password is required to signUp"},[At.EmptySignUpUsername]:{message:"username is required to signUp"},[At.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[At.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[At.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[At.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[At.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"},[At.InvalidPreferredChallenge]:{message:"The preferred challenge is not enabled in your backend configuration",recoverySuggestion:"Ensure the authentication method is enabled in your Amplify backend configuration"}};var u4;(function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"})(u4||(u4={}));var Tf;(function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"})(Tf||(Tf={}));class Tt extends zs{constructor(t){super(t),this.constructor=Tt,Object.setPrototypeOf(this,Tt.prototype)}}function Yr(e,t){const{message:r,recoverySuggestion:n}=n8[t];if(!e)throw new Tt({name:t,message:r,recoverySuggestion:n})}function _n(e){const t=e==null?void 0:e.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new Tt({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function f_(e){if(!e||!e.includes(":"))throw new Tt({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}function d_(e){return Object.entries(e).map(([t,r])=>({Name:t,Value:r}))}var f4;(function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"})(f4||(f4={}));var d4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(d4||(d4={}));var h4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(h4||(h4={}));var p4;(function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(p4||(p4={}));var m4;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(m4||(m4={}));var x4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(x4||(x4={}));var g4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(g4||(g4={}));var y4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(y4||(y4={}));var v4;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(v4||(v4={}));var b4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(b4||(b4={}));var w4;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(w4||(w4={}));var _4;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(_4||(_4={}));var E4;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(E4||(E4={}));var S4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"})(S4||(S4={}));var Hx;(function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Hx||(Hx={}));var N4;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(N4||(N4={}));var T4;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(T4||(T4={}));var k4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(k4||(k4={}));var h_;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"})(h_||(h_={}));var A4;(function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(A4||(A4={}));var C4;(function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(C4||(C4={}));var R4;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(R4||(R4={}));var O4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(O4||(O4={}));var j4;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(j4||(j4={}));const i1="UserUnAuthenticatedException",Hz="UserAlreadyAuthenticatedException",Vz="DeviceMetadataNotFoundException",qz="InvalidRedirectException",Wz="InvalidAppSchemeException",$z="InvalidPreferredRedirectUrlException",Gz=new Tt({name:qz,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."});new Tt({name:Wz,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."});new Tt({name:$z,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});const Kz="InvalidOriginException",Xz=new Tt({name:Kz,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."}),Yz="OAuthSignOutException",Jz="TokenRefreshException",Zz="UnexpectedSignInInterruptionException";function OE(e){if(!e||!e.accessToken)throw new Tt({name:i1,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}function Qz(e){if(!e||!e.idToken)throw new Tt({name:i1,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const eH=new Tt({name:Jz,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),tH=new Tt({name:i1,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function s8(e){if(sH(e))throw eH;if(!nH(e))throw tH}function a8(e){if(!e||!e.deviceKey||!e.deviceGroupKey||!e.randomPassword)throw new Tt({name:Vz,message:"Either deviceKey, deviceGroupKey or secretPassword were not found during the sign-in process.",recoverySuggestion:"Make sure to not clear storage after calling the signIn API."})}const rH={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function i8(e){return(e==null?void 0:e.accessToken)||(e==null?void 0:e.idToken)}function nH(e){return i8(e)&&(e==null?void 0:e.refreshToken)}function sH(e){return i8(e)&&!(e!=null&&e.refreshToken)}const aH=async e=>{var o,c;const t=(o=e.getConfig().Auth)==null?void 0:o.Cognito;Zt(t);const r=await e.Auth.getTokens({forceRefresh:!1});OE(r);const{"cognito:username":n,sub:s}=((c=r.idToken)==null?void 0:c.payload)??{},a={username:n,userId:s},i=iH(r);return i&&(a.signInDetails=i),a};function iH(e){return e==null?void 0:e.signInDetails}const o8=async()=>aH(Sr),ua=(e,t)=>n1({category:l_.Auth,action:e,...t}),Va=e=>(t,r)=>{const n=oH(e),s=JSON.stringify(t);return lH(r,n,s)},oH=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),lH=({url:e},t,r)=>({headers:t,url:e,body:r,method:"POST"});function li(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new Tt({name:qc.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const ui=()=>async e=>{if(e.statusCode>=300){const t=await Jf(e);throw li(t),new Tt({name:t.name,message:t.message,metadata:t.$metadata})}return L0(e)},cH=()=>(e,t)=>async function(n){return n.headers["cache-control"]="no-store",e(n)},qa=CE(Kj,[cH]),l8="cognito-idp",Wa={service:l8,retryDecider:Wj(Jf),computeDelay:qj,get userAgentValue(){return n1()},cache:"no-store"},z0=e=>qs(qa,Va("InitiateAuth"),ui(),{...Wa,...e}),o1=e=>qs(qa,Va("RespondToAuthChallenge"),ui(),{...Wa,...e}),uH=e=>qs(qa,Va("AssociateSoftwareToken"),ui(),{...Wa,...e}),fH=({region:e})=>({url:new B0(`https://${l8}.${e}.${Zj(e)}`)}),En=({endpointOverride:e})=>t=>e?{url:new B0(e)}:fH(t),dH=e=>qs(qa,Va("GetTokensFromRefreshToken"),ui(),{...Wa,...e}),hH=async({tokens:e,authConfig:t,username:r,clientMetadata:n})=>{var v;Zt(t==null?void 0:t.Cognito);const{userPoolId:s,userPoolClientId:a,userPoolEndpoint:i}=t.Cognito,o=_n(s);s8(e);const c=dH({endpointResolver:En({endpointOverride:i})}),{AuthenticationResult:f}=await c({region:o},{ClientId:a,RefreshToken:e.refreshToken,DeviceKey:(v=e.deviceMetadata)==null?void 0:v.deviceKey,ClientMetadata:n}),h=$c((f==null?void 0:f.AccessToken)??""),p=f!=null&&f.IdToken?$c(f.IdToken):void 0,{iat:x}=h.payload;if(!x)throw new Tt({name:"iatNotFoundException",message:"iat not found in access token"});const g=x*1e3-new Date().getTime();return{accessToken:h,idToken:p,clockDrift:g,refreshToken:(f==null?void 0:f.RefreshToken)??e.refreshToken,username:r}},pH=Pz(hH),mH={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var Vx;(function(e){e.InvalidAuthTokens="InvalidAuthTokens"})(Vx||(Vx={}));const xH={[Vx.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},gH=NE(xH),D4="CognitoIdentityServiceProvider";class yH{getKeyValueStorage(){if(!this.keyValueStorage)throw new Tt({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{const t=await this.getAuthKeys(),r=await this.getKeyValueStorage().getItem(t.accessToken);if(!r)throw new Tt({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const n=$c(r),s=await this.getKeyValueStorage().getItem(t.idToken),a=s?$c(s):void 0,i=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,o=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",c=Number.parseInt(o),f=await this.getKeyValueStorage().getItem(t.signInDetails),h={accessToken:n,idToken:a,refreshToken:i,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:c,username:await this.getLastAuthUser()};return f&&(h.signInDetails=JSON.parse(f)),h}catch{return null}}async storeTokens(t){gH(t!==void 0,Vx.InvalidAuthTokens);const r=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),r);const n=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n.accessToken,t.accessToken.toString()),t.idToken?await this.getKeyValueStorage().setItem(n.idToken,t.idToken.toString()):await this.getKeyValueStorage().removeItem(n.idToken),t.refreshToken?await this.getKeyValueStorage().setItem(n.refreshToken,t.refreshToken):await this.getKeyValueStorage().removeItem(n.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(n.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(n.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(n.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails?await this.getKeyValueStorage().setItem(n.signInDetails,JSON.stringify(t.signInDetails)):await this.getKeyValueStorage().removeItem(n.signInDetails),await this.getKeyValueStorage().setItem(n.clockDrift,`${t.clockDrift}`)}async clearTokens(){const t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(t.oauthMetadata)])}async getDeviceMetadata(t){const r=await this.getAuthKeys(t),n=await this.getKeyValueStorage().getItem(r.deviceKey),s=await this.getKeyValueStorage().getItem(r.deviceGroupKey),a=await this.getKeyValueStorage().getItem(r.randomPasswordKey);return a&&s&&n?{deviceKey:n,deviceGroupKey:s,randomPassword:a}:null}async clearDeviceMetadata(t){const r=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(r.deviceKey),this.getKeyValueStorage().removeItem(r.deviceGroupKey),this.getKeyValueStorage().removeItem(r.randomPasswordKey)])}async getAuthKeys(t){var n;Zt((n=this.authConfig)==null?void 0:n.Cognito);const r=t??await this.getLastAuthUser();return vH(D4,`${this.authConfig.Cognito.userPoolClientId}.${r}`)}getLastAuthUserKey(){var r;Zt((r=this.authConfig)==null?void 0:r.Cognito);const t=this.authConfig.Cognito.userPoolClientId;return`${D4}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(t){const{oauthMetadata:r}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(r,JSON.stringify(t))}async getOAuthMetadata(){const{oauthMetadata:t}=await this.getAuthKeys(),r=await this.getKeyValueStorage().getItem(t);return r&&JSON.parse(r)}}const vH=(e,t)=>jE(mH)(`${e}`,t);function jE(e){const t=Object.values({...e});return(r,n)=>t.reduce((s,a)=>({...s,[a]:`${r}.${n}.${a}`}),{})}const I4="amplify-signin-with-hostedUI",wi="CognitoIdentityServiceProvider";class c8{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){Zt(this.cognitoConfig);const t=_i(wi,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){Zt(this.cognitoConfig);const t=_i(wi,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(I4),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){Zt(this.cognitoConfig);const t=_i(wi,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){Zt(this.cognitoConfig);const r=_i(wi,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(r.oauthState,t)}loadPKCE(){Zt(this.cognitoConfig);const t=_i(wi,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){Zt(this.cognitoConfig);const r=_i(wi,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(r.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){Zt(this.cognitoConfig);const t=_i(wi,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){Zt(this.cognitoConfig);const r=_i(wi,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(r.inflightOAuth,`${t}`)}async loadOAuthSignIn(){var a;Zt(this.cognitoConfig);const t=_i(wi,this.cognitoConfig.userPoolClientId),r=await this.keyValueStorage.getItem(I4),[n,s]=((a=await this.keyValueStorage.getItem(t.oauthSignIn))==null?void 0:a.split(","))??[];return{isOAuthSignIn:n==="true"||r==="true",preferPrivateSession:s==="true"}}async storeOAuthSignIn(t,r=!1){Zt(this.cognitoConfig);const n=_i(wi,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.oauthSignIn,`${t},${r}`)}}const _i=(e,t)=>jE(rH)(e,t),M4=new c8(U0);class bH{constructor(){this.waitForInflightOAuth=zj()?async()=>{if(await M4.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,r)=>{}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){M4.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new Tt({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new Tt({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}setClientMetadataProvider(t){this.clientMetadataProvider=t}async getTokens(t){var i,o,c,f,h,p;let r;try{Zt((i=this.authConfig)==null?void 0:i.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,r=await this.getTokenStore().loadTokens();const n=await this.getTokenStore().getLastAuthUser();if(r===null)return null;const s=!!(r!=null&&r.idToken)&&c4({expiresAt:(((c=(o=r.idToken)==null?void 0:o.payload)==null?void 0:c.exp)??0)*1e3,clockDrift:r.clockDrift??0}),a=c4({expiresAt:(((h=(f=r.accessToken)==null?void 0:f.payload)==null?void 0:h.exp)??0)*1e3,clockDrift:r.clockDrift??0});return(t!=null&&t.forceRefresh||s||a)&&(r=await this.refreshTokens({tokens:r,username:n,clientMetadata:(t==null?void 0:t.clientMetadata)??await((p=this.clientMetadataProvider)==null?void 0:p.call(this))}),r===null)?null:{accessToken:r==null?void 0:r.accessToken,idToken:r==null?void 0:r.idToken,signInDetails:r==null?void 0:r.signInDetails}}async refreshTokens({tokens:t,username:r,clientMetadata:n}){try{const{signInDetails:s}=t,a=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:r,clientMetadata:n});return a.signInDetails=s,await this.setTokens({tokens:a}),Nf.dispatch("auth",{event:"tokenRefresh"},"Auth",Wc),a}catch(s){return this.handleErrors(s)}}handleErrors(t){if(li(t),this.isAuthenticationError(t)&&this.clearTokens(),Nf.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",Wc),t.name.startsWith("NotAuthorizedException"))return null;throw t}isAuthenticationError(t){return["NotAuthorizedException","TokenRevokedException","UserNotFoundException","PasswordResetRequiredException","UserNotConfirmedException","RefreshTokenReuseException"].some(n=>{var s,a;return(a=(s=t==null?void 0:t.name)==null?void 0:s.startsWith)==null?void 0:a.call(s,n)})}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}setOAuthMetadata(t){return this.getTokenStore().setOAuthMetadata(t)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}class wH{constructor(){this.authTokenStore=new yH,this.authTokenStore.setKeyValueStorage(U0),this.tokenOrchestrator=new bH,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(pH)}getTokens(t={}){return this.tokenOrchestrator.getTokens(t)}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setClientMetadataProvider(t){this.tokenOrchestrator.setClientMetadataProvider(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}}const kh=new wH,{tokenOrchestrator:za}=kh;async function Zf(e){if(e.AccessToken){const t=$c(e.AccessToken),r=(t.payload.iat||0)*1e3,n=new Date().getTime(),s=r>0?r-n:0;let a,i,o;e.RefreshToken&&(i=e.RefreshToken),e.IdToken&&(a=$c(e.IdToken)),e!=null&&e.NewDeviceMetadata&&(o=e.NewDeviceMetadata);const c={accessToken:t,idToken:a,refreshToken:i,clockDrift:s,deviceMetadata:o,username:e.username};e!=null&&e.signInDetails&&(c.signInDetails=e.signInDetails),await za.setTokens({tokens:c})}else throw new zs({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}const _H="Unable to get user session following successful sign-in.",Qf=async()=>{try{Nf.dispatch("auth",{event:"signedIn",data:await o8()},"Auth",Wc)}catch(e){throw e.name===i1?new Tt({name:Zz,message:_H,recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."}):e}};function u8(){return{active:!1}}const EH=(e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return u8();default:return e}},SH=e=>{let t=e(u8(),{type:"RESET"});return{getState:()=>t,dispatch:r=>{t=e(t,r)}}},Nl=SH(EH),NH=180*1e3,Dm="CognitoSignInState",vo={username:`${Dm}.username`,challengeName:`${Dm}.challengeName`,signInSession:`${Dm}.signInSession`,expiry:`${Dm}.expiry`},TH=(e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return Im({signInSession:t.value}),{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return Im(t.value),{...t.value};case"SET_CHALLENGE_NAME":return Im({challengeName:t.value}),{...e,challengeName:t.value};case"SET_USERNAME":return Im({username:t.value}),{...e,username:t.value};case"SET_INITIAL_STATE":return AH();case"RESET_STATE":return f8(),DE();default:return e}},kH=e=>{const t=Number(e),r=Date.now();return t<=r},Pi=()=>{Pl.dispatch({type:"RESET_STATE"})},f8=()=>{for(const e of Object.values(vo))yo.removeItem(e)},DE=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),AH=()=>{const e=yo.getItem(vo.expiry);if(!e||kH(e))return f8(),DE();const t=yo.getItem(vo.username)??void 0,r=yo.getItem(vo.challengeName)??void 0,n=yo.getItem(vo.signInSession)??void 0;return{username:t,challengeName:r,signInSession:n}},CH=e=>{let t=e(DE(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:r=>{t=e(t,r)}}},Pl=CH(TH);function ed(e){Pl.dispatch({type:"SET_SIGN_IN_STATE",value:e})}const Im=({challengeName:e,signInSession:t,username:r})=>{r&&yo.setItem(vo.username,r),e&&yo.setItem(vo.challengeName,e),t&&(yo.setItem(vo.signInSession,t),yo.setItem(vo.expiry,String(Date.now()+NH)))},F4="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.";class Eo extends zs{constructor(t){super(t),this.constructor=Eo,Object.setPrototypeOf(this,Eo.prototype)}}var Xr;(function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"})(Xr||(Xr={}));const vb="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",P4="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",qx={[Xr.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:F4},[Xr.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:P4},[Xr.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:P4},[Xr.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:F4},[Xr.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[Xr.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[Xr.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:vb},[Xr.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:vb},[Xr.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:vb},[Xr.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},IE=NE(qx,Eo),RH=e=>{if(e instanceof Error){if(e.name==="AbortError"){const{message:t,recoverySuggestion:r}=qx[Xr.PasskeyOperationAborted];return new Eo({name:Xr.PasskeyOperationAborted,message:t,recoverySuggestion:r,underlyingError:e})}if(e.name==="SecurityError"){const{message:t,recoverySuggestion:r}=qx[Xr.RelyingPartyMismatch];return new Eo({name:Xr.RelyingPartyMismatch,message:t,recoverySuggestion:r,underlyingError:e})}}return new Eo({name:qc.Unknown,message:"An unknown error has occurred.",underlyingError:e})},OH=e=>{if(e instanceof Eo)return e;if(e instanceof Error&&e.name==="NotAllowedError"){const{message:t,recoverySuggestion:r}=qx[Xr.PasskeyAuthenticationCanceled];return new Eo({name:Xr.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:r,underlyingError:e})}return RH(e)},jH=()=>zj()&&window.isSecureContext&&"credentials"in navigator&&typeof window.PublicKeyCredential=="function",fh=e=>o0.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0}),L4=e=>Uint8Array.from(TE.convert(e,{urlSafe:!0}),t=>t.charCodeAt(0)).buffer,DH=e=>{const t=L4(e.challenge),r=(e.allowCredentials||[]).map(n=>({...n,id:L4(n.id)}));return{...e,challenge:t,allowCredentials:r}},IH=e=>{const t={clientDataJSON:fh(e.response.clientDataJSON),authenticatorData:fh(e.response.authenticatorData),signature:fh(e.response.signature)};e.response.userHandle&&(t.userHandle=fh(e.response.userHandle));const r={id:e.id,rawId:fh(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(r.authenticatorAttachment=e.authenticatorAttachment),r};function MH(e){IE(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,Xr.PasskeyRetrievalFailed)}const FH=async e=>{try{const t=jH();IE(t,Xr.PasskeyNotSupported);const r=DH(e),n=await navigator.credentials.get({publicKey:r});return MH(n),IH(n)}catch(t){throw OH(t)}},PH=e=>qs(qa,Va("ConfirmDevice"),ui(),{...Wa,...e}),Sx={convert(e){return new TextEncoder().encode(e)}};function lt(e,t){e!=null&&this.fromString(e,t)}function _s(){return new lt(null,null)}let jl;const LH=0xdeadbeefcafe,B4=(LH&16777215)===15715070;function BH(e,t,r,n,s,a){for(;--a>=0;){const i=t*this[e++]+r[n]+s;s=Math.floor(i/67108864),r[n++]=i&67108863}return s}function UH(e,t,r,n,s,a){const i=t&32767,o=t>>15;for(;--a>=0;){let c=this[e]&32767;const f=this[e++]>>15,h=o*c+f*i;c=i*c+((h&32767)<<15)+r[n]+(s&1073741823),s=(c>>>30)+(h>>>15)+o*f+(s>>>30),r[n++]=c&1073741823}return s}function zH(e,t,r,n,s,a){const i=t&16383,o=t>>14;for(;--a>=0;){let c=this[e]&16383;const f=this[e++]>>14,h=o*c+f*i;c=i*c+((h&16383)<<14)+r[n]+s,s=(c>>28)+(h>>14)+o*f,r[n++]=c&268435455}return s}const U4=typeof navigator<"u";U4&&B4&&navigator.appName==="Microsoft Internet Explorer"?(lt.prototype.am=UH,jl=30):U4&&B4&&navigator.appName!=="Netscape"?(lt.prototype.am=BH,jl=26):(lt.prototype.am=zH,jl=28);lt.prototype.DB=jl;lt.prototype.DM=(1<<jl)-1;lt.prototype.DV=1<<jl;const ME=52;lt.prototype.FV=Math.pow(2,ME);lt.prototype.F1=ME-jl;lt.prototype.F2=2*jl-ME;const HH="0123456789abcdefghijklmnopqrstuvwxyz",l1=[];let td,Pa;td=48;for(Pa=0;Pa<=9;++Pa)l1[td++]=Pa;td=97;for(Pa=10;Pa<36;++Pa)l1[td++]=Pa;td=65;for(Pa=10;Pa<36;++Pa)l1[td++]=Pa;function z4(e){return HH.charAt(e)}function VH(e,t){const r=l1[e.charCodeAt(t)];return r??-1}function qH(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function WH(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function FE(e){const t=_s();return t.fromInt(e),t}function $H(e,t){let r;if(t===16)r=4;else if(t===8)r=3;else if(t===2)r=1;else if(t===32)r=5;else if(t===4)r=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let n=e.length,s=!1,a=0;for(;--n>=0;){const i=VH(e,n);if(i<0){e.charAt(n)==="-"&&(s=!0);continue}s=!1,a===0?this[this.t++]=i:a+r>this.DB?(this[this.t-1]|=(i&(1<<this.DB-a)-1)<<a,this[this.t++]=i>>this.DB-a):this[this.t-1]|=i<<a,a+=r,a>=this.DB&&(a-=this.DB)}this.clamp(),s&&lt.ZERO.subTo(this,this)}function GH(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t}function KH(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(e==16)t=4;else if(e===8)t=3;else if(e===2)t=1;else if(e===32)t=5;else if(e===4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");const r=(1<<t)-1;let n,s=!1,a="",i=this.t,o=this.DB-i*this.DB%t;if(i-- >0)for(o<this.DB&&(n=this[i]>>o)>0&&(s=!0,a=z4(n));i>=0;)o<t?(n=(this[i]&(1<<o)-1)<<t-o,n|=this[--i]>>(o+=this.DB-t)):(n=this[i]>>(o-=t)&r,o<=0&&(o+=this.DB,--i)),n>0&&(s=!0),s&&(a+=z4(n));return s?a:"0"}function XH(){const e=_s();return lt.ZERO.subTo(this,e),e}function YH(){return this.s<0?this.negate():this}function JH(e){let t=this.s-e.s;if(t!=0)return t;let r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this[r]-e[r])!=0)return t;return 0}function PE(e){let t=1,r;return(r=e>>>16)!==0&&(e=r,t+=16),(r=e>>8)!==0&&(e=r,t+=8),(r=e>>4)!==0&&(e=r,t+=4),(r=e>>2)!==0&&(e=r,t+=2),(r=e>>1)!==0&&(e=r,t+=1),t}function ZH(){return this.t<=0?0:this.DB*(this.t-1)+PE(this[this.t-1]^this.s&this.DM)}function QH(e,t){let r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}function eV(e,t){for(let r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}function tV(e,t){const r=e%this.DB,n=this.DB-r,s=(1<<n)-1,a=Math.floor(e/this.DB);let i=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t[o+a+1]=this[o]>>n|i,i=(this[o]&s)<<r;for(o=a-1;o>=0;--o)t[o]=0;t[a]=i,t.t=this.t+a+1,t.s=this.s,t.clamp()}function rV(e,t){t.s=this.s;const r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}const n=e%this.DB,s=this.DB-n,a=(1<<n)-1;t[0]=this[r]>>n;for(let i=r+1;i<this.t;++i)t[i-r-1]|=(this[i]&a)<<s,t[i-r]=this[i]>>n;n>0&&(t[this.t-r-1]|=(this.s&a)<<s),t.t=this.t-r,t.clamp()}function nV(e,t){let r=0,n=0;const s=Math.min(e.t,this.t);for(;r<s;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()}function sV(e,t){const r=this.abs(),n=e.abs();let s=r.t;for(t.t=s+n.t;--s>=0;)t[s]=0;for(s=0;s<n.t;++s)t[s+r.t]=r.am(0,n[s],t,s,0,r.t);t.s=0,t.clamp(),this.s!==e.s&&lt.ZERO.subTo(t,t)}function aV(e){const t=this.abs();let r=e.t=2*t.t;for(;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){const n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}function iV(e,t,r){const n=e.abs();if(n.t<=0)return;const s=this.abs();if(s.t<n.t){t!=null&&t.fromInt(0),r!=null&&this.copyTo(r);return}r===null&&(r=_s());const a=_s(),i=this.s,o=e.s,c=this.DB-PE(n[n.t-1]);c>0?(n.lShiftTo(c,a),s.lShiftTo(c,r)):(n.copyTo(a),s.copyTo(r));const f=a.t,h=a[f-1];if(h===0)return;const p=h*(1<<this.F1)+(f>1?a[f-2]>>this.F2:0),x=this.FV/p,g=(1<<this.F1)/p,v=1<<this.F2;let y=r.t,w=y-f;const _=t===null?_s():t;for(a.dlShiftTo(w,_),r.compareTo(_)>=0&&(r[r.t++]=1,r.subTo(_,r)),lt.ONE.dlShiftTo(f,_),_.subTo(a,a);a.t<f;)a[a.t++]=0;for(;--w>=0;){let S=r[--y]===h?this.DM:Math.floor(r[y]*x+(r[y-1]+v)*g);if((r[y]+=a.am(0,S,r,w,0,f))<S)for(a.dlShiftTo(w,_),r.subTo(_,r);r[y]<--S;)r.subTo(_,r)}t!==null&&(r.drShiftTo(f,t),i!==o&&lt.ZERO.subTo(t,t)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),i<0&&lt.ZERO.subTo(r,r)}function oV(e){const t=_s();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(lt.ZERO)>0&&e.subTo(t,t),t}function lV(){if(this.t<1)return 0;const e=this[0];if((e&1)===0)return 0;let t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function cV(e){return this.compareTo(e)===0}function uV(e,t){let r=0,n=0;const s=Math.min(e.t,this.t);for(;r<s;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()}function fV(e){const t=_s();return this.addTo(e,t),t}function dV(e){const t=_s();return this.subTo(e,t),t}function hV(e){const t=_s();return this.multiplyTo(e,t),t}function pV(e){const t=_s();return this.divRemTo(e,t,null),t}function rd(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function mV(e){const t=_s();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(lt.ZERO)>0&&this.m.subTo(t,t),t}function xV(e){const t=_s();return e.copyTo(t),this.reduce(t),t}function gV(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let r=e[t]&32767;const n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function yV(e,t){e.squareTo(t),this.reduce(t)}function vV(e,t,r){e.multiplyTo(t,r),this.reduce(r)}rd.prototype.convert=mV;rd.prototype.revert=xV;rd.prototype.reduce=gV;rd.prototype.mulTo=vV;rd.prototype.sqrTo=yV;function bV(e,t,r){let n=e.bitLength(),s,a=FE(1);const i=new rd(t);if(n<=0)return a;n<18?s=1:n<48?s=3:n<144?s=4:n<768?s=5:s=6;const o=[];let c=3;const f=s-1,h=(1<<s)-1;if(o[1]=i.convert(this),s>1){const _=_s();for(i.sqrTo(o[1],_);c<=h;)o[c]=_s(),i.mulTo(_,o[c-2],o[c]),c+=2}let p=e.t-1,x,g=!0,v=_s(),y;for(n=PE(e[p])-1;p>=0;){for(n>=f?x=e[p]>>n-f&h:(x=(e[p]&(1<<n+1)-1)<<f-n,p>0&&(x|=e[p-1]>>this.DB+n-f)),c=s;(x&1)===0;)x>>=1,--c;if((n-=c)<0&&(n+=this.DB,--p),g)o[x].copyTo(a),g=!1;else{for(;c>1;)i.sqrTo(a,v),i.sqrTo(v,a),c-=2;c>0?i.sqrTo(a,v):(y=a,a=v,v=y),i.mulTo(v,o[x],a)}for(;p>=0&&(e[p]&1<<n)===0;)i.sqrTo(a,v),y=a,a=v,v=y,--n<0&&(n=this.DB-1,--p)}const w=i.revert(a);return r(null,w),w}lt.prototype.copyTo=qH;lt.prototype.fromInt=WH;lt.prototype.fromString=$H;lt.prototype.clamp=GH;lt.prototype.dlShiftTo=QH;lt.prototype.drShiftTo=eV;lt.prototype.lShiftTo=tV;lt.prototype.rShiftTo=rV;lt.prototype.subTo=nV;lt.prototype.multiplyTo=sV;lt.prototype.squareTo=aV;lt.prototype.divRemTo=iV;lt.prototype.invDigit=lV;lt.prototype.addTo=uV;lt.prototype.toString=KH;lt.prototype.negate=XH;lt.prototype.abs=YH;lt.prototype.compareTo=JH;lt.prototype.bitLength=ZH;lt.prototype.mod=oV;lt.prototype.equals=cV;lt.prototype.add=fV;lt.prototype.subtract=dV;lt.prototype.multiply=hV;lt.prototype.divide=pV;lt.prototype.modPow=bV;lt.ZERO=FE(0);lt.ONE=FE(1);const wV=async({a:e,g:t,k:r,x:n,B:s,N:a,U:i})=>new Promise((o,c)=>{t.modPow(n,a,(f,h)=>{if(f){c(f);return}s.subtract(r.multiply(h)).modPow(e.add(i.multiply(n)),a,(p,x)=>{if(p){c(p);return}o(x.mod(a))})})}),_V="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",d8={},p_={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),d8[e]=t,p_[t]=e}const kf=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2){const n=e.slice(r,r+2).toLowerCase();if(n in p_)t[r/2]=p_[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return t},LE=e=>{let t="";for(let r=0;r<e.byteLength;r++)t+=d8[e[r]];return t},m_=e=>{const t=new zx;t.update(e);const r=t.digestSync(),n=LE(r);return new Array(64-n.length).join("0")+n},Nx=e=>m_(kf(e)),EV=/^[89a-f]/i,xo=e=>{if(!(e instanceof lt))throw new Error("Not a BigInteger");const t=e.compareTo(lt.ZERO)<0;let r=e.abs().toString(16);if(r=r.length%2!==0?`0${r}`:r,r=EV.test(r)?`00${r}`:r,t){const n=r.split("").map(a=>{const i=~parseInt(a,16)&15;return"0123456789ABCDEF".charAt(i)}).join("");r=new lt(n,16).add(lt.ONE).toString(16),r.toUpperCase().startsWith("FF8")&&(r=r.substring(2))}return r},SV=({A:e,B:t})=>{const r=new lt(Nx(xo(e)+xo(t)),16);if(r.equals(lt.ZERO))throw new Error("U cannot be zero.");return r},NV=(e,t,r)=>{const n=new zx(t);n.update(e);const s=n.digestSync(),a=new zx(s);return a.update(r),a.digestSync().slice(0,16)},BE=e=>{const t=new RE().random(e).toString();return kf(t)},TV=()=>o0.convert(BE(40));class kV{constructor({userPoolName:t,a:r,g:n,A:s,N:a}){this.encoder=Sx,this.userPoolName=t,this.a=r,this.g=n,this.A=s,this.N=a,this.k=new lt(Nx(`${xo(a)}${xo(n)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new Tt({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new Tt({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new Tt({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(t,r){this.randomPassword=TV();const n=`${t}${r}:${this.randomPassword}`,s=m_(n),a=LE(BE(16));return this.saltToHashDevices=xo(new lt(a,16)),new Promise((i,o)=>{this.g.modPow(new lt(Nx(this.saltToHashDevices+s),16),this.N,(c,f)=>{if(c){o(c);return}this.verifierDevices=xo(f),i()})})}async getPasswordAuthenticationKey({username:t,password:r,serverBValue:n,salt:s}){if(n.mod(this.N).equals(lt.ZERO))throw new Error("B cannot be zero.");const a=SV({A:this.A,B:n}),i=`${this.userPoolName}${t}:${r}`,o=m_(i),c=new lt(Nx(xo(s)+o),16),f=await wV({a:this.a,g:this.g,k:this.k,x:c,B:n,N:this.N,U:a}),h=this.encoder.convert("Caldera Derived Key"),p=this.encoder.convert(""),x=new Uint8Array(h.byteLength+p.byteLength);return x.set(h,0),x.set(p,h.byteLength),NV(kf(xo(f)),kf(xo(a)),x)}}const AV=async({a:e,g:t,N:r})=>new Promise((n,s)=>{t.modPow(e,r,(a,i)=>{if(a){s(a);return}if(i.mod(r).equals(lt.ZERO)){s(new Error("Illegal parameter. A mod N cannot be 0."));return}n(i)})}),c1=async e=>{const t=new lt(_V,16),r=new lt("2",16),n=CV(),s=await AV({a:n,g:r,N:t});return new kV({userPoolName:e,a:n,g:r,A:s,N:t})},CV=()=>{const e=LE(BE(128));return new lt(e,16)};async function nd({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:r,accessToken:n}){if(!r)return;const s=e.split("_")[1]||"",a=await c1(s),i=r==null?void 0:r.DeviceKey,o=r==null?void 0:r.DeviceGroupKey;try{await a.generateHashDevice(o??"",i??"")}catch{return}const c={Salt:o0.convert(kf(a.getSaltToHashDevices())),PasswordVerifier:o0.convert(kf(a.getVerifierDevices()))},f=a.getRandomPassword();try{return await PH({endpointResolver:En({endpointOverride:t})})({region:_n(e)},{AccessToken:n,DeviceName:await Lz(),DeviceKey:r==null?void 0:r.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:i,deviceGroupKey:o,randomPassword:f}}catch{return}}async function RV(e){var g;const t=(g=Sr.getConfig().Auth)==null?void 0:g.Cognito;Zt(t);const{username:r,signInSession:n,signInDetails:s,challengeName:a}=Pl.getState();if(a!=="WEB_AUTHN"||!r)throw new Tt({name:Tf.SignInException,message:"Unable to proceed due to invalid sign in state."});const{CREDENTIAL_REQUEST_OPTIONS:i}=e;IE(!!i,Xr.InvalidPasskeyAuthenticationOptions);const o=await FH(JSON.parse(i)),c=o1({endpointResolver:En({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:f,ChallengeParameters:h,AuthenticationResult:p,Session:x}=await c({region:_n(t.userPoolId),userAgentValue:ua(Ss.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:r,CREDENTIAL:JSON.stringify(o)},ClientId:t.userPoolClientId,Session:n});if(ed({signInSession:x,username:r,challengeName:f,signInDetails:s}),p)return await Zf({...p,username:r,NewDeviceMetadata:await nd({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:p.NewDeviceMetadata,accessToken:p.AccessToken}),signInDetails:s}),Pl.dispatch({type:"RESET_STATE"}),await Qf(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if(f==="WEB_AUTHN")throw new Tt({name:Tf.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:f,challengeParameters:h}}function fi({username:e,userPoolId:t,userPoolClientId:r}){if(typeof window>"u")return;const n=window.AmazonCognitoAdvancedSecurityData;if(typeof n>"u")return;const s=n.getData(e,t,r);return s?{EncodedData:s}:{}}const OV=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],jV=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h8=()=>{const e=new Date,t=jV[e.getUTCDay()],r=OV[e.getUTCMonth()],n=e.getUTCDate();let s=e.getUTCHours();s<10&&(s=`0${s}`);let a=e.getUTCMinutes();a<10&&(a=`0${a}`);let i=e.getUTCSeconds();i<10&&(i=`0${i}`);const o=e.getUTCFullYear();return`${t} ${r} ${n} ${s}:${a}:${i} UTC ${o}`},p8=({userPoolName:e,username:t,challengeParameters:r,dateNow:n,hkdf:s})=>{const a=Sx.convert(e),i=Sx.convert(t),o=DV(r.SECRET_BLOCK),c=Sx.convert(n),f=new Uint8Array(a.byteLength+i.byteLength+o.byteLength+c.byteLength);f.set(a,0),f.set(i,a.byteLength),f.set(o,a.byteLength+i.byteLength),f.set(c,a.byteLength+i.byteLength+o.byteLength);const h=new zx(s);h.update(f);const p=h.digestSync();return o0.convert(p)},DV=e=>{const t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/-/g,"+").replace(/_/g,"/"),n=TE.convert(r),s=new Uint8Array(n.length);for(let a=0;a<n.length;++a)s[a]=n.charCodeAt(a);return s};async function UE({username:e,config:t,clientMetadata:r,session:n,tokenOrchestrator:s}){const{userPoolId:a,userPoolEndpoint:i}=t,o=t.userPoolClientId,c=await(s==null?void 0:s.getDeviceMetadata(e));a8(c);const f=await c1(c.deviceGroupKey),h={USERNAME:e,SRP_A:f.A.toString(16),DEVICE_KEY:c.deviceKey},p={ChallengeName:"DEVICE_SRP_AUTH",ClientId:o,ChallengeResponses:h,ClientMetadata:r,Session:n},x=o1({endpointResolver:En({endpointOverride:i})}),{ChallengeParameters:g,Session:v}=await x({region:_n(a)},p);return IV(e,g,r,v,f,t,s)}async function IV(e,t,r,n,s,{userPoolId:a,userPoolClientId:i,userPoolEndpoint:o},c){const f=await(c==null?void 0:c.getDeviceMetadata(e));a8(f);const h=new lt(t==null?void 0:t.SRP_B,16),p=new lt(t==null?void 0:t.SALT,16),{deviceKey:x}=f,{deviceGroupKey:g}=f,v=await s.getPasswordAuthenticationKey({username:f.deviceKey,password:f.randomPassword,serverBValue:h,salt:p}),y=h8(),w={USERNAME:(t==null?void 0:t.USERNAME)??e,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:y,PASSWORD_CLAIM_SIGNATURE:p8({username:x,userPoolName:g,challengeParameters:t,dateNow:y,hkdf:v}),DEVICE_KEY:x},_=fi({username:e,userPoolId:a,userPoolClientId:i}),S={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:i,ChallengeResponses:w,Session:n,ClientMetadata:r,UserContextData:_};return o1({endpointResolver:En({endpointOverride:o})})({region:_n(a)},S)}async function m8(e,t,r,n,s,a,i){const{userPoolId:o,userPoolClientId:c,userPoolEndpoint:f}=a,h=(o==null?void 0:o.split("_")[1])||"",p=new lt(t==null?void 0:t.SRP_B,16),x=new lt(t==null?void 0:t.SALT,16),g=t==null?void 0:t.USER_ID_FOR_SRP;if(!g)throw new Tt({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const v=await s.getPasswordAuthenticationKey({username:g,password:e,serverBValue:p,salt:x}),y=h8(),w={USERNAME:g,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:y,PASSWORD_CLAIM_SIGNATURE:p8({username:g,userPoolName:h,challengeParameters:t,dateNow:y,hkdf:v})},_=await i.getDeviceMetadata(g);_&&_.deviceKey&&(w.DEVICE_KEY=_.deviceKey);const S=fi({username:g,userPoolId:o,userPoolClientId:c}),E={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:w,ClientMetadata:r,Session:n,ClientId:c,UserContextData:S},k=await o1({endpointResolver:En({endpointOverride:f})})({region:_n(o)},E);return k.ChallengeName==="DEVICE_SRP_AUTH"?UE({username:g,config:a,clientMetadata:r,session:k.Session,tokenOrchestrator:i}):k}async function u1(e,t,r,n){try{return await e(...t)}catch(s){if(s instanceof Tt&&s.name==="ResourceNotFoundException"&&s.message.includes("Device does not exist."))return await n.clearDeviceMetadata(r),e(...t);throw s}}function H0(e){const{dispatch:t}=Pl;t({type:"SET_USERNAME",value:e})}async function x8({username:e,password:t,clientMetadata:r,config:n,tokenOrchestrator:s,authFlow:a,preferredChallenge:i}){const{userPoolId:o,userPoolClientId:c,userPoolEndpoint:f}=n,h=(o==null?void 0:o.split("_")[1])||"",p=await c1(h),x={USERNAME:e,SRP_A:p.A.toString(16)};a==="USER_AUTH"&&i&&(x.PREFERRED_CHALLENGE=i);const g=fi({username:e,userPoolId:o,userPoolClientId:c}),v={AuthFlow:a,AuthParameters:x,ClientMetadata:r,ClientId:c,UserContextData:g},w=await z0({endpointResolver:En({endpointOverride:f})})({region:_n(o),userAgentValue:ua(Ss.SignIn)},v),{ChallengeParameters:_,Session:S}=w,E=(_==null?void 0:_.USERNAME)??e;return H0(E),w.ChallengeName==="PASSWORD_VERIFIER"?u1(m8,[t,_,r,S,p,n,s],E,s):w}const H4="userAttributes.";function MV(e){return"isSignedIn"in e&&"nextStep"in e}async function FV(e,t,r,n,s){var y,w;const{userPoolClientId:a,userPoolId:i,userPoolEndpoint:o}=n,c={USERNAME:e,PASSWORD:t},f=await s.getDeviceMetadata(e);f&&f.deviceKey&&(c.DEVICE_KEY=f.deviceKey);const h=fi({username:e,userPoolId:i,userPoolClientId:a}),p={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:c,ClientMetadata:r,ClientId:a,UserContextData:h},g=await z0({endpointResolver:En({endpointOverride:o})})({region:_n(i),userAgentValue:ua(Ss.SignIn)},p),v=((y=g.ChallengeParameters)==null?void 0:y.USERNAME)??((w=g.ChallengeParameters)==null?void 0:w.USER_ID_FOR_SRP)??e;return H0(v),g.ChallengeName==="DEVICE_SRP_AUTH"?UE({username:v,config:n,clientMetadata:r,session:g.Session,tokenOrchestrator:s}):g}async function PV(e,t,r,n,s){return x8({username:e,password:t,clientMetadata:r,config:n,tokenOrchestrator:s,authFlow:"USER_SRP_AUTH"})}async function LV(e,t,r,n){var v;const{userPoolClientId:s,userPoolId:a,userPoolEndpoint:i}=r,o={USERNAME:e},c=await n.getDeviceMetadata(e);c&&c.deviceKey&&(o.DEVICE_KEY=c.deviceKey);const f=fi({username:e,userPoolId:a,userPoolClientId:s}),h={AuthFlow:"CUSTOM_AUTH",AuthParameters:o,ClientMetadata:t,ClientId:s,UserContextData:f},x=await z0({endpointResolver:En({endpointOverride:i})})({region:_n(a),userAgentValue:ua(Ss.SignIn)},h),g=((v=x.ChallengeParameters)==null?void 0:v.USERNAME)??e;return H0(g),x.ChallengeName==="DEVICE_SRP_AUTH"?UE({username:g,config:r,clientMetadata:t,session:x.Session,tokenOrchestrator:n}):x}async function BV(e,t,r,n,s){Zt(n);const{userPoolId:a,userPoolClientId:i,userPoolEndpoint:o}=n,c=(a==null?void 0:a.split("_")[1])||"",f=await c1(c),h={USERNAME:e,SRP_A:f.A.toString(16),CHALLENGE_NAME:"SRP_A"},p=fi({username:e,userPoolId:a,userPoolClientId:i}),x={AuthFlow:"CUSTOM_AUTH",AuthParameters:h,ClientMetadata:r,ClientId:i,UserContextData:p},g=z0({endpointResolver:En({endpointOverride:o})}),{ChallengeParameters:v,Session:y}=await g({region:_n(a),userAgentValue:ua(Ss.SignIn)},x),w=(v==null?void 0:v.USERNAME)??e;return H0(w),u1(m8,[t,v,r,y,f,n,s],w,s)}async function sd(e){var a;const{challengeName:t,challengeParameters:r,availableChallenges:n}=e,s=(a=Sr.getConfig().Auth)==null?void 0:a.Cognito;switch(Zt(s),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:r}};case"MFA_SETUP":{const{signInSession:i,username:o}=Pl.getState(),c=V4(q4(r.MFAS_CAN_SETUP))||[],f=VV(c),h=f.includes("TOTP"),p=f.includes("EMAIL");if(h&&p)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:f}};if(p)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(h){const x=uH({endpointResolver:En({endpointOverride:s.userPoolEndpoint})}),{Session:g,SecretCode:v}=await x({region:_n(s.userPoolId)},{Session:i});return Pl.dispatch({type:"SET_SIGN_IN_SESSION",value:g}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:UV(v,o)}}}throw new Tt({name:Tf.SignInException,message:`Cannot initiate MFA setup from available types: ${c}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:zV(r.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:V4(q4(r.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:r.CODE_DELIVERY_DELIVERY_MEDIUM,destination:r.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:r.CODE_DELIVERY_DELIVERY_MEDIUM,destination:r.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{const i=await RV(r);return MV(i)?i:sd(i)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:n}}}throw new Tt({name:Tf.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function UV(e,t){return{sharedSecret:e,getSetupUri:(r,n)=>{const s=`otpauth://totp/${r}:${n??t}?secret=${e}&issuer=${r}`;return new B0(s)}}}function V0(e){if(e===Hx.PasswordResetRequiredException)return{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}};if(e===Hx.UserNotConfirmedException)return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}}function zV(e){return e?JSON.parse(e).map(r=>r.includes(H4)?r.replace(H4,""):r):[]}function HV(e){if(e==="SMS_MFA")return"SMS";if(e==="SOFTWARE_TOKEN_MFA")return"TOTP";if(e==="EMAIL_OTP")return"EMAIL"}function V4(e){if(e)return e.map(HV).filter(Boolean)}function q4(e){return e?JSON.parse(e):[]}function VV(e){return e.filter(t=>t==="EMAIL"||t==="TOTP")}async function qV(){let e;try{e=await o8()}catch{}if(e&&e.userId&&e.username)throw new Tt({name:Hz,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}function q0(e){return Pl.getState().username??e}async function WV(e){var o;const t=(o=Sr.getConfig().Auth)==null?void 0:o.Cognito;Zt(t);const{username:r,password:n,options:s}=e,a={loginId:r,authFlowType:"CUSTOM_WITHOUT_SRP"},i=s==null?void 0:s.clientMetadata;Yr(!!r,At.EmptySignInUsername),Yr(!n,At.CustomAuthSignInPassword);try{const{ChallengeName:c,ChallengeParameters:f,AuthenticationResult:h,Session:p}=await u1(LV,[r,i,t,za],r,za),x=q0(r);return ed({signInSession:p,username:x,challengeName:c,signInDetails:a}),h?(await Zf({username:x,...h,NewDeviceMetadata:await nd({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:h.NewDeviceMetadata,accessToken:h.AccessToken}),signInDetails:a}),Pi(),await Qf(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:c,challengeParameters:f})}catch(c){Pi(),li(c);const f=V0(c.name);if(f)return f;throw c}}async function $V(e){var o;const{username:t,password:r,options:n}=e,s={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},a=(o=Sr.getConfig().Auth)==null?void 0:o.Cognito;Zt(a);const i=n==null?void 0:n.clientMetadata;Yr(!!t,At.EmptySignInUsername),Yr(!!r,At.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:f,AuthenticationResult:h,Session:p}=await BV(t,r,i,a,za),x=q0(t);return ed({signInSession:p,username:x,challengeName:c,signInDetails:s}),h?(await Zf({username:x,...h,NewDeviceMetadata:await nd({userPoolId:a.userPoolId,userPoolEndpoint:a.userPoolEndpoint,newDeviceMetadata:h.NewDeviceMetadata,accessToken:h.AccessToken}),signInDetails:s}),Pi(),await Qf(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:c,challengeParameters:f})}catch(c){Pi(),li(c);const f=V0(c.name);if(f)return f;throw c}}function Oo(e=!0){Nl.dispatch({type:"RESET"})}async function W4(e){var i,o;const{username:t,password:r}=e,n=(i=Sr.getConfig().Auth)==null?void 0:i.Cognito,s={loginId:t,authFlowType:"USER_SRP_AUTH"};Zt(n);const a=(o=e.options)==null?void 0:o.clientMetadata;Yr(!!t,At.EmptySignInUsername),Yr(!!r,At.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:f,AuthenticationResult:h,Session:p}=await PV(t,r,a,n,za),x=q0(t);return ed({signInSession:p,username:x,challengeName:c,signInDetails:s}),h?(await Zf({username:x,...h,NewDeviceMetadata:await nd({userPoolId:n.userPoolId,userPoolEndpoint:n.userPoolEndpoint,newDeviceMetadata:h.NewDeviceMetadata,accessToken:h.AccessToken}),signInDetails:s}),Pi(),await Qf(),Oo(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:c,challengeParameters:f})}catch(c){Pi(),Oo(),li(c);const f=V0(c.name);if(f)return f;throw c}}async function GV(e){var o;const{username:t,password:r,options:n}=e,s=(o=Sr.getConfig().Auth)==null?void 0:o.Cognito,a={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};Zt(s);const i=n==null?void 0:n.clientMetadata;Yr(!!t,At.EmptySignInUsername),Yr(!!r,At.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:f,AuthenticationResult:h,Session:p}=await u1(FV,[t,r,i,s,za],t,za),x=q0(t);return ed({signInSession:p,username:x,challengeName:c,signInDetails:a}),h?(await Zf({...h,username:x,NewDeviceMetadata:await nd({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:h.NewDeviceMetadata,accessToken:h.AccessToken}),signInDetails:a}),Pi(),await Qf(),Oo(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:c,challengeParameters:f})}catch(c){Pi(),Oo(),li(c);const f=V0(c.name);if(f)return f;throw c}}async function KV({username:e,clientMetadata:t,config:r,tokenOrchestrator:n,preferredChallenge:s,password:a,session:i}){const{userPoolId:o,userPoolClientId:c,userPoolEndpoint:f}=r,h=fi({username:e,userPoolId:o,userPoolClientId:c}),p={USERNAME:e};if(s){if(r.passwordless&&(s==="EMAIL_OTP"&&!r.passwordless.emailOtpEnabled||s==="SMS_OTP"&&!r.passwordless.smsOtpEnabled||s==="WEB_AUTHN"&&!r.passwordless.webAuthn)&&Yr(!1,At.InvalidPreferredChallenge),s==="PASSWORD_SRP")return Yr(!!a,At.EmptySignInPassword),x8({username:e,password:a,clientMetadata:t,config:r,tokenOrchestrator:n,authFlow:"USER_AUTH",preferredChallenge:s});s==="PASSWORD"&&(Yr(!!a,At.EmptySignInPassword),p.PASSWORD=a),p.PREFERRED_CHALLENGE=s}const x={AuthFlow:"USER_AUTH",AuthParameters:p,ClientMetadata:t,ClientId:c,UserContextData:h};i&&(x.Session=i);const v=await z0({endpointResolver:En({endpointOverride:f})})({region:_n(o),userAgentValue:ua(Ss.SignIn)},x);return H0(e),v}async function XV(e){var c,f;const{username:t,password:r,options:n}=e,s=(c=Sr.getConfig().Auth)==null?void 0:c.Cognito,a={loginId:t,authFlowType:"USER_AUTH"};Zt(s);const i=n==null?void 0:n.clientMetadata,o=(n==null?void 0:n.preferredChallenge)??((f=s==null?void 0:s.passwordless)==null?void 0:f.preferredChallenge);Yr(!!t,At.EmptySignInUsername);try{const h={username:t,config:s,tokenOrchestrator:za,clientMetadata:i,preferredChallenge:o,password:r},p=Nl.getState();p.active&&p.username===t&&(h.session=p.session);const x=await KV(h),g=q0(t);return ed({signInSession:x.Session,username:g,challengeName:x.ChallengeName,signInDetails:a}),x.AuthenticationResult?(await Zf({username:g,...x.AuthenticationResult,NewDeviceMetadata:await nd({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:x.AuthenticationResult.NewDeviceMetadata,accessToken:x.AuthenticationResult.AccessToken}),signInDetails:a}),Pi(),await Qf(),Oo(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):sd({challengeName:x.ChallengeName,challengeParameters:x.ChallengeParameters,availableChallenges:"AvailableChallenges"in x?x.AvailableChallenges:void 0})}catch(h){Pi(),Oo(),li(h);const p=V0(h.name);if(p)return p;throw h}}async function YV(e){var r;Oo(!1);const t=(r=e.options)==null?void 0:r.authFlowType;switch(await qV(),t){case"USER_SRP_AUTH":return W4(e);case"USER_PASSWORD_AUTH":return GV(e);case"CUSTOM_WITHOUT_SRP":return WV(e);case"CUSTOM_WITH_SRP":return $V(e);case"USER_AUTH":return XV(e);default:return W4(e)}}const JV=180*1e3;function ZV(e){const t=Ux.listen("auth-internal",async({payload:n})=>{switch(n.event){case"confirmSignUp":{const s=n.data;s!=null&&s.isSignUpComplete&&(Ux.dispatch("auth-internal",{event:"autoSignIn"}),t())}}}),r=setTimeout(()=>{t(),clearTimeout(r),Oo()},JV)}const QV=()=>async e=>{if(e.statusCode>=300){const t=await Jf(e);if(li(t),t.name===h_.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){const r=At.EmptySignUpPassword,{message:n,recoverySuggestion:s}=n8[r];throw new Tt({name:r,message:n,recoverySuggestion:s})}throw new Tt({name:t.name,message:t.message})}return L0(e)},eq=e=>qs(qa,Va("SignUp"),QV(),{...Wa,...e});async function tq(e){var D;const{username:t,password:r,options:n}=e,s=(D=Sr.getConfig().Auth)==null?void 0:D.Cognito,a=(s==null?void 0:s.signUpVerificationMethod)??"code",{clientMetadata:i,validationData:o,autoSignIn:c}=e.options??{};Zt(s),Yr(!!t,At.EmptySignUpUsername);const f=typeof c!="boolean"?c:void 0;f==null||f.authFlowType;const{userPoolId:h,userPoolClientId:p,userPoolEndpoint:x}=s,g=eq({endpointResolver:En({endpointOverride:x})}),v={Username:t,Password:void 0,UserAttributes:(n==null?void 0:n.userAttributes)&&d_(n==null?void 0:n.userAttributes),ClientMetadata:i,ValidationData:o&&d_(o),ClientId:p,UserContextData:fi({username:t,userPoolId:h,userPoolClientId:p})};r&&(v.Password=r);const{UserSub:y,CodeDeliveryDetails:w,UserConfirmed:_,Session:S}=await g({region:_n(h),userAgentValue:ua(Ss.SignUp)},v);(f||c===!0)&&(Nl.dispatch({type:"START"}),Nl.dispatch({type:"SET_USERNAME",value:t}),Nl.dispatch({type:"SET_SESSION",value:S}));const E={destination:w==null?void 0:w.Destination,deliveryMedium:w==null?void 0:w.DeliveryMedium,attributeName:w==null?void 0:w.AttributeName},T=!!_,k=Nl.getState().active;if(T)return k?{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:y}:{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:y};if(k){if(a==="link")return{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:E},userId:y};ZV()}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:E},userId:y}}const rq=e=>qs(qa,Va("ForgotPassword"),ui(),{...Wa,...e});async function nq(e){var p,x;const{username:t}=e;Yr(!!t,At.EmptyResetPasswordUsername);const r=(p=Sr.getConfig().Auth)==null?void 0:p.Cognito;Zt(r);const{userPoolClientId:n,userPoolId:s,userPoolEndpoint:a}=r,i=(x=e.options)==null?void 0:x.clientMetadata,o=fi({username:t,userPoolId:s,userPoolClientId:n}),h=(await rq({endpointResolver:En({endpointOverride:a})})({region:_n(s),userAgentValue:ua(Ss.ResetPassword)},{Username:t,ClientMetadata:i,ClientId:n,UserContextData:o})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:h==null?void 0:h.DeliveryMedium,destination:h==null?void 0:h.Destination,attributeName:h==null?void 0:h.AttributeName}}}}const sq=e=>qs(qa,Va("ConfirmForgotPassword"),ui(),{...Wa,...e});async function aq(e){var p,x;const t=(p=Sr.getConfig().Auth)==null?void 0:p.Cognito;Zt(t);const{userPoolClientId:r,userPoolId:n,userPoolEndpoint:s}=t,{username:a,newPassword:i}=e;Yr(!!a,At.EmptyConfirmResetPasswordUsername),Yr(!!i,At.EmptyConfirmResetPasswordNewPassword);const o=e.confirmationCode;Yr(!!o,At.EmptyConfirmResetPasswordConfirmationCode);const c=(x=e.options)==null?void 0:x.clientMetadata,f=fi({username:a,userPoolId:n,userPoolClientId:r});await sq({endpointResolver:En({endpointOverride:s})})({region:_n(t.userPoolId),userAgentValue:ua(Ss.ConfirmResetPassword)},{Username:a,ConfirmationCode:o,Password:i,ClientMetadata:c,ClientId:t.userPoolClientId,UserContextData:f})}const iq=e=>qs(qa,Va("ConfirmSignUp"),ui(),{...Wa,...e});async function oq(e){var x;const{username:t,confirmationCode:r,options:n}=e,s=(x=Sr.getConfig().Auth)==null?void 0:x.Cognito;Zt(s);const{userPoolId:a,userPoolClientId:i,userPoolEndpoint:o}=s,c=n==null?void 0:n.clientMetadata;Yr(!!t,At.EmptyConfirmSignUpUsername),Yr(!!r,At.EmptyConfirmSignUpCode);const f=fi({username:t,userPoolId:a,userPoolClientId:i}),h=iq({endpointResolver:En({endpointOverride:o})}),{Session:p}=await h({region:_n(s.userPoolId),userAgentValue:ua(Ss.ConfirmSignUp)},{Username:t,ConfirmationCode:r,ClientMetadata:c,ForceAliasCreation:n==null?void 0:n.forceAliasCreation,ClientId:s.userPoolClientId,UserContextData:f});return new Promise((g,v)=>{try{const y={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},w=Nl.getState();if(!w.active||w.username!==t){g(y),Oo();return}Nl.dispatch({type:"SET_SESSION",value:p});const _=Ux.listen("auth-internal",({payload:S})=>{switch(S.event){case"autoSignIn":g({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),_()}});Ux.dispatch("auth-internal",{event:"confirmSignUp",data:y})}catch(y){v(y)}})}const lq=e=>qs(qa,Va("ChangePassword"),ui(),{...Wa,...e});async function cq(e){var c;const t=(c=Sr.getConfig().Auth)==null?void 0:c.Cognito;Zt(t);const{userPoolEndpoint:r,userPoolId:n}=t,{oldPassword:s,newPassword:a}=e;Yr(!!s,At.EmptyUpdatePassword),Yr(!!a,At.EmptyUpdatePassword);const{tokens:i}=await s1({forceRefresh:!1});OE(i),await lq({endpointResolver:En({endpointOverride:r})})({region:_n(n),userAgentValue:ua(Ss.UpdatePassword)},{AccessToken:i.accessToken.toString(),PreviousPassword:s,ProposedPassword:a})}const uq=e=>qs(qa,Va("UpdateUserAttributes"),ui(),{...Wa,...e}),fq=async e=>{var h;const{userAttributes:t,options:r}=e,n=(h=Sr.getConfig().Auth)==null?void 0:h.Cognito,s=r==null?void 0:r.clientMetadata;Zt(n);const{userPoolEndpoint:a,userPoolId:i}=n,{tokens:o}=await s1({forceRefresh:!1});OE(o);const c=uq({endpointResolver:En({endpointOverride:a})}),{CodeDeliveryDetailsList:f}=await c({region:_n(i),userAgentValue:ua(Ss.UpdateUserAttributes)},{AccessToken:o.accessToken.toString(),ClientMetadata:s,UserAttributes:d_(t)});return{...dq(t),...hq(f)}};function dq(e){var r;const t={};return(r=Object.keys(e))==null||r.forEach(n=>{t[n]={isUpdated:!0,nextStep:{updateAttributeStep:"DONE"}}}),t}function hq(e){const t={};return e==null||e.forEach(r=>{const{AttributeName:n,DeliveryMedium:s,Destination:a}=r;n&&(t[n]={isUpdated:!1,nextStep:{updateAttributeStep:"CONFIRM_ATTRIBUTE_WITH_CODE",codeDeliveryDetails:{attributeName:n,deliveryMedium:s,destination:a}}})}),t}function pq(e,t){{const r=(e==null?void 0:e.find(mq))??(e==null?void 0:e.find(xq)),n=(e==null?void 0:e.find(yq))??(e==null?void 0:e.find(gq));if(r)return r;throw n?Xz:Gz}}const mq=e=>e.startsWith(String(window.location.origin+(window.location.pathname||"/"))),xq=e=>e.includes(String(window.location.hostname)),gq=e=>e.startsWith("http://"),yq=e=>e.startsWith("https://"),vq=async e=>{window!=null&&window.location&&(window.location.href=e.replace("http://","https://"))},bq=async e=>{await e.clearOAuthData(),za.clearTokens(),await Hj(),Nf.dispatch("auth",{event:"signedOut"},"Auth",Wc)},wq=async(e,t=!1,r)=>{Ij(e);const{loginWith:n,userPoolClientId:s}=e,{domain:a,redirectSignOut:i}=n.oauth,o=pq(i),c=`https://${a}/logout?${Object.entries({client_id:s,logout_uri:encodeURIComponent(o)}).map(([f,h])=>`${f}=${h}`).join("&")}`;return vq(c)},_q=async(e,t,r,n)=>{const{isOAuthSignIn:s}=await t.loadOAuthSignIn(),a=await r.getOAuthMetadata();if(await bq(t),s||a!=null&&a.oauthSignIn)return wq(e,!1)},Eq=e=>qs(qa,Va("RevokeToken"),ui(),{...Wa,...e}),Sq=new ia("Auth");async function $4(e){var n;const t=(n=Sr.getConfig().Auth)==null?void 0:n.Cognito;Zt(t),await Nq(t);let r;try{Ij(t),r=!0}catch{r=!1}if(r){const s=new c8(U0);s.setAuthConfig(t);const{type:a}=await _q(t,s,za)??{};if(a==="error")throw new Tt({name:Yz,message:"An error occurred when attempting to log out from OAuth provider."})}else za.clearTokens(),await Hj(),Nf.dispatch("auth",{event:"signedOut"},"Auth",Wc)}async function Nq(e){try{const{userPoolEndpoint:t,userPoolId:r,userPoolClientId:n}=e,s=await za.getTokenStore().loadTokens();s8(s),Tq(s.accessToken)&&await Eq({endpointResolver:En({endpointOverride:t})})({region:_n(r),userAgentValue:ua(Ss.SignOut)},{ClientId:n,Token:s.refreshToken})}catch{Sq.debug("Client signOut error caught but will proceed with token removal")}}const Tq=e=>{var t;return!!((t=e==null?void 0:e.payload)!=null&&t.origin_jti)},kq={identityId:"identityId"},Aq=new ia("DefaultIdentityIdStore");class g8{setAuthConfig(t){_x(t.Cognito),this.authConfig=t,this._authKeys=Cq("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=t}async loadIdentityId(){var t;_x((t=this.authConfig)==null?void 0:t.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const r=await this.keyValueStorage.getItem(this._authKeys.identityId);return r?(this._hasGuestIdentityId=!0,{id:r,type:"guest"}):null}}catch(r){return Aq.log("Error getting stored IdentityId.",r),null}}async storeIdentityId(t){var r;_x((r=this.authConfig)==null?void 0:r.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=t.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const Cq=(e,t)=>jE(kq)(`com.amplify.${e}`,t),x_=({endpointOverride:e})=>t=>e?{url:new B0(e)}:Cz(t);function y8(e){const t=$c(e).payload.iss,r={};if(!t)throw new Tt({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const n=t.replace(/(^\w+:|^)\/\//,"");return r[n]=e,r}async function Rq({tokens:e,authConfig:t,identityIdStore:r}){r.setAuthConfig({Cognito:t});const n=await r.loadIdentityId();if(n)return n.id;const s=e!=null&&e.idToken?y8(e.idToken.toString()):{},a=await Oq(s,t);return r.storeIdentityId({id:a,type:e?"primary":"guest"}),a}async function Oq(e,t){const r=t==null?void 0:t.identityPoolId,n=f_(r),s=Tz({endpointResolver:x_({endpointOverride:t.identityPoolEndpoint})});let a;try{a=(await s({region:n},{IdentityPoolId:r,Logins:e})).IdentityId}catch(i){throw li(i),new Tt(i)}if(!a)throw new Tt({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return a}const Mm=new ia("CognitoCredentialsProvider"),G4=3e3*1e3;class v8{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){Mm.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){Mm.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){const r=t.authenticated,{tokens:n}=t,{authConfig:s}=t;try{_x(s==null?void 0:s.Cognito)}catch{return}if(!r&&!s.Cognito.allowGuestAccess)return;const{forceRefresh:a}=t,i=this.hasTokenChanged(n),o=await Rq({tokens:n,authConfig:s.Cognito,identityIdStore:this._identityIdStore});return(a||i)&&this.clearCredentials(),r?(Qz(n),this.credsForOIDCTokens(s.Cognito,n,o)):this.getGuestCredentials(o,s.Cognito)}async getGuestCredentials(t,r){var i,o;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return Mm.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const n=f_(r.identityPoolId),s=l4({endpointResolver:x_({endpointOverride:r.identityPoolEndpoint})});let a;try{a=await s({region:n},{IdentityId:t})}catch(c){throw li(c),new Tt(c)}if((i=a==null?void 0:a.Credentials)!=null&&i.AccessKeyId&&((o=a==null?void 0:a.Credentials)!=null&&o.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+G4;const c={credentials:{accessKeyId:a.Credentials.AccessKeyId,secretAccessKey:a.Credentials.SecretKey,sessionToken:a.Credentials.SessionToken,expiration:a.Credentials.Expiration},identityId:t};return a.IdentityId&&(c.identityId=a.IdentityId,this._identityIdStore.storeIdentityId({id:a.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...c,isAuthenticatedCreds:!1},c}else throw new Tt({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,r,n){var c,f,h;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return Mm.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const s=r.idToken?y8(r.idToken.toString()):{},a=f_(t.identityPoolId),i=l4({endpointResolver:x_({endpointOverride:t.identityPoolEndpoint})});let o;try{o=await i({region:a},{IdentityId:n,Logins:s})}catch(p){throw li(p),new Tt(p)}if((c=o==null?void 0:o.Credentials)!=null&&c.AccessKeyId&&((f=o==null?void 0:o.Credentials)!=null&&f.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+G4;const p={credentials:{accessKeyId:o.Credentials.AccessKeyId,secretAccessKey:o.Credentials.SecretKey,sessionToken:o.Credentials.SessionToken,expiration:o.Credentials.Expiration},identityId:n};return o.IdentityId&&(p.identityId=o.IdentityId,this._identityIdStore.storeIdentityId({id:o.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...p,isAuthenticatedCreds:!0,associatedIdToken:(h=r.idToken)==null?void 0:h.toString()},p}else throw new Tt({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){var r,n;return!!t&&!!((r=this._credentialsAndIdentityId)!=null&&r.associatedIdToken)&&((n=t.idToken)==null?void 0:n.toString())!==this._credentialsAndIdentityId.associatedIdToken}}function b8(e,t){return function(){return e.apply(t,arguments)}}const{toString:jq}=Object.prototype,{getPrototypeOf:zE}=Object,{iterator:f1,toStringTag:w8}=Symbol,d1=(e=>t=>{const r=jq.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),di=e=>(e=e.toLowerCase(),t=>d1(t)===e),h1=e=>t=>typeof t===e,{isArray:ad}=Array,Af=h1("undefined");function W0(e){return e!==null&&!Af(e)&&e.constructor!==null&&!Af(e.constructor)&&Ps(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const _8=di("ArrayBuffer");function Dq(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&_8(e.buffer),t}const Iq=h1("string"),Ps=h1("function"),E8=h1("number"),$0=e=>e!==null&&typeof e=="object",Mq=e=>e===!0||e===!1,Tx=e=>{if(d1(e)!=="object")return!1;const t=zE(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(w8 in e)&&!(f1 in e)},Fq=e=>{if(!$0(e)||W0(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Pq=di("Date"),Lq=di("File"),Bq=di("Blob"),Uq=di("FileList"),zq=e=>$0(e)&&Ps(e.pipe),Hq=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ps(e.append)&&((t=d1(e))==="formdata"||t==="object"&&Ps(e.toString)&&e.toString()==="[object FormData]"))},Vq=di("URLSearchParams"),[qq,Wq,$q,Gq]=["ReadableStream","Request","Response","Headers"].map(di),Kq=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function G0(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),ad(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(W0(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let o;for(n=0;n<i;n++)o=a[n],t.call(null,e[o],o,e)}}function S8(e,t){if(W0(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const Nc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,N8=e=>!Af(e)&&e!==Nc;function g_(){const{caseless:e,skipUndefined:t}=N8(this)&&this||{},r={},n=(s,a)=>{const i=e&&S8(r,a)||a;Tx(r[i])&&Tx(s)?r[i]=g_(r[i],s):Tx(s)?r[i]=g_({},s):ad(s)?r[i]=s.slice():(!t||!Af(s))&&(r[i]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&G0(arguments[s],n);return r}const Xq=(e,t,r,{allOwnKeys:n}={})=>(G0(t,(s,a)=>{r&&Ps(s)?Object.defineProperty(e,a,{value:b8(s,r),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(e,a,{value:s,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:n}),e),Yq=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Jq=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Zq=(e,t,r,n)=>{let s,a,i;const o={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)i=s[a],(!n||n(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=r!==!1&&zE(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Qq=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},eW=e=>{if(!e)return null;if(ad(e))return e;let t=e.length;if(!E8(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},tW=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&zE(Uint8Array)),rW=(e,t)=>{const n=(e&&e[f1]).call(e);let s;for(;(s=n.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},nW=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},sW=di("HTMLFormElement"),aW=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),K4=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),iW=di("RegExp"),T8=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};G0(r,(s,a)=>{let i;(i=t(s,a,e))!==!1&&(n[a]=i||s)}),Object.defineProperties(e,n)},oW=e=>{T8(e,(t,r)=>{if(Ps(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Ps(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},lW=(e,t)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return ad(e)?n(e):n(String(e).split(t)),r},cW=()=>{},uW=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function fW(e){return!!(e&&Ps(e.append)&&e[w8]==="FormData"&&e[f1])}const dW=e=>{const t=new Array(10),r=(n,s)=>{if($0(n)){if(t.indexOf(n)>=0)return;if(W0(n))return n;if(!("toJSON"in n)){t[s]=n;const a=ad(n)?[]:{};return G0(n,(i,o)=>{const c=r(i,s+1);!Af(c)&&(a[o]=c)}),t[s]=void 0,a}}return n};return r(e,0)},hW=di("AsyncFunction"),pW=e=>e&&($0(e)||Ps(e))&&Ps(e.then)&&Ps(e.catch),k8=((e,t)=>e?setImmediate:t?((r,n)=>(Nc.addEventListener("message",({source:s,data:a})=>{s===Nc&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),Nc.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ps(Nc.postMessage)),mW=typeof queueMicrotask<"u"?queueMicrotask.bind(Nc):typeof process<"u"&&process.nextTick||k8,xW=e=>e!=null&&Ps(e[f1]),Me={isArray:ad,isArrayBuffer:_8,isBuffer:W0,isFormData:Hq,isArrayBufferView:Dq,isString:Iq,isNumber:E8,isBoolean:Mq,isObject:$0,isPlainObject:Tx,isEmptyObject:Fq,isReadableStream:qq,isRequest:Wq,isResponse:$q,isHeaders:Gq,isUndefined:Af,isDate:Pq,isFile:Lq,isBlob:Bq,isRegExp:iW,isFunction:Ps,isStream:zq,isURLSearchParams:Vq,isTypedArray:tW,isFileList:Uq,forEach:G0,merge:g_,extend:Xq,trim:Kq,stripBOM:Yq,inherits:Jq,toFlatObject:Zq,kindOf:d1,kindOfTest:di,endsWith:Qq,toArray:eW,forEachEntry:rW,matchAll:nW,isHTMLForm:sW,hasOwnProperty:K4,hasOwnProp:K4,reduceDescriptors:T8,freezeMethods:oW,toObjectSet:lW,toCamelCase:aW,noop:cW,toFiniteNumber:uW,findKey:S8,global:Nc,isContextDefined:N8,isSpecCompliantForm:fW,toJSONObject:dW,isAsyncFn:hW,isThenable:pW,setImmediate:k8,asap:mW,isIterable:xW};let Et=class A8 extends Error{static from(t,r,n,s,a,i){const o=new A8(t.message,r||t.code,n,s,a);return o.cause=t,o.name=t.name,i&&Object.assign(o,i),o}constructor(t,r,n,s,a){super(t),this.name="AxiosError",this.isAxiosError=!0,r&&(this.code=r),n&&(this.config=n),s&&(this.request=s),a&&(this.response=a,this.status=a.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Me.toJSONObject(this.config),code:this.code,status:this.status}}};Et.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";Et.ERR_BAD_OPTION="ERR_BAD_OPTION";Et.ECONNABORTED="ECONNABORTED";Et.ETIMEDOUT="ETIMEDOUT";Et.ERR_NETWORK="ERR_NETWORK";Et.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";Et.ERR_DEPRECATED="ERR_DEPRECATED";Et.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";Et.ERR_BAD_REQUEST="ERR_BAD_REQUEST";Et.ERR_CANCELED="ERR_CANCELED";Et.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";Et.ERR_INVALID_URL="ERR_INVALID_URL";const gW=null;function y_(e){return Me.isPlainObject(e)||Me.isArray(e)}function C8(e){return Me.endsWith(e,"[]")?e.slice(0,-2):e}function X4(e,t,r){return e?e.concat(t).map(function(s,a){return s=C8(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}function yW(e){return Me.isArray(e)&&!e.some(y_)}const vW=Me.toFlatObject(Me,{},null,function(t){return/^is[A-Z]/.test(t)});function p1(e,t,r){if(!Me.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Me.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,w){return!Me.isUndefined(w[y])});const n=r.metaTokens,s=r.visitor||h,a=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Me.isSpecCompliantForm(t);if(!Me.isFunction(s))throw new TypeError("visitor must be a function");function f(v){if(v===null)return"";if(Me.isDate(v))return v.toISOString();if(Me.isBoolean(v))return v.toString();if(!c&&Me.isBlob(v))throw new Et("Blob is not supported. Use a Buffer instead.");return Me.isArrayBuffer(v)||Me.isTypedArray(v)?c&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function h(v,y,w){let _=v;if(v&&!w&&typeof v=="object"){if(Me.endsWith(y,"{}"))y=n?y:y.slice(0,-2),v=JSON.stringify(v);else if(Me.isArray(v)&&yW(v)||(Me.isFileList(v)||Me.endsWith(y,"[]"))&&(_=Me.toArray(v)))return y=C8(y),_.forEach(function(E,T){!(Me.isUndefined(E)||E===null)&&t.append(i===!0?X4([y],T,a):i===null?y:y+"[]",f(E))}),!1}return y_(v)?!0:(t.append(X4(w,y,a),f(v)),!1)}const p=[],x=Object.assign(vW,{defaultVisitor:h,convertValue:f,isVisitable:y_});function g(v,y){if(!Me.isUndefined(v)){if(p.indexOf(v)!==-1)throw Error("Circular reference detected in "+y.join("."));p.push(v),Me.forEach(v,function(_,S){(!(Me.isUndefined(_)||_===null)&&s.call(t,_,Me.isString(S)?S.trim():S,y,x))===!0&&g(_,y?y.concat(S):[S])}),p.pop()}}if(!Me.isObject(e))throw new TypeError("data must be an object");return g(e),t}function Y4(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function HE(e,t){this._pairs=[],e&&p1(e,this,t)}const R8=HE.prototype;R8.append=function(t,r){this._pairs.push([t,r])};R8.toString=function(t){const r=t?function(n){return t.call(this,n,Y4)}:Y4;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function bW(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function O8(e,t,r){if(!t)return e;const n=r&&r.encode||bW,s=Me.isFunction(r)?{serialize:r}:r,a=s&&s.serialize;let i;if(a?i=a(t,s):i=Me.isURLSearchParams(t)?t.toString():new HE(t,s).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class J4{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Me.forEach(this.handlers,function(n){n!==null&&t(n)})}}const j8={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wW=typeof URLSearchParams<"u"?URLSearchParams:HE,_W=typeof FormData<"u"?FormData:null,EW=typeof Blob<"u"?Blob:null,SW={isBrowser:!0,classes:{URLSearchParams:wW,FormData:_W,Blob:EW},protocols:["http","https","file","blob","url","data"]},VE=typeof window<"u"&&typeof document<"u",v_=typeof navigator=="object"&&navigator||void 0,NW=VE&&(!v_||["ReactNative","NativeScript","NS"].indexOf(v_.product)<0),TW=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",kW=VE&&window.location.href||"http://localhost",AW=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:VE,hasStandardBrowserEnv:NW,hasStandardBrowserWebWorkerEnv:TW,navigator:v_,origin:kW},Symbol.toStringTag,{value:"Module"})),cs={...AW,...SW};function CW(e,t){return p1(e,new cs.classes.URLSearchParams,{visitor:function(r,n,s,a){return cs.isNode&&Me.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function RW(e){return Me.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function OW(e){const t={},r=Object.keys(e);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],t[a]=e[a];return t}function D8(e){function t(r,n,s,a){let i=r[a++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),c=a>=r.length;return i=!i&&Me.isArray(s)?s.length:i,c?(Me.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!o):((!s[i]||!Me.isObject(s[i]))&&(s[i]=[]),t(r,n,s[i],a)&&Me.isArray(s[i])&&(s[i]=OW(s[i])),!o)}if(Me.isFormData(e)&&Me.isFunction(e.entries)){const r={};return Me.forEachEntry(e,(n,s)=>{t(RW(n),s,r,0)}),r}return null}function jW(e,t,r){if(Me.isString(e))try{return(t||JSON.parse)(e),Me.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const K0={transitional:j8,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=Me.isObject(t);if(a&&Me.isHTMLForm(t)&&(t=new FormData(t)),Me.isFormData(t))return s?JSON.stringify(D8(t)):t;if(Me.isArrayBuffer(t)||Me.isBuffer(t)||Me.isStream(t)||Me.isFile(t)||Me.isBlob(t)||Me.isReadableStream(t))return t;if(Me.isArrayBufferView(t))return t.buffer;if(Me.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return CW(t,this.formSerializer).toString();if((o=Me.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return p1(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),jW(t)):t}],transformResponse:[function(t){const r=this.transitional||K0.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Me.isResponse(t)||Me.isReadableStream(t))return t;if(t&&Me.isString(t)&&(n&&!this.responseType||s)){const i=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(o){if(i)throw o.name==="SyntaxError"?Et.from(o,Et.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:cs.classes.FormData,Blob:cs.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Me.forEach(["delete","get","head","post","put","patch"],e=>{K0.headers[e]={}});const DW=Me.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),IW=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(i){s=i.indexOf(":"),r=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!r||t[r]&&DW[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Z4=Symbol("internals");function dh(e){return e&&String(e).trim().toLowerCase()}function kx(e){return e===!1||e==null?e:Me.isArray(e)?e.map(kx):String(e)}function MW(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const FW=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function bb(e,t,r,n,s){if(Me.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!Me.isString(t)){if(Me.isString(n))return t.indexOf(n)!==-1;if(Me.isRegExp(n))return n.test(t)}}function PW(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function LW(e,t){const r=Me.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,a,i){return this[n].call(this,t,s,a,i)},configurable:!0})})}let Ls=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function a(o,c,f){const h=dh(c);if(!h)throw new Error("header name must be a non-empty string");const p=Me.findKey(s,h);(!p||s[p]===void 0||f===!0||f===void 0&&s[p]!==!1)&&(s[p||c]=kx(o))}const i=(o,c)=>Me.forEach(o,(f,h)=>a(f,h,c));if(Me.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(Me.isString(t)&&(t=t.trim())&&!FW(t))i(IW(t),r);else if(Me.isObject(t)&&Me.isIterable(t)){let o={},c,f;for(const h of t){if(!Me.isArray(h))throw TypeError("Object iterator must return a key-value pair");o[f=h[0]]=(c=o[f])?Me.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}i(o,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=dh(t),t){const n=Me.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return MW(s);if(Me.isFunction(r))return r.call(this,s,n);if(Me.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=dh(t),t){const n=Me.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||bb(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function a(i){if(i=dh(i),i){const o=Me.findKey(n,i);o&&(!r||bb(n,n[o],o,r))&&(delete n[o],s=!0)}}return Me.isArray(t)?t.forEach(a):a(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!t||bb(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const r=this,n={};return Me.forEach(this,(s,a)=>{const i=Me.findKey(n,a);if(i){r[i]=kx(s),delete r[a];return}const o=t?PW(a):String(a).trim();o!==a&&delete r[a],r[o]=kx(s),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Me.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&Me.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[Z4]=this[Z4]={accessors:{}}).accessors,s=this.prototype;function a(i){const o=dh(i);n[o]||(LW(s,i),n[o]=!0)}return Me.isArray(t)?t.forEach(a):a(t),this}};Ls.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Me.reduceDescriptors(Ls.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Me.freezeMethods(Ls);function wb(e,t){const r=this||K0,n=t||r,s=Ls.from(n.headers);let a=n.data;return Me.forEach(e,function(o){a=o.call(r,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function I8(e){return!!(e&&e.__CANCEL__)}let X0=class extends Et{constructor(t,r,n){super(t??"canceled",Et.ERR_CANCELED,r,n),this.name="CanceledError",this.__CANCEL__=!0}};function M8(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Et("Request failed with status code "+r.status,[Et.ERR_BAD_REQUEST,Et.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function BW(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function UW(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,a=0,i;return t=t!==void 0?t:1e3,function(c){const f=Date.now(),h=n[a];i||(i=f),r[s]=c,n[s]=f;let p=a,x=0;for(;p!==s;)x+=r[p++],p=p%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),f-i<t)return;const g=h&&f-h;return g?Math.round(x*1e3/g):void 0}}function zW(e,t){let r=0,n=1e3/t,s,a;const i=(f,h=Date.now())=>{r=h,s=null,a&&(clearTimeout(a),a=null),e(...f)};return[(...f)=>{const h=Date.now(),p=h-r;p>=n?i(f,h):(s=f,a||(a=setTimeout(()=>{a=null,i(s)},n-p)))},()=>s&&i(s)]}const Wx=(e,t,r=3)=>{let n=0;const s=UW(50,250);return zW(a=>{const i=a.loaded,o=a.lengthComputable?a.total:void 0,c=i-n,f=s(c),h=i<=o;n=i;const p={loaded:i,total:o,progress:o?i/o:void 0,bytes:c,rate:f||void 0,estimated:f&&o&&h?(o-i)/f:void 0,event:a,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(p)},r)},Q4=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},e3=e=>(...t)=>Me.asap(()=>e(...t)),HW=cs.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,cs.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(cs.origin),cs.navigator&&/(msie|trident)/i.test(cs.navigator.userAgent)):()=>!0,VW=cs.hasStandardBrowserEnv?{write(e,t,r,n,s,a,i){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];Me.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),Me.isString(n)&&o.push(`path=${n}`),Me.isString(s)&&o.push(`domain=${s}`),a===!0&&o.push("secure"),Me.isString(i)&&o.push(`SameSite=${i}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function qW(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function WW(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function F8(e,t,r){let n=!qW(t);return e&&(n||r==!1)?WW(e,t):t}const t3=e=>e instanceof Ls?{...e}:e;function Gc(e,t){t=t||{};const r={};function n(f,h,p,x){return Me.isPlainObject(f)&&Me.isPlainObject(h)?Me.merge.call({caseless:x},f,h):Me.isPlainObject(h)?Me.merge({},h):Me.isArray(h)?h.slice():h}function s(f,h,p,x){if(Me.isUndefined(h)){if(!Me.isUndefined(f))return n(void 0,f,p,x)}else return n(f,h,p,x)}function a(f,h){if(!Me.isUndefined(h))return n(void 0,h)}function i(f,h){if(Me.isUndefined(h)){if(!Me.isUndefined(f))return n(void 0,f)}else return n(void 0,h)}function o(f,h,p){if(p in t)return n(f,h);if(p in e)return n(void 0,f)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(f,h,p)=>s(t3(f),t3(h),p,!0)};return Me.forEach(Object.keys({...e,...t}),function(h){const p=c[h]||s,x=p(e[h],t[h],h);Me.isUndefined(x)&&p!==o||(r[h]=x)}),r}const P8=e=>{const t=Gc({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:i,auth:o}=t;if(t.headers=i=Ls.from(i),t.url=O8(F8(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Me.isFormData(r)){if(cs.hasStandardBrowserEnv||cs.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Me.isFunction(r.getHeaders)){const c=r.getHeaders(),f=["content-type","content-length"];Object.entries(c).forEach(([h,p])=>{f.includes(h.toLowerCase())&&i.set(h,p)})}}if(cs.hasStandardBrowserEnv&&(n&&Me.isFunction(n)&&(n=n(t)),n||n!==!1&&HW(t.url))){const c=s&&a&&VW.read(a);c&&i.set(s,c)}return t},$W=typeof XMLHttpRequest<"u",GW=$W&&function(e){return new Promise(function(r,n){const s=P8(e);let a=s.data;const i=Ls.from(s.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:f}=s,h,p,x,g,v;function y(){g&&g(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(h),s.signal&&s.signal.removeEventListener("abort",h)}let w=new XMLHttpRequest;w.open(s.method.toUpperCase(),s.url,!0),w.timeout=s.timeout;function _(){if(!w)return;const E=Ls.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),k={data:!o||o==="text"||o==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:E,config:e,request:w};M8(function(O){r(O),y()},function(O){n(O),y()},k),w=null}"onloadend"in w?w.onloadend=_:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(_)},w.onabort=function(){w&&(n(new Et("Request aborted",Et.ECONNABORTED,e,w)),w=null)},w.onerror=function(T){const k=T&&T.message?T.message:"Network Error",D=new Et(k,Et.ERR_NETWORK,e,w);D.event=T||null,n(D),w=null},w.ontimeout=function(){let T=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const k=s.transitional||j8;s.timeoutErrorMessage&&(T=s.timeoutErrorMessage),n(new Et(T,k.clarifyTimeoutError?Et.ETIMEDOUT:Et.ECONNABORTED,e,w)),w=null},a===void 0&&i.setContentType(null),"setRequestHeader"in w&&Me.forEach(i.toJSON(),function(T,k){w.setRequestHeader(k,T)}),Me.isUndefined(s.withCredentials)||(w.withCredentials=!!s.withCredentials),o&&o!=="json"&&(w.responseType=s.responseType),f&&([x,v]=Wx(f,!0),w.addEventListener("progress",x)),c&&w.upload&&([p,g]=Wx(c),w.upload.addEventListener("progress",p),w.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(h=E=>{w&&(n(!E||E.type?new X0(null,e,w):E),w.abort(),w=null)},s.cancelToken&&s.cancelToken.subscribe(h),s.signal&&(s.signal.aborted?h():s.signal.addEventListener("abort",h)));const S=BW(s.url);if(S&&cs.protocols.indexOf(S)===-1){n(new Et("Unsupported protocol "+S+":",Et.ERR_BAD_REQUEST,e));return}w.send(a||null)})},KW=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const a=function(f){if(!s){s=!0,o();const h=f instanceof Error?f:this.reason;n.abort(h instanceof Et?h:new X0(h instanceof Error?h.message:h))}};let i=t&&setTimeout(()=>{i=null,a(new Et(`timeout of ${t}ms exceeded`,Et.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),e=null)};e.forEach(f=>f.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>Me.asap(o),c}},XW=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},YW=async function*(e,t){for await(const r of JW(e))yield*XW(r,t)},JW=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},r3=(e,t,r,n)=>{const s=YW(e,t);let a=0,i,o=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:f,value:h}=await s.next();if(f){o(),c.close();return}let p=h.byteLength;if(r){let x=a+=p;r(x)}c.enqueue(new Uint8Array(h))}catch(f){throw o(f),f}},cancel(c){return o(c),s.return()}},{highWaterMark:2})},n3=64*1024,{isFunction:Fm}=Me,ZW=(({Request:e,Response:t})=>({Request:e,Response:t}))(Me.global),{ReadableStream:s3,TextEncoder:a3}=Me.global,i3=(e,...t)=>{try{return!!e(...t)}catch{return!1}},QW=e=>{e=Me.merge.call({skipUndefined:!0},ZW,e);const{fetch:t,Request:r,Response:n}=e,s=t?Fm(t):typeof fetch=="function",a=Fm(r),i=Fm(n);if(!s)return!1;const o=s&&Fm(s3),c=s&&(typeof a3=="function"?(v=>y=>v.encode(y))(new a3):async v=>new Uint8Array(await new r(v).arrayBuffer())),f=a&&o&&i3(()=>{let v=!1;const y=new r(cs.origin,{body:new s3,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!y}),h=i&&o&&i3(()=>Me.isReadableStream(new n("").body)),p={stream:h&&(v=>v.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!p[v]&&(p[v]=(y,w)=>{let _=y&&y[v];if(_)return _.call(y);throw new Et(`Response type '${v}' is not supported`,Et.ERR_NOT_SUPPORT,w)})});const x=async v=>{if(v==null)return 0;if(Me.isBlob(v))return v.size;if(Me.isSpecCompliantForm(v))return(await new r(cs.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(Me.isArrayBufferView(v)||Me.isArrayBuffer(v))return v.byteLength;if(Me.isURLSearchParams(v)&&(v=v+""),Me.isString(v))return(await c(v)).byteLength},g=async(v,y)=>{const w=Me.toFiniteNumber(v.getContentLength());return w??x(y)};return async v=>{let{url:y,method:w,data:_,signal:S,cancelToken:E,timeout:T,onDownloadProgress:k,onUploadProgress:D,responseType:O,headers:z,withCredentials:j="same-origin",fetchOptions:J}=P8(v),ae=t||fetch;O=O?(O+"").toLowerCase():"text";let F=KW([S,E&&E.toAbortSignal()],T),X=null;const P=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let le;try{if(D&&f&&w!=="get"&&w!=="head"&&(le=await g(z,_))!==0){let K=new r(y,{method:"POST",body:_,duplex:"half"}),M;if(Me.isFormData(_)&&(M=K.headers.get("content-type"))&&z.setContentType(M),K.body){const[q,G]=Q4(le,Wx(e3(D)));_=r3(K.body,n3,q,G)}}Me.isString(j)||(j=j?"include":"omit");const ee=a&&"credentials"in r.prototype,te={...J,signal:F,method:w.toUpperCase(),headers:z.normalize().toJSON(),body:_,duplex:"half",credentials:ee?j:void 0};X=a&&new r(y,te);let me=await(a?ae(X,J):ae(y,te));const ie=h&&(O==="stream"||O==="response");if(h&&(k||ie&&P)){const K={};["status","statusText","headers"].forEach(Z=>{K[Z]=me[Z]});const M=Me.toFiniteNumber(me.headers.get("content-length")),[q,G]=k&&Q4(M,Wx(e3(k),!0))||[];me=new n(r3(me.body,n3,q,()=>{G&&G(),P&&P()}),K)}O=O||"text";let Ee=await p[Me.findKey(p,O)||"text"](me,v);return!ie&&P&&P(),await new Promise((K,M)=>{M8(K,M,{data:Ee,headers:Ls.from(me.headers),status:me.status,statusText:me.statusText,config:v,request:X})})}catch(ee){throw P&&P(),ee&&ee.name==="TypeError"&&/Load failed|fetch/i.test(ee.message)?Object.assign(new Et("Network Error",Et.ERR_NETWORK,v,X),{cause:ee.cause||ee}):Et.from(ee,ee&&ee.code,v,X)}}},e$=new Map,L8=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:s}=t,a=[n,s,r];let i=a.length,o=i,c,f,h=e$;for(;o--;)c=a[o],f=h.get(c),f===void 0&&h.set(c,f=o?new Map:QW(t)),h=f;return f};L8();const qE={http:gW,xhr:GW,fetch:{get:L8}};Me.forEach(qE,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const o3=e=>`- ${e}`,t$=e=>Me.isFunction(e)||e===null||e===!1;function r$(e,t){e=Me.isArray(e)?e:[e];const{length:r}=e;let n,s;const a={};for(let i=0;i<r;i++){n=e[i];let o;if(s=n,!t$(n)&&(s=qE[(o=String(n)).toLowerCase()],s===void 0))throw new Et(`Unknown adapter '${o}'`);if(s&&(Me.isFunction(s)||(s=s.get(t))))break;a[o||"#"+i]=s}if(!s){const i=Object.entries(a).map(([c,f])=>`adapter ${c} `+(f===!1?"is not supported by the environment":"is not available in the build"));let o=r?i.length>1?`since :
`+i.map(o3).join(`
`):" "+o3(i[0]):"as no adapter specified";throw new Et("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s}const B8={getAdapter:r$,adapters:qE};function _b(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new X0(null,e)}function l3(e){return _b(e),e.headers=Ls.from(e.headers),e.data=wb.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),B8.getAdapter(e.adapter||K0.adapter,e)(e).then(function(n){return _b(e),n.data=wb.call(e,e.transformResponse,n),n.headers=Ls.from(n.headers),n},function(n){return I8(n)||(_b(e),n&&n.response&&(n.response.data=wb.call(e,e.transformResponse,n.response),n.response.headers=Ls.from(n.response.headers))),Promise.reject(n)})}const U8="1.13.4",m1={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{m1[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const c3={};m1.transitional=function(t,r,n){function s(a,i){return"[Axios v"+U8+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,o)=>{if(t===!1)throw new Et(s(i," has been removed"+(r?" in "+r:"")),Et.ERR_DEPRECATED);return r&&!c3[i]&&(c3[i]=!0,console.warn(s(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,o):!0}};m1.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function n$(e,t,r){if(typeof e!="object")throw new Et("options must be an object",Et.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const a=n[s],i=t[a];if(i){const o=e[a],c=o===void 0||i(o,a,e);if(c!==!0)throw new Et("option "+a+" must be "+c,Et.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Et("Unknown option "+a,Et.ERR_BAD_OPTION)}}const Ax={assertOptions:n$,validators:m1},Ei=Ax.validators;let Ic=class{constructor(t){this.defaults=t||{},this.interceptors={request:new J4,response:new J4}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Gc(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&Ax.assertOptions(n,{silentJSONParsing:Ei.transitional(Ei.boolean),forcedJSONParsing:Ei.transitional(Ei.boolean),clarifyTimeoutError:Ei.transitional(Ei.boolean)},!1),s!=null&&(Me.isFunction(s)?r.paramsSerializer={serialize:s}:Ax.assertOptions(s,{encode:Ei.function,serialize:Ei.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ax.assertOptions(r,{baseUrl:Ei.spelling("baseURL"),withXsrfToken:Ei.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&Me.merge(a.common,a[r.method]);a&&Me.forEach(["delete","get","head","post","put","patch","common"],v=>{delete a[v]}),r.headers=Ls.concat(i,a);const o=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(c=c&&y.synchronous,o.unshift(y.fulfilled,y.rejected))});const f=[];this.interceptors.response.forEach(function(y){f.push(y.fulfilled,y.rejected)});let h,p=0,x;if(!c){const v=[l3.bind(this),void 0];for(v.unshift(...o),v.push(...f),x=v.length,h=Promise.resolve(r);p<x;)h=h.then(v[p++],v[p++]);return h}x=o.length;let g=r;for(;p<x;){const v=o[p++],y=o[p++];try{g=v(g)}catch(w){y.call(this,w);break}}try{h=l3.call(this,g)}catch(v){return Promise.reject(v)}for(p=0,x=f.length;p<x;)h=h.then(f[p++],f[p++]);return h}getUri(t){t=Gc(this.defaults,t);const r=F8(t.baseURL,t.url,t.allowAbsoluteUrls);return O8(r,t.params,t.paramsSerializer)}};Me.forEach(["delete","get","head","options"],function(t){Ic.prototype[t]=function(r,n){return this.request(Gc(n||{},{method:t,url:r,data:(n||{}).data}))}});Me.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,o){return this.request(Gc(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}Ic.prototype[t]=r(),Ic.prototype[t+"Form"]=r(!0)});let s$=class z8{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const i=new Promise(o=>{n.subscribe(o),a=o}).then(s);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,o){n.reason||(n.reason=new X0(a,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new z8(function(s){t=s}),cancel:t}}};function a$(e){return function(r){return e.apply(null,r)}}function i$(e){return Me.isObject(e)&&e.isAxiosError===!0}const b_={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(b_).forEach(([e,t])=>{b_[t]=e});function H8(e){const t=new Ic(e),r=b8(Ic.prototype.request,t);return Me.extend(r,Ic.prototype,t,{allOwnKeys:!0}),Me.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return H8(Gc(e,s))},r}const Zr=H8(K0);Zr.Axios=Ic;Zr.CanceledError=X0;Zr.CancelToken=s$;Zr.isCancel=I8;Zr.VERSION=U8;Zr.toFormData=p1;Zr.AxiosError=Et;Zr.Cancel=Zr.CanceledError;Zr.all=function(t){return Promise.all(t)};Zr.spread=a$;Zr.isAxiosError=i$;Zr.mergeConfig=Gc;Zr.AxiosHeaders=Ls;Zr.formToJSON=e=>D8(Me.isHTMLForm(e)?new FormData(e):e);Zr.getAdapter=B8.getAdapter;Zr.HttpStatusCode=b_;Zr.default=Zr;const{Axios:Wwe,AxiosError:$we,CanceledError:Gwe,isCancel:Kwe,CancelToken:Xwe,VERSION:Ywe,all:Jwe,Cancel:Zwe,isAxiosError:Qwe,spread:e2e,toFormData:t2e,AxiosHeaders:r2e,HttpStatusCode:n2e,formToJSON:s2e,getAdapter:a2e,mergeConfig:i2e}=Zr;var o$=jj();const V8=SE(o$);function l$(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const c$=e=>{switch(e){case"success":return d$;case"info":return p$;case"warning":return h$;case"error":return m$;default:return null}},u$=Array(12).fill(0),f$=({visible:e,className:t})=>We.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},We.createElement("div",{className:"sonner-spinner"},u$.map((r,n)=>We.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),d$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),h$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),p$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),m$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),x$=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},We.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),We.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),g$=()=>{const[e,t]=We.useState(document.hidden);return We.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let w_=1;class y${constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:n,...s}=t,a=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:w_++,i=this.toasts.find(c=>c.id===a),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...t,id:a,title:n}),{...c,...t,id:a,dismissible:o,title:n}):c):this.addToast({title:n,...s,dismissible:o,id:a}),a},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let a=n!==void 0,i;const o=s.then(async f=>{if(i=["resolve",f],We.isValidElement(f))a=!1,this.create({id:n,type:"default",message:f});else if(b$(f)&&!f.ok){a=!1;const p=typeof r.error=="function"?await r.error(`HTTP error! status: ${f.status}`):r.error,x=typeof r.description=="function"?await r.description(`HTTP error! status: ${f.status}`):r.description,v=typeof p=="object"&&!We.isValidElement(p)?p:{message:p};this.create({id:n,type:"error",description:x,...v})}else if(f instanceof Error){a=!1;const p=typeof r.error=="function"?await r.error(f):r.error,x=typeof r.description=="function"?await r.description(f):r.description,v=typeof p=="object"&&!We.isValidElement(p)?p:{message:p};this.create({id:n,type:"error",description:x,...v})}else if(r.success!==void 0){a=!1;const p=typeof r.success=="function"?await r.success(f):r.success,x=typeof r.description=="function"?await r.description(f):r.description,v=typeof p=="object"&&!We.isValidElement(p)?p:{message:p};this.create({id:n,type:"success",description:x,...v})}}).catch(async f=>{if(i=["reject",f],r.error!==void 0){a=!1;const h=typeof r.error=="function"?await r.error(f):r.error,p=typeof r.description=="function"?await r.description(f):r.description,g=typeof h=="object"&&!We.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:p,...g})}}).finally(()=>{a&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),c=()=>new Promise((f,h)=>o.then(()=>i[0]==="reject"?h(i[1]):f(i[1])).catch(h));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(t,r)=>{const n=(r==null?void 0:r.id)||w_++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Is=new y$,v$=(e,t)=>{const r=(t==null?void 0:t.id)||w_++;return Is.addToast({title:e,...t,id:r}),r},b$=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",w$=v$,_$=()=>Is.toasts,E$=()=>Is.getActiveToasts(),Kn=Object.assign(w$,{success:Is.success,info:Is.info,warning:Is.warning,error:Is.error,custom:Is.custom,message:Is.message,promise:Is.promise,dismiss:Is.dismiss,loading:Is.loading},{getHistory:_$,getToasts:E$});l$("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Pm(e){return e.label!==void 0}const S$=3,N$="24px",T$="16px",u3=4e3,k$=356,A$=14,C$=45,R$=200;function Si(...e){return e.filter(Boolean).join(" ")}function O$(e){const[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}const j$=e=>{var t,r,n,s,a,i,o,c,f;const{invert:h,toast:p,unstyled:x,interacting:g,setHeights:v,visibleToasts:y,heights:w,index:_,toasts:S,expanded:E,removeToast:T,defaultRichColors:k,closeButton:D,style:O,cancelButtonStyle:z,actionButtonStyle:j,className:J="",descriptionClassName:ae="",duration:F,position:X,gap:P,expandByDefault:le,classNames:ee,icons:te,closeButtonAriaLabel:me="Close toast"}=e,[ie,Ee]=We.useState(null),[K,M]=We.useState(null),[q,G]=We.useState(!1),[Z,re]=We.useState(!1),[L,I]=We.useState(!1),[se,Q]=We.useState(!1),[Y,U]=We.useState(!1),[we,B]=We.useState(0),[be,V]=We.useState(0),C=We.useRef(p.duration||F||u3),A=We.useRef(null),H=We.useRef(null),ue=_===0,ye=_+1<=y,he=p.type,ke=p.dismissible!==!1,De=p.className||"",Fe=p.descriptionClassName||"",$e=We.useMemo(()=>w.findIndex(wt=>wt.toastId===p.id)||0,[w,p.id]),rt=We.useMemo(()=>{var wt;return(wt=p.closeButton)!=null?wt:D},[p.closeButton,D]),at=We.useMemo(()=>p.duration||F||u3,[p.duration,F]),qt=We.useRef(0),dt=We.useRef(0),Bt=We.useRef(0),hr=We.useRef(null),[vt,ir]=X.split("-"),Nn=We.useMemo(()=>w.reduce((wt,xr,sn)=>sn>=$e?wt:wt+xr.height,0),[w,$e]),or=g$(),Vo=p.invert||h,pi=he==="loading";dt.current=We.useMemo(()=>$e*P+Nn,[$e,Nn]),We.useEffect(()=>{C.current=at},[at]),We.useEffect(()=>{G(!0)},[]),We.useEffect(()=>{const wt=H.current;if(wt){const xr=wt.getBoundingClientRect().height;return V(xr),v(sn=>[{toastId:p.id,height:xr,position:p.position},...sn]),()=>v(sn=>sn.filter(Tn=>Tn.toastId!==p.id))}},[v,p.id]),We.useLayoutEffect(()=>{if(!q)return;const wt=H.current,xr=wt.style.height;wt.style.height="auto";const sn=wt.getBoundingClientRect().height;wt.style.height=xr,V(sn),v(Tn=>Tn.find(br=>br.toastId===p.id)?Tn.map(br=>br.toastId===p.id?{...br,height:sn}:br):[{toastId:p.id,height:sn,position:p.position},...Tn])},[q,p.title,p.description,v,p.id,p.jsx,p.action,p.cancel]);const xs=We.useCallback(()=>{re(!0),B(dt.current),v(wt=>wt.filter(xr=>xr.toastId!==p.id)),setTimeout(()=>{T(p)},R$)},[p,T,v,dt]);We.useEffect(()=>{if(p.promise&&he==="loading"||p.duration===1/0||p.type==="loading")return;let wt;return E||g||or?(()=>{if(Bt.current<qt.current){const Tn=new Date().getTime()-qt.current;C.current=C.current-Tn}Bt.current=new Date().getTime()})():(()=>{C.current!==1/0&&(qt.current=new Date().getTime(),wt=setTimeout(()=>{p.onAutoClose==null||p.onAutoClose.call(p,p),xs()},C.current))})(),()=>clearTimeout(wt)},[E,g,p,he,or,xs]),We.useEffect(()=>{p.delete&&(xs(),p.onDismiss==null||p.onDismiss.call(p,p))},[xs,p.delete]);function Ga(){var wt;if(te!=null&&te.loading){var xr;return We.createElement("div",{className:Si(ee==null?void 0:ee.loader,p==null||(xr=p.classNames)==null?void 0:xr.loader,"sonner-loader"),"data-visible":he==="loading"},te.loading)}return We.createElement(f$,{className:Si(ee==null?void 0:ee.loader,p==null||(wt=p.classNames)==null?void 0:wt.loader),visible:he==="loading"})}const Ka=p.icon||(te==null?void 0:te[he])||c$(he);var gs,nn;return We.createElement("li",{tabIndex:0,ref:H,className:Si(J,De,ee==null?void 0:ee.toast,p==null||(t=p.classNames)==null?void 0:t.toast,ee==null?void 0:ee.default,ee==null?void 0:ee[he],p==null||(r=p.classNames)==null?void 0:r[he]),"data-sonner-toast":"","data-rich-colors":(gs=p.richColors)!=null?gs:k,"data-styled":!(p.jsx||p.unstyled||x),"data-mounted":q,"data-promise":!!p.promise,"data-swiped":Y,"data-removed":Z,"data-visible":ye,"data-y-position":vt,"data-x-position":ir,"data-index":_,"data-front":ue,"data-swiping":L,"data-dismissible":ke,"data-type":he,"data-invert":Vo,"data-swipe-out":se,"data-swipe-direction":K,"data-expanded":!!(E||le&&q),"data-testid":p.testId,style:{"--index":_,"--toasts-before":_,"--z-index":S.length-_,"--offset":`${Z?we:dt.current}px`,"--initial-height":le?"auto":`${be}px`,...O,...p.style},onDragEnd:()=>{I(!1),Ee(null),hr.current=null},onPointerDown:wt=>{wt.button!==2&&(pi||!ke||(A.current=new Date,B(dt.current),wt.target.setPointerCapture(wt.pointerId),wt.target.tagName!=="BUTTON"&&(I(!0),hr.current={x:wt.clientX,y:wt.clientY})))},onPointerUp:()=>{var wt,xr,sn;if(se||!ke)return;hr.current=null;const Tn=Number(((wt=H.current)==null?void 0:wt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),mi=Number(((xr=H.current)==null?void 0:xr.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),br=new Date().getTime()-((sn=A.current)==null?void 0:sn.getTime()),es=ie==="x"?Tn:mi,qi=Math.abs(es)/br;if(Math.abs(es)>=C$||qi>.11){B(dt.current),p.onDismiss==null||p.onDismiss.call(p,p),M(ie==="x"?Tn>0?"right":"left":mi>0?"down":"up"),xs(),Q(!0);return}else{var kn,ts;(kn=H.current)==null||kn.style.setProperty("--swipe-amount-x","0px"),(ts=H.current)==null||ts.style.setProperty("--swipe-amount-y","0px")}U(!1),I(!1),Ee(null)},onPointerMove:wt=>{var xr,sn,Tn;if(!hr.current||!ke||((xr=window.getSelection())==null?void 0:xr.toString().length)>0)return;const br=wt.clientY-hr.current.y,es=wt.clientX-hr.current.x;var qi;const kn=(qi=e.swipeDirections)!=null?qi:O$(X);!ie&&(Math.abs(es)>1||Math.abs(br)>1)&&Ee(Math.abs(es)>Math.abs(br)?"x":"y");let ts={x:0,y:0};const qo=Ws=>1/(1.5+Math.abs(Ws)/20);if(ie==="y"){if(kn.includes("top")||kn.includes("bottom"))if(kn.includes("top")&&br<0||kn.includes("bottom")&&br>0)ts.y=br;else{const Ws=br*qo(br);ts.y=Math.abs(Ws)<Math.abs(br)?Ws:br}}else if(ie==="x"&&(kn.includes("left")||kn.includes("right")))if(kn.includes("left")&&es<0||kn.includes("right")&&es>0)ts.x=es;else{const Ws=es*qo(es);ts.x=Math.abs(Ws)<Math.abs(es)?Ws:es}(Math.abs(ts.x)>0||Math.abs(ts.y)>0)&&U(!0),(sn=H.current)==null||sn.style.setProperty("--swipe-amount-x",`${ts.x}px`),(Tn=H.current)==null||Tn.style.setProperty("--swipe-amount-y",`${ts.y}px`)}},rt&&!p.jsx&&he!=="loading"?We.createElement("button",{"aria-label":me,"data-disabled":pi,"data-close-button":!0,onClick:pi||!ke?()=>{}:()=>{xs(),p.onDismiss==null||p.onDismiss.call(p,p)},className:Si(ee==null?void 0:ee.closeButton,p==null||(n=p.classNames)==null?void 0:n.closeButton)},(nn=te==null?void 0:te.close)!=null?nn:x$):null,(he||p.icon||p.promise)&&p.icon!==null&&((te==null?void 0:te[he])!==null||p.icon)?We.createElement("div",{"data-icon":"",className:Si(ee==null?void 0:ee.icon,p==null||(s=p.classNames)==null?void 0:s.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||Ga():null,p.type!=="loading"?Ka:null):null,We.createElement("div",{"data-content":"",className:Si(ee==null?void 0:ee.content,p==null||(a=p.classNames)==null?void 0:a.content)},We.createElement("div",{"data-title":"",className:Si(ee==null?void 0:ee.title,p==null||(i=p.classNames)==null?void 0:i.title)},p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title),p.description?We.createElement("div",{"data-description":"",className:Si(ae,Fe,ee==null?void 0:ee.description,p==null||(o=p.classNames)==null?void 0:o.description)},typeof p.description=="function"?p.description():p.description):null),We.isValidElement(p.cancel)?p.cancel:p.cancel&&Pm(p.cancel)?We.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||z,onClick:wt=>{Pm(p.cancel)&&ke&&(p.cancel.onClick==null||p.cancel.onClick.call(p.cancel,wt),xs())},className:Si(ee==null?void 0:ee.cancelButton,p==null||(c=p.classNames)==null?void 0:c.cancelButton)},p.cancel.label):null,We.isValidElement(p.action)?p.action:p.action&&Pm(p.action)?We.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||j,onClick:wt=>{Pm(p.action)&&(p.action.onClick==null||p.action.onClick.call(p.action,wt),!wt.defaultPrevented&&xs())},className:Si(ee==null?void 0:ee.actionButton,p==null||(f=p.classNames)==null?void 0:f.actionButton)},p.action.label):null)};function f3(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function D$(e,t){const r={};return[e,t].forEach((n,s)=>{const a=s===1,i=a?"--mobile-offset":"--offset",o=a?T$:N$;function c(f){["top","right","bottom","left"].forEach(h=>{r[`${i}-${h}`]=typeof f=="number"?`${f}px`:f})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(f=>{n[f]===void 0?r[`${i}-${f}`]=o:r[`${i}-${f}`]=typeof n[f]=="number"?`${n[f]}px`:n[f]}):c(o)}),r}const I$=We.forwardRef(function(t,r){const{id:n,invert:s,position:a="bottom-right",hotkey:i=["altKey","KeyT"],expand:o,closeButton:c,className:f,offset:h,mobileOffset:p,theme:x="light",richColors:g,duration:v,style:y,visibleToasts:w=S$,toastOptions:_,dir:S=f3(),gap:E=A$,icons:T,containerAriaLabel:k="Notifications"}=t,[D,O]=We.useState([]),z=We.useMemo(()=>n?D.filter(q=>q.toasterId===n):D.filter(q=>!q.toasterId),[D,n]),j=We.useMemo(()=>Array.from(new Set([a].concat(z.filter(q=>q.position).map(q=>q.position)))),[z,a]),[J,ae]=We.useState([]),[F,X]=We.useState(!1),[P,le]=We.useState(!1),[ee,te]=We.useState(x!=="system"?x:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),me=We.useRef(null),ie=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),Ee=We.useRef(null),K=We.useRef(!1),M=We.useCallback(q=>{O(G=>{var Z;return(Z=G.find(re=>re.id===q.id))!=null&&Z.delete||Is.dismiss(q.id),G.filter(({id:re})=>re!==q.id)})},[]);return We.useEffect(()=>Is.subscribe(q=>{if(q.dismiss){requestAnimationFrame(()=>{O(G=>G.map(Z=>Z.id===q.id?{...Z,delete:!0}:Z))});return}setTimeout(()=>{V8.flushSync(()=>{O(G=>{const Z=G.findIndex(re=>re.id===q.id);return Z!==-1?[...G.slice(0,Z),{...G[Z],...q},...G.slice(Z+1)]:[q,...G]})})})}),[D]),We.useEffect(()=>{if(x!=="system"){te(x);return}if(x==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?te("dark"):te("light")),typeof window>"u")return;const q=window.matchMedia("(prefers-color-scheme: dark)");try{q.addEventListener("change",({matches:G})=>{te(G?"dark":"light")})}catch{q.addListener(({matches:Z})=>{try{te(Z?"dark":"light")}catch(re){console.error(re)}})}},[x]),We.useEffect(()=>{D.length<=1&&X(!1)},[D]),We.useEffect(()=>{const q=G=>{var Z;if(i.every(I=>G[I]||G.code===I)){var L;X(!0),(L=me.current)==null||L.focus()}G.code==="Escape"&&(document.activeElement===me.current||(Z=me.current)!=null&&Z.contains(document.activeElement))&&X(!1)};return document.addEventListener("keydown",q),()=>document.removeEventListener("keydown",q)},[i]),We.useEffect(()=>{if(me.current)return()=>{Ee.current&&(Ee.current.focus({preventScroll:!0}),Ee.current=null,K.current=!1)}},[me.current]),We.createElement("section",{ref:r,"aria-label":`${k} ${ie}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},j.map((q,G)=>{var Z;const[re,L]=q.split("-");return z.length?We.createElement("ol",{key:q,dir:S==="auto"?f3():S,tabIndex:-1,ref:me,className:f,"data-sonner-toaster":!0,"data-sonner-theme":ee,"data-y-position":re,"data-x-position":L,style:{"--front-toast-height":`${((Z=J[0])==null?void 0:Z.height)||0}px`,"--width":`${k$}px`,"--gap":`${E}px`,...y,...D$(h,p)},onBlur:I=>{K.current&&!I.currentTarget.contains(I.relatedTarget)&&(K.current=!1,Ee.current&&(Ee.current.focus({preventScroll:!0}),Ee.current=null))},onFocus:I=>{I.target instanceof HTMLElement&&I.target.dataset.dismissible==="false"||K.current||(K.current=!0,Ee.current=I.relatedTarget)},onMouseEnter:()=>X(!0),onMouseMove:()=>X(!0),onMouseLeave:()=>{P||X(!1)},onDragEnd:()=>X(!1),onPointerDown:I=>{I.target instanceof HTMLElement&&I.target.dataset.dismissible==="false"||le(!0)},onPointerUp:()=>le(!1)},z.filter(I=>!I.position&&G===0||I.position===q).map((I,se)=>{var Q,Y;return We.createElement(j$,{key:I.id,icons:T,index:se,toast:I,defaultRichColors:g,duration:(Q=_==null?void 0:_.duration)!=null?Q:v,className:_==null?void 0:_.className,descriptionClassName:_==null?void 0:_.descriptionClassName,invert:s,visibleToasts:w,closeButton:(Y=_==null?void 0:_.closeButton)!=null?Y:c,interacting:P,position:q,style:_==null?void 0:_.style,unstyled:_==null?void 0:_.unstyled,classNames:_==null?void 0:_.classNames,cancelButtonStyle:_==null?void 0:_.cancelButtonStyle,actionButtonStyle:_==null?void 0:_.actionButtonStyle,closeButtonAriaLabel:_==null?void 0:_.closeButtonAriaLabel,removeToast:M,toasts:z.filter(U=>U.position==I.position),heights:J.filter(U=>U.position==I.position),setHeights:ae,expandByDefault:o,gap:E,expanded:F,swipeDirections:t.swipeDirections})})):null}))}),Pt=Zr.create({baseURL:"http://127.0.0.1:8000",headers:{"Content-Type":"application/json"}}),__=e=>{if(typeof e=="string")return e.trim();if(e!==null&&typeof e=="object"){if(Array.isArray(e))return e.map(t=>__(t));if(Object.getPrototypeOf(e)===Object.prototype){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=__(e[r]));return t}}return e};Pt.interceptors.request.use(async e=>{var n,s,a;const r=(s=(n=(await s1()).tokens)==null?void 0:n.idToken)==null?void 0:s.toString();return r&&(e.headers.Authorization=`Bearer ${r}`),e.data&&["post","put","patch"].includes(((a=e.method)==null?void 0:a.toLowerCase())||"")&&(e.data=__(e.data)),e});Pt.interceptors.response.use(e=>e,e=>{var n,s;if(!e.response)return Kn.error("Network error. Please check your connection."),Promise.reject(e);const t=e.response.status,r=((n=e.response.data)==null?void 0:n.detail)||((s=e.response.data)==null?void 0:s.message);return t>=500&&Kn.error(r||"Server error. Please try again later."),t===401&&Kn.error("Session expired. Please log in again."),Promise.reject(e)});const q8=ne.createContext(void 0),M$=({children:e})=>{const[t,r]=ne.useState(null),[n,s]=ne.useState("loading"),[a,i]=ne.useState(!1),o=ne.useRef(!1),c=async()=>{const p=(await Pt.get("/users/me")).data;r(p),i(!!p.is_active),s("authenticated")};ne.useEffect(()=>{(async()=>{var x;if(o.current)return;if(o.current=!0,["/login","/signup","/forgot-password"].includes(window.location.pathname)){s("unauthenticated");return}try{if(!((x=(await s1()).tokens)!=null&&x.idToken)){s("unauthenticated");return}await c()}catch(g){console.error("Auth bootstrap failed:",g),await $4().catch(()=>{}),r(null),i(!1),s("unauthenticated")}})()},[]);const f=async()=>{try{await $4()}finally{r(null),i(!1),s("unauthenticated")}};return d.jsx(q8.Provider,{value:{user:t,isActive:a,setUser:r,status:n,refreshUser:c,logout:f},children:e})},Ui=()=>{const e=ne.useContext(q8);if(!e)throw new Error("useAuth must be used within AuthProvider");return e};/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var d3="popstate";function F$(e={}){function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return E_("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:l0(s)}return L$(t,r,null,e)}function Or(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ci(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function P$(){return Math.random().toString(36).substring(2,10)}function h3(e,t){return{usr:e.state,key:e.key,idx:t}}function E_(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?id(t):t,state:r,key:t&&t.key||n||P$()}}function l0({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function id(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function L$(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o="POP",c=null,f=h();f==null&&(f=0,i.replaceState({...i.state,idx:f},""));function h(){return(i.state||{idx:null}).idx}function p(){o="POP";let w=h(),_=w==null?null:w-f;f=w,c&&c({action:o,location:y.location,delta:_})}function x(w,_){o="PUSH";let S=E_(y.location,w,_);f=h()+1;let E=h3(S,f),T=y.createHref(S);try{i.pushState(E,"",T)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;s.location.assign(T)}a&&c&&c({action:o,location:y.location,delta:1})}function g(w,_){o="REPLACE";let S=E_(y.location,w,_);f=h();let E=h3(S,f),T=y.createHref(S);i.replaceState(E,"",T),a&&c&&c({action:o,location:y.location,delta:0})}function v(w){return B$(w)}let y={get action(){return o},get location(){return e(s,i)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(d3,p),c=w,()=>{s.removeEventListener(d3,p),c=null}},createHref(w){return t(s,w)},createURL:v,encodeLocation(w){let _=v(w);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:x,replace:g,go(w){return i.go(w)}};return y}function B$(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Or(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:l0(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function W8(e,t,r="/"){return U$(e,t,r,!1)}function U$(e,t,r,n){let s=typeof t=="string"?id(t):t,a=jo(s.pathname||"/",r);if(a==null)return null;let i=$8(e);z$(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let f=Z$(a);o=Y$(i[c],f,n)}return o}function $8(e,t=[],r=[],n="",s=!1){let a=(i,o,c=s,f)=>{let h={relativePath:f===void 0?i.path||"":f,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(n)&&c)return;Or(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length)}let p=So([n,h.relativePath]),x=r.concat(h);i.children&&i.children.length>0&&(Or(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),$8(i.children,t,x,p,c)),!(i.path==null&&!i.index)&&t.push({path:p,score:K$(p,i.index),routesMeta:x})};return e.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,o);else for(let f of G8(i.path))a(i,o,!0,f)}),t}function G8(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=G8(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function z$(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:X$(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var H$=/^:[\w-]+$/,V$=3,q$=2,W$=1,$$=10,G$=-2,p3=e=>e==="*";function K$(e,t){let r=e.split("/"),n=r.length;return r.some(p3)&&(n+=G$),t&&(n+=q$),r.filter(s=>!p3(s)).reduce((s,a)=>s+(H$.test(a)?V$:a===""?W$:$$),n)}function X$(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function Y$(e,t,r=!1){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],f=o===n.length-1,h=a==="/"?t:t.slice(a.length)||"/",p=$x({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},h),x=c.route;if(!p&&f&&r&&!n[n.length-1].route.index&&(p=$x({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!p)return null;Object.assign(s,p.params),i.push({params:s,pathname:So([a,p.pathname]),pathnameBase:rG(So([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=So([a,p.pathnameBase]))}return i}function $x(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=J$(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((f,{paramName:h,isOptional:p},x)=>{if(h==="*"){let v=o[x]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const g=o[x];return p&&!g?f[h]=void 0:f[h]=(g||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:i,pattern:e}}function J$(e,t=!1,r=!0){ci(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function Z$(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ci(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function jo(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}var Q$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function eG(e,t="/"){let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?id(e):e,a;return r?(r=r.replace(/\/\/+/g,"/"),r.startsWith("/")?a=m3(r.substring(1),"/"):a=m3(r,t)):a=t,{pathname:a,search:nG(n),hash:sG(s)}}function m3(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Eb(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function tG(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function WE(e){let t=tG(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function $E(e,t,r,n=!1){let s;typeof e=="string"?s=id(e):(s={...e},Or(!s.pathname||!s.pathname.includes("?"),Eb("?","pathname","search",s)),Or(!s.pathname||!s.pathname.includes("#"),Eb("#","pathname","hash",s)),Or(!s.search||!s.search.includes("#"),Eb("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let p=t.length-1;if(!n&&i.startsWith("..")){let x=i.split("/");for(;x[0]==="..";)x.shift(),p-=1;s.pathname=x.join("/")}o=p>=0?t[p]:"/"}let c=eG(s,o),f=i&&i!=="/"&&i.endsWith("/"),h=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(f||h)&&(c.pathname+="/"),c}var So=e=>e.join("/").replace(/\/\/+/g,"/"),rG=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),nG=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,sG=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,aG=class{constructor(e,t,r,n=!1){this.status=e,this.statusText=t||"",this.internal=n,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function iG(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function oG(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var K8=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function X8(e,t){let r=e;if(typeof r!="string"||!Q$.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let n=r,s=!1;if(K8)try{let a=new URL(window.location.href),i=r.startsWith("//")?new URL(a.protocol+r):new URL(r),o=jo(i.pathname,t);i.origin===a.origin&&o!=null?r=o+i.search+i.hash:s=!0}catch{ci(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:s,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Y8=["POST","PUT","PATCH","DELETE"];new Set(Y8);var lG=["GET",...Y8];new Set(lG);var od=ne.createContext(null);od.displayName="DataRouter";var x1=ne.createContext(null);x1.displayName="DataRouterState";var cG=ne.createContext(!1),J8=ne.createContext({isTransitioning:!1});J8.displayName="ViewTransition";var uG=ne.createContext(new Map);uG.displayName="Fetchers";var fG=ne.createContext(null);fG.displayName="Await";var fa=ne.createContext(null);fa.displayName="Navigation";var Y0=ne.createContext(null);Y0.displayName="Location";var hi=ne.createContext({outlet:null,matches:[],isDataRoute:!1});hi.displayName="Route";var GE=ne.createContext(null);GE.displayName="RouteError";var Z8="REACT_ROUTER_ERROR",dG="REDIRECT",hG="ROUTE_ERROR_RESPONSE";function pG(e){if(e.startsWith(`${Z8}:${dG}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function mG(e){if(e.startsWith(`${Z8}:${hG}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new aG(t.status,t.statusText,t.data)}catch{}}function xG(e,{relative:t}={}){Or(ld(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=ne.useContext(fa),{hash:s,pathname:a,search:i}=J0(e,{relative:t}),o=a;return r!=="/"&&(o=a==="/"?r:So([r,a])),n.createHref({pathname:o,search:i,hash:s})}function ld(){return ne.useContext(Y0)!=null}function Fo(){return Or(ld(),"useLocation() may be used only in the context of a <Router> component."),ne.useContext(Y0).location}var Q8="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function eD(e){ne.useContext(fa).static||ne.useLayoutEffect(e)}function Qn(){let{isDataRoute:e}=ne.useContext(hi);return e?OG():gG()}function gG(){Or(ld(),"useNavigate() may be used only in the context of a <Router> component.");let e=ne.useContext(od),{basename:t,navigator:r}=ne.useContext(fa),{matches:n}=ne.useContext(hi),{pathname:s}=Fo(),a=JSON.stringify(WE(n)),i=ne.useRef(!1);return eD(()=>{i.current=!0}),ne.useCallback((c,f={})=>{if(ci(i.current,Q8),!i.current)return;if(typeof c=="number"){r.go(c);return}let h=$E(c,JSON.parse(a),s,f.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:So([t,h.pathname])),(f.replace?r.replace:r.push)(h,f.state,f)},[t,r,a,s,e])}var yG=ne.createContext(null);function vG(e){let t=ne.useContext(hi).outlet;return ne.useMemo(()=>t&&ne.createElement(yG.Provider,{value:e},t),[t,e])}function J0(e,{relative:t}={}){let{matches:r}=ne.useContext(hi),{pathname:n}=Fo(),s=JSON.stringify(WE(r));return ne.useMemo(()=>$E(e,JSON.parse(s),n,t==="path"),[e,s,n,t])}function bG(e,t){return tD(e,t)}function tD(e,t,r,n,s){var S;Or(ld(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=ne.useContext(fa),{matches:i}=ne.useContext(hi),o=i[i.length-1],c=o?o.params:{},f=o?o.pathname:"/",h=o?o.pathnameBase:"/",p=o&&o.route;{let E=p&&p.path||"";nD(f,!p||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let x=Fo(),g;if(t){let E=typeof t=="string"?id(t):t;Or(h==="/"||((S=E.pathname)==null?void 0:S.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${E.pathname}" was given in the \`location\` prop.`),g=E}else g=x;let v=g.pathname||"/",y=v;if(h!=="/"){let E=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(E.length).join("/")}let w=W8(e,{pathname:y});ci(p||w!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),ci(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=NG(w&&w.map(E=>Object.assign({},E,{params:Object.assign({},c,E.params),pathname:So([h,a.encodeLocation?a.encodeLocation(E.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?h:So([h,a.encodeLocation?a.encodeLocation(E.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathnameBase])})),i,r,n,s);return t&&_?ne.createElement(Y0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},_):_}function wG(){let e=RG(),t=iG(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=ne.createElement(ne.Fragment,null,ne.createElement("p",null," Hey developer "),ne.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ne.createElement("code",{style:a},"ErrorBoundary")," or"," ",ne.createElement("code",{style:a},"errorElement")," prop on your route.")),ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},t),r?ne.createElement("pre",{style:s},r):null,i)}var _G=ne.createElement(wG,null),rD=class extends ne.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=mG(e.digest);r&&(e=r)}let t=e!==void 0?ne.createElement(hi.Provider,{value:this.props.routeContext},ne.createElement(GE.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?ne.createElement(EG,{error:e},t):t}};rD.contextType=cG;var Sb=new WeakMap;function EG({children:e,error:t}){let{basename:r}=ne.useContext(fa);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let n=pG(t.digest);if(n){let s=Sb.get(t);if(s)throw s;let a=X8(n.location,r);if(K8&&!Sb.get(t))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const i=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw Sb.set(t,i),i}return ne.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return e}function SG({routeContext:e,match:t,children:r}){let n=ne.useContext(od);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),ne.createElement(hi.Provider,{value:e},r)}function NG(e,t=[],r=null,n=null,s=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,i=r==null?void 0:r.errors;if(i!=null){let h=a.findIndex(p=>p.route.id&&(i==null?void 0:i[p.route.id])!==void 0);Or(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let o=!1,c=-1;if(r)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(c=h),p.route.id){let{loaderData:x,errors:g}=r,v=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!g||g[p.route.id]===void 0);if(p.route.lazy||v){o=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}let f=r&&n?(h,p)=>{var x,g;n(h,{location:r.location,params:((g=(x=r.matches)==null?void 0:x[0])==null?void 0:g.params)??{},unstable_pattern:oG(r.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,x)=>{let g,v=!1,y=null,w=null;r&&(g=i&&p.route.id?i[p.route.id]:void 0,y=p.route.errorElement||_G,o&&(c<0&&x===0?(nD("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,w=null):c===x&&(v=!0,w=p.route.hydrateFallbackElement||null)));let _=t.concat(a.slice(0,x+1)),S=()=>{let E;return g?E=y:v?E=w:p.route.Component?E=ne.createElement(p.route.Component,null):p.route.element?E=p.route.element:E=h,ne.createElement(SG,{match:p,routeContext:{outlet:h,matches:_,isDataRoute:r!=null},children:E})};return r&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?ne.createElement(rD,{location:r.location,revalidation:r.revalidation,component:y,error:g,children:S(),routeContext:{outlet:null,matches:_,isDataRoute:!0},onError:f}):S()},null)}function KE(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function TG(e){let t=ne.useContext(od);return Or(t,KE(e)),t}function kG(e){let t=ne.useContext(x1);return Or(t,KE(e)),t}function AG(e){let t=ne.useContext(hi);return Or(t,KE(e)),t}function XE(e){let t=AG(e),r=t.matches[t.matches.length-1];return Or(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function CG(){return XE("useRouteId")}function RG(){var n;let e=ne.useContext(GE),t=kG("useRouteError"),r=XE("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function OG(){let{router:e}=TG("useNavigate"),t=XE("useNavigate"),r=ne.useRef(!1);return eD(()=>{r.current=!0}),ne.useCallback(async(s,a={})=>{ci(r.current,Q8),r.current&&(typeof s=="number"?await e.navigate(s):await e.navigate(s,{fromRouteId:t,...a}))},[e,t])}var x3={};function nD(e,t,r){!t&&!x3[e]&&(x3[e]=!0,ci(!1,r))}ne.memo(jG);function jG({routes:e,future:t,state:r,onError:n}){return tD(e,void 0,r,n,t)}function _l({to:e,replace:t,state:r,relative:n}){Or(ld(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=ne.useContext(fa);ci(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=ne.useContext(hi),{pathname:i}=Fo(),o=Qn(),c=$E(e,WE(a),i,n==="path"),f=JSON.stringify(c);return ne.useEffect(()=>{o(JSON.parse(f),{replace:t,state:r,relative:n})},[o,f,n,t,r]),null}function g1(e){return vG(e.context)}function vr(e){Or(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function DG({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:s,static:a=!1,unstable_useTransitions:i}){Or(!ld(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),c=ne.useMemo(()=>({basename:o,navigator:s,static:a,unstable_useTransitions:i,future:{}}),[o,s,a,i]);typeof r=="string"&&(r=id(r));let{pathname:f="/",search:h="",hash:p="",state:x=null,key:g="default"}=r,v=ne.useMemo(()=>{let y=jo(f,o);return y==null?null:{location:{pathname:y,search:h,hash:p,state:x,key:g},navigationType:n}},[o,f,h,p,x,g,n]);return ci(v!=null,`<Router basename="${o}"> is not able to match the URL "${f}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:ne.createElement(fa.Provider,{value:c},ne.createElement(Y0.Provider,{children:t,value:v}))}function IG({children:e,location:t}){return bG(S_(e),t)}function S_(e,t=[]){let r=[];return ne.Children.forEach(e,(n,s)=>{if(!ne.isValidElement(n))return;let a=[...t,s];if(n.type===ne.Fragment){r.push.apply(r,S_(n.props.children,a));return}Or(n.type===vr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Or(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=S_(n.props.children,a)),r.push(i)}),r}var Cx="get",Rx="application/x-www-form-urlencoded";function y1(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function MG(e){return y1(e)&&e.tagName.toLowerCase()==="button"}function FG(e){return y1(e)&&e.tagName.toLowerCase()==="form"}function PG(e){return y1(e)&&e.tagName.toLowerCase()==="input"}function LG(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function BG(e,t){return e.button===0&&(!t||t==="_self")&&!LG(e)}var Lm=null;function UG(){if(Lm===null)try{new FormData(document.createElement("form"),0),Lm=!1}catch{Lm=!0}return Lm}var zG=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Nb(e){return e!=null&&!zG.has(e)?(ci(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Rx}"`),null):e}function HG(e,t){let r,n,s,a,i;if(FG(e)){let o=e.getAttribute("action");n=o?jo(o,t):null,r=e.getAttribute("method")||Cx,s=Nb(e.getAttribute("enctype"))||Rx,a=new FormData(e)}else if(MG(e)||PG(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||o.getAttribute("action");if(n=c?jo(c,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||Cx,s=Nb(e.getAttribute("formenctype"))||Nb(o.getAttribute("enctype"))||Rx,a=new FormData(o,e),!UG()){let{name:f,type:h,value:p}=e;if(h==="image"){let x=f?`${f}.`:"";a.append(`${x}x`,"0"),a.append(`${x}y`,"0")}else f&&a.append(f,p)}}else{if(y1(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Cx,n=null,s=Rx,i=e}return a&&s==="text/plain"&&(i=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function YE(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function VG(e,t,r,n){let s=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${n}`:s.pathname=`${s.pathname}.${n}`:s.pathname==="/"?s.pathname=`_root.${n}`:t&&jo(s.pathname,t)==="/"?s.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function qG(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function WG(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function $G(e,t,r){let n=await Promise.all(e.map(async s=>{let a=t.routes[s.route.id];if(a){let i=await qG(a,r);return i.links?i.links():[]}return[]}));return YG(n.flat(1).filter(WG).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function g3(e,t,r,n,s,a){let i=(c,f)=>r[f]?c.route.id!==r[f].route.id:!0,o=(c,f)=>{var h;return r[f].pathname!==c.pathname||((h=r[f].route.path)==null?void 0:h.endsWith("*"))&&r[f].params["*"]!==c.params["*"]};return a==="assets"?t.filter((c,f)=>i(c,f)||o(c,f)):a==="data"?t.filter((c,f)=>{var p;let h=n.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(i(c,f)||o(c,f))return!0;if(c.route.shouldRevalidate){let x=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((p=r[0])==null?void 0:p.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function GG(e,t,{includeHydrateFallback:r}={}){return KG(e.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function KG(e){return[...new Set(e)]}function XG(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function YG(e,t){let r=new Set;return new Set(t),e.reduce((n,s)=>{let a=JSON.stringify(XG(s));return r.has(a)||(r.add(a),n.push({key:a,link:s})),n},[])}function sD(){let e=ne.useContext(od);return YE(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function JG(){let e=ne.useContext(x1);return YE(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var JE=ne.createContext(void 0);JE.displayName="FrameworkContext";function aD(){let e=ne.useContext(JE);return YE(e,"You must render this element inside a <HydratedRouter> element"),e}function ZG(e,t){let r=ne.useContext(JE),[n,s]=ne.useState(!1),[a,i]=ne.useState(!1),{onFocus:o,onBlur:c,onMouseEnter:f,onMouseLeave:h,onTouchStart:p}=t,x=ne.useRef(null);ne.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let y=_=>{_.forEach(S=>{i(S.isIntersecting)})},w=new IntersectionObserver(y,{threshold:.5});return x.current&&w.observe(x.current),()=>{w.disconnect()}}},[e]),ne.useEffect(()=>{if(n){let y=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(y)}}},[n]);let g=()=>{s(!0)},v=()=>{s(!1),i(!1)};return r?e!=="intent"?[a,x,{}]:[a,x,{onFocus:hh(o,g),onBlur:hh(c,v),onMouseEnter:hh(f,g),onMouseLeave:hh(h,v),onTouchStart:hh(p,g)}]:[!1,x,{}]}function hh(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function QG({page:e,...t}){let{router:r}=sD(),n=ne.useMemo(()=>W8(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?ne.createElement(tK,{page:e,matches:n,...t}):null}function eK(e){let{manifest:t,routeModules:r}=aD(),[n,s]=ne.useState([]);return ne.useEffect(()=>{let a=!1;return $G(e,t,r).then(i=>{a||s(i)}),()=>{a=!0}},[e,t,r]),n}function tK({page:e,matches:t,...r}){let n=Fo(),{future:s,manifest:a,routeModules:i}=aD(),{basename:o}=sD(),{loaderData:c,matches:f}=JG(),h=ne.useMemo(()=>g3(e,t,f,a,n,"data"),[e,t,f,a,n]),p=ne.useMemo(()=>g3(e,t,f,a,n,"assets"),[e,t,f,a,n]),x=ne.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let y=new Set,w=!1;if(t.forEach(S=>{var T;let E=a.routes[S.route.id];!E||!E.hasLoader||(!h.some(k=>k.route.id===S.route.id)&&S.route.id in c&&((T=i[S.route.id])!=null&&T.shouldRevalidate)||E.hasClientLoader?w=!0:y.add(S.route.id))}),y.size===0)return[];let _=VG(e,o,s.unstable_trailingSlashAwareDataRequests,"data");return w&&y.size>0&&_.searchParams.set("_routes",t.filter(S=>y.has(S.route.id)).map(S=>S.route.id).join(",")),[_.pathname+_.search]},[o,s.unstable_trailingSlashAwareDataRequests,c,n,a,h,t,e,i]),g=ne.useMemo(()=>GG(p,a),[p,a]),v=eK(p);return ne.createElement(ne.Fragment,null,x.map(y=>ne.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),g.map(y=>ne.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),v.map(({key:y,link:w})=>ne.createElement("link",{key:y,nonce:r.nonce,...w,crossOrigin:w.crossOrigin??r.crossOrigin})))}function rK(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var nK=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{nK&&(window.__reactRouterVersion="7.13.0")}catch{}function sK({basename:e,children:t,unstable_useTransitions:r,window:n}){let s=ne.useRef();s.current==null&&(s.current=F$({window:n,v5Compat:!0}));let a=s.current,[i,o]=ne.useState({action:a.action,location:a.location}),c=ne.useCallback(f=>{r===!1?o(f):ne.startTransition(()=>o(f))},[r]);return ne.useLayoutEffect(()=>a.listen(c),[a,c]),ne.createElement(DG,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:a,unstable_useTransitions:r})}var iD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Cf=ne.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:i,state:o,target:c,to:f,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:x,...g},v){let{basename:y,unstable_useTransitions:w}=ne.useContext(fa),_=typeof f=="string"&&iD.test(f),S=X8(f,y);f=S.to;let E=xG(f,{relative:s}),[T,k,D]=ZG(n,g),O=oK(f,{replace:i,state:o,target:c,preventScrollReset:h,relative:s,viewTransition:p,unstable_defaultShouldRevalidate:x,unstable_useTransitions:w});function z(J){t&&t(J),J.defaultPrevented||O(J)}let j=ne.createElement("a",{...g,...D,href:S.absoluteURL||E,onClick:S.isExternal||a?t:z,ref:rK(v,k),target:c,"data-discover":!_&&r==="render"?"true":void 0});return T&&!_?ne.createElement(ne.Fragment,null,j,ne.createElement(QG,{page:E})):j});Cf.displayName="Link";var oD=ne.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:i,viewTransition:o,children:c,...f},h){let p=J0(i,{relative:f.relative}),x=Fo(),g=ne.useContext(x1),{navigator:v,basename:y}=ne.useContext(fa),w=g!=null&&dK(p)&&o===!0,_=v.encodeLocation?v.encodeLocation(p).pathname:p.pathname,S=x.pathname,E=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;r||(S=S.toLowerCase(),E=E?E.toLowerCase():null,_=_.toLowerCase()),E&&y&&(E=jo(E,y)||E);const T=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let k=S===_||!s&&S.startsWith(_)&&S.charAt(T)==="/",D=E!=null&&(E===_||!s&&E.startsWith(_)&&E.charAt(_.length)==="/"),O={isActive:k,isPending:D,isTransitioning:w},z=k?t:void 0,j;typeof n=="function"?j=n(O):j=[n,k?"active":null,D?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let J=typeof a=="function"?a(O):a;return ne.createElement(Cf,{...f,"aria-current":z,className:j,ref:h,style:J,to:i,viewTransition:o},typeof c=="function"?c(O):c)});oD.displayName="NavLink";var aK=ne.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:s,state:a,method:i=Cx,action:o,onSubmit:c,relative:f,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:x,...g},v)=>{let{unstable_useTransitions:y}=ne.useContext(fa),w=uK(),_=fK(o,{relative:f}),S=i.toLowerCase()==="get"?"get":"post",E=typeof o=="string"&&iD.test(o),T=k=>{if(c&&c(k),k.defaultPrevented)return;k.preventDefault();let D=k.nativeEvent.submitter,O=(D==null?void 0:D.getAttribute("formmethod"))||i,z=()=>w(D||k.currentTarget,{fetcherKey:t,method:O,navigate:r,replace:s,state:a,relative:f,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:x});y&&r!==!1?ne.startTransition(()=>z()):z()};return ne.createElement("form",{ref:v,method:S,action:_,onSubmit:n?c:T,...g,"data-discover":!E&&e==="render"?"true":void 0})});aK.displayName="Form";function iK(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lD(e){let t=ne.useContext(od);return Or(t,iK(e)),t}function oK(e,{target:t,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:i,unstable_defaultShouldRevalidate:o,unstable_useTransitions:c}={}){let f=Qn(),h=Fo(),p=J0(e,{relative:a});return ne.useCallback(x=>{if(BG(x,t)){x.preventDefault();let g=r!==void 0?r:l0(h)===l0(p),v=()=>f(e,{replace:g,state:n,preventScrollReset:s,relative:a,viewTransition:i,unstable_defaultShouldRevalidate:o});c?ne.startTransition(()=>v()):v()}},[h,f,p,r,n,t,e,s,a,i,o,c])}var lK=0,cK=()=>`__${String(++lK)}__`;function uK(){let{router:e}=lD("useSubmit"),{basename:t}=ne.useContext(fa),r=CG(),n=e.fetch,s=e.navigate;return ne.useCallback(async(a,i={})=>{let{action:o,method:c,encType:f,formData:h,body:p}=HG(a,t);if(i.navigate===!1){let x=i.fetcherKey||cK();await n(x,r,i.action||o,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:h,body:p,formMethod:i.method||c,formEncType:i.encType||f,flushSync:i.flushSync})}else await s(i.action||o,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:h,body:p,formMethod:i.method||c,formEncType:i.encType||f,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,s,t,r])}function fK(e,{relative:t}={}){let{basename:r}=ne.useContext(fa),n=ne.useContext(hi);Or(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...J0(e||".",{relative:t})},i=Fo();if(e==null){a.search=i.search;let o=new URLSearchParams(a.search),c=o.getAll("index");if(c.some(h=>h==="")){o.delete("index"),c.filter(p=>p).forEach(p=>o.append("index",p));let h=o.toString();a.search=h?`?${h}`:""}}return(!e||e===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:So([r,a.pathname])),l0(a)}function dK(e,{relative:t}={}){let r=ne.useContext(J8);Or(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=lD("useViewTransitionState"),s=J0(e,{relative:t});if(!r.isTransitioning)return!1;let a=jo(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=jo(r.nextLocation.pathname,n)||r.nextLocation.pathname;return $x(s.pathname,i)!=null||$x(s.pathname,a)!=null}const hK=new v8(new g8(U0)),pK={configure(e,t){const r=Pj(e),n=new Fz({sameSite:"lax"}),s=t!=null&&t.ssr?n:U0,a=t!=null&&t.ssr?new v8(new g8(n)):hK;if(!r.Auth){Sr.configure(r,t);return}if(t!=null&&t.Auth){Sr.configure(r,t);return}if(!Sr.libraryOptions.Auth){kh.setAuthConfig(r.Auth),kh.setKeyValueStorage(s),Sr.configure(r,{...t,Auth:{tokenProvider:kh,credentialsProvider:a}});return}if(t){const i=Sr.libraryOptions.Auth;t.ssr!==void 0&&(kh.setKeyValueStorage(s),i.credentialsProvider=a),Sr.configure(r,{Auth:i,...t});return}Sr.configure(r)},getConfig(){return Sr.getConfig()}},mK={aws_project_region:"us-east-1",aws_cognito_identity_pool_id:"us-east-1:56b9322b-f635-4de5-8568-2190b4d16cb7",aws_cognito_region:"us-east-1",aws_user_pools_id:"us-east-1_vEN2QD1i4",aws_user_pools_web_client_id:"75d8bj7e5gsqh5uo3ov7m5ua8t",oauth:{},aws_cognito_username_attributes:["EMAIL"],aws_cognito_social_providers:[],aws_cognito_signup_attributes:["EMAIL"],aws_cognito_mfa_configuration:"OFF",aws_cognito_mfa_types:["SMS"],aws_cognito_password_protection_settings:{passwordPolicyMinLength:8,passwordPolicyCharacters:[]},aws_cognito_verification_mechanisms:["EMAIL"]};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xK=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gK=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),y3=e=>{const t=gK(e);return t.charAt(0).toUpperCase()+t.slice(1)},cD=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),yK=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var vK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bK=ne.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>ne.createElement("svg",{ref:c,...vK,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:cD("lucide",s),...!a&&!yK(o)&&{"aria-hidden":"true"},...o},[...i.map(([f,h])=>ne.createElement(f,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=(e,t)=>{const r=ne.forwardRef(({className:n,...s},a)=>ne.createElement(bK,{ref:a,iconNode:t,className:cD(`lucide-${xK(y3(e))}`,`lucide-${e}`,n),...s}));return r.displayName=y3(e),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wK=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],_K=nt("arrow-down-wide-narrow",wK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EK=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],uD=nt("arrow-left",EK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],c0=nt("arrow-right",SK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NK=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]],TK=nt("arrow-up-narrow-wide",NK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kK=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],AK=nt("bold",kK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CK=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Xn=nt("building-2",CK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RK=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],cd=nt("calendar",RK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OK=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],jK=nt("chart-column",OK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DK=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ll=nt("check",DK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IK=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],u0=nt("chevron-down",IK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MK=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Jn=nt("chevron-left",MK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FK=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Mr=nt("chevron-right",FK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ud=nt("circle-alert",PK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LK=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],BK=nt("circle-check-big",LK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],la=nt("circle-check",UK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],HK=nt("circle-pause",zK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VK=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qK=nt("circle-play",VK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Rf=nt("circle-x",WK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $K=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Do=nt("clock",$K);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GK=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Gx=nt("download",GK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KK=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Bl=nt("ellipsis-vertical",KK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XK=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],N_=nt("external-link",XK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YK=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Bh=nt("eye-off",YK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JK=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],No=nt("eye",JK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZK=[["path",{d:"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34",key:"o6klzx"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z",key:"zhnas1"}]],ou=nt("file-pen",ZK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QK=[["path",{d:"M11.1 22H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.706.706l3.589 3.588A2.4 2.4 0 0 1 20 8v3.25",key:"uh4ikj"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m21 22-2.88-2.88",key:"9dd25w"}],["circle",{cx:"16",cy:"17",r:"3",key:"11br10"}]],eX=nt("file-search-corner",QK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tX=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"11.5",cy:"14.5",r:"2.5",key:"1bq0ko"}],["path",{d:"M13.3 16.3 15 18",key:"2quom7"}]],Kx=nt("file-search",tX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rX=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],T_=nt("file-spreadsheet",rX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nX=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ul=nt("file-text",nX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sX=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],fD=nt("file",sX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aX=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],iX=nt("funnel",aX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oX=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],lX=nt("hash",oX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cX=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],uX=nt("heading-1",cX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fX=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],dX=nt("heading-2",fX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hX=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],pX=nt("history",hX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mX=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],v1=nt("inbox",mX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xX=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],gX=nt("info",xX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yX=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],vX=nt("italic",yX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bX=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],wX=nt("layout-dashboard",bX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _X=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M16 12H3",key:"1a2rj7"}],["path",{d:"M11 19H3",key:"zflm78"}],["path",{d:"m15 18 2 2 4-4",key:"1szwhi"}]],EX=nt("list-check",_X);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SX=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],NX=nt("list-ordered",SX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TX=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],kX=nt("list",TX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AX=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ar=nt("loader-circle",AX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CX=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],b1=nt("lock",CX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RX=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],OX=nt("log-out",RX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jX=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],f0=nt("mail",jX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DX=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Of=nt("map-pin",DX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IX=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],MX=nt("menu",IX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FX=[["path",{d:"M5 12h14",key:"1ays0h"}]],ZE=nt("minus",FX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PX=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],LX=nt("package",PX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BX=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],UX=nt("pen-line",BX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zX=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],k_=nt("phone",zX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HX=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],VX=nt("play",HX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qX=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],fd=nt("plus",qX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WX=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],$X=nt("refresh-cw",WX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GX=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],KX=nt("rotate-ccw",GX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XX=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],YX=nt("rotate-cw",XX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JX=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ZX=nt("save",JX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QX=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Po=nt("search",QX);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eY=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],dD=nt("settings",eY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tY=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],hD=nt("shield-check",tY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rY=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],QE=nt("shield",rY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nY=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],sY=nt("sparkles",nY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aY=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Z0=nt("square-pen",aY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iY=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],oY=nt("trash-2",iY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lY=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],dd=nt("trending-down",lY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cY=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Kc=nt("trending-up",cY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uY=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],pD=nt("triangle-alert",uY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fY=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],dY=nt("underline",fY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hY=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],jf=nt("upload",hY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pY=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Xx=nt("user-check",pY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mY=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],mD=nt("user-plus",mY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xY=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],v3=nt("user-x",xY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gY=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],w1=nt("user",gY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yY=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],vY=nt("users",yY);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bY=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Zn=nt("x",bY),eS=({title:e,subtitle:t,children:r})=>d.jsxs("div",{className:"flex min-h-screen bg-white",children:[d.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-[#1d4e89] flex-col p-12 justify-between",children:[d.jsx("div",{className:"flex items-center gap-3"}),d.jsx("div",{className:"mb-24",children:d.jsxs("h1",{className:"text-white text-6xl font-bold leading-tight",children:["Winvale",d.jsx("br",{}),d.jsx("span",{className:"text-blue-300",children:"Automation Platform"})]})}),d.jsx("div",{className:"text-blue-200 text-sm"})]}),d.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8 bg-[#f8fafc]",children:d.jsxs("div",{className:"max-w-md w-full",children:[d.jsxs("div",{className:"lg:hidden flex items-center justify-center gap-3 mb-6",children:[d.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center shrink-0",children:d.jsx("img",{src:"logo.png",alt:"Winvale Logo"})}),d.jsx("span",{className:"text-2xl font-bold text-slate-900",children:"Winvale"})]}),d.jsxs("div",{className:"mb-10",children:[d.jsx("h2",{className:"text-3xl text-center font-bold text-slate-900 mb-2",children:e}),d.jsx("p",{className:"text-slate-500 text-center",children:t})]}),d.jsx("div",{className:"bg-white p-8 rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-100",children:r})]})})]}),wY=/^[A-Za-z0-9]+(?:[A-Za-z0-9 .,'&()\-]*[A-Za-z0-9])?$/,xD=/^[A-Za-z]+(?:[ .'-][A-Za-z]+)*$/,_Y=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,EY=/^\+?\d{1,14}$/,SY=/^[A-Za-z0-9]{1,7}$/,Xc={length:{test:e=>e.length>=8,label:"At least 8 characters"},lowercase:{test:e=>/[a-z]/.test(e),label:"At least 1 lowercase letter"},uppercase:{test:e=>/[A-Z]/.test(e),label:"At least 1 uppercase letter"},number:{test:e=>/\d/.test(e),label:"At least 1 number"},special:{test:e=>/[^A-Za-z0-9]/.test(e),label:"At least 1 special character"}},gD=e=>e?Object.values(Xc).find(r=>!r.test(e))?"Password does not meet requirements":null:"Password is required",yD=(e,t,r)=>e!==t?`${r} do not match`:null,Tl=(e,t)=>e==null||typeof e=="string"&&!e.trim()?`${t} is required`:null,vD=(e,t,r)=>{const n=(e==null?void 0:e.trim())||"";return n&&n.length<t?`${r} must be at least ${t} characters`:null},Dn=(e,t,r)=>{const n=(e==null?void 0:e.trim())||"";return n&&n.length>t?`${r} must be under ${t} characters`:null},hd=e=>{const t=(e==null?void 0:e.trim())||"";return t?_Y.test(t)?Dn(t,50,"Email"):"Please enter a valid email address":"Email is required"},_1=(e,t="Phone number")=>{const r=(e==null?void 0:e.trim())||"";return r?EY.test(r)?null:`${t} must be up to 14 digits and may start with +`:`${t} is required`},E1=e=>{const t=(e==null?void 0:e.trim())||"";return t&&!SY.test(t)?"ZIP code must be alphanumeric and up to 7 characters":null},S1=(e,t=!1)=>{const r=(e==null?void 0:e.trim())||"",n=t?"Company name":"Name",s=t?wY:xD;return r?s.test(r)?Dn(r,30,"Name"):t?"Company name can contain letters, numbers, spaces, and . , ' & ( ) - only":"Name can contain letters, spaces, and . ' - only":`${n} is required`},NY=(e,t="Name")=>{const r=(e==null?void 0:e.trim())||"";return r?xD.test(r)?Dn(r,30,"Name"):`${t} can contain letters, spaces, and . ' - only`:null},TY=(e,t,r,n)=>e<t||e>r?`${n} must be between ${t} and ${r}`:null,b3=(e,t)=>!Number.isInteger(e)||e<0?`${t} must be a positive number`:null,kY=()=>{const{refreshUser:e}=Ui(),[t,r]=ne.useState(""),[n,s]=ne.useState(""),[a,i]=ne.useState(!1),[o,c]=ne.useState(!1),[f,h]=ne.useState(null),[p,x]=ne.useState({}),g=ne.useRef(!1),v=()=>{const w={},_=hd(t);_&&(w.email=_);const S=Tl(n,"Password");return S&&(w.password=S),x(w),Object.keys(w).length===0},y=async w=>{if(w.preventDefault(),!(o||g.current)&&(h(null),!!v())){c(!0);try{await YV({username:t.trim(),password:n}),g.current=!0;try{await e()}catch{h("Login successful, but profile could not be loaded.")}}catch(_){h((_==null?void 0:_.message)||"Failed to sign in. Please check your credentials.")}finally{c(!1)}}};return d.jsxs(eS,{title:"Welcome back",subtitle:"Sign in to access your dashboard",children:[f&&d.jsx("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 text-sm",children:f}),d.jsxs("form",{onSubmit:y,className:"space-y-6",noValidate:!0,children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(f0,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"email",value:t,onChange:w=>{r(w.target.value),x(_=>({..._,email:void 0}))},className:"block w-full pl-11 pr-4 py-3 rounded-xl outline-none transition-all bg-slate-50 border border-slate-200 focus:ring-blue-500",placeholder:"name@winvale.com"})]}),p.email&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.email})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Password"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(b1,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:a?"text":"password",value:n,onChange:w=>{s(w.target.value),x(_=>({..._,password:void 0}))},className:"block w-full pl-11 pr-11 py-3 rounded-xl outline-none transition-all bg-slate-50 border border-slate-200 focus:ring-blue-500",placeholder:""}),d.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-slate-400 hover:text-slate-600",children:a?d.jsx(Bh,{className:"h-5 w-5"}):d.jsx(No,{className:"h-5 w-5"})})]}),p.password&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.password})]}),d.jsx("div",{className:"flex items-center justify-end",children:d.jsx(Cf,{to:"/forgot-password",className:"text-sm font-semibold text-blue-600 hover:text-blue-700",children:"Forgot password?"})}),d.jsx("button",{type:"submit",disabled:o,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#3498db] hover:bg-[#2980b9] text-white font-semibold rounded-xl shadow-lg shadow-blue-500/30 transition-all active:scale-[0.98] disabled:opacity-70",children:o?d.jsx(Ar,{className:"h-5 w-5 animate-spin"}):"Sign in"})]}),d.jsxs("div",{className:"mt-8 text-center text-sm border-t border-slate-100 pt-6",children:["Don't have an account?"," ",d.jsx(Cf,{to:"/signup",className:"font-semibold text-blue-600 hover:text-blue-700",children:"Sign up"})]})]})},w3="winvale.com",AY=e=>{const t={};t.fullName=vD(e.fullName,3,"Full name")||Dn(e.fullName,30,"Full name")||S1(e.fullName)||void 0;const r=hd(e.email);r?t.email=r:e.email.trim().toLowerCase().endsWith(`@${w3}`)||(t.email=`Only @${w3} email addresses are allowed.`),t.password=gD(e.password)||void 0,t.confirmPassword=Tl(e.confirmPassword,"Confirm password")||yD(e.password,e.confirmPassword,"Passwords")||void 0;const n=Object.fromEntries(Object.entries(t).filter(([s,a])=>a!==void 0));return{isValid:Object.keys(n).length===0,errors:n}},CY=({password:e})=>d.jsx("ul",{className:"mt-3 space-y-1 text-sm",children:Object.entries(Xc).map(([t,r])=>{const n=r.test(e);return d.jsxs("li",{className:`flex items-center gap-2 ${n?"text-green-600":"text-slate-400"}`,children:[d.jsx("span",{className:`inline-flex h-4 w-4 items-center justify-center rounded-full border text-xs ${n?"border-green-600 bg-green-600 text-white":"border-slate-300"}`,children:n?"":""}),r.label]},t)})}),RY=()=>{const e=Qn(),[t,r]=ne.useState("details"),[n,s]=ne.useState({fullName:"",email:"",password:"",confirmPassword:""}),[a,i]=ne.useState(!1),[o,c]=ne.useState(!1),[f,h]=ne.useState(""),[p,x]=ne.useState(!1),[g,v]=ne.useState(null),[y,w]=ne.useState({}),_=O=>{w(z=>({...z,[O]:void 0}))},S=Object.values(Xc).some(O=>!O.test(n.password)),E=async O=>{O.preventDefault();const{isValid:z,errors:j}=AY(n);if(!z){w(j);return}x(!0),v(null);try{await tq({username:n.email.trim(),password:n.password,options:{userAttributes:{email:n.email.trim(),name:n.fullName.trim()}}}),r("otp")}catch(J){J.name==="UsernameExistsException"?v("An account with this email already exists. Try signing in."):v(J.message||"Signup failed")}finally{x(!1)}},T=async O=>{var z;O.preventDefault(),x(!0),v(null);try{await oq({username:n.email.trim(),confirmationCode:f.trim()}),e("/login")}catch(j){(z=j.message)!=null&&z.includes("Current status is CONFIRMED")||j.name==="NotAuthorizedException"?(v("This account is already verified. Please sign in."),setTimeout(()=>e("/login"),2e3)):v(j.message||"Verification failed")}finally{x(!1)}},k=t==="details"?"Sign up":"Verify email",D=t==="details"?"Company employees only  use your @winvale.com email":`Enter the code sent to ${n.email}`;return d.jsxs(eS,{title:k,subtitle:D,children:[g&&d.jsx("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 text-sm",children:g}),t==="details"?d.jsxs("form",{onSubmit:E,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Full name"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(w1,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"text",value:n.fullName,onChange:O=>{_("fullName"),s({...n,fullName:O.target.value})},className:"block w-full pl-11 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Your Name"})]}),y.fullName&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.fullName})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(f0,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"email",value:n.email,onChange:O=>{_("email"),s({...n,email:O.target.value})},className:"block w-full pl-11 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"name@winvale.com"})]}),y.email&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.email})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Password"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(b1,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:a?"text":"password",value:n.password,onChange:O=>{_("password"),s({...n,password:O.target.value})},onFocus:()=>c(!0),onBlur:()=>c(!1),className:"block w-full pl-11 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Min. 8 characters"}),d.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-slate-400 hover:text-slate-600",children:a?d.jsx(Bh,{className:"h-5 w-5"}):d.jsx(No,{className:"h-5 w-5"})})]}),d.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${o&&S&&n.password.length>0?"max-h-40 opacity-100":"max-h-0 opacity-0"}`,children:d.jsx(CY,{password:n.password})}),y.password&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.password})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Confirm password"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(hD,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:a?"text":"password",value:n.confirmPassword,onChange:O=>{_("confirmPassword"),s({...n,confirmPassword:O.target.value})},className:"block w-full pl-11 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Re-enter password"})]}),y.confirmPassword&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.confirmPassword})]}),d.jsx("button",{type:"submit",disabled:p,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#3498db] hover:bg-[#2980b9] text-white font-semibold rounded-xl disabled:opacity-70 transition-all active:scale-[0.98]",children:p?d.jsx(Ar,{className:"h-5 w-5 animate-spin"}):"Sign up"})]}):d.jsxs("form",{onSubmit:T,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Verification Code"}),d.jsx("input",{type:"text",required:!0,maxLength:6,className:"block w-full text-center text-3xl tracking-[0.5em] font-mono py-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"000000",value:f,onChange:O=>h(O.target.value)})]}),d.jsx("button",{type:"submit",disabled:p,className:"w-full py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-xl shadow-lg shadow-green-500/30 transition-all active:scale-[0.98]",children:"Confirm Registration"}),d.jsxs("button",{type:"button",onClick:()=>r("details"),className:"w-full text-slate-500 text-sm flex items-center justify-center gap-2",children:[d.jsx(uD,{className:"h-4 w-4"})," Back to details"]})]}),d.jsxs("div",{className:"mt-8 text-center text-sm border-t border-slate-100 pt-6",children:["Already have an account?"," ",d.jsx(Cf,{to:"/login",className:"font-semibold text-blue-600 hover:text-blue-700",children:"Sign in"})]})]})},OY=()=>{const e=Qn(),[t,r]=ne.useState("request"),[n,s]=ne.useState(""),[a,i]=ne.useState(""),[o,c]=ne.useState(""),[f,h]=ne.useState(!1),[p,x]=ne.useState(!1),[g,v]=ne.useState(null),[y,w]=ne.useState({}),_=Object.values(Xc).some(z=>!z.test(o)),S=()=>{const z={},j=hd(n);return j&&(z.email=j),w(z),Object.keys(z).length===0},E=()=>{const z={};return a.trim()||(z.otp="Recovery code is required"),o.trim()?_&&(z.newPassword="Password does not meet requirements"):z.newPassword="New password is required",w(z),Object.keys(z).length===0},T=async z=>{if(z.preventDefault(),v(null),!!S()){x(!0);try{await nq({username:n.trim()}),r("confirm")}catch(j){(j==null?void 0:j.name)==="UserNotFoundException"?v("Email does not exist"):v("Unable to process your request. Please try again.")}finally{x(!1)}}},k=async z=>{if(z.preventDefault(),v(null),!!E()){x(!0);try{await aq({username:n.trim(),confirmationCode:a.trim(),newPassword:o}),e("/login")}catch(j){v((j==null?void 0:j.message)||"Reset failed")}finally{x(!1)}}},D=t==="request"?"Reset password":"Set new password",O=t==="request"?"We will send a recovery code to your email":"Enter the code and choose a new password";return d.jsxs(eS,{title:D,subtitle:O,children:[g&&d.jsx("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 text-sm",children:g}),t==="request"?d.jsxs("form",{onSubmit:T,className:"space-y-6",noValidate:!0,children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email Address"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(f0,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"email",value:n,onChange:z=>{s(z.target.value),w(j=>({...j,email:void 0}))},className:"block w-full pl-11 pr-4 py-3 rounded-xl outline-none transition-all bg-slate-50 border border-slate-200 focus:ring-blue-500",placeholder:"name@winvale.com"})]}),y.email&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.email})]}),d.jsxs("button",{type:"submit",disabled:p,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#3498db] hover:bg-[#2980b9] text-white font-semibold rounded-xl shadow-lg shadow-blue-500/30 transition-all active:scale-[0.98] disabled:opacity-70",children:[p?d.jsx(Ar,{className:"h-5 w-5 animate-spin"}):"Send Code",!p&&d.jsx(c0,{className:"h-5 w-5"})]})]}):d.jsxs("form",{onSubmit:k,className:"space-y-6",noValidate:!0,children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Recovery Code"}),d.jsx("input",{type:"text",maxLength:6,value:a,onChange:z=>{i(z.target.value),w(j=>({...j,otp:void 0}))},className:`block w-full text-center text-2xl tracking-[0.5em] font-mono py-4 rounded-xl outline-none transition-all
              bg-slate-50 border border-slate-200 focus:ring-blue-500`,placeholder:"000000"}),y.otp&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.otp})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"New Password"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:d.jsx(b1,{className:"h-5 w-5 text-slate-400"})}),d.jsx("input",{type:"password",value:o,onChange:z=>{c(z.target.value),w(j=>({...j,newPassword:void 0}))},onFocus:()=>h(!0),onBlur:()=>h(!1),className:`block w-full pl-11 pr-4 py-3 rounded-xl outline-none transition-all
                  bg-slate-50 border border-slate-200 focus:ring-blue-500`,placeholder:"Min. 8 characters"})]}),y.newPassword&&d.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.newPassword}),d.jsx("div",{className:`overflow-hidden transition-all duration-300 ${f&&o.length>0&&_?"max-h-40 opacity-100":"max-h-0 opacity-0"}`,children:d.jsx("ul",{className:"mt-3 space-y-1 text-sm",children:Object.entries(Xc).map(([z,j])=>{const J=j.test(o);return d.jsxs("li",{className:`flex items-center gap-2 ${J?"text-green-600":"text-slate-400"}`,children:[d.jsx("span",{className:`inline-flex h-4 w-4 items-center justify-center rounded-full border text-xs ${J?"border-green-600 bg-green-600 text-white":"border-slate-300"}`,children:J?"":""}),j.label]},z)})})})]}),d.jsxs("button",{type:"submit",disabled:p,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#3498db] hover:bg-[#2980b9] text-white font-semibold rounded-xl shadow-lg shadow-blue-500/30 transition-all active:scale-[0.98] disabled:opacity-70",children:[p?d.jsx(Ar,{className:"h-5 w-5 animate-spin"}):"Update Password",!p&&d.jsx(c0,{className:"h-5 w-5"})]})]}),d.jsx("div",{className:"mt-8 pt-6 border-t border-slate-100 text-center",children:d.jsxs(Cf,{to:"/login",className:"inline-flex items-center text-sm font-semibold text-blue-600 hover:text-blue-700",children:[d.jsx(uD,{className:"h-4 w-4 mr-2"})," Back to sign in"]})})]})},jY=()=>d.jsxs("div",{className:"mb-10",children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"Settings"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Manage your profile and security"})]}),DY={admin:"Administrator",user:"Consultant"},_3="w-full px-4 py-2.5 rounded-xl border border-slate-200 focus:outline-none focus:ring-4 focus:ring-[#3498db]/10 focus:border-[#3498db] transition-all bg-slate-50/50 text-slate-700",E3="w-full px-4 py-2.5 rounded-xl border border-slate-100 bg-slate-100/50 text-slate-500 cursor-not-allowed",IY=({user:e,onSave:t,loading:r})=>{var y;const[n,s]=ne.useState((e==null?void 0:e.name)||""),[a,i]=ne.useState(e!=null&&e.phone_no&&e.phone_no!=="NA"?e.phone_no:""),[o,c]=ne.useState(""),[f,h]=ne.useState(""),[p,x]=ne.useState(""),g=async()=>{const w=n.trim(),_=a.trim();c(""),x(""),h("");const S=vD(n,3,"Full name")||Dn(n,30,"Full name")||S1(n)||void 0;if(S){c(S);return}if(_){const E=_1(_);if(E){x(E);return}}if(w===(e==null?void 0:e.name)&&(_||null)===((e==null?void 0:e.phone_no)||null)){h("No changes to save");return}await t({fullName:w,phone:_===""?null:_})},v=w=>{i(w.target.value),x(""),h("")};return d.jsx("section",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-slate-100/80 overflow-hidden",children:d.jsxs("div",{className:"p-8 space-y-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-8",children:[d.jsx("div",{className:"w-28 h-28 rounded-3xl bg-[#3498db]/10 flex items-center justify-center text-4xl font-bold text-[#3498db] border-4 border-white shadow-xl",children:((y=e==null?void 0:e.name)==null?void 0:y.charAt(0))||"U"}),d.jsxs("div",{className:"text-center sm:text-left",children:[d.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:e==null?void 0:e.name}),d.jsxs("div",{className:"inline-flex items-center gap-2 mt-2 px-3 py-1 bg-slate-100 rounded-full",children:[d.jsx(QE,{className:"w-3.5 h-3.5 text-[#3498db]"}),d.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-600",children:DY[e==null?void 0:e.role]||"User"})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700 ml-1",children:"Full Name"}),d.jsx("input",{className:`${_3} ${o?"border-red-500":""}`,value:n,onChange:w=>{s(w.target.value),c(""),h("")}}),o&&d.jsx("p",{className:"text-sm text-red-600 mt-1 ml-1",children:o})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700 ml-1",children:"Email"}),d.jsx("input",{type:"email",autoComplete:"email",name:"email",className:E3,value:(e==null?void 0:e.email)||"",disabled:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700 ml-1",children:"Phone Number"}),d.jsx("input",{type:"tel",autoComplete:"tel",name:"phone",className:`${_3} ${p?"border-red-500":""}`,value:a,onChange:v,placeholder:"+1234567890"}),p&&d.jsx("p",{className:"text-sm text-red-600 mt-1 ml-1",children:p})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700 ml-1",children:"Status"}),d.jsx("input",{className:E3,value:e!=null&&e.is_active?"Active":"Inactive",disabled:!0})]})]}),f&&d.jsx("div",{className:"w-full bg-red-50 p-4 border-l-4 border-red-600",children:d.jsx("p",{className:"text-sm text-red-600",children:f})}),d.jsx("div",{className:"flex justify-end pt-4",children:d.jsxs("button",{onClick:g,disabled:r,className:"btn-primary flex items-center gap-2",children:[d.jsx(ZX,{className:"w-4 h-4"}),"Save Changes"]})})]})})},Tb="w-full px-4 py-2.5 rounded-xl border border-slate-200 focus:outline-none focus:ring-4 focus:ring-[#3498db]/10 focus:border-[#3498db] transition-all bg-slate-50/50 text-slate-700",MY=({onUpdate:e,loading:t})=>{const[r,n]=ne.useState(!1),[s,a]=ne.useState(""),[i,o]=ne.useState(""),[c,f]=ne.useState(""),[h,p]=ne.useState(!1),[x,g]=ne.useState(!1),[v,y]=ne.useState(!1),[w,_]=ne.useState(!1),[S,E]=ne.useState(""),[T,k]=ne.useState(""),[D,O]=ne.useState(""),z=Object.values(Xc).some(F=>!F.test(i)),j=()=>{E(""),k(""),O("")},J=async()=>{if(j(),!s){E("Current password is required");return}const F=gD(i);if(F){k(F);return}const X=yD(i,c,"Passwords");if(X){O(X);return}if(!await e(s,i,c)){E("Current password is incorrect");return}ae()},ae=()=>{n(!1),a(""),o(""),f(""),p(!1),g(!1),y(!1),_(!1),j()};return d.jsx("section",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-slate-100/80 overflow-hidden",children:r?d.jsxs("div",{className:"p-8 space-y-6",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Update Password"}),d.jsx("button",{onClick:ae,children:d.jsx(Zn,{className:"w-5 h-5 text-slate-400"})})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:h?"text":"password",className:`${Tb} ${S?"border-red-500":""} pr-10`,autoComplete:"current-password",placeholder:"Current password",value:s,onChange:F=>{a(F.target.value),E("")}}),d.jsx("button",{type:"button",onClick:()=>p(F=>!F),className:"absolute inset-y-0 right-3 flex items-center text-slate-400",children:h?d.jsx(Bh,{size:16}):d.jsx(No,{size:16})})]}),S&&d.jsx("p",{className:"text-xs text-red-600 mt-1 ml-1",children:S})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:x?"text":"password",className:`${Tb} ${T?"border-red-500":""} pr-10`,autoComplete:"new-password",placeholder:"New password",value:i,onChange:F=>{o(F.target.value),k("")},onFocus:()=>_(!0),onBlur:()=>_(!1)}),d.jsx("button",{type:"button",onClick:()=>g(F=>!F),className:"absolute inset-y-0 right-3 flex items-center text-slate-400",children:x?d.jsx(Bh,{size:16}):d.jsx(No,{size:16})})]}),T&&d.jsx("p",{className:"text-xs text-red-600 mt-1 ml-1",children:T}),d.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${w&&i.length>0&&z?"max-h-40 opacity-100":"max-h-0 opacity-0"}`,children:d.jsx("ul",{className:"mt-3 space-y-1 text-sm",children:Object.entries(Xc).map(([F,X])=>{const P=X.test(i);return d.jsxs("li",{className:`flex items-center gap-2 ${P?"text-green-600":"text-slate-400"}`,children:[d.jsx("span",{className:`inline-flex h-4 w-4 items-center justify-center rounded-full border text-xs ${P?"border-green-600 bg-green-600 text-white":"border-slate-300"}`,children:P?"":""}),X.label]},F)})})})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:v?"text":"password",className:`${Tb} ${D?"border-red-500":""} pr-10`,autoComplete:"new-password",placeholder:"Confirm new password",value:c,onChange:F=>{f(F.target.value),O("")}}),d.jsx("button",{type:"button",onClick:()=>y(F=>!F),className:"absolute inset-y-0 right-3 flex items-center text-slate-400",children:v?d.jsx(Bh,{size:16}):d.jsx(No,{size:16})})]}),D&&d.jsx("p",{className:"text-xs text-red-600 mt-1 ml-1",children:D})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:J,disabled:t,className:"btn-primary",children:"Update Password"}),d.jsx("button",{onClick:ae,className:"px-6 py-2.5 font-bold text-slate-500",children:"Cancel"})]})]}):d.jsxs("div",{className:"p-8 flex items-center justify-between cursor-pointer",onClick:()=>n(!0),children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx(b1,{className:"w-6 h-6 text-slate-500"}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Password"}),d.jsx("p",{className:"text-sm text-slate-500",children:"Change your account password"})]})]}),d.jsx(Mr,{className:"w-4 h-4 text-[#3498db]"})]})})};function FY(){const{user:e,refreshUser:t}=Ui(),[r,n]=ne.useState(!1),s=async i=>{try{n(!0),await fq({userAttributes:{name:i.fullName}}),await Pt.put("/users",{name:i.fullName,phone_no:i.phone}),await t(),Kn.success("Profile updated successfully")}catch(o){console.error(o),Kn.error("Failed to update profile")}finally{n(!1)}},a=async(i,o,c)=>{var f;try{return n(!0),await cq({oldPassword:i,newPassword:o}),Kn.success("Password updated successfully"),!0}catch(h){return console.error(h),(h==null?void 0:h.name)==="NotAuthorizedException"||(f=h==null?void 0:h.message)!=null&&f.toLowerCase().includes("incorrect")||Kn.error(h.message||"Password update failed"),!1}finally{n(!1)}};return d.jsxs("div",{className:"min-h-screen bg-slate-50/50 p-6 lg:p-10 space-y-10",children:[d.jsx(jY,{}),d.jsxs("div",{className:"space-y-6",children:[d.jsx(IY,{user:e,onSave:s,loading:r}),d.jsx(MY,{onUpdate:a,loading:r})]})]})}const PY=()=>{const e=Fo();return ne.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),d.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:d.jsxs("div",{className:"text-center",children:[d.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),d.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),d.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},LY=()=>{const{refreshUser:e,logout:t}=Ui();return ne.useEffect(()=>{const r=setInterval(()=>{e().catch(()=>{})},2e4);return()=>clearInterval(r)},[e]),d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#f5f6f7] px-4",children:d.jsxs("div",{className:"w-full max-w-md bg-white border border-slate-200 rounded-md p-10 text-center",children:[d.jsx("div",{className:"flex justify-center mb-8",children:d.jsx("img",{src:"/logo.png",alt:"Winvale",className:"h-9 object-contain"})}),d.jsxs("p",{className:"text-base text-slate-800 leading-relaxed",children:[d.jsx("span",{className:"font-semibold",children:"Your account has been created and is awaiting approval."}),d.jsx("br",{}),d.jsx("br",{}),"Access to the system will be enabled once your request has been reviewed and approved by the"," ",d.jsx("span",{className:"font-semibold",children:"Winvale Administration team"}),"."]}),d.jsx("div",{className:"mt-10",children:d.jsx("button",{onClick:t,className:"w-full btn-primary",children:"Done"})})]})})},kb=({isAuthenticated:e,allowedRoles:t})=>{const{user:r,status:n,isActive:s}=Ui();return n==="loading"||e&&!r?null:e?s?t&&!t.includes(r.role)?d.jsx(_l,{to:"/dashboard",replace:!0}):d.jsx(g1,{}):d.jsx(_l,{to:"/pending-approval",replace:!0}):d.jsx(_l,{to:"/login",replace:!0})},dn={ADMIN:"admin",USER:"user"},BY=[{label:"Overview",items:[{to:"/dashboard",icon:wX,label:"Dashboard",roles:[dn.ADMIN,dn.USER]}]},{label:"Analysis",items:[{to:"/pricelist-analysis",icon:eX,label:"Pricelist Analysis",roles:[dn.ADMIN,dn.USER]},{to:"/analyses",icon:pX,label:"Analysis History",roles:[dn.ADMIN,dn.USER]}]},{label:"Workspace",items:[{to:"/clients",icon:Xn,label:"Clients",roles:[dn.ADMIN,dn.USER]},{to:"/contracts",icon:fD,label:"Contracts",roles:[dn.ADMIN,dn.USER]},{to:"/gsa-products",icon:EX,label:"GSA Products",roles:[dn.ADMIN,dn.USER]}]},{label:"Administrative",items:[{to:"/user-activation",icon:Xx,label:"User Management",roles:[dn.ADMIN]},{to:"/client-activation",icon:Xn,label:"Client Management",roles:[dn.ADMIN]}]},{label:"System",items:[{to:"/settings",icon:dD,label:"Settings",roles:[dn.ADMIN,dn.USER]}]}];function UY(){var v;const{user:e,logout:t}=Ui(),[r,n]=ne.useState(!1),[s,a]=ne.useState(!1),[i,o]=ne.useState({Overview:!0,Analysis:!0,Workspace:!1,Administrative:!0,System:!1}),c=Qn(),f=(e==null?void 0:e.role)===dn.ADMIN,h={admin:"Administrator",user:"Consultant"};ne.useEffect(()=>{document.body.style.overflow=r?"hidden":"unset"},[r]);const p=y=>{f&&o(w=>({...w,[y]:!w[y]}))},x=()=>a(!0),g=async()=>{await t(),a(!1),n(!1)};return d.jsxs(d.Fragment,{children:[d.jsx("header",{className:"md:hidden sticky top-0 left-0 right-0 h-16 flex items-center justify-between px-4 z-40",children:d.jsx("button",{onClick:()=>n(!0),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:d.jsx(MX,{className:"w-6 h-6 text-slate-600"})})}),d.jsx("div",{className:`fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-40 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>n(!1)}),d.jsxs("aside",{className:`
          fixed md:sticky top-0 inset-y-0 left-0 z-50
          w-72 md:w-64 bg-[#f8fafc] border-r border-slate-200
          flex flex-col h-screen
          transform transition-transform duration-300 ease-in-out
          ${r?"translate-x-0":"-translate-x-full"}
          md:translate-x-0
        `,children:[d.jsxs("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between",children:[d.jsxs("div",{onClick:()=>{c("/dashboard"),n(!1)},className:"flex items-center gap-3 cursor-pointer",children:[d.jsx("img",{src:"logo.png",alt:"Logo",className:"w-8 h-8 object-contain"}),d.jsx("span",{className:"text-2xl font-bold text-[#1e293b] tracking-tight",children:"Winvale"})]}),d.jsx("button",{onClick:()=>n(!1),className:"md:hidden p-2 hover:bg-slate-200/50 rounded-lg transition-colors",children:d.jsx(Zn,{className:"w-5 h-5 text-slate-500"})})]}),d.jsx("nav",{className:"flex-1 overflow-y-auto custom-scrollbar py-4",children:BY.map(y=>{const w=y.items.filter(S=>e&&S.roles.includes(e.role));if(w.length===0)return null;const _=!f||i[y.label];return d.jsxs("div",{className:"mb-4",children:[d.jsxs("button",{disabled:!f,onClick:()=>p(y.label),className:`w-full flex items-center justify-between px-6 mb-1 text-[10px] font-bold uppercase tracking-widest transition-colors ${f?"hover:text-slate-900 cursor-pointer text-slate-400":"text-slate-400"}`,children:[d.jsx("span",{children:y.label}),f&&(_?d.jsx(u0,{size:12}):d.jsx(Mr,{size:12}))]}),d.jsx("div",{className:`space-y-0.5 overflow-hidden transition-all duration-300 ${_?"max-h-125 opacity-100":"max-h-0 opacity-0"}`,children:w.map(S=>d.jsx(oD,{to:S.to,onClick:()=>n(!1),className:({isActive:E})=>`group flex items-center gap-3.5 px-6 py-2 transition-all duration-200 relative ${E?"text-[#24578f] font-semibold bg-[#e0e4eb]":"text-slate-500 hover:text-slate-900 hover:bg-slate-100/50"}`,children:({isActive:E})=>d.jsxs(d.Fragment,{children:[E&&d.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-[#24578f] rounded-r-full"}),d.jsx(S.icon,{className:`w-5 h-5 ${E?"text-[#24578f]":"text-slate-400 group-hover:text-slate-600"}`,strokeWidth:E?2.5:2}),d.jsx("span",{children:S.label})]})},S.to))})]},y.label)})}),d.jsxs("div",{className:"p-4 bg-slate-50/50 border-t border-slate-200",children:[d.jsxs("div",{className:"flex items-center gap-3 p-2.5 rounded-xl bg-white border border-slate-200 shadow-sm mb-3",children:[d.jsx("div",{className:"w-10 h-10 rounded-full bg-linear-to-br from-[#c3d7e7] to-[#a3c1da] flex items-center justify-center shrink-0",children:d.jsx("span",{className:"text-sm font-bold text-[#1e293b]",children:((v=e==null?void 0:e.name)==null?void 0:v.charAt(0).toUpperCase())||"U"})}),d.jsxs("div",{className:"min-w-0 overflow-hidden",children:[d.jsx("p",{className:"text-sm font-bold text-slate-800 truncate",children:(e==null?void 0:e.name)||"User"}),d.jsx("p",{className:"text-[11px] text-slate-500 font-medium uppercase tracking-wider",children:h[e==null?void 0:e.role]||"Guest"})]})]}),d.jsxs("button",{onClick:x,className:"w-full flex items-center gap-3 px-3 py-2.5 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all group",children:[d.jsx(OX,{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform"}),d.jsx("span",{className:"font-semibold text-sm",children:"Sign out"})]})]})]}),s&&d.jsx("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-slate-900/40",children:d.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-sm shadow-xl mx-4",children:[d.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Confirm Signout"}),d.jsx("p",{className:"mt-2 text-sm text-slate-600",children:"Are you sure you want to sign out?"}),d.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[d.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-600 hover:bg-slate-100 transition-colors",children:"Cancel"}),d.jsx("button",{onClick:g,className:"px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition-colors",children:"Sign out"})]})]})})]})}function zY(){return d.jsxs("div",{className:"flex h-screen overflow-hidden bg-background",children:[d.jsx(UY,{}),d.jsx("main",{className:"flex-1 overflow-auto",children:d.jsx(g1,{})})]})}const hf=(e,t)=>{const r={},n=S1(e.company_name,!0);n&&(r.company_name=n);const s=hd(e.company_email);s&&(r.company_email=s);const a=_1(e.company_phone_no,"Company Phone");a&&(r.company_phone_no=a);const i=Tl(e.company_address,"Company Address")||Dn(e.company_address,50,"Address");i&&(r.company_address=i);const o=Tl(e.company_city,"City")||Dn(e.company_city,50,"City");o&&(r.company_city=o);const c=Tl(e.company_state,"State")||Dn(e.company_state,50,"State");c&&(r.company_state=c);const f=Tl(e.company_zip,"ZIP"),h=E1(e.company_zip);return(f||h)&&(r.company_zip=f||h||""),t(r),Object.keys(r).length===0},A_=e=>{const t={},r=S1(e.contact_officer_name,!1);r&&(t.contact_officer_name=r);const n=hd(e.contact_officer_email);n&&(t.contact_officer_email=n==="Email is required"?"Email address is required":n);const s=_1(e.contact_officer_phone_no,"Phone number");s&&(t.contact_officer_phone_no=s);const a=Dn(e.contact_officer_address,50,"Address");a&&(t.contact_officer_address=a);const i=Dn(e.contact_officer_city,50,"City");i&&(t.contact_officer_city=i);const o=Dn(e.contact_officer_state,50,"State");o&&(t.contact_officer_state=o);const c=E1(e.contact_officer_zip);return c&&(t.contact_officer_zip=c),{isValid:Object.keys(t).length===0,errors:t}},Df="inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-[10px] font-bold uppercase tracking-wider border",Q0={pending:{slug:"pending",label:"Pending",styles:"bg-orange-50 text-orange-600 border-orange-100",icon:Do},active:{slug:"active",label:"Active",styles:"bg-[#DCFCE7] text-[#15803D] border-[#BBF7D0]",icon:qK},inactive:{slug:"inactive",label:"Inactive",styles:"bg-[#E5E7EB] text-[#374151] border-[#D1D5DB]",icon:HK},approved:{slug:"approved",label:"Approved",styles:"bg-emerald-50 text-emerald-600 border-emerald-100",icon:la},rejected:{slug:"rejected",label:"Rejected",styles:"bg-rose-50 text-rose-600 border-rose-100",icon:Rf}},lu=e=>{if(!e)return"unknown";const t=e.toLowerCase();return t in Q0?t:"unknown"},Ox=e=>{var r,n,s,a;const t=e.contact_officer_name||e.contact_officer_email||e.contact_officer_phone_no||e.contact_officer_address;return{id:e.client_id,name:e.company_name,contract:e.contract_number||"",status:lu(e.status),products:e.products_count??0,lastModification:((r=e.updated_time||e.created_time)==null?void 0:r.split("T")[0])??"",contact:t?{name:((n=e.contact_officer_name)==null?void 0:n.trim())||null,email:((s=e.contact_officer_email)==null?void 0:s.trim())||null,phone:((a=e.contact_officer_phone_no)==null?void 0:a.trim())||null,address:[e.contact_officer_address,e.contact_officer_city,e.contact_officer_state,e.contact_officer_zip].filter(Boolean).join(", ")||null}:null,email:e.company_email,phone:e.company_phone_no,address:[e.company_address,e.company_city,e.company_state,e.company_zip].filter(Boolean).join(", ")}},HY=e=>{var t;return{id:e.data.client_id,name:e.data.company_name,contract:e.data.contract_number||"",status:e.data.status,products:0,lastModification:((t=e.data.created_at)==null?void 0:t.split("T")[0])??"",contact:e.data.contact_officer_name||e.data.contact_officer_email||e.data.contact_officer_phone_no?{name:e.data.contact_officer_name||null,email:e.data.contact_officer_email||null,phone:e.data.contact_officer_phone_no||null,address:[e.data.contact_officer_address,e.data.contact_officer_city,e.data.contact_officer_state,e.data.contact_officer_zip].filter(Boolean).join(", ")||null}:null,email:e.data.company_email,phone:e.data.company_phone_no,address:[e.data.company_address,e.data.company_city,e.data.company_state,e.data.company_zip].filter(Boolean).join(", ")}},VY=(e,t)=>{var r;return{id:e.data.client_id,name:e.data.company_name,contract:e.data.contract_number||"",status:e.data.status,products:t||0,lastModification:((r=e.data.updated_time)==null?void 0:r.split("T")[0])??"",contact:e.data.contact_officer_name||e.data.contact_officer_email||e.data.contact_officer_phone_no?{name:e.data.contact_officer_name||null,email:e.data.contact_officer_email||null,phone:e.data.contact_officer_phone_no||null,address:[e.data.contact_officer_address,e.data.contact_officer_city,e.data.contact_officer_state,e.data.contact_officer_zip].filter(Boolean).join(", ")||null}:null,email:e.data.company_email,phone:e.data.company_phone_no,address:[e.data.company_address,e.data.company_city,e.data.company_state,e.data.company_zip].filter(Boolean).join(", ")}},S3=()=>({company_name:"",company_email:"",company_phone_no:"",company_address:"",company_city:"",company_state:"",company_zip:"",contact_officer_name:"",contact_officer_email:"",contact_officer_phone_no:"",contact_officer_address:"",contact_officer_city:"",contact_officer_state:"",contact_officer_zip:"",status:"pending"}),qY=({onAddClick:e})=>d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-12 mx-auto",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-[#1E293B]",children:"Clients"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Manage your GSA contract clients and their information"})]}),d.jsxs("button",{onClick:e,className:"flex items-center justify-center gap-2 bg-[#38A1DB] hover:bg-[#2D8BBF] text-white px-7 py-3 rounded-xl shadow-lg shadow-blue-200 transition-all active:scale-95 font-bold",children:[d.jsx(fd,{className:"w-5 h-5 stroke-[3px]"}),"Add Client"]})]}),WY=({searchQuery:e,onSearchChange:t,filterStatus:r,onFilterChange:n})=>{const s=["all","approved","pending","rejected"];return d.jsxs("div",{className:"mx-auto bg-white p-4 rounded-4xl shadow-sm border border-slate-200 mb-8 flex flex-col lg:flex-row gap-4 items-center",children:[d.jsxs("div",{className:"relative flex-1 w-full",children:[d.jsx(Po,{className:"absolute left-5 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),d.jsx("input",{type:"text",placeholder:"Search clients by name, email, or contact...",className:"w-full pl-14 pr-6 py-3.5 rounded-2xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20  bg-slate-50/50 text-slate-700 placeholder:text-slate-400 transition-all font-medium",value:e,onChange:a=>t(a.target.value)})]}),d.jsx("div",{className:"flex p-1.5 bg-slate-100 rounded-2xl w-full lg:w-auto overflow-x-auto no-scrollbar",children:s.map(a=>{const i=r===a;return d.jsx("button",{onClick:()=>n(a),className:`
                flex-1 lg:flex-none px-6 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-all duration-200 whitespace-nowrap
                ${i?"bg-white text-[#24548f] shadow-sm ring-1 ring-slate-200":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}
              `,children:a},a)})})]})},bD=ne.createContext(void 0),$Y=({children:e})=>{const[t,r]=ne.useState(null);return d.jsx(bD.Provider,{value:{selectedClientId:t,setSelectedClientId:r},children:e||d.jsx(g1,{})})},wD=()=>{const e=ne.useContext(bD);if(e===void 0)throw new Error("useClient must be used within a ClientProvider");return e},N3=({client:e,onView:t,onEdit:r,onClose:n})=>{const s=Qn(),{setSelectedClientId:a}=wD();return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 z-40",onClick:i=>{i.stopPropagation(),n()}}),d.jsxs("div",{className:"absolute right-8 top-12 z-50 w-52 bg-white border border-slate-100 rounded-2xl shadow-xl py-2",onClick:i=>i.stopPropagation(),children:[d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{t(),n()},children:[d.jsx(No,{className:"w-4 h-4"}),"View Details"]}),d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{r(),n()},children:[d.jsx(Z0,{className:"w-4 h-4"}),"Edit Client"]}),d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{a(e.id),s("/clients/products"),n()},children:[d.jsx(LX,{className:"w-4 h-4"}),"View Products"]})]})]})},T3=e=>{if(!e)return"";const t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})},k3=e=>{const t=lu(e);if(t==="unknown")return d.jsx("span",{className:`${Df} bg-slate-100 text-slate-700 border-slate-200`,children:"Unknown"});const{label:r,styles:n,icon:s}=Q0[t];return d.jsxs("span",{className:`${Df} ${n}`,children:[d.jsx(s,{className:"w-3 h-3 stroke-[2.5px]"}),d.jsx("span",{className:"hidden sm:inline",children:r})]})},GY=({clients:e,loading:t,openClientId:r,onClientClick:n,onMenuToggle:s,onView:a,onEdit:i,currentPage:o,totalClients:c,itemsPerPage:f,onPageChange:h})=>{const p=Math.ceil(c/f),x=(o-1)*f,g=()=>{const y=[];for(let _=1;_<=p;_++)_===1||_===p||_>=o-1&&_<=o+1?y.push(_):y[y.length-1]!=="..."&&y.push("...");return y},v=()=>d.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-center px-4",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center mb-4 border border-slate-100",children:d.jsx(v1,{className:"w-8 h-8 text-slate-300"})}),d.jsx("h3",{className:"text-base font-bold text-slate-500",children:"No clients found"})]});return d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 ",children:[d.jsx("div",{className:"hidden md:block",children:d.jsxs("table",{className:"w-full text-left border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Client"}),d.jsx("th",{className:"px-4 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Contact"}),d.jsx("th",{className:"hidden lg:table-cell px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Company Email"}),d.jsx("th",{className:"hidden xl:table-cell px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Last Modified"}),d.jsx("th",{className:"w-16 p-5"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:t?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading clients..."})]})})}):e.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,children:d.jsx(v,{})})}):e.map(y=>d.jsxs("tr",{onClick:()=>n(y),className:"group hover:bg-blue-50/30 cursor-pointer transition-all duration-200",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"shrink-0 w-9 h-9 rounded-xl bg-linear-to-br from-[#3399cc] to-[#2980b9] flex items-center justify-center text-white font-bold text-xs shadow-sm",children:y.name.substring(0,2).toUpperCase()}),d.jsx("span",{className:"font-semibold text-slate-900 group-hover:text-[#38A1DB] transition-colors  max-w-50",children:y.name})]})}),d.jsx("td",{className:"px-4 py-4",children:k3(y.status)}),d.jsx("td",{className:"px-6 py-4",children:y.contact?d.jsxs("div",{className:"flex flex-col max-w-37.5",children:[d.jsx("span",{className:"text-sm font-semibold text-slate-900 truncate",children:y.contact.name}),d.jsx("span",{className:"hidden lg:block text-xs text-slate-500 truncate",children:y.contact.email})]}):d.jsx("span",{className:"text-[10px] italic font-medium text-gray-400 uppercase",children:"Not Assigned"})}),d.jsx("td",{className:"hidden lg:table-cell px-6 py-4 text-sm font-medium text-slate-600 truncate max-w-45",children:y.email}),d.jsx("td",{className:"hidden xl:table-cell px-6 py-4 text-sm text-slate-500",children:d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[d.jsx(cd,{className:"w-3.5 h-3.5 text-slate-400"}),T3(y.lastModification)]})}),d.jsxs("td",{className:"p-5 relative text-right",children:[d.jsx("button",{onClick:w=>{w.stopPropagation(),s(y.id)},className:"p-2 hover:bg-slate-200 rounded-lg transition-colors",children:d.jsx(Bl,{className:"w-5 h-5 text-slate-500"})}),r===y.id&&d.jsx(N3,{client:y,onView:()=>a(y),onEdit:()=>i(y),onClose:()=>s(y.id)})]})]},y.id))})]})}),d.jsx("div",{className:"md:hidden divide-y divide-slate-100",children:t?d.jsx("div",{className:"py-20 text-center",children:d.jsx(Ar,{className:"w-8 h-8 animate-spin mx-auto text-[#24578f]"})}):e.length===0?d.jsx(v,{}):e.map(y=>{var w;return d.jsxs("div",{onClick:()=>n(y),className:"p-5 hover:bg-blue-50/50 transition active:bg-blue-100",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 rounded-2xl bg-linear-to-br from-[#3399cc] to-[#2980b9] flex items-center justify-center text-white font-bold text-lg shadow-blue-100 shadow-lg",children:y.name.substring(0,2).toUpperCase()}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-900 text-lg",children:y.name}),d.jsx("div",{className:"mt-1",children:k3(y.status)})]})]}),d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:_=>{_.stopPropagation(),s(y.id)},className:"p-2 border border-slate-200 rounded-xl bg-white shadow-sm",children:d.jsx(Bl,{className:"w-5 h-5 text-slate-500"})}),r===y.id&&d.jsx(N3,{client:y,onView:()=>a(y),onEdit:()=>i(y),onClose:()=>s(y.id)})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-slate-50 rounded-xl p-4 border border-slate-100",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Contact"}),d.jsx("p",{className:"text-sm font-semibold text-slate-800 truncate",children:((w=y.contact)==null?void 0:w.name)||""})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Modified"}),d.jsx("p",{className:"text-sm font-semibold text-slate-800",children:T3(y.lastModification)})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Company Email"}),d.jsx("p",{className:"text-sm font-semibold text-slate-800",children:y.email})]})]})]},y.id)})}),!t&&c>f&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:x+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(x+f,c)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:c})," ","clients"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:o===1,onClick:()=>h(o-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Jn,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:g().map((y,w)=>d.jsx(We.Fragment,{children:y==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>h(Number(y)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                        ${o===y?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:y})},w))}),d.jsx("button",{disabled:o===p,onClick:()=>h(o+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})},ph=({icon:e,value:t})=>t?d.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[d.jsx(e,{className:"w-4 h-4 text-slate-400"}),d.jsx("span",{className:"text-sm",children:t})]}):null,_D=({client:e,onClose:t,onEdit:r})=>{if(!e)return null;const n=()=>{r(e),t()};return d.jsxs("div",{className:"fixed inset-0 bg-slate-900/40  z-50 flex items-center justify-center p-4 h-full",children:[d.jsx("div",{className:"absolute inset-0",onClick:t}),d.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"relative bg-linear-to-br p-8",children:[d.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-3 rounded-full hover:bg-white/20 text-slate-700 transition-colors",children:d.jsx(Zn,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex items-center gap-6",children:[d.jsx("div",{className:"w-20 h-20 rounded-2xl bg-[#38A1DB] shadow-lg flex items-center justify-center text-white font-black text-2xl border-4 border-white/20",children:e.name.split(" ").map(s=>s[0]).slice(0,2).join("").toUpperCase()}),d.jsxs("div",{children:[d.jsx("p",{className:"text-blue-400 text-sm font-medium uppercase tracking-widest mb-1",children:"Client Profile"}),d.jsx("h2",{className:"text-3xl font-bold text-slate-700 tracking-tight",children:e.name})]})]})]}),d.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:d.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-slate-100",children:[d.jsx(Xn,{className:"w-5 h-5 text-[#38A1DB]"}),d.jsx("h3",{className:"font-bold text-slate-800 uppercase text-sm tracking-wider",children:"Company Details"})]}),d.jsxs("div",{className:"bg-slate-50/50 rounded-xl p-5 border border-slate-100 space-y-4",children:[d.jsx(ph,{icon:f0,value:e.email}),d.jsx(ph,{icon:k_,value:e.phone}),d.jsx(ph,{icon:Of,value:e.address})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-slate-100",children:[d.jsx(w1,{className:"w-5 h-5 text-[#38A1DB]"}),d.jsx("h3",{className:"font-bold text-slate-800 uppercase text-sm tracking-wider",children:"Primary Contact"})]}),d.jsx("div",{className:"bg-blue-50/30 rounded-xl p-5 border border-blue-100/50",children:e.contact?d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-[10px] font-bold text-[#38A1DB] uppercase tracking-tighter",children:"Full Name"}),d.jsx("p",{className:"text-slate-900 font-bold text-lg leading-none mt-1",children:e.contact.name||""})]}),d.jsxs("div",{className:"pt-2 space-y-3 border-t border-blue-100/50",children:[d.jsx(ph,{icon:f0,value:e.contact.email}),d.jsx(ph,{icon:k_,value:e.contact.phone})]})]}):d.jsx("div",{className:"text-center py-6",children:d.jsx("p",{className:"text-slate-400 italic text-sm",children:"No primary contact assigned"})})})]})]})}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 rounded-b-3xl flex justify-between border-t border-slate-100",children:[d.jsx("button",{onClick:t,className:"px-6 py-3 rounded-2xl font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-all active:scale-95",children:"Close"}),d.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-6 py-3 rounded-2xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:[d.jsx(Z0,{className:"w-4 h-4"}),"Edit Client"]})]})]})]})},KY=({currentStep:e,steps:t})=>d.jsx("div",{className:"flex items-center justify-center gap-4 p-4  border-slate-100 shrink-0",children:t.map((r,n)=>{const s=n+1,a=e>=s,i=e>s;return d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold ${a?"bg-[#38A1DB] text-white":"bg-slate-200 text-slate-400"}`,children:i?d.jsx(la,{className:"w-6 h-6"}):s}),d.jsx("span",{className:`font-semibold ${a?"text-[#38A1DB]":"text-slate-400"}`,children:r})]}),n<t.length-1&&d.jsx("div",{className:`w-16 h-1 rounded-full ${i?"bg-[#38A1DB]":"bg-slate-200"}`})]},s)})}),XY=({formData:e,errors:t,onChange:r,onClearError:n})=>{const s=a=>`w-full mt-2 px-4 py-3 rounded-xl border-2 transition-colors focus:outline-none border-slate-200 focus:border-[#38A1DB]"
    `;return d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Company Name ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_name,onChange:a=>{r("company_name",a.target.value),n("company_name")},"aria-invalid":!!t.company_name}),t.company_name&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_name})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Company Email ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"email",required:!0,className:s(),value:e.company_email,onChange:a=>{r("company_email",a.target.value),n("company_email")},"aria-invalid":!!t.company_email}),t.company_email&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_email})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Company Phone ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"tel",required:!0,className:s(),value:e.company_phone_no,onChange:a=>{r("company_phone_no",a.target.value),n("company_phone_no")},"aria-invalid":!!t.company_phone_no}),t.company_phone_no&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_phone_no})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Company Address ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_address,onChange:a=>{r("company_address",a.target.value),n("company_address")},"aria-invalid":!!t.company_address}),t.company_address&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_address})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["City ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_city,onChange:a=>{r("company_city",a.target.value),n("company_city")},"aria-invalid":!!t.company_city}),t.company_city&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_city})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["State ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_state,onChange:a=>{r("company_state",a.target.value),n("company_state")},"aria-invalid":!!t.company_state}),t.company_state&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_state})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["ZIP ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",required:!0,className:s(),value:e.company_zip,onChange:a=>{r("company_zip",a.target.value),n("company_zip")},"aria-invalid":!!t.company_zip}),t.company_zip&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:t.company_zip})]})]})},YY=({formData:e,onChange:t,errors:r,onClearError:n})=>{const s=a=>`w-full mt-2 px-4 py-3 rounded-xl border-2 transition-colors focus:outline-none border-slate-200 focus:border-[#38A1DB]"
    }`;return d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Primary Contact Name ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_name,onChange:a=>{t("contact_officer_name",a.target.value),n("contact_officer_name")},"aria-invalid":!!r.contact_officer_name}),r.contact_officer_name&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_name})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Email ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"email",className:s(),value:e.contact_officer_email,onChange:a=>{t("contact_officer_email",a.target.value),n("contact_officer_email")},"aria-invalid":!!r.contact_officer_email}),r.contact_officer_email&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_email})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Phone ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"tel",className:s(),value:e.contact_officer_phone_no,onChange:a=>{t("contact_officer_phone_no",a.target.value),n("contact_officer_phone_no")},"aria-invalid":!!r.contact_officer_phone_no}),r.contact_officer_phone_no&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_phone_no})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Address"}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_address||"",onChange:a=>{t("contact_officer_address",a.target.value),n("contact_officer_address")}}),r.contact_officer_address&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_address})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"City"}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_city||"",onChange:a=>{t("contact_officer_city",a.target.value),n("contact_officer_city")}}),r.contact_officer_city&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_city})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"State"}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_state||"",onChange:a=>{t("contact_officer_state",a.target.value),n("contact_officer_state")}}),r.contact_officer_state&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_state})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"ZIP"}),d.jsx("input",{type:"text",className:s(),value:e.contact_officer_zip||"",onChange:a=>{t("contact_officer_zip",a.target.value),n("contact_officer_zip")}}),r.contact_officer_zip&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.contact_officer_zip})]})]})},JY=["Company Info","Primary Contact"],C_=({isOpen:e,title:t,subtitle:r,formData:n,errors:s,backendError:a,currentStep:i,isSubmitting:o,onClose:c,onSubmit:f,onNext:h,onBack:p,onChange:x,onClearError:g,onClearBackendError:v,submitButtonText:y="Create Client Profile"})=>{if(!e)return null;const w=_=>{_.preventDefault(),f(_)};return d.jsx("div",{className:"fixed inset-0 bg-slate-900/40 backdrop-blur-none z-50 flex items-center justify-center p-4 h-full",children:d.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[d.jsx("div",{className:"bg-linear-to-br bg-slate-50 py-4 px-8 shrink-0",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-700",children:t}),d.jsx("p",{className:"text-slate-500 text-sm opacity-80",children:r})]}),d.jsx("button",{type:"button",onClick:c,className:"p-2 hover:bg-white/20 rounded-full transition-colors",disabled:o,children:d.jsx(Zn,{className:"w-6 h-6 text-slate-700"})})]})}),d.jsx(KY,{currentStep:i,steps:JY}),a&&d.jsx("div",{className:"mx-8 mt-4 p-4 bg-red-50 border-l-4 border-red-500 ",children:d.jsxs("div",{className:"flex items-start",children:[d.jsx("div",{className:"ml-3 flex-1",children:d.jsx("p",{className:"text-sm font-medium text-red-800",children:a})}),v&&d.jsx("button",{type:"button",onClick:v,className:"ml-3 shrink-0 text-red-400 hover:text-red-600 transition-colors",children:d.jsx(Zn,{className:"h-5 w-5"})})]})}),d.jsxs("form",{onSubmit:w,className:"flex-1 overflow-y-auto",children:[d.jsxs("div",{className:"py-4 px-8 space-y-6",children:[i===1&&d.jsx(XY,{formData:n,errors:s,onChange:x,onClearError:g}),i===2&&d.jsx(YY,{formData:n,onChange:x,errors:s,onClearError:g})]}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 flex justify-between border-t border-slate-100 shrink-0",children:[d.jsx("button",{type:"button",onClick:i===1?c:p,className:"px-6 py-3 rounded-xl border-2 border-slate-300 font-bold text-slate-600 hover:bg-slate-100 transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:o,children:i===1?"Cancel":"Back"}),i===1?d.jsx("button",{type:"button",onClick:h,className:"px-6 py-3 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:"Next"}):d.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:o?"Processing...":y})]})]})]})})};function ZY(){const[e,t]=ne.useState(""),[r,n]=ne.useState("all"),[s,a]=ne.useState(null),[i,o]=ne.useState([]),[c,f]=ne.useState(!0),[h,p]=ne.useState({}),[x,g]=ne.useState(""),[v,y]=ne.useState(!1),[w,_]=ne.useState(!1),[S,E]=ne.useState(1),[T,k]=ne.useState(1),[D,O]=ne.useState(null),[z,j]=ne.useState(!1),[J,ae]=ne.useState(null),[F,X]=ne.useState(S3()),[P,le]=ne.useState(1),ee=10,te=i.filter(Y=>{var B;const U=Y.name.toLowerCase().includes(e.toLowerCase())||(((B=Y.contact)==null?void 0:B.name)||"").toLowerCase().includes(e.toLowerCase()),we=r==="all"||Y.status===r;return U&&we}),me=te.length,ie=(P-1)*ee,Ee=te.slice(ie,ie+ee);ne.useEffect(()=>{le(1)},[e,r]);const K=Y=>{Y.preventDefault(),hf(F,p)&&E(2)},M=Y=>{Y.preventDefault(),J&&hf(J,p)&&k(2)},q=(Y,U="operation")=>{var V,C,A,H,ue;console.error(`Error during ${U}:`,Y);const we=(V=Y.response)==null?void 0:V.status,B=((A=(C=Y.response)==null?void 0:C.data)==null?void 0:A.detail)||((ue=(H=Y.response)==null?void 0:H.data)==null?void 0:ue.message);let be="";switch(we){case 400:be=B||"Invalid data provided. Please check your inputs.";break;case 401:be=B||"You are not authorized. Please log in again.";break;case 403:be=B||"You don't have permission to perform this action.";break;case 404:be=B||"Client not found.";break;case 409:be=B||"A client with this email or phone number already exists. Please use different contact information.",U==="create client"?E(1):U==="update client"&&k(1);break;case 422:be=B||"Validation error. Please check all required fields.";break;case 500:be=B||"Server error occurred. Please try again later.";break;case 503:be=B||"Service temporarily unavailable. Please try again later.";break;default:Y.message==="Network Error"||(be=B||`Failed to ${U}. Please try again.`)}g(be)},G=async Y=>{if(Y.preventDefault(),!hf(F,p)){E(1);return}const we=A_(F);if(!we.isValid){p(B=>({...B,...we.errors})),E(2);return}j(!0);try{const B=await Pt.post("/clients",F),be=HY(B);o(V=>[be,...V]),Q(),y(!1),re()}catch(B){q(B,"create client")}finally{j(!1)}},Z=async Y=>{if(Y.preventDefault(),!J)return;if(!hf(J,p)){k(1);return}const we=A_(J);if(!we.isValid){p(B=>({...B,...we.errors})),k(2);return}j(!0);try{const B=await Pt.put(`/clients/${J.id}`,J),be=VY(B,J.products||0);o(V=>V.map(C=>C.id===be.id?be:C)),_(!1),ae(null),k(1),p({})}catch(B){q(B,"update client")}finally{j(!1)}},re=()=>{X(S3()),E(1),p({}),g("")},L=Y=>{var U,we,B,be,V,C,A,H,ue,ye,he;ae({id:Y.id,company_name:Y.name,company_email:Y.email,company_phone_no:Y.phone,company_address:Y.address.split(", ")[0]||"",company_city:Y.address.split(", ")[1]||"",company_state:Y.address.split(", ")[2]||"",company_zip:Y.address.split(", ")[3]||"",contact_officer_name:((U=Y.contact)==null?void 0:U.name)||"",contact_officer_email:((we=Y.contact)==null?void 0:we.email)||"",contact_officer_phone_no:((B=Y.contact)==null?void 0:B.phone)||"",contact_officer_address:((V=(be=Y.contact)==null?void 0:be.address)==null?void 0:V.split(", ")[0])||"",contact_officer_city:((A=(C=Y.contact)==null?void 0:C.address)==null?void 0:A.split(", ")[1])||"",contact_officer_state:((ue=(H=Y.contact)==null?void 0:H.address)==null?void 0:ue.split(", ")[2])||"",contact_officer_zip:((he=(ye=Y.contact)==null?void 0:ye.address)==null?void 0:he.split(", ")[3])||"",status:Y.status,products:Y.products}),k(1),p({}),g(""),_(!0)},I=(Y,U,we,B)=>{U({...Y,[we]:B})},se=Y=>{p(U=>({...U,[Y]:void 0}))},Q=async()=>{try{f(!0);const U=(await Pt.get("/clients")).data.map(Ox);o(U)}catch(Y){q(Y,"load clients")}finally{f(!1)}};return ne.useEffect(()=>{Q()},[]),d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-6 lg:p-10 space-y-10",children:[d.jsx(qY,{onAddClick:()=>y(!0)}),d.jsx(WY,{searchQuery:e,onSearchChange:t,filterStatus:r,onFilterChange:n}),d.jsx(GY,{clients:Ee,loading:c,openClientId:D,onClientClick:a,onMenuToggle:Y=>O(D===Y?null:Y),onView:a,onEdit:L,currentPage:P,totalClients:me,itemsPerPage:ee,onPageChange:le}),d.jsx(_D,{client:s,onClose:()=>a(null),onEdit:L}),d.jsx(C_,{isOpen:v,title:"Add Client",subtitle:"Set up a new Client Profile ",formData:F,errors:h,backendError:x,currentStep:S,isSubmitting:z,onClose:()=>{y(!1),re()},onSubmit:G,onNext:K,onBack:()=>E(1),onChange:(Y,U)=>I(F,X,Y,U),onClearError:se,onClearBackendError:()=>g(""),submitButtonText:"Create Client Profile"}),J&&d.jsx(C_,{isOpen:w,title:"Edit Client",subtitle:"Update client profile details",formData:J,errors:h,backendError:x,currentStep:T,isSubmitting:z,onClose:()=>{_(!1),k(1),p({}),g("")},onSubmit:Z,onNext:M,onBack:()=>k(1),onChange:(Y,U)=>I(J,ae,Y,U),onClearError:se,onClearBackendError:()=>g(""),submitButtonText:"Update Client"})]})}const Ah={async getAllProducts(){return(await Pt.get("/products")).data},async getProductsByClient(e){return(await Pt.get(`/products/client/${e}`)).data},async exportProducts(e){return(await Pt.get(`/export/${e}`,{responseType:"blob"})).data}};function QY(){var D;const e=Qn(),{selectedClientId:t}=wD(),r=t,[n,s]=ne.useState([]),[a,i]=ne.useState(null),[o,c]=ne.useState(!0),[f,h]=ne.useState(""),[p,x]=ne.useState(""),[g,v]=ne.useState(1),y=10;ne.useEffect(()=>{r?w():c(!1)},[r]);const w=async()=>{var O,z;if(r)try{c(!0);const j=await Ah.getProductsByClient(r);s(j.items)}catch(j){h(((z=(O=j.response)==null?void 0:O.data)==null?void 0:z.detail)||"Failed to load products")}finally{c(!1)}},_=n.filter(O=>O.item_name.toLowerCase().includes(p.toLowerCase())||O.manufacturer.toLowerCase().includes(p.toLowerCase())||O.manufacturer_part_number.toLowerCase().includes(p.toLowerCase())),S=Math.ceil(_.length/y),E=(g-1)*y,T=_.slice(E,E+y),k=O=>O==null?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O);return o?d.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:d.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("span",{className:"text-slate-400 font-bold",children:"Loading Products..."})]})}):d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 to-slate-100 p-6",children:[d.jsxs("div",{className:"mx-auto",children:[d.jsxs("div",{className:"mb-8",children:[d.jsxs("button",{onClick:()=>e(-1),className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 transition-colors mb-6 font-medium group",children:[d.jsx(Jn,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),"Back to Clients"]}),d.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:d.jsxs("div",{children:[d.jsxs("h1",{className:"text-3xl font-bold text-slate-900",children:[((D=n[0])==null?void 0:D.client_name)||(r?"Client":"No Client Selected")," Products"]}),d.jsx("p",{className:"text-slate-500",children:r?`Managing ${n.length} catalog items`:"Please select a client from the Clients page"})]})}),d.jsx("div",{className:"mx-auto bg-white p-4 rounded-4xl shadow-sm border border-slate-100 mb-8 flex flex-col lg:flex-row gap-4 items-center",children:d.jsxs("div",{className:"relative flex-1 w-full",children:[d.jsx(Po,{size:20,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-500 transition-colors"}),d.jsx("input",{type:"text",placeholder:"Search by name, manufacturer, or part number...",value:p,onChange:O=>{x(O.target.value),v(1)},className:"w-full pl-14 pr-4 py-3 border border-slate-200 rounded-2xl bg-slate-50/50 focus:ring-2 focus:ring-blue-500/20  outline-none transition-all"})]})})]}),d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"Item Name"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"Type"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"Manufacturer"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"MFR Part #"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"Price"}),d.jsx("th",{className:"text-left p-5 font-semibold text-slate-600 text-sm",children:"UOM"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:T.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"px-6 py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 text-slate-500",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center border border-slate-100",children:d.jsx(v1,{className:"w-8 h-8 text-slate-300"})}),d.jsx("h3",{className:"text-base font-bold text-slate-500",children:"No products found"}),p&&d.jsx("p",{className:"text-xs text-slate-400",children:"Try adjusting your search or filters"})]})})}):T.map(O=>d.jsxs("tr",{className:"hover:bg-blue-50/50 cursor-pointer transition-colors",onClick:()=>i(O),children:[d.jsxs("td",{className:"px-6 py-4",children:[d.jsx("div",{className:"font-semibold text-slate-900",children:O.item_name}),d.jsx("div",{className:"text-xs text-slate-400 truncate max-w-50",children:O.item_description})]}),d.jsx("td",{className:"px-6 py-4",children:O.item_type==="B"?d.jsx("span",{className:"px-2 py-1 rounded text-[10px] font-bold uppercase bg-emerald-100 text-emerald-700",children:"Base"}):d.jsx("span",{className:"px-2 py-1 rounded text-[10px] font-bold uppercase bg-blue-100 text-blue-700",children:"Accessory"})}),d.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:O.manufacturer}),d.jsx("td",{className:"px-6 py-4 text-sm font-mono text-slate-500",children:O.manufacturer_part_number}),d.jsx("td",{className:"px-6 py-4 text-sm font-bold text-slate-900",children:k(O.commercial_list_price)}),d.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:O.uom||"-"})]},O.product_id))})]})}),S>1&&d.jsxs("div",{className:"flex items-center justify-between px-6 py-5 bg-white border-t border-slate-100",children:[d.jsx("div",{className:"hidden sm:block",children:d.jsxs("p",{className:"text-sm text-slate-500",children:["Showing"," ",d.jsx("span",{className:"font-semibold text-slate-900",children:E+1})," ","to"," ",d.jsx("span",{className:"font-semibold text-slate-900",children:Math.min(E+y,_.length)})," ","of"," ",d.jsx("span",{className:"font-semibold text-slate-900",children:_.length})," ","products"]})}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{onClick:()=>v(O=>Math.max(1,O-1)),disabled:g===1,className:"inline-flex items-center justify-center w-10 h-10 rounded-xl border border-slate-200 bg-white text-slate-600 transition-all hover:bg-slate-50 hover:border-slate-300 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white active:scale-95",children:d.jsx(Jn,{size:18})}),d.jsx("div",{className:"flex items-center gap-1.5 mx-1",children:Array.from({length:S},(O,z)=>z+1).filter(O=>O===1||O===S||O>=g-1&&O<=g+1).map((O,z,j)=>d.jsxs(We.Fragment,{children:[z>0&&j[z-1]!==O-1&&d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}),d.jsx("button",{onClick:()=>v(O),className:`inline-flex items-center justify-center min-w-10 h-10 px-3 rounded-xl text-sm font-bold transition-all active:scale-95 ${O===g?"bg-[#3399cc] text-white shadow-blue-200 ":"bg-transparent text-slate-600 hover:bg-slate-100 hover:text-slate-900"}`,children:O})]},O))}),d.jsx("button",{onClick:()=>v(O=>Math.min(S,O+1)),disabled:g===S,className:"inline-flex items-center justify-center w-10 h-10 rounded-xl border border-slate-200 bg-white text-slate-600 transition-all hover:bg-slate-50 hover:border-slate-300 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white active:scale-95",children:d.jsx(Mr,{size:18})})]})]})]})]}),a&&d.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 transition-opacity",onClick:()=>i(null)}),d.jsxs("div",{className:"relative w-full max-w-lg bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[d.jsxs("div",{className:"p-6 border-b flex items-center justify-between bg-slate-50",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-bold text-slate-900",children:a.item_name}),d.jsx("p",{className:"text-sm text-slate-500",children:a.item_description})]}),d.jsx("button",{onClick:()=>i(null),className:"p-2 hover:bg-slate-200 rounded-full transition-colors",children:d.jsx(Zn,{size:20})})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[d.jsxs(Bm,{title:"Classification",children:[d.jsx(Ni,{label:"SIN",value:a.sin}),d.jsx(Ni,{label:"NSN",value:a.nsn}),d.jsx(Ni,{label:"UPC",value:a.upc}),d.jsx(Ni,{label:"UNSPSC",value:a.unspsc})]}),d.jsxs(Bm,{title:"Pricing & Shipping",children:[d.jsx(Ni,{label:"List Price",value:k(a.commercial_list_price)}),d.jsx(Ni,{label:"UOM",value:a.uom}),d.jsx(Ni,{label:"Qty Per Pack",value:a.quantity_per_pack}),d.jsx(Ni,{label:"COO",value:a.country_of_origin})]}),d.jsxs(Bm,{title:"Compliance",children:[d.jsx(Ni,{label:"Country of Origin",value:a.country_of_origin}),d.jsx(Ni,{label:"Recycled %",value:a.recycled_content_percent})]}),d.jsx(Bm,{title:"Documents & Links",children:d.jsxs("div",{className:"col-span-2 space-y-2",children:[a.product_url&&d.jsxs("a",{href:a.product_url,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 text-[#3399cc] hover:underline font-medium",children:[d.jsx(N_,{size:14})," View Product Website"]}),a.url_508&&d.jsxs("a",{rel:"noreferrer",className:"flex items-center gap-2 text-[#3399cc] hover:underline font-medium",children:[d.jsx(N_,{size:14})," 508 Compliance Document"]})]})})]})]})]})]})}function Bm({title:e,children:t}){return d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-4",children:e}),d.jsx("div",{className:"grid grid-cols-2 gap-4",children:t})]})}function Ni({label:e,value:t}){return d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-slate-500",children:e}),d.jsx("p",{className:"font-medium text-slate-900",children:t??"-"})]})}const If=({isOpen:e,onClose:t,onConfirm:r,title:n,message:s,details:a=[],warning:i,confirmText:o="Confirm",cancelText:c="Cancel",isSubmitting:f=!1,variant:h="emerald"})=>{if(!e)return null;const p={emerald:"bg-emerald-500 hover:bg-emerald-600",rose:"bg-rose-500 hover:bg-rose-600",amber:"bg-amber-500 hover:bg-amber-600",blue:"bg-blue-500 hover:bg-blue-600"},x={rose:"bg-rose-50 border-rose-100 text-rose-700",amber:"bg-amber-50 border-amber-100 text-amber-700",emerald:"bg-emerald-50 border-emerald-100 text-emerald-700"},g={rose:"text-rose-500",amber:"text-amber-500",emerald:"text-emerald-500"};return d.jsx("div",{className:"fixed inset-0 bg-slate-900/40 flex items-center justify-center z-50 p-4 h-full",children:d.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full overflow-hidden relative",children:[d.jsx("button",{onClick:t,className:"absolute top-6 right-6 text-slate-400 hover:text-slate-600 transition-colors",children:d.jsx(Zn,{className:"w-5 h-5"})}),d.jsxs("div",{className:"p-8",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:n}),d.jsx("div",{className:"text-slate-500 mb-6",children:s}),a.length>0&&d.jsx("div",{className:"bg-slate-50 rounded-2xl p-4 mb-6 space-y-2 text-left",children:a.map((v,y)=>d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsxs("span",{className:"text-sm text-slate-500 shrink-0",children:[v.label,":"]}),d.jsx("span",{className:"text-sm font-semibold text-slate-700 truncate text-right",children:v.value})]},y))}),i&&d.jsxs("div",{className:`flex items-start gap-3 border rounded-2xl p-4 mb-6 text-left ${x[i.type]}`,children:[d.jsx(pD,{className:`w-5 h-5 shrink-0 mt-0.5 ${g[i.type]}`}),d.jsx("p",{className:"text-xs font-medium leading-relaxed",children:i.message})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:t,disabled:f,className:"flex-1 px-6 py-3 bg-white border border-slate-200 text-slate-700 rounded-xl font-bold text-sm hover:bg-slate-50 transition-all disabled:opacity-50",children:c}),d.jsxs("button",{disabled:f,onClick:r,className:`flex-1 px-6 py-3 rounded-xl font-bold text-sm text-white transition-all shadow-sm flex items-center justify-center gap-2 ${p[h]} disabled:opacity-70`,children:[f&&d.jsx(Ar,{className:"w-4 h-4 animate-spin"}),o]})]})]})]})})},ED=({client:e,onView:t,onEdit:r,onApprove:n,onReject:s})=>{const[a,i]=ne.useState(!1),o=ne.useRef(null);ne.useEffect(()=>{const h=p=>{o.current&&!o.current.contains(p.target)&&i(!1)};return a&&document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[a]);const c=!["approved","rejected"].includes(e.status),f=e.status==="approved";return d.jsxs("div",{className:"relative",ref:o,children:[d.jsx("button",{onClick:h=>{h.stopPropagation(),i(!a)},className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:d.jsx(Bl,{className:"w-5 h-5 text-slate-600"})}),a&&d.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-slate-200 py-2 z-10",children:[d.jsxs("button",{onClick:h=>{h.stopPropagation(),t(),i(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-slate-700 hover:bg-slate-50 flex items-center gap-2 transition-colors",children:[d.jsx(No,{className:"w-4 h-4"}),"View Details"]}),d.jsxs("button",{onClick:h=>{h.stopPropagation(),r(),i(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-slate-700 hover:bg-slate-50 flex items-center gap-2 transition-colors",children:[d.jsx(Z0,{className:"w-4 h-4"}),"Edit Client"]}),d.jsx("div",{className:"border-t border-slate-100 my-2"}),c?d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:h=>{h.stopPropagation(),n(),i(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-emerald-600 hover:bg-emerald-50 flex items-center gap-2 transition-colors",children:[d.jsx(Ll,{className:"w-4 h-4"}),"Approve"]}),d.jsxs("button",{onClick:h=>{h.stopPropagation(),s(),i(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-rose-600 hover:bg-rose-50 flex items-center gap-2 transition-colors",children:[d.jsx(Zn,{className:"w-4 h-4"}),"Reject"]})]}):d.jsx("button",{onClick:h=>{h.stopPropagation(),f?s():n(),i(!1)},className:`w-full px-4 py-2 text-left text-sm font-medium flex items-center gap-2 transition-colors ${f?"text-red-600 hover:bg-rose-50":"text-emerald-600 hover:bg-emerald-50"}`,children:f?d.jsxs(d.Fragment,{children:[d.jsx(Zn,{className:"w-4 h-4"}),"Reject"]}):d.jsxs(d.Fragment,{children:[d.jsx(Ll,{className:"w-4 h-4"}),"Approve"]})})]})]})},eJ=({client:e,onView:t,onEdit:r,onApprove:n,onReject:s,getStatusBadge:a})=>d.jsxs("div",{onClick:t,className:"bg-white rounded-2xl shadow-sm border border-slate-100 p-5 hover:shadow-md transition-all cursor-pointer",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center shrink-0",children:d.jsx(Xn,{className:"w-6 h-6 text-blue-500"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"font-bold text-slate-800 text-base truncate",children:e.company_name}),d.jsx("p",{className:"text-xs text-slate-400 truncate",children:e.company_email})]})]}),d.jsx("div",{onClick:i=>i.stopPropagation(),children:d.jsx(ED,{client:e,onView:t,onEdit:r,onApprove:n,onReject:s})})]}),d.jsxs("div",{className:"space-y-2.5 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(w1,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{className:"truncate",children:e.contact_officer_name||"N/A"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(Of,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsxs("span",{className:"truncate",children:[e.company_city,", ",e.company_state]})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(cd,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{children:new Date(e.created_time).toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})})]})]}),d.jsx("div",{className:"flex items-center justify-between pt-3 border-t border-slate-100",children:a(e.status)})]}),tJ=()=>{var be,V,C;const[e,t]=ne.useState([]),[r,n]=ne.useState(!0),[s,a]=ne.useState(""),[i,o]=ne.useState("pending"),[c,f]=ne.useState({isOpen:!1,client:null,action:"approve"}),[h,p]=ne.useState(null),[x,g]=ne.useState(!1),[v,y]=ne.useState(!1),[w,_]=ne.useState(null),[S,E]=ne.useState({}),[T,k]=ne.useState(1),[D,O]=ne.useState(!1),[z,j]=ne.useState(""),[J,ae]=ne.useState(1),F=8,X=async()=>{try{n(!0);const A=await Pt.get("/clients");t(Array.isArray(A.data)?A.data:[])}catch(A){P(A,"load clients")}finally{n(!1)}};ne.useEffect(()=>{X()},[]),ne.useEffect(()=>{ae(1)},[i,s]);const P=(A,H="operation")=>{var ke,De,Fe,$e,rt;const ue=(ke=A.response)==null?void 0:ke.status;let he=((Fe=(De=A.response)==null?void 0:De.data)==null?void 0:Fe.detail)||((rt=($e=A.response)==null?void 0:$e.data)==null?void 0:rt.message)||`Failed to ${H}. Please try again.`;ue===409&&k(1),j(he),Kn.error(he)},le=(A,H)=>{f({isOpen:!0,client:A,action:H})},ee=()=>{f({isOpen:!1,client:null,action:"approve"})},te=async()=>{if(!c.client)return;const{client_id:A}=c.client,{action:H}=c;try{await Pt.patch(`/clients/${A}/approve`,null,{params:{action:H}}),Kn.success(`Client ${H==="approve"?"approved":"rejected"} successfully`),await X(),ee()}catch(ue){P(ue,`${H} client`)}},me=A=>{const H=Ox(A);p(H),g(!0)},ie=A=>{var H,ue,ye,he,ke,De,Fe,$e,rt,at,qt;_({id:A.id,company_name:A.name,company_email:A.email,company_phone_no:A.phone,company_address:A.address.split(", ")[0]||"",company_city:A.address.split(", ")[1]||"",company_state:A.address.split(", ")[2]||"",company_zip:A.address.split(", ")[3]||"",contact_officer_name:((H=A.contact)==null?void 0:H.name)||"",contact_officer_email:((ue=A.contact)==null?void 0:ue.email)||"",contact_officer_phone_no:((ye=A.contact)==null?void 0:ye.phone)||"",contact_officer_address:((ke=(he=A.contact)==null?void 0:he.address)==null?void 0:ke.split(", ")[0])||"",contact_officer_city:((Fe=(De=A.contact)==null?void 0:De.address)==null?void 0:Fe.split(", ")[1])||"",contact_officer_state:((rt=($e=A.contact)==null?void 0:$e.address)==null?void 0:rt.split(", ")[2])||"",contact_officer_zip:((qt=(at=A.contact)==null?void 0:at.address)==null?void 0:qt.split(", ")[3])||"",status:A.status,products:A.products}),y(!0),k(1),E({}),j("")},Ee=A=>{A.preventDefault(),w&&hf(w,E)&&k(2)},K=async A=>{if(A.preventDefault(),!w)return;if(!hf(w,E)){k(1);return}const ue=A_(w);if(!ue.isValid){E(ye=>({...ye,...ue.errors})),k(2);return}O(!0);try{await Pt.put(`/clients/${w.id}`,w),Kn.success("Client updated successfully"),await X(),y(!1)}catch(ye){P(ye,"update client")}finally{O(!1)}},M=A=>{me(A)},q=e.filter(A=>!["approved","rejected"].includes(A.status)),G=e.filter(A=>A.status==="approved"),Z=e.filter(A=>A.status==="rejected"),L=(()=>{let A=[];return i==="pending"?A=q:i==="approved"?A=G:i==="rejected"?A=Z:A=e,A.filter(H=>{var ue,ye;return((ue=H.company_name)==null?void 0:ue.toLowerCase().includes(s.toLowerCase()))||((ye=H.contact_officer_name)==null?void 0:ye.toLowerCase().includes(s.toLowerCase()))})})(),I=L.length,se=(J-1)*F,Q=L.slice(se,se+F),Y=Math.ceil(I/F),U=A=>A==="rejected"?d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-rose-50 text-rose-600 border-rose-100",children:[d.jsx(Rf,{className:"w-3 h-3"})," Rejected"]}):A==="approved"?d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-emerald-50 text-emerald-600 border-emerald-100",children:[d.jsx(la,{className:"w-3 h-3"})," Approved"]}):d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-orange-50 text-orange-600 border-orange-100",children:[d.jsx(Do,{className:"w-3 h-3"})," Pending"]}),we=()=>{switch(i){case"all":return"All Clients";case"pending":return"Pending Client Requests";case"approved":return"Approved Clients";case"rejected":return"Rejected Clients";default:return"Clients"}},B=()=>{switch(i){case"all":return"Complete list of all client profiles";case"pending":return"Client Profiles awaiting approval";case"approved":return"Approved Client Profiles";case"rejected":return"Client Profiles that are registration";default:return""}};return r?d.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"mt-4 text-slate-500",children:"Loading clients ..."})]}):d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-4 sm:p-6 lg:p-10 space-y-6 sm:space-y-8 lg:space-y-10",children:[d.jsx(If,{isOpen:c.isOpen,onClose:ee,onConfirm:te,title:`Confirm ${c.action==="approve"?"Approval":"Rejection"}`,message:d.jsxs(d.Fragment,{children:["Are you sure you want to ",c.action," ",d.jsx("span",{className:"font-bold text-slate-700",children:(be=c.client)==null?void 0:be.company_name}),"?"]}),details:[{label:"Company",value:((V=c.client)==null?void 0:V.company_name)||""},{label:"Email",value:((C=c.client)==null?void 0:C.company_email)||""}],variant:c.action==="approve"?"emerald":"rose",confirmText:c.action==="approve"?"Approve":"Reject",isSubmitting:r}),d.jsx(_D,{client:h,onClose:()=>{g(!1),p(null)},onEdit:ie}),w&&d.jsx(C_,{isOpen:v,title:"Edit Client",subtitle:"Update client information",formData:w,errors:S,backendError:z,currentStep:T,isSubmitting:D,onClose:()=>y(!1),onSubmit:K,onNext:Ee,onBack:()=>k(1),onChange:(A,H)=>{_({...w,[A]:H}),S[A]&&E({...S,[A]:""})},onClearError:A=>E({...S,[A]:""}),onClearBackendError:()=>j(""),submitButtonText:"Update Client"}),d.jsxs("div",{className:"mx-auto",children:[d.jsx("h1",{className:"text-3xl  font-extrabold tracking-tight text-slate-800",children:"Client Management"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1 ",children:"Manage client registrations, approvals, and accounts."})]}),d.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[{label:"Total Clients",count:e.length,icon:Xn,color:"blue"},{label:"Pending Requests",count:q.length,icon:Do,color:"orange"},{label:"Approved Clients",count:G.length,icon:la,color:"emerald"},{label:"Rejected",count:Z.length,icon:Rf,color:"rose"}].map(A=>d.jsxs("div",{className:"bg-white p-4 sm:p-6 lg:p-8 rounded-2xl sm:rounded-3xl shadow-sm flex items-center gap-3 sm:gap-5 border border-slate-100",children:[d.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-${A.color}-50 rounded-full flex items-center justify-center shrink-0`,children:d.jsx(A.icon,{className:`w-5 h-5 sm:w-6 sm:h-6 lg:w-7 lg:h-7 text-${A.color}-600`})}),d.jsxs("div",{className:"min-w-0 flex-1",children:[d.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold uppercase tracking-widest text-slate-400 truncate",children:A.label}),d.jsx("p",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold",children:A.count})]})]},A.label))}),d.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl shadow-sm border border-slate-100 ",children:[d.jsx("div",{className:"border-b border-slate-100 px-4 sm:px-6 lg:px-8 pt-4 sm:pt-6 overflow-x-auto",children:d.jsx("div",{className:"flex gap-1 sm:gap-2 min-w-max ",children:[{id:"all",label:"All Clients",count:e.length,color:"blue"},{id:"pending",label:"Pending",count:q.length,color:"orange"},{id:"approved",label:"Approved",count:G.length,color:"emerald"},{id:"rejected",label:"Rejected",count:Z.length,color:"rose"}].map(A=>d.jsxs("button",{onClick:()=>o(A.id),className:`px-4 sm:px-6 py-2 sm:py-3 rounded-t-xl font-bold text-xs sm:text-sm transition-all whitespace-nowrap ${i===A.id?`bg-${A.color}-50 text-${A.color}-600 border-b-2 border-${A.color}-600`:"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:[A.label," (",A.count,")"]},A.id))})}),d.jsxs("div",{className:"p-8 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-bold",children:we()}),d.jsx("p",{className:"text-slate-500 text-sm",children:B()})]}),d.jsxs("div",{className:"relative w-full md:w-80",children:[d.jsx(Po,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsx("input",{type:"text",placeholder:"Search by company or contact...",className:"w-full pl-11 pr-4 py-3 bg-white border border-slate-200 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/10 focus:border-blue-400 transition-all",value:s,onChange:A=>a(A.target.value)})]})]}),d.jsxs("div",{className:"lg:hidden px-4 sm:px-6 pb-4 sm:pb-6 space-y-3 sm:space-y-4",children:[Q.map(A=>d.jsx(eJ,{client:A,onView:()=>me(A),onEdit:()=>ie(Ox(A)),onApprove:()=>le(A,"approve"),onReject:()=>le(A,"reject"),getStatusBadge:U},A.client_id)),Q.length===0&&d.jsx("div",{className:"py-16 text-center text-slate-400 text-sm",children:"No clients found."})]}),d.jsxs("div",{className:"hidden lg:block  px-6 pb-6 ",children:[d.jsxs("table",{className:"w-full border-collapse bg-white rounded-2xl shadow-sm",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Company"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Contact Officer"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Location"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Status"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widerral Information",children:"Created Date"}),d.jsx("th",{className:"text-right px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:Q.map(A=>d.jsxs("tr",{onClick:()=>M(A),className:"group hover:bg-slate-50/30 transition-colors cursor-pointer",children:[d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:d.jsx(Xn,{className:"w-5 h-5 text-blue-500"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-sm text-slate-800",children:A.company_name}),d.jsx("p",{className:"text-xs text-slate-400",children:A.company_email})]})]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsx("p",{className:"text-sm font-semibold text-slate-700",children:A.contact_officer_name||"N/A"})}),d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"text-sm text-slate-600 flex items-center gap-1",children:[d.jsx(Of,{className:"w-3 h-3 text-slate-400"}),A.company_city,", ",A.company_state]})}),d.jsx("td",{className:"px-4 py-5",children:U(A.status)}),d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400 font-medium",children:[d.jsx(cd,{className:"w-4 h-4"}),new Date(A.created_time).toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsx("div",{className:"flex items-center justify-end",children:d.jsx(ED,{client:A,onView:()=>me(A),onEdit:()=>ie(Ox(A)),onApprove:()=>le(A,"approve"),onReject:()=>le(A,"reject")})})})]},A.client_id))})]}),Q.length===0&&d.jsx("div",{className:"py-20 text-center text-slate-400",children:"No clients found."})]}),I>F&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:se+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(se+F,I)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:I})," ","users"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:J===1,onClick:()=>ae(J-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Jn,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:(()=>{const A=[];for(let ue=1;ue<=Y;ue++)ue===1||ue===Y||ue>=J-1&&ue<=J+1?A.push(ue):A[A.length-1]!=="..."&&A.push("...");return A.map((ue,ye)=>d.jsx(We.Fragment,{children:ue==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>ae(Number(ue)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                            ${J===ue?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:ue})},ye))})()}),d.jsx("button",{disabled:J===Y,onClick:()=>ae(J+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})]})},Ch={admin:"Administrator",user:"Consultant"},SD=({user:e,onApprove:t,onReject:r,onChangeRole:n})=>{const[s,a]=ne.useState(!1),i=ne.useRef(null);ne.useEffect(()=>{const f=h=>{i.current&&!i.current.contains(h.target)&&a(!1)};return s&&document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[s]);const o=!e.is_active&&!e.is_deleted,c=e.is_active&&!e.is_deleted;return d.jsxs("div",{className:"relative",ref:i,children:[d.jsx("button",{onClick:f=>{f.stopPropagation(),a(!s)},className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:d.jsx(Bl,{className:"w-5 h-5 text-slate-600"})}),s&&d.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-slate-200 py-2 z-10",children:[o&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:f=>{f.stopPropagation(),t(),a(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-emerald-600 hover:bg-emerald-50 flex items-center gap-2 transition-colors",children:[d.jsx(Xx,{className:"w-4 h-4"}),"Approve"]}),d.jsxs("button",{onClick:f=>{f.stopPropagation(),r(),a(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-rose-600 hover:bg-rose-50 flex items-center gap-2 transition-colors",children:[d.jsx(v3,{className:"w-4 h-4"}),"Reject"]})]}),c&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:f=>{f.stopPropagation(),n(),a(!1)},className:"w-full px-4 py-2 text-left text-sm  text-slate-700 font-medium  hover:bg-slate-50 flex items-center gap-2 transition-colors",children:[d.jsx($X,{className:"w-4 h-4 text-[#3399cc]"}),"Change Role"]}),d.jsx("div",{className:"border-t border-slate-100 my-2"}),d.jsxs("button",{onClick:f=>{f.stopPropagation(),r(),a(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-rose-600 hover:bg-rose-50 flex items-center gap-2 transition-colors",children:[d.jsx(v3,{className:"w-4 h-4"}),"Reject"]})]}),e.is_deleted&&d.jsxs("button",{onClick:f=>{f.stopPropagation(),t(),a(!1)},className:"w-full px-4 py-2 text-left text-sm font-medium text-emerald-600 hover:bg-emerald-50 flex items-center gap-2 transition-colors",children:[d.jsx(Xx,{className:"w-4 h-4"}),"Approve"]})]})]})},rJ=({user:e,onApprove:t,onReject:r,onChangeRole:n,getStatusBadge:s,getRoleStyle:a})=>d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 p-5 hover:shadow-md transition-all",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center text-blue-500 font-bold text-sm uppercase shrink-0",children:e.name.charAt(0)}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"font-bold text-slate-800 text-base truncate",children:e.name}),d.jsx("p",{className:"text-xs text-slate-400 truncate",children:e.email})]})]}),d.jsx("div",{onClick:i=>i.stopPropagation(),children:d.jsx(SD,{user:e,onApprove:t,onReject:r,onChangeRole:n})})]}),d.jsxs("div",{className:"space-y-2.5 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(k_,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{className:"truncate",children:e.phone_no||"No Phone"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[d.jsx(QE,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border capitalize ${a(e.role)}`,children:Ch[e.role]||"User"})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[d.jsx(cd,{className:"w-4 h-4 text-slate-400 shrink-0"}),d.jsx("span",{children:new Date(e.created_time).toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})})]})]}),d.jsx("div",{className:"flex items-center justify-between pt-3 border-t border-slate-100",children:s(e)})]});function nJ(){var M,q,G,Z,re,L;const[e,t]=ne.useState([]),[r,n]=ne.useState(!0),[s,a]=ne.useState(!1),[i,o]=ne.useState(""),[c,f]=ne.useState("pending"),[h,p]=ne.useState({isOpen:!1,user:null,action:"approve"}),[x,g]=ne.useState({isOpen:!1,user:null}),[v,y]=ne.useState(1),w=8,_=async()=>{try{n(!0);const se=(await Pt.get("/users/all")).data;t(Array.isArray(se)?se:[se])}catch(I){console.error("Error fetching users:",I)}finally{n(!1)}};ne.useEffect(()=>{_()},[]),ne.useEffect(()=>{y(1)},[c,i]);const S=e.filter(I=>!I.is_active&&!I.is_deleted),E=e.filter(I=>I.is_active&&!I.is_deleted),T=e.filter(I=>I.is_deleted),k=(I,se)=>{p({isOpen:!0,user:I,action:se})},D=()=>{p({isOpen:!1,user:null,action:"approve"})},O=I=>{g({isOpen:!0,user:I})},z=()=>{g({isOpen:!1,user:null})},j=async(I,se)=>{try{a(!0),await Pt.patch(`/users/${I}/approve`,null,{params:{action:se}}),t(Q=>Q.map(Y=>Y.user_id===I?{...Y,is_active:se==="approve",is_deleted:se==="reject"}:Y)),Kn.success(`Client ${se==="approve"?"approved":"rejected"} successfully`),D()}catch(Q){console.error(Q),Kn.error(`Failed to ${se} user`)}finally{a(!1)}},J=()=>{h.user&&j(h.user.user_id,h.action)},ae=async()=>{var I,se;if(x.user)try{a(!0),await Pt.put(`/users/change_role/${x.user.user_id}`),await _(),Kn.success("User role changed successfully"),z()}catch(Q){console.error(Q);const Y=((se=(I=Q.response)==null?void 0:I.data)==null?void 0:se.detail)||"Failed to change user role";Kn.error(Y)}finally{a(!1)}},X=(()=>{let I=[];switch(c){case"all":I=e;break;case"pending":I=S;break;case"approved":I=E;break;case"rejected":I=T;break;default:I=e}return I.filter(se=>se.name.toLowerCase().includes(i.toLowerCase())||se.email.toLowerCase().includes(i.toLowerCase()))})(),P=X.length,le=(v-1)*w,ee=X.slice(le,le+w),te=Math.ceil(P/w),me=I=>{switch(Ch[I]||"default"){case"Administrator":return"bg-purple-50 text-purple-600 border-purple-100";case"Consultant":return"bg-orange-50 text-orange-600 border-orange-100";default:return"bg-slate-50 text-slate-600 border-slate-100"}},ie=I=>I.is_deleted?d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-rose-50 text-rose-600 border-rose-100",children:[d.jsx(Rf,{className:"w-3 h-3"}),"Rejected"]}):I.is_active?d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-emerald-50 text-emerald-600 border-emerald-100",children:[d.jsx(la,{className:"w-3 h-3"}),"Approved"]}):d.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border bg-orange-50 text-orange-600 border-orange-100",children:[d.jsx(Do,{className:"w-3 h-3"}),"Pending"]}),Ee=()=>{switch(c){case"all":return"All Users";case"pending":return"Pending User Requests";case"approved":return"Approved Users";case"rejected":return"Rejected Users";default:return"Users"}},K=()=>{switch(c){case"all":return"Complete list of all users in the system";case"pending":return"Users awaiting account activation";case"approved":return"Users with active accounts";case"rejected":return"Users whose accounts were rejected";default:return""}};return r?d.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center",children:[d.jsx(Ar,{className:"w-10 h-10 animate-spin text-[#24578f]"}),d.jsx("p",{className:"mt-4 text-slate-500",children:"Loading users ..."})]}):d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-4 sm:p-6 lg:p-10 space-y-6 sm:space-y-8 lg:space-y-10",children:[d.jsx(If,{isOpen:h.isOpen,onClose:D,onConfirm:J,title:`Confirm ${h.action==="approve"?"Approval":"Rejection"}`,message:d.jsxs(d.Fragment,{children:["Are you sure you want to ",h.action," ",d.jsx("span",{className:"font-bold text-slate-700",children:(M=h.user)==null?void 0:M.name}),"?"]}),details:[{label:"Email",value:((q=h.user)==null?void 0:q.email)||""},{label:"Role",value:Ch[(G=h.user)==null?void 0:G.role]||"User"}],warning:h.action==="reject"?{message:"This action will reject the user's account. They won't be able to access the system.",type:"rose"}:void 0,variant:h.action==="approve"?"emerald":"rose",confirmText:h.action==="approve"?"Approve":"Reject",isSubmitting:s}),d.jsx(If,{isOpen:x.isOpen,onClose:z,onConfirm:ae,title:"Change User Role",message:d.jsxs(d.Fragment,{children:["Are you sure you want to change the role of"," ",d.jsx("span",{className:"font-bold text-slate-700",children:(Z=x.user)==null?void 0:Z.name}),"?"]}),details:[{label:"Current Role",value:Ch[(re=x.user)==null?void 0:re.role]||"User"},{label:"New Role",value:((L=x.user)==null?void 0:L.role)==="admin"?"Consultant":"Administrator"}],warning:{message:"This will change the user's permissions and access level in the system.",type:"amber"},variant:"blue",confirmText:"Change Role",isSubmitting:s}),d.jsxs("div",{className:"mx-auto",children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"User Management"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Manage user accounts, approvals, and permissions."})]}),d.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[{label:"Total Users",count:e.length,icon:vY,color:"blue"},{label:"Pending Approvals",count:S.length,icon:Do,color:"orange"},{label:"Approved",count:E.length,icon:la,color:"emerald"},{label:"Rejected",count:T.length,icon:Rf,color:"rose"}].map(I=>d.jsxs("div",{className:"bg-white p-4 sm:p-6 lg:p-8 rounded-2xl sm:rounded-3xl shadow-sm flex items-center gap-3 sm:gap-5 border border-slate-100",children:[d.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-${I.color}-50 rounded-full flex items-center justify-center shrink-0`,children:d.jsx(I.icon,{className:`w-5 h-5 sm:w-6 sm:h-6 lg:w-7 lg:h-7 text-${I.color}-600`})}),d.jsxs("div",{className:"min-w-0 flex-1",children:[d.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold uppercase tracking-widest text-slate-400 truncate",children:I.label}),d.jsx("p",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900",children:I.count})]})]},I.label))}),d.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl shadow-sm border border-slate-100 ",children:[d.jsx("div",{className:"border-b border-slate-100 px-4 sm:px-6 lg:px-8 pt-4 sm:pt-6 overflow-x-auto",children:d.jsx("div",{className:"flex gap-1 sm:gap-2 min-w-max",children:[{id:"all",label:"All Users",count:e.length,color:"blue"},{id:"pending",label:"Pending",count:S.length,color:"orange"},{id:"approved",label:"Approved",count:E.length,color:"emerald"},{id:"rejected",label:"Rejected",count:T.length,color:"rose"}].map(I=>d.jsxs("button",{onClick:()=>f(I.id),className:`px-4 sm:px-6 py-2 sm:py-3 rounded-t-xl font-bold text-xs sm:text-sm transition-all whitespace-nowrap ${c===I.id?`bg-${I.color}-50 text-${I.color}-600 border-b-2 border-${I.color}-600`:"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:[I.label," (",I.count,")"]},I.id))})}),d.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-bold text-slate-900",children:Ee()}),d.jsx("p",{className:"text-slate-500 text-sm",children:K()})]}),d.jsxs("div",{className:"relative w-full md:w-80",children:[d.jsx(Po,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsx("input",{type:"text",placeholder:"Search users...",className:"w-full pl-11 pr-4 py-3 bg-white border border-slate-200 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/10 focus:border-blue-400 transition-all",value:i,onChange:I=>o(I.target.value)})]})]}),d.jsxs("div",{className:"lg:hidden px-4 sm:px-6 pb-4 sm:pb-6 space-y-3 sm:space-y-4",children:[ee.map(I=>d.jsx(rJ,{user:I,onApprove:()=>k(I,"approve"),onReject:()=>k(I,"reject"),onChangeRole:()=>O(I),getStatusBadge:ie,getRoleStyle:me},I.user_id)),ee.length===0&&d.jsx("div",{className:"py-16 text-center text-slate-400 text-sm",children:"No users found."})]}),d.jsxs("div",{className:"hidden lg:block  px-6 pb-6",children:[d.jsxs("table",{className:"w-full border-collapse bg-white rounded-2xl shadow-sm",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"User"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Role"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Phone"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Registered Date"}),d.jsx("th",{className:"text-right px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:ee.map(I=>d.jsxs("tr",{className:"group hover:bg-slate-50/30 transition-colors",children:[d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center text-blue-500 font-bold text-xs uppercase",children:I.name.charAt(0)}),d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-sm text-slate-800",children:I.name}),d.jsx("p",{className:"text-xs text-slate-400 flex items-center gap-1",children:I.email})]})]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[11px] font-bold border capitalize ${me(I.role)}`,children:[d.jsx(QE,{className:"w-3 h-3"}),Ch[I.role]||"User"]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsx("p",{className:"text-sm font-semibold text-slate-600",children:I.phone_no||"No Phone"})}),d.jsx("td",{className:"px-4 py-5",children:ie(I)}),d.jsx("td",{className:"px-4 py-5",children:d.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400 font-medium",children:[d.jsx(cd,{className:"w-4 h-4"}),new Date(I.created_time).toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})]})}),d.jsx("td",{className:"px-4 py-5",children:d.jsx("div",{className:"flex items-center justify-end",children:d.jsx(SD,{user:I,onApprove:()=>k(I,"approve"),onReject:()=>k(I,"reject"),onChangeRole:()=>O(I)})})})]},I.user_id))})]}),ee.length===0&&d.jsx("div",{className:"py-20 text-center text-slate-400",children:"No users found."})]}),P>w&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:le+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(le+w,P)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:P})," ","users"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:v===1,onClick:()=>y(v-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Jn,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:(()=>{const I=[];for(let Q=1;Q<=te;Q++)Q===1||Q===te||Q>=v-1&&Q<=v+1?I.push(Q):I[I.length-1]!=="..."&&I.push("...");return I.map((Q,Y)=>d.jsx(We.Fragment,{children:Q==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>y(Number(Q)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                            ${v===Q?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:Q})},Y))})()}),d.jsx("button",{disabled:v===te,onClick:()=>y(v+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})]})}const Yx={async getAllContracts(){return(await Pt.get("/contracts")).data},async getContractByClientId(e){return(await Pt.get(`/contracts/${e}`)).data},async createContract(e,t){return(await Pt.post(`/contracts/${e}`,t)).data},async updateContract(e,t){return(await Pt.put(`/contracts/${e}`,t)).data},async deleteContract(e){await Pt.delete(`/contracts/${e}`)}};function sJ({contracts:e,loading:t,onView:r,onEdit:n,onDelete:s,currentPage:a,totalContracts:i,itemsPerPage:o,onPageChange:c}){const[f,h]=ne.useState(null),p=Math.ceil(i/o),x=(a-1)*o,g=()=>{const y=[];for(let _=1;_<=p;_++)_===1||_===p||_>=a-1&&_<=a+1?y.push(_):y[y.length-1]!=="..."&&y.push("...");return y},v=()=>d.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-center px-4",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center mb-4 border border-slate-100",children:d.jsx(v1,{className:"w-8 h-8 text-slate-300"})}),d.jsx("h3",{className:"text-base font-bold text-slate-500",children:"No contracts found"})]});return d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 ",children:[d.jsx("div",{className:"hidden md:block",children:d.jsxs("table",{className:"w-full border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Contract"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Client"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Contract Officer"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Location"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Last Modified"}),d.jsx("th",{className:"w-16 px-6 py-4"})]})}),d.jsx("tbody",{className:"divide-slate-100 divide-y",children:t?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading contracts..."})]})})}):e.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,children:d.jsx(v,{})})}):e.map(y=>d.jsxs("tr",{onClick:()=>r(y),className:"group hover:bg-blue-50/30 cursor-pointer transition-all duration-200",children:[d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("span",{className:"font-bold text-slate-800 text-sm group-hover:text-[#38A1DB] transition-colors",children:y.contract_number})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-10 h-10 shrink-0 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] flex items-center justify-center text-white text-xs font-bold shadow-sm",children:y.client.slice(0,2).toLocaleUpperCase()}),d.jsx("div",{className:"flex flex-col",children:d.jsx("span",{className:"font-bold text-slate-800 text-sm transition-colors",children:y.client})})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm text-slate-600 font-medium",children:y.contract_officer_name||d.jsx("span",{className:"text-slate-300",children:""})})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[d.jsx(Of,{className:"w-3.5 h-3.5 text-slate-400"}),d.jsx("span",{className:"text-sm truncate max-w-37.5",children:y.contract_officer_city?`${y.contract_officer_city}, ${y.contract_officer_state}`:"Not set"})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[d.jsx(cd,{className:"w-3.5 h-3.5 text-slate-400"}),d.jsx("span",{className:"text-sm",children:new Date(y.updated_time).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})}),d.jsxs("td",{className:"px-6 py-4 text-right relative",children:[d.jsx("button",{onClick:w=>{w.stopPropagation(),h(f===y.client_id?null:y.client_id)},className:"p-2 hover:bg-slate-200 rounded-lg transition-colors",children:d.jsx(Bl,{className:"w-5 h-5 text-slate-400"})}),f===y.client_id&&d.jsx(A3,{onView:()=>r(y),onEdit:()=>n(y),onDelete:()=>s(y.client_id),onClose:()=>h(null)})]})]},y.client_profile_id))})]})}),d.jsx("div",{className:"md:hidden divide-y divide-slate-100",children:t?d.jsx("div",{className:"py-20 text-center",children:d.jsx(Ar,{className:"w-8 h-8 animate-spin mx-auto text-[#24578f]"})}):e.length===0?d.jsx(v,{}):e.map(y=>d.jsxs("div",{onClick:()=>r(y),className:"p-5 hover:bg-blue-50/50 transition active:bg-blue-100",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 rounded-2xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] flex items-center justify-center text-white font-bold text-lg shadow-blue-100 shadow-lg",children:y.contract_number.slice(0,2)}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-900 text-sm",children:y.contract_number}),d.jsx("p",{className:"text-xs text-slate-500 font-medium",children:y.client})]})]}),d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:w=>{w.stopPropagation(),h(f===y.client_id?null:y.client_id)},className:"p-2 border border-slate-200 rounded-xl bg-white shadow-sm",children:d.jsx(Bl,{className:"w-5 h-5 text-slate-500"})}),f===y.client_id&&d.jsx(A3,{onView:()=>r(y),onEdit:()=>n(y),onDelete:()=>s(y.client_id),onClose:()=>h(null)})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-slate-50 rounded-xl p-4 border border-slate-100",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Officer"}),d.jsx("p",{className:"text-xs font-semibold text-slate-800 truncate",children:y.contract_officer_name||""})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Modified"}),d.jsx("p",{className:"text-xs font-semibold text-slate-800",children:new Date(y.updated_time).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Location"}),d.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[d.jsx(Of,{size:12,className:"text-slate-400"}),d.jsx("p",{className:"text-xs font-semibold text-slate-800",children:y.contract_officer_city?`${y.contract_officer_city}, ${y.contract_officer_state}`:"Not set"})]})]})]})]},y.client_profile_id))}),!t&&i>o&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:x+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(x+o,i)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:i})," ","contracts"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:a===1,onClick:()=>c(a-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Jn,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:g().map((y,w)=>d.jsx(We.Fragment,{children:y==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>c(Number(y)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                        ${a===y?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:y})},w))}),d.jsx("button",{disabled:a===p,onClick:()=>c(a+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})}const A3=({onView:e,onEdit:t,onDelete:r,onClose:n})=>d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 z-40",onClick:s=>{s.stopPropagation(),n()}}),d.jsxs("div",{className:"absolute right-12 top-10 z-50 w-52 bg-white border border-slate-100 rounded-xl shadow-xl py-1.5 overflow-hidden animate-in fade-in zoom-in duration-100",onClick:s=>s.stopPropagation(),children:[d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{e(),n()},children:[d.jsx(No,{className:"w-4 h-4 text-slate-400"})," View Details"]}),d.jsxs("button",{className:"w-full px-4 py-3 text-left text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-3",onClick:()=>{t(),n()},children:[d.jsx(Z0,{className:"w-4 h-4 text-slate-400"})," Edit Contract"]})]})]});function aJ({contract:e,onClose:t,onEdit:r}){if(!e)return null;const n=({icon:s,value:a})=>a?d.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[d.jsx(s,{className:"w-4 h-4 text-slate-400"}),d.jsx("span",{className:"text-sm",children:a})]}):null;return d.jsxs("div",{className:"fixed inset-0 bg-slate-900/40  z-50 flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0",onClick:t}),d.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"sticky top-0 bg-linear-to-br px-8 py-6 rounded-t-3xl z-10",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-5",children:[d.jsx("div",{className:"relative",children:d.jsx("div",{className:"w-18 h-18 rounded-2xl bg-[#38A1DB]/20 backdrop-blur flex items-center justify-center shadow-inner text-[#38A1DB]",children:d.jsx(Ul,{className:"w-7 h-7"})})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-blue-400 text-sm font-medium uppercase tracking-widest mb-1",children:"Contract Details"}),d.jsx("h2",{className:"text-2xl font-bold text-slate-700 tracking-tight",children:e.contract_number}),d.jsx("p",{className:"text-sm md:text-base text-blue-100 font-medium mt-1",children:d.jsx("span",{className:"font-semibold text-slate-500",children:e.client||""})})]})]}),d.jsx("button",{onClick:t,className:"p-3 rounded-full hover:bg-white/20 transition-colors text-slate-700",children:d.jsx(Zn,{className:"w-6 h-6 text-slate-700"})})]})}),d.jsxs("div",{className:"p-8 grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-linear-to-br from-slate-50 to-white p-6 rounded-2xl border border-slate-200",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(w1,{className:"w-6 h-6 text-[#38A1DB]"}),d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Contract Officer"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Officer Name"}),d.jsx("p",{className:"text-slate-800 font-semibold mt-1",children:e.contract_officer_name||""})]}),d.jsx(n,{icon:Of,value:`${e.contract_officer_address||""}, ${e.contract_officer_city||""}, ${e.contract_officer_state||""} ${e.contract_officer_zip||""}`.trim().replace(/^,\s*/,"").replace(/,\s*,/g,",")})]})]}),d.jsxs("div",{className:"bg-linear-to-br from-blue-50 to-white p-6 rounded-2xl border border-blue-200",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(dD,{className:"w-6 h-6 text-[#38A1DB]"}),d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Terms & Logistics"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center border-b border-blue-100 pb-2",children:[d.jsx("span",{className:"text-sm text-slate-500 font-medium uppercase tracking-tight",children:"FOB Term"}),d.jsx("span",{className:"font-bold text-slate-800",children:e.fob_term})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Normal Deliv."}),d.jsxs("p",{className:"text-sm font-bold text-slate-700",children:[e.normal_delivery_time," Days"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Expedited"}),d.jsxs("p",{className:"text-sm font-bold text-slate-700",children:[e.expedited_delivery_time," Days"]})]})]}),d.jsxs("div",{className:"pt-2",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Energy Star Compliance"}),d.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[d.jsx(hD,{className:`w-4 h-4 ${e.energy_star_compliance==="Yes"?"text-emerald-500":"text-slate-300"}`}),d.jsx("span",{className:"text-sm font-bold text-slate-700",children:e.energy_star_compliance})]})]})]})]}),d.jsxs("div",{className:"md:col-span-2 bg-slate-50 p-6 rounded-2xl border border-slate-200",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d.jsx(gX,{className:"w-6 h-6 text-slate-400"}),d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Additional Terms"})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Additional Concessions"}),d.jsx("p",{className:"text-slate-700 mt-2 text-sm leading-relaxed",children:e.additional_concessions||"None specified"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Q/V Discount Details"}),d.jsx("p",{className:"text-slate-700 mt-2 text-sm leading-relaxed",children:e.q_v_discount||"None specified"})]})]})]})]}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 rounded-b-3xl flex justify-between border-t border-slate-100 z-10",children:[d.jsx("button",{onClick:t,className:"px-6 py-3 rounded-2xl font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-all active:scale-95",children:"Close"}),d.jsxs("button",{onClick:()=>{r(e),t()},className:`flex items-center gap-2 px-6 py-3 rounded-2xl
             bg-linear-to-br from-[#38A1DB] to-[#2D8BBF]
             text-white font-bold shadow-lg hover:shadow-xl
             transition-all active:scale-95`,children:[d.jsx(Z0,{className:"w-4 h-4 stroke-[2.5px]"}),"Edit Contract"]})]})]})]})}function iJ(e,t,r=!0){ne.useEffect(()=>{if(!r)return;const n=s=>{e.current&&!e.current.contains(s.target)&&t(s)};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[e,t,r])}function oJ({contract:e,onChange:t,clients:r,clientSearch:n,setClientSearch:s,showClientDropdown:a,setShowClientDropdown:i,errors:o}){const c=ne.useRef(null),f=!!e.client_id;iJ(c,()=>i(!1),a);const h=r.filter(p=>p.client_id.toString().includes(n)||p.company_name.toLowerCase().includes(n.toLowerCase()));return d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Contract Number ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",className:`w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB]"
          } outline-none`,value:e.contract_number,onChange:p=>t({...e,contract_number:p.target.value})}),o.contract_number&&d.jsx("div",{className:"mt-1 text-xs text-red-600",children:d.jsx("span",{children:o.contract_number})})]}),d.jsxs("div",{className:"md:col-span-2 relative",ref:c,children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Client ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",placeholder:"Search by Client ID or Company Name",className:`w-full mt-2 px-4 py-3 pr-10 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none ${f?"bg-slate-50 cursor-not-allowed":""}`,value:n,readOnly:f,onFocus:()=>{f||i(!0)},onChange:p=>{f||(s(p.target.value),i(!0),t({...e,client_id:void 0}))}}),f&&d.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/3 text-slate-400 hover:text-red-500",onClick:()=>{t({...e,client_id:void 0}),s(""),i(!1)},children:d.jsx(Zn,{className:"w-5 h-5"})})]}),o.client_id&&d.jsx("div",{className:"mt-1 text-xs text-red-600",children:d.jsx("span",{children:o.client_id})}),a&&!f&&d.jsx("div",{className:"absolute z-50 mt-2 w-full max-h-60 overflow-y-auto bg-white border border-slate-200 rounded-xl shadow-lg",children:h.length===0?d.jsx("div",{className:"px-4 py-3 text-slate-500 text-sm",children:"No clients found"}):h.map(p=>d.jsx("button",{type:"button",className:"w-full px-4 py-3 text-left hover:bg-blue-50 flex justify-between items-center",onClick:()=>{t({...e,client_id:p.client_id}),s(`${p.company_name}`),i(!1)},children:d.jsx("span",{className:"font-semibold text-slate-700",children:p.company_name})},p.client_id))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Contract Officer Name"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_name||"",onChange:p=>t({...e,contract_officer_name:p.target.value})}),o.contract_officer_name&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_name})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"GSA Office Address"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_address||"",onChange:p=>t({...e,contract_officer_address:p.target.value})}),o.contract_officer_address&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_address})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"GSA Office City"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_city||"",onChange:p=>t({...e,contract_officer_city:p.target.value})}),o.contract_officer_city&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_city})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"State"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_state||"",onChange:p=>t({...e,contract_officer_state:p.target.value})}),o.contract_officer_state&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_state})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"ZIP"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.contract_officer_zip||"",onChange:p=>t({...e,contract_officer_zip:p.target.value})}),o.contract_officer_zip&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.contract_officer_zip})]})]})]})}function lJ({contract:e,onChange:t,errors:r}){return d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"FOB Term"}),d.jsxs("select",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none bg-white",value:e.fob_term||"Origin",onChange:n=>t({...e,fob_term:n.target.value}),children:[d.jsx("option",{value:"Origin",children:"Origin"}),d.jsx("option",{value:"Destination",children:"Destination"})]}),r.fob_term&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.fob_term})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Energy Star Compliance"}),d.jsxs("select",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none bg-white",value:e.energy_star_compliance||"Yes",onChange:n=>t({...e,energy_star_compliance:n.target.value}),children:[d.jsx("option",{value:"Yes",children:"Yes"}),d.jsx("option",{value:"No",children:"No"}),d.jsx("option",{value:"N/A",children:"N/A"})]}),r.energy_star_compliance&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.energy_star_compliance})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Normal Delivery (Days)"}),d.jsx("input",{type:"number",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.normal_delivery_time||30,onChange:n=>t({...e,normal_delivery_time:parseInt(n.target.value)||0})}),r.normal_delivery_time&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.normal_delivery_time})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Expedited Delivery (Days)"}),d.jsx("input",{type:"number",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:e.expedited_delivery_time||10,onChange:n=>t({...e,expedited_delivery_time:parseInt(n.target.value)||0})}),r.expedited_delivery_time&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.expedited_delivery_time})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Quantity/Volume Discounts"}),d.jsx("input",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none resize-none",value:e.q_v_discount||"",onChange:n=>t({...e,q_v_discount:n.target.value})}),r.q_v_discount&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.q_v_discount})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Additional Concessions"}),d.jsx("textarea",{rows:2,className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none resize-none",value:e.additional_concessions||"",onChange:n=>t({...e,additional_concessions:n.target.value})}),r.additional_concessions&&d.jsx("p",{className:"mt-1 text-xs text-red-600",children:r.additional_concessions})]})]})}const ND={async getAllClients(){return(await Pt.get("/clients")).data},async getApprovedClients(){return(await Pt.get("/clients/approved")).data}},TD=e=>{const t={};Tl(e.client_id,"Client")&&(t.client_id="You must select a client");const n=Tl(e.contract_number,"Contract number")||Dn(e.contract_number,50,"Contract Number");n&&(t.contract_number=n);const s=NY(e.contract_officer_name,"Name");s&&(t.contract_officer_name=s);const a=Dn(e.contract_officer_address,50,"Address");a&&(t.contract_officer_address=a);const i=Dn(e.contract_officer_city,50,"City");i&&(t.contract_officer_city=i);const o=Dn(e.contract_officer_state,50,"State");o&&(t.contract_officer_state=o);const c=E1(e.contract_officer_zip);return c&&(t.contract_officer_zip=c),{isValid:Object.keys(t).length===0,errors:t}},kD=e=>{const t={},r=Dn(e.origin_country,50,"");r&&(t.origin_country=r);const n=TY(e.gsa_proposed_discount,0,100,"Discount");n&&(t.gsa_proposed_discount=n);const s=Dn(e.q_v_discount,50,"Quantity/Volume Discount");s&&(t.q_v_discount=s);const a=Dn(e.additional_concessions,50,"Additional Concessions");a&&(t.additional_concessions=a);const i=b3(e.normal_delivery_time,"Normal delivery time");i&&(t.normal_delivery_time=i);const o=b3(e.expedited_delivery_time,"Expedited delivery time");return o&&(t.expedited_delivery_time=o),e.fob_term||(t.fob_term="FOB term is required"),e.energy_star_compliance||(t.energy_star_compliance="Energy Star compliance is required"),{isValid:Object.keys(t).length===0,errors:t}},C3={client_id:void 0,contract_number:"",contract_officer_name:"",contract_officer_address:"",contract_officer_city:"",contract_officer_state:"",contract_officer_zip:"",origin_country:"USA",gsa_proposed_discount:0,q_v_discount:"",additional_concessions:"",normal_delivery_time:30,expedited_delivery_time:10,fob_term:"Origin",energy_star_compliance:"Yes",is_deleted:!1};function cJ({isOpen:e,onClose:t,onSuccess:r}){const[n,s]=ne.useState(1),[a,i]=ne.useState(C3),[o,c]=ne.useState([]),[f,h]=ne.useState(""),[p,x]=ne.useState(!1),[g,v]=ne.useState(!1),[y,w]=ne.useState({});ne.useEffect(()=>{e&&_()},[e]);const _=async()=>{try{const T=await ND.getAllClients();c(T)}catch(T){console.error("Failed to load clients",T)}},S=async T=>{var D,O,z,j;if(T.preventDefault(),n===1){const J=TD(a);w(J.errors),J.isValid&&s(2);return}const k=kD(a);if(w(k.errors),!!k.isValid){if(!a.client_id){w({client_id:"Client selection is missing"}),s(1);return}v(!0),w({}),x(!1);try{const{client_id:J,...ae}=a,F={...ae,contract_officer_name:ae.contract_officer_name||"",contract_number:ae.contract_number,origin_country:ae.origin_country||"USA",gsa_proposed_discount:Number(ae.gsa_proposed_discount)||0,normal_delivery_time:Number(ae.normal_delivery_time)||0,expedited_delivery_time:Number(ae.expedited_delivery_time)||0};await Yx.createContract(J,F),r(),E()}catch(J){const ae=(O=(D=J==null?void 0:J.response)==null?void 0:D.data)==null?void 0:O.detail;((z=J==null?void 0:J.response)==null?void 0:z.status)===409?w({submit:ae||"This client already has an active contract."}):Array.isArray(ae)?w({submit:((j=ae[0])==null?void 0:j.msg)||"Invalid data format provided."}):w({submit:ae||"An error occurred while creating the contract."})}finally{v(!1)}}},E=()=>{s(1),i(C3),h(""),w({}),t()};return ne.useEffect(()=>{w({})},[n]),e?d.jsx("div",{className:"fixed inset-0 bg-slate-900/40 z-50 flex items-center justify-center p-4 ",children:d.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[d.jsx("div",{className:"bg-slate-50 py-5 px-8 shrink-0",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-700",children:"Create Contract"}),d.jsx("p",{className:"text-slate-500 text-sm opacity-80",children:"Setup a new contract profile for your client"})]}),d.jsx("button",{type:"button",onClick:E,className:"p-2 hover:bg-white/20 rounded-full transition-colors",disabled:g,children:d.jsx(Zn,{className:"w-6 h-6 text-slate-700"})})]})}),d.jsx("div",{className:"flex items-center justify-center gap-4 p-4 shrink-0",children:["Client & Officer","Terms & Delivery"].map((T,k)=>{const D=k+1,O=n>=D,z=n>D;return d.jsxs(We.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold transition-all ${O?"bg-[#38A1DB] text-white":"bg-slate-200 text-slate-400"}`,children:z?d.jsx(la,{className:"w-6 h-6"}):D}),d.jsx("span",{className:`font-semibold ${O?"text-[#38A1DB]":"text-slate-400"}`,children:T})]}),k===0&&d.jsx("div",{className:`w-16 h-1 rounded-full transition-colors ${z?"bg-[#38A1DB]":"bg-slate-200"}`})]},D)})}),d.jsxs("form",{onSubmit:S,noValidate:!0,className:"flex-1 overflow-y-auto",children:[d.jsxs("div",{className:"py-6 px-8 space-y-6",children:[y.submit&&d.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-r-xl p-4 flex items-start gap-3",children:[d.jsx(ud,{className:"w-5 h-5 text-red-500 shrink-0 mt-0.5"}),d.jsx("div",{children:d.jsx("p",{className:"text-sm text-red-700",children:y.submit})})]}),n===1&&d.jsx(oJ,{contract:a,onChange:i,clients:o,clientSearch:f,setClientSearch:h,showClientDropdown:p,setShowClientDropdown:x,errors:y}),n===2&&d.jsx(lJ,{contract:a,onChange:i,errors:y})]}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 flex justify-between border-t border-slate-100 shrink-0",children:[d.jsx("button",{type:"button",onClick:()=>{n===1?E():s(1)},className:"px-6 py-3 rounded-xl border-2 border-slate-300 font-bold text-slate-600 hover:bg-slate-100 transition-colors disabled:opacity-50",disabled:g,children:n===1?"Cancel":"Back"}),d.jsx("button",{type:"submit",disabled:g,className:"px-6 py-3 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:g?d.jsxs(d.Fragment,{children:[d.jsx(Ar,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):n===1?"Next":"Create Contract Profile"})]})]})]})}):null}const uJ={contract_number:"",contract_officer_name:"",contract_officer_address:"",contract_officer_city:"",contract_officer_state:"",contract_officer_zip:"",origin_country:"USA",gsa_proposed_discount:0,q_v_discount:"",additional_concessions:"",normal_delivery_time:30,expedited_delivery_time:10,fob_term:"Origin",energy_star_compliance:"Yes"};function fJ({isOpen:e,contract:t,onClose:r,onSuccess:n}){const[s,a]=ne.useState(1),[i,o]=ne.useState(uJ),[c,f]=ne.useState(!1),[h,p]=ne.useState({});ne.useEffect(()=>{e&&t&&(o({contract_number:t.contract_number||"",contract_officer_name:t.contract_officer_name||"",contract_officer_address:t.contract_officer_address||"",contract_officer_city:t.contract_officer_city||"",contract_officer_state:t.contract_officer_state||"",contract_officer_zip:t.contract_officer_zip||"",origin_country:t.origin_country||"USA",gsa_proposed_discount:t.gsa_proposed_discount||0,q_v_discount:t.q_v_discount||"",additional_concessions:t.additional_concessions||"",normal_delivery_time:t.normal_delivery_time||30,expedited_delivery_time:t.expedited_delivery_time||10,fob_term:t.fob_term||"Origin",energy_star_compliance:t.energy_star_compliance||"Yes"}),a(1),p({}))},[e,t]);const x=async v=>{var w,_,S;if(v.preventDefault(),s===1){const E=TD({...i,client_id:t.client_id});p(E.errors),E.isValid&&a(2);return}if(!(t!=null&&t.client_id)){p({submit:"Missing Client ID. Cannot update."});return}const y=kD({...i,client_id:t.client_id});if(!y.isValid){p(y.errors);return}f(!0),p({});try{const E={...i,contract_number:i.contract_number,origin_country:i.origin_country||"USA",gsa_proposed_discount:Number(i.gsa_proposed_discount)||0,normal_delivery_time:Number(i.normal_delivery_time)||0,expedited_delivery_time:Number(i.expedited_delivery_time)||0};await Yx.updateContract(t.client_id,E),n(),g()}catch(E){const T=(_=(w=E==null?void 0:E.response)==null?void 0:w.data)==null?void 0:_.detail;Array.isArray(T)?p({submit:((S=T[0])==null?void 0:S.msg)||"Validation error"}):p({submit:T||"An unexpected error occurred"}),console.error("Update Error:",E)}finally{f(!1)}},g=()=>{a(1),p({}),r()};return!e||!t?null:d.jsx("div",{className:"fixed inset-0 bg-slate-900/40 z-50 flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[d.jsx("div",{className:"bg-slate-50 py-4 px-8 shrink-0",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold  text-slate-700",children:"Edit Contract"}),d.jsxs("p",{className:"text-slate-500 text-sm",children:["Update contract details for ",t.client]})]}),d.jsx("button",{type:"button",onClick:g,className:"p-2 hover:bg-white/20 rounded-full transition-colors",disabled:c,children:d.jsx(Zn,{className:"w-6 h-6 text-slate-700"})})]})}),d.jsx("div",{className:"flex items-center justify-center gap-4 p-4 shrink-0",children:["Contract & Officer","Terms & Delivery"].map((v,y)=>{const w=y+1,_=s>=w,S=s>w;return d.jsxs(We.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold transition-colors ${_?"bg-[#38A1DB] text-white":"bg-slate-200 text-slate-400"}`,children:S?d.jsx(la,{className:"w-6 h-6"}):w}),d.jsx("span",{className:`font-semibold ${_?"text-[#38A1DB]":"text-slate-400"}`,children:v})]}),y===0&&d.jsx("div",{className:`w-16 h-1 rounded-full ${s>1?"bg-[#38A1DB]":"bg-slate-200"}`})]},w)})}),d.jsxs("form",{onSubmit:x,noValidate:!0,className:"flex-1 overflow-y-auto",children:[d.jsxs("div",{className:"py-6 px-8 space-y-6",children:[h.submit&&d.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-center gap-3 text-red-800",children:[d.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),d.jsx("p",{className:"text-sm font-semibold",children:h.submit})]}),s===1?d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsxs("label",{className:"text-sm font-bold text-slate-700",children:["Contract Number ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 transition-all outline-none border-slate-200 focus:border-[#38A1DB]",value:i.contract_number,onChange:v=>o({...i,contract_number:v.target.value})}),h.contract_number&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.contract_number})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Officer Name"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_name,onChange:v=>o({...i,contract_officer_name:v.target.value})}),h.contract_officer_name&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.contract_officer_name})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Officer Address"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_address,onChange:v=>o({...i,contract_officer_address:v.target.value})}),h.contract_officer_address&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.contract_officer_address})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"City"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_city,onChange:v=>o({...i,contract_officer_city:v.target.value})}),h.contract_officer_city&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.contract_officer_city})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"State"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_state,onChange:v=>o({...i,contract_officer_state:v.target.value})}),h.contract_officer_state&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.contract_officer_state})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"ZIP"}),d.jsx("input",{type:"text",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.contract_officer_zip,onChange:v=>o({...i,contract_officer_zip:v.target.value})}),h.contract_officer_zip&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.contract_officer_zip})]})]})]}):d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"FOB Term"}),d.jsxs("select",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none bg-white",value:i.fob_term,onChange:v=>o({...i,fob_term:v.target.value}),children:[d.jsx("option",{value:"Origin",children:"Origin"}),d.jsx("option",{value:"Destination",children:"Destination"})]}),h.fob_term&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.fob_term})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Energy Star"}),d.jsxs("select",{className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none bg-white",value:i.energy_star_compliance,onChange:v=>o({...i,energy_star_compliance:v.target.value}),children:[d.jsx("option",{value:"Yes",children:"Yes"}),d.jsx("option",{value:"No",children:"No"}),d.jsx("option",{value:"N/A",children:"N/A"})]}),h.energy_star_compliance&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.energy_star_compliance})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Normal Delivery (Days)"}),d.jsx("input",{type:"number",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.normal_delivery_time,onChange:v=>o({...i,normal_delivery_time:parseInt(v.target.value)||0})}),h.normal_delivery_time&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.normal_delivery_time})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Expedited Delivery (Days)"}),d.jsx("input",{type:"number",className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none",value:i.expedited_delivery_time,onChange:v=>o({...i,expedited_delivery_time:parseInt(v.target.value)||0})}),h.expedited_delivery_time&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.expedited_delivery_time})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Quantity Discounts"}),d.jsx("textarea",{rows:2,className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none resize-none",value:i.q_v_discount,onChange:v=>o({...i,q_v_discount:v.target.value})}),h.q_v_discount&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.q_v_discount})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-sm font-bold text-slate-700",children:"Additional Concessions"}),d.jsx("textarea",{rows:2,className:"w-full mt-2 px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-[#38A1DB] outline-none resize-none",value:i.additional_concessions,onChange:v=>o({...i,additional_concessions:v.target.value})}),h.additional_concessions&&d.jsx("p",{className:"mt-1 text-xs text-red-500 font-medium",children:h.additional_concessions})]})]})]}),d.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-6 flex justify-between border-t border-slate-100 shrink-0",children:[d.jsx("button",{type:"button",onClick:()=>s===1?g():a(1),className:"px-6 py-3 rounded-xl border-2 border-slate-300 font-bold text-slate-600 hover:bg-slate-100 transition-all disabled:opacity-50",disabled:c,children:s===1?"Cancel":"Back"}),d.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 rounded-xl bg-linear-to-br from-[#38A1DB] to-[#2D8BBF] text-white font-bold shadow-lg hover:shadow-xl transition-all active:scale-95",children:c?d.jsxs(d.Fragment,{children:[d.jsx(Ar,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):s===1?"Next":"Update Contract"})]})]})]})})}function dJ(){var te;const[e,t]=ne.useState(""),[r,n]=ne.useState(null),[s,a]=ne.useState([]),[i,o]=ne.useState(!0),[c,f]=ne.useState(null),[h,p]=ne.useState(!1),[x,g]=ne.useState(!1),[v,y]=ne.useState(null),[w,_]=ne.useState(!1),[S,E]=ne.useState(null),[T,k]=ne.useState(!1),[D,O]=ne.useState(1),z=8;ne.useEffect(()=>{j()},[]),ne.useEffect(()=>{O(1)},[e]);const j=async()=>{try{o(!0),f(null);const me=await Yx.getAllContracts();a(me)}catch(me){console.error("Error fetching contracts:",me)}finally{o(!1)}},J=ne.useMemo(()=>s.filter(me=>{var Ee;if(me.is_deleted)return!1;const ie=e.toLowerCase();return me.contract_number.toLowerCase().includes(ie)||((Ee=me.contract_officer_name)==null?void 0:Ee.toLowerCase().includes(ie))||me.client.toLowerCase().includes(ie)}),[s,e]),ae=J.length,F=(D-1)*z,X=J.slice(F,F+z),P=me=>{E(me),_(!0)},le=async()=>{if(S)try{k(!0),await Yx.deleteContract(S),a(me=>me.map(ie=>ie.client_id===S?{...ie,is_deleted:!0}:ie))}catch(me){f(me instanceof Error?me.message:"Failed to delete contract")}finally{k(!1),_(!1),E(null)}},ee=me=>{y(me),g(!0)};return d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-6 lg:p-10 space-y-10",children:[c&&d.jsxs("div",{className:"mx-auto mb-6 bg-red-50 border border-red-200 rounded-2xl p-4 flex items-start gap-3",children:[d.jsx(ud,{className:"w-5 h-5 text-red-500 shrink-0 mt-0.5"}),d.jsx("div",{className:"flex-1",children:d.jsx("p",{className:"text-sm font-semibold text-red-800",children:c})}),d.jsx("button",{onClick:()=>f(null),className:"text-red-400 hover:text-red-600",children:d.jsx(Zn,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-12 mx-auto ",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"Contracts"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Manage your GSA contract profiles and logistics information"})]}),d.jsxs("button",{onClick:()=>p(!0),className:"flex items-center justify-center gap-2 bg-[#38A1DB] hover:bg-[#2D8BBF] text-white px-7 py-3 rounded-xl shadow-lg shadow-blue-200 transition-all active:scale-95 font-bold",children:[d.jsx(fd,{className:"w-5 h-5 stroke-[3px]"}),"Add Contract"]})]}),d.jsx("div",{className:"mx-auto bg-white p-4 rounded-4xl shadow-sm border border-slate-100 mb-8 flex flex-col lg:flex-row gap-4 items-center",children:d.jsxs("div",{className:"relative flex-1 w-full",children:[d.jsx(Po,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),d.jsx("input",{type:"text",placeholder:"Search contracts by number, officer name, or client...",className:"w-full pl-14 pr-6 py-3.5 rounded-2xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20  bg-slate-50/50 text-slate-700 placeholder:text-slate-400 transition-all font-medium",value:e,onChange:me=>t(me.target.value)})]})}),d.jsx("div",{className:"mx-auto ",children:d.jsx(sJ,{contracts:X,loading:i,onView:n,onEdit:ee,onDelete:P,currentPage:D,totalContracts:ae,itemsPerPage:z,onPageChange:O})}),d.jsx(aJ,{contract:r,onClose:()=>n(null),onEdit:ee}),d.jsx(cJ,{isOpen:h,onClose:()=>p(!1),onSuccess:j}),d.jsx(fJ,{isOpen:x,contract:v,onClose:()=>{g(!1),y(null)},onSuccess:j}),d.jsx(If,{isOpen:w,onClose:()=>{_(!1),E(null)},onConfirm:le,title:"Delete Contract",message:d.jsxs(d.Fragment,{children:["Are you sure you want to delete contract"," ",d.jsx("span",{className:"font-bold text-slate-700",children:(te=s.find(me=>me.client_id===S))==null?void 0:te.contract_number}),"?"]}),variant:"rose",confirmText:"Delete",isSubmitting:T})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Jx={};Jx.version="0.18.5";var AD=1252,hJ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],tS={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},rS=function(e){hJ.indexOf(e)!=-1&&(AD=tS[0]=e)};function pJ(){rS(1252)}var ri=function(e){rS(e)};function nS(){ri(1200),pJ()}function R3(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function mJ(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function CD(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Rh=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?mJ(e.slice(2)):t==254&&r==255?CD(e.slice(2)):t==65279?e.slice(1):e},Um=function(t){return String.fromCharCode(t)},O3=function(t){return String.fromCharCode(t)},d0,kl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function h0(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),i=(r&3)<<4|n>>4,s=e.charCodeAt(f++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=kl.charAt(a)+kl.charAt(i)+kl.charAt(o)+kl.charAt(c);return t}function ca(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=kl.indexOf(e.charAt(f++)),i=kl.indexOf(e.charAt(f++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=kl.indexOf(e.charAt(f++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=kl.indexOf(e.charAt(f++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Ft=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Lo=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function zl(e){return Ft?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function j3(e){return Ft?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var na=function(t){return Ft?Lo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function N1(e){if(typeof ArrayBuffer>"u")return na(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Gl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function xJ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function sS(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return sS(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var jn=Ft?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Lo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function gJ(e){for(var t=[],r=0,n=e.length+250,s=zl(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=zl(65535),n=65530)}return t.push(s.slice(0,r)),jn(t)}var Es=/\u0000/g,Oh=/[\u0001-\u0006]/g;function xf(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ni(e,t){var r=""+e;return r.length>=t?r:Hr("0",t-r.length)+r}function aS(e,t){var r=""+e;return r.length>=t?r:Hr(" ",t-r.length)+r}function Zx(e,t){var r=""+e;return r.length>=t?r:r+Hr(" ",t-r.length)}function yJ(e,t){var r=""+Math.round(e);return r.length>=t?r:Hr("0",t-r.length)+r}function vJ(e,t){var r=""+e;return r.length>=t?r:Hr("0",t-r.length)+r}var D3=Math.pow(2,32);function ef(e,t){if(e>D3||e<-D3)return yJ(e,t);var r=Math.round(e);return vJ(r,t)}function Qx(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var I3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ab=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function bJ(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var yt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},M3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wJ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function eg(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,f=0,h=0,p=Math.floor(s);f<t&&(p=Math.floor(s),o=p*i+a,h=p*f+c,!(s-p<5e-8));)s=1/(s-p),a=i,i=o,c=f,f=h;if(h>t&&(f>t?(h=c,o=a):(h=f,o=i)),!r)return[0,n*o,h];var x=Math.floor(n*o/h);return[x,n*o-x*h,h]}function Tc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=kJ(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var RD=new Date(1899,11,31,0,0,0),_J=RD.getTime(),EJ=new Date(1900,2,1,0,0,0);function OD(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=EJ&&(r+=1440*60*1e3),(r-(_J+(e.getTimezoneOffset()-RD.getTimezoneOffset())*6e4))/(1440*60*1e3)}function iS(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SJ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NJ(e){var t=e<0?12:11,r=iS(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function TJ(e){var t=iS(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function p0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=NJ(e):t===10?r=e.toFixed(10).substr(0,12):r=TJ(e),iS(SJ(r.toUpperCase()))}function Yc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):p0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ha(14,OD(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function kJ(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function AJ(e,t,r,n){var s="",a=0,i=0,o=r.y,c,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,f=2;break;default:c=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,f=t.length;break;case 3:return Ab[r.m-1][1];case 5:return Ab[r.m-1][0];default:return Ab[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,f=t.length;break;case 3:return I3[r.q][0];default:return I3[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ni(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=ni(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:c=o,f=1;break}var h=f>0?ni(c,f):"";return h}function Al(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var jD=/%/g;function CJ(e,t,r){var n=t.replace(jD,""),s=t.length-n.length;return To(e,n,r*Math.pow(10,2*s))+Hr("%",s)}function RJ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return To(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function DD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+DD(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,h){return c+f+h.substr(0,(s+a)%s)+"."+h.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ID=/# (\?+)( ?)\/( ?)(\d+)/;function OJ(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Hr(" ",e[1].length+1+e[4].length):aS(i,e[1].length)+e[2]+"/"+e[3]+ni(o,e[4].length))}function jJ(e,t,r){return r+(t===0?"":""+t)+Hr(" ",e[1].length+2+e[4].length)}var MD=/^#*0*\.([0#]+)/,FD=/\).*[0#]/,PD=/\(###\) ###\\?-####/;function vs(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function F3(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function P3(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function DJ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function IJ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ka(e,t,r){if(e.charCodeAt(0)===40&&!t.match(FD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ka("n",n,r):"("+ka("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return RJ(e,t,r);if(t.indexOf("%")!==-1)return CJ(e,t,r);if(t.indexOf("E")!==-1)return DD(t,r);if(t.charCodeAt(0)===36)return"$"+ka(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ef(c,t.length);if(t.match(/^[#?]+$/))return s=ef(r,0),s==="0"&&(s=""),s.length>t.length?s:vs(t.substr(0,t.length-s.length))+s;if(a=t.match(ID))return OJ(a,c,f);if(t.match(/^#+0+$/))return f+ef(c,t.length-t.indexOf("0"));if(a=t.match(MD))return s=F3(r,a[1].length).replace(/^([^\.]+)$/,"$1."+vs(a[1])).replace(/\.$/,"."+vs(a[1])).replace(/\.(\d*)$/,function(v,y){return"."+y+Hr("0",vs(a[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+F3(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+Al(ef(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ka(e,t,-r):Al(""+(Math.floor(r)+DJ(r,a[1].length)))+"."+ni(P3(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ka(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=xf(ka(e,t.replace(/[\\-]/g,""),r)),i=0,xf(xf(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(PD))return s=ka(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=eg(c,Math.pow(10,i)-1,!1),s=""+f,h=To("n",a[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+a[2]+"/"+a[3],h=Zx(o[2],i),h.length<a[4].length&&(h=vs(a[4].substr(a[4].length-h.length))+h),s+=h,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=eg(c,Math.pow(10,i)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?aS(o[1],i)+a[2]+"/"+a[3]+Zx(o[2],i):Hr(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=ef(r,0),t.length<=s.length?s:vs(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,x=t.length-s.length-p;return vs(t.substr(0,p)+s+t.substr(t.length-x))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=P3(r,a[1].length),r<0?"-"+ka(e,t,-r):Al(IJ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ni(0,3-v.length):"")+v})+"."+ni(i,a[1].length);switch(t){case"###,##0.00":return ka(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Al(ef(c,0));return g!=="0"?f+g:"";case"###,###.00":return ka(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ka(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function MJ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return To(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function FJ(e,t,r){var n=t.replace(jD,""),s=t.length-n.length;return To(e,n,r*Math.pow(10,2*s))+Hr("%",s)}function LD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+LD(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,h){return c+f+h.substr(0,(s+a)%s)+"."+h.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ai(e,t,r){if(e.charCodeAt(0)===40&&!t.match(FD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ai("n",n,r):"("+Ai("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return MJ(e,t,r);if(t.indexOf("%")!==-1)return FJ(e,t,r);if(t.indexOf("E")!==-1)return LD(t,r);if(t.charCodeAt(0)===36)return"$"+Ai(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ni(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:vs(t.substr(0,t.length-s.length))+s;if(a=t.match(ID))return jJ(a,c,f);if(t.match(/^#+0+$/))return f+ni(c,t.length-t.indexOf("0"));if(a=t.match(MD))return s=(""+r).replace(/^([^\.]+)$/,"$1."+vs(a[1])).replace(/\.$/,"."+vs(a[1])),s=s.replace(/\.(\d*)$/,function(v,y){return"."+y+Hr("0",vs(a[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+Al(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ai(e,t,-r):Al(""+r)+"."+Hr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Ai(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=xf(Ai(e,t.replace(/[\\-]/g,""),r)),i=0,xf(xf(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(PD))return s=Ai(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=eg(c,Math.pow(10,i)-1,!1),s=""+f,h=To("n",a[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+a[2]+"/"+a[3],h=Zx(o[2],i),h.length<a[4].length&&(h=vs(a[4].substr(a[4].length-h.length))+h),s+=h,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=eg(c,Math.pow(10,i)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?aS(o[1],i)+a[2]+"/"+a[3]+Zx(o[2],i):Hr(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:vs(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,x=t.length-s.length-p;return vs(t.substr(0,p)+s+t.substr(t.length-x))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ai(e,t,-r):Al(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ni(0,3-v.length):"")+v})+"."+ni(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Al(""+c);return g!=="0"?f+g:"";default:if(t.match(/\.[0#?]*$/))return Ai(e,t.slice(0,t.lastIndexOf(".")),r)+vs(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function To(e,t,r){return(r|0)===r?Ai(e,t,r):ka(e,t,r)}function PJ(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var BD=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function pd(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Qx(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(BD))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function LJ(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",f,h,p,x="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Qx(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(p=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(p);s[s.length]={t:"t",v:a},++i;break;case"\\":var g=e.charAt(++i),v=g==="("||g===")"?g:"t";s[s.length]={t:v,v:g},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(f==null&&(f=Tc(t,r,e.charAt(i+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Tc(t,r),f==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=x),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var y={t:o,v:o};if(f==null&&(f=Tc(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",x="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",i+=5,x="h"):e.substr(i,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",i+=5,x="h"):(y.t="t",++i),f==null&&y.t==="T")return"";s[s.length]=y,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(BD)){if(f==null&&(f=Tc(t,r),f==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",pd(e)||(s[s.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,_=0,S;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=x,c="h",w<1&&(w=1);break;case"s":(S=s[i].v.match(/\.0+$/))&&(_=Math.max(_,S[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var E="",T;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=AJ(s[i].t.charCodeAt(0),s[i].v,f,_),s[i].t="t";break;case"n":case"?":for(T=i+1;s[T]!=null&&((o=s[T].t)==="?"||o==="D"||(o===" "||o==="t")&&s[T+1]!=null&&(s[T+1].t==="?"||s[T+1].t==="t"&&s[T+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[T].v==="/"||s[T].v===" "&&s[T+1]!=null&&s[T+1].t=="?"));)s[i].v+=s[T].v,s[T]={v:"",t:";"},++T;E+=s[i].v,i=T-1;break;case"G":s[i].t="t",s[i].v=Yc(t,r);break}var k="",D,O;if(E.length>0){E.charCodeAt(0)==40?(D=t<0&&E.charCodeAt(0)===45?-t:t,O=To("n",E,D)):(D=t<0&&n>1?-t:t,O=To("n",E,D),D<0&&s[0]&&s[0].t=="t"&&(O=O.substr(1),s[0].v="-"+s[0].v)),T=O.length-1;var z=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){z=i;break}var j=s.length;if(z===s.length&&O.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(T>=s[i].v.length-1?(T-=s[i].v.length,s[i].v=O.substr(T+1,s[i].v.length)):T<0?s[i].v="":(s[i].v=O.substr(0,T+1),T=-1),s[i].t="t",j=i);T>=0&&j<s.length&&(s[j].v=O.substr(0,T+1)+s[j].v)}else if(z!==s.length&&O.indexOf("E")===-1){for(T=O.indexOf(".")-1,i=z;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(h=s[i].v.indexOf(".")>-1&&i===z?s[i].v.indexOf(".")-1:s[i].v.length-1,k=s[i].v.substr(h+1);h>=0;--h)T>=0&&(s[i].v.charAt(h)==="0"||s[i].v.charAt(h)==="#")&&(k=O.charAt(T--)+k);s[i].v=k,s[i].t="t",j=i}for(T>=0&&j<s.length&&(s[j].v=O.substr(0,T+1)+s[j].v),T=O.indexOf(".")+1,i=z;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==z)){for(h=s[i].v.indexOf(".")>-1&&i===z?s[i].v.indexOf(".")+1:0,k=s[i].v.substr(0,h);h<s[i].v.length;++h)T<O.length&&(k+=O.charAt(T++));s[i].v=k,s[i].t="t",j=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(D=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=To(s[i].t,s[i].v,D),s[i].t="t");var J="";for(i=0;i!==s.length;++i)s[i]!=null&&(J+=s[i].v);return J}var L3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function B3(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function BJ(e,t){var r=PJ(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(L3),o=r[1].match(L3);return B3(t,i)?[n,r[0]]:B3(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Ha(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:yt)[e],n==null&&(n=r.table&&r.table[M3[e]]||yt[M3[e]]),n==null&&(n=wJ[e]||"General");break}if(Qx(n,0))return Yc(t,r);t instanceof Date&&(t=OD(t,r.date1904));var s=BJ(n,t);if(Qx(s[1]))return Yc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return LJ(s[1],t,r,s[0])}function ko(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(yt[r]==null){t<0&&(t=r);continue}if(yt[r]==e){t=r;break}}t<0&&(t=391)}return yt[t]=e,t}function T1(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ko(e[t],t)}function md(){yt=bJ()}var UJ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},UD=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function zJ(e){var t=typeof e=="number"?yt[e]:e;return t=t.replace(UD,"(\\d+)"),new RegExp("^"+t+"$")}function HJ(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(UD)||[]).forEach(function(p,x){var g=parseInt(r[x+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=g;break;case"d":a=g;break;case"h":i=g;break;case"s":c=g;break;case"m":i>=0?o=g:s=g;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?f:n==-1&&s==-1&&a==-1?h:f+"T"+h}var VJ=(function(){var e={};e.version="1.2.0";function t(){for(var O=0,z=new Array(256),j=0;j!=256;++j)O=j,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,z[j]=O;return typeof Int32Array<"u"?new Int32Array(z):z}var r=t();function n(O){var z=0,j=0,J=0,ae=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(J=0;J!=256;++J)ae[J]=O[J];for(J=0;J!=256;++J)for(j=O[J],z=256+J;z<4096;z+=256)j=ae[z]=j>>>8^O[j&255];var F=[];for(J=1;J!=16;++J)F[J-1]=typeof Int32Array<"u"?ae.subarray(J*256,J*256+256):ae.slice(J*256,J*256+256);return F}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],f=s[4],h=s[5],p=s[6],x=s[7],g=s[8],v=s[9],y=s[10],w=s[11],_=s[12],S=s[13],E=s[14];function T(O,z){for(var j=z^-1,J=0,ae=O.length;J<ae;)j=j>>>8^r[(j^O.charCodeAt(J++))&255];return~j}function k(O,z){for(var j=z^-1,J=O.length-15,ae=0;ae<J;)j=E[O[ae++]^j&255]^S[O[ae++]^j>>8&255]^_[O[ae++]^j>>16&255]^w[O[ae++]^j>>>24]^y[O[ae++]]^v[O[ae++]]^g[O[ae++]]^x[O[ae++]]^p[O[ae++]]^h[O[ae++]]^f[O[ae++]]^c[O[ae++]]^o[O[ae++]]^i[O[ae++]]^a[O[ae++]]^r[O[ae++]];for(J+=15;ae<J;)j=j>>>8^r[(j^O[ae++])&255];return~j}function D(O,z){for(var j=z^-1,J=0,ae=O.length,F=0,X=0;J<ae;)F=O.charCodeAt(J++),F<128?j=j>>>8^r[(j^F)&255]:F<2048?(j=j>>>8^r[(j^(192|F>>6&31))&255],j=j>>>8^r[(j^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,X=O.charCodeAt(J++)&1023,j=j>>>8^r[(j^(240|F>>8&7))&255],j=j>>>8^r[(j^(128|F>>2&63))&255],j=j>>>8^r[(j^(128|X>>6&15|(F&3)<<4))&255],j=j>>>8^r[(j^(128|X&63))&255]):(j=j>>>8^r[(j^(224|F>>12&15))&255],j=j>>>8^r[(j^(128|F>>6&63))&255],j=j>>>8^r[(j^(128|F&63))&255]);return~j}return e.table=r,e.bstr=T,e.buf=k,e.str=D,e})(),mt=(function(){var t={};t.version="1.2.1";function r(oe,xe){for(var fe=oe.split("/"),de=xe.split("/"),pe=0,ge=0,Ae=Math.min(fe.length,de.length);pe<Ae;++pe){if(ge=fe[pe].length-de[pe].length)return ge;if(fe[pe]!=de[pe])return fe[pe]<de[pe]?-1:1}return fe.length-de.length}function n(oe){if(oe.charAt(oe.length-1)=="/")return oe.slice(0,-1).indexOf("/")===-1?oe:n(oe.slice(0,-1));var xe=oe.lastIndexOf("/");return xe===-1?oe:oe.slice(0,xe+1)}function s(oe){if(oe.charAt(oe.length-1)=="/")return s(oe.slice(0,-1));var xe=oe.lastIndexOf("/");return xe===-1?oe:oe.slice(xe+1)}function a(oe,xe){typeof xe=="string"&&(xe=new Date(xe));var fe=xe.getHours();fe=fe<<6|xe.getMinutes(),fe=fe<<5|xe.getSeconds()>>>1,oe.write_shift(2,fe);var de=xe.getFullYear()-1980;de=de<<4|xe.getMonth()+1,de=de<<5|xe.getDate(),oe.write_shift(2,de)}function i(oe){var xe=oe.read_shift(2)&65535,fe=oe.read_shift(2)&65535,de=new Date,pe=fe&31;fe>>>=5;var ge=fe&15;fe>>>=4,de.setMilliseconds(0),de.setFullYear(fe+1980),de.setMonth(ge-1),de.setDate(pe);var Ae=xe&31;xe>>>=5;var ze=xe&63;return xe>>>=6,de.setHours(xe),de.setMinutes(ze),de.setSeconds(Ae<<1),de}function o(oe){qn(oe,0);for(var xe={},fe=0;oe.l<=oe.length-4;){var de=oe.read_shift(2),pe=oe.read_shift(2),ge=oe.l+pe,Ae={};switch(de){case 21589:fe=oe.read_shift(1),fe&1&&(Ae.mtime=oe.read_shift(4)),pe>5&&(fe&2&&(Ae.atime=oe.read_shift(4)),fe&4&&(Ae.ctime=oe.read_shift(4))),Ae.mtime&&(Ae.mt=new Date(Ae.mtime*1e3));break}oe.l=ge,xe[de]=Ae}return xe}var c;function f(){return c||(c={})}function h(oe,xe){if(oe[0]==80&&oe[1]==75)return Ga(oe,xe);if((oe[0]|32)==109&&(oe[1]|32)==105)return br(oe,xe);if(oe.length<512)throw new Error("CFB file size "+oe.length+" < 512");var fe=3,de=512,pe=0,ge=0,Ae=0,ze=0,Ce=0,Re=[],je=oe.slice(0,512);qn(je,0);var Xe=p(je);switch(fe=Xe[0],fe){case 3:de=512;break;case 4:de=4096;break;case 0:if(Xe[1]==0)return Ga(oe,xe);default:throw new Error("Major Version: Expected 3 or 4 saw "+fe)}de!==512&&(je=oe.slice(0,de),qn(je,28));var Ze=oe.slice(0,de);x(je,fe);var st=je.read_shift(4,"i");if(fe===3&&st!==0)throw new Error("# Directory Sectors: Expected 0 saw "+st);je.l+=4,Ae=je.read_shift(4,"i"),je.l+=4,je.chk("00100000","Mini Stream Cutoff Size: "),ze=je.read_shift(4,"i"),pe=je.read_shift(4,"i"),Ce=je.read_shift(4,"i"),ge=je.read_shift(4,"i");for(var Ye=-1,tt=0;tt<109&&(Ye=je.read_shift(4,"i"),!(Ye<0));++tt)Re[tt]=Ye;var ct=g(oe,de);w(Ce,ge,ct,de,Re);var gr=S(ct,Ae,Re,de);gr[Ae].name="!Directory",pe>0&&ze!==X&&(gr[ze].name="!MiniFAT"),gr[Re[0]].name="!FAT",gr.fat_addrs=Re,gr.ssz=de;var yr={},Cr=[],ha=[],tc=[];E(Ae,gr,ct,Cr,pe,yr,ha,ze),v(ha,tc,Cr),Cr.shift();var Wo={FileIndex:ha,FullPaths:tc};return xe&&xe.raw&&(Wo.raw={header:Ze,sectors:ct}),Wo}function p(oe){if(oe[oe.l]==80&&oe[oe.l+1]==75)return[0,0];oe.chk(P,"Header Signature: "),oe.l+=16;var xe=oe.read_shift(2,"u");return[oe.read_shift(2,"u"),xe]}function x(oe,xe){var fe=9;switch(oe.l+=2,fe=oe.read_shift(2)){case 9:if(xe!=3)throw new Error("Sector Shift: Expected 9 saw "+fe);break;case 12:if(xe!=4)throw new Error("Sector Shift: Expected 12 saw "+fe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+fe)}oe.chk("0600","Mini Sector Shift: "),oe.chk("000000000000","Reserved: ")}function g(oe,xe){for(var fe=Math.ceil(oe.length/xe)-1,de=[],pe=1;pe<fe;++pe)de[pe-1]=oe.slice(pe*xe,(pe+1)*xe);return de[fe-1]=oe.slice(fe*xe),de}function v(oe,xe,fe){for(var de=0,pe=0,ge=0,Ae=0,ze=0,Ce=fe.length,Re=[],je=[];de<Ce;++de)Re[de]=je[de]=de,xe[de]=fe[de];for(;ze<je.length;++ze)de=je[ze],pe=oe[de].L,ge=oe[de].R,Ae=oe[de].C,Re[de]===de&&(pe!==-1&&Re[pe]!==pe&&(Re[de]=Re[pe]),ge!==-1&&Re[ge]!==ge&&(Re[de]=Re[ge])),Ae!==-1&&(Re[Ae]=de),pe!==-1&&de!=Re[de]&&(Re[pe]=Re[de],je.lastIndexOf(pe)<ze&&je.push(pe)),ge!==-1&&de!=Re[de]&&(Re[ge]=Re[de],je.lastIndexOf(ge)<ze&&je.push(ge));for(de=1;de<Ce;++de)Re[de]===de&&(ge!==-1&&Re[ge]!==ge?Re[de]=Re[ge]:pe!==-1&&Re[pe]!==pe&&(Re[de]=Re[pe]));for(de=1;de<Ce;++de)if(oe[de].type!==0){if(ze=de,ze!=Re[ze])do ze=Re[ze],xe[de]=xe[ze]+"/"+xe[de];while(ze!==0&&Re[ze]!==-1&&ze!=Re[ze]);Re[de]=-1}for(xe[0]+="/",de=1;de<Ce;++de)oe[de].type!==2&&(xe[de]+="/")}function y(oe,xe,fe){for(var de=oe.start,pe=oe.size,ge=[],Ae=de;fe&&pe>0&&Ae>=0;)ge.push(xe.slice(Ae*F,Ae*F+F)),pe-=F,Ae=_c(fe,Ae*4);return ge.length===0?Le(0):jn(ge).slice(0,oe.size)}function w(oe,xe,fe,de,pe){var ge=X;if(oe===X){if(xe!==0)throw new Error("DIFAT chain shorter than expected")}else if(oe!==-1){var Ae=fe[oe],ze=(de>>>2)-1;if(!Ae)return;for(var Ce=0;Ce<ze&&(ge=_c(Ae,Ce*4))!==X;++Ce)pe.push(ge);w(_c(Ae,de-4),xe-1,fe,de,pe)}}function _(oe,xe,fe,de,pe){var ge=[],Ae=[];pe||(pe=[]);var ze=de-1,Ce=0,Re=0;for(Ce=xe;Ce>=0;){pe[Ce]=!0,ge[ge.length]=Ce,Ae.push(oe[Ce]);var je=fe[Math.floor(Ce*4/de)];if(Re=Ce*4&ze,de<4+Re)throw new Error("FAT boundary crossed: "+Ce+" 4 "+de);if(!oe[je])break;Ce=_c(oe[je],Re)}return{nodes:ge,data:J3([Ae])}}function S(oe,xe,fe,de){var pe=oe.length,ge=[],Ae=[],ze=[],Ce=[],Re=de-1,je=0,Xe=0,Ze=0,st=0;for(je=0;je<pe;++je)if(ze=[],Ze=je+xe,Ze>=pe&&(Ze-=pe),!Ae[Ze]){Ce=[];var Ye=[];for(Xe=Ze;Xe>=0;){Ye[Xe]=!0,Ae[Xe]=!0,ze[ze.length]=Xe,Ce.push(oe[Xe]);var tt=fe[Math.floor(Xe*4/de)];if(st=Xe*4&Re,de<4+st)throw new Error("FAT boundary crossed: "+Xe+" 4 "+de);if(!oe[tt]||(Xe=_c(oe[tt],st),Ye[Xe]))break}ge[Ze]={nodes:ze,data:J3([Ce])}}return ge}function E(oe,xe,fe,de,pe,ge,Ae,ze){for(var Ce=0,Re=de.length?2:0,je=xe[oe].data,Xe=0,Ze=0,st;Xe<je.length;Xe+=128){var Ye=je.slice(Xe,Xe+128);qn(Ye,64),Ze=Ye.read_shift(2),st=hS(Ye,0,Ze-Re),de.push(st);var tt={name:st,type:Ye.read_shift(1),color:Ye.read_shift(1),L:Ye.read_shift(4,"i"),R:Ye.read_shift(4,"i"),C:Ye.read_shift(4,"i"),clsid:Ye.read_shift(16),state:Ye.read_shift(4,"i"),start:0,size:0},ct=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);ct!==0&&(tt.ct=T(Ye,Ye.l-8));var gr=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);gr!==0&&(tt.mt=T(Ye,Ye.l-8)),tt.start=Ye.read_shift(4,"i"),tt.size=Ye.read_shift(4,"i"),tt.size<0&&tt.start<0&&(tt.size=tt.type=0,tt.start=X,tt.name=""),tt.type===5?(Ce=tt.start,pe>0&&Ce!==X&&(xe[Ce].name="!StreamData")):tt.size>=4096?(tt.storage="fat",xe[tt.start]===void 0&&(xe[tt.start]=_(fe,tt.start,xe.fat_addrs,xe.ssz)),xe[tt.start].name=tt.name,tt.content=xe[tt.start].data.slice(0,tt.size)):(tt.storage="minifat",tt.size<0?tt.size=0:Ce!==X&&tt.start!==X&&xe[Ce]&&(tt.content=y(tt,xe[Ce].data,(xe[ze]||{}).data))),tt.content&&qn(tt.content,0),ge[st]=tt,Ae.push(tt)}}function T(oe,xe){return new Date((ra(oe,xe+4)/1e7*Math.pow(2,32)+ra(oe,xe)/1e7-11644473600)*1e3)}function k(oe,xe){return f(),h(c.readFileSync(oe),xe)}function D(oe,xe){var fe=xe&&xe.type;switch(fe||Ft&&Buffer.isBuffer(oe)&&(fe="buffer"),fe||"base64"){case"file":return k(oe,xe);case"base64":return h(na(ca(oe)),xe);case"binary":return h(na(oe),xe)}return h(oe,xe)}function O(oe,xe){var fe=xe||{},de=fe.root||"Root Entry";if(oe.FullPaths||(oe.FullPaths=[]),oe.FileIndex||(oe.FileIndex=[]),oe.FullPaths.length!==oe.FileIndex.length)throw new Error("inconsistent CFB structure");oe.FullPaths.length===0&&(oe.FullPaths[0]=de+"/",oe.FileIndex[0]={name:de,type:5}),fe.CLSID&&(oe.FileIndex[0].clsid=fe.CLSID),z(oe)}function z(oe){var xe="Sh33tJ5";if(!mt.find(oe,"/"+xe)){var fe=Le(4);fe[0]=55,fe[1]=fe[3]=50,fe[2]=54,oe.FileIndex.push({name:xe,type:2,content:fe,size:4,L:69,R:69,C:69}),oe.FullPaths.push(oe.FullPaths[0]+xe),j(oe)}}function j(oe,xe){O(oe);for(var fe=!1,de=!1,pe=oe.FullPaths.length-1;pe>=0;--pe){var ge=oe.FileIndex[pe];switch(ge.type){case 0:de?fe=!0:(oe.FileIndex.pop(),oe.FullPaths.pop());break;case 1:case 2:case 5:de=!0,isNaN(ge.R*ge.L*ge.C)&&(fe=!0),ge.R>-1&&ge.L>-1&&ge.R==ge.L&&(fe=!0);break;default:fe=!0;break}}if(!(!fe&&!xe)){var Ae=new Date(1987,1,19),ze=0,Ce=Object.create?Object.create(null):{},Re=[];for(pe=0;pe<oe.FullPaths.length;++pe)Ce[oe.FullPaths[pe]]=!0,oe.FileIndex[pe].type!==0&&Re.push([oe.FullPaths[pe],oe.FileIndex[pe]]);for(pe=0;pe<Re.length;++pe){var je=n(Re[pe][0]);de=Ce[je],de||(Re.push([je,{name:s(je).replace("/",""),type:1,clsid:ee,ct:Ae,mt:Ae,content:null}]),Ce[je]=!0)}for(Re.sort(function(st,Ye){return r(st[0],Ye[0])}),oe.FullPaths=[],oe.FileIndex=[],pe=0;pe<Re.length;++pe)oe.FullPaths[pe]=Re[pe][0],oe.FileIndex[pe]=Re[pe][1];for(pe=0;pe<Re.length;++pe){var Xe=oe.FileIndex[pe],Ze=oe.FullPaths[pe];if(Xe.name=s(Ze).replace("/",""),Xe.L=Xe.R=Xe.C=-(Xe.color=1),Xe.size=Xe.content?Xe.content.length:0,Xe.start=0,Xe.clsid=Xe.clsid||ee,pe===0)Xe.C=Re.length>1?1:-1,Xe.size=0,Xe.type=5;else if(Ze.slice(-1)=="/"){for(ze=pe+1;ze<Re.length&&n(oe.FullPaths[ze])!=Ze;++ze);for(Xe.C=ze>=Re.length?-1:ze,ze=pe+1;ze<Re.length&&n(oe.FullPaths[ze])!=n(Ze);++ze);Xe.R=ze>=Re.length?-1:ze,Xe.type=1}else n(oe.FullPaths[pe+1]||"")==n(Ze)&&(Xe.R=pe+1),Xe.type=2}}}function J(oe,xe){var fe=xe||{};if(fe.fileType=="mad")return es(oe,fe);switch(j(oe),fe.fileType){case"zip":return gs(oe,fe)}var de=(function(st){for(var Ye=0,tt=0,ct=0;ct<st.FileIndex.length;++ct){var gr=st.FileIndex[ct];if(gr.content){var yr=gr.content.length;yr>0&&(yr<4096?Ye+=yr+63>>6:tt+=yr+511>>9)}}for(var Cr=st.FullPaths.length+3>>2,ha=Ye+7>>3,tc=Ye+127>>7,Wo=ha+tt+Cr+tc,xi=Wo+127>>7,bd=xi<=109?0:Math.ceil((xi-109)/127);Wo+xi+bd+127>>7>xi;)bd=++xi<=109?0:Math.ceil((xi-109)/127);var ks=[1,bd,xi,tc,Cr,tt,Ye,0];return st.FileIndex[0].size=Ye<<6,ks[7]=(st.FileIndex[0].start=ks[0]+ks[1]+ks[2]+ks[3]+ks[4]+ks[5])+(ks[6]+7>>3),ks})(oe),pe=Le(de[7]<<9),ge=0,Ae=0;{for(ge=0;ge<8;++ge)pe.write_shift(1,le[ge]);for(ge=0;ge<8;++ge)pe.write_shift(2,0);for(pe.write_shift(2,62),pe.write_shift(2,3),pe.write_shift(2,65534),pe.write_shift(2,9),pe.write_shift(2,6),ge=0;ge<3;++ge)pe.write_shift(2,0);for(pe.write_shift(4,0),pe.write_shift(4,de[2]),pe.write_shift(4,de[0]+de[1]+de[2]+de[3]-1),pe.write_shift(4,0),pe.write_shift(4,4096),pe.write_shift(4,de[3]?de[0]+de[1]+de[2]-1:X),pe.write_shift(4,de[3]),pe.write_shift(-4,de[1]?de[0]-1:X),pe.write_shift(4,de[1]),ge=0;ge<109;++ge)pe.write_shift(-4,ge<de[2]?de[1]+ge:-1)}if(de[1])for(Ae=0;Ae<de[1];++Ae){for(;ge<236+Ae*127;++ge)pe.write_shift(-4,ge<de[2]?de[1]+ge:-1);pe.write_shift(-4,Ae===de[1]-1?X:Ae+1)}var ze=function(st){for(Ae+=st;ge<Ae-1;++ge)pe.write_shift(-4,ge+1);st&&(++ge,pe.write_shift(-4,X))};for(Ae=ge=0,Ae+=de[1];ge<Ae;++ge)pe.write_shift(-4,te.DIFSECT);for(Ae+=de[2];ge<Ae;++ge)pe.write_shift(-4,te.FATSECT);ze(de[3]),ze(de[4]);for(var Ce=0,Re=0,je=oe.FileIndex[0];Ce<oe.FileIndex.length;++Ce)je=oe.FileIndex[Ce],je.content&&(Re=je.content.length,!(Re<4096)&&(je.start=Ae,ze(Re+511>>9)));for(ze(de[6]+7>>3);pe.l&511;)pe.write_shift(-4,te.ENDOFCHAIN);for(Ae=ge=0,Ce=0;Ce<oe.FileIndex.length;++Ce)je=oe.FileIndex[Ce],je.content&&(Re=je.content.length,!(!Re||Re>=4096)&&(je.start=Ae,ze(Re+63>>6)));for(;pe.l&511;)pe.write_shift(-4,te.ENDOFCHAIN);for(ge=0;ge<de[4]<<2;++ge){var Xe=oe.FullPaths[ge];if(!Xe||Xe.length===0){for(Ce=0;Ce<17;++Ce)pe.write_shift(4,0);for(Ce=0;Ce<3;++Ce)pe.write_shift(4,-1);for(Ce=0;Ce<12;++Ce)pe.write_shift(4,0);continue}je=oe.FileIndex[ge],ge===0&&(je.start=je.size?je.start-1:X);var Ze=ge===0&&fe.root||je.name;if(Re=2*(Ze.length+1),pe.write_shift(64,Ze,"utf16le"),pe.write_shift(2,Re),pe.write_shift(1,je.type),pe.write_shift(1,je.color),pe.write_shift(-4,je.L),pe.write_shift(-4,je.R),pe.write_shift(-4,je.C),je.clsid)pe.write_shift(16,je.clsid,"hex");else for(Ce=0;Ce<4;++Ce)pe.write_shift(4,0);pe.write_shift(4,je.state||0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,je.start),pe.write_shift(4,je.size),pe.write_shift(4,0)}for(ge=1;ge<oe.FileIndex.length;++ge)if(je=oe.FileIndex[ge],je.size>=4096)if(pe.l=je.start+1<<9,Ft&&Buffer.isBuffer(je.content))je.content.copy(pe,pe.l,0,je.size),pe.l+=je.size+511&-512;else{for(Ce=0;Ce<je.size;++Ce)pe.write_shift(1,je.content[Ce]);for(;Ce&511;++Ce)pe.write_shift(1,0)}for(ge=1;ge<oe.FileIndex.length;++ge)if(je=oe.FileIndex[ge],je.size>0&&je.size<4096)if(Ft&&Buffer.isBuffer(je.content))je.content.copy(pe,pe.l,0,je.size),pe.l+=je.size+63&-64;else{for(Ce=0;Ce<je.size;++Ce)pe.write_shift(1,je.content[Ce]);for(;Ce&63;++Ce)pe.write_shift(1,0)}if(Ft)pe.l=pe.length;else for(;pe.l<pe.length;)pe.write_shift(1,0);return pe}function ae(oe,xe){var fe=oe.FullPaths.map(function(Ce){return Ce.toUpperCase()}),de=fe.map(function(Ce){var Re=Ce.split("/");return Re[Re.length-(Ce.slice(-1)=="/"?2:1)]}),pe=!1;xe.charCodeAt(0)===47?(pe=!0,xe=fe[0].slice(0,-1)+xe):pe=xe.indexOf("/")!==-1;var ge=xe.toUpperCase(),Ae=pe===!0?fe.indexOf(ge):de.indexOf(ge);if(Ae!==-1)return oe.FileIndex[Ae];var ze=!ge.match(Oh);for(ge=ge.replace(Es,""),ze&&(ge=ge.replace(Oh,"!")),Ae=0;Ae<fe.length;++Ae)if((ze?fe[Ae].replace(Oh,"!"):fe[Ae]).replace(Es,"")==ge||(ze?de[Ae].replace(Oh,"!"):de[Ae]).replace(Es,"")==ge)return oe.FileIndex[Ae];return null}var F=64,X=-2,P="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:P,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(oe,xe,fe){f();var de=J(oe,fe);c.writeFileSync(xe,de)}function ie(oe){for(var xe=new Array(oe.length),fe=0;fe<oe.length;++fe)xe[fe]=String.fromCharCode(oe[fe]);return xe.join("")}function Ee(oe,xe){var fe=J(oe,xe);switch(xe&&xe.type||"buffer"){case"file":return f(),c.writeFileSync(xe.filename,fe),fe;case"binary":return typeof fe=="string"?fe:ie(fe);case"base64":return h0(typeof fe=="string"?fe:ie(fe));case"buffer":if(Ft)return Buffer.isBuffer(fe)?fe:Lo(fe);case"array":return typeof fe=="string"?na(fe):fe}return fe}var K;function M(oe){try{var xe=oe.InflateRaw,fe=new xe;if(fe._processChunk(new Uint8Array([3,0]),fe._finishFlushFlag),fe.bytesRead)K=oe;else throw new Error("zlib does not expose bytesRead")}catch(de){console.error("cannot use native zlib: "+(de.message||de))}}function q(oe,xe){if(!K)return pi(oe,xe);var fe=K.InflateRaw,de=new fe,pe=de._processChunk(oe.slice(oe.l),de._finishFlushFlag);return oe.l+=de.bytesRead,pe}function G(oe){return K?K.deflateRawSync(oe):dt(oe)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function I(oe){var xe=(oe<<1|oe<<11)&139536|(oe<<5|oe<<15)&558144;return(xe>>16|xe>>8|xe)&255}for(var se=typeof Uint8Array<"u",Q=se?new Uint8Array(256):[],Y=0;Y<256;++Y)Q[Y]=I(Y);function U(oe,xe){var fe=Q[oe&255];return xe<=8?fe>>>8-xe:(fe=fe<<8|Q[oe>>8&255],xe<=16?fe>>>16-xe:(fe=fe<<8|Q[oe>>16&255],fe>>>24-xe))}function we(oe,xe){var fe=xe&7,de=xe>>>3;return(oe[de]|(fe<=6?0:oe[de+1]<<8))>>>fe&3}function B(oe,xe){var fe=xe&7,de=xe>>>3;return(oe[de]|(fe<=5?0:oe[de+1]<<8))>>>fe&7}function be(oe,xe){var fe=xe&7,de=xe>>>3;return(oe[de]|(fe<=4?0:oe[de+1]<<8))>>>fe&15}function V(oe,xe){var fe=xe&7,de=xe>>>3;return(oe[de]|(fe<=3?0:oe[de+1]<<8))>>>fe&31}function C(oe,xe){var fe=xe&7,de=xe>>>3;return(oe[de]|(fe<=1?0:oe[de+1]<<8))>>>fe&127}function A(oe,xe,fe){var de=xe&7,pe=xe>>>3,ge=(1<<fe)-1,Ae=oe[pe]>>>de;return fe<8-de||(Ae|=oe[pe+1]<<8-de,fe<16-de)||(Ae|=oe[pe+2]<<16-de,fe<24-de)||(Ae|=oe[pe+3]<<24-de),Ae&ge}function H(oe,xe,fe){var de=xe&7,pe=xe>>>3;return de<=5?oe[pe]|=(fe&7)<<de:(oe[pe]|=fe<<de&255,oe[pe+1]=(fe&7)>>8-de),xe+3}function ue(oe,xe,fe){var de=xe&7,pe=xe>>>3;return fe=(fe&1)<<de,oe[pe]|=fe,xe+1}function ye(oe,xe,fe){var de=xe&7,pe=xe>>>3;return fe<<=de,oe[pe]|=fe&255,fe>>>=8,oe[pe+1]=fe,xe+8}function he(oe,xe,fe){var de=xe&7,pe=xe>>>3;return fe<<=de,oe[pe]|=fe&255,fe>>>=8,oe[pe+1]=fe&255,oe[pe+2]=fe>>>8,xe+16}function ke(oe,xe){var fe=oe.length,de=2*fe>xe?2*fe:xe+5,pe=0;if(fe>=xe)return oe;if(Ft){var ge=j3(de);if(oe.copy)oe.copy(ge);else for(;pe<oe.length;++pe)ge[pe]=oe[pe];return ge}else if(se){var Ae=new Uint8Array(de);if(Ae.set)Ae.set(oe);else for(;pe<fe;++pe)Ae[pe]=oe[pe];return Ae}return oe.length=de,oe}function De(oe){for(var xe=new Array(oe),fe=0;fe<oe;++fe)xe[fe]=0;return xe}function Fe(oe,xe,fe){var de=1,pe=0,ge=0,Ae=0,ze=0,Ce=oe.length,Re=se?new Uint16Array(32):De(32);for(ge=0;ge<32;++ge)Re[ge]=0;for(ge=Ce;ge<fe;++ge)oe[ge]=0;Ce=oe.length;var je=se?new Uint16Array(Ce):De(Ce);for(ge=0;ge<Ce;++ge)Re[pe=oe[ge]]++,de<pe&&(de=pe),je[ge]=0;for(Re[0]=0,ge=1;ge<=de;++ge)Re[ge+16]=ze=ze+Re[ge-1]<<1;for(ge=0;ge<Ce;++ge)ze=oe[ge],ze!=0&&(je[ge]=Re[ze+16]++);var Xe=0;for(ge=0;ge<Ce;++ge)if(Xe=oe[ge],Xe!=0)for(ze=U(je[ge],de)>>de-Xe,Ae=(1<<de+4-Xe)-1;Ae>=0;--Ae)xe[ze|Ae<<Xe]=Xe&15|ge<<4;return de}var $e=se?new Uint16Array(512):De(512),rt=se?new Uint16Array(32):De(32);if(!se){for(var at=0;at<512;++at)$e[at]=0;for(at=0;at<32;++at)rt[at]=0}(function(){for(var oe=[],xe=0;xe<32;xe++)oe.push(5);Fe(oe,rt,32);var fe=[];for(xe=0;xe<=143;xe++)fe.push(8);for(;xe<=255;xe++)fe.push(9);for(;xe<=279;xe++)fe.push(7);for(;xe<=287;xe++)fe.push(8);Fe(fe,$e,288)})();var qt=(function(){for(var xe=se?new Uint8Array(32768):[],fe=0,de=0;fe<L.length-1;++fe)for(;de<L[fe+1];++de)xe[de]=fe;for(;de<32768;++de)xe[de]=29;var pe=se?new Uint8Array(259):[];for(fe=0,de=0;fe<re.length-1;++fe)for(;de<re[fe+1];++de)pe[de]=fe;function ge(ze,Ce){for(var Re=0;Re<ze.length;){var je=Math.min(65535,ze.length-Re),Xe=Re+je==ze.length;for(Ce.write_shift(1,+Xe),Ce.write_shift(2,je),Ce.write_shift(2,~je&65535);je-- >0;)Ce[Ce.l++]=ze[Re++]}return Ce.l}function Ae(ze,Ce){for(var Re=0,je=0,Xe=se?new Uint16Array(32768):[];je<ze.length;){var Ze=Math.min(65535,ze.length-je);if(Ze<10){for(Re=H(Ce,Re,+(je+Ze==ze.length)),Re&7&&(Re+=8-(Re&7)),Ce.l=Re/8|0,Ce.write_shift(2,Ze),Ce.write_shift(2,~Ze&65535);Ze-- >0;)Ce[Ce.l++]=ze[je++];Re=Ce.l*8;continue}Re=H(Ce,Re,+(je+Ze==ze.length)+2);for(var st=0;Ze-- >0;){var Ye=ze[je];st=(st<<5^Ye)&32767;var tt=-1,ct=0;if((tt=Xe[st])&&(tt|=je&-32768,tt>je&&(tt-=32768),tt<je))for(;ze[tt+ct]==ze[je+ct]&&ct<250;)++ct;if(ct>2){Ye=pe[ct],Ye<=22?Re=ye(Ce,Re,Q[Ye+1]>>1)-1:(ye(Ce,Re,3),Re+=5,ye(Ce,Re,Q[Ye-23]>>5),Re+=3);var gr=Ye<8?0:Ye-4>>2;gr>0&&(he(Ce,Re,ct-re[Ye]),Re+=gr),Ye=xe[je-tt],Re=ye(Ce,Re,Q[Ye]>>3),Re-=3;var yr=Ye<4?0:Ye-2>>1;yr>0&&(he(Ce,Re,je-tt-L[Ye]),Re+=yr);for(var Cr=0;Cr<ct;++Cr)Xe[st]=je&32767,st=(st<<5^ze[je])&32767,++je;Ze-=ct-1}else Ye<=143?Ye=Ye+48:Re=ue(Ce,Re,1),Re=ye(Ce,Re,Q[Ye]),Xe[st]=je&32767,++je}Re=ye(Ce,Re,0)-1}return Ce.l=(Re+7)/8|0,Ce.l}return function(Ce,Re){return Ce.length<8?ge(Ce,Re):Ae(Ce,Re)}})();function dt(oe){var xe=Le(50+Math.floor(oe.length*1.1)),fe=qt(oe,xe);return xe.slice(0,fe)}var Bt=se?new Uint16Array(32768):De(32768),hr=se?new Uint16Array(32768):De(32768),vt=se?new Uint16Array(128):De(128),ir=1,Nn=1;function or(oe,xe){var fe=V(oe,xe)+257;xe+=5;var de=V(oe,xe)+1;xe+=5;var pe=be(oe,xe)+4;xe+=4;for(var ge=0,Ae=se?new Uint8Array(19):De(19),ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ce=1,Re=se?new Uint8Array(8):De(8),je=se?new Uint8Array(8):De(8),Xe=Ae.length,Ze=0;Ze<pe;++Ze)Ae[Z[Ze]]=ge=B(oe,xe),Ce<ge&&(Ce=ge),Re[ge]++,xe+=3;var st=0;for(Re[0]=0,Ze=1;Ze<=Ce;++Ze)je[Ze]=st=st+Re[Ze-1]<<1;for(Ze=0;Ze<Xe;++Ze)(st=Ae[Ze])!=0&&(ze[Ze]=je[st]++);var Ye=0;for(Ze=0;Ze<Xe;++Ze)if(Ye=Ae[Ze],Ye!=0){st=Q[ze[Ze]]>>8-Ye;for(var tt=(1<<7-Ye)-1;tt>=0;--tt)vt[st|tt<<Ye]=Ye&7|Ze<<3}var ct=[];for(Ce=1;ct.length<fe+de;)switch(st=vt[C(oe,xe)],xe+=st&7,st>>>=3){case 16:for(ge=3+we(oe,xe),xe+=2,st=ct[ct.length-1];ge-- >0;)ct.push(st);break;case 17:for(ge=3+B(oe,xe),xe+=3;ge-- >0;)ct.push(0);break;case 18:for(ge=11+C(oe,xe),xe+=7;ge-- >0;)ct.push(0);break;default:ct.push(st),Ce<st&&(Ce=st);break}var gr=ct.slice(0,fe),yr=ct.slice(fe);for(Ze=fe;Ze<286;++Ze)gr[Ze]=0;for(Ze=de;Ze<30;++Ze)yr[Ze]=0;return ir=Fe(gr,Bt,286),Nn=Fe(yr,hr,30),xe}function Vo(oe,xe){if(oe[0]==3&&!(oe[1]&3))return[zl(xe),2];for(var fe=0,de=0,pe=j3(xe||1<<18),ge=0,Ae=pe.length>>>0,ze=0,Ce=0;(de&1)==0;){if(de=B(oe,fe),fe+=3,de>>>1)de>>1==1?(ze=9,Ce=5):(fe=or(oe,fe),ze=ir,Ce=Nn);else{fe&7&&(fe+=8-(fe&7));var Re=oe[fe>>>3]|oe[(fe>>>3)+1]<<8;if(fe+=32,Re>0)for(!xe&&Ae<ge+Re&&(pe=ke(pe,ge+Re),Ae=pe.length);Re-- >0;)pe[ge++]=oe[fe>>>3],fe+=8;continue}for(;;){!xe&&Ae<ge+32767&&(pe=ke(pe,ge+32767),Ae=pe.length);var je=A(oe,fe,ze),Xe=de>>>1==1?$e[je]:Bt[je];if(fe+=Xe&15,Xe>>>=4,(Xe>>>8&255)===0)pe[ge++]=Xe;else{if(Xe==256)break;Xe-=257;var Ze=Xe<8?0:Xe-4>>2;Ze>5&&(Ze=0);var st=ge+re[Xe];Ze>0&&(st+=A(oe,fe,Ze),fe+=Ze),je=A(oe,fe,Ce),Xe=de>>>1==1?rt[je]:hr[je],fe+=Xe&15,Xe>>>=4;var Ye=Xe<4?0:Xe-2>>1,tt=L[Xe];for(Ye>0&&(tt+=A(oe,fe,Ye),fe+=Ye),!xe&&Ae<st&&(pe=ke(pe,st+100),Ae=pe.length);ge<st;)pe[ge]=pe[ge-tt],++ge}}}return xe?[pe,fe+7>>>3]:[pe.slice(0,ge),fe+7>>>3]}function pi(oe,xe){var fe=oe.slice(oe.l||0),de=Vo(fe,xe);return oe.l+=de[1],de[0]}function xs(oe,xe){if(oe)typeof console<"u"&&console.error(xe);else throw new Error(xe)}function Ga(oe,xe){var fe=oe;qn(fe,0);var de=[],pe=[],ge={FileIndex:de,FullPaths:pe};O(ge,{root:xe.root});for(var Ae=fe.length-4;(fe[Ae]!=80||fe[Ae+1]!=75||fe[Ae+2]!=5||fe[Ae+3]!=6)&&Ae>=0;)--Ae;fe.l=Ae+4,fe.l+=4;var ze=fe.read_shift(2);fe.l+=6;var Ce=fe.read_shift(4);for(fe.l=Ce,Ae=0;Ae<ze;++Ae){fe.l+=20;var Re=fe.read_shift(4),je=fe.read_shift(4),Xe=fe.read_shift(2),Ze=fe.read_shift(2),st=fe.read_shift(2);fe.l+=8;var Ye=fe.read_shift(4),tt=o(fe.slice(fe.l+Xe,fe.l+Xe+Ze));fe.l+=Xe+Ze+st;var ct=fe.l;fe.l=Ye+4,Ka(fe,Re,je,ge,tt),fe.l=ct}return ge}function Ka(oe,xe,fe,de,pe){oe.l+=2;var ge=oe.read_shift(2),Ae=oe.read_shift(2),ze=i(oe);if(ge&8257)throw new Error("Unsupported ZIP encryption");for(var Ce=oe.read_shift(4),Re=oe.read_shift(4),je=oe.read_shift(4),Xe=oe.read_shift(2),Ze=oe.read_shift(2),st="",Ye=0;Ye<Xe;++Ye)st+=String.fromCharCode(oe[oe.l++]);if(Ze){var tt=o(oe.slice(oe.l,oe.l+Ze));(tt[21589]||{}).mt&&(ze=tt[21589].mt),((pe||{})[21589]||{}).mt&&(ze=pe[21589].mt)}oe.l+=Ze;var ct=oe.slice(oe.l,oe.l+Re);switch(Ae){case 8:ct=q(oe,je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ae)}var gr=!1;ge&8&&(Ce=oe.read_shift(4),Ce==134695760&&(Ce=oe.read_shift(4),gr=!0),Re=oe.read_shift(4),je=oe.read_shift(4)),Re!=xe&&xs(gr,"Bad compressed size: "+xe+" != "+Re),je!=fe&&xs(gr,"Bad uncompressed size: "+fe+" != "+je),kn(de,st,ct,{unsafe:!0,mt:ze})}function gs(oe,xe){var fe=xe||{},de=[],pe=[],ge=Le(1),Ae=fe.compression?8:0,ze=0,Ce=0,Re=0,je=0,Xe=0,Ze=oe.FullPaths[0],st=Ze,Ye=oe.FileIndex[0],tt=[],ct=0;for(Ce=1;Ce<oe.FullPaths.length;++Ce)if(st=oe.FullPaths[Ce].slice(Ze.length),Ye=oe.FileIndex[Ce],!(!Ye.size||!Ye.content||st=="Sh33tJ5")){var gr=je,yr=Le(st.length);for(Re=0;Re<st.length;++Re)yr.write_shift(1,st.charCodeAt(Re)&127);yr=yr.slice(0,yr.l),tt[Xe]=VJ.buf(Ye.content,0);var Cr=Ye.content;Ae==8&&(Cr=G(Cr)),ge=Le(30),ge.write_shift(4,67324752),ge.write_shift(2,20),ge.write_shift(2,ze),ge.write_shift(2,Ae),Ye.mt?a(ge,Ye.mt):ge.write_shift(4,0),ge.write_shift(-4,tt[Xe]),ge.write_shift(4,Cr.length),ge.write_shift(4,Ye.content.length),ge.write_shift(2,yr.length),ge.write_shift(2,0),je+=ge.length,de.push(ge),je+=yr.length,de.push(yr),je+=Cr.length,de.push(Cr),ge=Le(46),ge.write_shift(4,33639248),ge.write_shift(2,0),ge.write_shift(2,20),ge.write_shift(2,ze),ge.write_shift(2,Ae),ge.write_shift(4,0),ge.write_shift(-4,tt[Xe]),ge.write_shift(4,Cr.length),ge.write_shift(4,Ye.content.length),ge.write_shift(2,yr.length),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(4,0),ge.write_shift(4,gr),ct+=ge.l,pe.push(ge),ct+=yr.length,pe.push(yr),++Xe}return ge=Le(22),ge.write_shift(4,101010256),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,Xe),ge.write_shift(2,Xe),ge.write_shift(4,ct),ge.write_shift(4,je),ge.write_shift(2,0),jn([jn(de),jn(pe),ge])}var nn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wt(oe,xe){if(oe.ctype)return oe.ctype;var fe=oe.name||"",de=fe.match(/\.([^\.]+)$/);return de&&nn[de[1]]||xe&&(de=(fe=xe).match(/[\.\\]([^\.\\])+$/),de&&nn[de[1]])?nn[de[1]]:"application/octet-stream"}function xr(oe){for(var xe=h0(oe),fe=[],de=0;de<xe.length;de+=76)fe.push(xe.slice(de,de+76));return fe.join(`\r
`)+`\r
`}function sn(oe){var xe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Re){var je=Re.charCodeAt(0).toString(16).toUpperCase();return"="+(je.length==1?"0"+je:je)});xe=xe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),xe.charAt(0)==`
`&&(xe="=0D"+xe.slice(1)),xe=xe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var fe=[],de=xe.split(`\r
`),pe=0;pe<de.length;++pe){var ge=de[pe];if(ge.length==0){fe.push("");continue}for(var Ae=0;Ae<ge.length;){var ze=76,Ce=ge.slice(Ae,Ae+ze);Ce.charAt(ze-1)=="="?ze--:Ce.charAt(ze-2)=="="?ze-=2:Ce.charAt(ze-3)=="="&&(ze-=3),Ce=ge.slice(Ae,Ae+ze),Ae+=ze,Ae<ge.length&&(Ce+="="),fe.push(Ce)}}return fe.join(`\r
`)}function Tn(oe){for(var xe=[],fe=0;fe<oe.length;++fe){for(var de=oe[fe];fe<=oe.length&&de.charAt(de.length-1)=="=";)de=de.slice(0,de.length-1)+oe[++fe];xe.push(de)}for(var pe=0;pe<xe.length;++pe)xe[pe]=xe[pe].replace(/[=][0-9A-Fa-f]{2}/g,function(ge){return String.fromCharCode(parseInt(ge.slice(1),16))});return na(xe.join(`\r
`))}function mi(oe,xe,fe){for(var de="",pe="",ge="",Ae,ze=0;ze<10;++ze){var Ce=xe[ze];if(!Ce||Ce.match(/^\s*$/))break;var Re=Ce.match(/^(.*?):\s*([^\s].*)$/);if(Re)switch(Re[1].toLowerCase()){case"content-location":de=Re[2].trim();break;case"content-type":ge=Re[2].trim();break;case"content-transfer-encoding":pe=Re[2].trim();break}}switch(++ze,pe.toLowerCase()){case"base64":Ae=na(ca(xe.slice(ze).join("")));break;case"quoted-printable":Ae=Tn(xe.slice(ze));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+pe)}var je=kn(oe,de.slice(fe.length),Ae,{unsafe:!0});ge&&(je.ctype=ge)}function br(oe,xe){if(ie(oe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var fe=xe&&xe.root||"",de=(Ft&&Buffer.isBuffer(oe)?oe.toString("binary"):ie(oe)).split(`\r
`),pe=0,ge="";for(pe=0;pe<de.length;++pe)if(ge=de[pe],!!/^Content-Location:/i.test(ge)&&(ge=ge.slice(ge.indexOf("file")),fe||(fe=ge.slice(0,ge.lastIndexOf("/")+1)),ge.slice(0,fe.length)!=fe))for(;fe.length>0&&(fe=fe.slice(0,fe.length-1),fe=fe.slice(0,fe.lastIndexOf("/")+1),ge.slice(0,fe.length)!=fe););var Ae=(de[1]||"").match(/boundary="(.*?)"/);if(!Ae)throw new Error("MAD cannot find boundary");var ze="--"+(Ae[1]||""),Ce=[],Re=[],je={FileIndex:Ce,FullPaths:Re};O(je);var Xe,Ze=0;for(pe=0;pe<de.length;++pe){var st=de[pe];st!==ze&&st!==ze+"--"||(Ze++&&mi(je,de.slice(Xe,pe),fe),Xe=pe)}return je}function es(oe,xe){var fe=xe||{},de=fe.boundary||"SheetJS";de="------="+de;for(var pe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+de.slice(2)+'"',"","",""],ge=oe.FullPaths[0],Ae=ge,ze=oe.FileIndex[0],Ce=1;Ce<oe.FullPaths.length;++Ce)if(Ae=oe.FullPaths[Ce].slice(ge.length),ze=oe.FileIndex[Ce],!(!ze.size||!ze.content||Ae=="Sh33tJ5")){Ae=Ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var Re=ze.content,je=Ft&&Buffer.isBuffer(Re)?Re.toString("binary"):ie(Re),Xe=0,Ze=Math.min(1024,je.length),st=0,Ye=0;Ye<=Ze;++Ye)(st=je.charCodeAt(Ye))>=32&&st<128&&++Xe;var tt=Xe>=Ze*4/5;pe.push(de),pe.push("Content-Location: "+(fe.root||"file:///C:/SheetJS/")+Ae),pe.push("Content-Transfer-Encoding: "+(tt?"quoted-printable":"base64")),pe.push("Content-Type: "+wt(ze,Ae)),pe.push(""),pe.push(tt?sn(je):xr(je))}return pe.push(de+`--\r
`),pe.join(`\r
`)}function qi(oe){var xe={};return O(xe,oe),xe}function kn(oe,xe,fe,de){var pe=de&&de.unsafe;pe||O(oe);var ge=!pe&&mt.find(oe,xe);if(!ge){var Ae=oe.FullPaths[0];xe.slice(0,Ae.length)==Ae?Ae=xe:(Ae.slice(-1)!="/"&&(Ae+="/"),Ae=(Ae+xe).replace("//","/")),ge={name:s(xe),type:2},oe.FileIndex.push(ge),oe.FullPaths.push(Ae),pe||mt.utils.cfb_gc(oe)}return ge.content=fe,ge.size=fe?fe.length:0,de&&(de.CLSID&&(ge.clsid=de.CLSID),de.mt&&(ge.mt=de.mt),de.ct&&(ge.ct=de.ct)),ge}function ts(oe,xe){O(oe);var fe=mt.find(oe,xe);if(fe){for(var de=0;de<oe.FileIndex.length;++de)if(oe.FileIndex[de]==fe)return oe.FileIndex.splice(de,1),oe.FullPaths.splice(de,1),!0}return!1}function qo(oe,xe,fe){O(oe);var de=mt.find(oe,xe);if(de){for(var pe=0;pe<oe.FileIndex.length;++pe)if(oe.FileIndex[pe]==de)return oe.FileIndex[pe].name=s(fe),oe.FullPaths[pe]=fe,!0}return!1}function Ws(oe){j(oe,!0)}return t.find=ae,t.read=D,t.parse=h,t.write=Ee,t.writeFile=me,t.utils={cfb_new:qi,cfb_add:kn,cfb_del:ts,cfb_mov:qo,cfb_gc:Ws,ReadShift:Uh,CheckField:lI,prep_blob:qn,bconcat:jn,use_zlib:M,_deflateRaw:dt,_inflateRaw:pi,consts:te},t})();function qJ(e){return typeof e=="string"?N1(e):Array.isArray(e)?xJ(e):e}function ep(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=N1(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Mi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([qJ(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Gl(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function WJ(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Wr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function U3(e,t){for(var r=[],n=Wr(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function k1(e){for(var t=[],r=Wr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function A1(e){for(var t=[],r=Wr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function $J(e){for(var t=[],r=Wr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var tg=new Date(1899,11,30,0,0,0);function wn(e,t){var r=e.getTime(),n=tg.getTime()+(e.getTimezoneOffset()-tg.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var zD=new Date,GJ=tg.getTime()+(zD.getTimezoneOffset()-tg.getTimezoneOffset())*6e4,z3=zD.getTimezoneOffset();function C1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+GJ),t.getTimezoneOffset()!==z3&&t.setTime(t.getTime()+(t.getTimezoneOffset()-z3)*6e4),t}function KJ(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var H3=new Date("2017-02-19T19:06:09.000Z"),HD=isNaN(H3.getFullYear())?new Date("2/19/17"):H3,XJ=HD.getFullYear()==2017;function Tr(e,t){var r=new Date(e);if(XJ)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(HD.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Jc(e,t){if(Ft&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Mi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Mi(CD(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Mi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Mi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function kr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=kr(e[r]));return t}function Hr(e,t){for(var r="";r.length<t;)r+=e;return r}function ai(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var YJ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Mf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&YJ.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var JJ=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}})();function VD(e){return e?e.content&&e.type?Jc(e.content,!0):e.data?Rh(e.data):e.asNodeBuffer&&Ft?Rh(e.asNodeBuffer().toString("binary")):e.asBinary?Rh(e.asBinary()):e._data&&e._data.getContent?Rh(Jc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function qD(e){if(!e)return null;if(e.data)return R3(e.data);if(e.asNodeBuffer&&Ft)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?R3(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ZJ(e){return e&&e.name.slice(-4)===".bin"?qD(e):VD(e)}function Oa(e,t){for(var r=e.FullPaths||Wr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function oS(e,t){var r=Oa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function pn(e,t,r){if(!r)return ZJ(oS(e,t));if(!t)return null;try{return pn(e,t)}catch{return null}}function sa(e,t,r){if(!r)return VD(oS(e,t));if(!t)return null;try{return sa(e,t)}catch{return null}}function QJ(e,t,r){return qD(oS(e,t))}function V3(e){for(var t=e.FullPaths||Wr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ot(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ft?n=Lo(r):n=gJ(r),mt.utils.cfb_add(e,t,n)}mt.utils.cfb_add(e,t,r)}else e.file(t,r)}function lS(){return mt.utils.cfb_new()}function WD(e,t){switch(t.type){case"base64":return mt.read(e,{type:"base64"});case"binary":return mt.read(e,{type:"binary"});case"buffer":case"array":return mt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function jh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Qr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eZ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,q3=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tZ=/<[^>]*>/g,ps=Qr.match(q3)?q3:tZ,rZ=/<\w*:/,nZ=/<(\/?)\w+:/;function _t(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(eZ),o=0,c="",f=0,h="",p="",x=1;if(i)for(f=0;f!=i.length;++f){for(p=i[f],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(h=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(x=(s=p.charCodeAt(a+1))==34||s==39?1:0,c=p.slice(a+1+x,p.length-x),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var g=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[g]&&h.slice(o-3,o)=="ext")continue;n[g]=c,n[g.toLowerCase()]=c}}return n}function zi(e){return e.replace(nZ,"<$1")}var $D={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cS=k1($D),$t=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return $D[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),uS=/[&<>'"]/g,sZ=/[\u0000-\u0008\u000b-\u001f]/g;function sr(e){var t=e+"";return t.replace(uS,function(r){return cS[r]}).replace(sZ,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function W3(e){return sr(e).replace(/ /g,"_x0020_")}var GD=/[\u0000-\u001f]/g;function fS(e){var t=e+"";return t.replace(uS,function(r){return cS[r]}).replace(/\n/g,"<br/>").replace(GD,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function aZ(e){var t=e+"";return t.replace(uS,function(r){return cS[r]}).replace(GD,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var $3=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function iZ(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Nr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Cb(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function G3(e){var t=zl(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function K3(e){return Lo(e,"binary").toString("utf8")}var zm="foo bar baz",dr=Ft&&(K3(zm)==Cb(zm)&&K3||G3(zm)==Cb(zm)&&G3)||Cb,Mi=Ft?function(e){return Lo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},m0=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),KD=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),oZ=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),lZ=/<\/?(?:vt:)?variant>/g,cZ=/<(?:vt:)([^>]*)>([\s\S]*)</;function X3(e,t){var r=_t(e),n=e.match(oZ(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(lZ,"").match(cZ);i&&s.push({v:dr(i[2]),t:i[1]})}),s}var XD=/(^\s|\s$|\n)/;function Gn(e,t){return"<"+e+(t.match(XD)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function x0(e){return Wr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Qe(e,t,r){return"<"+e+(r!=null?x0(r):"")+(t!=null?(t.match(XD)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function R_(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function uZ(e,t){switch(typeof e){case"string":var r=Qe("vt:lpwstr",sr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Qe((e|0)==e?"vt:i4":"vt:r8",sr(String(e)));case"boolean":return Qe("vt:bool",e?"true":"false")}if(e instanceof Date)return Qe("vt:filetime",R_(e));throw new Error("Unable to serialize "+e)}function dS(e){if(Ft&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return dr(Gl(sS(e)));throw new Error("Bad input format: expected Buffer or string")}var g0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,bn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},cu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ta={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function fZ(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function dZ(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var Y3=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},J3=Ft?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Lo(t)})):Y3(e)}:Y3,Z3=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(bo(e,s)));return n.join("").replace(Es,"")},hS=Ft?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Es,""):Z3(e,t,r)}:Z3,Q3=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},YD=Ft?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Q3(e,t,r)}:Q3,e5=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(lf(e,s)));return n.join("")},tp=Ft?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):e5(t,r,n)}:e5,JD=function(e,t){var r=ra(e,t);return r>0?tp(e,t+4,t+4+r-1):""},ZD=JD,QD=function(e,t){var r=ra(e,t);return r>0?tp(e,t+4,t+4+r-1):""},eI=QD,tI=function(e,t){var r=2*ra(e,t);return r>0?tp(e,t+4,t+4+r-1):""},rI=tI,nI=function(t,r){var n=ra(t,r);return n>0?hS(t,r+4,r+4+n):""},sI=nI,aI=function(e,t){var r=ra(e,t);return r>0?tp(e,t+4,t+4+r):""},iI=aI,oI=function(e,t){return fZ(e,t)},rg=oI,pS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ft&&(ZD=function(t,r){if(!Buffer.isBuffer(t))return JD(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},eI=function(t,r){if(!Buffer.isBuffer(t))return QD(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},rI=function(t,r){if(!Buffer.isBuffer(t))return tI(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},sI=function(t,r){if(!Buffer.isBuffer(t))return nI(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},iI=function(t,r){if(!Buffer.isBuffer(t))return aI(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},rg=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):oI(t,r)},pS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var lf=function(e,t){return e[t]},bo=function(e,t){return e[t+1]*256+e[t]},hZ=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ra=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},_c=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},pZ=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Uh(e,t){var r="",n,s,a=[],i,o,c,f;switch(t){case"dbcs":if(f=this.l,Ft&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(bo(this,f)),f+=2;e*=2;break;case"utf8":r=tp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=hS(this,this.l,this.l+e);break;case"wstr":return Uh.call(this,e,"dbcs");case"lpstr-ansi":r=ZD(this,this.l),e=4+ra(this,this.l);break;case"lpstr-cp":r=eI(this,this.l),e=4+ra(this,this.l);break;case"lpwstr":r=rI(this,this.l),e=4+2*ra(this,this.l);break;case"lpp4":e=4+ra(this,this.l),r=sI(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ra(this,this.l),r=iI(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=lf(this,this.l+e++))!==0;)a.push(Um(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=bo(this,this.l+e))!==0;)a.push(Um(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return i=lf(this,f),this.l=f+1,o=Uh.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Um(bo(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return i=lf(this,f),this.l=f+1,o=Uh.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Um(lf(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=lf(this,this.l),this.l++,n;case 2:return n=(t==="i"?hZ:bo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?_c:pZ)(this,this.l),this.l+=4,n):(s=ra(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=rg(this,this.l):s=rg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=YD(this,this.l,e);break}}return this.l+=e,r}var mZ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},xZ=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},gZ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function yZ(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)gZ(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,mZ(this,t,this.l);break;case 8:if(n=8,r==="f"){dZ(this,t,this.l);break}case 16:break;case-4:n=4,xZ(this,t,this.l);break}return this.l+=n,this}function lI(e,t){var r=YD(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function qn(e,t){e.l=t,e.read_shift=Uh,e.chk=lI,e.write_shift=yZ}function ds(e,t){e.l+=t}function Le(e){var t=zl(e);return qn(t,0),t}function Bo(e,t,r){if(e){var n,s,a;qn(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=E0[o]||E0[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var h=f.f&&f.f(e,a,r);if(e.l=c,t(h,f,o))return}}}function Bs(){var e=[],t=Ft?256:2048,r=function(f){var h=Le(f);return qn(h,0),h},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(s(),n=r(Math.max(f+1,t)))},i=function(){return s(),jn(e)},o=function(f){s(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function qe(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=E0[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&pS(r)&&e.push(r)}}function zh(e,t,r){var n=kr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function t5(e,t,r){var n=kr(e);return n.s=zh(n.s,t.s,r),n.e=zh(n.e,t.s,r),n}function Hh(e,t){if(e.cRel&&e.c<0)for(e=kr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=kr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=bt(e);return!e.cRel&&e.cRel!=null&&(r=wZ(r)),!e.rRel&&e.rRel!=null&&(r=vZ(r)),r}function Rb(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dr(e.s.c)+":"+(e.e.cRel?"":"$")+Dr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Jr(e.s.r)+":"+(e.e.rRel?"":"$")+Jr(e.e.r):Hh(e.s,t.biff)+":"+Hh(e.e,t.biff)}function mS(e){return parseInt(bZ(e),10)-1}function Jr(e){return""+(e+1)}function vZ(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function bZ(e){return e.replace(/\$(\d+)$/,"$1")}function xS(e){for(var t=_Z(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Dr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function wZ(e){return e.replace(/^([A-Z])/,"$$$1")}function _Z(e){return e.replace(/^\$([A-Z])/,"$1")}function EZ(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ir(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function bt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Hs(e){var t=e.indexOf(":");return t==-1?{s:Ir(e),e:Ir(e)}:{s:Ir(e.slice(0,t)),e:Ir(e.slice(t+1))}}function Ct(e,t){return typeof t>"u"||typeof t=="number"?Ct(e.s,e.e):(typeof e!="string"&&(e=bt(e)),typeof t!="string"&&(t=bt(t)),e==t?e:e+":"+t)}function Gt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function r5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ha(e.z,r?wn(t):t)}catch{}try{return e.w=Ha((e.XF||{}).numFmtId||(r?14:0),r?wn(t):t)}catch{return""+t}}function Io(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Uo[e.v]||e.v:t==null?r5(e,e.v):r5(e,t))}function Kl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function cI(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Ir(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var h=Gt(a["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),i==-1&&(f.e.r=i=h.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[p].length;++x)if(!(typeof t[p][x]>"u")){var g={v:t[p][x]},v=i+p,y=o+x;if(f.s.r>v&&(f.s.r=v),f.s.c>y&&(f.s.c=y),f.e.r<v&&(f.e.r=v),f.e.c<y&&(f.e.c=y),t[p][x]&&typeof t[p][x]=="object"&&!Array.isArray(t[p][x])&&!(t[p][x]instanceof Date))g=t[p][x];else if(Array.isArray(g.v)&&(g.f=t[p][x][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||yt[14],n.cellDates?(g.t="d",g.w=Ha(g.z,wn(g.v))):(g.t="n",g.v=wn(g.v),g.w=Ha(g.z,g.v))):g.t="s";if(s)a[v]||(a[v]=[]),a[v][y]&&a[v][y].z&&(g.z=a[v][y].z),a[v][y]=g;else{var w=bt({c:y,r:v});a[w]&&a[w].z&&(g.z=a[w].z),a[w]=g}}}return f.s.c<1e7&&(a["!ref"]=Ct(f)),a}function xd(e,t){return cI(null,e,t)}function SZ(e){return e.read_shift(4,"i")}function ii(e,t){return t||(t=Le(4)),t.write_shift(4,e),t}function fs(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function In(e,t){var r=!1;return t==null&&(r=!0,t=Le(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function NZ(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function TZ(e,t){return t||(t=Le(4)),t.write_shift(2,0),t.write_shift(2,0),t}function gS(e,t){var r=e.l,n=e.read_shift(1),s=fs(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(NZ(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function kZ(e,t){var r=!1;return t==null&&(r=!0,t=Le(15+4*e.t.length)),t.write_shift(1,0),In(e.t,t),r?t.slice(0,t.l):t}var AZ=gS;function CZ(e,t){var r=!1;return t==null&&(r=!0,t=Le(23+4*e.t.length)),t.write_shift(1,1),In(e.t,t),t.write_shift(4,1),TZ({},t),r?t.slice(0,t.l):t}function $a(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function uu(e,t){return t==null&&(t=Le(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function fu(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function du(e,t){return t==null&&(t=Le(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var RZ=fs,uI=In;function yS(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ng(e,t){var r=!1;return t==null&&(r=!0,t=Le(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var OZ=fs,O_=yS,vS=ng;function bS(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?rg([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):_c(t,0)>>2;return r?s/100:s}function fI(e,t){t==null&&(t=Le(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function dI(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function jZ(e,t){return t||(t=Le(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var hu=dI,gd=jZ;function us(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zc(e,t){return(t||Le(8)).write_shift(8,e,"f")}function DZ(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var f=Mc[s];f&&(t.rgb=v0(f));break;case 2:t.rgb=v0([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function sg(e,t){if(t||(t=Le(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function IZ(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function MZ(e,t){t||(t=Le(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function hI(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function FZ(e){return hI(e,1)}function PZ(e){return hI(e,2)}var wS=2,Ms=3,Hm=11,n5=12,ag=19,Vm=64,LZ=65,BZ=71,UZ=4108,zZ=4126,Rn=80,pI=81,HZ=[Rn,pI],j_={1:{n:"CodePage",t:wS},2:{n:"Category",t:Rn},3:{n:"PresentationFormat",t:Rn},4:{n:"ByteCount",t:Ms},5:{n:"LineCount",t:Ms},6:{n:"ParagraphCount",t:Ms},7:{n:"SlideCount",t:Ms},8:{n:"NoteCount",t:Ms},9:{n:"HiddenCount",t:Ms},10:{n:"MultimediaClipCount",t:Ms},11:{n:"ScaleCrop",t:Hm},12:{n:"HeadingPairs",t:UZ},13:{n:"TitlesOfParts",t:zZ},14:{n:"Manager",t:Rn},15:{n:"Company",t:Rn},16:{n:"LinksUpToDate",t:Hm},17:{n:"CharacterCount",t:Ms},19:{n:"SharedDoc",t:Hm},22:{n:"HyperlinksChanged",t:Hm},23:{n:"AppVersion",t:Ms,p:"version"},24:{n:"DigSig",t:LZ},26:{n:"ContentType",t:Rn},27:{n:"ContentStatus",t:Rn},28:{n:"Language",t:Rn},29:{n:"Version",t:Rn},255:{},2147483648:{n:"Locale",t:ag},2147483651:{n:"Behavior",t:ag},1919054434:{}},D_={1:{n:"CodePage",t:wS},2:{n:"Title",t:Rn},3:{n:"Subject",t:Rn},4:{n:"Author",t:Rn},5:{n:"Keywords",t:Rn},6:{n:"Comments",t:Rn},7:{n:"Template",t:Rn},8:{n:"LastAuthor",t:Rn},9:{n:"RevNumber",t:Rn},10:{n:"EditTime",t:Vm},11:{n:"LastPrinted",t:Vm},12:{n:"CreatedDate",t:Vm},13:{n:"ModifiedDate",t:Vm},14:{n:"PageCount",t:Ms},15:{n:"WordCount",t:Ms},16:{n:"CharCount",t:Ms},17:{n:"Thumbnail",t:BZ},18:{n:"Application",t:Rn},19:{n:"DocSecurity",t:Ms},255:{},2147483648:{n:"Locale",t:ag},2147483651:{n:"Behavior",t:ag},1919054434:{}},s5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},VZ=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function qZ(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var WZ=qZ([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Mc=kr(WZ),Uo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},mI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},I_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},qm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function _S(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function $Z(e){var t=_S();if(!e||!e.match)return t;var r={};if((e.match(ps)||[]).forEach(function(n){var s=_t(n);switch(s[0].replace(rZ,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[I_[s.ContentType]]!==void 0&&t[I_[s.ContentType]].push(s.PartName);break}}),t.xmlns!==bn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function xI(e,t){var r=$J(I_),n=[],s;n[n.length]=Qr,n[n.length]=Qe("Types",null,{xmlns:bn.CT,"xmlns:xsd":bn.xsd,"xmlns:xsi":bn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Qe("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Qe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:qm[c][t.bookType]||qm[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(f){n[n.length]=Qe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:qm[c][t.bookType]||qm[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(f){n[n.length]=Qe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Lt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function y0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Vh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ps)||[]).forEach(function(s){var a=_t(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:jh(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function gf(e){var t=[Qr,Qe("Relationships",null,{xmlns:bn.RELS})];return Wr(e["!id"]).forEach(function(r){t[t.length]=Qe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function nr(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Lt.HLINK,Lt.XPATH,Lt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var GZ="application/vnd.oasis.opendocument.spreadsheet";function KZ(e,t){for(var r=dS(e),n,s;n=g0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=_t(n[0],!1),s.path=="/"&&s.type!==GZ)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function XZ(e){var t=[Qr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function a5(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function YZ(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function JZ(e){var t=[Qr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(a5(e[r][0],e[r][1])),t.push(YZ("",e[r][0]));return t.push(a5("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function gI(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Jx.version+"</meta:generator></office:meta></office:document-meta>"}var La=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ZZ=(function(){for(var e=new Array(La.length),t=0;t<La.length;++t){var r=La[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function yI(e){var t={};e=dr(e);for(var r=0;r<La.length;++r){var n=La[r],s=e.match(ZZ[r]);s!=null&&s.length>0&&(t[n[1]]=$t(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Tr(t[n[1]]))}return t}function Ob(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=sr(t),n[n.length]=r?Qe(e,t,r):Gn(e,t))}function vI(e,t){var r=t||{},n=[Qr,Qe("cp:coreProperties",null,{"xmlns:cp":bn.CORE_PROPS,"xmlns:dc":bn.dc,"xmlns:dcterms":bn.dcterms,"xmlns:dcmitype":bn.dcmitype,"xmlns:xsi":bn.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Ob("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:R_(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Ob("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:R_(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=La.length;++a){var i=La[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Ob(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Fc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],bI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wI(e,t,r,n){var s=[];if(typeof e=="string")s=X3(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(h){return{v:h}}));var i=typeof t=="string"?X3(t,n).map(function(h){return h.v}):t,o=0,c=0;if(i.length>0)for(var f=0;f!==s.length;f+=2){switch(c=+s[f+1].v,s[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function QZ(e,t,r){var n={};return t||(t={}),e=dr(e),Fc.forEach(function(s){var a=(e.match(m0(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=$t(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&wI(n.HeadingPairs,n.TitlesOfParts,t,r),t}function _I(e){var t=[],r=Qe;return e||(e={}),e.Application="SheetJS",t[t.length]=Qr,t[t.length]=Qe("Properties",null,{xmlns:bn.EXT_PROPS,"xmlns:vt":bn.vt}),Fc.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=sr(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+sr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var eQ=/<[^>]+>[^<]*/g;function tQ(e,t){var r={},n="",s=e.match(eQ);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=_t(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=$t(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),f=c[0].slice(4),h=c[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=$t(h);break;case"bool":r[n]=Nr(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Tr(h);break;case"cy":case"error":r[n]=$t(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,f,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function EI(e){var t=[Qr,Qe("Properties",null,{xmlns:bn.CUST_PROPS,"xmlns:vt":bn.vt})];if(!e)return t.join("");var r=1;return Wr(e).forEach(function(s){++r,t[t.length]=Qe("property",uZ(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:sr(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var M_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},jb;function rQ(e,t,r){jb||(jb=k1(M_)),t=jb[t]||t,e[t]=r}function nQ(e,t){var r=[];return Wr(M_).map(function(n){for(var s=0;s<La.length;++s)if(La[s][1]==n)return La[s];for(s=0;s<Fc.length;++s)if(Fc[s][1]==n)return Fc[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Gn(M_[n[1]]||n[1],s))}}),Qe("DocumentProperties",r.join(""),{xmlns:ta.o})}function sQ(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Wr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<La.length;++i)if(a==La[i][1])return;for(i=0;i<Fc.length;++i)if(a==Fc[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Qe(W3(a),o,{"dt:dt":c}))}}),t&&Wr(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Qe(W3(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+ta.o+'">'+s.join("")+"</"+n+">"}function ES(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function aQ(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=Le(8);return i.write_shift(4,n),i.write_shift(4,s),i}function SI(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function NI(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function TI(e,t,r){return t===31?NI(e):SI(e,t,r)}function F_(e,t,r){return TI(e,t,r===!1?0:4)}function iQ(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return TI(e,t,0)}function oQ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Es,""),e.l-s&2&&(e.l+=2)}return r}function lQ(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Es,"");return r}function cQ(e){var t=e.l,r=ig(e,pI);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ig(e,Ms);return[r,n]}function uQ(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(cQ(e));return r}function i5(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Es,"").replace(Oh,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function kI(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function fQ(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ig(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==n5&&n!==t&&HZ.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===n5?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return SI(e,n,4).replace(Es,"");case 31:return NI(e);case 64:return ES(e);case 65:return kI(e);case 71:return fQ(e);case 80:return F_(e,n,!a.raw).replace(Es,"");case 81:return iQ(e,n).replace(Es,"");case 4108:return uQ(e);case 4126:case 4127:return n==4127?oQ(e):lQ(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function o5(e,t){var r=Le(4),n=Le(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Le(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=aQ(t);break;case 31:case 80:for(n=Le(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return jn([r,n])}function l5(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,f={};for(i=0;i!=s;++i){var h=e.read_shift(4),p=e.read_shift(4);a[i]=[h,p+r]}a.sort(function(S,E){return S[1]-E[1]});var x={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var g=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,g=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],g=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],g=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(g=!1,e.l=a[i][1]),g)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[a[i][0]];if(x[v.n]=ig(e,v.t,{raw:!0}),v.p==="version"&&(x[v.n]=String(x[v.n]>>16)+"."+("0000"+String(x[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(x[v.n]){case 0:x[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ri(o=x[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[v.n])}}else if(a[i][0]===1){if(o=x.CodePage=ig(e,wS),ri(o),c!==-1){var y=e.l;e.l=a[c][1],f=i5(e,o),e.l=y}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}f=i5(e,o)}else{var w=f[a[i][0]],_;switch(e[e.l]){case 65:e.l+=4,_=kI(e);break;case 30:e.l+=4,_=F_(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=F_(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=Kr(e,4);break;case 64:e.l+=4,_=Tr(ES(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[w]=_}}return e.l=r+n,x}var AI=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function dQ(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function c5(e,t,r){var n=Le(8),s=[],a=[],i=8,o=0,c=Le(8),f=Le(8);if(c.write_shift(4,2),c.write_shift(4,1200),f.write_shift(4,1),a.push(c),s.push(f),i+=8+c.length,!t){f=Le(8),f.write_shift(4,0),s.unshift(f);var h=[Le(4)];for(h[0].write_shift(4,e.length),o=0;o<e.length;++o){var p=e[o][0];for(c=Le(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=jn(h),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(AI.indexOf(e[o][0])>-1||bI.indexOf(e[o][0])>-1)&&e[o][1]!=null){var x=e[o][1],g=0;if(t){g=+t[e[o][0]];var v=r[g];if(v.p=="version"&&typeof x=="string"){var y=x.split(".");x=(+y[0]<<16)+(+y[1]||0)}c=o5(v.t,x)}else{var w=dQ(x);w==-1&&(w=31,x=String(x)),c=o5(w,x)}a.push(c),f=Le(8),f.write_shift(4,t?g:2+o),s.push(f),i+=8+c.length}var _=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,_),_+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),jn([n].concat(s).concat(a))}function u5(e,t,r){var n=e.content;if(!n)return{};qn(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),h=n.read_shift(16);if(h!==mt.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var p=l5(n,t),x={SystemIdentifier:f};for(var g in p)x[g]=p[g];if(x.FMTID=a,s===1)return x;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=l5(n,null)}catch{}for(g in v)x[g]=v[g];return x.FMTID=[a,i],x}function f5(e,t,r,n,s,a){var i=Le(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,mt.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=c5(e,r,n);if(o.push(c),s){var f=c5(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(f)}return jn(o)}function ml(e,t){return e.read_shift(t),null}function hQ(e,t){t||(t=Le(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function pQ(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Kr(e,t){return e.read_shift(t)===1}function bs(e,t){return t||(t=Le(2)),t.write_shift(2,+!!e),t}function mn(e){return e.read_shift(2,"u")}function Ia(e,t){return t||(t=Le(2)),t.write_shift(2,e),t}function CI(e,t){return pQ(e,t,mn)}function mQ(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function RI(e,t,r){return r||(r=Le(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function rp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function xQ(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=h,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function gQ(e){var t=e.t||"",r=Le(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Le(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return jn(s)}function Qc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function np(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Qc(e,n,r)}function pu(e,t,r){if(r.biff>5)return np(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function OI(e,t,r){return r||(r=Le(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function yQ(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function vQ(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Es,"");return n&&(e.l+=24),s}function bQ(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Es,"");return r+i}function wQ(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return vQ(e);case"0303000000000000c000000000000046":return bQ(e);default:throw new Error("Unsupported Moniker "+r)}}function Wm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Es,""):"";return r}function d5(e,t){t||(t=Le(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function _Q(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,f="",h,p;s&16&&(a=Wm(e,r-e.l)),s&128&&(i=Wm(e,r-e.l)),(s&257)===257&&(o=Wm(e,r-e.l)),(s&257)===1&&(c=wQ(e,r-e.l)),s&8&&(f=Wm(e,r-e.l)),s&32&&(h=e.read_shift(16)),s&64&&(p=ES(e)),e.l=r;var x=i||o||c||"";x&&f&&(x+="#"+f),x||(x="#"+f),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var g={Target:x};return h&&(g.guid=h),p&&(g.time=p),a&&(g.Tooltip=a),g}function EQ(e){var t=Le(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),d5(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&d5(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function jI(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function DI(e,t){var r=jI(e);return r[3]=0,r}function Hi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function eu(e,t,r,n){return n||(n=Le(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function SQ(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function NQ(e,t,r){return t===0?"":pu(e,t,r)}function TQ(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function II(e){var t=e.read_shift(2),r=bS(e);return[t,r]}function kQ(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=rp(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function R1(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function MI(e,t){return t||(t=Le(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function FI(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var AQ=FI;function PI(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function CQ(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function RQ(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ns(e){e.l+=2,e.l+=e.read_shift(2)}var OQ={0:ns,4:ns,5:ns,6:ns,7:RQ,8:ns,9:ns,10:ns,11:ns,12:ns,13:CQ,14:ns,15:ns,16:ns,17:ns,18:ns,19:ns,20:ns,21:PI};function jQ(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(OQ[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function $m(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function SS(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Le(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function DQ(e,t){return t===0||e.read_shift(2),1200}function IQ(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=pu(e,0,r);return e.read_shift(t+n-e.l),s}function MQ(e,t){var r=!t||t.biff==8,n=Le(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function FQ(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function PQ(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=rp(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function LQ(e,t){var r=!t||t.biff>=8?2:1,n=Le(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function BQ(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(xQ(e));return a.Count=n,a.Unique=s,a}function UQ(e,t){var r=Le(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=gQ(e[s]);var a=jn([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function zQ(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function HQ(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function VQ(e){var t=SQ(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function qQ(e){return e.read_shift(2),e.read_shift(4)}function h5(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function WQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:f}}function $Q(){var e=Le(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function GQ(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function KQ(e){var t=Le(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function XQ(){}function YQ(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=rp(e,0,r),n}function JQ(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=Le(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function ZQ(e){var t=Hi(e);return t.isst=e.read_shift(4),t}function QQ(e,t,r,n){var s=Le(10);return eu(e,t,n,s),s.write_shift(4,r),s}function eee(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Hi(e);r.biff==2&&e.l++;var a=np(e,n-e.l,r);return s.val=a,s}function tee(e,t,r,n,s){var a=!s||s.biff==8,i=Le(8+ +a+(1+a)*r.length);return eu(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function ree(e,t,r){var n=e.read_shift(2),s=pu(e,0,r);return[n,s]}function nee(e,t,r,n){var s=r&&r.biff==5;n||(n=Le(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var see=pu;function p5(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function aee(e,t){var r=t.biff==8||!t.biff?4:2,n=Le(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function iee(e){var t=e.read_shift(2),r=e.read_shift(2),n=II(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function oee(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(II(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function lee(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function cee(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=VZ[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function uee(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=cee(e,t,n.fStyle,r),n}function m5(e,t,r,n){var s=r&&r.biff==5;n||(n=Le(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function fee(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function dee(e){var t=Le(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function x5(e,t,r){var n=Hi(e);(r.biff==2||t==9)&&++e.l;var s=mQ(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function hee(e,t,r,n,s,a){var i=Le(8);return eu(e,t,n,i),RI(r,a,i),i}function pee(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Hi(e),s=us(e);return n.val=s,n}function mee(e,t,r,n){var s=Le(14);return eu(e,t,n,s),Zc(r,s),s}var g5=NQ;function xee(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Qc(e,a),o=[];n>e.l;)o.push(np(e));return[a,s,i,o]}function y5(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=kQ(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var gee=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function v5(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Qc(e,i,r);s&32&&(f=gee[f.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var p=n==e.l||o===0||!(h>0)?[]:jse(e,h,r,o);return{chKey:a,Name:f,itab:c,rgce:p}}function LI(e,t,r){if(r.biff<8)return yee(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(TQ(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function yee(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=rp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function vee(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Qc(e,n,r),i=Qc(e,s,r);return[a,i]}function bee(e,t,r){var n=FI(e);e.l++;var s=e.read_shift(1);return t-=8,[Dse(e,t,r),s,n]}function b5(e,t,r){var n=AQ(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Rse(e,t,r)]}function wee(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function _ee(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=pu(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Eee(e,t,r){return _ee(e,t,r)}function See(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(R1(e));return r}function Nee(e){var t=Le(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)MI(e[r],t);return t}function Tee(e,t,r){if(r&&r.biff<8)return Aee(e,t,r);var n=PI(e),s=jQ(e,t-22,n[1]);return{cmo:n,ft:s}}var kee={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function Aee(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((kee[n]||ds)(e,t,r)),{cmo:[s,n,a],ft:i}}function Cee(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=yQ(e,6,r);var o=e.read_shift(2);e.read_shift(2),mn(e,2);var c=e.read_shift(2);e.l+=c;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],p=Qc(e,e.lens[f+1]-e.lens[f]-1);if(s+=p,s.length>=(h?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Ree(e,t){var r=R1(e);e.l+=16;var n=_Q(e,t-24);return[r,n]}function Oee(e){var t=Le(24),r=Ir(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return jn([t,EQ(e[1])])}function jee(e,t){e.read_shift(2);var r=R1(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Es,""),[r,n]}function Dee(e){var t=e[1].Tooltip,r=Le(10+2*(t.length+1));r.write_shift(2,2048);var n=Ir(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Iee(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=s5[r]||r,r=e.read_shift(2),t[1]=s5[r]||r,t}function Mee(e){return e||(e=Le(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Fee(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(DI(e));return r}function Pee(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(DI(e));return r}function Lee(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function BI(e,t,r){if(!r.cellStyles)return ds(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var f={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(f.level=c>>8&7),f}function Bee(e,t){var r=Le(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Uee(e,t){var r={};return t<32||(e.l+=16,r.header=us(e),r.footer=us(e),e.l+=2),r}function zee(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Hee(e){for(var t=Le(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Vee=Hi,qee=CI,Wee=np;function $ee(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function Gee(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Hi(e);++e.l;var s=pu(e,t-7,r);return n.t="str",n.val=s,n}function Kee(e){var t=Hi(e);++e.l;var r=us(e);return t.t="n",t.val=r,t}function Xee(e,t,r){var n=Le(15);return op(n,e,t),n.write_shift(8,r,"f"),n}function Yee(e){var t=Hi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Jee(e,t,r){var n=Le(9);return op(n,e,t),n.write_shift(2,r),n}function Zee(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Qee(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function ete(e,t,r){var n=e.l+t,s=Hi(e),a=e.read_shift(2),i=Qc(e,a,r);return e.l=n,s.t="str",s.val=i,s}var tte=[2,3,48,49,131,139,140,245],P_=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=k1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var f=[],h=zl(1);switch(c.type){case"base64":h=na(ca(o));break;case"binary":h=na(o);break;case"buffer":case"array":h=o;break}qn(h,0);var p=h.read_shift(1),x=!!(p&136),g=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,w=521;p==2&&(y=h.read_shift(2)),h.l+=3,p!=2&&(y=h.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(w=h.read_shift(2));var _=h.read_shift(2),S=c.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(S=e[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var E=[],T={},k=Math.min(h.length,p==2?521:w-10-(g?264:0)),D=v?32:11;h.l<k&&h[h.l]!=13;)switch(T={},T.name=d0.utils.decode(S,h.slice(h.l,h.l+D)).replace(/[\u0000\r\n].*$/g,""),h.l+=D,T.type=String.fromCharCode(h.read_shift(1)),p!=2&&!v&&(T.offset=h.read_shift(4)),T.len=h.read_shift(1),p==2&&(T.offset=h.read_shift(2)),T.dec=h.read_shift(1),T.name.length&&E.push(T),p!=2&&(h.l+=v?13:14),T.type){case"B":(!g||T.len!=8)&&c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var O=0,z=0;for(f[0]=[],z=0;z!=E.length;++z)f[0][z]=E[z].name;for(;y-- >0;){if(h[h.l]===42){h.l+=_;continue}for(++h.l,f[++O]=[],z=0,z=0;z!=E.length;++z){var j=h.slice(h.l,h.l+E[z].len);h.l+=E[z].len,qn(j,0);var J=d0.utils.decode(S,j);switch(E[z].type){case"C":J.trim().length&&(f[O][z]=J.replace(/\s+$/,""));break;case"D":J.length===8?f[O][z]=new Date(+J.slice(0,4),+J.slice(4,6)-1,+J.slice(6,8)):f[O][z]=J;break;case"F":f[O][z]=parseFloat(J.trim());break;case"+":case"I":f[O][z]=v?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(J.trim().toUpperCase()){case"Y":case"T":f[O][z]=!0;break;case"N":case"F":f[O][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+J+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[O][z]="##MEMO##"+(v?parseInt(J.trim(),10):j.read_shift(4));break;case"N":J=J.replace(/\u0000/g,"").trim(),J&&J!="."&&(f[O][z]=+J||0);break;case"@":f[O][z]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":f[O][z]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":f[O][z]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[O][z]=-j.read_shift(-8,"f");break;case"B":if(g&&E[z].len==8){f[O][z]=j.read_shift(8,"f");break}case"G":case"P":j.l+=E[z].len;break;case"0":if(E[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[z].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(f=f.slice(0,c.sheetRows)),c.DBF=E,f}function n(o,c){var f=c||{};f.dateNF||(f.dateNF="yyyymmdd");var h=xd(r(o,f),f);return h["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,h}function s(o,c){try{return Kl(n(o,c),c)}catch(f){if(c&&c.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var f=c||{};if(+f.codepage>=0&&ri(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=Bs(),p=ug(o,{header:1,raw:!0,cellDates:!0}),x=p[0],g=p.slice(1),v=o["!cols"]||[],y=0,w=0,_=0,S=1;for(y=0;y<x.length;++y){if(((v[y]||{}).DBF||{}).name){x[y]=v[y].DBF.name,++_;continue}if(x[y]!=null){if(++_,typeof x[y]=="number"&&(x[y]=x[y].toString(10)),typeof x[y]!="string")throw new Error("DBF Invalid column name "+x[y]+" |"+typeof x[y]+"|");if(x.indexOf(x[y])!==y){for(w=0;w<1024;++w)if(x.indexOf(x[y]+"_"+w)==-1){x[y]+="_"+w;break}}}}var E=Gt(o["!ref"]),T=[],k=[],D=[];for(y=0;y<=E.e.c-E.s.c;++y){var O="",z="",j=0,J=[];for(w=0;w<g.length;++w)g[w][y]!=null&&J.push(g[w][y]);if(J.length==0||x[y]==null){T[y]="?";continue}for(w=0;w<J.length;++w){switch(typeof J[w]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=J[w]instanceof Date?"D":"C";break;default:z="C"}j=Math.max(j,String(J[w]).length),O=O&&O!=z?"C":z}j>250&&(j=250),z=((v[y]||{}).DBF||{}).type,z=="C"&&v[y].DBF.len>j&&(j=v[y].DBF.len),O=="B"&&z=="N"&&(O="N",D[y]=v[y].DBF.dec,j=v[y].DBF.len),k[y]=O=="C"||z=="N"?j:a[O]||0,S+=k[y],T[y]=O}var ae=h.next(32);for(ae.write_shift(4,318902576),ae.write_shift(4,g.length),ae.write_shift(2,296+32*_),ae.write_shift(2,S),y=0;y<4;++y)ae.write_shift(4,0);for(ae.write_shift(4,0|(+t[AD]||3)<<8),y=0,w=0;y<x.length;++y)if(x[y]!=null){var F=h.next(32),X=(x[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,X,"sbcs"),F.write_shift(1,T[y]=="?"?"C":T[y],"sbcs"),F.write_shift(4,w),F.write_shift(1,k[y]||a[T[y]]||0),F.write_shift(1,D[y]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),w+=k[y]||a[T[y]]||0}var P=h.next(264);for(P.write_shift(4,13),y=0;y<65;++y)P.write_shift(4,0);for(y=0;y<g.length;++y){var le=h.next(S);for(le.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(T[w]){case"L":le.write_shift(1,g[y][w]==null?63:g[y][w]?84:70);break;case"B":le.write_shift(8,g[y][w]||0,"f");break;case"N":var ee="0";for(typeof g[y][w]=="number"&&(ee=g[y][w].toFixed(D[w]||0)),_=0;_<k[w]-ee.length;++_)le.write_shift(1,32);le.write_shift(1,ee,"sbcs");break;case"D":g[y][w]?(le.write_shift(4,("0000"+g[y][w].getFullYear()).slice(-4),"sbcs"),le.write_shift(2,("00"+(g[y][w].getMonth()+1)).slice(-2),"sbcs"),le.write_shift(2,("00"+g[y][w].getDate()).slice(-2),"sbcs")):le.write_shift(8,"00000000","sbcs");break;case"C":var te=String(g[y][w]!=null?g[y][w]:"").slice(0,k[w]);for(le.write_shift(1,te,"sbcs"),_=0;_<k[w]-te.length;++_)le.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),UI=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Wr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,g){var v=e[g];return typeof v=="number"?O3(v):v},n=function(x,g,v){var y=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return y==59?x:O3(y)};e["|"]=254;function s(x,g){switch(g.type){case"base64":return a(ca(x),g);case"binary":return a(x,g);case"buffer":return a(Ft&&Buffer.isBuffer(x)?x.toString("binary"):Gl(x),g);case"array":return a(Jc(x),g)}throw new Error("Unrecognized type "+g.type)}function a(x,g){var v=x.split(/[\n\r]+/),y=-1,w=-1,_=0,S=0,E=[],T=[],k=null,D={},O=[],z=[],j=[],J=0,ae;for(+g.codepage>=0&&ri(+g.codepage);_!==v.length;++_){J=0;var F=v[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),X=F.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),P=X[0],le;if(F.length>0)switch(P){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&T.push(F.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,te=!1,me=!1,ie=!1,Ee=-1,K=-1;for(S=1;S<X.length;++S)switch(X[S].charAt(0)){case"A":break;case"X":w=parseInt(X[S].slice(1))-1,te=!0;break;case"Y":for(y=parseInt(X[S].slice(1))-1,te||(w=0),ae=E.length;ae<=y;++ae)E[ae]=[];break;case"K":le=X[S].slice(1),le.charAt(0)==='"'?le=le.slice(1,le.length-1):le==="TRUE"?le=!0:le==="FALSE"?le=!1:isNaN(ai(le))?isNaN(Mf(le).getDate())||(le=Tr(le)):(le=ai(le),k!==null&&pd(k)&&(le=C1(le))),ee=!0;break;case"E":ie=!0;var M=yf(X[S].slice(1),{r:y,c:w});E[y][w]=[E[y][w],M];break;case"S":me=!0,E[y][w]=[E[y][w],"S5S"];break;case"G":break;case"R":Ee=parseInt(X[S].slice(1))-1;break;case"C":K=parseInt(X[S].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}if(ee&&(E[y][w]&&E[y][w].length==2?E[y][w][0]=le:E[y][w]=le,k=null),me){if(ie)throw new Error("SYLK shared formula cannot have own formula");var q=Ee>-1&&E[Ee][K];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");E[y][w][1]=sM(q[1],{r:y-Ee,c:w-K})}break;case"F":var G=0;for(S=1;S<X.length;++S)switch(X[S].charAt(0)){case"X":w=parseInt(X[S].slice(1))-1,++G;break;case"Y":for(y=parseInt(X[S].slice(1))-1,ae=E.length;ae<=y;++ae)E[ae]=[];break;case"M":J=parseInt(X[S].slice(1))/20;break;case"F":break;case"G":break;case"P":k=T[parseInt(X[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=X[S].slice(1).split(" "),ae=parseInt(j[0],10);ae<=parseInt(j[1],10);++ae)J=parseInt(j[2],10),z[ae-1]=J===0?{hidden:!0}:{wch:J},Hl(z[ae-1]);break;case"C":w=parseInt(X[S].slice(1))-1,z[w]||(z[w]={});break;case"R":y=parseInt(X[S].slice(1))-1,O[y]||(O[y]={}),J>0?(O[y].hpt=J,O[y].hpx=Pf(J)):J===0&&(O[y].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}G<1&&(k=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}}return O.length>0&&(D["!rows"]=O),z.length>0&&(D["!cols"]=z),g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),[E,D]}function i(x,g){var v=s(x,g),y=v[0],w=v[1],_=xd(y,g);return Wr(w).forEach(function(S){_[S]=w[S]}),_}function o(x,g){return Kl(i(x,g),g)}function c(x,g,v,y){var w="C;Y"+(v+1)+";X"+(y+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+RS(x.f,{r:v,c:y}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function f(x,g){g.forEach(function(v,y){var w="F;W"+(y+1)+" "+(y+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=b0(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=w0(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function h(x,g){g.forEach(function(v,y){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*_0(v.hpx)+";"),w.length>2&&x.push(w+"R"+(y+1))})}function p(x,g){var v=["ID;PWXL;N;E"],y=[],w=Gt(x["!ref"]),_,S=Array.isArray(x),E=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),x["!cols"]&&f(v,x["!cols"]),x["!rows"]&&h(v,x["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var T=w.s.r;T<=w.e.r;++T)for(var k=w.s.c;k<=w.e.c;++k){var D=bt({r:T,c:k});_=S?(x[T]||[])[k]:x[D],!(!_||_.v==null&&(!_.f||_.F))&&y.push(c(_,x,T,k))}return v.join(E)+E+y.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:i,from_sheet:p}})(),zI=(function(){function e(a,i){switch(i.type){case"base64":return t(ca(a),i);case"binary":return t(a,i);case"buffer":return t(Ft&&Buffer.isBuffer(a)?a.toString("binary"):Gl(a),i);case"array":return t(Jc(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,f=-1,h=0,p=[];h!==o.length;++h){if(o[h].trim()==="BOT"){p[++c]=[],f=0;continue}if(!(c<0)){var x=o[h].trim().split(","),g=x[0],v=x[1];++h;for(var y=o[h]||"";(y.match(/["]/g)||[]).length&1&&h<o.length-1;)y+=`
`+o[++h];switch(y=y.trim(),+g){case-1:if(y==="BOT"){p[++c]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[c][f]=!0:y==="FALSE"?p[c][f]=!1:isNaN(ai(v))?isNaN(Mf(v).getDate())?p[c][f]=v:p[c][f]=Tr(v):p[c][f]=ai(v),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[c][f++]=y!==""?y:null;break}if(y==="EOD")break}}return i&&i.sheetRows&&(p=p.slice(0,i.sheetRows)),p}function r(a,i){return xd(e(a,i),i)}function n(a,i){return Kl(r(a,i),i)}var s=(function(){var a=function(c,f,h,p,x){c.push(f),c.push(h+","+p),c.push('"'+x.replace(/"/g,'""')+'"')},i=function(c,f,h,p){c.push(f+","+h),c.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var f=[],h=Gt(c["!ref"]),p,x=Array.isArray(c);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,h.e.r-h.s.r+1,""),a(f,"TUPLES",0,h.e.c-h.s.c+1,""),a(f,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){i(f,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var y=bt({r:g,c:v});if(p=x?(c[g]||[])[v]:c[y],!p){i(f,1,0,"");continue}switch(p.t){case"n":var w=p.w;!w&&p.v!=null&&(w=p.v),w==null?p.f&&!p.F?i(f,1,0,"="+p.f):i(f,1,0,""):i(f,0,w,"V");break;case"b":i(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":i(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ha(p.z||yt[14],wn(Tr(p.v)))),i(f,0,p.w,"V");break;default:i(f,1,0,"")}}}i(f,-1,0,"EOD");var _=`\r
`,S=f.join(_);return S}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),HI=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,x){for(var g=p.split(`
`),v=-1,y=-1,w=0,_=[];w!==g.length;++w){var S=g[w].trim().split(":");if(S[0]==="cell"){var E=Ir(S[1]);if(_.length<=E.r)for(v=_.length;v<=E.r;++v)_[v]||(_[v]=[]);switch(v=E.r,y=E.c,S[2]){case"t":_[v][y]=e(S[3]);break;case"v":_[v][y]=+S[3];break;case"vtf":var T=S[S.length-1];case"vtc":switch(S[3]){case"nl":_[v][y]=!!+S[4];break;default:_[v][y]=+S[4];break}S[2]=="vtf"&&(_[v][y]=[_[v][y],T])}}}return x&&x.sheetRows&&(_=_.slice(0,x.sheetRows)),_}function n(p,x){return xd(r(p,x),x)}function s(p,x){return Kl(n(p,x),x)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var x=[],g=[],v,y="",w=Hs(p["!ref"]),_=Array.isArray(p),S=w.s.r;S<=w.e.r;++S)for(var E=w.s.c;E<=w.e.c;++E)if(y=bt({r:S,c:E}),v=_?(p[S]||[])[E]:p[y],!(!v||v.v==null||v.t==="z")){switch(g=["cell",y,"t"],v.t){case"s":case"str":g.push(t(v.v));break;case"n":v.f?(g[2]="vtf",g[3]="n",g[4]=v.v,g[5]=t(v.f)):(g[2]="v",g[3]=v.v);break;case"b":g[2]="vt"+(v.f?"f":"c"),g[3]="nl",g[4]=v.v?"1":"0",g[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var T=wn(Tr(v.v));g[2]="vtc",g[3]="nd",g[4]=""+T,g[5]=v.w||Ha(v.z||yt[14],T);break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(p){return[a,i,o,i,f(p),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:h}})(),Ff=(function(){function e(h,p,x,g,v){v.raw?p[x][g]=h:h===""||(h==="TRUE"?p[x][g]=!0:h==="FALSE"?p[x][g]=!1:isNaN(ai(h))?isNaN(Mf(h).getDate())?p[x][g]=h:p[x][g]=Tr(h):p[x][g]=ai(h))}function t(h,p){var x=p||{},g=[];if(!h||h.length===0)return g;for(var v=h.split(/[\r\n]/),y=v.length-1;y>=0&&v[y].length===0;)--y;for(var w=10,_=0,S=0;S<=y;++S)_=v[S].indexOf(" "),_==-1?_=v[S].length:_++,w=Math.max(w,_);for(S=0;S<=y;++S){g[S]=[];var E=0;for(e(v[S].slice(0,w).trim(),g,S,E,x),E=1;E<=(v[S].length-w)/10+1;++E)e(v[S].slice(w+(E-1)*10,w+E*10).trim(),g,S,E,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(h){for(var p={},x=!1,g=0,v=0;g<h.length;++g)(v=h.charCodeAt(g))==34?x=!x:!x&&v in r&&(p[v]=(p[v]||0)+1);v=[];for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&v.push([p[g],g]);if(!v.length){p=n;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&v.push([p[g],g])}return v.sort(function(y,w){return y[0]-w[0]||n[y[1]]-n[w[1]]}),r[v.pop()[1]]||44}function a(h,p){var x=p||{},g="",v=x.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=s(h.slice(0,1024)):x&&x.FS?g=x.FS:g=s(h.slice(0,1024));var w=0,_=0,S=0,E=0,T=0,k=g.charCodeAt(0),D=!1,O=0,z=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var j=x.dateNF!=null?zJ(x.dateNF):null;function J(){var ae=h.slice(E,T),F={};if(ae.charAt(0)=='"'&&ae.charAt(ae.length-1)=='"'&&(ae=ae.slice(1,-1).replace(/""/g,'"')),ae.length===0)F.t="z";else if(x.raw)F.t="s",F.v=ae;else if(ae.trim().length===0)F.t="s",F.v=ae;else if(ae.charCodeAt(0)==61)ae.charCodeAt(1)==34&&ae.charCodeAt(ae.length-1)==34?(F.t="s",F.v=ae.slice(2,-1).replace(/""/g,'"')):xne(ae)?(F.t="n",F.f=ae.slice(1)):(F.t="s",F.v=ae);else if(ae=="TRUE")F.t="b",F.v=!0;else if(ae=="FALSE")F.t="b",F.v=!1;else if(!isNaN(S=ai(ae)))F.t="n",x.cellText!==!1&&(F.w=ae),F.v=S;else if(!isNaN(Mf(ae).getDate())||j&&ae.match(j)){F.z=x.dateNF||yt[14];var X=0;j&&ae.match(j)&&(ae=HJ(ae,x.dateNF,ae.match(j)||[]),X=1),x.cellDates?(F.t="d",F.v=Tr(ae,X)):(F.t="n",F.v=wn(Tr(ae,X))),x.cellText!==!1&&(F.w=Ha(F.z,F.v instanceof Date?wn(F.v):F.v)),x.cellNF||delete F.z}else F.t="s",F.v=ae;if(F.t=="z"||(x.dense?(v[w]||(v[w]=[]),v[w][_]=F):v[bt({c:_,r:w})]=F),E=T+1,z=h.charCodeAt(E),y.e.c<_&&(y.e.c=_),y.e.r<w&&(y.e.r=w),O==k)++_;else if(_=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;T<h.length;++T)switch(O=h.charCodeAt(T)){case 34:z===34&&(D=!D);break;case k:case 10:case 13:if(!D&&J())break e;break}return T-E>0&&J(),v["!ref"]=Ct(y),v}function i(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?a(h,p):xd(t(h,p),p)}function o(h,p){var x="",g=p.type=="string"?[0,0,0,0]:LS(h,p);switch(p.type){case"base64":x=ca(h);break;case"binary":x=h;break;case"buffer":p.codepage==65001?x=h.toString("utf8"):p.codepage&&typeof d0<"u"||(x=Ft&&Buffer.isBuffer(h)?h.toString("binary"):Gl(h));break;case"array":x=Jc(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+p.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=dr(x.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?x=dr(x):p.type=="binary"&&typeof d0<"u",x.slice(0,19)=="socialcalc:version:"?HI.to_sheet(p.type=="string"?x:dr(x),p):i(x,p)}function c(h,p){return Kl(o(h,p),p)}function f(h){for(var p=[],x=Gt(h["!ref"]),g,v=Array.isArray(h),y=x.s.r;y<=x.e.r;++y){for(var w=[],_=x.s.c;_<=x.e.c;++_){var S=bt({r:y,c:_});if(g=v?(h[y]||[])[_]:h[S],!g||g.v==null){w.push("          ");continue}for(var E=(g.w||(Io(g),g.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(_===0?" ":""))}p.push(w.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:f}})();function rte(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=UI.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Ff.to_workbook(e,t)}}var Pc=(function(){function e(M,q,G){if(M){qn(M,M.l||0);for(var Z=G.Enum||Ee;M.l<M.length;){var re=M.read_shift(2),L=Z[re]||Z[65535],I=M.read_shift(2),se=M.l+I,Q=L.f&&L.f(M,I,G);if(M.l=se,q(Q,L,re))return}}}function t(M,q){switch(q.type){case"base64":return r(na(ca(M)),q);case"binary":return r(na(M),q);case"buffer":case"array":return r(M,q)}throw"Unsupported type "+q.type}function r(M,q){if(!M)return M;var G=q||{},Z=G.dense?[]:{},re="Sheet1",L="",I=0,se={},Q=[],Y=[],U={s:{r:0,c:0},e:{r:0,c:0}},we=G.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)G.Enum=Ee,e(M,function(C,A,H){switch(H){case 0:G.vers=C,C>=4096&&(G.qpro=!0);break;case 6:U=C;break;case 204:C&&(L=C);break;case 222:L=C;break;case 15:case 51:G.qpro||(C[1].v=C[1].v.slice(1));case 13:case 14:case 16:H==14&&(C[2]&112)==112&&(C[2]&15)>1&&(C[2]&15)<15&&(C[1].z=G.dateNF||yt[14],G.cellDates&&(C[1].t="d",C[1].v=C1(C[1].v))),G.qpro&&C[3]>I&&(Z["!ref"]=Ct(U),se[re]=Z,Q.push(re),Z=G.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},I=C[3],re=L||"Sheet"+(I+1),L="");var ue=G.dense?(Z[C[0].r]||[])[C[0].c]:Z[bt(C[0])];if(ue){ue.t=C[1].t,ue.v=C[1].v,C[1].z!=null&&(ue.z=C[1].z),C[1].f!=null&&(ue.f=C[1].f);break}G.dense?(Z[C[0].r]||(Z[C[0].r]=[]),Z[C[0].r][C[0].c]=C[1]):Z[bt(C[0])]=C[1];break}},G);else if(M[2]==26||M[2]==14)G.Enum=K,M[2]==14&&(G.qpro=!0,M.l=0),e(M,function(C,A,H){switch(H){case 204:re=C;break;case 22:C[1].v=C[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(C[3]>I&&(Z["!ref"]=Ct(U),se[re]=Z,Q.push(re),Z=G.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},I=C[3],re="Sheet"+(I+1)),we>0&&C[0].r>=we)break;G.dense?(Z[C[0].r]||(Z[C[0].r]=[]),Z[C[0].r][C[0].c]=C[1]):Z[bt(C[0])]=C[1],U.e.c<C[0].c&&(U.e.c=C[0].c),U.e.r<C[0].r&&(U.e.r=C[0].r);break;case 27:C[14e3]&&(Y[C[14e3][0]]=C[14e3][1]);break;case 1537:Y[C[0]]=C[1],C[0]==I&&(re=C[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(Z["!ref"]=Ct(U),se[L||re]=Z,Q.push(L||re),!Y.length)return{SheetNames:Q,Sheets:se};for(var B={},be=[],V=0;V<Y.length;++V)se[Q[V]]?(be.push(Y[V]||Q[V]),B[Y[V]]=se[Y[V]]||se[Q[V]]):(be.push(Y[V]),B[Y[V]]={"!ref":"A1"});return{SheetNames:be,Sheets:B}}function n(M,q){var G=q||{};if(+G.codepage>=0&&ri(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=Bs(),re=Gt(M["!ref"]),L=Array.isArray(M),I=[];et(Z,0,a(1030)),et(Z,6,c(re));for(var se=Math.min(re.e.r,8191),Q=re.s.r;Q<=se;++Q)for(var Y=Jr(Q),U=re.s.c;U<=re.e.c;++U){Q===re.s.r&&(I[U]=Dr(U));var we=I[U]+Y,B=L?(M[Q]||[])[U]:M[we];if(!(!B||B.t=="z"))if(B.t=="n")(B.v|0)==B.v&&B.v>=-32768&&B.v<=32767?et(Z,13,g(Q,U,B.v)):et(Z,14,y(Q,U,B.v));else{var be=Io(B);et(Z,15,p(Q,U,be.slice(0,239)))}}return et(Z,1),Z.end()}function s(M,q){var G=q||{};if(+G.codepage>=0&&ri(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=Bs();et(Z,0,i(M));for(var re=0,L=0;re<M.SheetNames.length;++re)(M.Sheets[M.SheetNames[re]]||{})["!ref"]&&et(Z,27,ie(M.SheetNames[re],L++));var I=0;for(re=0;re<M.SheetNames.length;++re){var se=M.Sheets[M.SheetNames[re]];if(!(!se||!se["!ref"])){for(var Q=Gt(se["!ref"]),Y=Array.isArray(se),U=[],we=Math.min(Q.e.r,8191),B=Q.s.r;B<=we;++B)for(var be=Jr(B),V=Q.s.c;V<=Q.e.c;++V){B===Q.s.r&&(U[V]=Dr(V));var C=U[V]+be,A=Y?(se[B]||[])[V]:se[C];if(!(!A||A.t=="z"))if(A.t=="n")et(Z,23,J(B,V,I,A.v));else{var H=Io(A);et(Z,22,O(B,V,I,H.slice(0,239)))}}++I}}return et(Z,1),Z.end()}function a(M){var q=Le(2);return q.write_shift(2,M),q}function i(M){var q=Le(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var G=0,Z=0,re=0,L=0;L<M.SheetNames.length;++L){var I=M.SheetNames[L],se=M.Sheets[I];if(!(!se||!se["!ref"])){++re;var Q=Hs(se["!ref"]);G<Q.e.r&&(G=Q.e.r),Z<Q.e.c&&(Z=Q.e.c)}}return G>8191&&(G=8191),q.write_shift(2,G),q.write_shift(1,re),q.write_shift(1,Z),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(M,q,G){var Z={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&G.qpro?(Z.s.c=M.read_shift(1),M.l++,Z.s.r=M.read_shift(2),Z.e.c=M.read_shift(1),M.l++,Z.e.r=M.read_shift(2),Z):(Z.s.c=M.read_shift(2),Z.s.r=M.read_shift(2),q==12&&G.qpro&&(M.l+=2),Z.e.c=M.read_shift(2),Z.e.r=M.read_shift(2),q==12&&G.qpro&&(M.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function c(M){var q=Le(8);return q.write_shift(2,M.s.c),q.write_shift(2,M.s.r),q.write_shift(2,M.e.c),q.write_shift(2,M.e.r),q}function f(M,q,G){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(Z[0].c=M.read_shift(1),Z[3]=M.read_shift(1),Z[0].r=M.read_shift(2),M.l+=2):(Z[2]=M.read_shift(1),Z[0].c=M.read_shift(2),Z[0].r=M.read_shift(2)),Z}function h(M,q,G){var Z=M.l+q,re=f(M,q,G);if(re[1].t="s",G.vers==20768){M.l++;var L=M.read_shift(1);return re[1].v=M.read_shift(L,"utf8"),re}return G.qpro&&M.l++,re[1].v=M.read_shift(Z-M.l,"cstr"),re}function p(M,q,G){var Z=Le(7+G.length);Z.write_shift(1,255),Z.write_shift(2,q),Z.write_shift(2,M),Z.write_shift(1,39);for(var re=0;re<Z.length;++re){var L=G.charCodeAt(re);Z.write_shift(1,L>=128?95:L)}return Z.write_shift(1,0),Z}function x(M,q,G){var Z=f(M,q,G);return Z[1].v=M.read_shift(2,"i"),Z}function g(M,q,G){var Z=Le(7);return Z.write_shift(1,255),Z.write_shift(2,q),Z.write_shift(2,M),Z.write_shift(2,G,"i"),Z}function v(M,q,G){var Z=f(M,q,G);return Z[1].v=M.read_shift(8,"f"),Z}function y(M,q,G){var Z=Le(13);return Z.write_shift(1,255),Z.write_shift(2,q),Z.write_shift(2,M),Z.write_shift(8,G,"f"),Z}function w(M,q,G){var Z=M.l+q,re=f(M,q,G);if(re[1].v=M.read_shift(8,"f"),G.qpro)M.l=Z;else{var L=M.read_shift(2);T(M.slice(M.l,M.l+L),re),M.l+=L}return re}function _(M,q,G){var Z=q&32768;return q&=-32769,q=(Z?M:0)+(q>=8192?q-16384:q),(Z?"":"$")+(G?Dr(q):Jr(q))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(M,q){qn(M,0);for(var G=[],Z=0,re="",L="",I="",se="";M.l<M.length;){var Q=M[M.l++];switch(Q){case 0:G.push(M.read_shift(8,"f"));break;case 1:L=_(q[0].c,M.read_shift(2),!0),re=_(q[0].r,M.read_shift(2),!1),G.push(L+re);break;case 2:{var Y=_(q[0].c,M.read_shift(2),!0),U=_(q[0].r,M.read_shift(2),!1);L=_(q[0].c,M.read_shift(2),!0),re=_(q[0].r,M.read_shift(2),!1),G.push(Y+U+":"+L+re)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(M.read_shift(2));break;case 6:{for(var we="";Q=M[M.l++];)we+=String.fromCharCode(Q);G.push('"'+we.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:se=G.pop(),I=G.pop(),G.push(["AND","OR"][Q-20]+"("+I+","+se+")");break;default:if(Q<32&&E[Q])se=G.pop(),I=G.pop(),G.push(I+E[Q]+se);else if(S[Q]){if(Z=S[Q][1],Z==69&&(Z=M[M.l++]),Z>G.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+G.join("|")+"|");return}var B=G.slice(-Z);G.length-=Z,G.push(S[Q][0]+"("+B.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}G.length==1?q[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function k(M){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=M.read_shift(2),q[3]=M[M.l++],q[0].c=M[M.l++],q}function D(M,q){var G=k(M);return G[1].t="s",G[1].v=M.read_shift(q-4,"cstr"),G}function O(M,q,G,Z){var re=Le(6+Z.length);re.write_shift(2,M),re.write_shift(1,G),re.write_shift(1,q),re.write_shift(1,39);for(var L=0;L<Z.length;++L){var I=Z.charCodeAt(L);re.write_shift(1,I>=128?95:I)}return re.write_shift(1,0),re}function z(M,q){var G=k(M);G[1].v=M.read_shift(2);var Z=G[1].v>>1;if(G[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return G[1].v=Z,G}function j(M,q){var G=k(M),Z=M.read_shift(4),re=M.read_shift(4),L=M.read_shift(2);if(L==65535)return Z===0&&re===3221225472?(G[1].t="e",G[1].v=15):Z===0&&re===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var I=L&32768;return L=(L&32767)-16446,G[1].v=(1-I*2)*(re*Math.pow(2,L+32)+Z*Math.pow(2,L)),G}function J(M,q,G,Z){var re=Le(14);if(re.write_shift(2,M),re.write_shift(1,G),re.write_shift(1,q),Z==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var L=0,I=0,se=0,Q=0;return Z<0&&(L=1,Z=-Z),I=Math.log2(Z)|0,Z/=Math.pow(2,I-31),Q=Z>>>0,(Q&2147483648)==0&&(Z/=2,++I,Q=Z>>>0),Z-=Q,Q|=2147483648,Q>>>=0,Z*=Math.pow(2,32),se=Z>>>0,re.write_shift(4,se),re.write_shift(4,Q),I+=16383+(L?32768:0),re.write_shift(2,I),re}function ae(M,q){var G=j(M);return M.l+=q-14,G}function F(M,q){var G=k(M),Z=M.read_shift(4);return G[1].v=Z>>6,G}function X(M,q){var G=k(M),Z=M.read_shift(8,"f");return G[1].v=Z,G}function P(M,q){var G=X(M);return M.l+=q-10,G}function le(M,q){return M[M.l+q-1]==0?M.read_shift(q,"cstr"):""}function ee(M,q){var G=M[M.l++];G>q-1&&(G=q-1);for(var Z="";Z.length<G;)Z+=String.fromCharCode(M[M.l++]);return Z}function te(M,q,G){if(!(!G.qpro||q<21)){var Z=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var re=M.read_shift(q-21,"cstr");return[Z,re]}}function me(M,q){for(var G={},Z=M.l+q;M.l<Z;){var re=M.read_shift(2);if(re==14e3){for(G[re]=[0,""],G[re][0]=M.read_shift(2);M[M.l];)G[re][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return G}function ie(M,q){var G=Le(5+M.length);G.write_shift(2,14e3),G.write_shift(2,q);for(var Z=0;Z<M.length;++Z){var re=M.charCodeAt(Z);G[G.l++]=re>127?95:re}return G[G.l++]=0,G}var Ee={0:{n:"BOF",f:mn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:le},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:ae},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:P},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:le},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function nte(e){var t={},r=e.match(ps),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=_t(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=tS[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var ste=(function(){var e=m0("t"),t=m0("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:$t(i[1])},c=a.match(t);return c&&(o.s=nte(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),ate=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),ite=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ote=/<(?:\w+:)?r>/,lte=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function NS(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=$t(dr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=dr(e),r&&(n.h=fS(n.t))):e.match(ote)&&(n.r=dr(e),n.t=$t(dr((e.replace(lte,"").match(ite)||[]).join("").replace(ps,""))),r&&(n.h=ate(ste(n.r)))),n):{t:""}}var cte=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ute=/<(?:\w+:)?(?:si|sstItem)>/g,fte=/<\/(?:\w+:)?(?:si|sstItem)>/;function dte(e,t){var r=[],n="";if(!e)return r;var s=e.match(cte);if(s){n=s[2].replace(ute,"").split(fte);for(var a=0;a!=n.length;++a){var i=NS(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=_t(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var hte=/^\s|\s$|[\t\n\r]/;function VI(e,t){if(!t.bookSST)return"";var r=[Qr];r[r.length]=Qe("sst",null,{xmlns:cu[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(hte)&&(a+=' xml:space="preserve"'),a+=">"+sr(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function pte(e){return[e.read_shift(4),e.read_shift(4)]}function mte(e,t){var r=[],n=!1;return Bo(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function xte(e,t){return t||(t=Le(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var gte=kZ;function yte(e){var t=Bs();qe(t,159,xte(e));for(var r=0;r<e.length;++r)qe(t,19,gte(e[r]));return qe(t,160),t.end()}function qI(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ao(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function vte(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ao(e,4),t.U=Ao(e,4),t.W=Ao(e,4),t}function bte(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function wte(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(bte(e));return t}function _te(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Ete(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ao(e,4),t.U=Ao(e,4),t.W=Ao(e,4),t}function Ste(e){var t=Ete(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function WI(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function $I(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Nte(e){var t=Ao(e);switch(t.Minor){case 2:return[t.Minor,Tte(e)];case 3:return[t.Minor,kte()];case 4:return[t.Minor,Ate(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Tte(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=WI(e,r),s=$I(e,e.length-e.l);return{t:"Std",h:n,v:s}}function kte(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Ate(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ps,function(a){var i=_t(a);switch(zi(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Cte(e,t){var r={},n=r.EncryptionVersionInfo=Ao(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=WI(e,s),t-=s,r.EncryptionVerifier=$I(e,t),r}function Rte(e){var t={},r=t.EncryptionVersionInfo=Ao(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function TS(e){var t=0,r,n=qI(e),s=n.length+1,a,i,o,c,f;for(r=zl(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=(t&16384)===0?0:1,c=t<<1&32767,f=o|c,t=f^i;return t^52811}var GI=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,f=i.length-1;f>=0;--f)for(var h=i[f],p=0;p!=7;++p)h&64&&(o^=r[c]),h*=2,--c;return o};return function(i){for(var o=qI(i),c=a(o),f=o.length,h=zl(16),p=0;p!=16;++p)h[p]=0;var x,g,v;for((f&1)===1&&(x=c>>8,h[f]=s(e[0],x),--f,x=c&255,g=o[o.length-1],h[f]=s(g,x));f>0;)--f,x=c>>8,h[f]=s(o[f],x),--f,x=c&255,h[f]=s(o[f],x);for(f=15,v=15-o.length;v>0;)x=c>>8,h[f]=s(e[v],x),--f,--v,x=c&255,h[f]=s(o[f],x),--f,--v;return h}})(),Ote=function(e,t,r,n,s){s||(s=t),n||(n=GI(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},jte=function(e){var t=0,r=GI(e);return function(n){var s=Ote("",n,t,r);return t=s[1],s[0]}};function Dte(e,t,r,n){var s={key:mn(e),verificationBytes:mn(e)};return r.password&&(s.verifier=TS(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=jte(r.password)),s}function Ite(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Rte(e):n.Data=Cte(e,t),n}function Mte(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Ite(e,t-2,n):Dte(e,r.biff>=8?t:t-2,r,n),n}var KI=(function(){function e(s,a){switch(a.type){case"base64":return t(ca(s),a);case"binary":return t(s,a);case"buffer":return t(Ft&&Buffer.isBuffer(s)?s.toString("binary"):Gl(s),a);case"array":return t(Jc(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,p){Array.isArray(o)&&(o[p]=[]);for(var x=/\\\w+\b/g,g=0,v,y=-1;v=x.exec(h);){switch(v[0]){case"\\cell":var w=h.slice(g,x.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++y,w.length){var _={v:w,t:"s"};Array.isArray(o)?o[p][y]=_:o[bt({r:p,c:y})]=_}break}g=x.lastIndex}y>f.e.c&&(f.e.c=y)}),o["!ref"]=Ct(f),o}function r(s,a){return Kl(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Gt(s["!ref"]),o,c=Array.isArray(s),f=i.s.r;f<=i.e.r;++f){a.push("\\trowd\\trautofit1");for(var h=i.s.c;h<=i.e.c;++h)a.push("\\cellx"+(h+1));for(a.push("\\pard\\intbl"),h=i.s.c;h<=i.e.c;++h){var p=bt({r:f,c:h});o=c?(s[f]||[])[h]:s[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Io(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Fte(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function v0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Pte(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,f=s+a;switch(c=i/(f>1?2-f:f),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,f/2]}function Lte(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var f=0;f!=3;++f)i[f]=Math.round(i[f]*255);return i}function og(e,t){if(t===0)return e;var r=Pte(Fte(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),v0(Lte(r))}var XI=6,Bte=15,Ute=1,ls=XI;function b0(e){return Math.floor((e+Math.round(128/ls)/256)*ls)}function w0(e){return Math.floor((e-5)/ls*100+.5)/100}function lg(e){return Math.round((e*ls+5)/ls*256)/256}function Db(e){return lg(w0(b0(e)))}function kS(e){var t=Math.abs(e-Db(e)),r=ls;if(t>.005)for(ls=Ute;ls<Bte;++ls)Math.abs(e-Db(e))<=t&&(t=Math.abs(e-Db(e)),r=ls);ls=r}function Hl(e){e.width?(e.wpx=b0(e.width),e.wch=w0(e.wpx),e.MDW=ls):e.wpx?(e.wch=w0(e.wpx),e.width=lg(e.wch),e.MDW=ls):typeof e.wch=="number"&&(e.width=lg(e.wch),e.wpx=b0(e.width),e.MDW=ls),e.customWidth&&delete e.customWidth}var zte=96,YI=zte;function _0(e){return e*96/YI}function Pf(e){return e*YI/96}var Hte={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Vte(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(ps)||[]).forEach(function(i){var o=_t(i);switch(zi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Nr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Nr(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function qte(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(ps)||[]).forEach(function(i){var o=_t(i);switch(zi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function Wte(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(ps)||[]).forEach(function(i){var o=_t(i);switch(zi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=dr(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Nr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Nr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Nr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Nr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Nr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Nr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Nr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=tS[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Nr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Mc[s.color.index];s.color.index==81&&(c=Mc[1]),c||(c=Mc[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=og(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function $te(e,t,r){t.NumberFmt=[];for(var n=Wr(yt),s=0;s<n.length;++s)t.NumberFmt[n[s]]=yt[n[s]];var a=e[0].match(ps);if(a)for(s=0;s<a.length;++s){var i=_t(a[s]);switch(zi(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=$t(dr(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}ko(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Gte(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Qe("numFmt",null,{numFmtId:n,formatCode:sr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Qe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Gm=["numFmtId","fillId","fontId","borderId","xfId"],Km=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Kte(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(ps)||[]).forEach(function(a){var i=_t(a),o=0;switch(zi(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Gm.length;++o)n[Gm[o]]&&(n[Gm[o]]=parseInt(n[Gm[o]],10));for(o=0;o<Km.length;++o)n[Km[o]]&&(n[Km[o]]=Nr(n[Km[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Nr(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function Xte(e){var t=[];return t[t.length]=Qe("cellXfs",null),e.forEach(function(r){t[t.length]=Qe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Qe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Yte=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,f){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&$te(p,h,f),(p=o.match(s))&&Wte(p,h,c,f),(p=o.match(n))&&qte(p,h,c,f),(p=o.match(a))&&Vte(p,h,c,f),(p=o.match(r))&&Kte(p,h,f),h}})();function JI(e,t){var r=[Qr,Qe("styleSheet",null,{xmlns:cu[0],"xmlns:vt":bn.vt})],n;return e.SSF&&(n=Gte(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Xte(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Jte(e,t){var r=e.read_shift(2),n=fs(e);return[r,n]}function Zte(e,t,r){r||(r=Le(6+4*t.length)),r.write_shift(2,e),In(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Qte(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=IZ(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=DZ(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=fs(e),n}function ere(e,t){t||(t=Le(153)),t.write_shift(2,e.sz*20),MZ(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),sg(e.color,t);var n=0;return n=2,t.write_shift(1,n),In(e.name,t),t.length>t.l?t.slice(0,t.l):t}var tre=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ib,rre=ds;function w5(e,t){t||(t=Le(84)),Ib||(Ib=k1(tre));var r=Ib[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(sg({auto:1},t),sg({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function nre(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function ZI(e,t,r){r||(r=Le(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function mh(e,t){return t||(t=Le(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var sre=ds;function are(e,t){return t||(t=Le(51)),t.write_shift(1,0),mh(null,t),mh(null,t),mh(null,t),mh(null,t),mh(null,t),t.length>t.l?t.slice(0,t.l):t}function ire(e,t){return t||(t=Le(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),ng(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function ore(e,t,r){var n=Le(2052);return n.write_shift(4,e),ng(t,n),ng(r,n),n.length>n.l?n.slice(0,n.l):n}function lre(e,t,r){var n={};n.NumberFmt=[];for(var s in yt)n.NumberFmt[s]=yt[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Bo(e,function(c,f,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],ko(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=og(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(h),i=!0;break;case 38:a.pop(),i=!1;break;default:if(f.T>0)a.push(h);else if(f.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function cre(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(qe(e,615,ii(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&qe(e,44,Zte(s,t[s]))}),qe(e,616))}}function ure(e){var t=1;qe(e,611,ii(t)),qe(e,43,ere({sz:12,color:{theme:1},name:"Calibri",family:2})),qe(e,612)}function fre(e){var t=2;qe(e,603,ii(t)),qe(e,45,w5({patternType:"none"})),qe(e,45,w5({patternType:"gray125"})),qe(e,604)}function dre(e){var t=1;qe(e,613,ii(t)),qe(e,46,are()),qe(e,614)}function hre(e){var t=1;qe(e,626,ii(t)),qe(e,47,ZI({numFmtId:0},65535)),qe(e,627)}function pre(e,t){qe(e,617,ii(t.length)),t.forEach(function(r){qe(e,47,ZI(r,0))}),qe(e,618)}function mre(e){var t=1;qe(e,619,ii(t)),qe(e,48,ire({xfId:0,name:"Normal"})),qe(e,620)}function xre(e){var t=0;qe(e,505,ii(t)),qe(e,506)}function gre(e){var t=0;qe(e,508,ore(t,"TableStyleMedium9","PivotStyleMedium4")),qe(e,509)}function yre(e,t){var r=Bs();return qe(r,278),cre(r,e.SSF),ure(r),fre(r),dre(r),hre(r),pre(r,t.cellXfs),mre(r),xre(r),gre(r),qe(r,279),r.end()}var vre=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function bre(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ps)||[]).forEach(function(s){var a=_t(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[vre.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function wre(){}function _re(){}var Ere=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Sre=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Nre=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Tre(e,t,r){t.themeElements={};var n;[["clrScheme",Ere,bre],["fontScheme",Sre,wre],["fmtScheme",Nre,_re]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var kre=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function QI(e,t){(!e||e.length===0)&&(e=AS());var r,n={};if(!(r=e.match(kre)))throw new Error("themeElements not found in theme");return Tre(r[0],n,t),n.raw=e,n}function AS(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Qr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Are(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=WD(a,{type:"array"})}catch{return}var o=sa(i,"theme/theme/theme1.xml",!0);if(o)return QI(o,r)}}function Cre(e){return e.read_shift(4)}function Rre(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Ore(e,4);break;case 2:t.xclrValue=jI(e);break;case 3:t.xclrValue=Cre(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Ore(e,t){return ds(e,t)}function jre(e,t){return ds(e,t)}function Dre(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Rre(e);break;case 6:n[1]=jre(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Ire(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(Dre(e,r-e.l));return{ixfe:n,ext:a}}function Mre(e,t){t.forEach(function(r){r[0]})}function Fre(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:fs(e)}}function Pre(e){var t=Le(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),In(e.name,t),t.slice(0,t.l)}function Lre(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Bre(e){var t=Le(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Ure(e,t){var r=Le(8+2*t.length);return r.write_shift(4,e),In(t,r),r.slice(0,r.l)}function zre(e){return e.l+=4,e.read_shift(4)!=0}function Hre(e,t){var r=Le(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Vre(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return Bo(e,function(c,f,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(h),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!f.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function qre(){var e=Bs();return qe(e,332),qe(e,334,ii(1)),qe(e,335,Pre({name:"XLDAPR",version:12e4,flags:3496657072})),qe(e,336),qe(e,339,Ure(1,"XLDAPR")),qe(e,52),qe(e,35,ii(514)),qe(e,4096,ii(0)),qe(e,4097,Ia(1)),qe(e,36),qe(e,53),qe(e,340),qe(e,337,Hre(1)),qe(e,51,Bre([[1,0]])),qe(e,338),qe(e,333),e.end()}function Wre(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(ps,function(o){var c=_t(o);switch(zi(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==c.name&&(i=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function eM(){var e=[Qr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function $re(e){var t=[];if(!e)return t;var r=1;return(e.match(ps)||[]).forEach(function(n){var s=_t(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Gre(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=bt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Kre(e,t,r){var n=[];return Bo(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Xre(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Bo(e,function(o,c,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},s)}function Yre(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var pf=1024;function tM(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Qe("xml",null,{"xmlns:v":ta.v,"xmlns:o":ta.o,"xmlns:x":ta.x,"xmlns:mv":ta.mv}).replace(/\/>/,">"),Qe("o:shapelayout",Qe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Qe("v:shapetype",[Qe("v:stroke",null,{joinstyle:"miter"}),Qe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];pf<e*1e3;)pf+=1e3;return t.forEach(function(a){var i=Ir(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Qe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Qe("v:fill",c,o),h={on:"t",obscured:"t"};++pf,s=s.concat(["<v:shape"+x0({id:"_x0000_s"+pf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Qe("v:shadow",null,h),Qe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Gn("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Gn("x:AutoFill","False"),Gn("x:Row",String(i.r)),Gn("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function _5(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Ir(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=Gt(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var f=Ct(c);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var h={a:i.author,t:i.t,r:i.r,T:r};i.h&&(h.h=i.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(h.a==n[p].id){h.a=n[p].name||h.a;break}}a.c.push(h)})}function Jre(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=_t(o[0]),f={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=Ir(c.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var p=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!p&&!!p[1]&&NS(p[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),n.push(f)}}}}),n}function rM(e){var t=[Qr,Qe("comments",null,{xmlns:cu[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=sr(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(sr(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Gn("t",sr(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(Gn("t",sr(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Zre(e,t){var r=[],n=!1,s={},a=0;return e.replace(ps,function(o,c){var f=_t(o);switch(zi(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function Qre(e,t,r){var n=[Qr,Qe("ThreadedComments",null,{xmlns:bn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Qe("threadedComment",Gn("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function ene(e,t){var r=[],n=!1;return e.replace(ps,function(a){var i=_t(a);switch(zi(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function tne(e){var t=[Qr,Qe("personList",null,{xmlns:bn.TCMNT,"xmlns:x":cu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Qe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function rne(e){var t={};t.iauthor=e.read_shift(4);var r=hu(e);return t.rfx=r.s,t.ref=bt(r.s),e.l+=16,t}function nne(e,t){return t==null&&(t=Le(36)),t.write_shift(4,e[1].iauthor),gd(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var sne=fs;function ane(e){return In(e.slice(0,54))}function ine(e,t){var r=[],n=[],s={},a=!1;return Bo(e,function(o,c,f){switch(f){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function one(e){var t=Bs(),r=[];return qe(t,628),qe(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),qe(t,632,ane(s.a)))})}),qe(t,631),qe(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Ir(n[0]),e:Ir(n[0])};qe(t,635,nne([a,s])),s.t&&s.t.length>0&&qe(t,637,CZ(s)),qe(t,636),delete s.iauthor})}),qe(t,634),qe(t,629),t.end()}var lne="application/vnd.ms-office.vbaProject";function cne(e){var t=mt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");mt.utils.cfb_add(t,s,e.FileIndex[n].content)}}),mt.write(t)}function une(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&mt.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var nM=["xlsb","xlsm","xlam","biff8","xla"];function fne(){return{"!type":"dialog"}}function dne(){return{"!type":"dialog"}}function hne(){return{"!type":"macro"}}function pne(){return{"!type":"macro"}}var yf=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,h=i.length>0?parseInt(i,10)|0:0;return o?h+=t.c:--h,c?f+=t.r:--f,s+(o?"":"$")+Dr(h)+(c?"":"$")+Jr(f)}return function(s,a){return t=a,s.replace(e,r)}})(),CS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,RS=(function(){return function(t,r){return t.replace(CS,function(n,s,a,i,o,c){var f=xS(i)-(a?0:r.c),h=mS(c)-(o?0:r.r),p=h==0?"":o?h+1:"["+h+"]",x=f==0?"":a?f+1:"["+f+"]";return s+"R"+p+"C"+x})}})();function sM(e,t){return e.replace(CS,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Dr(xS(a)+t.c))+(i=="$"?i+o:Jr(mS(o)+t.r))})}function mne(e,t,r){var n=Hs(t),s=n.s,a=Ir(r),i={r:a.r-s.r,c:a.c-s.c};return sM(e,i)}function xne(e){return e.length!=1}function E5(e){return e.replace(/_xlfn\./g,"")}function un(e){e.l+=1}function Vl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function aM(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return iM(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Vl(e),o=Vl(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function iM(e){var t=Vl(e),r=Vl(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function gne(e,t,r){if(r.biff<8)return iM(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Vl(e),i=Vl(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function oM(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return yne(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Vl(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function yne(e){var t=Vl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function vne(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function bne(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return wne(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function wne(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function _ne(e,t,r){var n=(e[e.l++]&96)>>5,s=aM(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Ene(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=aM(e,a,r);return[n,s,i]}function Sne(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Nne(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function Tne(e,t,r){var n=(e[e.l++]&96)>>5,s=gne(e,t-1,r);return[n,s]}function kne(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function S5(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Ane(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Cne(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Rne(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function One(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function jne(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function lM(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Dne(e){return e.read_shift(2),lM(e)}function Ine(e){return e.read_shift(2),lM(e)}function Mne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=oM(e,0,r);return[n,s]}function Fne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=bne(e,0,r);return[n,s]}function Pne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=oM(e,0,r);return[n,s,a]}function Lne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[zse[s],fM[s],n]}function Bne(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Une(e);return[s,(a[0]===0?fM:Use)[a[1]]]}function Une(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function zne(e,t,r){e.l+=r&&r.biff==2?3:4}function Hne(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Vne(e){return e.l++,Uo[e.read_shift(1)]}function qne(e){return e.l++,e.read_shift(2)}function Wne(e){return e.l++,e.read_shift(1)!==0}function $ne(e){return e.l++,us(e)}function Gne(e,t,r){return e.l++,rp(e,t-1,r)}function Kne(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Kr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Uo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=us(e);break;case 2:r[1]=pu(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Xne(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?hu:R1)(e));return s}function Yne(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=Kne(e,r.biff);return i}function Jne(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function Zne(e,t,r){if(r.biff==5)return Qne(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function Qne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function ese(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function tse(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function rse(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function nse(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var sse=ds,ase=ds,ise=ds;function sp(e,t,r){return e.l+=2,[vne(e)]}function OS(e){return e.l+=6,[]}var ose=sp,lse=OS,cse=OS,use=sp;function cM(e){return e.l+=2,[mn(e),e.read_shift(2)&1]}var fse=sp,dse=cM,hse=OS,pse=sp,mse=sp,xse=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gse(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=xse[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function yse(e){return e.l+=2,[e.read_shift(4)]}function vse(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function bse(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function wse(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function _se(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Ese(e){return e.l+=4,[0,0]}var N5={1:{n:"PtgExp",f:Hne},2:{n:"PtgTbl",f:ise},3:{n:"PtgAdd",f:un},4:{n:"PtgSub",f:un},5:{n:"PtgMul",f:un},6:{n:"PtgDiv",f:un},7:{n:"PtgPower",f:un},8:{n:"PtgConcat",f:un},9:{n:"PtgLt",f:un},10:{n:"PtgLe",f:un},11:{n:"PtgEq",f:un},12:{n:"PtgGe",f:un},13:{n:"PtgGt",f:un},14:{n:"PtgNe",f:un},15:{n:"PtgIsect",f:un},16:{n:"PtgUnion",f:un},17:{n:"PtgRange",f:un},18:{n:"PtgUplus",f:un},19:{n:"PtgUminus",f:un},20:{n:"PtgPercent",f:un},21:{n:"PtgParen",f:un},22:{n:"PtgMissArg",f:un},23:{n:"PtgStr",f:Gne},26:{n:"PtgSheet",f:vse},27:{n:"PtgEndSheet",f:bse},28:{n:"PtgErr",f:Vne},29:{n:"PtgBool",f:Wne},30:{n:"PtgInt",f:qne},31:{n:"PtgNum",f:$ne},32:{n:"PtgArray",f:kne},33:{n:"PtgFunc",f:Lne},34:{n:"PtgFuncVar",f:Bne},35:{n:"PtgName",f:Jne},36:{n:"PtgRef",f:Mne},37:{n:"PtgArea",f:_ne},38:{n:"PtgMemArea",f:ese},39:{n:"PtgMemErr",f:sse},40:{n:"PtgMemNoMem",f:ase},41:{n:"PtgMemFunc",f:tse},42:{n:"PtgRefErr",f:rse},43:{n:"PtgAreaErr",f:Sne},44:{n:"PtgRefN",f:Fne},45:{n:"PtgAreaN",f:Tne},46:{n:"PtgMemAreaN",f:wse},47:{n:"PtgMemNoMemN",f:_se},57:{n:"PtgNameX",f:Zne},58:{n:"PtgRef3d",f:Pne},59:{n:"PtgArea3d",f:Ene},60:{n:"PtgRefErr3d",f:nse},61:{n:"PtgAreaErr3d",f:Nne},255:{}},Sse={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Nse={1:{n:"PtgElfLel",f:cM},2:{n:"PtgElfRw",f:pse},3:{n:"PtgElfCol",f:ose},6:{n:"PtgElfRwV",f:mse},7:{n:"PtgElfColV",f:use},10:{n:"PtgElfRadical",f:fse},11:{n:"PtgElfRadicalS",f:hse},13:{n:"PtgElfColS",f:lse},15:{n:"PtgElfColSV",f:cse},16:{n:"PtgElfRadicalLel",f:dse},25:{n:"PtgList",f:gse},29:{n:"PtgSxName",f:yse},255:{}},Tse={0:{n:"PtgAttrNoop",f:Ese},1:{n:"PtgAttrSemi",f:jne},2:{n:"PtgAttrIf",f:Rne},4:{n:"PtgAttrChoose",f:Ane},8:{n:"PtgAttrGoto",f:Cne},16:{n:"PtgAttrSum",f:zne},32:{n:"PtgAttrBaxcel",f:S5},33:{n:"PtgAttrBaxcel",f:S5},64:{n:"PtgAttrSpace",f:Dne},65:{n:"PtgAttrSpaceSemi",f:Ine},128:{n:"PtgAttrIfError",f:One},255:{}};function ap(e,t,r,n){if(n.biff<8)return ds(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Yne(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Xne(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(ds(e,t)),a}function ip(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=N5[a]||N5[Sse[a]],(a===24||a===25)&&(s=(a===24?Nse:Tse)[e[e.l+1]]),!s||!s.f?ds(e,t):i.push([s.n,s.f(e,t,r)]);return i}function kse(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Ase={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Cse(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function uM(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function T5(e,t,r){var n=uM(e,t,r);return n=="#REF"?n:Cse(n,r)}function is(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,f,h,p=0,x=0,g,v="";if(!e[0]||!e[0][0])return"";for(var y=-1,w="",_=0,S=e[0].length;_<S;++_){var E=e[0][_];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),f=o.pop(),y>=0){switch(e[0][y][1][0]){case 0:w=Hr(" ",e[0][y][1][1]);break;case 1:w=Hr("\r",e[0][y][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+w,y=-1}o.push(f+Ase[E[0]]+c);break;case"PtgIsect":c=o.pop(),f=o.pop(),o.push(f+" "+c);break;case"PtgUnion":c=o.pop(),f=o.pop(),o.push(f+","+c);break;case"PtgRange":c=o.pop(),f=o.pop(),o.push(f+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=zh(E[1][1],i,s),o.push(Hh(h,a));break;case"PtgRefN":h=r?zh(E[1][1],r,s):E[1][1],o.push(Hh(h,a));break;case"PtgRef3d":p=E[1][1],h=zh(E[1][2],i,s),v=T5(n,p,s),o.push(v+"!"+Hh(h,a));break;case"PtgFunc":case"PtgFuncVar":var T=E[1][0],k=E[1][1];T||(T=0),T&=127;var D=T==0?[]:o.slice(-T);o.length-=T,k==="User"&&(k=D.shift()),o.push(k+"("+D.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":g=t5(E[1][1],r?{s:r}:i,s),o.push(Rb(g,s));break;case"PtgArea":g=t5(E[1][1],i,s),o.push(Rb(g,s));break;case"PtgArea3d":p=E[1][1],g=E[1][2],v=T5(n,p,s),o.push(v+"!"+Rb(g,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=E[1][2];var O=(n.names||[])[x-1]||(n[0]||[])[x],z=O?O.Name:"SH33TJSNAME"+String(x);z&&z.slice(0,6)=="_xlfn."&&!s.xlfn&&(z=z.slice(6)),o.push(z);break;case"PtgNameX":var j=E[1][1];x=E[1][2];var J;if(s.biff<=5)j<0&&(j=-j),n[j]&&(J=n[j][x]);else{var ae="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][x]&&n[j][x].itab>0&&(ae=n.SheetNames[n[j][x].itab-1]+"!"):ae=n.SheetNames[x-1]+"!"),n[j]&&n[j][x])ae+=n[j][x].Name;else if(n[0]&&n[0][x])ae+=n[0][x].Name;else{var F=(uM(n,j,s)||"").split(";;");F[x-1]?ae=F[x-1]:ae+="SH33TJSERRX"}o.push(ae);break}J||(J={Name:"SH33TJSERRY"}),o.push(J.Name);break;case"PtgParen":var X="(",P=")";if(y>=0){switch(w="",e[0][y][1][0]){case 2:X=Hr(" ",e[0][y][1][1])+X;break;case 3:X=Hr("\r",e[0][y][1][1])+X;break;case 4:P=Hr(" ",e[0][y][1][1])+P;break;case 5:P=Hr("\r",e[0][y][1][1])+P;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}o.push(X+o.pop()+P);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:E[1][1],r:E[1][0]};var le={c:r.c,r:r.r};if(n.sharedf[bt(h)]){var ee=n.sharedf[bt(h)];o.push(is(ee,i,le,n,s))}else{var te=!1;for(c=0;c!=n.arrayf.length;++c)if(f=n.arrayf[c],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){o.push(is(f[1],i,le,n,s)),te=!0;break}te||o.push(E[1])}break;case"PtgArray":o.push("{"+kse(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&me.indexOf(e[0][_][0])==-1){E=e[0][y];var ie=!0;switch(E[1][0]){case 4:ie=!1;case 0:w=Hr(" ",E[1][1]);break;case 5:ie=!1;case 1:w=Hr("\r",E[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((ie?w:"")+o.pop()+(ie?"":w)),y=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Rse(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],ds(e,t-2)];var o=ip(e,i,r);return t!==i+s&&(a=ap(e,t-i-s,o,r)),e.l=n,[o,a]}function Ose(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],ds(e,t-2)];var o=ip(e,i,r);return t!==i+s&&(a=ap(e,t-i-s,o,r)),e.l=n,[o,a]}function jse(e,t,r,n){var s=e.l+t,a=ip(e,n,r),i;return s!==e.l&&(i=ap(e,s-e.l,a,r)),[a,i]}function Dse(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=ip(e,a,r);return a==65535?[[],ds(e,t-2)]:(t!==a+2&&(s=ap(e,n-a-2,i,r)),[i,s])}function Ise(e){var t;if(bo(e,e.l+6)!==65535)return[us(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Mse(e){if(e==null){var t=Le(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Zc(e);return Zc(0)}function Mb(e,t,r){var n=e.l+t,s=Hi(e);r.biff==2&&++e.l;var a=Ise(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Ose(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Fse(e,t,r,n,s){var a=eu(t,r,s),i=Mse(e.v),o=Le(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var f=Le(e.bf.length),h=0;h<e.bf.length;++h)f[h]=e.bf[h];var p=jn([a,i,o,f]);return p}function O1(e,t,r){var n=e.read_shift(4),s=ip(e,n,r),a=e.read_shift(4),i=a>0?ap(e,a,s,r):null;return[s,i]}var Pse=O1,j1=O1,Lse=O1,Bse=O1,Use={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},fM={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},zse={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function k5(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Hse(e){var t="of:="+e.replace(CS,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Fb(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Vse(e){return e.replace(/\./,"!")}var qh={},vf={},Wh=typeof Map<"u";function jS(e,t,r){var n=0,s=e.length;if(r){if(Wh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Wh?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Wh?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function D1(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ls=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=w0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=lg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Lc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Xl(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){ko(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function dM(e,t,r,n,s,a){try{n.cellNF&&(e.z=yt[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Tr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(yt[t]==null&&ko(UJ[t]||"General",t),e.t==="e")e.w=e.w||Uo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=p0(e.v);else if(e.t==="d"){var i=wn(e.v);(i|0)===i?e.w=i.toString(10):e.w=p0(i)}else{if(e.v===void 0)return"";e.w=Yc(e.v,vf)}else e.t==="d"?e.w=Ha(t,wn(e.v),vf):e.w=Ha(t,e.v,vf)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=og(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=og(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function qse(e,t,r){if(e&&e["!ref"]){var n=Gt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Wse(e,t){var r=Gt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ct(r))}var $se=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Gse=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Kse=/<(?:\w:)?hyperlink [^>]*>/mg,Xse=/"(\w*:\w*)"/,Yse=/<(?:\w:)?col\b[^>]*[\/]?>/g,Jse=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Zse=/<(?:\w:)?pageMargins[^>]*\/>/g,hM=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Qse=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,eae=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tae(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",p=e.match(Gse);p?(f=e.slice(0,p.index),h=e.slice(p.index+p[0].length)):f=h=e;var x=f.match(hM);x?DS(x[0],o,s,r):(x=f.match(Qse))&&nae(x[0],x[1]||"",o,s,r);var g=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var v=f.slice(g,g+50).match(Xse);v&&Wse(o,v[1])}var y=f.match(eae);y&&y[1]&&xae(y[1],s);var w=[];if(t.cellStyles){var _=f.match(Yse);_&&fae(w,_)}p&&vae(p[1],o,t,c,a,i);var S=h.match(Jse);S&&(o["!autofilter"]=hae(S[0]));var E=[],T=h.match($se);if(T)for(g=0;g!=T.length;++g)E[g]=Gt(T[g].slice(T[g].indexOf('"')+1));var k=h.match(Kse);k&&lae(o,k,n);var D=h.match(Zse);if(D&&(o["!margins"]=cae(_t(D[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ct(c)),t.sheetRows>0&&o["!ref"]){var O=Gt(o["!ref"]);t.sheetRows<=+O.e.r&&(O.e.r=t.sheetRows-1,O.e.r>c.e.r&&(O.e.r=c.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>c.e.c&&(O.e.c=c.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ct(O))}return w.length>0&&(o["!cols"]=w),E.length>0&&(o["!merges"]=E),o}function rae(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ct(e[r])+'"/>';return t+"</mergeCells>"}function DS(e,t,r,n){var s=_t(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=$t(dr(s.codeName)))}function nae(e,t,r,n,s){DS(e.slice(0,e.indexOf(">")),r,n,s)}function sae(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Mi(sr(c))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),o=(o||"")+Qe("outlinePr",null,f)}!a&&!o||(s[s.length]=Qe("sheetPr",o,i))}var aae=["objects","scenarios","selectLockedCells","selectUnlockedCells"],iae=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function oae(e){var t={sheet:1};return aae.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),iae.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=TS(e.password).toString(16).toUpperCase()),Qe("sheetProtection",null,t)}function lae(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=_t(dr(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+$t(a.location))):(a.Target="#"+$t(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Gt(a.ref),c=o.s.r;c<=o.e.r;++c)for(var f=o.s.c;f<=o.e.c;++f){var h=bt({c:f,r:c});n?(e[c]||(e[c]=[]),e[c][f]||(e[c][f]={t:"z",v:void 0}),e[c][f].l=a):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=a)}}}function cae(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function uae(e){return Lc(e),Qe("pageMargins",null,e)}function fae(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=_t(t[n],!0);s.hidden&&(s.hidden=Nr(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,kS(s.width)),Hl(s);a<=i;)e[a++]=kr(s)}}function dae(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Qe("col",null,D1(s,n)));return r[r.length]="</cols>",r.join("")}function hae(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function pae(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Ct(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Hs(s);i.s.r==i.e.r&&(i.e.r=Hs(t["!ref"]).e.r,s=Ct(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Qe("autoFilter",null,{ref:s})}var mae=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function xae(e,t){t.Views||(t.Views=[{}]),(e.match(mae)||[]).forEach(function(r,n){var s=_t(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Nr(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function gae(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Qe("sheetViews",Qe("sheetView",null,s),{})}function yae(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Uo[e.v];break;case"d":n&&n.cellDates?s=Tr(e.v,-1).toISOString():(e=kr(e),e.t="n",s=""+(e.v=wn(Tr(e.v)))),typeof e.z>"u"&&(e.z=yt[14]);break;default:s=e.v;break}var o=Gn("v",sr(s)),c={r:t},f=Xl(n.cellXfs,e,n);switch(f!==0&&(c.s=f),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Gn("v",""+jS(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Qe("f",sr(e.f),h)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Qe("c",o,c)}var vae=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=m0("v"),i=m0("f");return function(c,f,h,p,x,g){for(var v=0,y="",w=[],_=[],S=0,E=0,T=0,k="",D,O,z=0,j=0,J,ae,F=0,X=0,P=Array.isArray(g.CellXf),le,ee=[],te=[],me=Array.isArray(f),ie=[],Ee={},K=!1,M=!!h.sheetStubs,q=c.split(t),G=0,Z=q.length;G!=Z;++G){y=q[G].trim();var re=y.length;if(re!==0){var L=0;e:for(v=0;v<re;++v)switch(y[v]){case">":if(y[v-1]!="/"){++v;break e}if(h&&h.cellStyles){if(O=_t(y.slice(L,v),!0),z=O.r!=null?parseInt(O.r,10):z+1,j=-1,h.sheetRows&&h.sheetRows<z)continue;Ee={},K=!1,O.ht&&(K=!0,Ee.hpt=parseFloat(O.ht),Ee.hpx=Pf(Ee.hpt)),O.hidden=="1"&&(K=!0,Ee.hidden=!0),O.outlineLevel!=null&&(K=!0,Ee.level=+O.outlineLevel),K&&(ie[z-1]=Ee)}break;case"<":L=v;break}if(L>=v)break;if(O=_t(y.slice(L,v),!0),z=O.r!=null?parseInt(O.r,10):z+1,j=-1,!(h.sheetRows&&h.sheetRows<z)){p.s.r>z-1&&(p.s.r=z-1),p.e.r<z-1&&(p.e.r=z-1),h&&h.cellStyles&&(Ee={},K=!1,O.ht&&(K=!0,Ee.hpt=parseFloat(O.ht),Ee.hpx=Pf(Ee.hpt)),O.hidden=="1"&&(K=!0,Ee.hidden=!0),O.outlineLevel!=null&&(K=!0,Ee.level=+O.outlineLevel),K&&(ie[z-1]=Ee)),w=y.slice(v).split(e);for(var I=0;I!=w.length&&w[I].trim().charAt(0)=="<";++I);for(w=w.slice(I),v=0;v!=w.length;++v)if(y=w[v].trim(),y.length!==0){if(_=y.match(r),S=v,E=0,T=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,_!=null&&_.length===2){for(S=0,k=_[1],E=0;E!=k.length&&!((T=k.charCodeAt(E)-64)<1||T>26);++E)S=26*S+T;--S,j=S}else++j;for(E=0;E!=y.length&&y.charCodeAt(E)!==62;++E);if(++E,O=_t(y.slice(0,E),!0),O.r||(O.r=bt({r:z-1,c:j})),k=y.slice(E),D={t:""},(_=k.match(a))!=null&&_[1]!==""&&(D.v=$t(_[1])),h.cellFormula){if((_=k.match(i))!=null&&_[1]!==""){if(D.f=$t(dr(_[1])).replace(/\r\n/g,`
`),h.xlfn||(D.f=E5(D.f)),_[0].indexOf('t="array"')>-1)D.F=(k.match(s)||[])[1],D.F.indexOf(":")>-1&&ee.push([Gt(D.F),D.F]);else if(_[0].indexOf('t="shared"')>-1){ae=_t(_[0]);var se=$t(dr(_[1]));h.xlfn||(se=E5(se)),te[parseInt(ae.si,10)]=[ae,se,O.r]}}else(_=k.match(/<f[^>]*\/>/))&&(ae=_t(_[0]),te[ae.si]&&(D.f=mne(te[ae.si][1],te[ae.si][2],O.r)));var Q=Ir(O.r);for(E=0;E<ee.length;++E)Q.r>=ee[E][0].s.r&&Q.r<=ee[E][0].e.r&&Q.c>=ee[E][0].s.c&&Q.c<=ee[E][0].e.c&&(D.F=ee[E][1])}if(O.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(M)D.t="z";else continue;else D.t=O.t||"n";switch(p.s.c>j&&(p.s.c=j),p.e.c<j&&(p.e.c=j),D.t){case"n":if(D.v==""||D.v==null){if(!M)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!M)continue;D.t="z"}else J=qh[parseInt(D.v,10)],D.v=J.t,D.r=J.r,h.cellHTML&&(D.h=J.h);break;case"str":D.t="s",D.v=D.v!=null?dr(D.v):"",h.cellHTML&&(D.h=fS(D.v));break;case"inlineStr":_=k.match(n),D.t="s",_!=null&&(J=NS(_[1]))?(D.v=J.t,h.cellHTML&&(D.h=J.h)):D.v="";break;case"b":D.v=Nr(D.v);break;case"d":h.cellDates?D.v=Tr(D.v,1):(D.v=wn(Tr(D.v,1)),D.t="n");break;case"e":(!h||h.cellText!==!1)&&(D.w=D.v),D.v=mI[D.v];break}if(F=X=0,le=null,P&&O.s!==void 0&&(le=g.CellXf[O.s],le!=null&&(le.numFmtId!=null&&(F=le.numFmtId),h.cellStyles&&le.fillId!=null&&(X=le.fillId))),dM(D,F,X,h,x,g),h.cellDates&&P&&D.t=="n"&&pd(yt[F])&&(D.t="d",D.v=C1(D.v)),O.cm&&h.xlmeta){var Y=(h.xlmeta.Cell||[])[+O.cm-1];Y&&Y.type=="XLDAPR"&&(D.D=!0)}if(me){var U=Ir(O.r);f[U.r]||(f[U.r]=[]),f[U.r][U.c]=D}else f[O.r]=D}}}}ie.length>0&&(f["!rows"]=ie)}})();function bae(e,t,r,n){var s=[],a=[],i=Gt(e["!ref"]),o="",c,f="",h=[],p=0,x=0,g=e["!rows"],v=Array.isArray(e),y={r:f},w,_=-1;for(x=i.s.c;x<=i.e.c;++x)h[x]=Dr(x);for(p=i.s.r;p<=i.e.r;++p){for(a=[],f=Jr(p),x=i.s.c;x<=i.e.c;++x){c=h[x]+f;var S=v?(e[p]||[])[x]:e[c];S!==void 0&&(o=yae(S,c,e,t))!=null&&a.push(o)}(a.length>0||g&&g[p])&&(y={r:f},g&&g[p]&&(w=g[p],w.hidden&&(y.hidden=1),_=-1,w.hpx?_=_0(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(y.ht=_,y.customHeight=1),w.level&&(y.outlineLevel=w.level)),s[s.length]=Qe("row",a.join(""),y))}if(g)for(;p<g.length;++p)g&&g[p]&&(y={r:p+1},w=g[p],w.hidden&&(y.hidden=1),_=-1,w.hpx?_=_0(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(y.ht=_,y.customHeight=1),w.level&&(y.outlineLevel=w.level),s[s.length]=Qe("row","",y));return s.join("")}function pM(e,t,r,n){var s=[Qr,Qe("worksheet",null,{xmlns:cu[0],"xmlns:r":bn.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var f=c["!ref"]||"A1",h=Gt(f);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),f=Ct(h)}n||(n={}),c["!comments"]=[];var p=[];sae(c,r,e,t,s),s[s.length]=Qe("dimension",null,{ref:f}),s[s.length]=gae(c,t,e,r),t.sheetFormat&&(s[s.length]=Qe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=dae(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=bae(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=oae(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=pae(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=rae(c["!merges"]));var x=-1,g,v=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(y){y[1].Target&&(g={ref:y[0]},y[1].Target.charAt(0)!="#"&&(v=nr(n,-1,sr(y[1].Target).replace(/#.*$/,""),Lt.HLINK),g["r:id"]="rId"+v),(x=y[1].Target.indexOf("#"))>-1&&(g.location=sr(y[1].Target.slice(x+1))),y[1].Tooltip&&(g.tooltip=sr(y[1].Tooltip)),s[s.length]=Qe("hyperlink",null,g))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=uae(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Gn("ignoredErrors",Qe("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(v=nr(n,-1,"../drawings/drawing"+(e+1)+".xml",Lt.DRAW),s[s.length]=Qe("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=p),c["!comments"].length>0&&(v=nr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Lt.VML),s[s.length]=Qe("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function wae(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function _ae(e,t,r){var n=Le(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=_0(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var f={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var p=-1,x=-1,g=h<<10;g<h+1<<10;++g){f.c=g;var v=Array.isArray(r)?(r[f.r]||[])[f.c]:r[bt(f)];v&&(p<0&&(p=g),x=g)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,x))}var y=n.l;return n.l=c,n.write_shift(4,o),n.l=y,n.length>n.l?n.slice(0,n.l):n}function Eae(e,t,r,n){var s=_ae(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&qe(e,0,s)}var Sae=hu,Nae=gd;function Tae(){}function kae(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=RZ(e),r}function Aae(e,t,r){r==null&&(r=Le(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return sg({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),uI(e,r),r.slice(0,r.l)}function Cae(e){var t=$a(e);return[t]}function Rae(e,t,r){return r==null&&(r=Le(8)),uu(t,r)}function Oae(e){var t=fu(e);return[t]}function jae(e,t,r){return r==null&&(r=Le(4)),du(t,r)}function Dae(e){var t=$a(e),r=e.read_shift(1);return[t,r,"b"]}function Iae(e,t,r){return r==null&&(r=Le(9)),uu(t,r),r.write_shift(1,e.v?1:0),r}function Mae(e){var t=fu(e),r=e.read_shift(1);return[t,r,"b"]}function Fae(e,t,r){return r==null&&(r=Le(5)),du(t,r),r.write_shift(1,e.v?1:0),r}function Pae(e){var t=$a(e),r=e.read_shift(1);return[t,r,"e"]}function Lae(e,t,r){return r==null&&(r=Le(9)),uu(t,r),r.write_shift(1,e.v),r}function Bae(e){var t=fu(e),r=e.read_shift(1);return[t,r,"e"]}function Uae(e,t,r){return r==null&&(r=Le(8)),du(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function zae(e){var t=$a(e),r=e.read_shift(4);return[t,r,"s"]}function Hae(e,t,r){return r==null&&(r=Le(12)),uu(t,r),r.write_shift(4,t.v),r}function Vae(e){var t=fu(e),r=e.read_shift(4);return[t,r,"s"]}function qae(e,t,r){return r==null&&(r=Le(8)),du(t,r),r.write_shift(4,t.v),r}function Wae(e){var t=$a(e),r=us(e);return[t,r,"n"]}function $ae(e,t,r){return r==null&&(r=Le(16)),uu(t,r),Zc(e.v,r),r}function mM(e){var t=fu(e),r=us(e);return[t,r,"n"]}function Gae(e,t,r){return r==null&&(r=Le(12)),du(t,r),Zc(e.v,r),r}function Kae(e){var t=$a(e),r=bS(e);return[t,r,"n"]}function Xae(e,t,r){return r==null&&(r=Le(12)),uu(t,r),fI(e.v,r),r}function Yae(e){var t=fu(e),r=bS(e);return[t,r,"n"]}function Jae(e,t,r){return r==null&&(r=Le(8)),du(t,r),fI(e.v,r),r}function Zae(e){var t=$a(e),r=gS(e);return[t,r,"is"]}function Qae(e){var t=$a(e),r=fs(e);return[t,r,"str"]}function eie(e,t,r){return r==null&&(r=Le(12+4*e.v.length)),uu(t,r),In(e.v,r),r.length>r.l?r.slice(0,r.l):r}function tie(e){var t=fu(e),r=fs(e);return[t,r,"str"]}function rie(e,t,r){return r==null&&(r=Le(8+4*e.v.length)),du(t,r),In(e.v,r),r.length>r.l?r.slice(0,r.l):r}function nie(e,t,r){var n=e.l+t,s=$a(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=j1(e,n-e.l,r);i[3]=is(o,null,s,r.supbooks,r)}else e.l=n;return i}function sie(e,t,r){var n=e.l+t,s=$a(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=j1(e,n-e.l,r);i[3]=is(o,null,s,r.supbooks,r)}else e.l=n;return i}function aie(e,t,r){var n=e.l+t,s=$a(e);s.r=r["!row"];var a=us(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=j1(e,n-e.l,r);i[3]=is(o,null,s,r.supbooks,r)}else e.l=n;return i}function iie(e,t,r){var n=e.l+t,s=$a(e);s.r=r["!row"];var a=fs(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=j1(e,n-e.l,r);i[3]=is(o,null,s,r.supbooks,r)}else e.l=n;return i}var oie=hu,lie=gd;function cie(e,t){return t==null&&(t=Le(4)),t.write_shift(4,e),t}function uie(e,t){var r=e.l+t,n=hu(e),s=yS(e),a=fs(e),i=fs(e),o=fs(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function fie(e,t){var r=Le(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));gd({s:Ir(e[0]),e:Ir(e[0])},r),vS("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return In(s||"",r),In(e[1].Tooltip||"",r),In("",r),r.slice(0,r.l)}function die(){}function hie(e,t,r){var n=e.l+t,s=dI(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=Pse(e,n-e.l,r);i[1]=o}else e.l=n;return i}function pie(e,t,r){var n=e.l+t,s=hu(e),a=[s];if(r.cellFormula){var i=Bse(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function mie(e,t,r){r==null&&(r=Le(18));var n=D1(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var xM=["left","right","top","bottom","header","footer"];function xie(e){var t={};return xM.forEach(function(r){t[r]=us(e)}),t}function gie(e,t){return t==null&&(t=Le(48)),Lc(e),xM.forEach(function(r){Zc(e[r],t)}),t}function yie(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function vie(e,t,r){r==null&&(r=Le(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function bie(e){var t=Le(24);return t.write_shift(4,4),t.write_shift(4,1),gd(e,t),t}function wie(e,t){return t==null&&(t=Le(66)),t.write_shift(2,e.password?TS(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function _ie(){}function Eie(){}function Sie(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,x=!1,g,v,y,w,_,S,E,T,k,D=[];o.biff=12,o["!row"]=0;var O=0,z=!1,j=[],J={},ae=o.supbooks||s.supbooks||[[]];if(ae.sharedf=J,ae.arrayf=j,ae.SheetNames=s.SheetNames||s.Sheets.map(function(me){return me.name}),!o.supbooks&&(o.supbooks=ae,s.Names))for(var F=0;F<s.Names.length;++F)ae[0][F+1]=s.Names[F];var X=[],P=[],le=!1;E0[16]={n:"BrtShortReal",f:mM};var ee;if(Bo(e,function(ie,Ee,K){if(!x)switch(K){case 148:f=ie;break;case 0:g=ie,o.sheetRows&&o.sheetRows<=g.r&&(x=!0),T=Jr(w=g.r),o["!row"]=g.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=Pf(ie.hpt)),P[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:ie[2]},ie[2]){case"n":v.v=ie[1];break;case"s":E=qh[ie[1]],v.v=E.t,v.r=E.r;break;case"b":v.v=!!ie[1];break;case"e":v.v=ie[1],o.cellText!==!1&&(v.w=Uo[v.v]);break;case"str":v.t="s",v.v=ie[1];break;case"is":v.t="s",v.v=ie[1].t;break}if((y=i.CellXf[ie[0].iStyleRef])&&dM(v,y.numFmtId,null,o,a,i),_=ie[0].c==-1?_+1:ie[0].c,o.dense?(c[w]||(c[w]=[]),c[w][_]=v):c[Dr(_)+T]=v,o.cellFormula){for(z=!1,O=0;O<j.length;++O){var M=j[O];g.r>=M[0].s.r&&g.r<=M[0].e.r&&_>=M[0].s.c&&_<=M[0].e.c&&(v.F=Ct(M[0]),z=!0)}!z&&ie.length>3&&(v.f=ie[3])}if(h.s.r>g.r&&(h.s.r=g.r),h.s.c>_&&(h.s.c=_),h.e.r<g.r&&(h.e.r=g.r),h.e.c<_&&(h.e.c=_),o.cellDates&&y&&v.t=="n"&&pd(yt[y.numFmtId])){var q=Tc(v.v);q&&(v.t="d",v.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}ee&&(ee.type=="XLDAPR"&&(v.D=!0),ee=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;v={t:"z",v:void 0},_=ie[0].c==-1?_+1:ie[0].c,o.dense?(c[w]||(c[w]=[]),c[w][_]=v):c[Dr(_)+T]=v,h.s.r>g.r&&(h.s.r=g.r),h.s.c>_&&(h.s.c=_),h.e.r<g.r&&(h.e.r=g.r),h.e.c<_&&(h.e.c=_),ee&&(ee.type=="XLDAPR"&&(v.D=!0),ee=void 0);break;case 176:D.push(ie);break;case 49:ee=((o.xlmeta||{}).Cell||[])[ie-1];break;case 494:var G=n["!id"][ie.relId];for(G?(ie.Target=G.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=G):ie.relId==""&&(ie.Target="#"+ie.loc),w=ie.rfx.s.r;w<=ie.rfx.e.r;++w)for(_=ie.rfx.s.c;_<=ie.rfx.e.c;++_)o.dense?(c[w]||(c[w]=[]),c[w][_]||(c[w][_]={t:"z",v:void 0}),c[w][_].l=ie):(S=bt({c:_,r:w}),c[S]||(c[S]={t:"z",v:void 0}),c[S].l=ie);break;case 426:if(!o.cellFormula)break;j.push(ie),k=o.dense?c[w][_]:c[Dr(_)+T],k.f=is(ie[1],h,{r:g.r,c:_},ae,o),k.F=Ct(ie[0]);break;case 427:if(!o.cellFormula)break;J[bt(ie[0].s)]=ie[1],k=o.dense?c[w][_]:c[Dr(_)+T],k.f=is(ie[1],h,{r:g.r,c:_},ae,o);break;case 60:if(!o.cellStyles)break;for(;ie.e>=ie.s;)X[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},le||(le=!0,kS(ie.w/256)),Hl(X[ie.e+1]);break;case 161:c["!autofilter"]={ref:Ct(ie)};break;case 476:c["!margins"]=ie;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),ie.name&&(s.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(c["!outline"]={above:ie.above,left:ie.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ie.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!Ee.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(c["!ref"]=Ct(f||h)),o.sheetRows&&c["!ref"]){var te=Gt(c["!ref"]);o.sheetRows<=+te.e.r&&(te.e.r=o.sheetRows-1,te.e.r>h.e.r&&(te.e.r=h.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>h.e.c&&(te.e.c=h.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ct(te))}return D.length>0&&(c["!merges"]=D),X.length>0&&(c["!cols"]=X),P.length>0&&(c["!rows"]=P),c}function Nie(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=kr(t),t.z=t.z||yt[14],t.v=wn(Tr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Xl(s.cellXfs,t,s),t.l&&a["!links"].push([bt(c),t.l]),t.c&&a["!comments"].push([bt(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=jS(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?qe(e,18,qae(t,c)):qe(e,7,Hae(t,c))):(c.t="str",i?qe(e,17,rie(t,c)):qe(e,6,eie(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?qe(e,13,Jae(t,c)):qe(e,2,Xae(t,c)):i?qe(e,16,Gae(t,c)):qe(e,5,$ae(t,c)),!0;case"b":return c.t="b",i?qe(e,15,Fae(t,c)):qe(e,4,Iae(t,c)),!0;case"e":return c.t="e",i?qe(e,14,Uae(t,c)):qe(e,3,Lae(t,c)),!0}return i?qe(e,12,jae(t,c)):qe(e,1,Rae(t,c)),!0}function Tie(e,t,r,n){var s=Gt(t["!ref"]||"A1"),a,i="",o=[];qe(e,145);var c=Array.isArray(t),f=s.e.r;t["!rows"]&&(f=Math.max(s.e.r,t["!rows"].length-1));for(var h=s.s.r;h<=f;++h){i=Jr(h),Eae(e,t,s,h);var p=!1;if(h<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){h===s.s.r&&(o[x]=Dr(x)),a=o[x]+i;var g=c?(t[h]||[])[x]:t[a];if(!g){p=!1;continue}p=Nie(e,g,h,x,n,t,p)}}qe(e,146)}function kie(e,t){!t||!t["!merges"]||(qe(e,177,cie(t["!merges"].length)),t["!merges"].forEach(function(r){qe(e,176,lie(r))}),qe(e,178))}function Aie(e,t){!t||!t["!cols"]||(qe(e,390),t["!cols"].forEach(function(r,n){r&&qe(e,60,mie(n,r))}),qe(e,391))}function Cie(e,t){!t||!t["!ref"]||(qe(e,648),qe(e,649,bie(Gt(t["!ref"]))),qe(e,650))}function Rie(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=nr(r,-1,n[1].Target.replace(/#.*$/,""),Lt.HLINK);qe(e,494,fie(n,s))}}),delete t["!links"]}function Oie(e,t,r,n){if(t["!comments"].length>0){var s=nr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Lt.VML);qe(e,551,vS("rId"+s)),t["!legacy"]=s}}function jie(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Ct(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Hs(a);o.s.r==o.e.r&&(o.e.r=Hs(t["!ref"]).e.r,a=Ct(o));for(var c=0;c<i.length;++c){var f=i[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),qe(e,161,gd(Gt(a))),qe(e,162)}}function Die(e,t,r){qe(e,133),qe(e,137,vie(t,r)),qe(e,138),qe(e,134)}function Iie(e,t){t["!protect"]&&qe(e,535,wie(t["!protect"]))}function Mie(e,t,r,n){var s=Bs(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Gt(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],qe(s,129),(r.vbaraw||i["!outline"])&&qe(s,147,Aae(o,i["!outline"])),qe(s,148,Nae(c)),Die(s,i,r.Workbook),Aie(s,i),Tie(s,i,e,t),Iie(s,i),jie(s,i,r,e),kie(s,i),Rie(s,i,n),i["!margins"]&&qe(s,476,gie(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Cie(s,i),Oie(s,i,e,n),qe(s,130),s.end()}function Fie(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=$t((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function Pie(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var x=Fie(p);h.s.r=h.s.c=0,h.e.c=o,f=Dr(o),x[0].forEach(function(g,v){i[f+Jr(v)]={t:"n",v:g,z:x[1]},c=v}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(i["!ref"]=Ct(h)),i}function Lie(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(hM);return o&&DS(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Bie(e,t){e.l+=10;var r=fs(e);return{name:r}}function Uie(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Bo(e,function(c,f,h){switch(h){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var IS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],zie=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Hie=[],Vie=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function A5(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Nr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function C5(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Nr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function gM(e){C5(e.WBProps,IS),C5(e.CalcPr,Vie),A5(e.WBView,zie),A5(e.Sheets,Hie),vf.date1904=Nr(e.WBProps.date1904)}function qie(e){return!e.Workbook||!e.Workbook.WBProps?"false":Nr(e.Workbook.WBProps.date1904)?"true":"false"}var Wie="][*?/\\".split("");function yM(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Wie.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function $ie(e,t,r){e.forEach(function(n,s){yM(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Gie(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];$ie(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)qse(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Kie=/<\w+:workbook/;function Xie(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(ps,function(c,f){var h=_t(c);switch(zi(h[0])){case"<?xml":break;case"<workbook":c.match(Kie)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[s];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":IS.forEach(function(p){if(h[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Nr(h[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(h[p[0]],10);break;default:r.WBProps[p[0]]=h[p[0]]}}),h.codeName&&(r.WBProps.CodeName=dr(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=$t(dr(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=dr(h.name),h.comment&&(a.Comment=h.comment),h.localSheetId&&(a.Sheet=+h.localSheetId),Nr(h.hidden||"0")&&(a.Hidden=!0),i=f+c.length;break;case"</definedName>":a.Ref=$t(dr(e.slice(i,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),cu.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return gM(r),r}function vM(e){var t=[Qr];t[t.length]=Qe("workbook",null,{xmlns:cu[0],"xmlns:r":bn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(IS.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Qe("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:sr(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Qe("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Qe("definedName",sr(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Yie(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=O_(e),r.name=fs(e),r}function Jie(e,t){return t||(t=Le(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),vS(e.strRelID,t),In(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Zie(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?fs(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Qie(e,t){t||(t=Le(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),uI(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function eoe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function toe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=OZ(e),i=Lse(e,0,r),o=yS(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function roe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],E0[16]={n:"BrtFRTArchID$",f:eoe},Bo(e,function(c,f,h){switch(h){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=is(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([h,c]):i[0]=[h,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(h),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!f.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),gM(r),r.Names=a,r.supbooks=i,r}function noe(e,t){qe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};qe(e,156,Jie(s))}qe(e,144)}function soe(e,t){t||(t=Le(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return In("SheetJS",t),In(Jx.version,t),In(Jx.version,t),In("7262",t),t.length>t.l?t.slice(0,t.l):t}function aoe(e,t){t||(t=Le(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function ioe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(qe(e,135),qe(e,158,aoe(s)),qe(e,136))}}function ooe(e,t){var r=Bs();return qe(r,131),qe(r,128,soe()),qe(r,153,Qie(e.Workbook&&e.Workbook.WBProps||null)),ioe(r,e),noe(r,e),qe(r,132),r.end()}function loe(e,t,r){return t.slice(-4)===".bin"?roe(e,r):Xie(e,r)}function coe(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Sie(e,n,r,s,a,i,o):tae(e,n,r,s,a,i,o)}function uoe(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Uie(e,n,r,s,a):Lie(e,n,r,s,a)}function foe(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?hne():pne()}function doe(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?fne():dne()}function hoe(e,t,r,n){return t.slice(-4)===".bin"?lre(e,r,n):Yte(e,r,n)}function poe(e,t,r){return QI(e,r)}function moe(e,t,r){return t.slice(-4)===".bin"?mte(e,r):dte(e,r)}function xoe(e,t,r){return t.slice(-4)===".bin"?ine(e,r):Jre(e,r)}function goe(e,t,r){return t.slice(-4)===".bin"?Kre(e):$re(e)}function yoe(e,t,r,n){return r.slice(-4)===".bin"?Xre(e,t,r,n):void 0}function voe(e,t,r){return t.slice(-4)===".bin"?Vre(e,t,r):Wre(e,t,r)}function boe(e,t,r){return(t.slice(-4)===".bin"?ooe:vM)(e)}function woe(e,t,r,n,s){return(t.slice(-4)===".bin"?Mie:pM)(e,r,n,s)}function _oe(e,t,r){return(t.slice(-4)===".bin"?yre:JI)(e,r)}function Eoe(e,t,r){return(t.slice(-4)===".bin"?yte:VI)(e,r)}function Soe(e,t,r){return(t.slice(-4)===".bin"?one:rM)(e)}function Noe(e){return(e.slice(-4)===".bin"?qre:eM)()}var bM=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wM=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Za(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(bM),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(wM),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function Toe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(bM),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(wM),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var $h;function koe(e,t){var r=$h[e]||$t(e);return r==="General"?Yc(t):Ha(r,t)}function Aoe(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Nr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Tr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[$t(t)]=s}function Coe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Uo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=p0(e.v):e.w=Yc(e.v):e.w=koe(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=$h[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&pd(n)){var s=Tc(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function Roe(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Hte[n.Pattern]||n.Pattern)}e[t.ID]=t}function Ooe(e,t,r,n,s,a,i,o,c,f){var h="General",p=n.StyleID,x={};f=f||{};var g=[],v=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&i&&(p=i.StyleID);a[p]!==void 0&&(a[p].nf&&(h=a[p].nf),a[p].Interior&&g.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Nr(e);break;case"String":n.t="s",n.r=$3($t(e)),n.v=e.indexOf("<")>-1?$t(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Tr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=$t(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=mI[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=$3(t||e));break}if(Coe(n,h,f),f.cellFormula!==!1)if(n.Formula){var y=$t(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=yf(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=yf("RC:RC",s):n.ArrayRange&&(n.F=yf(n.ArrayRange,s),c.push([Gt(n.F),n.F]))}else for(v=0;v<c.length;++v)s.r>=c[v][0].s.r&&s.r<=c[v][0].e.r&&s.c>=c[v][0].s.c&&s.c<=c[v][0].e.c&&(n.F=c[v][1]);f.cellStyles&&(g.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function joe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Pb(e,t){var r=t||{};md();var n=Rh(dS(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=dr(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=kr(r);return i.type="string",Ff.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(A){s.indexOf("<"+A)>=0&&(a=!0)}),a)return gle(n,r);$h={"General Number":"General","General Date":yt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":yt[15],"Short Date":yt[14],"Long Time":yt[19],"Medium Time":yt[18],"Short Time":yt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:yt[2],Standard:yt[4],Percent:yt[10],Scientific:yt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],f,h={},p=[],x=r.dense?[]:{},g="",v={},y={},w=Za('<Data ss:Type="String">'),_=0,S=0,E=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},D={},O="",z=0,j=[],J={},ae={},F=0,X=[],P=[],le={},ee=[],te,me=!1,ie=[],Ee=[],K={},M=0,q=0,G={Sheets:[],WBProps:{date1904:!1}},Z={};g0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";o=g0.exec(n);)switch(o[3]=(re=o[3]).toLowerCase()){case"data":if(re=="data"){if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Ooe(n.slice(_,o.index),O,w,c[c.length-1][0]=="comment"?le:v,{c:S,r:E},k,ee[S],y,ie,r):(O="",w=Za(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(P.length>0&&(v.c=P),(!r.sheetRows||r.sheetRows>E)&&v.v!==void 0&&(r.dense?(x[E]||(x[E]=[]),x[E][S]=v):x[Dr(S)+Jr(E)]=v),v.HRef&&(v.l={Target:$t(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(M=S+(parseInt(v.MergeAcross,10)|0),q=E+(parseInt(v.MergeDown,10)|0),j.push({s:{c:S,r:E},e:{c:M,r:q}})),!r.sheetStubs)v.MergeAcross?S=M+1:++S;else if(v.MergeAcross||v.MergeDown){for(var L=S;L<=M;++L)for(var I=E;I<=q;++I)(L>S||I>E)&&(r.dense?(x[I]||(x[I]=[]),x[I][L]={t:"z"}):x[Dr(L)+Jr(I)]={t:"z"});S=M+1}else++S;else v=Toe(o[0]),v.Index&&(S=+v.Index-1),S<T.s.c&&(T.s.c=S),S>T.e.c&&(T.e.c=S),o[0].slice(-2)==="/>"&&++S,P=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<T.s.r&&(T.s.r=E),E>T.e.r&&(T.e.r=E),o[0].slice(-2)==="/>"&&(y=Za(o[0]),y.Index&&(E=+y.Index-1)),S=0,++E):(y=Za(o[0]),y.Index&&(E=+y.Index-1),K={},(y.AutoFitHeight=="0"||y.Height)&&(K.hpx=parseInt(y.Height,10),K.hpt=_0(K.hpx),Ee[E]=K),y.Hidden=="1"&&(K.hidden=!0,Ee[E]=K));break;case"worksheet":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));p.push(g),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(x["!ref"]=Ct(T),r.sheetRows&&r.sheetRows<=T.e.r&&(x["!fullref"]=x["!ref"],T.e.r=r.sheetRows-1,x["!ref"]=Ct(T))),j.length&&(x["!merges"]=j),ee.length>0&&(x["!cols"]=ee),Ee.length>0&&(x["!rows"]=Ee),h[g]=x}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=S=0,c.push([o[3],!1]),f=Za(o[0]),g=$t(f.Name),x=r.dense?[]:{},j=[],ie=[],Ee=[],Z={name:g,Hidden:0},G.Sheets.push(Z);break;case"table":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),ee=[],me=!1}break;case"style":o[1]==="/"?Roe(k,D,r):D=Za(o[0]);break;case"numberformat":D.nf=$t(Za(o[0]).Format||"General"),$h[D.nf]&&(D.nf=$h[D.nf]);for(var se=0;se!=392&&yt[se]!=D.nf;++se);if(se==392){for(se=57;se!=392;++se)if(yt[se]==null){ko(D.nf,se);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(te=Za(o[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!me&&te.wpx>10){me=!0,ls=XI;for(var Q=0;Q<ee.length;++Q)ee[Q]&&Hl(ee[Q])}me&&Hl(te),ee[te.Index-1||ee.length]=te;for(var Y=0;Y<+te.Span;++Y)ee[ee.length]=kr(te);break;case"namedrange":if(o[1]==="/")break;G.Names||(G.Names=[]);var U=_t(o[0]),we={Name:U.Name,Ref:yf(U.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(we.Sheet=G.Sheets.length-1),G.Names.push(we);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?O+=n.slice(z,o.index):z=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=Za(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?rQ(J,re,n.slice(F,o.index)):F=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));joe(le),P.push(le)}else c.push([o[3],!1]),f=Za(o[0]),le={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var B=Za(o[0]);x["!autofilter"]={ref:yf(B.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return I5(n,r);var be=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:be=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:be=!1}break;case"excelworkbook":switch(o[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:be=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:be=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(F,o.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else F=o.index+o[0].length;break;case"header":x["!margins"]||Lc(x["!margins"]={},"xlml"),isNaN(+_t(o[0]).Margin)||(x["!margins"].header=+_t(o[0]).Margin);break;case"footer":x["!margins"]||Lc(x["!margins"]={},"xlml"),isNaN(+_t(o[0]).Margin)||(x["!margins"].footer=+_t(o[0]).Margin);break;case"pagemargins":var V=_t(o[0]);x["!margins"]||Lc(x["!margins"]={},"xlml"),isNaN(+V.Top)||(x["!margins"].top=+V.Top),isNaN(+V.Left)||(x["!margins"].left=+V.Left),isNaN(+V.Right)||(x["!margins"].right=+V.Right),isNaN(+V.Bottom)||(x["!margins"].bottom=+V.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:be=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:be=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:be=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:be=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:be=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:be=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:be=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:be=!1}break;case"smarttags":break;default:be=!1;break}if(be||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Aoe(ae,re,X,n.slice(F,o.index)):(X=o,F=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var C={};return!r.bookSheets&&!r.bookProps&&(C.Sheets=h),C.SheetNames=p,C.Workbook=G,C.SSF=kr(yt),C.Props=J,C.Custprops=ae,C}function L_(e,t){switch(FS(t=t||{}),t.type||"base64"){case"base64":return Pb(ca(e),t);case"binary":case"buffer":case"file":return Pb(e,t);case"array":return Pb(Gl(e),t)}}function Doe(e,t){var r=[];return e.Props&&r.push(nQ(e.Props,t)),e.Custprops&&r.push(sQ(e.Props,e.Custprops)),r.join("")}function Ioe(){return""}function Moe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Qe("NumberFormat",null,{"ss:Format":sr(yt[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Qe("Style",a.join(""),i))}),Qe("Styles",r.join(""))}function _M(e){return Qe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+RS(e.Ref,{r:0,c:0})})}function Foe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(_M(s)))}return Qe("Names",r.join(""))}function Poe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(_M(o)))}return a.join("")}function Loe(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Qe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Qe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Qe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Qe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Gn("ProtectContents","True")),e["!protect"].objects&&s.push(Gn("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Gn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Gn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Gn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Qe("WorksheetOptions",s.join(""),{xmlns:ta.x})}function Boe(e){return e.map(function(t){var r=iZ(t.t||""),n=Qe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Qe("Comment",n,{"ss:Author":t.a})}).join("")}function Uoe(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+sr(RS(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Ir(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=sr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=sr(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],h=0;h!=f.length;++h)f[h].s.c!=i.c||f[h].s.r!=i.r||(f[h].e.c>f[h].s.c&&(o["ss:MergeAcross"]=f[h].e.c-f[h].s.c),f[h].e.r>f[h].s.r&&(o["ss:MergeDown"]=f[h].e.r-f[h].s.r));var p="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",x=String(e.v);break;case"b":p="Boolean",x=e.v?"1":"0";break;case"e":p="Error",x=Uo[e.v];break;case"d":p="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||yt[14]);break;case"s":p="String",x=aZ(e.v||"");break}var g=Xl(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=i.c+1;var v=e.v!=null?x:"",y=e.t=="z"?"":'<Data ss:Type="'+p+'">'+v+"</Data>";return(e.c||[]).length>0&&(y+=Boe(e.c)),Qe("Cell",y,o)}function zoe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Pf(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Hoe(e,t,r,n){if(!e["!ref"])return"";var s=Gt(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,_){Hl(w);var S=!!w.width,E=D1(_,w),T={"ss:Index":_+1};S&&(T["ss:Width"]=b0(E.width)),w.hidden&&(T["ss:Hidden"]="1"),o.push(Qe("Column",null,T))});for(var c=Array.isArray(e),f=s.s.r;f<=s.e.r;++f){for(var h=[zoe(f,(e["!rows"]||[])[f])],p=s.s.c;p<=s.e.c;++p){var x=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>p)&&!(a[i].s.r>f)&&!(a[i].e.c<p)&&!(a[i].e.r<f)){(a[i].s.c!=p||a[i].s.r!=f)&&(x=!0);break}if(!x){var g={r:f,c:p},v=bt(g),y=c?(e[f]||[])[p]:e[v];h.push(Uoe(y,v,e,t,r,n,g))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function Voe(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?Poe(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?Hoe(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(Loe(a,t,e,r)),n.join("")}function qoe(e,t){t||(t={}),e.SSF||(e.SSF=kr(yt)),e.SSF&&(md(),T1(e.SSF),t.revssf=A1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Xl(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Doe(e,t)),r.push(Ioe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Qe("Worksheet",Voe(n,t,e),{"ss:Name":sr(e.SheetNames[n])}));return r[2]=Moe(e,t),r[3]=Foe(e),Qr+Qe("Workbook",r.join(""),{xmlns:ta.ss,"xmlns:o":ta.o,"xmlns:x":ta.x,"xmlns:ss":ta.ss,"xmlns:dt":ta.dt,"xmlns:html":ta.html})}function Woe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=FZ(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=PZ(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var $oe=[60,1084,2066,2165,2175];function Goe(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=bo(r,r.l),f=B_[c],h=0;f!=null&&$oe.indexOf(c)>-1;)a=bo(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),o=r.slice(h,r.l+4+a),i.push(o),r.l+=4+a,f=B_[c=bo(r,r.l)];var p=jn(i);qn(p,0);var x=0;p.lens=[];for(var g=0;g<i.length;++g)p.lens.push(x),x+=i[g].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,s)}function Ti(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=yt[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Uo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=p0(e.v):e.w=Yc(e.v):e.w=Ha(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&pd(yt[n]||String(n))){var s=Tc(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Xm(e,t,r){return{v:e,ixfe:t,t:r}}function Koe(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],f="",h={},p,x="",g,v,y,w,_={},S=[],E,T,k=[],D=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},j=function(dt){return dt<8?Mc[dt]:dt<64&&D[dt-8]||Mc[dt]},J=function(dt,Bt,hr){var vt=Bt.XF.data;if(!(!vt||!vt.patternType||!hr||!hr.cellStyles)){Bt.s={},Bt.s.patternType=vt.patternType;var ir;(ir=v0(j(vt.icvFore)))&&(Bt.s.fgColor={rgb:ir}),(ir=v0(j(vt.icvBack)))&&(Bt.s.bgColor={rgb:ir})}},ae=function(dt,Bt,hr){if(!(K>1)&&!(hr.sheetRows&&dt.r>=hr.sheetRows)){if(hr.cellStyles&&Bt.XF&&Bt.XF.data&&J(dt,Bt,hr),delete Bt.ixfe,delete Bt.XF,p=dt,x=bt(dt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<i.s.r&&(i.s.r=dt.r),dt.c<i.s.c&&(i.s.c=dt.c),dt.r+1>i.e.r&&(i.e.r=dt.r+1),dt.c+1>i.e.c&&(i.e.c=dt.c+1),hr.cellFormula&&Bt.f){for(var vt=0;vt<S.length;++vt)if(!(S[vt][0].s.c>dt.c||S[vt][0].s.r>dt.r)&&!(S[vt][0].e.c<dt.c||S[vt][0].e.r<dt.r)){Bt.F=Ct(S[vt][0]),(S[vt][0].s.c!=dt.c||S[vt][0].s.r!=dt.r)&&delete Bt.f,Bt.f&&(Bt.f=""+is(S[vt][1],i,dt,ie,F));break}}hr.dense?(s[dt.r]||(s[dt.r]=[]),s[dt.r][dt.c]=Bt):s[x]=Bt}},F={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(F.password=t.password);var X,P=[],le=[],ee=[],te=[],me=!1,ie=[];ie.SheetNames=F.snames,ie.sharedf=F.sharedf,ie.arrayf=F.arrayf,ie.names=[],ie.XTI=[];var Ee=0,K=0,M=0,q=[],G=[],Z;F.codepage=1200,ri(1200);for(var re=!1;e.l<e.length-1;){var L=e.l,I=e.read_shift(2);if(I===0&&Ee===10)break;var se=e.l===e.length?0:e.read_shift(2),Q=B_[I];if(Q&&Q.f){if(t.bookSheets&&Ee===133&&I!==133)break;if(Ee=I,Q.r===2||Q.r==12){var Y=e.read_shift(2);if(se-=2,!F.enc&&Y!==I&&((Y&255)<<8|Y>>8)!==I)throw new Error("rt mismatch: "+Y+"!="+I);Q.r==12&&(e.l+=10,se-=10)}var U={};if(I===10?U=Q.f(e,se,F):U=Goe(I,Q,e,se,F),K==0&&[9,521,1033,2057].indexOf(Ee)===-1)continue;switch(I){case 34:r.opts.Date1904=O.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(e.l=0),F.enc=U,!t.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=U;break;case 66:var we=Number(U);switch(we){case 21010:we=1200;break;case 32768:we=1e4;break;case 32769:we=1252;break}ri(F.codepage=we),re=!0;break;case 317:F.rrtabid=U;break;case 25:F.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:F.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(s["!type"]="dialog"),U.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),U.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:k.push(U);break;case 430:ie.push([U]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(U);break;case 24:case 536:Z={Name:U.Name,Ref:is(U.rgce,i,null,ie,F)},U.itab>0&&(Z.Sheet=U.itab-1),ie.names.push(Z),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(G[U.itab-1]={ref:Ct(U.rgce[0][0][1][2])});break;case 22:F.ExternCount=U;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(U),ie.XTI=ie.XTI.concat(U);break;case 2196:if(F.biff<8)break;Z!=null&&(Z.Comment=U[1]);break;case 18:s["!protect"]=U;break;case 19:U!==0&&F.WTF&&console.error("Password verifier: "+U);break;case 133:a[U.pos]=U,F.snames.push(U.name);break;case 10:{if(--K)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Ct(i),t.sheetRows&&t.sheetRows<=i.e.r){var B=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ct(i),i.e.r=B}i.e.r++,i.e.c++}P.length>0&&(s["!merges"]=P),le.length>0&&(s["!objects"]=le),ee.length>0&&(s["!cols"]=ee),te.length>0&&(s["!rows"]=te),O.Sheets.push(z)}f===""?h=s:n[f]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[I]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),F.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(F.biff=5,re=!0,ri(F.codepage=28591)),F.biff==8&&U.BIFFVer==0&&U.dt==16&&(F.biff=2),K++)break;if(s=t.dense?[]:{},F.biff<8&&!re&&(re=!0,ri(F.codepage=t.codepage||1252)),F.biff<5||U.BIFFVer==0&&U.dt==4096){f===""&&(f="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var be={pos:e.l-se,name:f};a[be.pos]=be,F.snames.push(f)}else f=(a[L]||{name:""}).name;U.dt==32&&(s["!type"]="chart"),U.dt==64&&(s["!type"]="macro"),P=[],le=[],F.arrayf=S=[],ee=[],te=[],me=!1,z={Hidden:(a[L]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[U.r]||[])[U.c]:s[bt({c:U.c,r:U.r})])&&++U.c,E={ixfe:U.ixfe,XF:k[U.ixfe]||{},v:U.val,t:"n"},M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae({c:U.c,r:U.r},E,t);break;case 5:case 517:E={ixfe:U.ixfe,XF:k[U.ixfe],v:U.val,t:U.t},M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae({c:U.c,r:U.r},E,t);break;case 638:E={ixfe:U.ixfe,XF:k[U.ixfe],v:U.rknum,t:"n"},M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae({c:U.c,r:U.r},E,t);break;case 189:for(var V=U.c;V<=U.C;++V){var C=U.rkrec[V-U.c][0];E={ixfe:C,XF:k[C],v:U.rkrec[V-U.c][1],t:"n"},M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae({c:V,r:U.r},E,t)}break;case 6:case 518:case 1030:{if(U.val=="String"){o=U;break}if(E=Xm(U.val,U.cell.ixfe,U.tt),E.XF=k[E.ixfe],t.cellFormula){var A=U.formula;if(A&&A[0]&&A[0][0]&&A[0][0][0]=="PtgExp"){var H=A[0][0][1][0],ue=A[0][0][1][1],ye=bt({r:H,c:ue});_[ye]?E.f=""+is(U.formula,i,U.cell,ie,F):E.F=((t.dense?(s[H]||[])[ue]:s[ye])||{}).F}else E.f=""+is(U.formula,i,U.cell,ie,F)}M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae(U.cell,E,t),o=U}break;case 7:case 519:if(o)o.val=U,E=Xm(U,o.cell.ixfe,"s"),E.XF=k[E.ixfe],t.cellFormula&&(E.f=""+is(o.formula,i,o.cell,ie,F)),M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae(o.cell,E,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(U);var he=bt(U[0].s);if(g=t.dense?(s[U[0].s.r]||[])[U[0].s.c]:s[he],t.cellFormula&&g){if(!o||!he||!g)break;g.f=""+is(U[1],i,U[0],ie,F),g.F=Ct(U[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!o)break;_[bt(o.cell)]=U[0],g=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[bt(o.cell)],(g||{}).f=""+is(U[0],i,p,ie,F)}}break;case 253:E=Xm(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(E.h=c[U.isst].h),E.XF=k[E.ixfe],M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae({c:U.c,r:U.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:U.ixfe,XF:k[U.ixfe],t:"z"},M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae({c:U.c,r:U.r},E,t));break;case 190:if(t.sheetStubs)for(var ke=U.c;ke<=U.C;++ke){var De=U.ixfe[ke-U.c];E={ixfe:De,XF:k[De],t:"z"},M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae({c:ke,r:U.r},E,t)}break;case 214:case 516:case 4:E=Xm(U.val,U.ixfe,"s"),E.XF=k[E.ixfe],M>0&&(E.z=q[E.ixfe>>8&63]),Ti(E,t,r.opts.Date1904),ae({c:U.c,r:U.r},E,t);break;case 0:case 512:K===1&&(i=U);break;case 252:c=U;break;case 1054:if(F.biff==4){q[M++]=U[1];for(var Fe=0;Fe<M+163&&yt[Fe]!=U[1];++Fe);Fe>=163&&ko(U[1],M+163)}else ko(U[1],U[0]);break;case 30:{q[M++]=U;for(var $e=0;$e<M+163&&yt[$e]!=U;++$e);$e>=163&&ko(U,M+163)}break;case 229:P=P.concat(U);break;case 93:le[U.cmo[0]]=F.lastobj=U;break;case 438:F.lastobj.TxO=U;break;case 127:F.lastobj.ImData=U;break;case 440:for(w=U[0].s.r;w<=U[0].e.r;++w)for(y=U[0].s.c;y<=U[0].e.c;++y)g=t.dense?(s[w]||[])[y]:s[bt({c:y,r:w})],g&&(g.l=U[1]);break;case 2048:for(w=U[0].s.r;w<=U[0].e.r;++w)for(y=U[0].s.c;y<=U[0].e.c;++y)g=t.dense?(s[w]||[])[y]:s[bt({c:y,r:w})],g&&g.l&&(g.l.Tooltip=U[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;g=t.dense?(s[U[0].r]||[])[U[0].c]:s[bt(U[0])];var rt=le[U[2]];g||(t.dense?(s[U[0].r]||(s[U[0].r]=[]),g=s[U[0].r][U[0].c]={t:"z"}):g=s[bt(U[0])]={t:"z"},i.e.r=Math.max(i.e.r,U[0].r),i.s.r=Math.min(i.s.r,U[0].r),i.e.c=Math.max(i.e.c,U[0].c),i.s.c=Math.min(i.s.c,U[0].c)),g.c||(g.c=[]),v={a:U[1],t:rt.TxO.t},g.c.push(v)}break;case 2173:Mre(k[U.ixfe],U.ext);break;case 125:{if(!F.cellStyles)break;for(;U.e>=U.s;)ee[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},me||(me=!0,kS(U.w/256)),Hl(ee[U.e+1])}break;case 520:{var at={};U.level!=null&&(te[U.r]=at,at.level=U.level),U.hidden&&(te[U.r]=at,at.hidden=!0),U.hpt&&(te[U.r]=at,at.hpt=U.hpt,at.hpx=Pf(U.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Lc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[I]]=U;break;case 161:s["!margins"]||Lc(s["!margins"]={}),s["!margins"].header=U.header,s["!margins"].footer=U.footer;break;case 574:U.RTL&&(O.Views[0].RTL=!0);break;case 146:D=U;break;case 2198:X=U;break;case 140:T=U;break;case 442:f?z.CodeName=U||z.name:O.WBProps.CodeName=U||"ThisWorkbook";break}}else Q||console.error("Missing Info for XLS Record 0x"+I.toString(16)),e.l+=se}return r.SheetNames=Wr(a).sort(function(qt,dt){return Number(qt)-Number(dt)}).map(function(qt){return a[qt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&G.forEach(function(qt,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=qt}),r.Strings=c,r.SSF=kr(yt),F.enc&&(r.Encryption=F.enc),X&&(r.Themes=X),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),ie.names.length>0&&(O.Names=ie.names),r.Workbook=O,r}var Gh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Xoe(e,t,r){var n=mt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=u5(n,j_,Gh.DSI);for(var a in s)t[a]=s[a]}catch(f){if(r.WTF)throw f}var i=mt.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=u5(i,D_,Gh.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(wI(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Yoe(e,t){var r=[],n=[],s=[],a=0,i,o=U3(j_,"n"),c=U3(D_,"n");if(e.Props)for(i=Wr(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Wr(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var f=[];for(a=0;a<s.length;++a)AI.indexOf(s[a][0])>-1||bI.indexOf(s[a][0])>-1||s[a][1]!=null&&f.push(s[a]);n.length&&mt.utils.cfb_add(t,"/SummaryInformation",f5(n,Gh.SI,c,D_)),(r.length||f.length)&&mt.utils.cfb_add(t,"/DocumentSummaryInformation",f5(r,Gh.DSI,o,j_,f.length?f:null,Gh.UDI))}function EM(e,t){t||(t={}),FS(t),nS(),t.codepage&&rS(t.codepage);var r,n;if(e.FullPaths){if(mt.find(e,"/encryption"))throw new Error("File is password-protected");r=mt.find(e,"!CompObj"),n=mt.find(e,"/Workbook")||mt.find(e,"/Book")}else{switch(t.type){case"base64":e=na(ca(e));break;case"binary":e=na(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}qn(e,0),n={content:e}}var s,a;if(r&&Woe(r),t.bookProps&&!t.bookSheets)s={};else{var i=Ft?"buffer":"array";if(n&&n.content)s=Koe(n.content,t);else if((a=mt.find(e,"PerfectOffice_MAIN"))&&a.content)s=Pc.to_workbook(a.content,(t.type=i,t));else if((a=mt.find(e,"NativeContent_MAIN"))&&a.content)s=Pc.to_workbook(a.content,(t.type=i,t));else throw(a=mt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&mt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=cne(e))}var o={};return e.FullPaths&&Xoe(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function Joe(e,t){var r=t||{},n=mt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return mt.utils.cfb_add(n,s,SM(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Yoe(e,n),r.biff==8&&e.vbaraw&&une(n,mt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var E0={0:{f:wae},1:{f:Cae},2:{f:Kae},3:{f:Pae},4:{f:Dae},5:{f:Wae},6:{f:Qae},7:{f:zae},8:{f:iie},9:{f:aie},10:{f:nie},11:{f:sie},12:{f:Oae},13:{f:Yae},14:{f:Bae},15:{f:Mae},16:{f:mM},17:{f:tie},18:{f:Vae},19:{f:gS},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:toe},40:{},42:{},43:{f:Qte},44:{f:Jte},45:{f:rre},46:{f:sre},47:{f:nre},48:{},49:{f:SZ},50:{},51:{f:Lre},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:BI},62:{f:Zae},63:{f:Gre},64:{f:_ie},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ds,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yie},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:kae},148:{f:Sae,p:16},151:{f:die},152:{},153:{f:Zie},154:{},155:{},156:{f:Yie},157:{},158:{},159:{T:1,f:pte},160:{T:-1},161:{T:1,f:hu},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:oie},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Fre},336:{T:-1},337:{f:zre,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:O_},357:{},358:{},359:{},360:{T:1},361:{},362:{f:LI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hie},427:{f:pie},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xie},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Tae},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:uie},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:O_},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:sne},633:{T:1},634:{T:-1},635:{T:1,f:rne},636:{T:-1},637:{f:AZ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Bie},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Eie},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},B_={6:{f:Mb},10:{f:ml},12:{f:mn},13:{f:mn},14:{f:Kr},15:{f:Kr},16:{f:us},17:{f:Kr},18:{f:Kr},19:{f:mn},20:{f:g5},21:{f:g5},23:{f:LI},24:{f:v5},25:{f:Kr},26:{},27:{},28:{f:Eee},29:{},34:{f:Kr},35:{f:y5},38:{f:us},39:{f:us},40:{f:us},41:{f:us},42:{f:Kr},43:{f:Kr},47:{f:Mte},49:{f:YQ},51:{f:mn},60:{},61:{f:WQ},64:{f:Kr},65:{f:XQ},66:{f:mn},77:{},80:{},81:{},82:{},85:{f:mn},89:{},90:{},91:{},92:{f:IQ},93:{f:Tee},94:{},95:{f:Kr},96:{},97:{},99:{f:Kr},125:{f:BI},128:{f:fee},129:{f:FQ},130:{f:mn},131:{f:Kr},132:{f:Kr},133:{f:PQ},134:{},140:{f:Iee},141:{f:mn},144:{},146:{f:Pee},151:{},152:{},153:{},154:{},155:{},156:{f:mn},157:{},158:{},160:{f:qee},161:{f:Uee},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:oee},190:{f:lee},193:{f:ml},197:{},198:{},199:{},200:{},201:{},202:{f:Kr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:mn},220:{},221:{f:Kr},222:{},224:{f:uee},225:{f:DQ},226:{f:ml},227:{},229:{f:See},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:BQ},253:{f:ZQ},255:{f:zQ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:CI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Kr},353:{f:ml},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:xee},431:{f:Kr},432:{},433:{},434:{},437:{},438:{f:Cee},439:{f:Kr},440:{f:Ree},441:{},442:{f:np},443:{},444:{f:mn},445:{},446:{},448:{f:ml},449:{f:qQ,r:2},450:{f:ml},512:{f:p5},513:{f:Vee},515:{f:pee},516:{f:eee},517:{f:x5},519:{f:Wee},520:{f:HQ},523:{},545:{f:b5},549:{f:h5},566:{},574:{f:GQ},638:{f:iee},659:{},1048:{},1054:{f:ree},1084:{},1212:{f:bee},2048:{f:jee},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:$m},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ml},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Lee,r:12},2173:{f:Ire,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Kr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:vee,r:12},2197:{},2198:{f:Are,r:12},2199:{},2200:{},2201:{},2202:{f:wee,r:12},2203:{f:ml},2204:{},2205:{},2206:{},2207:{},2211:{f:VQ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:mn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:zee},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Fee},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:p5},1:{},2:{f:Yee},3:{f:Kee},4:{f:Gee},5:{f:x5},7:{f:Zee},8:{},9:{f:$m},11:{},22:{f:mn},30:{f:see},31:{},32:{},33:{f:b5},36:{},37:{f:h5},50:{f:Qee},62:{},52:{},67:{},68:{f:mn},69:{},86:{},126:{},127:{f:$ee},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:ete},223:{},234:{},354:{},421:{},518:{f:Mb},521:{f:$m},536:{f:v5},547:{f:y5},561:{},579:{},1030:{f:Mb},1033:{f:$m},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function et(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&pS(r)&&e.push(r)}}function Zoe(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return et(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,f=0;f+(i[o]||8224)<=8224;)f+=i[o]||8224,o++;var h=e.next(4);for(h.write_shift(2,a),h.write_shift(2,f),e.push(r.slice(c,c+f)),c+=f;c<s;){for(h=e.next(4),h.write_shift(2,60),f=0;f+(i[o]||8224)<=8224;)f+=i[o]||8224,o++;h.write_shift(2,f),e.push(r.slice(c,c+f)),c+=f}}}function op(e,t,r){return e||(e=Le(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Qoe(e,t,r,n){var s=Le(9);return op(s,e,t),RI(r,n||"b",s),s}function ele(e,t,r){var n=Le(8+2*r.length);return op(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function tle(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?wn(Tr(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?et(e,2,Jee(r,n,s)):et(e,3,Xee(r,n,s));return;case"b":case"e":et(e,5,Qoe(r,n,t.v,t.t));return;case"s":case"str":et(e,4,ele(r,n,(t.v||"").slice(0,255)));return}et(e,1,op(null,r,n))}function rle(e,t,r,n){var s=Array.isArray(t),a=Gt(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Ct(a)}for(var f=a.s.r;f<=a.e.r;++f){o=Jr(f);for(var h=a.s.c;h<=a.e.c;++h){f===a.s.r&&(c[h]=Dr(h)),i=c[h]+o;var p=s?(t[f]||[])[h]:t[i];p&&tle(e,p,f,h)}}}function nle(e,t){for(var r=t||{},n=Bs(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return et(n,r.biff==4?1033:r.biff==3?521:9,SS(e,16,r)),rle(n,e.Sheets[e.SheetNames[s]],s,r),et(n,10),n.end()}function sle(e,t,r){et(e,49,JQ({sz:12,name:"Arial"},r))}function ale(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&et(e,1054,nee(s,t[s],r))})}function ile(e,t){var r=Le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),et(e,2151,r),r=Le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),MI(Gt(t["!ref"]||"A1"),r),r.write_shift(4,4),et(e,2152,r)}function ole(e,t){for(var r=0;r<16;++r)et(e,224,m5({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){et(e,224,m5(n,0,t))})}function lle(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];et(e,440,Oee(n)),n[1].Tooltip&&et(e,2048,Dee(n))}delete t["!links"]}function cle(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&et(e,125,Bee(D1(s,n),s))})}}function ule(e,t,r,n,s){var a=16+Xl(s.cellXfs,t,s);if(t.v==null&&!t.bf){et(e,513,eu(r,n,a));return}if(t.bf)et(e,6,Fse(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?wn(Tr(t.v)):t.v;et(e,515,mee(r,n,i,a));break;case"b":case"e":et(e,517,hee(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=jS(s.Strings,t.v,s.revStrings);et(e,253,QQ(r,n,o,a))}else et(e,516,tee(r,n,(t.v||"").slice(0,255),a,s));break;default:et(e,513,eu(r,n,a))}}function fle(e,t,r){var n=Bs(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),f=t.biff==8,h,p="",x=[],g=Gt(a["!ref"]||"A1"),v=f?65536:16384;if(g.e.c>255||g.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,v-1)}et(n,2057,SS(r,16,t)),et(n,13,Ia(1)),et(n,12,Ia(100)),et(n,15,bs(!0)),et(n,17,bs(!1)),et(n,16,Zc(.001)),et(n,95,bs(!0)),et(n,42,bs(!1)),et(n,43,bs(!1)),et(n,130,Ia(1)),et(n,128,dee()),et(n,131,bs(!1)),et(n,132,bs(!1)),f&&cle(n,a["!cols"]),et(n,512,aee(g,t)),f&&(a["!links"]=[]);for(var y=g.s.r;y<=g.e.r;++y){p=Jr(y);for(var w=g.s.c;w<=g.e.c;++w){y===g.s.r&&(x[w]=Dr(w)),h=x[w]+p;var _=c?(a[y]||[])[w]:a[h];_&&(ule(n,_,y,w,t),f&&_.l&&a["!links"].push([h,_.l]))}}var S=o.CodeName||o.name||s;return f&&et(n,574,KQ((i.Views||[])[0])),f&&(a["!merges"]||[]).length&&et(n,229,Nee(a["!merges"])),f&&lle(n,a),et(n,442,OI(S)),f&&ile(n,a),et(n,10),n.end()}function dle(e,t,r){var n=Bs(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(et(n,2057,SS(e,5,r)),r.bookType=="xla"&&et(n,135),et(n,225,o?Ia(1200):null),et(n,193,hQ(2)),c&&et(n,191),c&&et(n,192),et(n,226),et(n,92,MQ("SheetJS",r)),et(n,66,Ia(o?1200:1252)),o&&et(n,353,Ia(0)),o&&et(n,448),et(n,317,Hee(e.SheetNames.length)),o&&e.vbaraw&&et(n,211),o&&e.vbaraw){var f=i.CodeName||"ThisWorkbook";et(n,442,OI(f))}et(n,156,Ia(17)),et(n,25,bs(!1)),et(n,18,bs(!1)),et(n,19,Ia(0)),o&&et(n,431,bs(!1)),o&&et(n,444,Ia(0)),et(n,61,$Q()),et(n,64,bs(!1)),et(n,141,Ia(0)),et(n,34,bs(qie(e)=="true")),et(n,14,bs(!0)),o&&et(n,439,bs(!1)),et(n,218,Ia(0)),sle(n,e,r),ale(n,e.SSF,r),ole(n,r),o&&et(n,352,bs(!1));var h=n.end(),p=Bs();o&&et(p,140,Mee()),o&&r.Strings&&Zoe(p,252,UQ(r.Strings)),et(p,10);var x=p.end(),g=Bs(),v=0,y=0;for(y=0;y<e.SheetNames.length;++y)v+=(o?12:11)+(o?2:1)*e.SheetNames[y].length;var w=h.length+v+x.length;for(y=0;y<e.SheetNames.length;++y){var _=a[y]||{};et(g,133,LQ({pos:w,hs:_.Hidden||0,dt:0,name:e.SheetNames[y]},r)),w+=t[y].length}var S=g.end();if(v!=S.length)throw new Error("BS8 "+v+" != "+S.length);var E=[];return h.length&&E.push(h),S.length&&E.push(S),x.length&&E.push(x),jn(E)}function hle(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=kr(yt)),e&&e.SSF&&(md(),T1(e.SSF),r.revssf=A1(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,PS(r),r.cellXfs=[],Xl(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=fle(s,r,e);return n.unshift(dle(e,n,r)),jn(n)}function SM(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Hs(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return hle(e,t);case 4:case 3:case 2:return nle(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function R5(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=JJ(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,p=0,x=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<c.length;++i){var y=c[i].trim(),w=y.slice(0,3).toLowerCase();if(w=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(w!="<td"&&w!="<th")){var _=y.split(/<\/t[dh]>/i);for(o=0;o<_.length;++o){var S=_[o].trim();if(S.match(/<t[dh]/i)){for(var E=S,T=0;E.charAt(0)=="<"&&(T=E.indexOf(">"))>-1;)E=E.slice(T+1);for(var k=0;k<v.length;++k){var D=v[k];D.s.c==h&&D.s.r<f&&f<=D.e.r&&(h=D.e.c+1,k=-1)}var O=_t(S.slice(0,S.indexOf(">")));x=O.colspan?+O.colspan:1,((p=+O.rowspan)>1||x>1)&&v.push({s:{r:f,c:h},e:{r:f+(p||1)-1,c:h+x-1}});var z=O.t||O["data-t"]||"";if(!E.length){h+=x;continue}if(E=KD(E),g.s.r>f&&(g.s.r=f),g.e.r<f&&(g.e.r=f),g.s.c>h&&(g.s.c=h),g.e.c<h&&(g.e.c=h),!E.length){h+=x;continue}var j={t:"s",v:E};r.raw||!E.trim().length||z=="s"||(E==="TRUE"?j={t:"b",v:!0}:E==="FALSE"?j={t:"b",v:!1}:isNaN(ai(E))?isNaN(Mf(E).getDate())||(j={t:"d",v:Tr(E)},r.cellDates||(j={t:"n",v:wn(j.v)}),j.z=r.dateNF||yt[14]):j={t:"n",v:ai(E)}),r.dense?(n[f]||(n[f]=[]),n[f][h]=j):n[bt({r:f,c:h})]=j,h+=x}}}}return n["!ref"]=Ct(g),v.length&&(n["!merges"]=v),n}function ple(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,f=0;f<s.length;++f)if(!(s[f].s.r>r||s[f].s.c>i)&&!(s[f].e.r<r||s[f].e.c<i)){if(s[f].s.r<r||s[f].s.c<i){o=-1;break}o=s[f].e.r-s[f].s.r+1,c=s[f].e.c-s[f].s.c+1;break}if(!(o<0)){var h=bt({r,c:i}),p=n.dense?(e[r]||[])[i]:e[h],x=p&&p.v!=null&&(p.h||fS(p.w||(Io(p),p.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?x='<span contenteditable="true">'+x+"</span>":p&&(g["data-t"]=p&&p.t||"z",p.v!=null&&(g["data-v"]=p.v),p.z!=null&&(g["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+p.l.Target+'">'+x+"</a>")),g.id=(n.id||"sjs")+"-"+h,a.push(Qe("td",x,g))}}var v="<tr>";return v+a.join("")+"</tr>"}var mle='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',xle="</body></html>";function gle(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Kl(R5(r[0],t),t);var n=US();return r.forEach(function(s,a){zS(n,R5(s,t),"Sheet"+(a+1))}),n}function yle(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function NM(e,t){var r=t||{},n=r.header!=null?r.header:mle,s=r.footer!=null?r.footer:xle,a=[n],i=Hs(e["!ref"]);r.dense=Array.isArray(e),a.push(yle(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(ple(e,i,o,r));return a.push("</table>"+s),a.join("")}function TM(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Ir(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var h=Hs(e["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),s==-1&&(f.e.r=s=h.e.r+1)}var p=[],x=0,g=e["!rows"]||(e["!rows"]=[]),v=0,y=0,w=0,_=0,S=0,E=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&y<c;++v){var T=o[v];if(O5(T)){if(n.display)continue;g[y]={hidden:!0}}var k=T.children;for(w=_=0;w<k.length;++w){var D=k[w];if(!(n.display&&O5(D))){var O=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):KD(D.innerHTML),z=D.getAttribute("data-z")||D.getAttribute("z");for(x=0;x<p.length;++x){var j=p[x];j.s.c==_+a&&j.s.r<y+s&&y+s<=j.e.r&&(_=j.e.c+1-a,x=-1)}E=+D.getAttribute("colspan")||1,((S=+D.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:y+s,c:_+a},e:{r:y+s+(S||1)-1,c:_+a+(E||1)-1}});var J={t:"s",v:O},ae=D.getAttribute("data-t")||D.getAttribute("t")||"";O!=null&&(O.length==0?J.t=ae||"z":n.raw||O.trim().length==0||ae=="s"||(O==="TRUE"?J={t:"b",v:!0}:O==="FALSE"?J={t:"b",v:!1}:isNaN(ai(O))?isNaN(Mf(O).getDate())||(J={t:"d",v:Tr(O)},n.cellDates||(J={t:"n",v:wn(J.v)}),J.z=n.dateNF||yt[14]):J={t:"n",v:ai(O)})),J.z===void 0&&z!=null&&(J.z=z);var F="",X=D.getElementsByTagName("A");if(X&&X.length)for(var P=0;P<X.length&&!(X[P].hasAttribute("href")&&(F=X[P].getAttribute("href"),F.charAt(0)!="#"));++P);F&&F.charAt(0)!="#"&&(J.l={Target:F}),n.dense?(e[y+s]||(e[y+s]=[]),e[y+s][_+a]=J):e[bt({c:_+a,r:y+s})]=J,f.e.c<_+a&&(f.e.c=_+a),_+=E}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+s),e["!ref"]=Ct(f),y>=c&&(e["!fullref"]=Ct((f.e.r=o.length-v+y-1+s,f))),e}function kM(e,t){var r=t||{},n=r.dense?[]:{};return TM(n,e,t)}function vle(e,t){return Kl(kM(e,t),t)}function O5(e){var t="",r=ble(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function ble(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function wle(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=$t(t.replace(/<[^>]*>/g,""));return[r]}var j5={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function AM(e,t){var r=t||{},n=dS(e),s=[],a,i,o={name:""},c="",f=0,h,p,x={},g=[],v=r.dense?[]:{},y,w,_={value:""},S="",E=0,T=[],k=-1,D=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,j={},J=[],ae={},F=0,X=0,P=[],le=1,ee=1,te=[],me={Names:[]},ie={},Ee=["",""],K=[],M={},q="",G=0,Z=!1,re=!1,L=0;for(g0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=g0.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?v["!ref"]=Ct(O):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=O.e.r&&(v["!fullref"]=v["!ref"],O.e.r=r.sheetRows-1,v["!ref"]=Ct(O)),J.length&&(v["!merges"]=J),P.length&&(v["!rows"]=P),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),g.push(h.name),x[h.name]=v,re=!1):y[0].charAt(y[0].length-2)!=="/"&&(h=_t(y[0],!1),k=D=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,v=r.dense?[]:{},J=[],P=[],re=!0);break;case"table-row-group":y[1]==="/"?--z:++z;break;case"table-row":case"":if(y[1]==="/"){k+=le,le=1;break}if(p=_t(y[0],!1),p.?k=p.-1:k==-1&&(k=0),le=+p["number-rows-repeated"]||1,le<10)for(L=0;L<le;++L)z>0&&(P[k+L]={level:z});D=-1;break;case"covered-table-cell":y[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(v[k]||(v[k]=[]),v[k][D]={t:"z"}):v[bt({r:k,c:D})]={t:"z"}),S="",T=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++D,_=_t(y[0],!1),ee=parseInt(_["number-columns-repeated"]||"1",10),w={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(w.f=k5($t(_.formula))),(_.||_["value-type"])=="string"&&(w.t="s",w.v=$t(_["string-value"]||""),r.dense?(v[k]||(v[k]=[]),v[k][D]=w):v[bt({r:k,c:D})]=w),D+=ee-1;else if(y[1]!=="/"){++D,S="",E=0,T=[],ee=1;var I=le?k+le-1:k;if(D>O.e.c&&(O.e.c=D),D<O.s.c&&(O.s.c=D),k<O.s.r&&(O.s.r=k),I>O.e.r&&(O.e.r=I),_=_t(y[0],!1),K=[],M={},w={t:_.||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=$t(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(F=parseInt(_["number-matrix-rows-spanned"],10)||0,X=parseInt(_["number-matrix-columns-spanned"],10)||0,ae={s:{r:k,c:D},e:{r:k+F-1,c:D+X-1}},w.F=Ct(ae),te.push([ae,w.F])),_.formula)w.f=k5(_.formula);else for(L=0;L<te.length;++L)k>=te[L][0].s.r&&k<=te[L][0].e.r&&D>=te[L][0].s.c&&D<=te[L][0].e.c&&(w.F=te[L][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(F=parseInt(_["number-rows-spanned"],10)||0,X=parseInt(_["number-columns-spanned"],10)||0,ae={s:{r:k,c:D},e:{r:k+F-1,c:D+X-1}},J.push(ae)),_["number-columns-repeated"]&&(ee=parseInt(_["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Nr(_["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(_.value);break;case"percentage":w.t="n",w.v=parseFloat(_.value);break;case"currency":w.t="n",w.v=parseFloat(_.value);break;case"date":w.t="d",w.v=Tr(_["date-value"]),r.cellDates||(w.t="n",w.v=wn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=KJ(_["time-value"])/86400,r.cellDates&&(w.t="d",w.v=C1(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(_.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",_["string-value"]!=null&&(S=$t(_["string-value"]),T=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Z=!1,w.t==="s"&&(w.v=S||"",T.length&&(w.R=T),Z=E==0),ie.Target&&(w.l=ie),K.length>0&&(w.c=K,K=[]),S&&r.cellText!==!1&&(w.w=S),Z&&(w.t="z",delete w.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var se=0;se<le;++se){if(ee=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(v[k+se]||(v[k+se]=[]),v[k+se][D]=se==0?w:kr(w);--ee>0;)v[k+se][D+ee]=kr(w);else for(v[bt({r:k+se,c:D})]=w;--ee>0;)v[bt({r:k+se,c:D+ee})]=kr(w);O.e.c<=D&&(O.e.c=D)}ee=parseInt(_["number-columns-repeated"]||"1",10),D+=ee-1,ee=0,w={},S="",T=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((a=s.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((a=s.pop())[0]!==y[3])throw"Bad state: "+a;M.t=S,T.length&&(M.R=T),M.a=q,K.push(M)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);q="",G=0,S="",E=0,T=[];break;case"creator":y[1]==="/"?q=n.slice(G,y.index):G=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((a=s.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);S="",E=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(j[o.name]=c,(a=s.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&(c="",o=_t(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=_t(y[0],!1),c+=j5[y[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=_t(y[0],!1),c+=j5[y[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":i=_t(y[0],!1),Ee=Fb(i["cell-range-address"]);var Q={Name:i.name,Ref:Ee[0]+"!"+Ee[1]};re&&(Q.Sheet=g.length),me.Names.push(Q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!_||!_["string-value"])){var Y=wle(n.slice(E,y.index));S=(S.length>0?S+`
`:"")+Y[0]}else _t(y[0],!1),E=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{Ee=Fb(_t(y[0])["target-range-address"]),x[Ee[0]]["!autofilter"]={ref:Ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(ie=_t(y[0],!1),!ie.href)break;ie.Target=$t(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Ee=Fb(ie.Target.slice(1)),ie.Target="#"+Ee[0]+"!"+Ee[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var U={Sheets:x,SheetNames:g,Workbook:me};return r.bookSheets&&delete U.Sheets,U}function D5(e,t){t=t||{},Oa(e,"META-INF/manifest.xml")&&KZ(pn(e,"META-INF/manifest.xml"),t);var r=sa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=AM(dr(r),t);return Oa(e,"meta.xml")&&(n.Props=yI(pn(e,"meta.xml"))),n}function I5(e,t){return AM(e,t)}var _le=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+x0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qr+t}})(),M5=(function(){var e=function(a){return sr(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+sr(i.SheetNames[o])+`" table:style-name="ta1">
`);var f=0,h=0,p=Hs(a["!ref"]||"A1"),x=a["!merges"]||[],g=0,v=Array.isArray(a);if(a["!cols"])for(h=0;h<=p.e.c;++h)c.push("        <table:table-column"+(a["!cols"][h]?' table:style-name="co'+a["!cols"][h].ods+'"':"")+`></table:table-column>
`);var y="",w=a["!rows"]||[];for(f=0;f<p.s.r;++f)y=w[f]?' table:style-name="ro'+w[f].ods+'"':"",c.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=p.e.r;++f){for(y=w[f]?' table:style-name="ro'+w[f].ods+'"':"",c.push("        <table:table-row"+y+`>
`),h=0;h<p.s.c;++h)c.push(t);for(;h<=p.e.c;++h){var _=!1,S={},E="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>h)&&!(x[g].s.r>f)&&!(x[g].e.c<h)&&!(x[g].e.r<f)){(x[g].s.c!=h||x[g].s.r!=f)&&(_=!0),S["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,S["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(_){c.push(r);continue}var T=bt({r:f,c:h}),k=v?(a[f]||[])[h]:a[T];if(k&&k.f&&(S["table:formula"]=sr(Hse(k.f)),k.F&&k.F.slice(0,T.length)==T)){var D=Hs(k.F);S["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,S["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!k){c.push(t);continue}switch(k.t){case"b":E=k.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=k.v?"true":"false";break;case"n":E=k.w||String(k.v||0),S["office:value-type"]="float",S["office:value"]=k.v||0;break;case"s":case"str":E=k.v==null?"":k.v,S["office:value-type"]="string";break;case"d":E=k.w||Tr(k.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Tr(k.v).toISOString(),S["table:style-name"]="ce1";break;default:c.push(t);continue}var O=e(E);if(k.l&&k.l.Target){var z=k.l.Target;z=z.charAt(0)=="#"?"#"+Vse(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),O=Qe("text:a",O,{"xlink:href":z.replace(/&/g,"&amp;")})}c.push("          "+Qe("table:table-cell",Qe("text:p",O,{}),S)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var h=0;h<f["!cols"].length;++h)if(f["!cols"][h]){var p=f["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Hl(p),p.ods=o;var x=f["!cols"][h].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var h=0;h<f["!rows"].length;++h)if(f["!rows"][h]){f["!rows"][h].ods=c;var p=f["!rows"][h].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[Qr],f=x0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=x0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+f+h+`>
`),c.push(gI().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+f+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=i.SheetNames.length;++p)c.push(n(i.Sheets[i.SheetNames[p]],i,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function CM(e,t){if(t.bookType=="fods")return M5(e,t);var r=lS(),n="",s=[],a=[];return n="mimetype",Ot(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ot(r,n,M5(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Ot(r,n,_le(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Ot(r,n,Qr+gI()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Ot(r,n,JZ(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ot(r,n,XZ(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function tu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function U_(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):dr(Gl(e))}function Ele(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):na(Mi(e))}function Sle(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ql(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function F5(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Nle(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Tle(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function S0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function tr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function qr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Yt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=S0(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=S0(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var f={data:o,type:a};t[s]==null?t[s]=[f]:t[s].push(f)}return t}function Hn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(tr(n*8+s.type)),s.type==2&&t.push(tr(s.data.length)),t.push(s.data))})}),ql(t)}function MS(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Aa(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=S0(e,n),a=Yt(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:qr(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=Yt(o.data),f=qr(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(i.merge=qr(a[3][0].data)>>>0>0),r.push(i)}return r}function tf(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:tr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:tr(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:tr(i.data.length)}],n[2].push({data:Hn(i.meta),type:2})});var a=Hn(n);t.push(tr(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),ql(t)}function kle(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=S0(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[ql(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(f>=c)for(s.push(s[0].slice(-c)),f-=c;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-c,-c+f))}}var h=ql(s);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Ca(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(kle(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ql(t)}function rf(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=tr(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return ql(t)}function Ale(e,t,r,n){var s=tu(e),a=s.getUint32(4,!0),i=(n>1?12:8)+F5(a&(n>1?3470:398))*4,o=-1,c=-1,f=NaN,h=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=F5(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(f=s.getFloat64(i,!0),i+=8),a&64&&(h.setTime(h.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(c>-1)p={t:"s",v:t[c]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function Cle(e,t,r){var n=tu(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,f=NaN,h=new Date(2001,0,1);s&1&&(c=Nle(e,a),a+=16),s&2&&(f=n.getFloat64(a,!0),a+=8),s&4&&(h.setTime(h.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(i>-1)p={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return p}function Lb(e,t){var r=new Uint8Array(32),n=tu(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Tle(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Bb(e,t){var r=new Uint8Array(32),n=tu(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Rle(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ale(e,t,r,e[0]);case 5:return Cle(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function as(e){var t=Yt(e);return S0(t[1][0].data)}function P5(e,t){var r=Yt(t.data),n=qr(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Yt(i.data),c=qr(o[1][0].data)>>>0;switch(n){case 1:a[c]=U_(o[3][0].data);break;case 8:{var f=e[as(o[9][0].data)][0],h=Yt(f.data),p=e[as(h[1][0].data)][0],x=qr(p.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var g=Yt(p.data);a[c]=g[3].map(function(v){return U_(v.data)}).join("")}break}}),a}function Ole(e,t){var r,n,s,a,i,o,c,f,h,p,x,g,v,y,w=Yt(e),_=qr(w[1][0].data)>>>0,S=qr(w[2][0].data)>>>0,E=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&qr(w[8][0].data)>0||!1,T,k;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)T=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,k=(f=(c=w[6])==null?void 0:c[0])==null?void 0:f.data;else if((p=(h=w[4])==null?void 0:h[0])!=null&&p.data&&t!=1)T=(g=(x=w[4])==null?void 0:x[0])==null?void 0:g.data,k=(y=(v=w[3])==null?void 0:v[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=E?4:1,O=tu(T),z=[],j=0;j<T.length/2;++j){var J=O.getUint16(j*2,!0);J<65535&&z.push([j,J])}if(z.length!=S)throw"Expected ".concat(S," cells, found ").concat(z.length);var ae=[];for(j=0;j<z.length-1;++j)ae[z[j][0]]=k.subarray(z[j][1]*D,z[j+1][1]*D);return z.length>=1&&(ae[z[z.length-1][0]]=k.subarray(z[z.length-1][1]*D)),{R:_,cells:ae}}function jle(e,t){var r,n=Yt(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?qr(n[7][0].data)>>>0>0?1:0:-1,a=MS(n[5],function(i){return Ole(i,s)});return{nrows:qr(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,f){if(i[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));i[o.R][f]=c}),i},[])}}function Dle(e,t,r){var n,s=Yt(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(qr(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(qr(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ct(a);var i=Yt(s[4][0].data),o=P5(e,e[as(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?P5(e,e[as(i[17][0].data)][0]):[],f=Yt(i[3][0].data),h=0;f[1].forEach(function(p){var x=Yt(p.data),g=e[as(x[2][0].data)][0],v=qr(g.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var y=jle(e,g);y.data.forEach(function(w,_){w.forEach(function(S,E){var T=bt({r:h+_,c:E}),k=Rle(S,o,c);k&&(r[T]=k)})}),h+=y.nrows})}function Ile(e,t){var r=Yt(t.data),n={"!ref":"A1"},s=e[as(r[2][0].data)],a=qr(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Dle(e,s[0],n),n}function Mle(e,t){var r,n=Yt(t.data),s={name:(r=n[1])!=null&&r[0]?U_(n[1][0].data):"",sheets:[]},a=MS(n[2],as);return a.forEach(function(i){e[i].forEach(function(o){var c=qr(o.meta[1][0].data);c==6e3&&s.sheets.push(Ile(e,o))})}),s}function Fle(e,t){var r=US(),n=Yt(t.data),s=MS(n[1],as);if(s.forEach(function(a){e[a].forEach(function(i){var o=qr(i.meta[1][0].data);if(o==2){var c=Mle(e,i);c.sheets.forEach(function(f,h){zS(r,f,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ub(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var f;try{f=Ca(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var h;try{h=Aa(f)}catch(p){return console.log("## "+(p.message||p))}h.forEach(function(p){a[p.id]=p.messages,i.push(p.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&qr(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(f){var h=qr(f.meta[1][0].data)>>>0;if(h==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Fle(a,o)}function Ple(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&qr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,f=tu(e[7][0].data),h=0,p=[],x=tu(e[4][0].data),g=0,v=[],y=0;y<t.length;++y){if(t[y]==null){f.setUint16(y*2,65535,!0),x.setUint16(y*2,65535);continue}f.setUint16(y*2,h,!0),x.setUint16(y*2,g,!0);var w,_;switch(typeof t[y]){case"string":w=Lb({t:"s",v:t[y]},r),_=Bb({t:"s",v:t[y]},r);break;case"number":w=Lb({t:"n",v:t[y]},r),_=Bb({t:"n",v:t[y]},r);break;case"boolean":w=Lb({t:"b",v:t[y]},r),_=Bb({t:"b",v:t[y]},r);break;default:throw new Error("Unsupported value "+t[y])}p.push(w),h+=w.length,v.push(_),g+=_.length,++c}for(e[2][0].data=tr(c);y<e[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),x.setUint16(y*2,65535,!0);return e[6][0].data=ql(p),e[3][0].data=ql(v),c}function Lle(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Hs(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Ct(n)));var a=ug(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(q){return q.forEach(function(G){typeof G=="string"&&i.push(G)})});var o={},c=[],f=mt.read(t.numbers,{type:"base64"});f.FileIndex.map(function(q,G){return[q,f.FullPaths[G]]}).forEach(function(q){var G=q[0],Z=q[1];if(G.type==2&&G.name.match(/\.iwa/)){var re=G.content,L=Ca(re),I=Aa(L);I.forEach(function(se){c.push(se.id),o[se.id]={deps:[],location:Z,type:qr(se.messages[0].meta[1][0].data)}})}}),c.sort(function(q,G){return q-G});var h=c.filter(function(q){return q>1}).map(function(q){return[q,tr(q)]});f.FileIndex.map(function(q,G){return[q,f.FullPaths[G]]}).forEach(function(q){var G=q[0];if(q[1],!!G.name.match(/\.iwa/)){var Z=Aa(Ca(G.content));Z.forEach(function(re){re.messages.forEach(function(L){h.forEach(function(I){re.messages.some(function(se){return qr(se.meta[1][0].data)!=11006&&Sle(se.data,I[1])})&&o[I[0]].deps.push(re.id)})})})}});for(var p=mt.find(f,o[1].location),x=Aa(Ca(p.content)),g,v=0;v<x.length;++v){var y=x[v];y.id==1&&(g=y)}var w=as(Yt(g.messages[0].data)[1][0].data);for(p=mt.find(f,o[w].location),x=Aa(Ca(p.content)),v=0;v<x.length;++v)y=x[v],y.id==w&&(g=y);for(w=as(Yt(g.messages[0].data)[2][0].data),p=mt.find(f,o[w].location),x=Aa(Ca(p.content)),v=0;v<x.length;++v)y=x[v],y.id==w&&(g=y);for(w=as(Yt(g.messages[0].data)[2][0].data),p=mt.find(f,o[w].location),x=Aa(Ca(p.content)),v=0;v<x.length;++v)y=x[v],y.id==w&&(g=y);var _=Yt(g.messages[0].data);{_[6][0].data=tr(n.e.r+1),_[7][0].data=tr(n.e.c+1);var S=as(_[46][0].data),E=mt.find(f,o[S].location),T=Aa(Ca(E.content));{for(var k=0;k<T.length&&T[k].id!=S;++k);if(T[k].id!=S)throw"Bad ColumnRowUIDMapArchive";var D=Yt(T[k].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var O=0;O<=n.e.c;++O){var z=[];z[1]=z[2]=[{type:0,data:tr(O+420690)}],D[1].push({type:2,data:Hn(z)}),D[2].push({type:0,data:tr(O)}),D[3].push({type:0,data:tr(O)})}D[4]=[],D[5]=[],D[6]=[];for(var j=0;j<=n.e.r;++j)z=[],z[1]=z[2]=[{type:0,data:tr(j+726270)}],D[4].push({type:2,data:Hn(z)}),D[5].push({type:0,data:tr(j)}),D[6].push({type:0,data:tr(j)});T[k].messages[0].data=Hn(D)}E.content=rf(tf(T)),E.size=E.content.length,delete _[46];var J=Yt(_[4][0].data);{J[7][0].data=tr(n.e.r+1);var ae=Yt(J[1][0].data),F=as(ae[2][0].data);E=mt.find(f,o[F].location),T=Aa(Ca(E.content));{if(T[0].id!=F)throw"Bad HeaderStorageBucket";var X=Yt(T[0].messages[0].data);for(j=0;j<a.length;++j){var P=Yt(X[2][0].data);P[1][0].data=tr(j),P[4][0].data=tr(a[j].length),X[2][j]={type:X[2][0].type,data:Hn(P)}}T[0].messages[0].data=Hn(X)}E.content=rf(tf(T)),E.size=E.content.length;var le=as(J[2][0].data);E=mt.find(f,o[le].location),T=Aa(Ca(E.content));{if(T[0].id!=le)throw"Bad HeaderStorageBucket";for(X=Yt(T[0].messages[0].data),O=0;O<=n.e.c;++O)P=Yt(X[2][0].data),P[1][0].data=tr(O),P[4][0].data=tr(n.e.r+1),X[2][O]={type:X[2][0].type,data:Hn(P)};T[0].messages[0].data=Hn(X)}E.content=rf(tf(T)),E.size=E.content.length;var ee=as(J[4][0].data);(function(){for(var q=mt.find(f,o[ee].location),G=Aa(Ca(q.content)),Z,re=0;re<G.length;++re){var L=G[re];L.id==ee&&(Z=L)}var I=Yt(Z.messages[0].data);{I[3]=[];var se=[];i.forEach(function(U,we){se[1]=[{type:0,data:tr(we)}],se[2]=[{type:0,data:tr(1)}],se[3]=[{type:2,data:Ele(U)}],I[3].push({type:2,data:Hn(se)})})}Z.messages[0].data=Hn(I);var Q=tf(G),Y=rf(Q);q.content=Y,q.size=q.content.length})();var te=Yt(J[3][0].data);{var me=te[1][0];delete te[2];var ie=Yt(me.data);{var Ee=as(ie[2][0].data);(function(){for(var q=mt.find(f,o[Ee].location),G=Aa(Ca(q.content)),Z,re=0;re<G.length;++re){var L=G[re];L.id==Ee&&(Z=L)}var I=Yt(Z.messages[0].data);{delete I[6],delete te[7];var se=new Uint8Array(I[5][0].data);I[5]=[];for(var Q=0,Y=0;Y<=n.e.r;++Y){var U=Yt(se);Q+=Ple(U,a[Y],i),U[1][0].data=tr(Y),I[5].push({data:Hn(U),type:2})}I[1]=[{type:0,data:tr(n.e.c+1)}],I[2]=[{type:0,data:tr(n.e.r+1)}],I[3]=[{type:0,data:tr(Q)}],I[4]=[{type:0,data:tr(n.e.r+1)}]}Z.messages[0].data=Hn(I);var we=tf(G),B=rf(we);q.content=B,q.size=q.content.length})()}me.data=Hn(ie)}J[3][0].data=Hn(te)}_[4][0].data=Hn(J)}g.messages[0].data=Hn(_);var K=tf(x),M=rf(K);return p.content=M,p.size=p.content.length,f}function RM(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function FS(e){RM([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function PS(e){RM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Ble(e){return Lt.WS.indexOf(e)>-1?"sheet":e==Lt.CS?"chart":e==Lt.DS?"dialog":e==Lt.MS?"macro":e&&e.length?e:"sheet"}function Ule(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Ble(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function zle(e,t,r,n,s,a,i,o,c,f,h,p){try{a[n]=Vh(sa(e,r,!0),t);var x=pn(e,t),g;switch(o){case"sheet":g=coe(x,t,s,c,a[n],f,h,p);break;case"chart":if(g=uoe(x,t,s,c,a[n],f,h,p),!g||!g["!drawel"])break;var v=jh(g["!drawel"].Target,t),y=y0(v),w=Yre(sa(e,v,!0),Vh(sa(e,y,!0),v)),_=jh(w,v),S=y0(_);g=Pie(sa(e,_,!0),_,c,Vh(sa(e,S,!0),_),f,g);break;case"macro":g=foe(x,t,s,c,a[n],f,h,p);break;case"dialog":g=doe(x,t,s,c,a[n],f,h,p);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=g;var E=[];a&&a[n]&&Wr(a[n]).forEach(function(T){var k="";if(a[n][T].Type==Lt.CMNT){k=jh(a[n][T].Target,t);var D=xoe(pn(e,k,!0),k,c);if(!D||!D.length)return;_5(g,D,!1)}a[n][T].Type==Lt.TCMNT&&(k=jh(a[n][T].Target,t),E=E.concat(Zre(pn(e,k,!0),c)))}),E&&E.length&&_5(g,E,!0,c.people||[])}catch(T){if(c.WTF)throw T}}function Sa(e){return e.charAt(0)=="/"?e.slice(1):e}function Hle(e,t){if(md(),t=t||{},FS(t),Oa(e,"META-INF/manifest.xml")||Oa(e,"objectdata.xml"))return D5(e,t);if(Oa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ub<"u"){if(e.FileIndex)return Ub(e);var r=mt.utils.cfb_new();return V3(e).forEach(function(P){Ot(r,P,QJ(e,P))}),Ub(r)}throw new Error("Unsupported NUMBERS file")}if(!Oa(e,"[Content_Types].xml"))throw Oa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Oa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=V3(e),s=$Z(sa(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",pn(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!pn(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},f={};if(!t.bookSheets&&!t.bookProps){if(qh=[],s.sst)try{qh=moe(pn(e,Sa(s.sst)),s.sst,t)}catch(P){if(t.WTF)throw P}t.cellStyles&&s.themes.length&&(c=poe(sa(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(f=hoe(pn(e,Sa(s.style)),s.style,c,t))}s.links.map(function(P){try{var le=Vh(sa(e,y0(Sa(P))),P);return yoe(pn(e,Sa(P)),le,P,t)}catch{}});var h=loe(pn(e,Sa(s.workbooks[0])),s.workbooks[0],t),p={},x="";s.coreprops.length&&(x=pn(e,Sa(s.coreprops[0]),!0),x&&(p=yI(x)),s.extprops.length!==0&&(x=pn(e,Sa(s.extprops[0]),!0),x&&QZ(x,p,t)));var g={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(x=sa(e,Sa(s.custprops[0]),!0),x&&(g=tQ(x,t)));var v={};if((t.bookSheets||t.bookProps)&&(h.Sheets?i=h.Sheets.map(function(le){return le.name}):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),t.bookProps&&(v.Props=p,v.Custprops=g),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var y={};t.bookDeps&&s.calcchain&&(y=goe(pn(e,Sa(s.calcchain)),s.calcchain));var w=0,_={},S,E;{var T=h.Sheets;p.Worksheets=T.length,p.SheetNames=[];for(var k=0;k!=T.length;++k)p.SheetNames[k]=T[k].name}var D=a?"bin":"xml",O=s.workbooks[0].lastIndexOf("/"),z=(s.workbooks[0].slice(0,O+1)+"_rels/"+s.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");Oa(e,z)||(z="xl/_rels/workbook."+D+".rels");var j=Vh(sa(e,z,!0),z.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=voe(pn(e,Sa(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=ene(pn(e,Sa(s.people[0])),t)),j&&(j=Ule(j,h.Sheets));var J=pn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=p.Worksheets;++w){var ae="sheet";if(j&&j[w]?(S="xl/"+j[w][1].replace(/[\/]?xl\//,""),Oa(e,S)||(S=j[w][1]),Oa(e,S)||(S=z.replace(/_rels\/.*$/,"")+j[w][1]),ae=j[w][2]):(S="xl/worksheets/sheet"+(w+1-J)+"."+D,S=S.replace(/sheet0\./,"sheet.")),E=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(p.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var F=!1,X=0;X!=t.sheets.length;++X)typeof t.sheets[X]=="number"&&t.sheets[X]==w&&(F=1),typeof t.sheets[X]=="string"&&t.sheets[X].toLowerCase()==p.SheetNames[w].toLowerCase()&&(F=1);if(!F)continue e}}zle(e,S,E,p.SheetNames[w],w,_,i,ae,t,h,c,f)}return v={Directory:s,Workbook:h,Props:p,Custprops:g,Deps:y,Sheets:i,SheetNames:p.SheetNames,Strings:qh,Styles:f,Themes:c,SSF:kr(yt)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(P,le){P=P.replace(/^Root Entry[\/]/,""),v.keys.push(P),v.files[P]=e.FileIndex[le]}))),t&&t.bookVBA&&(s.vba.length>0?v.vbaraw=pn(e,Sa(s.vba[0]),!0):s.defaults&&s.defaults.bin===lne&&(v.vbaraw=pn(e,"xl/vbaProject.bin",!0))),v}function Vle(e,t){var r=t||{},n="Workbook",s=mt.find(e,n);try{if(n="/!DataSpaces/Version",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(vte(s.content),n="/!DataSpaces/DataSpaceMap",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=wte(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=_te(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Ste(s.content)}catch{}if(n="/EncryptionInfo",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Nte(s.content);if(n="/EncryptedPackage",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function qle(e,t){return t.bookType=="ods"?CM(e,t):t.bookType=="numbers"?Lle(e,t):t.bookType=="xlsb"?Wle(e,t):$le(e,t)}function Wle(e,t){pf=1024,e&&!e.SSF&&(e.SSF=kr(yt)),e&&e.SSF&&(md(),T1(e.SSF),t.revssf=A1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Wh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=nM.indexOf(t.bookType)>-1,s=_S();PS(t=t||{});var a=lS(),i="",o=0;if(t.cellXfs=[],Xl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ot(a,i,vI(e.Props,t)),s.coreprops.push(i),nr(t.rels,2,i,Lt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(e.SheetNames[f]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ot(a,i,_I(e.Props)),s.extprops.push(i),nr(t.rels,3,i,Lt.EXT_PROPS),e.Custprops!==e.Props&&Wr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ot(a,i,EI(e.Custprops)),s.custprops.push(i),nr(t.rels,4,i,Lt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],x=(p||{})["!type"]||"sheet";switch(x){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ot(a,i,woe(o-1,i,t,e,h)),s.sheets.push(i),nr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Lt.WS[0])}if(p){var g=p["!comments"],v=!1,y="";g&&g.length>0&&(y="xl/comments"+o+"."+r,Ot(a,y,Soe(g,y)),s.comments.push(y),nr(h,-1,"../comments"+o+"."+r,Lt.CMNT),v=!0),p["!legacy"]&&v&&Ot(a,"xl/drawings/vmlDrawing"+o+".vml",tM(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Ot(a,y0(i),gf(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ot(a,i,Eoe(t.Strings,i,t)),s.strs.push(i),nr(t.wbrels,-1,"sharedStrings."+r,Lt.SST)),i="xl/workbook."+r,Ot(a,i,boe(e,i)),s.workbooks.push(i),nr(t.rels,1,i,Lt.WB),i="xl/theme/theme1.xml",Ot(a,i,AS(e.Themes,t)),s.themes.push(i),nr(t.wbrels,-1,"theme/theme1.xml",Lt.THEME),i="xl/styles."+r,Ot(a,i,_oe(e,i,t)),s.styles.push(i),nr(t.wbrels,-1,"styles."+r,Lt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ot(a,i,e.vbaraw),s.vba.push(i),nr(t.wbrels,-1,"vbaProject.bin",Lt.VBA)),i="xl/metadata."+r,Ot(a,i,Noe(i)),s.metadata.push(i),nr(t.wbrels,-1,"metadata."+r,Lt.XLMETA),Ot(a,"[Content_Types].xml",xI(s,t)),Ot(a,"_rels/.rels",gf(t.rels)),Ot(a,"xl/_rels/workbook."+r+".rels",gf(t.wbrels)),delete t.revssf,delete t.ssf,a}function $le(e,t){pf=1024,e&&!e.SSF&&(e.SSF=kr(yt)),e&&e.SSF&&(md(),T1(e.SSF),t.revssf=A1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Wh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=nM.indexOf(t.bookType)>-1,s=_S();PS(t=t||{});var a=lS(),i="",o=0;if(t.cellXfs=[],Xl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ot(a,i,vI(e.Props,t)),s.coreprops.push(i),nr(t.rels,2,i,Lt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(e.SheetNames[f]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ot(a,i,_I(e.Props)),s.extprops.push(i),nr(t.rels,3,i,Lt.EXT_PROPS),e.Custprops!==e.Props&&Wr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ot(a,i,EI(e.Custprops)),s.custprops.push(i),nr(t.rels,4,i,Lt.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var p={"!id":{}},x=e.Sheets[e.SheetNames[o-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ot(a,i,pM(o-1,t,e,p)),s.sheets.push(i),nr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Lt.WS[0])}if(x){var v=x["!comments"],y=!1,w="";if(v&&v.length>0){var _=!1;v.forEach(function(S){S[1].forEach(function(E){E.T==!0&&(_=!0)})}),_&&(w="xl/threadedComments/threadedComment"+o+"."+r,Ot(a,w,Qre(v,h,t)),s.threadedcomments.push(w),nr(p,-1,"../threadedComments/threadedComment"+o+"."+r,Lt.TCMNT)),w="xl/comments"+o+"."+r,Ot(a,w,rM(v)),s.comments.push(w),nr(p,-1,"../comments"+o+"."+r,Lt.CMNT),y=!0}x["!legacy"]&&y&&Ot(a,"xl/drawings/vmlDrawing"+o+".vml",tM(o,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&Ot(a,y0(i),gf(p))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ot(a,i,VI(t.Strings,t)),s.strs.push(i),nr(t.wbrels,-1,"sharedStrings."+r,Lt.SST)),i="xl/workbook."+r,Ot(a,i,vM(e)),s.workbooks.push(i),nr(t.rels,1,i,Lt.WB),i="xl/theme/theme1.xml",Ot(a,i,AS(e.Themes,t)),s.themes.push(i),nr(t.wbrels,-1,"theme/theme1.xml",Lt.THEME),i="xl/styles."+r,Ot(a,i,JI(e,t)),s.styles.push(i),nr(t.wbrels,-1,"styles."+r,Lt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ot(a,i,e.vbaraw),s.vba.push(i),nr(t.wbrels,-1,"vbaProject.bin",Lt.VBA)),i="xl/metadata."+r,Ot(a,i,eM()),s.metadata.push(i),nr(t.wbrels,-1,"metadata."+r,Lt.XLMETA),h.length>1&&(i="xl/persons/person.xml",Ot(a,i,tne(h)),s.people.push(i),nr(t.wbrels,-1,"persons/person.xml",Lt.PEOPLE)),Ot(a,"[Content_Types].xml",xI(s,t)),Ot(a,"_rels/.rels",gf(t.rels)),Ot(a,"xl/_rels/workbook."+r+".rels",gf(t.wbrels)),delete t.revssf,delete t.ssf,a}function LS(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ca(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Gle(e,t){return mt.find(e,"EncryptedPackage")?Vle(e,t):EM(e,t)}function Kle(e,t){var r,n=e,s=t||{};return s.type||(s.type=Ft&&Buffer.isBuffer(e)?"buffer":"base64"),r=WD(n,s),Hle(r,s)}function OM(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return L_(e.slice(r),t);default:break e}return Ff.to_workbook(e,t)}function Xle(e,t){var r="",n=LS(e,t);switch(t.type){case"base64":r=ca(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Jc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=dr(r)),t.type="binary",OM(r,t)}function Yle(e,t){var r=e;return t.type=="base64"&&(r=ca(r)),r=d0.utils.decode(1200,r.slice(2),"str"),t.type="binary",OM(r,t)}function Jle(e){return e.match(/[^\x00-\x7F]/)?Mi(e):e}function zb(e,t,r,n){return n?(r.type="string",Ff.to_workbook(e,r)):Ff.to_workbook(t,r)}function cg(e,t){nS();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return cg(new Uint8Array(e),(r=kr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),vf={},r.dateNF&&(vf.dateNF=r.dateNF),r.type||(r.type=Ft&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ft?"buffer":"binary",n=WJ(e),typeof Uint8Array<"u"&&!Ft&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Jle(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=kr(r),r.type="array",cg(sS(n),r)}switch((s=LS(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Gle(mt.read(n,r),r);break;case 9:if(s[1]<=8)return EM(n,r);break;case 60:return L_(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return rte(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return zI.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Kle(n,r):zb(e,n,r,a);case 239:return s[3]===60?L_(n,r):zb(e,n,r,a);case 255:if(s[1]===254)return Yle(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Pc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Pc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return P_.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return KI.to_workbook(n,r);break;case 10:case 13:case 32:return Xle(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tte.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?P_.to_workbook(n,r):zb(e,n,r,a)}function jM(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ep(t.file,mt.write(e,{type:Ft?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return mt.write(e,t)}function Zle(e,t){var r=kr(t||{}),n=qle(e,r);return Qle(n,r)}function Qle(e,t){var r={},n=Ft?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?mt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(N1(s))}return t.password&&typeof encrypt_agile<"u"?jM(encrypt_agile(s,t.password),t):t.type==="file"?ep(t.file,s):t.type=="string"?dr(s):s}function ece(e,t){var r=t||{},n=Joe(e,r);return jM(n,r)}function Ci(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return h0(Mi(n));case"binary":return Mi(n);case"string":return e;case"file":return ep(t.file,n,"utf8");case"buffer":return Ft?Lo(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ci(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function tce(e,t){switch(t.type){case"base64":return h0(e);case"binary":return e;case"string":return e;case"file":return ep(t.file,e,"binary");case"buffer":return Ft?Lo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ym(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?h0(r):t.type=="string"?dr(r):r;case"file":return ep(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function DM(e,t){nS(),Gie(e);var r=kr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=DM(e,r);return r.type="array",N1(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ci(qoe(e,r),r);case"slk":case"sylk":return Ci(UI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Ci(NM(e.Sheets[e.SheetNames[s]],r),r);case"txt":return tce(IM(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Ci(BS(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ci(zI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Ym(P_.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Ci(Ff.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Ci(KI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Ci(HI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Ci(CM(e,r),r);case"wk1":return Ym(Pc.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Ym(Pc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ym(SM(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ece(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Zle(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function rce(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function nce(e,t,r){var n={};return n.type="file",n.file=t,rce(n),DM(e,n)}function sce(e,t,r,n,s,a,i,o){var c=Jr(r),f=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!i||e[r])for(var g=t.s.c;g<=t.e.c;++g){var v=i?e[r][g]:e[n[g]+c];if(v===void 0||v.t===void 0){if(f===void 0)continue;a[g]!=null&&(x[a[g]]=f);continue}var y=v.v;switch(v.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[g]!=null){if(y==null)if(v.t=="e"&&y===null)x[a[g]]=null;else if(f!==void 0)x[a[g]]=f;else if(h&&y===null)x[a[g]]=null;else continue;else x[a[g]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?y:Io(v,y,o);y!=null&&(p=!1)}}return{row:x,isempty:p}}function ug(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof h){case"string":c=Gt(h);break;case"number":c=Gt(e["!ref"]),c.s.r=h;break;default:c=h}n>0&&(s=0);var p=Jr(c.s.r),x=[],g=[],v=0,y=0,w=Array.isArray(e),_=c.s.r,S=0,E={};w&&!e[_]&&(e[_]=[]);var T=f.skipHidden&&e["!cols"]||[],k=f.skipHidden&&e["!rows"]||[];for(S=c.s.c;S<=c.e.c;++S)if(!(T[S]||{}).hidden)switch(x[S]=Dr(S),r=w?e[_][S]:e[x[S]+p],n){case 1:a[S]=S-c.s.c;break;case 2:a[S]=x[S];break;case 3:a[S]=f.header[S-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Io(r,null,f),y=E[i]||0,!y)E[i]=1;else{do o=i+"_"+y++;while(E[o]);E[i]=y,E[o]=1}a[S]=o}for(_=c.s.r+s;_<=c.e.r;++_)if(!(k[_]||{}).hidden){var D=sce(e,c,_,x,n,a,w,f);(D.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(g[v++]=D.row)}return g.length=v,g}var L5=/"/g;function ace(e,t,r,n,s,a,i,o){for(var c=!0,f=[],h="",p=Jr(r),x=t.s.c;x<=t.e.c;++x)if(n[x]){var g=o.dense?(e[r]||[])[x]:e[n[x]+p];if(g==null)h="";else if(g.v!=null){c=!1,h=""+(o.rawNumbers&&g.t=="n"?g.v:Io(g,null,o));for(var v=0,y=0;v!==h.length;++v)if((y=h.charCodeAt(v))===s||y===a||y===34||o.forceQuotes){h='"'+h.replace(L5,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(c=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(L5,'""')+'"')):h="";f.push(h)}return o.blankrows===!1&&c?null:f.join(i)}function BS(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Gt(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),h="",p=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(x[v]||{}).hidden||(p[v]=Dr(v));for(var y=0,w=s.s.r;w<=s.e.r;++w)(g[w]||{}).hidden||(h=ace(e,s,w,p,i,c,a,n),h!=null&&(n.strip&&(h=h.replace(f,"")),(h||n.blankrows!==!1)&&r.push((y++?o:"")+h)));return delete n.dense,r.join("")}function IM(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=BS(e,t);return r}function ice(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Gt(e["!ref"]),a="",i=[],o,c=[],f=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Dr(o);for(var h=s.s.r;h<=s.e.r;++h)for(a=Jr(h),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=f?(e[h]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function MM(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Ir(n.origin):n.origin;i=c.r,o=c.c}var f,h={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var p=Gt(a["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),i==-1&&(i=p.e.r+1,h.e.r=i+t.length-1+s)}else i==-1&&(i=0,h.e.r=t.length-1+s);var x=n.header||[],g=0;t.forEach(function(y,w){Wr(y).forEach(function(_){(g=x.indexOf(_))==-1&&(x[g=x.length]=_);var S=y[_],E="z",T="",k=bt({c:o+g,r:i+w+s});f=N0(a,k),S&&typeof S=="object"&&!(S instanceof Date)?a[k]=S:(typeof S=="number"?E="n":typeof S=="boolean"?E="b":typeof S=="string"?E="s":S instanceof Date?(E="d",n.cellDates||(E="n",S=wn(S)),T=n.dateNF||yt[14]):S===null&&n.nullError&&(E="e",S=0),f?(f.t=E,f.v=S,delete f.w,delete f.R,T&&(f.z=T)):a[k]=f={t:E,v:S},T&&(f.z=T))})}),h.e.c=Math.max(h.e.c,o+x.length-1);var v=Jr(i);if(s)for(g=0;g<x.length;++g)a[Dr(g+o)+v]={t:"s",v:x[g]};return a["!ref"]=Ct(h),a}function oce(e,t){return MM(null,e,t)}function N0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ir(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?N0(e,bt(t)):N0(e,bt({r:t,c:r||0}))}function lce(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function US(){return{SheetNames:[],Sheets:{}}}function zS(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(yM(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function cce(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=lce(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function uce(e,t){return e.z=t,e}function FM(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function fce(e,t,r){return FM(e,"#"+t,r)}function dce(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function hce(e,t,r,n){for(var s=typeof t!="string"?t:Gt(t),a=typeof t=="string"?t:Ct(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=N0(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Kh={encode_col:Dr,encode_row:Jr,encode_cell:bt,encode_range:Ct,decode_col:xS,decode_row:mS,split_cell:EZ,decode_cell:Ir,decode_range:Hs,format_cell:Io,sheet_add_aoa:cI,sheet_add_json:MM,sheet_add_dom:TM,aoa_to_sheet:xd,json_to_sheet:oce,table_to_sheet:kM,table_to_book:vle,sheet_to_csv:BS,sheet_to_txt:IM,sheet_to_json:ug,sheet_to_html:NM,sheet_to_formulae:ice,sheet_to_row_object_array:ug,sheet_get_cell:N0,book_new:US,book_append_sheet:zS,book_set_sheet_visibility:cce,cell_set_number_format:uce,cell_set_hyperlink:FM,cell_set_internal_link:fce,cell_add_comment:dce,sheet_set_array_formula:hce,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const PM=({clients:e,selectedClient:t,onClientSelect:r,placeholder:n="Choose an approved client...",disabled:s=!1,className:a=""})=>{const[i,o]=ne.useState(!1),[c,f]=ne.useState(""),h=ne.useRef(null);ne.useEffect(()=>{const v=y=>{h.current&&!h.current.contains(y.target)&&o(!1)};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[]);const p=e.find(v=>v.client_id===t),x=()=>{s||(o(!i),i||f(""))},g=e.filter(v=>v.company_name.toLowerCase().includes(c.toLowerCase()));return d.jsxs("div",{className:`relative group/select ${a}`,ref:h,children:[d.jsxs("div",{onClick:x,className:`w-full pl-6 pr-6 py-4 bg-white border rounded-2xl outline-none font-medium flex items-center justify-between transition-all ${s?"opacity-60 cursor-not-allowed bg-slate-50":"cursor-pointer"} ${i?"border-[#3399cc] ring-4 ring-[#3399cc]/10 shadow-lg shadow-[#3399cc]/5":"border-slate-200 hover:border-slate-300"}`,children:[d.jsxs("div",{className:"flex items-center gap-3 w-full overflow-hidden",children:[d.jsx(Xn,{className:`w-5 h-5 shrink-0 transition-colors ${i?"text-[#3399cc]":"text-slate-400"}`,size:18}),d.jsx("span",{className:`block truncate ${p?"text-slate-900":"text-slate-400"}`,children:p?`${p.company_name} (${p.contract_number||"No Contract"})`:n})]}),d.jsx(u0,{className:`w-5 h-5 shrink-0 text-slate-400 transition-transform duration-200 ${i?"rotate-180 text-[#3399cc]":""}`})]}),i&&d.jsxs("div",{className:"absolute top-full left-0 w-full mt-2 bg-white border border-slate-100 rounded-2xl shadow-xl overflow-hidden z-50 animate-in fade-in slide-in-from-top-2 duration-200 origin-top",children:[d.jsx("div",{className:"p-3 border-b border-slate-100 bg-slate-50/50",children:d.jsxs("div",{className:"relative",children:[d.jsx(Po,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:14}),d.jsx("input",{autoFocus:!0,type:"text",placeholder:"Search by company name...",value:c,onChange:v=>f(v.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-200 rounded-xl outline-none focus:border-[#3399cc] bg-white transition-colors",onClick:v=>v.stopPropagation()})]})}),d.jsx("div",{className:"max-h-60 overflow-y-auto py-2 custom-scrollbar",children:g.length===0?d.jsxs("div",{className:"px-4 py-8 text-slate-400 text-sm text-center italic",children:['No clients found matching "',c,'"']}):g.map(v=>d.jsxs("div",{onClick:()=>{r(v.client_id),o(!1)},className:`px-4 py-3 mx-2 rounded-xl cursor-pointer transition-colors text-sm font-medium group flex items-center justify-between
                    ${t===v.client_id?"bg-slate-100 text-[#3399cc]":"text-slate-700 hover:bg-slate-50 hover:text-slate-900"}
                  `,children:[d.jsxs("div",{className:"flex flex-col overflow-hidden",children:[d.jsx("span",{className:"font-semibold uppercase truncate",children:v.company_name}),v.contract_number&&d.jsxs("span",{className:`text-xs mt-1 transition-colors truncate ${t===v.client_id?"text-[#3399cc]/70":"text-slate-400 group-hover:text-slate-500"}`,children:["Contract: ",v.contract_number]})]}),t===v.client_id&&d.jsx(Ll,{size:16,className:"text-[#3399cc] shrink-0 ml-2"})]},v.client_id))})]})]})},pce=()=>{var j,J;const e=Qn(),[t,r]=ne.useState([]),[n,s]=ne.useState(""),[a,i]=ne.useState(null),[o,c]=ne.useState(!1),[f,h]=ne.useState(!0),[p,x]=ne.useState(null),[g,v]=ne.useState(null),[y,w]=ne.useState(null),[_,S]=ne.useState(!1);ne.useEffect(()=>{E()},[]);const E=async()=>{try{h(!0);const ae=await Pt.get("clients/approved");r(ae.data)}catch{v("Failed to load approved clients")}finally{h(!1)}},T=async ae=>{var X;const F=((X=ae.target.files)==null?void 0:X[0])??null;if(!F){i(null),w(null);return}if(!F.name.endsWith(".xlsx")){v("Invalid format. Please select an Excel (.xlsx) file"),i(null);return}i(F),v(null),x(null),await k(F)},k=async ae=>{try{const F=await ae.arrayBuffer(),X=new Uint8Array(F),P=cg(X,{type:"array"}),le=P.Sheets[P.SheetNames[0]],ee=Kh.sheet_to_json(le);w(ee.slice(0,10))}catch(F){console.error("Preview failed:",F),w(null)}},D=()=>{if(!n){v("Please select a client to associate with these products");return}if(!a){v("Please select a file to upload");return}v(null),S(!0)},O=async()=>{var F,X;if(!n){v("Please select a client to associate with these products");return}if(!a){v("Please select a file to upload");return}c(!0),v(null),x(null);const ae=new FormData;ae.append("file",a);try{const P=await Pt.post(`/upload/${n}`,ae,{headers:{"Content-Type":"multipart/form-data"}});x(P.data),i(null),w(null),setTimeout(()=>{e("/gsa-products")},2500)}catch(P){v(((X=(F=P==null?void 0:P.response)==null?void 0:F.data)==null?void 0:X.detail)??(P==null?void 0:P.message)??"Upload failed")}finally{c(!1),S(!1)}},z=()=>!y||y.length===0?[]:Object.keys(y[0]);return d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 to-slate-100 p-6 md:p-10",children:[d.jsx(If,{isOpen:_,onClose:()=>S(!1),onConfirm:O,title:"Confirm GSA Product Upload",message:d.jsxs(d.Fragment,{children:["Are you sure you want to upload the product catalog for"," ",d.jsx("span",{className:"font-bold text-slate-800",children:(j=t.find(ae=>ae.client_id===n))==null?void 0:j.company_name}),"?"]}),details:[{label:"Client",value:((J=t.find(ae=>ae.client_id===n))==null?void 0:J.company_name)||""},{label:"File",value:(a==null?void 0:a.name)||""},{label:"Size",value:`${(((a==null?void 0:a.size)||0)/1024).toFixed(1)} KB`}],warning:{message:"This action will update the product catalog for the selected client. Existing products may be updated or replaced.",type:"amber"},confirmText:"Yes, Upload Catalog",cancelText:"Cancel",isSubmitting:o,variant:"emerald"}),d.jsxs("div",{className:" mx-auto",children:[d.jsxs("button",{onClick:()=>e(-1),className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 transition-colors mb-6 font-medium group",children:[d.jsx(Jn,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),"Back to Products"]}),d.jsxs("div",{className:"mb-10",children:[d.jsx("h1",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Upload GSA Products Catalog"}),d.jsx("p",{className:"text-slate-500 mt-1",children:"Update your product catalog by uploading an Excel spreadsheet."})]}),d.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[d.jsxs("div",{className:"bg-white rounded-4xl shadow-sm border border-slate-200 p-8 md:p-10 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 p-8 pointer-events-none opacity-5",children:d.jsx(T_,{size:120})}),d.jsxs("div",{className:"space-y-8 relative",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"w-6 h-6 rounded-full bg-[#3399cc] text-white flex items-center justify-center text-xs font-bold",children:"1"}),d.jsx("label",{className:"text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Select Client"})]}),f?d.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-2xl",children:[d.jsx(Ar,{className:"w-5 h-5 animate-spin text-[#24578f]"}),d.jsx("span",{className:"text-slate-500 text-sm font-medium",children:"Fetching approved clients..."})]}):d.jsx(PM,{clients:t,selectedClient:n,onClientSelect:s})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"w-6 h-6 rounded-full bg-[#3399cc] text-white flex items-center justify-center text-xs font-bold",children:"2"}),d.jsx("label",{className:"text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Upload Spreadsheet"})]}),a?d.jsxs("div",{className:"flex items-center justify-between p-6 bg-blue-50 border border-blue-100 rounded-2xl",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-12 h-12 bg-[#3399cc] rounded-xl flex items-center justify-center text-white",children:d.jsx(T_,{size:24})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-bold text-slate-900 truncate max-w-50 md:max-w-xs",children:a.name}),d.jsxs("p",{className:"text-xs text-slate-500",children:[(a.size/1024).toFixed(1)," KB  Ready to upload"]})]})]}),d.jsx("button",{onClick:()=>{i(null),w(null)},className:"p-2 hover:bg-white rounded-full text-slate-400 hover:text-red-500 transition-all",children:d.jsx(Zn,{size:20})})]}):d.jsxs("label",{className:"group flex flex-col items-center justify-center w-full h-56 border-2 border-dashed border-slate-200 rounded-4xl cursor-pointer hover:border-[#3399cc] hover:bg-blue-50/30 transition-all bg-slate-50/50",children:[d.jsxs("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:d.jsx(jf,{className:"w-8 h-8 text-[#3399cc]"})}),d.jsx("p",{className:"text-base font-bold text-slate-700 mb-1",children:"Click to browse and upload"}),d.jsx("p",{className:"text-sm text-slate-400",children:"Excel (.xlsx) files only"})]}),d.jsx("input",{id:"file-input",type:"file",accept:".xlsx",onChange:T,className:"hidden"})]})]}),d.jsx("div",{className:"pt-4",children:d.jsx("button",{onClick:D,disabled:o||!a||!n,className:"w-full bg-[#3399cc] text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-3 transition-all hover:bg-[#2b82ad] disabled:opacity-40 disabled:grayscale shadow-lg shadow-blue-200 hover:shadow-xl active:scale-[0.98]",children:o?d.jsxs(d.Fragment,{children:[d.jsx(Ar,{className:"w-5 h-5 animate-spin"})," Processing Upload..."]}):d.jsxs(d.Fragment,{children:[d.jsx(jf,{size:20})," Start Product Import"," ",d.jsx(c0,{size:18})]})})}),g&&d.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 rounded-2xl flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[d.jsx(ud,{className:"w-5 h-5 text-red-500 shrink-0 mt-0.5"}),d.jsx("p",{className:"text-sm text-red-700 font-medium",children:g})]}),p&&d.jsxs("div",{className:"p-5 bg-emerald-50 border border-emerald-100 rounded-2xl flex items-start gap-4 animate-in zoom-in-95 duration-300",children:[d.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-full flex items-center justify-center shrink-0",children:d.jsx(BK,{className:"w-6 h-6 text-white"})}),d.jsxs("div",{className:"text-sm text-emerald-800",children:[d.jsx("p",{className:"font-black text-base uppercase tracking-tight",children:"Upload Successful"}),d.jsxs("div",{className:"flex gap-4 mt-1 font-medium opacity-80",children:[d.jsxs("span",{children:["Inserted: ",d.jsx("strong",{children:p.inserted})]}),d.jsx("span",{className:"w-1 h-1 bg-emerald-300 rounded-full my-auto"}),d.jsxs("span",{children:["Updated: ",d.jsx("strong",{children:p.updated})]})]}),d.jsx("p",{className:"mt-3 text-xs opacity-60 italic font-medium",children:"Redirecting to catalog..."})]})]})]})]}),y&&y.length>0&&d.jsxs("div",{className:"bg-white rounded-4xl shadow-sm border border-slate-200 overflow-hidden animate-in fade-in slide-in-from-bottom-4 duration-500",children:[d.jsxs("div",{className:"p-6 border-b border-slate-100 bg-slate-50/50 flex items-center justify-between",children:[d.jsx("h2",{className:"text-sm font-black text-slate-400 uppercase tracking-[0.2em]",children:"Data Preview (First 10 Rows)"}),d.jsx("span",{className:"text-[10px] font-bold bg-slate-200 text-slate-600 px-2 py-0.5 rounded uppercase",children:"Read Only"})]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full border-collapse",children:[d.jsx("thead",{children:d.jsx("tr",{className:"bg-white",children:z().map(ae=>d.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-slate-400 uppercase tracking-wider border-b border-slate-100",children:ae},ae))})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:y.map((ae,F)=>d.jsx("tr",{className:"hover:bg-slate-50/50 transition-colors",children:z().map(X=>d.jsx("td",{className:"px-6 py-4 text-xs font-semibold text-slate-600 whitespace-nowrap",children:ae[X]!=null?String(ae[X]):""},X))},F))})]})})]})]})]})]})};function mce({onUploadClick:e,onExportClick:t,isExporting:r=!1}){return d.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center md:justify-between gap-6 mb-12 mx-auto",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"Products"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"Catalog management and inventory overview"})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[t&&d.jsx("button",{onClick:t,disabled:r,className:"flex items-center justify-center gap-2 bg-white text-slate-700 border border-slate-200 px-6 py-2.5 rounded-xl font-semibold hover:bg-slate-50 transition-all shadow-am disabled:opacity-50 disabled:cursor-not-allowed",children:r?d.jsx(d.Fragment,{children:"Running..."}):d.jsx(d.Fragment,{children:"Export to Excel"})}),d.jsxs("button",{onClick:e,className:"flex items-center justify-center gap-2 bg-[#3399cc] text-white px-6 py-2.5 rounded-xl font-semibold hover:bg-[#2b82ad] transition-all shadow-md hover:shadow-lg active:scale-95",children:[d.jsx(jf,{size:18}),"Upload GSA"]})]})]})}function xce({clients:e,selectedClient:t,onClientSelect:r}){const n=ne.useRef(null),[s,a]=ne.useState(!1),[i,o]=ne.useState("");ne.useEffect(()=>{const h=p=>{n.current&&!n.current.contains(p.target)&&a(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const c=h=>{r(h),a(!1),o("")},f=e.filter(h=>h.company_name.toLowerCase().includes(i.toLowerCase()));return d.jsxs("div",{className:"relative w-full md:w-80",ref:n,children:[d.jsxs("div",{onClick:()=>a(!s),className:`w-full flex items-center justify-between px-4 py-3.5 bg-slate-50/50 border rounded-2xl cursor-pointer transition-all hover:border-slate-300 ${s?"border-[#3399cc] ring-4 ring-[#3399cc]/10":"border-slate-200"}`,children:[d.jsxs("div",{className:"flex items-center gap-3 overflow-hidden text-slate-700",children:[d.jsx(Xn,{size:18,className:"text-slate-400 shrink-0"}),d.jsx("span",{className:`truncate font-medium ${t?"text-slate-900":"text-slate-400"}`,children:t?t.company_name:"All Clients"})]}),d.jsx(u0,{size:18,className:`text-slate-400 transition-transform duration-300 ${s?"rotate-180":""}`})]}),s&&d.jsxs("div",{className:"absolute z-50 w-full mt-2 bg-white border border-slate-200 rounded-2xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[d.jsx("div",{className:"p-3 border-b border-slate-100 bg-slate-50/50",children:d.jsxs("div",{className:"relative",children:[d.jsx(Po,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:14}),d.jsx("input",{autoFocus:!0,type:"text",placeholder:"Search by company name...",value:i,onChange:h=>o(h.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-200 rounded-xl outline-none focus:border-[#3399cc] bg-white transition-colors"})]})}),d.jsxs("div",{className:"max-h-64 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-200",children:[d.jsxs("div",{onClick:()=>c(null),className:"px-4 py-3 text-sm hover:bg-slate-50 cursor-pointer flex items-center justify-between transition-colors",children:[d.jsx("span",{className:"font-medium text-slate-600",children:"Show All"}),!t&&d.jsx(Ll,{size:16,className:"text-[#3399cc]"})]}),f.map(h=>d.jsxs("div",{onClick:()=>c(h),className:"px-4 py-3 text-sm hover:bg-slate-50 cursor-pointer flex items-center justify-between transition-colors border-t border-slate-50",children:[d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-semibold text-slate-800",children:h.company_name}),d.jsx("span",{className:"text-[10px] text-slate-400 uppercase tracking-tight",children:h.status})]}),(t==null?void 0:t.client_id)===h.client_id&&d.jsx(Ll,{size:16,className:"text-[#3399cc]"})]},h.client_id)),f.length===0&&d.jsx("div",{className:"px-4 py-10 text-center text-slate-400 text-sm italic",children:"No companies found"})]})]})]})}function gce({searchTerm:e,onSearchChange:t,clients:r,selectedClient:n,onClientSelect:s}){return d.jsxs("div",{className:"mx-auto bg-white p-4 rounded-4xl shadow-sm border border-slate-100 mb-8 flex flex-col lg:flex-row gap-4 items-center",children:[d.jsxs("div",{className:"relative flex-1 w-full",children:[d.jsx(Po,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:20}),d.jsx("input",{type:"text",placeholder:"Search by name, manufacturer, or part number...",value:e,onChange:a=>t(a.target.value),className:"w-full pl-14 pr-6 py-3.5 rounded-2xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20  bg-slate-50/50 text-slate-700 placeholder:text-slate-400 transition-all font-medium"})]}),d.jsx(xce,{clients:r,selectedClient:n,onClientSelect:s})]})}const LM=e=>e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e):"-";function yce({product:e,onClick:t}){return d.jsxs("tr",{className:"hover:bg-slate-50/80 transition-colors cursor-pointer group",onClick:t,children:[d.jsxs("td",{className:"px-6 py-4",children:[d.jsx("div",{className:"text-sm font-bold text-slate-800 group-hover:text-[#3399cc] transition-colors",children:e.item_name}),e.item_description&&d.jsx("div",{className:"text-xs text-slate-500 mt-1 truncate max-w-62.5 font-medium",children:e.item_description})]}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:`px-3 py-1 rounded-lg text-[10px] font-extrabold uppercase tracking-wider ${e.item_type==="A"?"bg-blue-50 text-blue-600":"bg-emerald-50 text-emerald-600"}`,children:e.item_type==="A"?"Accessory":"Base"})}),d.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 font-semibold",children:e.client_name}),d.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.manufacturer}),d.jsx("td",{className:"px-6 py-4 text-sm font-mono text-slate-600 font-medium",children:e.manufacturer_part_number}),d.jsx("td",{className:"px-6 py-4 text-sm font-black text-slate-900",children:LM(e.commercial_list_price)}),d.jsx("td",{className:"px-6 py-4 text-sm font-mono text-slate-600",children:e.uom})]})}function vce({currentPage:e,totalPages:t,itemsPerPage:r,startIndex:n,totalItems:s,onPageChange:a}){const i=()=>{const o=[];if(t<=5)for(let f=1;f<=t;f++)o.push(f);else e<=3?o.push(1,2,3,4,"...",t):e>=t-2?o.push(1,"...",t-3,t-2,t-1,t):o.push(1,"...",e-1,e,e+1,"...",t);return o};return d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:n+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(n+r,s)})," ","of ",d.jsx("span",{className:"text-slate-900 font-semibold",children:s})," ","products"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:e===1,onClick:()=>a(e-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Jn,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:i().map((o,c)=>d.jsx(We.Fragment,{children:o==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>a(Number(o)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                  ${e===o?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:o})},c))}),d.jsx("button",{disabled:e===t,onClick:()=>a(e+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})}function bce({products:e,filteredProducts:t,loading:r,selectedClient:n,currentPage:s,totalPages:a,itemsPerPage:i,startIndex:o,onProductClick:c,onPageChange:f}){return d.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden relative transition-all",children:[d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50/50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Item Description"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Type"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Client"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Manufacturer"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"MFR Part #"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Price"}),d.jsx("th",{className:"text-left px-6 py-5 text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"UOM"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100",children:r?d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"px-6 py-32",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading Products..."})]})})}):e.length>0?e.map(h=>d.jsx(yce,{product:h,onClick:()=>c(h)},h.product_id)):d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"px-6 py-20",children:d.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center mb-4 border border-slate-100",children:d.jsx(v1,{className:"w-8 h-8 text-slate-300"})}),d.jsx("h3",{className:"text-base font-bold text-slate-500",children:n?"No products found for this client":"No products match your search"})]})})})})]})}),t.length>i&&d.jsx(vce,{currentPage:s,totalPages:a,itemsPerPage:i,startIndex:o,totalItems:t.length,onPageChange:f})]})}function wce({product:e,onClose:t}){return d.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-900/40 transition-opacity",onClick:t}),d.jsxs("div",{className:"relative w-full max-w-lg bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[d.jsxs("div",{className:"p-6 border-b border-slate-100 flex items-start justify-between bg-white sticky top-0 z-10",children:[d.jsxs("div",{className:"pr-8",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${e.item_type==="A"?"bg-blue-100 text-blue-700":"bg-emerald-100 text-emerald-700"}`,children:e.item_type==="A"?"Accessory":"Base Product"}),e.hazmat&&d.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 rounded text-[10px] font-bold uppercase",children:"Hazmat"})]}),d.jsx("h2",{className:"text-xl font-bold text-slate-900 leading-tight",children:e.item_name}),d.jsx("p",{className:"text-xs text-slate-500 mt-1 font-medium italic",children:e.item_description})]}),d.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-400 hover:text-slate-900",children:d.jsx(Zn,{size:24})})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-8 space-y-10 scrollbar-thin",children:[e.photo_path&&d.jsx("div",{className:"w-full h-48 bg-slate-50 rounded-2xl border border-slate-100 overflow-hidden flex items-center justify-center",children:d.jsx("img",{src:e.photo_path,alt:e.item_name,className:"h-full w-full object-contain p-4",onError:r=>r.currentTarget.style.display="none"})}),d.jsxs(xh,{title:"Core Identifiers",children:[d.jsx(Cn,{label:"Client",value:e.client_name}),d.jsx(Cn,{label:"Client Part #",value:e.client_part_number}),d.jsx(Cn,{label:"Mfr Part #",value:e.manufacturer_part_number}),d.jsx(Cn,{label:"Manufacturer",value:e.manufacturer})]}),d.jsxs(xh,{title:"Physical Specifications",children:[d.jsx(Cn,{label:"Dimensions (L x W x H)",value:e.length?`${e.length} x ${e.width} x ${e.height} ${e.physical_uom||""}`:null}),d.jsx(Cn,{label:"Weight",value:e.weight_lbs?`${e.weight_lbs} lbs`:null}),d.jsx(Cn,{label:"Warranty",value:e.warranty_period}),d.jsx(Cn,{label:"Quantity per Pack",value:`${e.quantity_per_pack||1} ${e.quantity_unit_uom||""}`})]}),d.jsxs(xh,{title:"Pricing & Classification",children:[d.jsx(Cn,{label:"Commercial List Price",value:LM(e.commercial_list_price)}),d.jsx(Cn,{label:"UOM",value:e.uom}),d.jsx(Cn,{label:"SIN",value:e.sin}),d.jsx(Cn,{label:"NSN",value:e.nsn}),d.jsx(Cn,{label:"UPC",value:e.upc}),d.jsx(Cn,{label:"UNSPSC",value:e.unspsc})]}),d.jsxs(xh,{title:"Compliance & Environment",children:[d.jsx(Cn,{label:"Country of Origin",value:e.country_of_origin}),d.jsx(Cn,{label:"Recycled Content",value:e.recycled_content_percent?`${e.recycled_content_percent}%`:"0%"}),d.jsx(Cn,{label:"Hazmat Status",value:e.hazmat?"Yes":"No"}),d.jsx(Cn,{label:"Product Info Code",value:e.product_info_code})]}),d.jsx(xh,{title:"Resources & Links",children:d.jsxs("div",{className:"col-span-2 flex flex-col gap-3",children:[e.product_url&&d.jsxs("a",{href:e.product_url,target:"_blank",rel:"noreferrer",className:"flex items-center justify-between gap-3 text-slate-700 hover:text-[#3399cc] font-semibold text-sm bg-slate-50 p-4 rounded-xl border border-slate-100 transition-all hover:border-[#3399cc]/30",children:[d.jsxs("span",{className:"flex items-center gap-2",children:[d.jsx(N_,{size:16})," Product Page"]}),d.jsx(Mr,{size:14,className:"text-slate-400"})]}),e.url_508&&d.jsxs("a",{target:"_blank",rel:"noreferrer",className:"flex items-center justify-between gap-3 text-slate-700 hover:text-[#3399cc] font-semibold text-sm bg-slate-50 p-4 rounded-xl border border-slate-100 transition-all hover:border-[#3399cc]/30",children:[d.jsxs("span",{className:"flex items-center gap-2",children:[d.jsx(Ll,{size:16,className:"text-emerald-500"})," 508 Compliance Link"]}),d.jsx(Mr,{size:14,className:"text-slate-400"})]})]})}),d.jsx("div",{className:"pt-6 border-t border-slate-100",children:d.jsxs("div",{className:"flex justify-between text-[10px] font-medium text-slate-400 uppercase tracking-tighter",children:[d.jsxs("span",{children:["Created:"," ",e.created_time?new Date(e.created_time).toLocaleDateString("en-US"):"N/A"]}),d.jsxs("span",{children:["Last Updated:"," ",e.updated_time?new Date(e.updated_time).toLocaleDateString("en-US"):"N/A"]})]})})]})]})]})}function xh({title:e,children:t}){return d.jsxs("div",{children:[d.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-5",children:e}),d.jsx("div",{className:"grid grid-cols-2 gap-y-8 gap-x-4",children:t})]})}function Cn({label:e,value:t}){return d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1 tracking-wide",children:e}),d.jsx("p",{className:"text-sm font-bold text-slate-800",children:t??""})]})}function _ce(){const e=Qn(),[t,r]=ne.useState([]),[n,s]=ne.useState([]),[a,i]=ne.useState(null),[o,c]=ne.useState(!0),[f,h]=ne.useState(""),[p,x]=ne.useState(""),[g,v]=ne.useState(1),[y,w]=ne.useState(null),[_,S]=ne.useState(!1),E=10;ne.useEffect(()=>{(async()=>{var ae,F;try{c(!0),h("");const[X,P]=await Promise.allSettled([Ah.getAllProducts(),ND.getApprovedClients()]);X.status==="fulfilled"?r(X.value.items):((F=(ae=X.reason)==null?void 0:ae.response)==null?void 0:F.status)===404?r([]):h("Failed to load products"),P.status==="fulfilled"&&s(P.value)}catch{h("Failed to initialize page data")}finally{c(!1)}})()},[]);const T=async J=>{w(J),v(1),h("");try{if(c(!0),J){const ae=await Ah.getProductsByClient(J.client_id);r(ae.items)}else{const ae=await Ah.getAllProducts();r(ae.items)}}catch(ae){ae.response&&ae.response.status===404?r([]):(console.error("Filtering error",ae),h("Failed to fetch products for this client"))}finally{c(!1)}},k=ne.useMemo(()=>t.filter(J=>J.item_name.toLowerCase().includes(p.toLowerCase())||J.manufacturer.toLowerCase().includes(p.toLowerCase())||J.manufacturer_part_number.toLowerCase().includes(p.toLowerCase())),[t,p]),D=Math.ceil(k.length/E),O=(g-1)*E,z=ne.useMemo(()=>k.slice(O,O+E),[k,O,E]),j=async()=>{if(y)try{S(!0);const J=await Ah.exportProducts(y.client_id),ae=window.URL.createObjectURL(J),F=document.createElement("a");F.href=ae;const X=new Date().toISOString().split("T")[0];F.download=`${y.company_name}_master_${X}.xlsx`,document.body.appendChild(F),F.click(),window.URL.revokeObjectURL(ae),document.body.removeChild(F)}catch{}finally{S(!1)}};return d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-6 lg:p-10 space-y-10",children:[d.jsxs("div",{className:"mx-auto",children:[d.jsx(mce,{onUploadClick:()=>e("/gsa-products/upload"),onExportClick:y?j:void 0,isExporting:_}),d.jsx(gce,{searchTerm:p,onSearchChange:J=>{x(J),v(1)},clients:n,selectedClient:y,onClientSelect:T}),d.jsx(bce,{products:z,filteredProducts:k,loading:o,selectedClient:y,currentPage:g,totalPages:D,itemsPerPage:E,startIndex:O,onProductClick:i,onPageChange:v})]}),a&&d.jsx(wce,{product:a,onClose:()=>i(null)})]})}function BM(e,t){const r=Kh.book_new(),n={Additions:t.additions,Deletions:t.deletions,"Price Increases":t.priceIncreases,"Price Decreases":t.priceDecreases,"Description Changes":t.descriptionChanges};Object.entries(n).forEach(([a,i])=>{if(!i||i.length===0)return;const o=i.map(f=>({"Part Number":f.manufacturer_part_number||"","Product Name":f.product_name||"","Old Price":f.old_price??"","New Price":f.new_price??"","Old Description":f.old_description||"","New Description":f.new_description||""})),c=Kh.json_to_sheet(o);Kh.book_append_sheet(r,c,a)});const s=`ANAL-JOB-${e}-analysis.xlsx`;nce(r,s)}const UM=ne.createContext(void 0),Ece=({children:e})=>{const[t,r]=ne.useState(null);return d.jsx(UM.Provider,{value:{selectedJobId:t,setSelectedJobId:r},children:e||d.jsx(g1,{})})},mu=()=>{const e=ne.useContext(UM);if(e===void 0)throw new Error("useAnalysis must be used within an AnalysisProvider");return e},Sce=({steps:e,currentStep:t})=>d.jsx("div",{className:"flex items-center gap-2 p-2 rounded-2xl bg-white shadow-sm overflow-x-auto",children:e.map(r=>d.jsxs("div",{className:"flex items-center shrink-0",children:[d.jsxs("div",{className:`h-10 px-4 flex items-center gap-3 rounded-3xl transition-all ${t===r.id?"bg-[#3399cc] text-white shadow-lg":"text-slate-400"}`,children:[d.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border ${t===r.id?"border-white/30":"border-slate-200"}`,children:t>r.id?d.jsx(Ll,{className:"w-3 h-3"}):r.id}),d.jsx("p",{className:"text-xs font-bold uppercase tracking-widest hidden sm:block",children:r.title})]}),r.id<4&&d.jsx("div",{className:"w-4 h-px bg-slate-200 mx-1"})]},r.id))}),Nce=({clients:e,selectedClient:t,onClientSelect:r,onContinue:n,error:s})=>d.jsxs("div",{className:"group bg-white/80 backdrop-blur-md rounded-3xl border border-slate-200 shadow-2xl shadow-slate-200/60 overflow-visible z-10 relative",children:[d.jsxs("div",{className:"p-8 border-b border-slate-100 bg-slate-50/30",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[d.jsx("div",{className:"p-2.5 bg-cyan-50 rounded-xl shadow-sm ring-1 ring-cyan-100",children:d.jsx(Xn,{className:"w-5 h-5 text-[#3399cc]"})}),d.jsx("h3",{className:"text-xl font-semibold text-slate-800 tracking-tight",children:"Select Client"})]}),d.jsx("p",{className:"text-sm text-slate-500",children:"Choose the client for analysis"})]}),d.jsxs("div",{className:"p-8 space-y-8 relative",children:[d.jsx(PM,{clients:e,selectedClient:t,onClientSelect:r}),s&&d.jsxs("div",{className:"p-4 bg-red-50 text-red-700 rounded-xl flex items-center gap-2 animate-in fade-in slide-in-from-top-1",children:[d.jsx(ud,{className:"w-5 h-5 shrink-0"}),d.jsx("span",{className:"text-sm font-medium",children:s})]}),d.jsx("div",{className:"flex justify-end pt-2",children:d.jsxs("button",{onClick:n,disabled:!t,className:"btn-primary",children:["Continue ",d.jsx(Mr,{className:"w-4 h-4 ml-1"})]})})]})]}),Tce=({file:e,uploadedFileName:t,previewData:r,totalRows:n,error:s,onFileChange:a,onBack:i,onContinue:o,onClearFile:c})=>d.jsxs("div",{className:"group bg-white/80 backdrop-blur-md rounded-3xl border border-slate-200 shadow-2xl shadow-slate-200/60 overflow-hidden",children:[d.jsxs("div",{className:"p-8 border-b border-slate-100 bg-slate-50/30",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("div",{className:"p-2.5 bg-cyan-50 rounded-xl shadow-sm ring-1 ring-cyan-100",children:d.jsx(T_,{className:"w-5 h-5 text-[#3399cc]"})}),d.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:"Upload Commercial Pricelist"})]}),d.jsx("p",{className:"text-sm text-slate-500",children:"Upload the updated commercial pricelist (Excel format)"})]}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsx("input",{id:"file-upload-input",type:"file",className:"hidden",accept:".xlsx",onChange:a}),d.jsx("div",{className:`border-2 border-dashed rounded-xl p-12 text-center transition-colors cursor-pointer ${e?"border-emerald-500 bg-emerald-50":"border-slate-300 hover:border-[#3399cc] hover:bg-cyan-50/50"}`,onClick:a,children:e?d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"w-16 h-16 mx-auto rounded-xl bg-emerald-100 flex items-center justify-center",children:d.jsx(Ll,{className:"w-8 h-8 text-emerald-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-slate-900",children:t}),d.jsx("p",{className:"text-sm text-slate-500",children:"Click to replace"})]})]}):d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-sm flex items-center justify-center mx-auto",children:d.jsx(jf,{className:"w-8 h-8 text-[#3399cc]"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-slate-900",children:"Click to browse and upload"}),d.jsx("p",{className:"text-sm text-slate-500",children:"Excel files (.xlsx)"})]})]})}),r&&r.length>0&&d.jsxs("div",{className:"mt-6 border border-slate-200 rounded-xl overflow-hidden",children:[d.jsxs("div",{className:"bg-slate-50 px-4 py-2 border-b border-slate-200 flex justify-between items-center",children:[d.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase",children:["Data Preview (",n," rows)"]}),d.jsx("button",{onClick:c,className:"text-slate-400 hover:text-red-500",children:d.jsx(Zn,{className:"w-4 h-4"})})]}),d.jsx("div",{className:"max-h-100 overflow-auto",children:d.jsxs("table",{className:"w-full text-[11px] text-left border-collapse",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsx("tr",{className:"bg-slate-100 border-b border-slate-200",children:Object.keys(r[0]).map(f=>d.jsx("th",{className:"px-4 py-2 font-bold text-slate-700 whitespace-nowrap",children:f},f))})}),d.jsx("tbody",{children:r.slice(0,10).map((f,h)=>d.jsx("tr",{className:"bg-white hover:bg-slate-50 border-b border-slate-50 transition-colors",children:Object.values(f).map((p,x)=>d.jsx("td",{className:"px-4 py-2 text-slate-600 whitespace-nowrap",children:String(p)},x))},h))})]})})]}),s&&d.jsxs("div",{className:"p-4 bg-red-50 text-red-700 rounded-xl flex items-center gap-2",children:[d.jsx(ud,{className:"w-5 h-5"})," ",s]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("button",{onClick:i,className:"h-11 flex items-center gap-2 px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-700 font-bold hover:bg-slate-50 transition-all shadow-sm",children:[d.jsx(Jn,{className:"w-4 h-4"})," Back"]}),d.jsxs("button",{onClick:o,disabled:!e,className:"btn-primary",children:["Continue ",d.jsx(Mr,{className:"w-4 h-4"})]})]})]})]}),kce=({activeClient:e,uploadedFileName:t,totalRows:r,isAnalyzing:n,error:s,onBack:a,onRunAnalysis:i})=>d.jsxs("div",{className:"group bg-white/80 backdrop-blur-md rounded-3xl border border-slate-200 shadow-2xl shadow-slate-200/60 overflow-hidden",children:[d.jsxs("div",{className:"p-8 border-b border-slate-100 bg-slate-50/30",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("div",{className:"p-2.5 bg-cyan-50 rounded-xl shadow-sm ring-1 ring-cyan-100",children:d.jsx(sY,{className:"w-5 h-5 text-[#3399cc]"})}),d.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:"Run Analysis"})]}),d.jsx("p",{className:"text-sm text-slate-500",children:"Compare uploaded data with GSA contract data"})]}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full mb-10",children:[d.jsxs("div",{className:"p-4 rounded-2xl bg-slate-50 border border-slate-100 flex items-center gap-4",children:[d.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:d.jsx(Xn,{className:"w-5 h-5 text-[#3399cc]"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Client Name"}),d.jsx("p",{className:"text-sm font-semibold text-slate-700",children:(e==null?void 0:e.company_name)||"N/A"})]})]}),d.jsxs("div",{className:"p-4 rounded-2xl bg-slate-50 border border-slate-100 flex items-center gap-4",children:[d.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:d.jsx(Kx,{className:"w-5 h-5 text-emerald-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Contract Number"}),d.jsx("p",{className:"text-sm font-semibold text-slate-700",children:(e==null?void 0:e.contract_number)||"No Contract"})]})]}),d.jsxs("div",{className:"p-4 rounded-2xl bg-slate-50 border border-slate-100 flex items-center gap-4",children:[d.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:d.jsx(Ul,{className:"w-5 h-5 text-indigo-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"File Name"}),d.jsx("p",{className:"text-sm font-semibold text-slate-700 max-w-70",children:t})]})]}),d.jsxs("div",{className:"p-4 rounded-2xl bg-slate-50 border border-slate-100 flex items-center gap-4",children:[d.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:d.jsx(lX,{className:"w-5 h-5 text-orange-600"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:"Total Rows"}),d.jsx("p",{className:"text-sm font-semibold text-slate-700",children:r.toLocaleString()})]})]})]}),s&&d.jsxs("div",{className:"p-4 bg-red-50 text-red-700 rounded-xl flex items-center gap-2",children:[d.jsx(ud,{className:"w-5 h-5"})," ",s]}),d.jsxs("div",{className:"flex justify-between pt-4",children:[d.jsxs("button",{onClick:a,disabled:n,className:"h-11 flex items-center gap-2 px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-700 font-bold hover:bg-slate-50 transition-all shadow-sm",children:[d.jsx(Jn,{className:"w-4 h-4"})," Back"]}),d.jsx("button",{onClick:i,disabled:n,className:"btn-primary",children:n?d.jsxs(d.Fragment,{children:[d.jsx(Ar,{className:"w-5 h-5 animate-spin"})," Analyzing..."]}):d.jsxs(d.Fragment,{children:[d.jsx(VX,{className:"w-4 h-4 fill-current"})," Run Analysis"]})})]})]})]}),Ace=({label:e,value:t,icon:r,variant:n="blue"})=>{const a={emerald:{bg:"bg-emerald-50",text:"text-emerald-600",border:"border-emerald-100",iconBg:"bg-emerald-100/50"},red:{bg:"bg-red-50",text:"text-red-600",border:"border-red-100",iconBg:"bg-red-100/50"},amber:{bg:"bg-amber-50",text:"text-amber-600",border:"border-amber-100",iconBg:"bg-amber-100/50"},cyan:{bg:"bg-cyan-50",text:"text-[#3399cc]",border:"border-cyan-100",iconBg:"bg-cyan-100/50"},blue:{bg:"bg-blue-50",text:"text-blue-600",border:"border-blue-100",iconBg:"bg-blue-100/50"}}[n];return d.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm h-full hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`w-12 h-12 rounded-2xl ${a.iconBg} flex items-center justify-center ${a.text}`,children:We.cloneElement(r,{size:20})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-2xl font-bold text-slate-900 tabular-nums leading-none",children:t.toLocaleString()}),d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mt-1.5",children:e})]})]})})},Cce=({categorized:e,activeTab:t,setActiveTab:r,currentPage:n,setCurrentPage:s,itemsPerPage:a,onExport:i,onReset:o,onGenerateDocuments:c})=>{const f=e[t]||[],h=f.length,p=Math.ceil(h/a),x=(n-1)*a,g=f.slice(x,x+a),v=E=>{const T=[];if(E<=7){for(let O=1;O<=E;O++)T.push(O);return T}T.push(1),n>4&&T.push("...");const k=Math.max(2,n-1),D=Math.min(E-1,n+1);for(let O=k;O<=D;O++)T.push(O);return n<E-3&&T.push("..."),T.push(E),T},y=[{id:"additions",label:"Additions",icon:fd,variant:"emerald",count:e.additions.length},{id:"deletions",label:"Deletions",icon:ZE,variant:"red",count:e.deletions.length},{id:"priceIncreases",label:"Increases",icon:Kc,variant:"amber",count:e.priceIncreases.length},{id:"priceDecreases",label:"Decreases",icon:dd,variant:"cyan",count:e.priceDecreases.length},{id:"descriptionChanges",label:"Descriptions",icon:ou,variant:"blue",count:e.descriptionChanges.length}],w=t==="descriptionChanges",_=t==="priceIncreases"||t==="priceDecreases",S=t==="additions"||t==="deletions";return d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:y.map(E=>d.jsx(Ace,{label:E.label,value:E.count,icon:d.jsx(E.icon,{className:"w-4 h-4"}),variant:E.variant},E.id))}),d.jsxs("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden",children:[d.jsxs("div",{className:"px-6 py-5 border-b border-slate-100 flex items-center justify-between gap-4",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Analysis Results"}),d.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-slate-50 text-slate-700 text-sm font-bold border border-slate-200 hover:bg-slate-100 transition-all",children:[d.jsx(Gx,{size:16})," Export All"]})]}),d.jsx("div",{className:"px-6 pt-4",children:d.jsx("div",{className:"bg-slate-100/80 p-1 rounded-2xl flex items-center w-full ",children:y.map(E=>d.jsxs("button",{onClick:()=>{r(E.id),s(1)},className:`flex-1 flex items-center justify-center gap-2 py-2.5 rounded-xl text-sm font-bold transition-all
                   ${t===E.id?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(E.icon,{size:14,className:t===E.id?`text-${E.variant}-600`:""}),E.label]},E.id))})}),d.jsx("div",{className:"p-6",children:d.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden",children:d.jsxs("table",{className:"w-full text-sm table-fixed",children:[d.jsx("thead",{className:"bg-slate-50/50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Part Number"}),d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Product Name"}),w&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Old Description"}),d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"New Description"})]}),_&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"Old Price"}),d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"New Price"})]}),S&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Description"}),d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"Price"})]})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-100",children:[g.map((E,T)=>d.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[d.jsx("td",{className:"p-3 font-mono text-xs text-slate-500",children:E.manufacturer_part_number||"N/A"}),d.jsx("td",{className:"p-3 font-medium text-slate-900",children:E.product_name||"Unknown Product"}),w&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-xs text-slate-400 truncate max-w-60",children:E.old_description||"-"}),d.jsx("td",{className:"p-3 text-xs text-slate-700",children:E.new_description||"-"})]}),_&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-right text-slate-400 tabular-nums",children:E.old_price?`$${Number(E.old_price).toLocaleString()}`:"-"}),d.jsx("td",{className:"p-3 text-right font-bold text-slate-900 tabular-nums",children:E.new_price?`$${Number(E.new_price).toLocaleString()}`:"-"})]}),S&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-xs text-slate-700 truncate max-w-60",children:E.description||E.new_description||"-"}),d.jsx("td",{className:"p-3 text-right font-bold text-slate-900 tabular-nums",children:E.price??E.new_price?`$${Number(E.price??E.new_price).toLocaleString()}`:"-"})]})]},T)),f.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:4,className:"p-10 text-center text-slate-400 italic",children:"No modifications found for this category."})})]})]})})}),h>a&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing ",d.jsx("span",{className:"text-slate-900 font-semibold",children:x+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(x+a,h)})," ","of ",d.jsx("span",{className:"text-slate-900 font-semibold",children:h})," results"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:n===1,onClick:()=>s(n-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Jn,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:v(p).map((E,T)=>E==="..."?d.jsx("span",{className:"min-w-9 h-9 flex items-center justify-center text-slate-400 font-bold",children:""},T):d.jsx("button",{onClick:()=>s(E),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                        ${n===E?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:E},T))}),d.jsx("button",{disabled:n===p,onClick:()=>s(n+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]}),d.jsxs("div",{className:"flex justify-between items-center pt-4",children:[d.jsx("button",{onClick:o,className:"px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-700 font-bold hover:bg-slate-50 transition-all shadow-sm",children:"Start New Analysis"}),d.jsxs("button",{onClick:c,className:"btn-primary",children:["Generate Documents ",d.jsx(c0,{className:"w-4 h-4"})]})]})]})},Rce=[{id:1,title:"Select Client",description:"Choose a client"},{id:2,title:"Upload Pricelist",description:"Upload Excel file"},{id:3,title:"Run Analysis",description:"Process data"},{id:4,title:"Review Results",description:"Review and export"}];function Oce(){const e=Qn(),{setSelectedJobId:t}=mu(),[r,n]=ne.useState(1),[s,a]=ne.useState(""),[i,o]=ne.useState(!1),[c,f]=ne.useState("additions"),[h,p]=ne.useState(1),x=5,[g,v]=ne.useState([]),[y,w]=ne.useState(!0),[_,S]=ne.useState(null),[E,T]=ne.useState(null),[k,D]=ne.useState(""),[O,z]=ne.useState(null),[j,J]=ne.useState(null),[ae,F]=ne.useState(null),[X,P]=ne.useState(0),[le,ee]=ne.useState(!1);ne.useEffect(()=>{te()},[]);const te=async()=>{try{w(!0);const Z=await Pt.get("clients/approved");v(Z.data)}catch{S("Failed to fetch clients.")}finally{w(!1)}},me=async Z=>{ee(!0);try{const re=await Pt.get(`/jobs/${Z}`);J(re.data)}catch{S("Failed to fetch detailed job results.")}finally{ee(!1)}},ie=async Z=>{var we,B;if(Z.type==="click"){(we=document.getElementById("file-upload-input"))==null||we.click();return}const L=((B=Z.target.files)==null?void 0:B[0])??null;if(!L)return;if(!L.name.endsWith(".xlsx")){S("Invalid format. Please select an Excel (.xlsx) file");return}T(L),D(L.name),S(null);const I=await L.arrayBuffer(),se=new Uint8Array(I),Q=cg(se,{type:"array"}),Y=Q.Sheets[Q.SheetNames[0]],U=Kh.sheet_to_json(Y,{defval:""});if(U.length===0){S("The uploaded Excel file contains no data rows."),T(null),F(null),P(0);return}P(U.length),F(U)},Ee=async()=>{var re,L;if(!E||!s){S("Missing file or client selection");return}o(!0),S(null);const Z=new FormData;Z.append("file",E);try{const I=await Pt.post(`/cpl/${s}`,Z,{headers:{"Content-Type":"multipart/form-data"}});z(I.data),t(I.data.job_id),await me(I.data.job_id),n(4),o(!1)}catch(I){o(!1),S(((L=(re=I==null?void 0:I.response)==null?void 0:re.data)==null?void 0:L.detail)??"Analysis failed. Please try again.")}},K=()=>{const Z=(j==null?void 0:j.modifications_actions)||[];return{additions:Z.filter(re=>re.action_type==="NEW_PRODUCT"||re.action_type==="ADD_PRODUCT"),deletions:Z.filter(re=>re.action_type==="REMOVED_PRODUCT"),priceIncreases:Z.filter(re=>re.action_type==="PRICE_INCREASE"),priceDecreases:Z.filter(re=>re.action_type==="PRICE_DECREASE"),descriptionChanges:Z.filter(re=>re.action_type==="DESCRIPTION_CHANGE")}},M=()=>{n(1),a(""),T(null),D(""),z(null),t(null),J(null),F(null),P(0),S(null),f("additions"),p(1)},q=g.find(Z=>String(Z.client_id)===String(s)),G=()=>{switch(r){case 1:return d.jsx(Nce,{clients:g,selectedClient:s,onClientSelect:Z=>{a(Z),S(null)},onContinue:()=>{if(!q){S("Please select a client.");return}if(!q.has_products){S("No products found for this client. Please upload initial GSA products for selected client before running Price List Analysis.");return}S(null),n(2)},error:_});case 2:return d.jsx(Tce,{file:E,uploadedFileName:k,previewData:ae,totalRows:X,error:_,onFileChange:ie,onBack:()=>{n(1),T(null),F(null),S(null)},onContinue:()=>{n(3),S(null)},onClearFile:()=>{T(null),F(null)}});case 3:return d.jsx(kce,{activeClient:q,uploadedFileName:k,totalRows:X,isAnalyzing:i,error:_,onBack:()=>{n(2),z(null),S(null)},onRunAnalysis:Ee});case 4:return le?d.jsxs("div",{className:"py-20 text-center",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin mx-auto text-[#3399cc]"}),d.jsx("p",{className:"mt-4 text-slate-500",children:"Fetching modification details..."})]}):d.jsx(Cce,{categorized:K(),activeTab:c,setActiveTab:f,currentPage:h,setCurrentPage:p,itemsPerPage:x,onExport:()=>BM(O.job_id,K()),onReset:M,onGenerateDocuments:()=>e("/documents")});default:return null}};return d.jsxs("div",{className:"min-h-screen bg-slate-50/50 p-6 lg:p-10 space-y-10",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:"Price List Analysis"}),d.jsx("p",{className:"text-slate-500 font-medium",children:"Compare commercial pricelists with GSA contract data"})]}),d.jsx(Sce,{steps:Rce,currentStep:r}),d.jsx("div",{className:"w-full",children:G()})]})}const jx=[{id:"add-product",name:"Additions",description:"Request to add new products to an existing GSA contract",icon:"Plus",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contracting Officer",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin_additions",label:"SIN",type:"text",behavior:"editable",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"solicitationNumber",label:"Solicitation Number",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"refresh",label:"Refresh Number",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"coo",label:"Country of Origin",type:"text",behavior:"manual",section:"Request Details"},{id:"basicDiscount",label:"GSA Basic Discount",type:"text",behavior:"manual",section:"Request Details"},{id:"numberOfProductsAdded",label:"Number of Products Added",type:"number",behavior:"readonly",section:"Request Details"},{id:"quantityVolumeDiscount",label:"Quantity / Volume Discount",type:"text",behavior:"readonly",section:"Request Details"},{id:"otherDiscounts",label:"Other Discounts / Concessions",type:"text",behavior:"readonly",section:"Request Details"},{id:"additionRationale",label:"Addition Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"deliveryAroNormal",label:"Delivery ARO  Normal",type:"text",behavior:"readonly",section:"Logistics & Compliance"},{id:"deliveryAroExpedited",label:"Delivery ARO  Expedited",type:"text",behavior:"readonly",section:"Logistics & Compliance"},{id:"fobTerms",label:"FOB Terms",type:"text",behavior:"readonly",section:"Logistics & Compliance"},{id:"energyStarCompliance",label:"Energy Star Compliance",type:"select",behavior:"readonly",section:"Logistics & Compliance",options:[{value:"yes",label:"Yes"},{value:"no",label:"No"},{value:"na",label:"Not Applicable"}]}]},{id:"delete-product",name:"Deletions",description:"Request to remove products from an existing GSA contract",icon:"Trash2",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contracting Officer",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin_deletions",label:"SIN",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"numberOfProductsDeleted",label:"Number of Products Deleted",type:"number",behavior:"readonly",section:"Request Details"},{id:"deletionRationale",label:"Deletional Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]}]},{id:"price-increase",name:"Price Increase",description:"Economic Price Adjustment for price increases based on index changes",icon:"TrendingUp",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contracting Officer",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin_price_increase",label:"SIN",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"priceIncreased",label:"Number of Products Price Increased",type:"number",behavior:"readonly",section:"Request Details"},{id:"requestedIncrease",label:"Requested Increase (%)",type:"percentage",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"increaseRationale",label:"Increase Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"backgroundInfo",label:"Background Information",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]}]},{id:"price-decrease",name:"Price Decrease",description:"Economic Price Adjustment for price decreases based on index changes",icon:"TrendingDown",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contracting Officer",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin_price_decrease",label:"SIN",type:"text",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"priceDecreased",label:"Number of Products Price Decreased",type:"number",behavior:"readonly",section:"Request Details"},{id:"requestedDecrease",label:"Requested Decrease (%)",type:"percentage",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"decreaseRationale",label:"Decrease Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]}]},{id:"description-change",name:"Description Changes",description:"Request to modify product descriptions without price changes",icon:"FileEdit",fields:[{id:"contractNumber",label:"Contract Number",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"companyName",label:"Company Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"salutation",label:"Salutation",type:"select",behavior:"manual",section:"Contract & Contact Info",options:[{value:"Mr.",label:"Mr."},{value:"Ms.",label:"Ms."},{value:"Mrs.",label:"Mrs."}],validation:[{type:"required",message:"Required"}],width:"w-1/4"},{id:"contractorName",label:"Contracting Officer",type:"text",behavior:"readonly",section:"Contract & Contact Info",width:"w-3/4"},{id:"gsaOfficeAddressLine",label:"GSA Office Address Line",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeCity",label:"GSA Office City",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeState",label:"GSA Office State",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"gsaOfficeZip",label:"GSA Office ZIP Code",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"consultantName",label:"Consultant Name",type:"text",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantEmail",label:"Consultant Email",type:"email",behavior:"readonly",section:"Contract & Contact Info"},{id:"consultantPhone",label:"Consultant Phone",type:"text",behavior:"manual",section:"Contract & Contact Info",validation:[{type:"required",message:"Required"}]},{id:"sin_description_change",label:"SIN",type:"text",behavior:"editable",section:"Request Details",validation:[{type:"required",message:"Required"}]},{id:"descriptionChanged",label:"Number of Products Changed",type:"number",behavior:"readonly",section:"Request Details"},{id:"modificationRationale",label:"Description Change Rationale",type:"textarea",behavior:"manual",section:"Request Details",validation:[{type:"required",message:"Required"}]}]}],jce=e=>jx.find(t=>t.id===e),Dce=async e=>(await Pt.get(`/generate/${e}`)).data,Ice=e=>{const t=e.client||{},r=e.client_contract||{},n=e.modification_summary||{},s=r.discounts||{},a=r.delivery||{},i=r.address||{},o=r.other||{};return{companyName:t.company_name,contractNumber:r.contract_number,contractorName:r.contract_officer_name,contractorAddress:i.contract_officer_address,contractorCity:i.contract_officer_city,contractorState:i.contract_officer_state,contractorZip:i.contract_officer_zip,gsaOfficeAddressLine:i.contract_officer_address,gsaOfficeCity:i.contract_officer_city,gsaOfficeState:i.contract_officer_state,gsaOfficeZip:i.contract_officer_zip,gsaOfficeCityStateZip:`${i.contract_officer_city||""}, ${i.contract_officer_state||""}, ${i.contract_officer_zip||""}`.trim(),deliveryAroNormal:a.normal_delivery_time,deliveryAroExpedited:a.expedited_delivery_time,fobTerms:o.fob_term,coo:r.origin_country,basicDiscount:s.gsa_proposed_discount,quantityVolumeDiscount:s.q_v_discount,otherDiscounts:o.additional_concessions,energyStarCompliance:(()=>{var f;const c=(f=o.energy_star_compliance)==null?void 0:f.toLowerCase();return c==="yes"?"yes":c==="no"?"no":c==="applicable"||c==="not applicable"||c==="n/a"?"na":""})(),numberOfProductsAdded:n.products_added,numberOfProductsDeleted:n.products_deleted,descriptionChanged:n.description_changed,numberOfItemsChanged:n.description_changed,priceIncreased:n.price_increased,priceDecreased:n.price_decreased,requestedIncrease:n.price_increased>0?"":void 0,requestedDecrease:n.price_decreased>0?"":void 0}},zM=ne.createContext(void 0),Mce=({children:e})=>{const{user:t}=Ui(),[r,n]=ne.useState("select-type"),[s,a]=ne.useState(null),[i,o]=ne.useState(null),[c,f]=ne.useState({}),[h,p]=ne.useState([]),[x,g]=ne.useState([]),[v,y]=ne.useState(null),[w,_]=ne.useState(null),[S,E]=ne.useState(null),T=ne.useCallback(async(J,ae)=>{const F=jce(J);if(F){o(F),a(J);try{let X={},P=null;ae&&(ae===S&&w?P=w:(n("load-config"),P=await Dce(ae),_(P),E(ae))),P&&(X=Ice(P),y(P.modification_summary)),t&&(X.consultantName=t.name,X.consultantEmail=t.email,X.consultantPhone=t.phone_no);const le={};F.fields.forEach(ee=>{X[ee.id]!==void 0?le[ee.id]=X[ee.id]:ee.defaultValue!==void 0&&(le[ee.id]=ee.defaultValue)}),f(ee=>{const te={...ee};return Object.keys(le).forEach(me=>{(me.toLowerCase().includes("numberof")||me.toLowerCase().includes("priceincreased")||me.toLowerCase().includes("pricedecreased")||me.toLowerCase().includes("descriptionchanged")||ee[me]===void 0||ee[me]==="")&&(te[me]=le[me])}),te})}catch(X){console.error("Prefill failed:",X)}}},[t,S,w,n]),k=ne.useCallback((J,ae)=>{f(F=>({...F,[J]:ae})),p(F=>F.filter(X=>X.fieldId!==J))},[]),D=ne.useCallback(()=>{if(!i)return!1;const J=[];return i.fields.forEach(ae=>{var te;const F=c[ae.id],X=typeof F=="string"?F.trim():F,P=ae.label;if(((te=ae.validation)==null?void 0:te.some(me=>me.type==="required"))&&!X&&X!==0&&(typeof X!="string"||X.trim()==="")){J.push({fieldId:ae.id,message:`${P} is required`});return}if(!X&&X!==0)return;let ee=null;if(ae.type==="email")ee=hd(String(X));else if(ae.id.toLowerCase().includes("phone")||ae.id.toLowerCase().includes("phoneno"))ee=_1(String(X),P);else if(ae.id.toLowerCase().includes("zip")||ae.id.toLowerCase().includes("postal"))ee=E1(String(X));else if(ae.type==="number"||ae.type==="percentage"){const me=Number(X);isNaN(me)?ee=`${P} must be a valid number`:me<0&&(ee=`${P} must be a positive number`)}ee&&J.push({fieldId:ae.id,message:ee})}),p(J),J.length===0},[i,c]),O=ne.useCallback(()=>{n("select-type"),a(null),o(null),f({}),p([]),y(null),_(null),E(null)},[]),z=ne.useCallback(()=>{const J=`DOC-${Date.now().toString(36).toUpperCase()}`,ae=x.filter(F=>F.documentType===s).length;return{id:J,documentType:(i==null?void 0:i.name)||"",version:`v1.${ae}`,generatedBy:(t==null?void 0:t.name)||"Unknown User",generatedAt:new Date().toISOString(),data:{...c}}},[i,x,c,s,t]),j=ne.useCallback(J=>{g(ae=>[J,...ae])},[]);return d.jsx(zM.Provider,{value:{currentStep:r,setCurrentStep:n,selectedDocumentType:s,setSelectedDocumentType:a,documentConfig:i,formData:c,setFormData:f,updateField:k,validationErrors:h,setValidationErrors:p,validateForm:D,documentHistory:x,addToHistory:j,loadDocumentConfig:T,resetWorkflow:O,generateDocument:z,analysisSummary:v},children:e})},HS=()=>{const e=ne.useContext(zM);if(!e)throw new Error("useDocument must be used within a DocumentProvider");return e},Fce={"add-product":{primary:"#059669",bg:"bg-emerald-50",border:"border-emerald-200",hoverBorder:"hover:border-emerald-500/40",iconBg:"bg-emerald-100",iconColor:"#059669",dotBg:"bg-emerald-600",chevron:"text-emerald-600"},"delete-product":{primary:"#DC2626",bg:"bg-red-50/50",border:"border-red-200",hoverBorder:"hover:border-red-500/40",iconBg:"bg-red-100",iconColor:"#DC2626",dotBg:"bg-red-500",chevron:"text-red-500"},"price-increase":{primary:"#d97706",bg:"bg-amber-50/50",border:"border-amber-200",hoverBorder:"hover:border-amber-500/40",iconBg:"bg-amber-100",iconColor:"#d97706",dotBg:"bg-amber-600",chevron:"text-amber-600"},"price-decrease":{primary:"#0891B2",bg:"bg-cyan-50/50",border:"border-cyan-200",hoverBorder:"hover:border-cyan-500/40",iconBg:"bg-cyan-100",iconColor:"#0891B2",dotBg:"bg-cyan-600",chevron:"text-cyan-600"},"description-change":{primary:"#2563EB",bg:"bg-blue-50/50",border:"border-blue-200",hoverBorder:"hover:border-blue-500/40",iconBg:"bg-blue-100",iconColor:"#2563EB",dotBg:"bg-blue-600",chevron:"text-blue-600"}},Pce={Plus:fd,Trash2:oY,TrendingUp:Kc,TrendingDown:dd,FileEdit:ou},Lce=({config:e,isSelected:t,onSelect:r,count:n,variant:s="grid"})=>{const a=Pce[e.icon]||ou,i=Fce[e.id];return s==="horizontal"?d.jsxs("div",{onClick:r,className:`
          group cursor-pointer transition-all duration-300
          px-6 py-4 rounded-2xl relative overflow-hidden flex items-center gap-4 shrink-0
          ${t?`bg-white shadow-md border ${i.border} scale-[1.02]`:`bg-white backdrop-blur-sm shadow-sm  border-slate-200 hover:shadow-md ${i.hoverBorder} hover:scale-[1.01]`}
        `,children:[d.jsx("div",{className:`
            w-10 h-10 rounded-xl flex items-center justify-center shrink-0
            transition-all duration-300
            ${t?`${i.iconBg} shadow-lg shadow-black/10`:`bg-slate-100 group-hover:${i.bg}`}
          `,children:d.jsx(a,{className:`w-5 h-5 transition-all duration-300 ${t?"scale-110":"group-hover:scale-110"}`,style:{color:i.iconColor}})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"font-bold text-sm text-slate-900 tracking-tight truncate",children:e.name}),n!==void 0&&d.jsxs("p",{className:"text-[10px] font-bold text-slate-400 mt-0.5 animate-in fade-in slide-in-from-left-1 duration-500",children:[n," ",n===1?"modification":"modifications"]})]}),t&&d.jsx("div",{className:`absolute top-2 right-2 w-1.5 h-1.5 rounded-full ${i.dotBg} animate-pulse`})]}):d.jsxs("div",{onClick:r,className:`
        group cursor-pointer transition-all duration-300
        p-8 rounded-3xl relative overflow-hidden
        ${t?`bg-white shadow-xl border-2 ${i.border} scale-[1.02]`:`bg-white/80 backdrop-blur-sm shadow-sm border border-slate-200 hover:shadow-lg ${i.hoverBorder} hover:scale-[1.01]`}
      `,children:[t&&d.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10",style:{background:`linear-gradient(135deg, ${i.primary} 0%, transparent 100%)`}}),d.jsxs("div",{className:"flex items-start gap-6 relative z-10",children:[d.jsx("div",{className:`
            w-14 h-14 rounded-2xl flex items-center justify-center shrink-0
            transition-all duration-300
            ${t?`${i.iconBg} shadow-lg shadow-black/10`:`bg-slate-50 border border-slate-200 group-hover:${i.bg} group-hover:border-black/5`}
          `,children:d.jsx(a,{className:`w-6 h-6 transition-all duration-300 ${t?"scale-110":"group-hover:scale-110"}`,style:{color:t?"#ffffff":i.iconColor},strokeWidth:2.5})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex items-center justify-between gap-3 mb-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("h3",{className:"font-bold text-lg text-slate-900 tracking-tight",children:e.name}),n!==void 0&&d.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold ${i.bg} ${i.chevron} border ${i.border} animate-in zoom-in duration-500`,children:n})]}),d.jsx(Mr,{className:`w-5 h-5 transition-all duration-300 shrink-0 ${t?`${i.chevron} translate-x-1`:`text-slate-300 group-hover:${i.chevron} group-hover:translate-x-1`}`})]}),d.jsx("p",{className:"text-sm text-slate-500 font-medium leading-relaxed",children:e.description})]})]}),t&&d.jsx("div",{className:`absolute top-4 right-4 w-2 h-2 rounded-full ${i.dotBg} animate-pulse`})]})};function Bce(){var S;const{documentConfig:e,formData:t,updateField:r,validateForm:n,setCurrentStep:s,validationErrors:a}=HS(),i=Qn(),[o,c]=ne.useState(""),f={muted:"#627383",border:"#d9e0e8",secondaryBg:"#f8fafc"},h=`
    w-full mt-2 px-4 py-3 rounded-xl border transition-all text-sm font-medium
    focus:outline-none focus:ring-4 focus:ring-[#24548f]/5 focus:border-[#24548f]
    placeholder:text-slate-400
  `,p=`
    w-full mt-2 px-4 py-3 rounded-xl border bg-[#f8fafc] text-[#627383] 
    cursor-not-allowed border-[#d9e0e8] font-medium text-sm
  `,x=ne.useMemo(()=>e!=null&&e.fields?e.fields.reduce((E,T)=>{const k=T.section||"General Information";return E[k]||(E[k]=[]),E[k].push(T),E},{}):{},[e]),g=ne.useMemo(()=>Object.keys(x),[x]);ne.useEffect(()=>{g.length!==0&&(g.includes(o)||c(g[0]))},[g,o]);const v=()=>{n()&&s("preview")},y=E=>{var k;const T=((k=x[E])==null?void 0:k.map(D=>D.id))||[];return a.some(D=>T.includes(D.fieldId))};if(!e)return d.jsx("div",{className:"min-h-100 flex items-center justify-center text-slate-500 font-bold",children:"Please select a document type first."});const w=E=>{switch(E){case"number":case"email":case"password":case"date":return E;default:return"text"}},_=g.indexOf(o);return d.jsxs("div",{className:"animate-fade-in  mx-auto",children:[d.jsx("div",{className:"flex flex-wrap gap-2 mb-6 border-b border-slate-200",children:g.map(E=>{const T=o===E,k=y(E);return d.jsxs("button",{onClick:()=>c(E),className:`px-6 py-4 text-xs font-bold uppercase tracking-widest transition-all border-b-2 relative ${T?"border-[#24548f] text-[#24548f]":"border-transparent text-slate-400 hover:text-slate-600"}`,children:[E,k&&d.jsxs("span",{className:"absolute top-3 right-2 flex h-2 w-2",children:[d.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),d.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-red-500"})]})]},E)})}),d.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden min-h-100 animate-slide-up",children:d.jsx("div",{className:"p-8 flex flex-wrap -mx-4 gap-y-6",children:(S=x[o])==null?void 0:S.map(E=>{var O,z,j;const T=E.behavior==="readonly",k=a.some(J=>J.fieldId===E.id),D=E.width||(E.type==="textarea"?"w-full":"w-full md:w-1/2");return d.jsxs("div",{className:`${D} px-4`,children:[d.jsxs("label",{className:"text-sm font-black ml-1",style:{color:f.muted},children:[E.label," ",((O=E.validation)==null?void 0:O.some(J=>J.type==="required"))&&d.jsx("span",{className:"text-red-500 mr-1",children:"*"})]}),E.type==="textarea"?d.jsx("textarea",{value:t[E.id]||"",onChange:J=>r(E.id,J.target.value),disabled:T,placeholder:E.placeholder,className:`${T?p:h} min-h-30 resize-none`,style:{borderColor:f.border,backgroundColor:T?f.secondaryBg:"white"}}):E.type==="select"?d.jsxs("div",{className:"relative",children:[d.jsxs("select",{value:t[E.id]||"",onChange:J=>r(E.id,J.target.value),disabled:T,className:`${T?p:h} appearance-none pr-8`,style:{borderColor:f.border,backgroundColor:T?f.secondaryBg:"white"},children:[d.jsxs("option",{value:"",disabled:!0,children:["Select ",E.label]}),(z=E.options)==null?void 0:z.map(J=>d.jsx("option",{value:J.value,children:J.label},J.value))]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:d.jsx(Mr,{className:"w-4 h-4 text-gray-400 rotate-90"})})]}):d.jsx("input",{type:w(E.type),value:t[E.id]||"",onChange:J=>r(E.id,J.target.value),disabled:T,placeholder:E.placeholder,className:T?p:h,style:{borderColor:f.border,backgroundColor:T?f.secondaryBg:"white"}}),k&&d.jsx("div",{className:"flex items-center gap-1 mt-1.5 ml-1 text-red-600",children:d.jsx("p",{className:"text-xs",children:((j=a.find(J=>J.fieldId===E.id))==null?void 0:j.message)||"This field is required"})})]},E.id)})})}),d.jsxs("div",{className:"mt-8 flex items-center justify-between pb-10",children:[_===0?d.jsxs("button",{onClick:()=>i(-1),className:"flex items-center gap-2 px-5 py-3 rounded-xl font-medium text-sm bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 transition-colors",children:[d.jsx(Jn,{className:"w-4 h-4"}),"Back"]}):d.jsxs("button",{onClick:()=>_>0?c(g[_-1]):s("select-type"),className:"flex items-center gap-2 px-5 py-3 rounded-xl font-medium text-sm bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 transition-colors",children:[d.jsx(Jn,{className:"w-4 h-4"}),"Previous Section"]}),_===g.length-1?d.jsxs("button",{onClick:v,className:"btn-primary",children:["Review & Continue",d.jsx(Mr,{className:"w-4 h-4",strokeWidth:3})]}):d.jsxs("button",{onClick:()=>c(g[_+1]),className:"btn-primary",children:["Next Section",d.jsx(Mr,{className:"w-4 h-4"})]})]})]})}const Uce=e=>{switch(e){case"addition":case"add-product":case"add-product-modification":return"addition";case"deletion":case"delete-product":return"deletion";case"price-increase":return"price-increase";case"price-decrease":return"price-decrease";case"description-change":return"description-change";default:return console.error("No template mapped for documentId:",e),null}},zce=({data:e})=>d.jsxs("div",{className:"relative text-[14px] leading-[1.6] text-foreground px-12 py-10",style:{fontFamily:"'Times New Roman', Times, serif"},children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-10"})}),d.jsx("p",{className:"mb-6",children:e.submissionDate}),d.jsxs("p",{className:"mb-6",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-6",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["Add Product Modification to GSA Contract"," ",d.jsx("strong",{children:e.contractNumber})]})]})}),d.jsxs("p",{className:"mb-4",children:["Dear ",e.salutation," ",e.contractorName]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of an Add Product Modification to GSA Schedule Contract"," ",d.jsx("strong",{children:e.contractNumber}),"."," ",d.jsx("strong",{children:e.numberOfProductsAdded})," products under SIN(s)"," ",d.jsx("strong",{children:e.sin_additions}),". We would like to add these products because"," ",d.jsx("strong",{children:e.additionRationale}),"."]}),d.jsxs("ul",{className:"list-disc ml-6 mb-4 space-y-1",children:[d.jsxs("li",{children:["We certify that these products are TAA Compliant in accordance with 52.225-6 TRADE AGREEMENTS CERTIFICATE (MAY 2014). The Country of Origin for the added products is"," ",d.jsx("strong",{children:e!=null&&e.coo&&e.coo.trim()!==""&&e.coo!=="undefined"?e.coo:""}),"."]}),d.jsxs("li",{children:["GSA Basic Discount: ",d.jsx("strong",{children:e.basicDiscount})," %"]}),d.jsxs("li",{children:["Number of products added:"," ",d.jsx("strong",{children:e.numberOfProductsAdded||"0"})]}),d.jsxs("li",{children:["Quantity / Volume Discount:"," ",d.jsx("strong",{children:e.quantityVolumeDiscount||"None"})]}),d.jsxs("li",{children:["Other Discounts / Concessions:"," ",d.jsx("strong",{children:e.otherDiscounts||""})]}),d.jsxs("li",{children:["Delivery After Receipt of Order (ARO):",d.jsxs("ul",{className:"list-disc ml-6",children:[d.jsxs("li",{children:["Normal: ",d.jsx("strong",{children:e.deliveryAroNormal})]}),d.jsxs("li",{children:["Expedited: ",d.jsx("strong",{children:e.deliveryAroExpedited})]})]})]}),d.jsxs("li",{children:["FOB Terms: ",d.jsx("strong",{children:e.fobTerms})]}),d.jsx("li",{children:"There have been (no) changes to our Commercial Sales Practices."}),d.jsxs("li",{children:["Energy Star Compliance:"," ",e.energyStarCompliance==="yes"?d.jsx("strong",{children:"Yes"}):e.energyStarCompliance==="no"?d.jsx("strong",{children:"No"}):e.energyStarCompliance==="na"?d.jsx("strong",{children:"Not Applicable"}):""]}),d.jsxs("li",{children:["This modification is submitted under Solicitation",d.jsx("strong",{children:` ${e.solicitationNumber}`})," Refresh"," ",d.jsx("strong",{children:e.refresh}),"."]}),d.jsx("li",{children:"The items being added are not identical/substantially similar to previously deleted items that had a lower Schedule price."}),d.jsx("li",{children:"No hazardous materials will be delivered under this contract."}),d.jsx("li",{children:"Place of Performance per FAR 52.215-6 (see current Solicitation)."}),d.jsx("li",{children:"If applicable, EPA method and mechanism are unchanged or proposed herein."})]}),d.jsx("p",{className:"mb-4",children:"I certify to the best of my knowledge that the information I provided is current, complete and accurate. All other terms and conditions remain the same."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",d.jsx("strong",{children:e.consultantName})," at The Winvale Group at"," ",d.jsx("strong",{children:e.consultantPhone})," or"," ",d.jsx("strong",{children:e.consultantEmail}),"."]}),d.jsx("p",{className:"mb-4",children:"Sincerely,"}),d.jsx("div",{children:d.jsxs("p",{children:["_________________________________",d.jsx("br",{}),e.contractorName||"AUTHORIZED NEGOTIATOR NAME",d.jsx("br",{}),e.authorizedNegotiatorTitle||"[Title]","  Authorized to sign on behalf of ",e.companyName||"COMPANY NAME"]})})]}),Hce=({data:e})=>d.jsxs("div",{className:"relative text-[14px] leading-[1.6] text-foreground px-12 py-10",style:{fontFamily:"'Times New Roman', Times, serif"},children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-35 object-contain"})}),d.jsx("p",{className:"mb-6",children:e.submissionDate||"DATE"}),d.jsxs("p",{className:"mb-6",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-6",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["Deletion Modification to GSA Contract"," ",d.jsx("strong",{children:e.contractNumber})]})]})}),d.jsxs("p",{className:"mb-4",children:["Dear ",e.salutation," ",e.contractorName]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of a Deletion Modification to GSA Schedule Contract"," ",d.jsx("strong",{children:e.contractNumber}),". The modification consists of the deletion of ",d.jsx("strong",{children:e.numberOfProductsDeleted})," item(s) listed under SIN ",d.jsx("strong",{children:e.sin_deletions}),". These products are being removed because ",d.jsx("strong",{children:e.deletionRationale}),"."]}),d.jsxs("p",{className:"mb-1",children:[e.companyName," states the following:"]}),d.jsx("ol",{className:"ml-10 mb-4 space-y-1 list-outside",style:{listStyleType:"lower-alpha"},children:d.jsx("li",{children:"The items being deleted will not be added at a later date with a higher price without justification for such higher price."})}),d.jsx("p",{className:"mb-4",children:"I certify to the best of my knowledge that the information provided is current, complete, and accurate. All other terms and conditions of the contract remain unchanged."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",d.jsx("strong",{children:e.consultantName})," of The Winvale Group at ",d.jsx("strong",{children:e.consultantPhone})," or"," ",d.jsx("strong",{children:e.consultantEmail}),"."]}),d.jsx("p",{className:"mb-4",children:"Sincerely,"}),d.jsx("div",{children:d.jsxs("p",{children:["_________________________________",d.jsx("br",{}),e.contractorName||"AUTHORIZED NEGOTIATOR NAME",d.jsx("br",{}),e.authorizedNegotiatorTitle||"[Title]","  Authorized to sign on behalf of ",e.companyName||"COMPANY NAME"]})})]}),Vce=({data:e})=>d.jsxs("div",{className:"relative text-[13px] leading-[1.6] text-foreground px-8 py-6",children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-35 object-contain"})}),d.jsx("p",{className:"mb-4",children:e.submissionDate}),d.jsxs("p",{className:"mb-4",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-4",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["Product Descriptive Change Modification to GSA Contract"," ",d.jsx("strong",{children:e.contractNumber})]})]})}),d.jsxs("p",{className:"mb-3",children:["Dear ",e.salutation," ",e.contractorName]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of a product descriptive modification to GSA Schedule Contract"," ",d.jsx("strong",{children:e.contractNumber})," under SIN"," ",d.jsx("strong",{children:e.sin_description_change}),". The modification consists of descriptive changes for ",d.jsx("strong",{children:e.descriptionChanged})," ","item(s) due to ",d.jsx("strong",{children:e.modificationRationale}),". These revisions will not result in any changes to the GSA price."]}),d.jsx("p",{className:"mb-4",children:"I certify to the best of my knowledge that the information I provided is current, complete and accurate. All other terms and conditions remain the same."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",d.jsx("strong",{children:e.consultantName})," at"," ",d.jsx("strong",{children:e.consultantPhone})," or"," ",d.jsx("strong",{children:e.consultantEmail}),"."]}),d.jsx("p",{className:"mb-4",children:"Respectfully,"}),d.jsx("div",{children:d.jsxs("p",{children:["_________________________________",d.jsx("br",{}),e.contractorName||"AUTHORIZED NEGOTIATOR NAME",d.jsx("br",{}),e.authorizedNegotiatorTitle||"[Title]","  Authorized to sign on behalf of ",e.companyName||"COMPANY NAME"]})})]}),qce=({data:e})=>d.jsxs("div",{className:"relative text-[14px] leading-[1.6] text-foreground px-12 py-10",style:{fontFamily:"'Times New Roman', Times, serif"},children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-35 object-contain"})}),d.jsx("p",{className:"mb-6",children:e.submissionDate}),d.jsxs("p",{className:"mb-6",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-6",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["EPA Modification Based on a Commercial Price List to GSA Contract"," ",d.jsx("strong",{children:e.contractNumber})]})]})}),d.jsxs("p",{className:"mb-4",children:["Dear ",e.salutation," ",e.contractorName]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of an Economic Price Adjustment (EPA) increase based on a Commercial Price List to GSA Schedule Contract ",d.jsx("strong",{children:e.contractNumber})," under SIN"," ",d.jsx("strong",{children:e.sin_price_increase}),". This request is in accordance with EPA Clause GSAM 538.270-4(a)(3). The modification consists of a price increase of"," ",d.jsxs("strong",{children:[e.requestedIncrease||e.priceIncreasePercent,"%"]})," ","for ",d.jsx("strong",{children:e.priceIncreased})," item(s) due to"," ",d.jsx("strong",{children:e.increaseRationale}),"."]}),d.jsxs("ul",{className:"list-[lower-alpha] ml-10 mb-4 space-y-2",children:[d.jsx("li",{children:e.backgroundInfo||"[Background information regarding your current prices, the applicable wage determination price levels (if applicable), and the increases necessary for your company.]"}),d.jsx("li",{children:e.justification||"[Justification for increase. If the EPA requested exceeds the allowable Ceiling Limit, provide specific justification and attach supporting documentation to the modification.] "}),d.jsxs("li",{children:[e.companyName," acknowledges that the proposed price increase will not become effective until the Contracting Officer executes the completed modification."]}),d.jsx("li",{children:"All prices offered to GSA include the current Industrial Funding Fee (IFF)."}),d.jsx("li",{children:e.cspStatement||"For non-TDR only: Statement that Commercial Sales Practices (CSP) Information in accordance with GSAR 552.238-81 PRICE REDUCTIONS (see most current Solicitation for clause/deviation effective date) previously submitted with the initial award (or contract modification) or CSP-1 has not changed, if applicable. If CSP has changed, provide updated CSP-1 in eMod."}),d.jsx("li",{children:e.confirmStatement||"This request conforms to the agreed upon EPA method."})]}),d.jsx("p",{className:"mb-4",children:"I certify to the best of my knowledge that the information I provided is current, complete and accurate. All other terms and conditions remain the same."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",d.jsx("strong",{children:e.consultantName})," at The Winvale Group at"," ",d.jsx("strong",{children:e.consultantPhone})," or"," ",d.jsx("strong",{children:e.consultantEmail}),"."]}),d.jsx("p",{className:"mb-4",children:"Respectfully,"}),d.jsx("div",{children:d.jsxs("p",{children:["_________________________________",d.jsx("br",{}),e.contractorName||"AUTHORIZED NEGOTIATOR NAME",d.jsx("br",{}),e.authorizedNegotiatorTitle||"[Title]","  Authorized to sign on behalf of ",e.companyName||"COMPANY NAME"]})})]}),Wce=({data:e})=>d.jsxs("div",{className:"relative text-[14px] leading-[1.6] text-foreground px-12 py-10",style:{fontFamily:"'Times New Roman', Times, serif"},children:[d.jsx("div",{className:"absolute top-6 right-8",children:d.jsx("img",{src:"logo.png",alt:"Winvale",className:"h-10 w-35 object-contain"})}),d.jsx("p",{className:"mb-6",children:e.submissionDate}),d.jsxs("p",{className:"mb-6",children:["Attn: ",e.contractorName," (",e.contractNumber,") ",d.jsx("br",{}),"General Services Administration ",d.jsx("br",{}),e.gsaOfficeAddressLine," ",d.jsx("br",{}),e.gsaOfficeCityStateZip]}),d.jsx("div",{className:"mb-6",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Re:"})," ",d.jsx("strong",{children:e.companyName}),d.jsx("br",{}),d.jsxs("strong",{children:["Price Reduction Modification Based on a Commercial Price List to GSA Contract ",e.contractNumber]})]})}),d.jsxs("p",{className:"mb-4",children:["Dear ",e.salutation," ",e.contractorName,","]}),d.jsxs("p",{className:"mb-4",children:["The purpose of this letter is to request your approval of a price reduction modification based on a Commercial Price List to GSA Schedule Contract ",d.jsx("strong",{children:e.contractNumber})," under SIN"," ",d.jsx("strong",{children:e.sin_price_decrease}),". This request is in accordance with EPA Clause GSAM 538.270-4(a)(3). The modification consists of a price decrease of"," ",d.jsxs("strong",{children:[e.requestedDecrease||e.priceDecreasePercent,"%"]})," ","for ",d.jsx("strong",{children:e.priceDecreased})," item(s) due to"," ",d.jsx("strong",{children:e.decreaseRationale}),"."]}),d.jsxs("ul",{className:"list-disc ml-10 mb-4 space-y-2",children:[d.jsxs("li",{children:[e.companyName," acknowledges that this proposed price decrease will go into effect immediately, as of the date of submission."]}),d.jsx("li",{children:"All prices offered to GSA include the current IFF."}),d.jsx("li",{children:e.cspStatement||"For non-TDR contracts only: Commercial Sales Practices (CSP) information previously submitted in accordance with GSAR 552.238-81 Price Reductions remains accurate and unchanged. If CSP information has changed, an updated CSP-1 has been provided within eMod."})]}),d.jsx("p",{className:"mb-4",children:"I certify to the best of my knowledge that the information I provided is current, complete, and accurate. All other terms and conditions remain the same."}),d.jsxs("p",{className:"mb-4",children:["If you have any questions regarding this request, please contact"," ",d.jsx("strong",{children:e.consultantName})," at The Winvale Group at"," ",d.jsx("strong",{children:e.consultantPhone})," or"," ",d.jsx("strong",{children:e.consultantEmail}),"."]}),d.jsx("p",{className:"mb-4",children:"Respectfully ,"}),d.jsx("div",{children:d.jsxs("p",{children:["_________________________________",d.jsx("br",{}),e.contractorName||"AUTHORIZED NEGOTIATOR NAME",d.jsx("br",{}),e.authorizedNegotiatorTitle||"[Title]","  Authorized to sign on behalf of ",e.companyName||"COMPANY NAME"]})})]}),$ce=({documentId:e,data:t})=>{const r=Uce(e);return d.jsx("div",{id:"document-export-root",className:"bg-white text-black w-full",children:(()=>{switch(r){case"addition":return d.jsx(zce,{data:t});case"deletion":return d.jsx(Hce,{data:t});case"description-change":return d.jsx(Vce,{data:t});case"price-increase":return d.jsx(qce,{data:t});case"price-decrease":return d.jsx(Wce,{data:t});default:return null}})()})};var Hb={exports:{}},Vb={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B5;function Gce(){if(B5)return Vb;B5=1;var e=P0();function t(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,s=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function o(p,x){var g=x(),v=n({inst:{value:g,getSnapshot:x}}),y=v[0].inst,w=v[1];return a(function(){y.value=g,y.getSnapshot=x,c(y)&&w({inst:y})},[p,g,x]),s(function(){return c(y)&&w({inst:y}),p(function(){c(y)&&w({inst:y})})},[p]),i(g),g}function c(p){var x=p.getSnapshot;p=p.value;try{var g=x();return!r(p,g)}catch{return!0}}function f(p,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:o;return Vb.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,Vb}var U5;function HM(){return U5||(U5=1,Hb.exports=Gce()),Hb.exports}var VM=HM();function Vn(e){this.content=e}Vn.prototype={constructor:Vn,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,r){var n=r&&r!=e?this.remove(r):this,s=n.find(e),a=n.content.slice();return s==-1?a.push(r||e,t):(a[s+1]=t,r&&(a[s]=r)),new Vn(a)},remove:function(e){var t=this.find(e);if(t==-1)return this;var r=this.content.slice();return r.splice(t,2),new Vn(r)},addToStart:function(e,t){return new Vn([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var r=this.remove(e).content.slice();return r.push(e,t),new Vn(r)},addBefore:function(e,t,r){var n=this.remove(t),s=n.content.slice(),a=n.find(e);return s.splice(a==-1?s.length:a,0,t,r),new Vn(s)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=Vn.from(e),e.size?new Vn(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=Vn.from(e),e.size?new Vn(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Vn.from(e);for(var r=0;r<e.content.length;r+=2)t=t.remove(e.content[r]);return t},toObject:function(){var e={};return this.forEach(function(t,r){e[t]=r}),e},get size(){return this.content.length>>1}};Vn.from=function(e){if(e instanceof Vn)return e;var t=[];if(e)for(var r in e)t.push(r,e[r]);return new Vn(t)};function qM(e,t,r){for(let n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:r;let s=e.child(n),a=t.child(n);if(s==a){r+=s.nodeSize;continue}if(!s.sameMarkup(a))return r;if(s.isText&&s.text!=a.text){for(let i=0;s.text[i]==a.text[i];i++)r++;return r}if(s.content.size||a.content.size){let i=qM(s.content,a.content,r+1);if(i!=null)return i}r+=s.nodeSize}}function WM(e,t,r,n){for(let s=e.childCount,a=t.childCount;;){if(s==0||a==0)return s==a?null:{a:r,b:n};let i=e.child(--s),o=t.child(--a),c=i.nodeSize;if(i==o){r-=c,n-=c;continue}if(!i.sameMarkup(o))return{a:r,b:n};if(i.isText&&i.text!=o.text){let f=0,h=Math.min(i.text.length,o.text.length);for(;f<h&&i.text[i.text.length-f-1]==o.text[o.text.length-f-1];)f++,r--,n--;return{a:r,b:n}}if(i.content.size||o.content.size){let f=WM(i.content,o.content,r-1,n-1);if(f)return f}r-=c,n-=c}}class Ke{constructor(t,r){if(this.content=t,this.size=r||0,r==null)for(let n=0;n<t.length;n++)this.size+=t[n].nodeSize}nodesBetween(t,r,n,s=0,a){for(let i=0,o=0;o<r;i++){let c=this.content[i],f=o+c.nodeSize;if(f>t&&n(c,s+o,a||null,i)!==!1&&c.content.size){let h=o+1;c.nodesBetween(Math.max(0,t-h),Math.min(c.content.size,r-h),n,s+h)}o=f}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,r,n,s){let a="",i=!0;return this.nodesBetween(t,r,(o,c)=>{let f=o.isText?o.text.slice(Math.max(t,c)-c,r-c):o.isLeaf?s?typeof s=="function"?s(o):s:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&f||o.isTextblock)&&n&&(i?i=!1:a+=n),a+=f},0),a}append(t){if(!t.size)return this;if(!this.size)return t;let r=this.lastChild,n=t.firstChild,s=this.content.slice(),a=0;for(r.isText&&r.sameMarkup(n)&&(s[s.length-1]=r.withText(r.text+n.text),a=1);a<t.content.length;a++)s.push(t.content[a]);return new Ke(s,this.size+t.size)}cut(t,r=this.size){if(t==0&&r==this.size)return this;let n=[],s=0;if(r>t)for(let a=0,i=0;i<r;a++){let o=this.content[a],c=i+o.nodeSize;c>t&&((i<t||c>r)&&(o.isText?o=o.cut(Math.max(0,t-i),Math.min(o.text.length,r-i)):o=o.cut(Math.max(0,t-i-1),Math.min(o.content.size,r-i-1))),n.push(o),s+=o.nodeSize),i=c}return new Ke(n,s)}cutByIndex(t,r){return t==r?Ke.empty:t==0&&r==this.content.length?this:new Ke(this.content.slice(t,r))}replaceChild(t,r){let n=this.content[t];if(n==r)return this;let s=this.content.slice(),a=this.size+r.nodeSize-n.nodeSize;return s[t]=r,new Ke(s,a)}addToStart(t){return new Ke([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new Ke(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(t.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let r=this.content[t];if(!r)throw new RangeError("Index "+t+" out of range for "+this);return r}maybeChild(t){return this.content[t]||null}forEach(t){for(let r=0,n=0;r<this.content.length;r++){let s=this.content[r];t(s,n,r),n+=s.nodeSize}}findDiffStart(t,r=0){return qM(this,t,r)}findDiffEnd(t,r=this.size,n=t.size){return WM(this,t,r,n)}findIndex(t){if(t==0)return Jm(0,t);if(t==this.size)return Jm(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,n=0;;r++){let s=this.child(r),a=n+s.nodeSize;if(a>=t)return a==t?Jm(r+1,a):Jm(r,n);n=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,r){if(!r)return Ke.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ke(r.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return Ke.empty;let r,n=0;for(let s=0;s<t.length;s++){let a=t[s];n+=a.nodeSize,s&&a.isText&&t[s-1].sameMarkup(a)?(r||(r=t.slice(0,s)),r[r.length-1]=a.withText(r[r.length-1].text+a.text)):r&&r.push(a)}return new Ke(r||t,n)}static from(t){if(!t)return Ke.empty;if(t instanceof Ke)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Ke([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ke.empty=new Ke([],0);const qb={index:0,offset:0};function Jm(e,t){return qb.index=e,qb.offset=t,qb}function fg(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;let r=Array.isArray(e);if(Array.isArray(t)!=r)return!1;if(r){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!fg(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!fg(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}let mr=class z_{constructor(t,r){this.type=t,this.attrs=r}addToSet(t){let r,n=!1;for(let s=0;s<t.length;s++){let a=t[s];if(this.eq(a))return t;if(this.type.excludes(a.type))r||(r=t.slice(0,s));else{if(a.type.excludes(this.type))return t;!n&&a.type.rank>this.type.rank&&(r||(r=t.slice(0,s)),r.push(this),n=!0),r&&r.push(a)}}return r||(r=t.slice()),n||r.push(this),r}removeFromSet(t){for(let r=0;r<t.length;r++)if(this.eq(t[r]))return t.slice(0,r).concat(t.slice(r+1));return t}isInSet(t){for(let r=0;r<t.length;r++)if(this.eq(t[r]))return!0;return!1}eq(t){return this==t||this.type==t.type&&fg(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let r in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=t.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let s=n.create(r.attrs);return n.checkAttrs(s.attrs),s}static sameSet(t,r){if(t==r)return!0;if(t.length!=r.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].eq(r[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return z_.none;if(t instanceof z_)return[t];let r=t.slice();return r.sort((n,s)=>n.type.rank-s.type.rank),r}};mr.none=[];class dg extends Error{}class it{constructor(t,r,n){this.content=t,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,r){let n=GM(this.content,t+this.openStart,r);return n&&new it(n,this.openStart,this.openEnd)}removeBetween(t,r){return new it($M(this.content,t+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,r){if(!r)return it.empty;let n=r.openStart||0,s=r.openEnd||0;if(typeof n!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new it(Ke.fromJSON(t,r.content),n,s)}static maxOpen(t,r=!0){let n=0,s=0;for(let a=t.firstChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.firstChild)n++;for(let a=t.lastChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.lastChild)s++;return new it(t,n,s)}}it.empty=new it(Ke.empty,0,0);function $M(e,t,r){let{index:n,offset:s}=e.findIndex(t),a=e.maybeChild(n),{index:i,offset:o}=e.findIndex(r);if(s==t||a.isText){if(o!=r&&!e.child(i).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(r))}if(n!=i)throw new RangeError("Removing non-flat range");return e.replaceChild(n,a.copy($M(a.content,t-s-1,r-s-1)))}function GM(e,t,r,n){let{index:s,offset:a}=e.findIndex(t),i=e.maybeChild(s);if(a==t||i.isText)return n&&!n.canReplace(s,s,r)?null:e.cut(0,t).append(r).append(e.cut(t));let o=GM(i.content,t-a-1,r,i);return o&&e.replaceChild(s,i.copy(o))}function Kce(e,t,r){if(r.openStart>e.depth)throw new dg("Inserted content deeper than insertion position");if(e.depth-r.openStart!=t.depth-r.openEnd)throw new dg("Inconsistent open depths");return KM(e,t,r,0)}function KM(e,t,r,n){let s=e.index(n),a=e.node(n);if(s==t.index(n)&&n<e.depth-r.openStart){let i=KM(e,t,r,n+1);return a.copy(a.content.replaceChild(s,i))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&e.depth==n&&t.depth==n){let i=e.parent,o=i.content;return Uc(i,o.cut(0,e.parentOffset).append(r.content).append(o.cut(t.parentOffset)))}else{let{start:i,end:o}=Xce(r,e);return Uc(a,YM(e,i,o,t,n))}else return Uc(a,hg(e,t,n))}function XM(e,t){if(!t.type.compatibleContent(e.type))throw new dg("Cannot join "+t.type.name+" onto "+e.type.name)}function H_(e,t,r){let n=e.node(r);return XM(n,t.node(r)),n}function Bc(e,t){let r=t.length-1;r>=0&&e.isText&&e.sameMarkup(t[r])?t[r]=e.withText(t[r].text+e.text):t.push(e)}function Xh(e,t,r,n){let s=(t||e).node(r),a=0,i=t?t.index(r):s.childCount;e&&(a=e.index(r),e.depth>r?a++:e.textOffset&&(Bc(e.nodeAfter,n),a++));for(let o=a;o<i;o++)Bc(s.child(o),n);t&&t.depth==r&&t.textOffset&&Bc(t.nodeBefore,n)}function Uc(e,t){return e.type.checkContent(t),e.copy(t)}function YM(e,t,r,n,s){let a=e.depth>s&&H_(e,t,s+1),i=n.depth>s&&H_(r,n,s+1),o=[];return Xh(null,e,s,o),a&&i&&t.index(s)==r.index(s)?(XM(a,i),Bc(Uc(a,YM(e,t,r,n,s+1)),o)):(a&&Bc(Uc(a,hg(e,t,s+1)),o),Xh(t,r,s,o),i&&Bc(Uc(i,hg(r,n,s+1)),o)),Xh(n,null,s,o),new Ke(o)}function hg(e,t,r){let n=[];if(Xh(null,e,r,n),e.depth>r){let s=H_(e,t,r+1);Bc(Uc(s,hg(e,t,r+1)),n)}return Xh(t,null,r,n),new Ke(n)}function Xce(e,t){let r=t.depth-e.openStart,s=t.node(r).copy(e.content);for(let a=r-1;a>=0;a--)s=t.node(a).copy(Ke.from(s));return{start:s.resolveNoCache(e.openStart+r),end:s.resolveNoCache(s.content.size-e.openEnd-r)}}class T0{constructor(t,r,n){this.pos=t,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,r=this.index(this.depth);if(r==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],s=t.child(r);return n?t.child(r).cut(n):s}get nodeBefore(){let t=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(t).cut(0,r):t==0?null:this.parent.child(t-1)}posAtIndex(t,r){r=this.resolveDepth(r);let n=this.path[r*3],s=r==0?0:this.path[r*3-1]+1;for(let a=0;a<t;a++)s+=n.child(a).nodeSize;return s}marks(){let t=this.parent,r=this.index();if(t.content.size==0)return mr.none;if(this.textOffset)return t.child(r).marks;let n=t.maybeChild(r-1),s=t.maybeChild(r);if(!n){let o=n;n=s,s=o}let a=n.marks;for(var i=0;i<a.length;i++)a[i].type.spec.inclusive===!1&&(!s||!a[i].isInSet(s.marks))&&(a=a[i--].removeFromSet(a));return a}marksAcross(t){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,s=t.parent.maybeChild(t.index());for(var a=0;a<n.length;a++)n[a].type.spec.inclusive===!1&&(!s||!n[a].isInSet(s.marks))&&(n=n[a--].removeFromSet(n));return n}sharedDepth(t){for(let r=this.depth;r>0;r--)if(this.start(r)<=t&&this.end(r)>=t)return r;return 0}blockRange(t=this,r){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!r||r(this.node(n))))return new pg(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let r=1;r<=this.depth;r++)t+=(t?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return t+":"+this.parentOffset}static resolve(t,r){if(!(r>=0&&r<=t.content.size))throw new RangeError("Position "+r+" out of range");let n=[],s=0,a=r;for(let i=t;;){let{index:o,offset:c}=i.content.findIndex(a),f=a-c;if(n.push(i,o,s+c),!f||(i=i.child(o),i.isText))break;a=f-1,s+=c+1}return new T0(r,n,a)}static resolveCached(t,r){let n=z5.get(t);if(n)for(let a=0;a<n.elts.length;a++){let i=n.elts[a];if(i.pos==r)return i}else z5.set(t,n=new Yce);let s=n.elts[n.i]=T0.resolve(t,r);return n.i=(n.i+1)%Jce,s}}class Yce{constructor(){this.elts=[],this.i=0}}const Jce=12,z5=new WeakMap;class pg{constructor(t,r,n){this.$from=t,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Zce=Object.create(null);class oi{constructor(t,r,n,s=mr.none){this.type=t,this.attrs=r,this.marks=s,this.content=n||Ke.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,r,n,s=0){this.content.nodesBetween(t,r,n,s,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,r,n,s){return this.content.textBetween(t,r,n,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,r,n){return this.type==t&&fg(this.attrs,r||t.defaultAttrs||Zce)&&mr.sameSet(this.marks,n||mr.none)}copy(t=null){return t==this.content?this:new oi(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new oi(this.type,this.attrs,this.content,t)}cut(t,r=this.content.size){return t==0&&r==this.content.size?this:this.copy(this.content.cut(t,r))}slice(t,r=this.content.size,n=!1){if(t==r)return it.empty;let s=this.resolve(t),a=this.resolve(r),i=n?0:s.sharedDepth(r),o=s.start(i),f=s.node(i).content.cut(s.pos-o,a.pos-o);return new it(f,s.depth-i,a.depth-i)}replace(t,r,n){return Kce(this.resolve(t),this.resolve(r),n)}nodeAt(t){for(let r=this;;){let{index:n,offset:s}=r.content.findIndex(t);if(r=r.maybeChild(n),!r)return null;if(s==t||r.isText)return r;t-=s+1}}childAfter(t){let{index:r,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(r),index:r,offset:n};let s=this.content.child(r-1);return{node:s,index:r-1,offset:n-s.nodeSize}}resolve(t){return T0.resolveCached(this,t)}resolveNoCache(t){return T0.resolve(this,t)}rangeHasMark(t,r,n){let s=!1;return r>t&&this.nodesBetween(t,r,a=>(n.isInSet(a.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),JM(this.marks,t)}contentMatchAt(t){let r=this.type.contentMatch.matchFragment(this.content,0,t);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(t,r,n=Ke.empty,s=0,a=n.childCount){let i=this.contentMatchAt(t).matchFragment(n,s,a),o=i&&i.matchFragment(this.content,r);if(!o||!o.validEnd)return!1;for(let c=s;c<a;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0}canReplaceWith(t,r,n,s){if(s&&!this.type.allowsMarks(s))return!1;let a=this.contentMatchAt(t).matchType(n),i=a&&a.matchFragment(this.content,r);return i?i.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=mr.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!mr.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let t={type:this.type.name};for(let r in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(r=>r.toJSON())),t}static fromJSON(t,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(t.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(r.text,n)}let s=Ke.fromJSON(t,r.content),a=t.nodeType(r.type).create(r.attrs,s,n);return a.type.checkAttrs(a.attrs),a}}oi.prototype.text=void 0;class mg extends oi{constructor(t,r,n,s){if(super(t,r,null,s),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):JM(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,r){return this.text.slice(t,r)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new mg(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new mg(this.type,this.attrs,t,this.marks)}cut(t=0,r=this.text.length){return t==0&&r==this.text.length?this:this.withText(this.text.slice(t,r))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function JM(e,t){for(let r=e.length-1;r>=0;r--)t=e[r].type.name+"("+t+")";return t}class ru{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,r){let n=new Qce(t,r);if(n.next==null)return ru.empty;let s=ZM(n);n.next&&n.err("Unexpected trailing text");let a=iue(aue(s));return oue(a,n),a}matchType(t){for(let r=0;r<this.next.length;r++)if(this.next[r].type==t)return this.next[r].next;return null}matchFragment(t,r=0,n=t.childCount){let s=this;for(let a=r;s&&a<n;a++)s=s.matchType(t.child(a).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:r}=this.next[t];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(t){for(let r=0;r<this.next.length;r++)for(let n=0;n<t.next.length;n++)if(this.next[r].type==t.next[n].type)return!0;return!1}fillBefore(t,r=!1,n=0){let s=[this];function a(i,o){let c=i.matchFragment(t,n);if(c&&(!r||c.validEnd))return Ke.from(o.map(f=>f.createAndFill()));for(let f=0;f<i.next.length;f++){let{type:h,next:p}=i.next[f];if(!(h.isText||h.hasRequiredAttrs())&&s.indexOf(p)==-1){s.push(p);let x=a(p,o.concat(h));if(x)return x}}return null}return a(this,[])}findWrapping(t){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];let r=this.computeWrapping(t);return this.wrapCache.push(t,r),r}computeWrapping(t){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let s=n.shift(),a=s.match;if(a.matchType(t)){let i=[];for(let o=s;o.type;o=o.via)i.push(o.type);return i.reverse()}for(let i=0;i<a.next.length;i++){let{type:o,next:c}=a.next[i];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in r)&&(!s.type||c.validEnd)&&(n.push({match:o.contentMatch,type:o,via:s}),r[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function r(n){t.push(n);for(let s=0;s<n.next.length;s++)t.indexOf(n.next[s].next)==-1&&r(n.next[s].next)}return r(this),t.map((n,s)=>{let a=s+(n.validEnd?"*":" ")+" ";for(let i=0;i<n.next.length;i++)a+=(i?", ":"")+n.next[i].type.name+"->"+t.indexOf(n.next[i].next);return a}).join(`
`)}}ru.empty=new ru(!0);class Qce{constructor(t,r){this.string=t,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function ZM(e){let t=[];do t.push(eue(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function eue(e){let t=[];do t.push(tue(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function tue(e){let t=sue(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=rue(e,t);else break;return t}function H5(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function rue(e,t){let r=H5(e),n=r;return e.eat(",")&&(e.next!="}"?n=H5(e):n=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:t}}function nue(e,t){let r=e.nodeTypes,n=r[t];if(n)return[n];let s=[];for(let a in r){let i=r[a];i.isInGroup(t)&&s.push(i)}return s.length==0&&e.err("No node type or group '"+t+"' found"),s}function sue(e){if(e.eat("(")){let t=ZM(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=nue(e,e.next).map(r=>(e.inline==null?e.inline=r.isInline:e.inline!=r.isInline&&e.err("Mixing inline and block content"),{type:"name",value:r}));return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function aue(e){let t=[[]];return s(a(e,0),r()),t;function r(){return t.push([])-1}function n(i,o,c){let f={term:c,to:o};return t[i].push(f),f}function s(i,o){i.forEach(c=>c.to=o)}function a(i,o){if(i.type=="choice")return i.exprs.reduce((c,f)=>c.concat(a(f,o)),[]);if(i.type=="seq")for(let c=0;;c++){let f=a(i.exprs[c],o);if(c==i.exprs.length-1)return f;s(f,o=r())}else if(i.type=="star"){let c=r();return n(o,c),s(a(i.expr,c),c),[n(c)]}else if(i.type=="plus"){let c=r();return s(a(i.expr,o),c),s(a(i.expr,c),c),[n(c)]}else{if(i.type=="opt")return[n(o)].concat(a(i.expr,o));if(i.type=="range"){let c=o;for(let f=0;f<i.min;f++){let h=r();s(a(i.expr,c),h),c=h}if(i.max==-1)s(a(i.expr,c),c);else for(let f=i.min;f<i.max;f++){let h=r();n(c,h),s(a(i.expr,c),h),c=h}return[n(c)]}else{if(i.type=="name")return[n(o,void 0,i.value)];throw new Error("Unknown expr type")}}}}function QM(e,t){return t-e}function V5(e,t){let r=[];return n(t),r.sort(QM);function n(s){let a=e[s];if(a.length==1&&!a[0].term)return n(a[0].to);r.push(s);for(let i=0;i<a.length;i++){let{term:o,to:c}=a[i];!o&&r.indexOf(c)==-1&&n(c)}}}function iue(e){let t=Object.create(null);return r(V5(e,0));function r(n){let s=[];n.forEach(i=>{e[i].forEach(({term:o,to:c})=>{if(!o)return;let f;for(let h=0;h<s.length;h++)s[h][0]==o&&(f=s[h][1]);V5(e,c).forEach(h=>{f||s.push([o,f=[]]),f.indexOf(h)==-1&&f.push(h)})})});let a=t[n.join(",")]=new ru(n.indexOf(e.length-1)>-1);for(let i=0;i<s.length;i++){let o=s[i][1].sort(QM);a.next.push({type:s[i][0],next:t[o.join(",")]||r(o)})}return a}}function oue(e,t){for(let r=0,n=[e];r<n.length;r++){let s=n[r],a=!s.validEnd,i=[];for(let o=0;o<s.next.length;o++){let{type:c,next:f}=s.next[o];i.push(c.name),a&&!(c.isText||c.hasRequiredAttrs())&&(a=!1),n.indexOf(f)==-1&&n.push(f)}a&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function eF(e){let t=Object.create(null);for(let r in e){let n=e[r];if(!n.hasDefault)return null;t[r]=n.default}return t}function tF(e,t){let r=Object.create(null);for(let n in e){let s=t&&t[n];if(s===void 0){let a=e[n];if(a.hasDefault)s=a.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=s}return r}function rF(e,t,r,n){for(let s in t)if(!(s in e))throw new RangeError(`Unsupported attribute ${s} for ${r} of type ${s}`);for(let s in e){let a=e[s];a.validate&&a.validate(t[s])}}function nF(e,t){let r=Object.create(null);if(t)for(let n in t)r[n]=new cue(e,n,t[n]);return r}let q5=class sF{constructor(t,r,n){this.name=t,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=nF(t,n.attrs),this.defaultAttrs=eF(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ru.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:tF(this.attrs,t)}create(t=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new oi(this,this.computeAttrs(t),Ke.from(r),mr.setFrom(n))}createChecked(t=null,r,n){return r=Ke.from(r),this.checkContent(r),new oi(this,this.computeAttrs(t),r,mr.setFrom(n))}createAndFill(t=null,r,n){if(t=this.computeAttrs(t),r=Ke.from(r),r.size){let i=this.contentMatch.fillBefore(r);if(!i)return null;r=i.append(r)}let s=this.contentMatch.matchFragment(r),a=s&&s.fillBefore(Ke.empty,!0);return a?new oi(this,t,r.append(a),mr.setFrom(n)):null}validContent(t){let r=this.contentMatch.matchFragment(t);if(!r||!r.validEnd)return!1;for(let n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){rF(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let r=0;r<t.length;r++)if(!this.allowsMarkType(t[r].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let r;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?r&&r.push(t[n]):r||(r=t.slice(0,n));return r?r.length?r:mr.none:t}static compile(t,r){let n=Object.create(null);t.forEach((a,i)=>n[a]=new sF(a,r,i));let s=r.spec.topNode||"doc";if(!n[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let a in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function lue(e,t,r){let n=r.split("|");return s=>{let a=s===null?"null":typeof s;if(n.indexOf(a)<0)throw new RangeError(`Expected value of type ${n} for attribute ${t} on type ${e}, got ${a}`)}}class cue{constructor(t,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?lue(t,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class I1{constructor(t,r,n,s){this.name=t,this.rank=r,this.schema=n,this.spec=s,this.attrs=nF(t,s.attrs),this.excluded=null;let a=eF(this.attrs);this.instance=a?new mr(this,a):null}create(t=null){return!t&&this.instance?this.instance:new mr(this,tF(this.attrs,t))}static compile(t,r){let n=Object.create(null),s=0;return t.forEach((a,i)=>n[a]=new I1(a,s++,r,i)),n}removeFromSet(t){for(var r=0;r<t.length;r++)t[r].type==this&&(t=t.slice(0,r).concat(t.slice(r+1)),r--);return t}isInSet(t){for(let r=0;r<t.length;r++)if(t[r].type==this)return t[r]}checkAttrs(t){rF(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class aF{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let s in t)r[s]=t[s];r.nodes=Vn.from(t.nodes),r.marks=Vn.from(t.marks||{}),this.nodes=q5.compile(this.spec.nodes,this),this.marks=I1.compile(this.spec.marks,this);let n=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let a=this.nodes[s],i=a.spec.content||"",o=a.spec.marks;if(a.contentMatch=n[i]||(n[i]=ru.parse(i,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=o=="_"?null:o?W5(this,o.split(" ")):o==""||!a.inlineContent?[]:null}for(let s in this.marks){let a=this.marks[s],i=a.spec.excludes;a.excluded=i==null?[a]:i==""?[]:W5(this,i.split(" "))}this.nodeFromJSON=s=>oi.fromJSON(this,s),this.markFromJSON=s=>mr.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,r=null,n,s){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof q5){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(r,n,s)}text(t,r){let n=this.nodes.text;return new mg(n,n.defaultAttrs,t,mr.setFrom(r))}mark(t,r){return typeof t=="string"&&(t=this.marks[t]),t.create(r)}nodeType(t){let r=this.nodes[t];if(!r)throw new RangeError("Unknown node type: "+t);return r}}function W5(e,t){let r=[];for(let n=0;n<t.length;n++){let s=t[n],a=e.marks[s],i=a;if(a)r.push(a);else for(let o in e.marks){let c=e.marks[o];(s=="_"||c.spec.group&&c.spec.group.split(" ").indexOf(s)>-1)&&r.push(i=c)}if(!i)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return r}function uue(e){return e.tag!=null}function fue(e){return e.style!=null}class Dl{constructor(t,r){this.schema=t,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(s=>{if(uue(s))this.tags.push(s);else if(fue(s)){let a=/[^=]*/.exec(s.style)[0];n.indexOf(a)<0&&n.push(a),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let a=t.nodes[s.node];return a.contentMatch.matchType(a)})}parse(t,r={}){let n=new G5(this,r,!1);return n.addAll(t,mr.none,r.from,r.to),n.finish()}parseSlice(t,r={}){let n=new G5(this,r,!0);return n.addAll(t,mr.none,r.from,r.to),it.maxOpen(n.finish())}matchTag(t,r,n){for(let s=n?this.tags.indexOf(n)+1:0;s<this.tags.length;s++){let a=this.tags[s];if(pue(t,a.tag)&&(a.namespace===void 0||t.namespaceURI==a.namespace)&&(!a.context||r.matchesContext(a.context))){if(a.getAttrs){let i=a.getAttrs(t);if(i===!1)continue;a.attrs=i||void 0}return a}}}matchStyle(t,r,n,s){for(let a=s?this.styles.indexOf(s)+1:0;a<this.styles.length;a++){let i=this.styles[a],o=i.style;if(!(o.indexOf(t)!=0||i.context&&!n.matchesContext(i.context)||o.length>t.length&&(o.charCodeAt(t.length)!=61||o.slice(t.length+1)!=r))){if(i.getAttrs){let c=i.getAttrs(r);if(c===!1)continue;i.attrs=c||void 0}return i}}}static schemaRules(t){let r=[];function n(s){let a=s.priority==null?50:s.priority,i=0;for(;i<r.length;i++){let o=r[i];if((o.priority==null?50:o.priority)<a)break}r.splice(i,0,s)}for(let s in t.marks){let a=t.marks[s].spec.parseDOM;a&&a.forEach(i=>{n(i=K5(i)),i.mark||i.ignore||i.clearMark||(i.mark=s)})}for(let s in t.nodes){let a=t.nodes[s].spec.parseDOM;a&&a.forEach(i=>{n(i=K5(i)),i.node||i.ignore||i.mark||(i.node=s)})}return r}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new Dl(t,Dl.schemaRules(t)))}}const iF={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},due={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},oF={ol:!0,ul:!0},k0=1,V_=2,Yh=4;function $5(e,t,r){return t!=null?(t?k0:0)|(t==="full"?V_:0):e&&e.whitespace=="pre"?k0|V_:r&~Yh}class Zm{constructor(t,r,n,s,a,i){this.type=t,this.attrs=r,this.marks=n,this.solid=s,this.options=i,this.content=[],this.activeMarks=mr.none,this.match=a||(i&Yh?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Ke.from(t));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,s;return(s=n.findWrapping(t.type))?(this.match=n,s):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&k0)){let n=this.content[this.content.length-1],s;if(n&&n.isText&&(s=/[ \t\r\n\u000c]+$/.exec(n.text))){let a=n;n.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-s[0].length))}}let r=Ke.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(Ke.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!iF.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class G5{constructor(t,r,n){this.parser=t,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let s=r.topNode,a,i=$5(null,r.preserveWhitespace,0)|(n?Yh:0);s?a=new Zm(s.type,s.attrs,mr.none,!0,r.topMatch||s.type.contentMatch,i):n?a=new Zm(null,null,mr.none,!0,null,i):a=new Zm(t.schema.topNodeType,null,mr.none,!0,null,i),this.nodes=[a],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,r){t.nodeType==3?this.addTextNode(t,r):t.nodeType==1&&this.addElement(t,r)}addTextNode(t,r){let n=t.nodeValue,s=this.top,a=s.options&V_?"full":this.localPreserveWS||(s.options&k0)>0,{schema:i}=this.parser;if(a==="full"||s.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(a)if(a==="full")n=n.replace(/\r\n?/g,`
`);else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){let o=n.split(/\r?\n|\r/);for(let c=0;c<o.length;c++)c&&this.insertNode(i.linebreakReplacement.create(),r,!0),o[c]&&this.insertNode(i.text(o[c]),r,!/\S/.test(o[c]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let o=s.content[s.content.length-1],c=t.previousSibling;(!o||c&&c.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),r,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,r,n){let s=this.localPreserveWS,a=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let i=t.nodeName.toLowerCase(),o;oF.hasOwnProperty(i)&&this.parser.normalizeLists&&hue(t);let c=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(o=this.parser.matchTag(t,this,n));e:if(c?c.ignore:due.hasOwnProperty(i))this.findInside(t),this.ignoreFallback(t,r);else if(!c||c.skip||c.closeParent){c&&c.closeParent?this.open=Math.max(0,this.open-1):c&&c.skip.nodeType&&(t=c.skip);let f,h=this.needsBlock;if(iF.hasOwnProperty(i))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),f=!0,a.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,r);break e}let p=c&&c.skip?r:this.readStyles(t,r);p&&this.addAll(t,p),f&&this.sync(a),this.needsBlock=h}else{let f=this.readStyles(t,r);f&&this.addElementByRule(t,c,f,c.consuming===!1?o:void 0)}this.localPreserveWS=s}leafFallback(t,r){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),r)}ignoreFallback(t,r){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(t,r){let n=t.style;if(n&&n.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let a=this.parser.matchedStyles[s],i=n.getPropertyValue(a);if(i)for(let o=void 0;;){let c=this.parser.matchStyle(a,i,this,o);if(!c)break;if(c.ignore)return null;if(c.clearMark?r=r.filter(f=>!c.clearMark(f)):r=r.concat(this.parser.schema.marks[c.mark].create(c.attrs)),c.consuming===!1)o=c;else break}}return r}addElementByRule(t,r,n,s){let a,i;if(r.node)if(i=this.parser.schema.nodes[r.node],i.isLeaf)this.insertNode(i.create(r.attrs),n,t.nodeName=="BR")||this.leafFallback(t,n);else{let c=this.enter(i,r.attrs||null,n,r.preserveWhitespace);c&&(a=!0,n=c)}else{let c=this.parser.schema.marks[r.mark];n=n.concat(c.create(r.attrs))}let o=this.top;if(i&&i.isLeaf)this.findInside(t);else if(s)this.addElement(t,n,s);else if(r.getContent)this.findInside(t),r.getContent(t,this.parser.schema).forEach(c=>this.insertNode(c,n,!1));else{let c=t;typeof r.contentElement=="string"?c=t.querySelector(r.contentElement):typeof r.contentElement=="function"?c=r.contentElement(t):r.contentElement&&(c=r.contentElement),this.findAround(t,c,!0),this.addAll(c,n),this.findAround(t,c,!1)}a&&this.sync(o)&&this.open--}addAll(t,r,n,s){let a=n||0;for(let i=n?t.childNodes[n]:t.firstChild,o=s==null?null:t.childNodes[s];i!=o;i=i.nextSibling,++a)this.findAtPoint(t,a),this.addDOM(i,r);this.findAtPoint(t,a)}findPlace(t,r,n){let s,a;for(let i=this.open,o=0;i>=0;i--){let c=this.nodes[i],f=c.findWrapping(t);if(f&&(!s||s.length>f.length+o)&&(s=f,a=c,!f.length))break;if(c.solid){if(n)break;o+=2}}if(!s)return null;this.sync(a);for(let i=0;i<s.length;i++)r=this.enterInner(s[i],null,r,!1);return r}insertNode(t,r,n){if(t.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(r=this.enterInner(a,null,r))}let s=this.findPlace(t,r,n);if(s){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(t.type));let i=mr.none;for(let o of s.concat(t.marks))(a.type?a.type.allowsMarkType(o.type):X5(o.type,t.type))&&(i=o.addToSet(i));return a.content.push(t.mark(i)),!0}return!1}enter(t,r,n,s){let a=this.findPlace(t.create(r),n,!1);return a&&(a=this.enterInner(t,r,n,!0,s)),a}enterInner(t,r,n,s=!1,a){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(t);let o=$5(t,a,i.options);i.options&Yh&&i.content.length==0&&(o|=Yh);let c=mr.none;return n=n.filter(f=>(i.type?i.type.allowsMarkType(f.type):X5(f.type,t))?(c=f.addToSet(c),!1):!0),this.nodes.push(new Zm(t,r,c,s,null,o)),this.open++,n}closeExtra(t=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let r=this.open;r>=0;r--){if(this.nodes[r]==t)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=k0)}return!1}get currentPos(){this.closeExtra();let t=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let s=n.length-1;s>=0;s--)t+=n[s].nodeSize;r&&t++}return t}findAtPoint(t,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&t.nodeType==1&&t.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(t,r,n){if(t!=r&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&t.nodeType==1&&t.contains(this.find[s].node)&&r.compareDocumentPosition(this.find[s].node)&(n?2:4)&&(this.find[s].pos=this.currentPos)}findInText(t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&(this.find[r].pos=this.currentPos-(t.nodeValue.length-this.find[r].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let r=t.split("/"),n=this.options.context,s=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),a=-(n?n.depth+1:0)+(s?0:1),i=(o,c)=>{for(;o>=0;o--){let f=r[o];if(f==""){if(o==r.length-1||o==0)continue;for(;c>=a;c--)if(i(o-1,c))return!0;return!1}else{let h=c>0||c==0&&s?this.nodes[c].type:n&&c>=a?n.node(c-a).type:null;if(!h||h.name!=f&&!h.isInGroup(f))return!1;c--}}return!0};return i(r.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let r=t.depth;r>=0;r--){let n=t.node(r).contentMatchAt(t.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function hue(e){for(let t=e.firstChild,r=null;t;t=t.nextSibling){let n=t.nodeType==1?t.nodeName.toLowerCase():null;n&&oF.hasOwnProperty(n)&&r?(r.appendChild(t),t=r):n=="li"?r=t:n&&(r=null)}}function pue(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function K5(e){let t={};for(let r in e)t[r]=e[r];return t}function X5(e,t){let r=t.schema.nodes;for(let n in r){let s=r[n];if(!s.allowsMarkType(e))continue;let a=[],i=o=>{a.push(o);for(let c=0;c<o.edgeCount;c++){let{type:f,next:h}=o.edge(c);if(f==t||a.indexOf(h)<0&&i(h))return!0}};if(i(s.contentMatch))return!0}}class xu{constructor(t,r){this.nodes=t,this.marks=r}serializeFragment(t,r={},n){n||(n=Wb(r).createDocumentFragment());let s=n,a=[];return t.forEach(i=>{if(a.length||i.marks.length){let o=0,c=0;for(;o<a.length&&c<i.marks.length;){let f=i.marks[c];if(!this.marks[f.type.name]){c++;continue}if(!f.eq(a[o][0])||f.type.spec.spanning===!1)break;o++,c++}for(;o<a.length;)s=a.pop()[1];for(;c<i.marks.length;){let f=i.marks[c++],h=this.serializeMark(f,i.isInline,r);h&&(a.push([f,s]),s.appendChild(h.dom),s=h.contentDOM||h.dom)}}s.appendChild(this.serializeNodeInner(i,r))}),n}serializeNodeInner(t,r){let{dom:n,contentDOM:s}=Dx(Wb(r),this.nodes[t.type.name](t),null,t.attrs);if(s){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,r,s)}return n}serializeNode(t,r={}){let n=this.serializeNodeInner(t,r);for(let s=t.marks.length-1;s>=0;s--){let a=this.serializeMark(t.marks[s],t.isInline,r);a&&((a.contentDOM||a.dom).appendChild(n),n=a.dom)}return n}serializeMark(t,r,n={}){let s=this.marks[t.type.name];return s&&Dx(Wb(n),s(t,r),null,t.attrs)}static renderSpec(t,r,n=null,s){return Dx(t,r,n,s)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new xu(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let r=Y5(t.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(t){return Y5(t.marks)}}function Y5(e){let t={};for(let r in e){let n=e[r].spec.toDOM;n&&(t[r]=n)}return t}function Wb(e){return e.document||window.document}const J5=new WeakMap;function mue(e){let t=J5.get(e);return t===void 0&&J5.set(e,t=xue(e)),t}function xue(e){let t=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")t||(t=[]),t.push(n);else for(let s=0;s<n.length;s++)r(n[s]);else for(let s in n)r(n[s])}return r(e),t}function Dx(e,t,r,n){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let s=t[0],a;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(a=mue(n))&&a.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let i=s.indexOf(" ");i>0&&(r=s.slice(0,i),s=s.slice(i+1));let o,c=r?e.createElementNS(r,s):e.createElement(s),f=t[1],h=1;if(f&&typeof f=="object"&&f.nodeType==null&&!Array.isArray(f)){h=2;for(let p in f)if(f[p]!=null){let x=p.indexOf(" ");x>0?c.setAttributeNS(p.slice(0,x),p.slice(x+1),f[p]):p=="style"&&c.style?c.style.cssText=f[p]:c.setAttribute(p,f[p])}}for(let p=h;p<t.length;p++){let x=t[p];if(x===0){if(p<t.length-1||p>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}else{let{dom:g,contentDOM:v}=Dx(e,x,r,n);if(c.appendChild(g),v){if(o)throw new RangeError("Multiple content holes");o=v}}}return{dom:c,contentDOM:o}}const lF=65535,cF=Math.pow(2,16);function gue(e,t){return e+t*cF}function Z5(e){return e&lF}function yue(e){return(e-(e&lF))/cF}const uF=1,fF=2,Ix=4,dF=8;class q_{constructor(t,r,n){this.pos=t,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&dF)>0}get deletedBefore(){return(this.delInfo&(uF|Ix))>0}get deletedAfter(){return(this.delInfo&(fF|Ix))>0}get deletedAcross(){return(this.delInfo&Ix)>0}}class aa{constructor(t,r=!1){if(this.ranges=t,this.inverted=r,!t.length&&aa.empty)return aa.empty}recover(t){let r=0,n=Z5(t);if(!this.inverted)for(let s=0;s<n;s++)r+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[n*3]+r+yue(t)}mapResult(t,r=1){return this._map(t,r,!1)}map(t,r=1){return this._map(t,r,!0)}_map(t,r,n){let s=0,a=this.inverted?2:1,i=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let c=this.ranges[o]-(this.inverted?s:0);if(c>t)break;let f=this.ranges[o+a],h=this.ranges[o+i],p=c+f;if(t<=p){let x=f?t==c?-1:t==p?1:r:r,g=c+s+(x<0?0:h);if(n)return g;let v=t==(r<0?c:p)?null:gue(o/3,t-c),y=t==c?fF:t==p?uF:Ix;return(r<0?t!=c:t!=p)&&(y|=dF),new q_(g,y,v)}s+=h-f}return n?t+s:new q_(t+s,0,null)}touches(t,r){let n=0,s=Z5(r),a=this.inverted?2:1,i=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let c=this.ranges[o]-(this.inverted?n:0);if(c>t)break;let f=this.ranges[o+a],h=c+f;if(t<=h&&o==s*3)return!0;n+=this.ranges[o+i]-f}return!1}forEach(t){let r=this.inverted?2:1,n=this.inverted?1:2;for(let s=0,a=0;s<this.ranges.length;s+=3){let i=this.ranges[s],o=i-(this.inverted?a:0),c=i+(this.inverted?0:a),f=this.ranges[s+r],h=this.ranges[s+n];t(o,o+f,c,c+h),a+=h-f}}invert(){return new aa(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?aa.empty:new aa(t<0?[0,-t,0]:[0,0,t])}}aa.empty=new aa([]);class A0{constructor(t,r,n=0,s=t?t.length:0){this.mirror=r,this.from=n,this.to=s,this._maps=t||[],this.ownData=!(t||r)}get maps(){return this._maps}slice(t=0,r=this.maps.length){return new A0(this._maps,this.mirror,t,r)}appendMap(t,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(t){for(let r=0,n=this._maps.length;r<t._maps.length;r++){let s=t.getMirror(r);this.appendMap(t._maps[r],s!=null&&s<r?n+s:void 0)}}getMirror(t){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==t)return this.mirror[r+(r%2?-1:1)]}}setMirror(t,r){this.mirror||(this.mirror=[]),this.mirror.push(t,r)}appendMappingInverted(t){for(let r=t.maps.length-1,n=this._maps.length+t._maps.length;r>=0;r--){let s=t.getMirror(r);this.appendMap(t._maps[r].invert(),s!=null&&s>r?n-s-1:void 0)}}invert(){let t=new A0;return t.appendMappingInverted(this),t}map(t,r=1){if(this.mirror)return this._map(t,r,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,r);return t}mapResult(t,r=1){return this._map(t,r,!1)}_map(t,r,n){let s=0;for(let a=this.from;a<this.to;a++){let i=this._maps[a],o=i.mapResult(t,r);if(o.recover!=null){let c=this.getMirror(a);if(c!=null&&c>a&&c<this.to){a=c,t=this._maps[c].recover(o.recover);continue}}s|=o.delInfo,t=o.pos}return n?t:new q_(t,s,null)}}const $b=Object.create(null);class ms{getMap(){return aa.empty}merge(t){return null}static fromJSON(t,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=$b[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(t,r)}static jsonID(t,r){if(t in $b)throw new RangeError("Duplicate use of step JSON ID "+t);return $b[t]=r,r.prototype.jsonID=t,r}}class xn{constructor(t,r){this.doc=t,this.failed=r}static ok(t){return new xn(t,null)}static fail(t){return new xn(null,t)}static fromReplace(t,r,n,s){try{return xn.ok(t.replace(r,n,s))}catch(a){if(a instanceof dg)return xn.fail(a.message);throw a}}}function VS(e,t,r){let n=[];for(let s=0;s<e.childCount;s++){let a=e.child(s);a.content.size&&(a=a.copy(VS(a.content,t,a))),a.isInline&&(a=t(a,r,s)),n.push(a)}return Ke.fromArray(n)}class Cl extends ms{constructor(t,r,n){super(),this.from=t,this.to=r,this.mark=n}apply(t){let r=t.slice(this.from,this.to),n=t.resolve(this.from),s=n.node(n.sharedDepth(this.to)),a=new it(VS(r.content,(i,o)=>!i.isAtom||!o.type.allowsMarkType(this.mark.type)?i:i.mark(this.mark.addToSet(i.marks)),s),r.openStart,r.openEnd);return xn.fromReplace(t,this.from,this.to,a)}invert(){return new si(this.from,this.to,this.mark)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Cl(r.pos,n.pos,this.mark)}merge(t){return t instanceof Cl&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Cl(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Cl(r.from,r.to,t.markFromJSON(r.mark))}}ms.jsonID("addMark",Cl);class si extends ms{constructor(t,r,n){super(),this.from=t,this.to=r,this.mark=n}apply(t){let r=t.slice(this.from,this.to),n=new it(VS(r.content,s=>s.mark(this.mark.removeFromSet(s.marks)),t),r.openStart,r.openEnd);return xn.fromReplace(t,this.from,this.to,n)}invert(){return new Cl(this.from,this.to,this.mark)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new si(r.pos,n.pos,this.mark)}merge(t){return t instanceof si&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new si(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new si(r.from,r.to,t.markFromJSON(r.mark))}}ms.jsonID("removeMark",si);class Rl extends ms{constructor(t,r){super(),this.pos=t,this.mark=r}apply(t){let r=t.nodeAt(this.pos);if(!r)return xn.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return xn.fromReplace(t,this.pos,this.pos+1,new it(Ke.from(n),0,r.isLeaf?0:1))}invert(t){let r=t.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let s=0;s<r.marks.length;s++)if(!r.marks[s].isInSet(n))return new Rl(this.pos,r.marks[s]);return new Rl(this.pos,this.mark)}}return new nu(this.pos,this.mark)}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new Rl(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Rl(r.pos,t.markFromJSON(r.mark))}}ms.jsonID("addNodeMark",Rl);class nu extends ms{constructor(t,r){super(),this.pos=t,this.mark=r}apply(t){let r=t.nodeAt(this.pos);if(!r)return xn.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return xn.fromReplace(t,this.pos,this.pos+1,new it(Ke.from(n),0,r.isLeaf?0:1))}invert(t){let r=t.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new Rl(this.pos,this.mark)}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new nu(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new nu(r.pos,t.markFromJSON(r.mark))}}ms.jsonID("removeNodeMark",nu);class On extends ms{constructor(t,r,n,s=!1){super(),this.from=t,this.to=r,this.slice=n,this.structure=s}apply(t){return this.structure&&W_(t,this.from,this.to)?xn.fail("Structure replace would overwrite content"):xn.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new aa([this.from,this.to-this.from,this.slice.size])}invert(t){return new On(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new On(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof On)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let r=this.slice.size+t.slice.size==0?it.empty:new it(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new On(this.from,this.to+(t.to-t.from),r,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let r=this.slice.size+t.slice.size==0?it.empty:new it(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new On(t.from,this.to,r,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new On(r.from,r.to,it.fromJSON(t,r.slice),!!r.structure)}}ms.jsonID("replace",On);class Mn extends ms{constructor(t,r,n,s,a,i,o=!1){super(),this.from=t,this.to=r,this.gapFrom=n,this.gapTo=s,this.slice=a,this.insert=i,this.structure=o}apply(t){if(this.structure&&(W_(t,this.from,this.gapFrom)||W_(t,this.gapTo,this.to)))return xn.fail("Structure gap-replace would overwrite content");let r=t.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return xn.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?xn.fromReplace(t,this.from,this.to,n):xn.fail("Content does not fit in gap")}getMap(){return new aa([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let r=this.gapTo-this.gapFrom;return new Mn(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),s=this.from==this.gapFrom?r.pos:t.map(this.gapFrom,-1),a=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||s<r.pos||a>n.pos?null:new Mn(r.pos,n.pos,s,a,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Mn(r.from,r.to,r.gapFrom,r.gapTo,it.fromJSON(t,r.slice),r.insert,!!r.structure)}}ms.jsonID("replaceAround",Mn);function W_(e,t,r){let n=e.resolve(t),s=r-t,a=n.depth;for(;s>0&&a>0&&n.indexAfter(a)==n.node(a).childCount;)a--,s--;if(s>0){let i=n.node(a).maybeChild(n.indexAfter(a));for(;s>0;){if(!i||i.isLeaf)return!0;i=i.firstChild,s--}}return!1}function vue(e,t,r,n){let s=[],a=[],i,o;e.doc.nodesBetween(t,r,(c,f,h)=>{if(!c.isInline)return;let p=c.marks;if(!n.isInSet(p)&&h.type.allowsMarkType(n.type)){let x=Math.max(f,t),g=Math.min(f+c.nodeSize,r),v=n.addToSet(p);for(let y=0;y<p.length;y++)p[y].isInSet(v)||(i&&i.to==x&&i.mark.eq(p[y])?i.to=g:s.push(i=new si(x,g,p[y])));o&&o.to==x?o.to=g:a.push(o=new Cl(x,g,n))}}),s.forEach(c=>e.step(c)),a.forEach(c=>e.step(c))}function bue(e,t,r,n){let s=[],a=0;e.doc.nodesBetween(t,r,(i,o)=>{if(!i.isInline)return;a++;let c=null;if(n instanceof I1){let f=i.marks,h;for(;h=n.isInSet(f);)(c||(c=[])).push(h),f=h.removeFromSet(f)}else n?n.isInSet(i.marks)&&(c=[n]):c=i.marks;if(c&&c.length){let f=Math.min(o+i.nodeSize,r);for(let h=0;h<c.length;h++){let p=c[h],x;for(let g=0;g<s.length;g++){let v=s[g];v.step==a-1&&p.eq(s[g].style)&&(x=v)}x?(x.to=f,x.step=a):s.push({style:p,from:Math.max(o,t),to:f,step:a})}}}),s.forEach(i=>e.step(new si(i.from,i.to,i.style)))}function qS(e,t,r,n=r.contentMatch,s=!0){let a=e.doc.nodeAt(t),i=[],o=t+1;for(let c=0;c<a.childCount;c++){let f=a.child(c),h=o+f.nodeSize,p=n.matchType(f.type);if(!p)i.push(new On(o,h,it.empty));else{n=p;for(let x=0;x<f.marks.length;x++)r.allowsMarkType(f.marks[x].type)||e.step(new si(o,h,f.marks[x]));if(s&&f.isText&&r.whitespace!="pre"){let x,g=/\r?\n|\r/g,v;for(;x=g.exec(f.text);)v||(v=new it(Ke.from(r.schema.text(" ",r.allowedMarks(f.marks))),0,0)),i.push(new On(o+x.index,o+x.index+x[0].length,v))}}o=h}if(!n.validEnd){let c=n.fillBefore(Ke.empty,!0);e.replace(o,o,new it(c,0,0))}for(let c=i.length-1;c>=0;c--)e.step(i[c])}function wue(e,t,r){return(t==0||e.canReplace(t,e.childCount))&&(r==e.childCount||e.canReplace(0,r))}function yd(e){let r=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,s=0,a=0;;--n){let i=e.$from.node(n),o=e.$from.index(n)+s,c=e.$to.indexAfter(n)-a;if(n<e.depth&&i.canReplace(o,c,r))return n;if(n==0||i.type.spec.isolating||!wue(i,o,c))break;o&&(s=1),c<i.childCount&&(a=1)}return null}function _ue(e,t,r){let{$from:n,$to:s,depth:a}=t,i=n.before(a+1),o=s.after(a+1),c=i,f=o,h=Ke.empty,p=0;for(let v=a,y=!1;v>r;v--)y||n.index(v)>0?(y=!0,h=Ke.from(n.node(v).copy(h)),p++):c--;let x=Ke.empty,g=0;for(let v=a,y=!1;v>r;v--)y||s.after(v+1)<s.end(v)?(y=!0,x=Ke.from(s.node(v).copy(x)),g++):f++;e.step(new Mn(c,f,i,o,new it(h.append(x),p,g),h.size-p,!0))}function WS(e,t,r=null,n=e){let s=Eue(e,t),a=s&&Sue(n,t);return a?s.map(Q5).concat({type:t,attrs:r}).concat(a.map(Q5)):null}function Q5(e){return{type:e,attrs:null}}function Eue(e,t){let{parent:r,startIndex:n,endIndex:s}=e,a=r.contentMatchAt(n).findWrapping(t);if(!a)return null;let i=a.length?a[0]:t;return r.canReplaceWith(n,s,i)?a:null}function Sue(e,t){let{parent:r,startIndex:n,endIndex:s}=e,a=r.child(n),i=t.contentMatch.findWrapping(a.type);if(!i)return null;let c=(i.length?i[i.length-1]:t).contentMatch;for(let f=n;c&&f<s;f++)c=c.matchType(r.child(f).type);return!c||!c.validEnd?null:i}function Nue(e,t,r){let n=Ke.empty;for(let i=r.length-1;i>=0;i--){if(n.size){let o=r[i].type.contentMatch.matchFragment(n);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Ke.from(r[i].type.create(r[i].attrs,n))}let s=t.start,a=t.end;e.step(new Mn(s,a,s,a,new it(n,0,0),r.length,!0))}function Tue(e,t,r,n,s){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=e.steps.length;e.doc.nodesBetween(t,r,(i,o)=>{let c=typeof s=="function"?s(i):s;if(i.isTextblock&&!i.hasMarkup(n,c)&&kue(e.doc,e.mapping.slice(a).map(o),n)){let f=null;if(n.schema.linebreakReplacement){let g=n.whitespace=="pre",v=!!n.contentMatch.matchType(n.schema.linebreakReplacement);g&&!v?f=!1:!g&&v&&(f=!0)}f===!1&&pF(e,i,o,a),qS(e,e.mapping.slice(a).map(o,1),n,void 0,f===null);let h=e.mapping.slice(a),p=h.map(o,1),x=h.map(o+i.nodeSize,1);return e.step(new Mn(p,x,p+1,x-1,new it(Ke.from(n.create(c,null,i.marks)),0,0),1,!0)),f===!0&&hF(e,i,o,a),!1}})}function hF(e,t,r,n){t.forEach((s,a)=>{if(s.isText){let i,o=/\r?\n|\r/g;for(;i=o.exec(s.text);){let c=e.mapping.slice(n).map(r+1+a+i.index);e.replaceWith(c,c+1,t.type.schema.linebreakReplacement.create())}}})}function pF(e,t,r,n){t.forEach((s,a)=>{if(s.type==s.type.schema.linebreakReplacement){let i=e.mapping.slice(n).map(r+1+a);e.replaceWith(i,i+1,t.type.schema.text(`
`))}})}function kue(e,t,r){let n=e.resolve(t),s=n.index();return n.parent.canReplaceWith(s,s+1,r)}function Aue(e,t,r,n,s){let a=e.doc.nodeAt(t);if(!a)throw new RangeError("No node at given position");r||(r=a.type);let i=r.create(n,null,s||a.marks);if(a.isLeaf)return e.replaceWith(t,t+a.nodeSize,i);if(!r.validContent(a.content))throw new RangeError("Invalid content for node type "+r.name);e.step(new Mn(t,t+a.nodeSize,t+1,t+a.nodeSize-1,new it(Ke.from(i),0,0),1,!0))}function Co(e,t,r=1,n){let s=e.resolve(t),a=s.depth-r,i=n&&n[n.length-1]||s.parent;if(a<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!i.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let f=s.depth-1,h=r-2;f>a;f--,h--){let p=s.node(f),x=s.index(f);if(p.type.spec.isolating)return!1;let g=p.content.cutByIndex(x,p.childCount),v=n&&n[h+1];v&&(g=g.replaceChild(0,v.type.create(v.attrs)));let y=n&&n[h]||p;if(!p.canReplace(x+1,p.childCount)||!y.type.validContent(g))return!1}let o=s.indexAfter(a),c=n&&n[0];return s.node(a).canReplaceWith(o,o,c?c.type:s.node(a+1).type)}function Cue(e,t,r=1,n){let s=e.doc.resolve(t),a=Ke.empty,i=Ke.empty;for(let o=s.depth,c=s.depth-r,f=r-1;o>c;o--,f--){a=Ke.from(s.node(o).copy(a));let h=n&&n[f];i=Ke.from(h?h.type.create(h.attrs,i):s.node(o).copy(i))}e.step(new On(t,t,new it(a.append(i),r,r),!0))}function Yl(e,t){let r=e.resolve(t),n=r.index();return mF(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function Rue(e,t){t.content.size||e.type.compatibleContent(t.type);let r=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let s=0;s<t.childCount;s++){let a=t.child(s),i=a.type==n?e.type.schema.nodes.text:a.type;if(r=r.matchType(i),!r||!e.type.allowsMarks(a.marks))return!1}return r.validEnd}function mF(e,t){return!!(e&&t&&!e.isLeaf&&Rue(e,t))}function M1(e,t,r=-1){let n=e.resolve(t);for(let s=n.depth;;s--){let a,i,o=n.index(s);if(s==n.depth?(a=n.nodeBefore,i=n.nodeAfter):r>0?(a=n.node(s+1),o++,i=n.node(s).maybeChild(o)):(a=n.node(s).maybeChild(o-1),i=n.node(s+1)),a&&!a.isTextblock&&mF(a,i)&&n.node(s).canReplace(o,o+1))return t;if(s==0)break;t=r<0?n.before(s):n.after(s)}}function Oue(e,t,r){let n=null,{linebreakReplacement:s}=e.doc.type.schema,a=e.doc.resolve(t-r),i=a.node().type;if(s&&i.inlineContent){let h=i.whitespace=="pre",p=!!i.contentMatch.matchType(s);h&&!p?n=!1:!h&&p&&(n=!0)}let o=e.steps.length;if(n===!1){let h=e.doc.resolve(t+r);pF(e,h.node(),h.before(),o)}i.inlineContent&&qS(e,t+r-1,i,a.node().contentMatchAt(a.index()),n==null);let c=e.mapping.slice(o),f=c.map(t-r);if(e.step(new On(f,c.map(t+r,-1),it.empty,!0)),n===!0){let h=e.doc.resolve(f);hF(e,h.node(),h.before(),e.steps.length)}return e}function jue(e,t,r){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),r))return t;if(n.parentOffset==0)for(let s=n.depth-1;s>=0;s--){let a=n.index(s);if(n.node(s).canReplaceWith(a,a,r))return n.before(s+1);if(a>0)return null}if(n.parentOffset==n.parent.content.size)for(let s=n.depth-1;s>=0;s--){let a=n.indexAfter(s);if(n.node(s).canReplaceWith(a,a,r))return n.after(s+1);if(a<n.node(s).childCount)return null}return null}function xF(e,t,r){let n=e.resolve(t);if(!r.content.size)return t;let s=r.content;for(let a=0;a<r.openStart;a++)s=s.firstChild.content;for(let a=1;a<=(r.openStart==0&&r.size?2:1);a++)for(let i=n.depth;i>=0;i--){let o=i==n.depth?0:n.pos<=(n.start(i+1)+n.end(i+1))/2?-1:1,c=n.index(i)+(o>0?1:0),f=n.node(i),h=!1;if(a==1)h=f.canReplace(c,c,s);else{let p=f.contentMatchAt(c).findWrapping(s.firstChild.type);h=p&&f.canReplaceWith(c,c,p[0])}if(h)return o==0?n.pos:o<0?n.before(i+1):n.after(i+1)}return null}function F1(e,t,r=t,n=it.empty){if(t==r&&!n.size)return null;let s=e.resolve(t),a=e.resolve(r);return gF(s,a,n)?new On(t,r,n):new Due(s,a,n).fit()}function gF(e,t,r){return!r.openStart&&!r.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),r.content)}class Due{constructor(t,r,n){this.$from=t,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=Ke.empty;for(let s=0;s<=t.depth;s++){let a=t.node(s);this.frontier.push({type:a.type,match:a.contentMatchAt(t.indexAfter(s))})}for(let s=t.depth;s>0;s--)this.placed=Ke.from(t.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let f=this.findFittable();f?this.placeNodes(f):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,s=this.close(t<0?this.$to:n.doc.resolve(t));if(!s)return null;let a=this.placed,i=n.depth,o=s.depth;for(;i&&o&&a.childCount==1;)a=a.firstChild.content,i--,o--;let c=new it(a,i,o);return t>-1?new Mn(n.pos,t,this.$to.pos,this.$to.end(),c,r):c.size||n.pos!=this.$to.pos?new On(n.pos,s.pos,c):null}findFittable(){let t=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,s=this.unplaced.openEnd;n<t;n++){let a=r.firstChild;if(r.childCount>1&&(s=0),a.type.spec.isolating&&s<=n){t=n;break}r=a.content}for(let r=1;r<=2;r++)for(let n=r==1?t:this.unplaced.openStart;n>=0;n--){let s,a=null;n?(a=Gb(this.unplaced.content,n-1).firstChild,s=a.content):s=this.unplaced.content;let i=s.firstChild;for(let o=this.depth;o>=0;o--){let{type:c,match:f}=this.frontier[o],h,p=null;if(r==1&&(i?f.matchType(i.type)||(p=f.fillBefore(Ke.from(i),!1)):a&&c.compatibleContent(a.type)))return{sliceDepth:n,frontierDepth:o,parent:a,inject:p};if(r==2&&i&&(h=f.findWrapping(i.type)))return{sliceDepth:n,frontierDepth:o,parent:a,wrap:h};if(a&&f.matchType(a.type))break}}}openMore(){let{content:t,openStart:r,openEnd:n}=this.unplaced,s=Gb(t,r);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new it(t,r+1,Math.max(n,s.size+r>=t.size-n?r+1:0)),!0)}dropNode(){let{content:t,openStart:r,openEnd:n}=this.unplaced,s=Gb(t,r);if(s.childCount<=1&&r>0){let a=t.size-r<=r+s.size;this.unplaced=new it(Dh(t,r-1,1),r-1,a?r-1:n)}else this.unplaced=new it(Dh(t,r,1),r,n)}placeNodes({sliceDepth:t,frontierDepth:r,parent:n,inject:s,wrap:a}){for(;this.depth>r;)this.closeFrontierNode();if(a)for(let y=0;y<a.length;y++)this.openFrontierNode(a[y]);let i=this.unplaced,o=n?n.content:i.content,c=i.openStart-t,f=0,h=[],{match:p,type:x}=this.frontier[r];if(s){for(let y=0;y<s.childCount;y++)h.push(s.child(y));p=p.matchFragment(s)}let g=o.size+t-(i.content.size-i.openEnd);for(;f<o.childCount;){let y=o.child(f),w=p.matchType(y.type);if(!w)break;f++,(f>1||c==0||y.content.size)&&(p=w,h.push(yF(y.mark(x.allowedMarks(y.marks)),f==1?c:0,f==o.childCount?g:-1)))}let v=f==o.childCount;v||(g=-1),this.placed=Ih(this.placed,r,Ke.from(h)),this.frontier[r].match=p,v&&g<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,w=o;y<g;y++){let _=w.lastChild;this.frontier.push({type:_.type,match:_.contentMatchAt(_.childCount)}),w=_.content}this.unplaced=v?t==0?it.empty:new it(Dh(i.content,t-1,1),t-1,g<0?i.openEnd:t-1):new it(Dh(i.content,t,f),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],r;if(!t.type.isTextblock||!Kb(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,s=this.$to.after(n);for(;n>1&&s==this.$to.end(--n);)++s;return s}findCloseLevel(t){e:for(let r=Math.min(this.depth,t.depth);r>=0;r--){let{match:n,type:s}=this.frontier[r],a=r<t.depth&&t.end(r+1)==t.pos+(t.depth-(r+1)),i=Kb(t,r,s,n,a);if(i){for(let o=r-1;o>=0;o--){let{match:c,type:f}=this.frontier[o],h=Kb(t,o,f,c,!0);if(!h||h.childCount)continue e}return{depth:r,fit:i,move:a?t.doc.resolve(t.after(r+1)):t}}}}close(t){let r=this.findCloseLevel(t);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=Ih(this.placed,r.depth,r.fit)),t=r.move;for(let n=r.depth+1;n<=t.depth;n++){let s=t.node(n),a=s.type.contentMatch.fillBefore(s.content,!0,t.index(n));this.openFrontierNode(s.type,s.attrs,a)}return t}openFrontierNode(t,r=null,n){let s=this.frontier[this.depth];s.match=s.match.matchType(t),this.placed=Ih(this.placed,this.depth,Ke.from(t.create(r,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(Ke.empty,!0);r.childCount&&(this.placed=Ih(this.placed,this.frontier.length,r))}}function Dh(e,t,r){return t==0?e.cutByIndex(r,e.childCount):e.replaceChild(0,e.firstChild.copy(Dh(e.firstChild.content,t-1,r)))}function Ih(e,t,r){return t==0?e.append(r):e.replaceChild(e.childCount-1,e.lastChild.copy(Ih(e.lastChild.content,t-1,r)))}function Gb(e,t){for(let r=0;r<t;r++)e=e.firstChild.content;return e}function yF(e,t,r){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,yF(n.firstChild,t-1,n.childCount==1?r-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(Ke.empty,!0)))),e.copy(n)}function Kb(e,t,r,n,s){let a=e.node(t),i=s?e.indexAfter(t):e.index(t);if(i==a.childCount&&!r.compatibleContent(a.type))return null;let o=n.fillBefore(a.content,!0,i);return o&&!Iue(r,a.content,i)?o:null}function Iue(e,t,r){for(let n=r;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}function Mue(e){return e.spec.defining||e.spec.definingForContent}function Fue(e,t,r,n){if(!n.size)return e.deleteRange(t,r);let s=e.doc.resolve(t),a=e.doc.resolve(r);if(gF(s,a,n))return e.step(new On(t,r,n));let i=bF(s,a);i[i.length-1]==0&&i.pop();let o=-(s.depth+1);i.unshift(o);for(let x=s.depth,g=s.pos-1;x>0;x--,g--){let v=s.node(x).type.spec;if(v.defining||v.definingAsContext||v.isolating)break;i.indexOf(x)>-1?o=x:s.before(x)==g&&i.splice(1,0,-x)}let c=i.indexOf(o),f=[],h=n.openStart;for(let x=n.content,g=0;;g++){let v=x.firstChild;if(f.push(v),g==n.openStart)break;x=v.content}for(let x=h-1;x>=0;x--){let g=f[x],v=Mue(g.type);if(v&&!g.sameMarkup(s.node(Math.abs(o)-1)))h=x;else if(v||!g.type.isTextblock)break}for(let x=n.openStart;x>=0;x--){let g=(x+h+1)%(n.openStart+1),v=f[g];if(v)for(let y=0;y<i.length;y++){let w=i[(y+c)%i.length],_=!0;w<0&&(_=!1,w=-w);let S=s.node(w-1),E=s.index(w-1);if(S.canReplaceWith(E,E,v.type,v.marks))return e.replace(s.before(w),_?a.after(w):r,new it(vF(n.content,0,n.openStart,g),g,n.openEnd))}}let p=e.steps.length;for(let x=i.length-1;x>=0&&(e.replace(t,r,n),!(e.steps.length>p));x--){let g=i[x];g<0||(t=s.before(g),r=a.after(g))}}function vF(e,t,r,n,s){if(t<r){let a=e.firstChild;e=e.replaceChild(0,a.copy(vF(a.content,t+1,r,n,a)))}if(t>n){let a=s.contentMatchAt(0),i=a.fillBefore(e).append(e);e=i.append(a.matchFragment(i).fillBefore(Ke.empty,!0))}return e}function Pue(e,t,r,n){if(!n.isInline&&t==r&&e.doc.resolve(t).parent.content.size){let s=jue(e.doc,t,n.type);s!=null&&(t=r=s)}e.replaceRange(t,r,new it(Ke.from(n),0,0))}function Lue(e,t,r){let n=e.doc.resolve(t),s=e.doc.resolve(r),a=bF(n,s);for(let i=0;i<a.length;i++){let o=a[i],c=i==a.length-1;if(c&&o==0||n.node(o).type.contentMatch.validEnd)return e.delete(n.start(o),s.end(o));if(o>0&&(c||n.node(o-1).canReplace(n.index(o-1),s.indexAfter(o-1))))return e.delete(n.before(o),s.after(o))}for(let i=1;i<=n.depth&&i<=s.depth;i++)if(t-n.start(i)==n.depth-i&&r>n.end(i)&&s.end(i)-r!=s.depth-i&&n.start(i-1)==s.start(i-1)&&n.node(i-1).canReplace(n.index(i-1),s.index(i-1)))return e.delete(n.before(i),r);e.delete(t,r)}function bF(e,t){let r=[],n=Math.min(e.depth,t.depth);for(let s=n;s>=0;s--){let a=e.start(s);if(a<e.pos-(e.depth-s)||t.end(s)>t.pos+(t.depth-s)||e.node(s).type.spec.isolating||t.node(s).type.spec.isolating)break;(a==t.start(s)||s==e.depth&&s==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&s&&t.start(s-1)==a-1)&&r.push(s)}return r}class bf extends ms{constructor(t,r,n){super(),this.pos=t,this.attr=r,this.value=n}apply(t){let r=t.nodeAt(this.pos);if(!r)return xn.fail("No node at attribute step's position");let n=Object.create(null);for(let a in r.attrs)n[a]=r.attrs[a];n[this.attr]=this.value;let s=r.type.create(n,null,r.marks);return xn.fromReplace(t,this.pos,this.pos+1,new it(Ke.from(s),0,r.isLeaf?0:1))}getMap(){return aa.empty}invert(t){return new bf(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new bf(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new bf(r.pos,r.attr,r.value)}}ms.jsonID("attr",bf);class C0 extends ms{constructor(t,r){super(),this.attr=t,this.value=r}apply(t){let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let n=t.type.create(r,t.content,t.marks);return xn.ok(n)}getMap(){return aa.empty}invert(t){return new C0(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new C0(r.attr,r.value)}}ms.jsonID("docAttr",C0);let Lf=class extends Error{};Lf=function e(t){let r=Error.call(this,t);return r.__proto__=e.prototype,r};Lf.prototype=Object.create(Error.prototype);Lf.prototype.constructor=Lf;Lf.prototype.name="TransformError";class wF{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new A0}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let r=this.maybeStep(t);if(r.failed)throw new Lf(r.failed);return this}maybeStep(t){let r=t.apply(this.doc);return r.failed||this.addStep(t,r.doc),r}get docChanged(){return this.steps.length>0}changedRange(){let t=1e9,r=-1e9;for(let n=0;n<this.mapping.maps.length;n++){let s=this.mapping.maps[n];n&&(t=s.map(t,1),r=s.map(r,-1)),s.forEach((a,i,o,c)=>{t=Math.min(t,o),r=Math.max(r,c)})}return t==1e9?null:{from:t,to:r}}addStep(t,r){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=r}replace(t,r=t,n=it.empty){let s=F1(this.doc,t,r,n);return s&&this.step(s),this}replaceWith(t,r,n){return this.replace(t,r,new it(Ke.from(n),0,0))}delete(t,r){return this.replace(t,r,it.empty)}insert(t,r){return this.replaceWith(t,t,r)}replaceRange(t,r,n){return Fue(this,t,r,n),this}replaceRangeWith(t,r,n){return Pue(this,t,r,n),this}deleteRange(t,r){return Lue(this,t,r),this}lift(t,r){return _ue(this,t,r),this}join(t,r=1){return Oue(this,t,r),this}wrap(t,r){return Nue(this,t,r),this}setBlockType(t,r=t,n,s=null){return Tue(this,t,r,n,s),this}setNodeMarkup(t,r,n=null,s){return Aue(this,t,r,n,s),this}setNodeAttribute(t,r,n){return this.step(new bf(t,r,n)),this}setDocAttribute(t,r){return this.step(new C0(t,r)),this}addNodeMark(t,r){return this.step(new Rl(t,r)),this}removeNodeMark(t,r){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(r instanceof mr)r.isInSet(n.marks)&&this.step(new nu(t,r));else{let s=n.marks,a,i=[];for(;a=r.isInSet(s);)i.push(new nu(t,a)),s=a.removeFromSet(s);for(let o=i.length-1;o>=0;o--)this.step(i[o])}return this}split(t,r=1,n){return Cue(this,t,r,n),this}addMark(t,r,n){return vue(this,t,r,n),this}removeMark(t,r,n){return bue(this,t,r,n),this}clearIncompatible(t,r,n){return qS(this,t,r,n),this}}const Xb=Object.create(null);class It{constructor(t,r,n){this.$anchor=t,this.$head=r,this.ranges=n||[new Bue(t.min(r),t.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let r=0;r<t.length;r++)if(t[r].$from.pos!=t[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,r=it.empty){let n=r.content.lastChild,s=null;for(let o=0;o<r.openEnd;o++)s=n,n=n.lastChild;let a=t.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:c,$to:f}=i[o],h=t.mapping.slice(a);t.replaceRange(h.map(c.pos),h.map(f.pos),o?it.empty:r),o==0&&rR(t,a,(n?n.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(t,r){let n=t.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:i,$to:o}=s[a],c=t.mapping.slice(n),f=c.map(i.pos),h=c.map(o.pos);a?t.deleteRange(f,h):(t.replaceRangeWith(f,h,r),rR(t,n,r.isInline?-1:1))}}static findFrom(t,r,n=!1){let s=t.parent.inlineContent?new St(t):cf(t.node(0),t.parent,t.pos,t.index(),r,n);if(s)return s;for(let a=t.depth-1;a>=0;a--){let i=r<0?cf(t.node(0),t.node(a),t.before(a+1),t.index(a),r,n):cf(t.node(0),t.node(a),t.after(a+1),t.index(a)+1,r,n);if(i)return i}return null}static near(t,r=1){return this.findFrom(t,r)||this.findFrom(t,-r)||new oa(t.node(0))}static atStart(t){return cf(t,t,0,0,1)||new oa(t)}static atEnd(t){return cf(t,t,t.content.size,t.childCount,-1)||new oa(t)}static fromJSON(t,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Xb[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(t,r)}static jsonID(t,r){if(t in Xb)throw new RangeError("Duplicate use of selection JSON ID "+t);return Xb[t]=r,r.prototype.jsonID=t,r}getBookmark(){return St.between(this.$anchor,this.$head).getBookmark()}}It.prototype.visible=!0;class Bue{constructor(t,r){this.$from=t,this.$to=r}}let eR=!1;function tR(e){!eR&&!e.parent.inlineContent&&(eR=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class St extends It{constructor(t,r=t){tR(t),tR(r),super(t,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,r){let n=t.resolve(r.map(this.head));if(!n.parent.inlineContent)return It.near(n);let s=t.resolve(r.map(this.anchor));return new St(s.parent.inlineContent?s:n,n)}replace(t,r=it.empty){if(super.replace(t,r),r==it.empty){let n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}}eq(t){return t instanceof St&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new P1(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new St(t.resolve(r.anchor),t.resolve(r.head))}static create(t,r,n=r){let s=t.resolve(r);return new this(s,n==r?s:t.resolve(n))}static between(t,r,n){let s=t.pos-r.pos;if((!n||s)&&(n=s>=0?1:-1),!r.parent.inlineContent){let a=It.findFrom(r,n,!0)||It.findFrom(r,-n,!0);if(a)r=a.$head;else return It.near(r,n)}return t.parent.inlineContent||(s==0?t=r:(t=(It.findFrom(t,-n,!0)||It.findFrom(t,n,!0)).$anchor,t.pos<r.pos!=s<0&&(t=r))),new St(t,r)}}It.jsonID("text",St);class P1{constructor(t,r){this.anchor=t,this.head=r}map(t){return new P1(t.map(this.anchor),t.map(this.head))}resolve(t){return St.between(t.resolve(this.anchor),t.resolve(this.head))}}class xt extends It{constructor(t){let r=t.nodeAfter,n=t.node(0).resolve(t.pos+r.nodeSize);super(t,n),this.node=r}map(t,r){let{deleted:n,pos:s}=r.mapResult(this.anchor),a=t.resolve(s);return n?It.near(a):new xt(a)}content(){return new it(Ke.from(this.node),0,0)}eq(t){return t instanceof xt&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new $S(this.anchor)}static fromJSON(t,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new xt(t.resolve(r.anchor))}static create(t,r){return new xt(t.resolve(r))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}xt.prototype.visible=!1;It.jsonID("node",xt);class $S{constructor(t){this.anchor=t}map(t){let{deleted:r,pos:n}=t.mapResult(this.anchor);return r?new P1(n,n):new $S(n)}resolve(t){let r=t.resolve(this.anchor),n=r.nodeAfter;return n&&xt.isSelectable(n)?new xt(r):It.near(r)}}class oa extends It{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,r=it.empty){if(r==it.empty){t.delete(0,t.doc.content.size);let n=It.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else super.replace(t,r)}toJSON(){return{type:"all"}}static fromJSON(t){return new oa(t)}map(t){return new oa(t)}eq(t){return t instanceof oa}getBookmark(){return Uue}}It.jsonID("all",oa);const Uue={map(){return this},resolve(e){return new oa(e)}};function cf(e,t,r,n,s,a=!1){if(t.inlineContent)return St.create(e,r);for(let i=n-(s>0?0:1);s>0?i<t.childCount:i>=0;i+=s){let o=t.child(i);if(o.isAtom){if(!a&&xt.isSelectable(o))return xt.create(e,r-(s<0?o.nodeSize:0))}else{let c=cf(e,o,r+s,s<0?o.childCount:0,s,a);if(c)return c}r+=o.nodeSize*s}return null}function rR(e,t,r){let n=e.steps.length-1;if(n<t)return;let s=e.steps[n];if(!(s instanceof On||s instanceof Mn))return;let a=e.mapping.maps[n],i;a.forEach((o,c,f,h)=>{i==null&&(i=h)}),e.setSelection(It.near(e.doc.resolve(i),r))}const nR=1,Qm=2,sR=4;class zue extends wF{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|nR)&~Qm,this.storedMarks=null,this}get selectionSet(){return(this.updated&nR)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=Qm,this}ensureMarks(t){return mr.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Qm)>0}addStep(t,r){super.addStep(t,r),this.updated=this.updated&~Qm,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,r=!0){let n=this.selection;return r&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||mr.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,r,n){let s=this.doc.type.schema;if(r==null)return t?this.replaceSelectionWith(s.text(t),!0):this.deleteSelection();{if(n==null&&(n=r),!t)return this.deleteRange(r,n);let a=this.storedMarks;if(!a){let i=this.doc.resolve(r);a=n==r?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,s.text(t,a)),!this.selection.empty&&this.selection.to==r+t.length&&this.setSelection(It.near(this.selection.$to)),this}}setMeta(t,r){return this.meta[typeof t=="string"?t:t.key]=r,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=sR,this}get scrolledIntoView(){return(this.updated&sR)>0}}function aR(e,t){return!t||!e?e:e.bind(t)}class Mh{constructor(t,r,n){this.name=t,this.init=aR(r.init,n),this.apply=aR(r.apply,n)}}const Hue=[new Mh("doc",{init(e){return e.doc||e.schema.topNodeType.createAndFill()},apply(e){return e.doc}}),new Mh("selection",{init(e,t){return e.selection||It.atStart(t.doc)},apply(e){return e.selection}}),new Mh("storedMarks",{init(e){return e.storedMarks||null},apply(e,t,r,n){return n.selection.$cursor?e.storedMarks:null}}),new Mh("scrollToSelection",{init(){return 0},apply(e,t){return e.scrolledIntoView?t+1:t}})];class Yb{constructor(t,r){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Hue.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new Mh(n.key,n.spec.state,n))})}}class mf{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let s=this.config.plugins[n];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let r=[t],n=this.applyInner(t),s=null;for(;;){let a=!1;for(let i=0;i<this.config.plugins.length;i++){let o=this.config.plugins[i];if(o.spec.appendTransaction){let c=s?s[i].n:0,f=s?s[i].state:this,h=c<r.length&&o.spec.appendTransaction.call(o,c?r.slice(c):r,f,n);if(h&&n.filterTransaction(h,i)){if(h.setMeta("appendedTransaction",t),!s){s=[];for(let p=0;p<this.config.plugins.length;p++)s.push(p<i?{state:n,n:r.length}:{state:this,n:0})}r.push(h),n=n.applyInner(h),a=!0}s&&(s[i]={state:n,n:r.length})}}if(!a)return{state:n,transactions:r}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new mf(this.config),n=this.config.fields;for(let s=0;s<n.length;s++){let a=n[s];r[a.name]=a.apply(t,this[a.name],this,r)}return r}get tr(){return new zue(this)}static create(t){let r=new Yb(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new mf(r);for(let s=0;s<r.fields.length;s++)n[r.fields[s].name]=r.fields[s].init(t,n);return n}reconfigure(t){let r=new Yb(this.schema,t.plugins),n=r.fields,s=new mf(r);for(let a=0;a<n.length;a++){let i=n[a].name;s[i]=this.hasOwnProperty(i)?this[i]:n[a].init(t,s)}return s}toJSON(t){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),t&&typeof t=="object")for(let n in t){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=t[n],a=s.spec.state;a&&a.toJSON&&(r[n]=a.toJSON.call(s,this[s.key]))}return r}static fromJSON(t,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let s=new Yb(t.schema,t.plugins),a=new mf(s);return s.fields.forEach(i=>{if(i.name=="doc")a.doc=oi.fromJSON(t.schema,r.doc);else if(i.name=="selection")a.selection=It.fromJSON(a.doc,r.selection);else if(i.name=="storedMarks")r.storedMarks&&(a.storedMarks=r.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let o in n){let c=n[o],f=c.spec.state;if(c.key==i.name&&f&&f.fromJSON&&Object.prototype.hasOwnProperty.call(r,o)){a[i.name]=f.fromJSON.call(c,t,r[o],a);return}}a[i.name]=i.init(t,a)}}),a}}function _F(e,t,r){for(let n in e){let s=e[n];s instanceof Function?s=s.bind(t):n=="handleDOMEvents"&&(s=_F(s,t,{})),r[n]=s}return r}class Fr{constructor(t){this.spec=t,this.props={},t.props&&_F(t.props,this,this.props),this.key=t.key?t.key.key:EF("plugin")}getState(t){return t[this.key]}}const Jb=Object.create(null);function EF(e){return e in Jb?e+"$"+ ++Jb[e]:(Jb[e]=0,e+"$")}class Sn{constructor(t="key"){this.key=EF(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const GS=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function SF(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("backward",e):r.parentOffset>0)?null:r}const NF=(e,t,r)=>{let n=SF(e,r);if(!n)return!1;let s=KS(n);if(!s){let i=n.blockRange(),o=i&&yd(i);return o==null?!1:(t&&t(e.tr.lift(i,o).scrollIntoView()),!0)}let a=s.nodeBefore;if(IF(e,s,t,-1))return!0;if(n.parent.content.size==0&&(Bf(a,"end")||xt.isSelectable(a)))for(let i=n.depth;;i--){let o=F1(e.doc,n.before(i),n.after(i),it.empty);if(o&&o.slice.size<o.to-o.from){if(t){let c=e.tr.step(o);c.setSelection(Bf(a,"end")?It.findFrom(c.doc.resolve(c.mapping.map(s.pos,-1)),-1):xt.create(c.doc,s.pos-a.nodeSize)),t(c.scrollIntoView())}return!0}if(i==1||n.node(i-1).childCount>1)break}return a.isAtom&&s.depth==n.depth-1?(t&&t(e.tr.delete(s.pos-a.nodeSize,s.pos).scrollIntoView()),!0):!1},Vue=(e,t,r)=>{let n=SF(e,r);if(!n)return!1;let s=KS(n);return s?TF(e,s,t):!1},que=(e,t,r)=>{let n=AF(e,r);if(!n)return!1;let s=XS(n);return s?TF(e,s,t):!1};function TF(e,t,r){let n=t.nodeBefore,s=n,a=t.pos-1;for(;!s.isTextblock;a--){if(s.type.spec.isolating)return!1;let h=s.lastChild;if(!h)return!1;s=h}let i=t.nodeAfter,o=i,c=t.pos+1;for(;!o.isTextblock;c++){if(o.type.spec.isolating)return!1;let h=o.firstChild;if(!h)return!1;o=h}let f=F1(e.doc,a,c,it.empty);if(!f||f.from!=a||f instanceof On&&f.slice.size>=c-a)return!1;if(r){let h=e.tr.step(f);h.setSelection(St.create(h.doc,a)),r(h.scrollIntoView())}return!0}function Bf(e,t,r=!1){for(let n=e;n;n=t=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const kF=(e,t,r)=>{let{$head:n,empty:s}=e.selection,a=n;if(!s)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",e):n.parentOffset>0)return!1;a=KS(n)}let i=a&&a.nodeBefore;return!i||!xt.isSelectable(i)?!1:(t&&t(e.tr.setSelection(xt.create(e.doc,a.pos-i.nodeSize)).scrollIntoView()),!0)};function KS(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function AF(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)?null:r}const CF=(e,t,r)=>{let n=AF(e,r);if(!n)return!1;let s=XS(n);if(!s)return!1;let a=s.nodeAfter;if(IF(e,s,t,1))return!0;if(n.parent.content.size==0&&(Bf(a,"start")||xt.isSelectable(a))){let i=F1(e.doc,n.before(),n.after(),it.empty);if(i&&i.slice.size<i.to-i.from){if(t){let o=e.tr.step(i);o.setSelection(Bf(a,"start")?It.findFrom(o.doc.resolve(o.mapping.map(s.pos)),1):xt.create(o.doc,o.mapping.map(s.pos))),t(o.scrollIntoView())}return!0}}return a.isAtom&&s.depth==n.depth-1?(t&&t(e.tr.delete(s.pos,s.pos+a.nodeSize).scrollIntoView()),!0):!1},RF=(e,t,r)=>{let{$head:n,empty:s}=e.selection,a=n;if(!s)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;a=XS(n)}let i=a&&a.nodeAfter;return!i||!xt.isSelectable(i)?!1:(t&&t(e.tr.setSelection(xt.create(e.doc,a.pos)).scrollIntoView()),!0)};function XS(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let r=e.node(t);if(e.index(t)+1<r.childCount)return e.doc.resolve(e.after(t+1));if(r.type.spec.isolating)break}return null}const Wue=(e,t)=>{let r=e.selection,n=r instanceof xt,s;if(n){if(r.node.isTextblock||!Yl(e.doc,r.from))return!1;s=r.from}else if(s=M1(e.doc,r.from,-1),s==null)return!1;if(t){let a=e.tr.join(s);n&&a.setSelection(xt.create(a.doc,s-e.doc.resolve(s).nodeBefore.nodeSize)),t(a.scrollIntoView())}return!0},$ue=(e,t)=>{let r=e.selection,n;if(r instanceof xt){if(r.node.isTextblock||!Yl(e.doc,r.to))return!1;n=r.to}else if(n=M1(e.doc,r.to,1),n==null)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0},Gue=(e,t)=>{let{$from:r,$to:n}=e.selection,s=r.blockRange(n),a=s&&yd(s);return a==null?!1:(t&&t(e.tr.lift(s,a).scrollIntoView()),!0)},OF=(e,t)=>{let{$head:r,$anchor:n}=e.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function YS(e){for(let t=0;t<e.edgeCount;t++){let{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const Kue=(e,t)=>{let{$head:r,$anchor:n}=e.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let s=r.node(-1),a=r.indexAfter(-1),i=YS(s.contentMatchAt(a));if(!i||!s.canReplaceWith(a,a,i))return!1;if(t){let o=r.after(),c=e.tr.replaceWith(o,o,i.createAndFill());c.setSelection(It.near(c.doc.resolve(o),1)),t(c.scrollIntoView())}return!0},jF=(e,t)=>{let r=e.selection,{$from:n,$to:s}=r;if(r instanceof oa||n.parent.inlineContent||s.parent.inlineContent)return!1;let a=YS(s.parent.contentMatchAt(s.indexAfter()));if(!a||!a.isTextblock)return!1;if(t){let i=(!n.parentOffset&&s.index()<s.parent.childCount?n:s).pos,o=e.tr.insert(i,a.createAndFill());o.setSelection(St.create(o.doc,i+1)),t(o.scrollIntoView())}return!0},DF=(e,t)=>{let{$cursor:r}=e.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let a=r.before();if(Co(e.doc,a))return t&&t(e.tr.split(a).scrollIntoView()),!0}let n=r.blockRange(),s=n&&yd(n);return s==null?!1:(t&&t(e.tr.lift(n,s).scrollIntoView()),!0)};function Xue(e){return(t,r)=>{let{$from:n,$to:s}=t.selection;if(t.selection instanceof xt&&t.selection.node.isBlock)return!n.parentOffset||!Co(t.doc,n.pos)?!1:(r&&r(t.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let a=[],i,o,c=!1,f=!1;for(let g=n.depth;;g--)if(n.node(g).isBlock){c=n.end(g)==n.pos+(n.depth-g),f=n.start(g)==n.pos-(n.depth-g),o=YS(n.node(g-1).contentMatchAt(n.indexAfter(g-1))),a.unshift(c&&o?{type:o}:null),i=g;break}else{if(g==1)return!1;a.unshift(null)}let h=t.tr;(t.selection instanceof St||t.selection instanceof oa)&&h.deleteSelection();let p=h.mapping.map(n.pos),x=Co(h.doc,p,a.length,a);if(x||(a[0]=o?{type:o}:null,x=Co(h.doc,p,a.length,a)),!x)return!1;if(h.split(p,a.length,a),!c&&f&&n.node(i).type!=o){let g=h.mapping.map(n.before(i)),v=h.doc.resolve(g);o&&n.node(i-1).canReplaceWith(v.index(),v.index()+1,o)&&h.setNodeMarkup(h.mapping.map(n.before(i)),o)}return r&&r(h.scrollIntoView()),!0}}const Yue=Xue(),Jue=(e,t)=>{let{$from:r,to:n}=e.selection,s,a=r.sharedDepth(n);return a==0?!1:(s=r.before(a),t&&t(e.tr.setSelection(xt.create(e.doc,s))),!0)};function Zue(e,t,r){let n=t.nodeBefore,s=t.nodeAfter,a=t.index();return!n||!s||!n.type.compatibleContent(s.type)?!1:!n.content.size&&t.parent.canReplace(a-1,a)?(r&&r(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(a,a+1)||!(s.isTextblock||Yl(e.doc,t.pos))?!1:(r&&r(e.tr.join(t.pos).scrollIntoView()),!0)}function IF(e,t,r,n){let s=t.nodeBefore,a=t.nodeAfter,i,o,c=s.type.spec.isolating||a.type.spec.isolating;if(!c&&Zue(e,t,r))return!0;let f=!c&&t.parent.canReplace(t.index(),t.index()+1);if(f&&(i=(o=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&o.matchType(i[0]||a.type).validEnd){if(r){let g=t.pos+a.nodeSize,v=Ke.empty;for(let _=i.length-1;_>=0;_--)v=Ke.from(i[_].create(null,v));v=Ke.from(s.copy(v));let y=e.tr.step(new Mn(t.pos-1,g,t.pos,g,new it(v,1,0),i.length,!0)),w=y.doc.resolve(g+2*i.length);w.nodeAfter&&w.nodeAfter.type==s.type&&Yl(y.doc,w.pos)&&y.join(w.pos),r(y.scrollIntoView())}return!0}let h=a.type.spec.isolating||n>0&&c?null:It.findFrom(t,1),p=h&&h.$from.blockRange(h.$to),x=p&&yd(p);if(x!=null&&x>=t.depth)return r&&r(e.tr.lift(p,x).scrollIntoView()),!0;if(f&&Bf(a,"start",!0)&&Bf(s,"end")){let g=s,v=[];for(;v.push(g),!g.isTextblock;)g=g.lastChild;let y=a,w=1;for(;!y.isTextblock;y=y.firstChild)w++;if(g.canReplace(g.childCount,g.childCount,y.content)){if(r){let _=Ke.empty;for(let E=v.length-1;E>=0;E--)_=Ke.from(v[E].copy(_));let S=e.tr.step(new Mn(t.pos-v.length,t.pos+a.nodeSize,t.pos+w,t.pos+a.nodeSize-w,new it(_,v.length,0),0,!0));r(S.scrollIntoView())}return!0}}return!1}function MF(e){return function(t,r){let n=t.selection,s=e<0?n.$from:n.$to,a=s.depth;for(;s.node(a).isInline;){if(!a)return!1;a--}return s.node(a).isTextblock?(r&&r(t.tr.setSelection(St.create(t.doc,e<0?s.start(a):s.end(a)))),!0):!1}}const Que=MF(-1),efe=MF(1);function tfe(e,t=null){return function(r,n){let{$from:s,$to:a}=r.selection,i=s.blockRange(a),o=i&&WS(i,e,t);return o?(n&&n(r.tr.wrap(i,o).scrollIntoView()),!0):!1}}function iR(e,t=null){return function(r,n){let s=!1;for(let a=0;a<r.selection.ranges.length&&!s;a++){let{$from:{pos:i},$to:{pos:o}}=r.selection.ranges[a];r.doc.nodesBetween(i,o,(c,f)=>{if(s)return!1;if(!(!c.isTextblock||c.hasMarkup(e,t)))if(c.type==e)s=!0;else{let h=r.doc.resolve(f),p=h.index();s=h.parent.canReplaceWith(p,p+1,e)}})}if(!s)return!1;if(n){let a=r.tr;for(let i=0;i<r.selection.ranges.length;i++){let{$from:{pos:o},$to:{pos:c}}=r.selection.ranges[i];a.setBlockType(o,c,e,t)}n(a.scrollIntoView())}return!0}}function JS(...e){return function(t,r,n){for(let s=0;s<e.length;s++)if(e[s](t,r,n))return!0;return!1}}JS(GS,NF,kF);JS(GS,CF,RF);JS(OF,jF,DF,Yue);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function rfe(e,t=null){return function(r,n){let{$from:s,$to:a}=r.selection,i=s.blockRange(a);if(!i)return!1;let o=n?r.tr:null;return nfe(o,i,e,t)?(n&&n(o.scrollIntoView()),!0):!1}}function nfe(e,t,r,n=null){let s=!1,a=t,i=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(r)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let c=i.resolve(t.start-2);a=new pg(c,c,t.depth),t.endIndex<t.parent.childCount&&(t=new pg(t.$from,i.resolve(t.$to.end(t.depth)),t.depth)),s=!0}let o=WS(a,r,n,t);return o?(e&&sfe(e,t,o,s,r),!0):!1}function sfe(e,t,r,n,s){let a=Ke.empty;for(let h=r.length-1;h>=0;h--)a=Ke.from(r[h].type.create(r[h].attrs,a));e.step(new Mn(t.start-(n?2:0),t.end,t.start,t.end,new it(a,0,0),r.length,!0));let i=0;for(let h=0;h<r.length;h++)r[h].type==s&&(i=h+1);let o=r.length-i,c=t.start+r.length-(n?2:0),f=t.parent;for(let h=t.startIndex,p=t.endIndex,x=!0;h<p;h++,x=!1)!x&&Co(e.doc,c,o)&&(e.split(c,o),c+=2*o),c+=f.child(h).nodeSize;return e}function afe(e){return function(t,r){let{$from:n,$to:s}=t.selection,a=n.blockRange(s,i=>i.childCount>0&&i.firstChild.type==e);return a?r?n.node(a.depth-1).type==e?ife(t,r,e,a):ofe(t,r,a):!0:!1}}function ife(e,t,r,n){let s=e.tr,a=n.end,i=n.$to.end(n.depth);a<i&&(s.step(new Mn(a-1,i,a,i,new it(Ke.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new pg(s.doc.resolve(n.$from.pos),s.doc.resolve(i),n.depth));const o=yd(n);if(o==null)return!1;s.lift(n,o);let c=s.doc.resolve(s.mapping.map(a,-1)-1);return Yl(s.doc,c.pos)&&c.nodeBefore.type==c.nodeAfter.type&&s.join(c.pos),t(s.scrollIntoView()),!0}function ofe(e,t,r){let n=e.tr,s=r.parent;for(let g=r.end,v=r.endIndex-1,y=r.startIndex;v>y;v--)g-=s.child(v).nodeSize,n.delete(g-1,g+1);let a=n.doc.resolve(r.start),i=a.nodeAfter;if(n.mapping.map(r.end)!=r.start+a.nodeAfter.nodeSize)return!1;let o=r.startIndex==0,c=r.endIndex==s.childCount,f=a.node(-1),h=a.index(-1);if(!f.canReplace(h+(o?0:1),h+1,i.content.append(c?Ke.empty:Ke.from(s))))return!1;let p=a.pos,x=p+i.nodeSize;return n.step(new Mn(p-(o?1:0),x+(c?1:0),p+1,x-1,new it((o?Ke.empty:Ke.from(s.copy(Ke.empty))).append(c?Ke.empty:Ke.from(s.copy(Ke.empty))),o?0:1,c?0:1),o?0:1)),t(n.scrollIntoView()),!0}function lfe(e){return function(t,r){let{$from:n,$to:s}=t.selection,a=n.blockRange(s,f=>f.childCount>0&&f.firstChild.type==e);if(!a)return!1;let i=a.startIndex;if(i==0)return!1;let o=a.parent,c=o.child(i-1);if(c.type!=e)return!1;if(r){let f=c.lastChild&&c.lastChild.type==o.type,h=Ke.from(f?e.create():null),p=new it(Ke.from(e.create(null,Ke.from(o.type.create(null,h)))),f?3:1,0),x=a.start,g=a.end;r(t.tr.step(new Mn(x-(f?3:1),g,x,g,p,1,!0)).scrollIntoView())}return!0}}const Wn=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},Uf=function(e){let t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t};let $_=null;const go=function(e,t,r){let n=$_||($_=document.createRange());return n.setEnd(e,r??e.nodeValue.length),n.setStart(e,t||0),n},cfe=function(){$_=null},su=function(e,t,r,n){return r&&(oR(e,t,r,n,-1)||oR(e,t,r,n,1))},ufe=/^(img|br|input|textarea|hr)$/i;function oR(e,t,r,n,s){for(var a;;){if(e==r&&t==n)return!0;if(t==(s<0?0:Fa(e))){let i=e.parentNode;if(!i||i.nodeType!=1||lp(e)||ufe.test(e.nodeName)||e.contentEditable=="false")return!1;t=Wn(e)+(s<0?0:1),e=i}else if(e.nodeType==1){let i=e.childNodes[t+(s<0?-1:0)];if(i.nodeType==1&&i.contentEditable=="false")if(!((a=i.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)t+=s;else return!1;else e=i,t=s<0?Fa(e):0}else return!1}}function Fa(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function ffe(e,t){for(;;){if(e.nodeType==3&&t)return e;if(e.nodeType==1&&t>0){if(e.contentEditable=="false")return null;e=e.childNodes[t-1],t=Fa(e)}else if(e.parentNode&&!lp(e))t=Wn(e),e=e.parentNode;else return null}}function dfe(e,t){for(;;){if(e.nodeType==3&&t<e.nodeValue.length)return e;if(e.nodeType==1&&t<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[t],t=0}else if(e.parentNode&&!lp(e))t=Wn(e)+1,e=e.parentNode;else return null}}function hfe(e,t,r){for(let n=t==0,s=t==Fa(e);n||s;){if(e==r)return!0;let a=Wn(e);if(e=e.parentNode,!e)return!1;n=n&&a==0,s=s&&a==Fa(e)}}function lp(e){let t;for(let r=e;r&&!(t=r.pmViewDesc);r=r.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const L1=function(e){return e.focusNode&&su(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Ec(e,t){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=e,r.key=r.code=t,r}function pfe(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function mfe(e,t,r){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,r);if(n)return{node:n.offsetNode,offset:Math.min(Fa(n.offsetNode),n.offset)}}catch{}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,r);if(n)return{node:n.startContainer,offset:Math.min(Fa(n.startContainer),n.startOffset)}}}const Li=typeof navigator<"u"?navigator:null,lR=typeof document<"u"?document:null,Jl=Li&&Li.userAgent||"",G_=/Edge\/(\d+)/.exec(Jl),FF=/MSIE \d/.exec(Jl),K_=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Jl),Us=!!(FF||K_||G_),Il=FF?document.documentMode:K_?+K_[1]:G_?+G_[1]:0,Ba=!Us&&/gecko\/(\d+)/i.test(Jl);Ba&&+(/Firefox\/(\d+)/.exec(Jl)||[0,0])[1];const X_=!Us&&/Chrome\/(\d+)/.exec(Jl),Yn=!!X_,PF=X_?+X_[1]:0,hs=!Us&&!!Li&&/Apple Computer/.test(Li.vendor),zf=hs&&(/Mobile\/\w+/.test(Jl)||!!Li&&Li.maxTouchPoints>2),Ma=zf||(Li?/Mac/.test(Li.platform):!1),LF=Li?/Win/.test(Li.platform):!1,wo=/Android \d/.test(Jl),cp=!!lR&&"webkitFontSmoothing"in lR.documentElement.style,xfe=cp?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function gfe(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function co(e,t){return typeof e=="number"?e:e[t]}function yfe(e){let t=e.getBoundingClientRect(),r=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*r,top:t.top,bottom:t.top+e.clientHeight*n}}function cR(e,t,r){let n=e.someProp("scrollThreshold")||0,s=e.someProp("scrollMargin")||5,a=e.dom.ownerDocument;for(let i=r||e.dom;i;){if(i.nodeType!=1){i=Uf(i);continue}let o=i,c=o==a.body,f=c?gfe(a):yfe(o),h=0,p=0;if(t.top<f.top+co(n,"top")?p=-(f.top-t.top+co(s,"top")):t.bottom>f.bottom-co(n,"bottom")&&(p=t.bottom-t.top>f.bottom-f.top?t.top+co(s,"top")-f.top:t.bottom-f.bottom+co(s,"bottom")),t.left<f.left+co(n,"left")?h=-(f.left-t.left+co(s,"left")):t.right>f.right-co(n,"right")&&(h=t.right-f.right+co(s,"right")),h||p)if(c)a.defaultView.scrollBy(h,p);else{let g=o.scrollLeft,v=o.scrollTop;p&&(o.scrollTop+=p),h&&(o.scrollLeft+=h);let y=o.scrollLeft-g,w=o.scrollTop-v;t={left:t.left-y,top:t.top-w,right:t.right-y,bottom:t.bottom-w}}let x=c?"fixed":getComputedStyle(i).position;if(/^(fixed|sticky)$/.test(x))break;i=x=="absolute"?i.offsetParent:Uf(i)}}function vfe(e){let t=e.dom.getBoundingClientRect(),r=Math.max(0,t.top),n,s;for(let a=(t.left+t.right)/2,i=r+1;i<Math.min(innerHeight,t.bottom);i+=5){let o=e.root.elementFromPoint(a,i);if(!o||o==e.dom||!e.dom.contains(o))continue;let c=o.getBoundingClientRect();if(c.top>=r-20){n=o,s=c.top;break}}return{refDOM:n,refTop:s,stack:BF(e.dom)}}function BF(e){let t=[],r=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=r);n=Uf(n));return t}function bfe({refDOM:e,refTop:t,stack:r}){let n=e?e.getBoundingClientRect().top:0;UF(r,n==0?0:n-t)}function UF(e,t){for(let r=0;r<e.length;r++){let{dom:n,top:s,left:a}=e[r];n.scrollTop!=s+t&&(n.scrollTop=s+t),n.scrollLeft!=a&&(n.scrollLeft=a)}}let nf=null;function wfe(e){if(e.setActive)return e.setActive();if(nf)return e.focus(nf);let t=BF(e);e.focus(nf==null?{get preventScroll(){return nf={preventScroll:!0},!0}}:void 0),nf||(nf=!1,UF(t,0))}function zF(e,t){let r,n=2e8,s,a=0,i=t.top,o=t.top,c,f;for(let h=e.firstChild,p=0;h;h=h.nextSibling,p++){let x;if(h.nodeType==1)x=h.getClientRects();else if(h.nodeType==3)x=go(h).getClientRects();else continue;for(let g=0;g<x.length;g++){let v=x[g];if(v.top<=i&&v.bottom>=o){i=Math.max(v.bottom,i),o=Math.min(v.top,o);let y=v.left>t.left?v.left-t.left:v.right<t.left?t.left-v.right:0;if(y<n){r=h,n=y,s=y&&r.nodeType==3?{left:v.right<t.left?v.right:v.left,top:t.top}:t,h.nodeType==1&&y&&(a=p+(t.left>=(v.left+v.right)/2?1:0));continue}}else v.top>t.top&&!c&&v.left<=t.left&&v.right>=t.left&&(c=h,f={left:Math.max(v.left,Math.min(v.right,t.left)),top:v.top});!r&&(t.left>=v.right&&t.top>=v.top||t.left>=v.left&&t.top>=v.bottom)&&(a=p+1)}}return!r&&c&&(r=c,s=f,n=0),r&&r.nodeType==3?_fe(r,s):!r||n&&r.nodeType==1?{node:e,offset:a}:zF(r,s)}function _fe(e,t){let r=e.nodeValue.length,n=document.createRange(),s;for(let a=0;a<r;a++){n.setEnd(e,a+1),n.setStart(e,a);let i=yl(n,1);if(i.top!=i.bottom&&ZS(t,i)){s={node:e,offset:a+(t.left>=(i.left+i.right)/2?1:0)};break}}return n.detach(),s||{node:e,offset:0}}function ZS(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function Efe(e,t){let r=e.parentNode;return r&&/^li$/i.test(r.nodeName)&&t.left<e.getBoundingClientRect().left?r:e}function Sfe(e,t,r){let{node:n,offset:s}=zF(t,r),a=-1;if(n.nodeType==1&&!n.firstChild){let i=n.getBoundingClientRect();a=i.left!=i.right&&r.left>(i.left+i.right)/2?1:-1}return e.docView.posFromDOM(n,s,a)}function Nfe(e,t,r,n){let s=-1;for(let a=t,i=!1;a!=e.dom;){let o=e.docView.nearestDesc(a,!0),c;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((c=o.dom.getBoundingClientRect()).width||c.height)&&(o.node.isBlock&&o.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(o.dom.nodeName)&&(!i&&c.left>n.left||c.top>n.top?s=o.posBefore:(!i&&c.right<n.left||c.bottom<n.top)&&(s=o.posAfter),i=!0),!o.contentDOM&&s<0&&!o.node.isText))return(o.node.isBlock?n.top<(c.top+c.bottom)/2:n.left<(c.left+c.right)/2)?o.posBefore:o.posAfter;a=o.dom.parentNode}return s>-1?s:e.docView.posFromDOM(t,r,-1)}function HF(e,t,r){let n=e.childNodes.length;if(n&&r.top<r.bottom)for(let s=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-r.top)/(r.bottom-r.top))-2)),a=s;;){let i=e.childNodes[a];if(i.nodeType==1){let o=i.getClientRects();for(let c=0;c<o.length;c++){let f=o[c];if(ZS(t,f))return HF(i,t,f)}}if((a=(a+1)%n)==s)break}return e}function Tfe(e,t){let r=e.dom.ownerDocument,n,s=0,a=mfe(r,t.left,t.top);a&&({node:n,offset:s}=a);let i=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top),o;if(!i||!e.dom.contains(i.nodeType!=1?i.parentNode:i)){let f=e.dom.getBoundingClientRect();if(!ZS(t,f)||(i=HF(e.dom,t,f),!i))return null}if(hs)for(let f=i;n&&f;f=Uf(f))f.draggable&&(n=void 0);if(i=Efe(i,t),n){if(Ba&&n.nodeType==1&&(s=Math.min(s,n.childNodes.length),s<n.childNodes.length)){let h=n.childNodes[s],p;h.nodeName=="IMG"&&(p=h.getBoundingClientRect()).right<=t.left&&p.bottom>t.top&&s++}let f;cp&&s&&n.nodeType==1&&(f=n.childNodes[s-1]).nodeType==1&&f.contentEditable=="false"&&f.getBoundingClientRect().top>=t.top&&s--,n==e.dom&&s==n.childNodes.length-1&&n.lastChild.nodeType==1&&t.top>n.lastChild.getBoundingClientRect().bottom?o=e.state.doc.content.size:(s==0||n.nodeType!=1||n.childNodes[s-1].nodeName!="BR")&&(o=Nfe(e,n,s,t))}o==null&&(o=Sfe(e,i,t));let c=e.docView.nearestDesc(i,!0);return{pos:o,inside:c?c.posAtStart-c.border:-1}}function uR(e){return e.top<e.bottom||e.left<e.right}function yl(e,t){let r=e.getClientRects();if(r.length){let n=r[t<0?0:r.length-1];if(uR(n))return n}return Array.prototype.find.call(r,uR)||e.getBoundingClientRect()}const kfe=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function VF(e,t,r){let{node:n,offset:s,atom:a}=e.docView.domFromPos(t,r<0?-1:1),i=cp||Ba;if(n.nodeType==3)if(i&&(kfe.test(n.nodeValue)||(r<0?!s:s==n.nodeValue.length))){let c=yl(go(n,s,s),r);if(Ba&&s&&/\s/.test(n.nodeValue[s-1])&&s<n.nodeValue.length){let f=yl(go(n,s-1,s-1),-1);if(f.top==c.top){let h=yl(go(n,s,s+1),-1);if(h.top!=c.top)return gh(h,h.left<f.left)}}return c}else{let c=s,f=s,h=r<0?1:-1;return r<0&&!s?(f++,h=-1):r>=0&&s==n.nodeValue.length?(c--,h=1):r<0?c--:f++,gh(yl(go(n,c,f),h),h<0)}if(!e.state.doc.resolve(t-(a||0)).parent.inlineContent){if(a==null&&s&&(r<0||s==Fa(n))){let c=n.childNodes[s-1];if(c.nodeType==1)return Zb(c.getBoundingClientRect(),!1)}if(a==null&&s<Fa(n)){let c=n.childNodes[s];if(c.nodeType==1)return Zb(c.getBoundingClientRect(),!0)}return Zb(n.getBoundingClientRect(),r>=0)}if(a==null&&s&&(r<0||s==Fa(n))){let c=n.childNodes[s-1],f=c.nodeType==3?go(c,Fa(c)-(i?0:1)):c.nodeType==1&&(c.nodeName!="BR"||!c.nextSibling)?c:null;if(f)return gh(yl(f,1),!1)}if(a==null&&s<Fa(n)){let c=n.childNodes[s];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let f=c?c.nodeType==3?go(c,0,i?0:1):c.nodeType==1?c:null:null;if(f)return gh(yl(f,-1),!0)}return gh(yl(n.nodeType==3?go(n):n,-r),r>=0)}function gh(e,t){if(e.width==0)return e;let r=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:r,right:r}}function Zb(e,t){if(e.height==0)return e;let r=t?e.top:e.bottom;return{top:r,bottom:r,left:e.left,right:e.right}}function qF(e,t,r){let n=e.state,s=e.root.activeElement;n!=t&&e.updateState(t),s!=e.dom&&e.focus();try{return r()}finally{n!=t&&e.updateState(n),s!=e.dom&&s&&s.focus()}}function Afe(e,t,r){let n=t.selection,s=r=="up"?n.$from:n.$to;return qF(e,t,()=>{let{node:a}=e.docView.domFromPos(s.pos,r=="up"?-1:1);for(;;){let o=e.docView.nearestDesc(a,!0);if(!o)break;if(o.node.isBlock){a=o.contentDOM||o.dom;break}a=o.dom.parentNode}let i=VF(e,s.pos,1);for(let o=a.firstChild;o;o=o.nextSibling){let c;if(o.nodeType==1)c=o.getClientRects();else if(o.nodeType==3)c=go(o,0,o.nodeValue.length).getClientRects();else continue;for(let f=0;f<c.length;f++){let h=c[f];if(h.bottom>h.top+1&&(r=="up"?i.top-h.top>(h.bottom-i.top)*2:h.bottom-i.bottom>(i.bottom-h.top)*2))return!1}}return!0})}const Cfe=/[\u0590-\u08ac]/;function Rfe(e,t,r){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let s=n.parentOffset,a=!s,i=s==n.parent.content.size,o=e.domSelection();return o?!Cfe.test(n.parent.textContent)||!o.modify?r=="left"||r=="backward"?a:i:qF(e,t,()=>{let{focusNode:c,focusOffset:f,anchorNode:h,anchorOffset:p}=e.domSelectionRange(),x=o.caretBidiLevel;o.modify("move",r,"character");let g=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:v,focusOffset:y}=e.domSelectionRange(),w=v&&!g.contains(v.nodeType==1?v:v.parentNode)||c==v&&f==y;try{o.collapse(h,p),c&&(c!=h||f!=p)&&o.extend&&o.extend(c,f)}catch{}return x!=null&&(o.caretBidiLevel=x),w}):n.pos==n.start()||n.pos==n.end()}let fR=null,dR=null,hR=!1;function Ofe(e,t,r){return fR==t&&dR==r?hR:(fR=t,dR=r,hR=r=="up"||r=="down"?Afe(e,t,r):Rfe(e,t,r))}const Ua=0,pR=1,kc=2,Bi=3;class up{constructor(t,r,n,s){this.parent=t,this.children=r,this.dom=n,this.contentDOM=s,this.dirty=Ua,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,r,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let r=0;r<this.children.length;r++)t+=this.children[r].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let r=0,n=this.posAtStart;;r++){let s=this.children[r];if(s==t)return n;n+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,r,n){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(n<0){let a,i;if(t==this.contentDOM)a=t.childNodes[r-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.previousSibling}for(;a&&!((i=a.pmViewDesc)&&i.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(i)+i.size:this.posAtStart}else{let a,i;if(t==this.contentDOM)a=t.childNodes[r];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.nextSibling}for(;a&&!((i=a.pmViewDesc)&&i.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(i):this.posAtEnd}let s;if(t==this.dom&&this.contentDOM)s=r>Wn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let a=t;;a=a.parentNode){if(a==this.dom){s=!1;break}if(a.previousSibling)break}if(s==null&&r==t.childNodes.length)for(let a=t;;a=a.parentNode){if(a==this.dom){s=!0;break}if(a.nextSibling)break}}return s??n>0?this.posAtEnd:this.posAtStart}nearestDesc(t,r=!1){for(let n=!0,s=t;s;s=s.parentNode){let a=this.getDesc(s),i;if(a&&(!r||a.node))if(n&&(i=a.nodeDOM)&&!(i.nodeType==1?i.contains(t.nodeType==1?t:t.parentNode):i==t))n=!1;else return a}}getDesc(t){let r=t.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(t,r,n){for(let s=t;s;s=s.parentNode){let a=this.getDesc(s);if(a)return a.localPosFromDOM(t,r,n)}return-1}descAt(t){for(let r=0,n=0;r<this.children.length;r++){let s=this.children[r],a=n+s.size;if(n==t&&a!=n){for(;!s.border&&s.children.length;)for(let i=0;i<s.children.length;i++){let o=s.children[i];if(o.size){s=o;break}}return s}if(t<a)return s.descAt(t-n-s.border);n=a}}domFromPos(t,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,s=0;for(let a=0;n<this.children.length;n++){let i=this.children[n],o=a+i.size;if(o>t||i instanceof $F){s=t-a;break}a=o}if(s)return this.children[n].domFromPos(s-this.children[n].border,r);for(let a;n&&!(a=this.children[n-1]).size&&a instanceof WF&&a.side>=0;n--);if(r<=0){let a,i=!0;for(;a=n?this.children[n-1]:null,!(!a||a.dom.parentNode==this.contentDOM);n--,i=!1);return a&&r&&i&&!a.border&&!a.domAtom?a.domFromPos(a.size,r):{node:this.contentDOM,offset:a?Wn(a.dom)+1:0}}else{let a,i=!0;for(;a=n<this.children.length?this.children[n]:null,!(!a||a.dom.parentNode==this.contentDOM);n++,i=!1);return a&&i&&!a.border&&!a.domAtom?a.domFromPos(0,r):{node:this.contentDOM,offset:a?Wn(a.dom):this.contentDOM.childNodes.length}}}parseRange(t,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,a=-1;for(let i=n,o=0;;o++){let c=this.children[o],f=i+c.size;if(s==-1&&t<=f){let h=i+c.border;if(t>=h&&r<=f-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(t,r,h);t=i;for(let p=o;p>0;p--){let x=this.children[p-1];if(x.size&&x.dom.parentNode==this.contentDOM&&!x.emptyChildAt(1)){s=Wn(x.dom)+1;break}t-=x.size}s==-1&&(s=0)}if(s>-1&&(f>r||o==this.children.length-1)){r=f;for(let h=o+1;h<this.children.length;h++){let p=this.children[h];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){a=Wn(p.dom);break}r+=p.size}a==-1&&(a=this.contentDOM.childNodes.length);break}i=f}return{node:this.contentDOM,from:t,to:r,fromOffset:s,toOffset:a}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[t<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(t)}domAfterPos(t){let{node:r,offset:n}=this.domFromPos(t,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+t);return r.childNodes[n]}setSelection(t,r,n,s=!1){let a=Math.min(t,r),i=Math.max(t,r);for(let g=0,v=0;g<this.children.length;g++){let y=this.children[g],w=v+y.size;if(a>v&&i<w)return y.setSelection(t-v-y.border,r-v-y.border,n,s);v=w}let o=this.domFromPos(t,t?-1:1),c=r==t?o:this.domFromPos(r,r?-1:1),f=n.root.getSelection(),h=n.domSelectionRange(),p=!1;if((Ba||hs)&&t==r){let{node:g,offset:v}=o;if(g.nodeType==3){if(p=!!(v&&g.nodeValue[v-1]==`
`),p&&v==g.nodeValue.length)for(let y=g,w;y;y=y.parentNode){if(w=y.nextSibling){w.nodeName=="BR"&&(o=c={node:w.parentNode,offset:Wn(w)+1});break}let _=y.pmViewDesc;if(_&&_.node&&_.node.isBlock)break}}else{let y=g.childNodes[v-1];p=y&&(y.nodeName=="BR"||y.contentEditable=="false")}}if(Ba&&h.focusNode&&h.focusNode!=c.node&&h.focusNode.nodeType==1){let g=h.focusNode.childNodes[h.focusOffset];g&&g.contentEditable=="false"&&(s=!0)}if(!(s||p&&hs)&&su(o.node,o.offset,h.anchorNode,h.anchorOffset)&&su(c.node,c.offset,h.focusNode,h.focusOffset))return;let x=!1;if((f.extend||t==r)&&!(p&&Ba)){f.collapse(o.node,o.offset);try{t!=r&&f.extend(c.node,c.offset),x=!0}catch{}}if(!x){if(t>r){let v=o;o=c,c=v}let g=document.createRange();g.setEnd(c.node,c.offset),g.setStart(o.node,o.offset),f.removeAllRanges(),f.addRange(g)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,r){for(let n=0,s=0;s<this.children.length;s++){let a=this.children[s],i=n+a.size;if(n==i?t<=i&&r>=n:t<i&&r>n){let o=n+a.border,c=i-a.border;if(t>=o&&r<=c){this.dirty=t==n||r==i?kc:pR,t==o&&r==c&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=Bi:a.markDirty(t-o,r-o);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?kc:Bi}n=i}this.dirty=kc}markParentsDirty(){let t=1;for(let r=this.parent;r;r=r.parent,t++){let n=t==1?kc:pR;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}}class WF extends up{constructor(t,r,n,s){let a,i=r.type.toDOM;if(typeof i=="function"&&(i=i(n,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)})),!r.type.spec.raw){if(i.nodeType!=1){let o=document.createElement("span");o.appendChild(i),i=o}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(t,[],i,null),this.widget=r,this.widget=r,a=this}matchesWidget(t){return this.dirty==Ua&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let r=this.widget.spec.stopEvent;return r?r(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class jfe extends up{constructor(t,r,n,s){super(t,[],r,null),this.textDOM=n,this.text=s}get size(){return this.text.length}localPosFromDOM(t,r){return t!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class au extends up{constructor(t,r,n,s,a){super(t,[],n,s),this.mark=r,this.spec=a}static create(t,r,n,s){let a=s.nodeViews[r.type.name],i=a&&a(r,s,n);return(!i||!i.dom)&&(i=xu.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new au(t,r,i.dom,i.contentDOM||i.dom,i)}parseRule(){return this.dirty&Bi||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=Bi&&this.mark.eq(t)}markDirty(t,r){if(super.markDirty(t,r),this.dirty!=Ua){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=Ua}}slice(t,r,n){let s=au.create(this.parent,this.mark,!0,n),a=this.children,i=this.size;r<i&&(a=J_(a,r,i,n)),t>0&&(a=J_(a,0,t,n));for(let o=0;o<a.length;o++)a[o].parent=s;return s.children=a,s}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Ml extends up{constructor(t,r,n,s,a,i,o,c,f){super(t,[],a,i),this.node=r,this.outerDeco=n,this.innerDeco=s,this.nodeDOM=o}static create(t,r,n,s,a,i){let o=a.nodeViews[r.type.name],c,f=o&&o(r,a,()=>{if(!c)return i;if(c.parent)return c.parent.posBeforeChild(c)},n,s),h=f&&f.dom,p=f&&f.contentDOM;if(r.isText){if(!h)h=document.createTextNode(r.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else h||({dom:h,contentDOM:p}=xu.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!p&&!r.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),r.type.spec.draggable&&(h.draggable=!0));let x=h;return h=XF(h,n,r),f?c=new Dfe(t,r,n,s,h,p||null,x,f,a,i+1):r.isText?new B1(t,r,n,s,h,x,a):new Ml(t,r,n,s,h,p||null,x,a,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>Ke.empty)}return t}matchesNode(t,r,n){return this.dirty==Ua&&t.eq(this.node)&&xg(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,r){let n=this.node.inlineContent,s=r,a=t.composing?this.localCompositionInfo(t,r):null,i=a&&a.pos>-1?a:null,o=a&&a.pos<0,c=new Mfe(this,i&&i.node,t);Lfe(this.node,this.innerDeco,(f,h,p)=>{f.spec.marks?c.syncToMarks(f.spec.marks,n,t,h):f.type.side>=0&&!p&&c.syncToMarks(h==this.node.childCount?mr.none:this.node.child(h).marks,n,t,h),c.placeWidget(f,t,s)},(f,h,p,x)=>{c.syncToMarks(f.marks,n,t,x);let g;c.findNodeMatch(f,h,p,x)||o&&t.state.selection.from>s&&t.state.selection.to<s+f.nodeSize&&(g=c.findIndexWithChild(a.node))>-1&&c.updateNodeAt(f,h,p,g,t)||c.updateNextNode(f,h,p,t,x,s)||c.addNode(f,h,p,t,s),s+=f.nodeSize}),c.syncToMarks([],n,t,0),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||this.dirty==kc)&&(i&&this.protectLocalComposition(t,i),GF(this.contentDOM,this.children,t),zf&&Bfe(this.dom))}localCompositionInfo(t,r){let{from:n,to:s}=t.state.selection;if(!(t.state.selection instanceof St)||n<r||s>r+this.node.content.size)return null;let a=t.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let i=a.nodeValue,o=Ufe(this.node.content,i,n-r,s-r);return o<0?null:{node:a,pos:o,text:i}}else return{node:a,pos:-1,text:""}}protectLocalComposition(t,{node:r,pos:n,text:s}){if(this.getDesc(r))return;let a=r;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let i=new jfe(this,a,r,s);t.input.compositionNodes.push(i),this.children=J_(this.children,n,n+s.length,t,i)}update(t,r,n,s){return this.dirty==Bi||!t.sameMarkup(this.node)?!1:(this.updateInner(t,r,n,s),!0)}updateInner(t,r,n,s){this.updateOuterDeco(r),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Ua}updateOuterDeco(t){if(xg(t,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=KF(this.dom,this.nodeDOM,Y_(this.outerDeco,this.node,r),Y_(t,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function mR(e,t,r,n,s){XF(n,t,e);let a=new Ml(void 0,e,t,r,n,n,n,s,0);return a.contentDOM&&a.updateChildren(s,0),a}class B1 extends Ml{constructor(t,r,n,s,a,i,o){super(t,r,n,s,a,null,i,o,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,r,n,s){return this.dirty==Bi||this.dirty!=Ua&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=Ua||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=t,this.dirty=Ua,!0)}inParent(){let t=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,r,n){return t==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(t,r,n)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,r,n){let s=this.node.cut(t,r),a=document.createTextNode(s.text);return new B1(this.parent,s,this.outerDeco,this.innerDeco,a,a,n)}markDirty(t,r){super.markDirty(t,r),this.dom!=this.nodeDOM&&(t==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=Bi)}get domAtom(){return!1}isText(t){return this.node.text==t}}class $F extends up{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==Ua&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Dfe extends Ml{constructor(t,r,n,s,a,i,o,c,f,h){super(t,r,n,s,a,i,o,f,h),this.spec=c}update(t,r,n,s){if(this.dirty==Bi)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let a=this.spec.update(t,r,n);return a&&this.updateInner(t,r,n,s),a}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,r,n,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,r,n,s){this.spec.setSelection?this.spec.setSelection(t,r,n.root):super.setSelection(t,r,n,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function GF(e,t,r){let n=e.firstChild,s=!1;for(let a=0;a<t.length;a++){let i=t[a],o=i.dom;if(o.parentNode==e){for(;o!=n;)n=xR(n),s=!0;n=n.nextSibling}else s=!0,e.insertBefore(o,n);if(i instanceof au){let c=n?n.previousSibling:e.lastChild;GF(i.contentDOM,i.children,r),n=c?c.nextSibling:e.firstChild}}for(;n;)n=xR(n),s=!0;s&&r.trackWrites==e&&(r.trackWrites=null)}const Jh=function(e){e&&(this.nodeName=e)};Jh.prototype=Object.create(null);const Ac=[new Jh];function Y_(e,t,r){if(e.length==0)return Ac;let n=r?Ac[0]:new Jh,s=[n];for(let a=0;a<e.length;a++){let i=e[a].type.attrs;if(i){i.nodeName&&s.push(n=new Jh(i.nodeName));for(let o in i){let c=i[o];c!=null&&(r&&s.length==1&&s.push(n=new Jh(t.isInline?"span":"div")),o=="class"?n.class=(n.class?n.class+" ":"")+c:o=="style"?n.style=(n.style?n.style+";":"")+c:o!="nodeName"&&(n[o]=c))}}}return s}function KF(e,t,r,n){if(r==Ac&&n==Ac)return t;let s=t;for(let a=0;a<n.length;a++){let i=n[a],o=r[a];if(a){let c;o&&o.nodeName==i.nodeName&&s!=e&&(c=s.parentNode)&&c.nodeName.toLowerCase()==i.nodeName||(c=document.createElement(i.nodeName),c.pmIsDeco=!0,c.appendChild(s),o=Ac[0]),s=c}Ife(s,o||Ac[0],i)}return s}function Ife(e,t,r){for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&e.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=t[n]&&e.setAttribute(n,r[n]);if(t.class!=r.class){let n=t.class?t.class.split(" ").filter(Boolean):[],s=r.class?r.class.split(" ").filter(Boolean):[];for(let a=0;a<n.length;a++)s.indexOf(n[a])==-1&&e.classList.remove(n[a]);for(let a=0;a<s.length;a++)n.indexOf(s[a])==-1&&e.classList.add(s[a]);e.classList.length==0&&e.removeAttribute("class")}if(t.style!=r.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=n.exec(t.style);)e.style.removeProperty(s[1])}r.style&&(e.style.cssText+=r.style)}}function XF(e,t,r){return KF(e,e,Ac,Y_(t,r,e.nodeType!=1))}function xg(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].type.eq(t[r].type))return!1;return!0}function xR(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class Mfe{constructor(t,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=Ffe(t.node.content,t)}destroyBetween(t,r){if(t!=r){for(let n=t;n<r;n++)this.top.children[n].destroy();this.top.children.splice(t,r-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,r,n,s){let a=0,i=this.stack.length>>1,o=Math.min(i,t.length);for(;a<o&&(a==i-1?this.top:this.stack[a+1<<1]).matchesMark(t[a])&&t[a].type.spec.spanning!==!1;)a++;for(;a<i;)this.destroyRest(),this.top.dirty=Ua,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<t.length;){this.stack.push(this.top,this.index+1);let c=-1,f=this.top.children.length;s<this.preMatch.index&&(f=Math.min(this.index+3,f));for(let h=this.index;h<f;h++){let p=this.top.children[h];if(p.matchesMark(t[i])&&!this.isLocked(p.dom)){c=h;break}}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{let h=au.create(this.top,t[i],r,n);this.top.children.splice(this.index,0,h),this.top=h,this.changed=!0}this.index=0,i++}}findNodeMatch(t,r,n,s){let a=-1,i;if(s>=this.preMatch.index&&(i=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&i.matchesNode(t,r,n))a=this.top.children.indexOf(i,this.index);else for(let o=this.index,c=Math.min(this.top.children.length,o+5);o<c;o++){let f=this.top.children[o];if(f.matchesNode(t,r,n)&&!this.preMatch.matched.has(f)){a=o;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(t,r,n,s,a){let i=this.top.children[s];return i.dirty==Bi&&i.dom==i.contentDOM&&(i.dirty=kc),i.update(t,r,n,a)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(t){for(;;){let r=t.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=t.pmViewDesc;if(n){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==n)return s}return-1}t=r}}updateNextNode(t,r,n,s,a,i){for(let o=this.index;o<this.top.children.length;o++){let c=this.top.children[o];if(c instanceof Ml){let f=this.preMatch.matched.get(c);if(f!=null&&f!=a)return!1;let h=c.dom,p,x=this.isLocked(h)&&!(t.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==t.text&&c.dirty!=Bi&&xg(r,c.outerDeco));if(!x&&c.update(t,r,n,s))return this.destroyBetween(this.index,o),c.dom!=h&&(this.changed=!0),this.index++,!0;if(!x&&(p=this.recreateWrapper(c,t,r,n,s,i)))return this.destroyBetween(this.index,o),this.top.children[this.index]=p,p.contentDOM&&(p.dirty=kc,p.updateChildren(s,i+1),p.dirty=Ua),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,r,n,s,a,i){if(t.dirty||r.isAtom||!t.children.length||!t.node.content.eq(r.content)||!xg(n,t.outerDeco)||!s.eq(t.innerDeco))return null;let o=Ml.create(this.top,r,n,s,a,i);if(o.contentDOM){o.children=t.children,t.children=[];for(let c of o.children)c.parent=o}return t.destroy(),o}addNode(t,r,n,s,a){let i=Ml.create(this.top,t,r,n,s,a);i.contentDOM&&i.updateChildren(s,a+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(t,r,n){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(t)&&(t==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let a=new WF(this.top,t,r,n);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],r=this.top;for(;t instanceof au;)r=t,t=r.children[r.children.length-1];(!t||!(t instanceof B1)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((hs||Yn)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(t,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);t=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),t=="BR"&&(n.className="ProseMirror-trailingBreak");let s=new $F(this.top,[],n,null);r!=this.top?r.children.push(s):r.children.splice(this.index++,0,s),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function Ffe(e,t){let r=t,n=r.children.length,s=e.childCount,a=new Map,i=[];e:for(;s>0;){let o;for(;;)if(n){let f=r.children[n-1];if(f instanceof au)r=f,n=f.children.length;else{o=f,n--;break}}else{if(r==t)break e;n=r.parent.children.indexOf(r),r=r.parent}let c=o.node;if(c){if(c!=e.child(s-1))break;--s,a.set(o,s),i.push(o)}}return{index:s,matched:a,matches:i.reverse()}}function Pfe(e,t){return e.type.side-t.type.side}function Lfe(e,t,r,n){let s=t.locals(e),a=0;if(s.length==0){for(let f=0;f<e.childCount;f++){let h=e.child(f);n(h,s,t.forChild(a,h),f),a+=h.nodeSize}return}let i=0,o=[],c=null;for(let f=0;;){let h,p;for(;i<s.length&&s[i].to==a;){let w=s[i++];w.widget&&(h?(p||(p=[h])).push(w):h=w)}if(h)if(p){p.sort(Pfe);for(let w=0;w<p.length;w++)r(p[w],f,!!c)}else r(h,f,!!c);let x,g;if(c)g=-1,x=c,c=null;else if(f<e.childCount)g=f,x=e.child(f++);else break;for(let w=0;w<o.length;w++)o[w].to<=a&&o.splice(w--,1);for(;i<s.length&&s[i].from<=a&&s[i].to>a;)o.push(s[i++]);let v=a+x.nodeSize;if(x.isText){let w=v;i<s.length&&s[i].from<w&&(w=s[i].from);for(let _=0;_<o.length;_++)o[_].to<w&&(w=o[_].to);w<v&&(c=x.cut(w-a),x=x.cut(0,w-a),v=w,g=-1)}else for(;i<s.length&&s[i].to<v;)i++;let y=x.isInline&&!x.isLeaf?o.filter(w=>!w.inline):o.slice();n(x,y,t.forChild(a,x),g),a=v}}function Bfe(e){if(e.nodeName=="UL"||e.nodeName=="OL"){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function Ufe(e,t,r,n){for(let s=0,a=0;s<e.childCount&&a<=n;){let i=e.child(s++),o=a;if(a+=i.nodeSize,!i.isText)continue;let c=i.text;for(;s<e.childCount;){let f=e.child(s++);if(a+=f.nodeSize,!f.isText)break;c+=f.text}if(a>=r){if(a>=n&&c.slice(n-t.length-o,n-o)==t)return n-t.length;let f=o<n?c.lastIndexOf(t,n-o-1):-1;if(f>=0&&f+t.length+o>=r)return o+f;if(r==n&&c.length>=n+t.length-o&&c.slice(n-o,n-o+t.length)==t)return n}}return-1}function J_(e,t,r,n,s){let a=[];for(let i=0,o=0;i<e.length;i++){let c=e[i],f=o,h=o+=c.size;f>=r||h<=t?a.push(c):(f<t&&a.push(c.slice(0,t-f,n)),s&&(a.push(s),s=void 0),h>r&&a.push(c.slice(r-f,c.size,n)))}return a}function QS(e,t=null){let r=e.domSelectionRange(),n=e.state.doc;if(!r.focusNode)return null;let s=e.docView.nearestDesc(r.focusNode),a=s&&s.size==0,i=e.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(i<0)return null;let o=n.resolve(i),c,f;if(L1(r)){for(c=i;s&&!s.node;)s=s.parent;let p=s.node;if(s&&p.isAtom&&xt.isSelectable(p)&&s.parent&&!(p.isInline&&hfe(r.focusNode,r.focusOffset,s.dom))){let x=s.posBefore;f=new xt(i==x?o:n.resolve(x))}}else{if(r instanceof e.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let p=i,x=i;for(let g=0;g<r.rangeCount;g++){let v=r.getRangeAt(g);p=Math.min(p,e.docView.posFromDOM(v.startContainer,v.startOffset,1)),x=Math.max(x,e.docView.posFromDOM(v.endContainer,v.endOffset,-1))}if(p<0)return null;[c,i]=x==e.state.selection.anchor?[x,p]:[p,x],o=n.resolve(i)}else c=e.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(c<0)return null}let h=n.resolve(c);if(!f){let p=t=="pointer"||e.state.selection.head<o.pos&&!a?1:-1;f=eN(e,h,o,p)}return f}function YF(e){return e.editable?e.hasFocus():ZF(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Ro(e,t=!1){let r=e.state.selection;if(JF(e,r),!!YF(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Yn){let n=e.domSelectionRange(),s=e.domObserver.currentSelection;if(n.anchorNode&&s.anchorNode&&su(n.anchorNode,n.anchorOffset,s.anchorNode,s.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)Hfe(e);else{let{anchor:n,head:s}=r,a,i;gR&&!(r instanceof St)&&(r.$from.parent.inlineContent||(a=yR(e,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(i=yR(e,r.to))),e.docView.setSelection(n,s,e,t),gR&&(a&&vR(a),i&&vR(i)),r.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&zfe(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const gR=hs||Yn&&PF<63;function yR(e,t){let{node:r,offset:n}=e.docView.domFromPos(t,0),s=n<r.childNodes.length?r.childNodes[n]:null,a=n?r.childNodes[n-1]:null;if(hs&&s&&s.contentEditable=="false")return Qb(s);if((!s||s.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(s)return Qb(s);if(a)return Qb(a)}}function Qb(e){return e.contentEditable="true",hs&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function vR(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function zfe(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let r=e.domSelectionRange(),n=r.anchorNode,s=r.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=s)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!YF(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function Hfe(e){let t=e.domSelection();if(!t)return;let r=e.cursorWrapper.dom,n=r.nodeName=="IMG";n?t.collapse(r.parentNode,Wn(r)+1):t.collapse(r,0),!n&&!e.state.selection.visible&&Us&&Il<=11&&(r.disabled=!0,r.disabled=!1)}function JF(e,t){if(t instanceof xt){let r=e.docView.descAt(t.from);r!=e.lastSelectedViewDesc&&(bR(e),r&&r.selectNode(),e.lastSelectedViewDesc=r)}else bR(e)}function bR(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function eN(e,t,r,n){return e.someProp("createSelectionBetween",s=>s(e,t,r))||St.between(t,r,n)}function wR(e){return e.editable&&!e.hasFocus()?!1:ZF(e)}function ZF(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function Vfe(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),r=e.domSelectionRange();return su(t.node,t.offset,r.anchorNode,r.anchorOffset)}function Z_(e,t){let{$anchor:r,$head:n}=e.selection,s=t>0?r.max(n):r.min(n),a=s.parent.inlineContent?s.depth?e.doc.resolve(t>0?s.after():s.before()):null:s;return a&&It.findFrom(a,t)}function vl(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function _R(e,t,r){let n=e.state.selection;if(n instanceof St)if(r.indexOf("s")>-1){let{$head:s}=n,a=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let i=e.state.doc.resolve(s.pos+a.nodeSize*(t<0?-1:1));return vl(e,new St(n.$anchor,i))}else if(n.empty){if(e.endOfTextblock(t>0?"forward":"backward")){let s=Z_(e.state,t);return s&&s instanceof xt?vl(e,s):!1}else if(!(Ma&&r.indexOf("m")>-1)){let s=n.$head,a=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter,i;if(!a||a.isText)return!1;let o=t<0?s.pos-a.nodeSize:s.pos;return a.isAtom||(i=e.docView.descAt(o))&&!i.contentDOM?xt.isSelectable(a)?vl(e,new xt(t<0?e.state.doc.resolve(s.pos-a.nodeSize):s)):cp?vl(e,new St(e.state.doc.resolve(t<0?o:o+a.nodeSize))):!1:!1}}else return!1;else{if(n instanceof xt&&n.node.isInline)return vl(e,new St(t>0?n.$to:n.$from));{let s=Z_(e.state,t);return s?vl(e,s):!1}}}function gg(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function Zh(e,t){let r=e.pmViewDesc;return r&&r.size==0&&(t<0||e.nextSibling||e.nodeName!="BR")}function sf(e,t){return t<0?qfe(e):Wfe(e)}function qfe(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let s,a,i=!1;for(Ba&&r.nodeType==1&&n<gg(r)&&Zh(r.childNodes[n],-1)&&(i=!0);;)if(n>0){if(r.nodeType!=1)break;{let o=r.childNodes[n-1];if(Zh(o,-1))s=r,a=--n;else if(o.nodeType==3)r=o,n=r.nodeValue.length;else break}}else{if(QF(r))break;{let o=r.previousSibling;for(;o&&Zh(o,-1);)s=r.parentNode,a=Wn(o),o=o.previousSibling;if(o)r=o,n=gg(r);else{if(r=r.parentNode,r==e.dom)break;n=0}}}i?Q_(e,r,n):s&&Q_(e,s,a)}function Wfe(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let s=gg(r),a,i;for(;;)if(n<s){if(r.nodeType!=1)break;let o=r.childNodes[n];if(Zh(o,1))a=r,i=++n;else break}else{if(QF(r))break;{let o=r.nextSibling;for(;o&&Zh(o,1);)a=o.parentNode,i=Wn(o)+1,o=o.nextSibling;if(o)r=o,n=0,s=gg(r);else{if(r=r.parentNode,r==e.dom)break;n=s=0}}}a&&Q_(e,a,i)}function QF(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function $fe(e,t){for(;e&&t==e.childNodes.length&&!lp(e);)t=Wn(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let r=e.childNodes[t];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;e=r,t=0}}function Gfe(e,t){for(;e&&!t&&!lp(e);)t=Wn(e),e=e.parentNode;for(;e&&t;){let r=e.childNodes[t-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;e=r,t=e.childNodes.length}}function Q_(e,t,r){if(t.nodeType!=3){let a,i;(i=$fe(t,r))?(t=i,r=0):(a=Gfe(t,r))&&(t=a,r=a.nodeValue.length)}let n=e.domSelection();if(!n)return;if(L1(n)){let a=document.createRange();a.setEnd(t,r),a.setStart(t,r),n.removeAllRanges(),n.addRange(a)}else n.extend&&n.extend(t,r);e.domObserver.setCurSelection();let{state:s}=e;setTimeout(()=>{e.state==s&&Ro(e)},50)}function ER(e,t){let r=e.state.doc.resolve(t);if(!(Yn||LF)&&r.parent.inlineContent){let s=e.coordsAtPos(t);if(t>r.start()){let a=e.coordsAtPos(t-1),i=(a.top+a.bottom)/2;if(i>s.top&&i<s.bottom&&Math.abs(a.left-s.left)>1)return a.left<s.left?"ltr":"rtl"}if(t<r.end()){let a=e.coordsAtPos(t+1),i=(a.top+a.bottom)/2;if(i>s.top&&i<s.bottom&&Math.abs(a.left-s.left)>1)return a.left>s.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function SR(e,t,r){let n=e.state.selection;if(n instanceof St&&!n.empty||r.indexOf("s")>-1||Ma&&r.indexOf("m")>-1)return!1;let{$from:s,$to:a}=n;if(!s.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let i=Z_(e.state,t);if(i&&i instanceof xt)return vl(e,i)}if(!s.parent.inlineContent){let i=t<0?s:a,o=n instanceof oa?It.near(i,t):It.findFrom(i,t);return o?vl(e,o):!1}return!1}function NR(e,t){if(!(e.state.selection instanceof St))return!0;let{$head:r,$anchor:n,empty:s}=e.state.selection;if(!r.sameParent(n))return!0;if(!s)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let a=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(a&&!a.isText){let i=e.state.tr;return t<0?i.delete(r.pos-a.nodeSize,r.pos):i.delete(r.pos,r.pos+a.nodeSize),e.dispatch(i),!0}return!1}function TR(e,t,r){e.domObserver.stop(),t.contentEditable=r,e.domObserver.start()}function Kfe(e){if(!hs||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:r}=e.domSelectionRange();if(t&&t.nodeType==1&&r==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let n=t.firstChild;TR(e,n,"true"),setTimeout(()=>TR(e,n,"false"),20)}return!1}function Xfe(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function Yfe(e,t){let r=t.keyCode,n=Xfe(t);if(r==8||Ma&&r==72&&n=="c")return NR(e,-1)||sf(e,-1);if(r==46&&!t.shiftKey||Ma&&r==68&&n=="c")return NR(e,1)||sf(e,1);if(r==13||r==27)return!0;if(r==37||Ma&&r==66&&n=="c"){let s=r==37?ER(e,e.state.selection.from)=="ltr"?-1:1:-1;return _R(e,s,n)||sf(e,s)}else if(r==39||Ma&&r==70&&n=="c"){let s=r==39?ER(e,e.state.selection.from)=="ltr"?1:-1:1;return _R(e,s,n)||sf(e,s)}else{if(r==38||Ma&&r==80&&n=="c")return SR(e,-1,n)||sf(e,-1);if(r==40||Ma&&r==78&&n=="c")return Kfe(e)||SR(e,1,n)||sf(e,1);if(n==(Ma?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function tN(e,t){e.someProp("transformCopied",g=>{t=g(t,e)});let r=[],{content:n,openStart:s,openEnd:a}=t;for(;s>1&&a>1&&n.childCount==1&&n.firstChild.childCount==1;){s--,a--;let g=n.firstChild;r.push(g.type.name,g.attrs!=g.type.defaultAttrs?g.attrs:null),n=g.content}let i=e.someProp("clipboardSerializer")||xu.fromSchema(e.state.schema),o=aP(),c=o.createElement("div");c.appendChild(i.serializeFragment(n,{document:o}));let f=c.firstChild,h,p=0;for(;f&&f.nodeType==1&&(h=sP[f.nodeName.toLowerCase()]);){for(let g=h.length-1;g>=0;g--){let v=o.createElement(h[g]);for(;c.firstChild;)v.appendChild(c.firstChild);c.appendChild(v),p++}f=c.firstChild}f&&f.nodeType==1&&f.setAttribute("data-pm-slice",`${s} ${a}${p?` -${p}`:""} ${JSON.stringify(r)}`);let x=e.someProp("clipboardTextSerializer",g=>g(t,e))||t.content.textBetween(0,t.content.size,`

`);return{dom:c,text:x,slice:t}}function eP(e,t,r,n,s){let a=s.parent.type.spec.code,i,o;if(!r&&!t)return null;let c=!!t&&(n||a||!r);if(c){if(e.someProp("transformPastedText",x=>{t=x(t,a||n,e)}),a)return o=new it(Ke.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),e.someProp("transformPasted",x=>{o=x(o,e,!0)}),o;let p=e.someProp("clipboardTextParser",x=>x(t,s,n,e));if(p)o=p;else{let x=s.marks(),{schema:g}=e.state,v=xu.fromSchema(g);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(y=>{let w=i.appendChild(document.createElement("p"));y&&w.appendChild(v.serializeNode(g.text(y,x)))})}}else e.someProp("transformPastedHTML",p=>{r=p(r,e)}),i=ede(r),cp&&tde(i);let f=i&&i.querySelector("[data-pm-slice]"),h=f&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(f.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let p=+h[3];p>0;p--){let x=i.firstChild;for(;x&&x.nodeType!=1;)x=x.nextSibling;if(!x)break;i=x}if(o||(o=(e.someProp("clipboardParser")||e.someProp("domParser")||Dl.fromSchema(e.state.schema)).parseSlice(i,{preserveWhitespace:!!(c||h),context:s,ruleFromNode(x){return x.nodeName=="BR"&&!x.nextSibling&&x.parentNode&&!Jfe.test(x.parentNode.nodeName)?{ignore:!0}:null}})),h)o=rde(kR(o,+h[1],+h[2]),h[4]);else if(o=it.maxOpen(Zfe(o.content,s),!0),o.openStart||o.openEnd){let p=0,x=0;for(let g=o.content.firstChild;p<o.openStart&&!g.type.spec.isolating;p++,g=g.firstChild);for(let g=o.content.lastChild;x<o.openEnd&&!g.type.spec.isolating;x++,g=g.lastChild);o=kR(o,p,x)}return e.someProp("transformPasted",p=>{o=p(o,e,c)}),o}const Jfe=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Zfe(e,t){if(e.childCount<2)return e;for(let r=t.depth;r>=0;r--){let s=t.node(r).contentMatchAt(t.index(r)),a,i=[];if(e.forEach(o=>{if(!i)return;let c=s.findWrapping(o.type),f;if(!c)return i=null;if(f=i.length&&a.length&&rP(c,a,o,i[i.length-1],0))i[i.length-1]=f;else{i.length&&(i[i.length-1]=nP(i[i.length-1],a.length));let h=tP(o,c);i.push(h),s=s.matchType(h.type),a=c}}),i)return Ke.from(i)}return e}function tP(e,t,r=0){for(let n=t.length-1;n>=r;n--)e=t[n].create(null,Ke.from(e));return e}function rP(e,t,r,n,s){if(s<e.length&&s<t.length&&e[s]==t[s]){let a=rP(e,t,r,n.lastChild,s+1);if(a)return n.copy(n.content.replaceChild(n.childCount-1,a));if(n.contentMatchAt(n.childCount).matchType(s==e.length-1?r.type:e[s+1]))return n.copy(n.content.append(Ke.from(tP(r,e,s+1))))}}function nP(e,t){if(t==0)return e;let r=e.content.replaceChild(e.childCount-1,nP(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(Ke.empty,!0);return e.copy(r.append(n))}function eE(e,t,r,n,s,a){let i=t<0?e.firstChild:e.lastChild,o=i.content;return e.childCount>1&&(a=0),s<n-1&&(o=eE(o,t,r,n,s+1,a)),s>=r&&(o=t<0?i.contentMatchAt(0).fillBefore(o,a<=s).append(o):o.append(i.contentMatchAt(i.childCount).fillBefore(Ke.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,i.copy(o))}function kR(e,t,r){return t<e.openStart&&(e=new it(eE(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),r<e.openEnd&&(e=new it(eE(e.content,1,r,e.openEnd,0,0),e.openStart,r)),e}const sP={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let AR=null;function aP(){return AR||(AR=document.implementation.createHTMLDocument("title"))}let ew=null;function Qfe(e){let t=window.trustedTypes;return t?(ew||(ew=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),ew.createHTML(e)):e}function ede(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let r=aP().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(e),s;if((s=n&&sP[n[1].toLowerCase()])&&(e=s.map(a=>"<"+a+">").join("")+e+s.map(a=>"</"+a+">").reverse().join("")),r.innerHTML=Qfe(e),s)for(let a=0;a<s.length;a++)r=r.querySelector(s[a])||r;return r}function tde(e){let t=e.querySelectorAll(Yn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<t.length;r++){let n=t[r];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}function rde(e,t){if(!e.size)return e;let r=e.content.firstChild.type.schema,n;try{n=JSON.parse(t)}catch{return e}let{content:s,openStart:a,openEnd:i}=e;for(let o=n.length-2;o>=0;o-=2){let c=r.nodes[n[o]];if(!c||c.hasRequiredAttrs())break;s=Ke.from(c.create(n[o+1],s)),a++,i++}return new it(s,a,i)}const Ns={},Ts={},nde={touchstart:!0,touchmove:!0};class sde{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ade(e){for(let t in Ns){let r=Ns[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=n=>{ode(e,n)&&!rN(e,n)&&(e.editable||!(n.type in Ts))&&r(e,n)},nde[t]?{passive:!0}:void 0)}hs&&e.dom.addEventListener("input",()=>null),tE(e)}function Ol(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function ide(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function tE(e){e.someProp("handleDOMEvents",t=>{for(let r in t)e.input.eventHandlers[r]||e.dom.addEventListener(r,e.input.eventHandlers[r]=n=>rN(e,n))})}function rN(e,t){return e.someProp("handleDOMEvents",r=>{let n=r[t.type];return n?n(e,t)||t.defaultPrevented:!1})}function ode(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let r=t.target;r!=e.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(t))return!1;return!0}function lde(e,t){!rN(e,t)&&Ns[t.type]&&(e.editable||!(t.type in Ts))&&Ns[t.type](e,t)}Ts.keydown=(e,t)=>{let r=t;if(e.input.shiftKey=r.keyCode==16||r.shiftKey,!oP(e,r)&&(e.input.lastKeyCode=r.keyCode,e.input.lastKeyCodeTime=Date.now(),!(wo&&Yn&&r.keyCode==13)))if(r.keyCode!=229&&e.domObserver.forceFlush(),zf&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();e.input.lastIOSEnter=n,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==n&&(e.someProp("handleKeyDown",s=>s(e,Ec(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",n=>n(e,r))||Yfe(e,r)?r.preventDefault():Ol(e,"key")};Ts.keyup=(e,t)=>{t.keyCode==16&&(e.input.shiftKey=!1)};Ts.keypress=(e,t)=>{let r=t;if(oP(e,r)||!r.charCode||r.ctrlKey&&!r.altKey||Ma&&r.metaKey)return;if(e.someProp("handleKeyPress",s=>s(e,r))){r.preventDefault();return}let n=e.state.selection;if(!(n instanceof St)||!n.$from.sameParent(n.$to)){let s=String.fromCharCode(r.charCode),a=()=>e.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!e.someProp("handleTextInput",i=>i(e,n.$from.pos,n.$to.pos,s,a))&&e.dispatch(a()),r.preventDefault()}};function U1(e){return{left:e.clientX,top:e.clientY}}function cde(e,t){let r=t.x-e.clientX,n=t.y-e.clientY;return r*r+n*n<100}function nN(e,t,r,n,s){if(n==-1)return!1;let a=e.state.doc.resolve(n);for(let i=a.depth+1;i>0;i--)if(e.someProp(t,o=>i>a.depth?o(e,r,a.nodeAfter,a.before(i),s,!0):o(e,r,a.node(i),a.before(i),s,!1)))return!0;return!1}function wf(e,t,r){if(e.focused||e.focus(),e.state.selection.eq(t))return;let n=e.state.tr.setSelection(t);n.setMeta("pointer",!0),e.dispatch(n)}function ude(e,t){if(t==-1)return!1;let r=e.state.doc.resolve(t),n=r.nodeAfter;return n&&n.isAtom&&xt.isSelectable(n)?(wf(e,new xt(r)),!0):!1}function fde(e,t){if(t==-1)return!1;let r=e.state.selection,n,s;r instanceof xt&&(n=r.node);let a=e.state.doc.resolve(t);for(let i=a.depth+1;i>0;i--){let o=i>a.depth?a.nodeAfter:a.node(i);if(xt.isSelectable(o)){n&&r.$from.depth>0&&i>=r.$from.depth&&a.before(r.$from.depth+1)==r.$from.pos?s=a.before(r.$from.depth):s=a.before(i);break}}return s!=null?(wf(e,xt.create(e.state.doc,s)),!0):!1}function dde(e,t,r,n,s){return nN(e,"handleClickOn",t,r,n)||e.someProp("handleClick",a=>a(e,t,n))||(s?fde(e,r):ude(e,r))}function hde(e,t,r,n){return nN(e,"handleDoubleClickOn",t,r,n)||e.someProp("handleDoubleClick",s=>s(e,t,n))}function pde(e,t,r,n){return nN(e,"handleTripleClickOn",t,r,n)||e.someProp("handleTripleClick",s=>s(e,t,n))||mde(e,r,n)}function mde(e,t,r){if(r.button!=0)return!1;let n=e.state.doc;if(t==-1)return n.inlineContent?(wf(e,St.create(n,0,n.content.size)),!0):!1;let s=n.resolve(t);for(let a=s.depth+1;a>0;a--){let i=a>s.depth?s.nodeAfter:s.node(a),o=s.before(a);if(i.inlineContent)wf(e,St.create(n,o+1,o+1+i.content.size));else if(xt.isSelectable(i))wf(e,xt.create(n,o));else continue;return!0}}function sN(e){return yg(e)}const iP=Ma?"metaKey":"ctrlKey";Ns.mousedown=(e,t)=>{let r=t;e.input.shiftKey=r.shiftKey;let n=sN(e),s=Date.now(),a="singleClick";s-e.input.lastClick.time<500&&cde(r,e.input.lastClick)&&!r[iP]&&e.input.lastClick.button==r.button&&(e.input.lastClick.type=="singleClick"?a="doubleClick":e.input.lastClick.type=="doubleClick"&&(a="tripleClick")),e.input.lastClick={time:s,x:r.clientX,y:r.clientY,type:a,button:r.button};let i=e.posAtCoords(U1(r));i&&(a=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new xde(e,i,r,!!n)):(a=="doubleClick"?hde:pde)(e,i.pos,i.inside,r)?r.preventDefault():Ol(e,"pointer"))};class xde{constructor(t,r,n,s){this.view=t,this.pos=r,this.event=n,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[iP],this.allowDefault=n.shiftKey;let a,i;if(r.inside>-1)a=t.state.doc.nodeAt(r.inside),i=r.inside;else{let h=t.state.doc.resolve(r.pos);a=h.parent,i=h.depth?h.before():0}const o=s?null:n.target,c=o?t.docView.nearestDesc(o,!0):null;this.target=c&&c.nodeDOM.nodeType==1?c.nodeDOM:null;let{selection:f}=t.state;(n.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||f instanceof xt&&f.from<=i&&f.to>i)&&(this.mightDrag={node:a,pos:i,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ba&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Ol(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ro(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(U1(t))),this.updateAllowDefault(t),this.allowDefault||!r?Ol(this.view,"pointer"):dde(this.view,r.pos,r.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||hs&&this.mightDrag&&!this.mightDrag.node.isAtom||Yn&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(wf(this.view,It.near(this.view.state.doc.resolve(r.pos))),t.preventDefault()):Ol(this.view,"pointer")}move(t){this.updateAllowDefault(t),Ol(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}Ns.touchstart=e=>{e.input.lastTouch=Date.now(),sN(e),Ol(e,"pointer")};Ns.touchmove=e=>{e.input.lastTouch=Date.now(),Ol(e,"pointer")};Ns.contextmenu=e=>sN(e);function oP(e,t){return e.composing?!0:hs&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}const gde=wo?5e3:-1;Ts.compositionstart=Ts.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,r=t.selection.$to;if(t.selection instanceof St&&(t.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)||Yn&&LF&&yde(e)))e.markCursor=e.state.storedMarks||r.marks(),yg(e,!0),e.markCursor=null;else if(yg(e,!t.selection.empty),Ba&&t.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=e.domSelectionRange();for(let s=n.focusNode,a=n.focusOffset;s&&s.nodeType==1&&a!=0;){let i=a<0?s.lastChild:s.childNodes[a-1];if(!i)break;if(i.nodeType==3){let o=e.domSelection();o&&o.collapse(i,i.nodeValue.length);break}else s=i,a=-1}}e.input.composing=!0}lP(e,gde)};function yde(e){let{focusNode:t,focusOffset:r}=e.domSelectionRange();if(!t||t.nodeType!=1||r>=t.childNodes.length)return!1;let n=t.childNodes[r];return n.nodeType==1&&n.contentEditable=="false"}Ts.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.badSafariComposition?e.domObserver.forceFlush():e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,lP(e,20))};function lP(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>yg(e),t))}function cP(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=bde());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function vde(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let r=ffe(t.focusNode,t.focusOffset),n=dfe(t.focusNode,t.focusOffset);if(r&&n&&r!=n){let s=n.pmViewDesc,a=e.domObserver.lastChangedTextNode;if(r==a||n==a)return a;if(!s||!s.isText(n.nodeValue))return n;if(e.input.compositionNode==n){let i=r.pmViewDesc;if(!(!i||!i.isText(r.nodeValue)))return n}}return r||n}function bde(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function yg(e,t=!1){if(!(wo&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),cP(e),t||e.docView&&e.docView.dirty){let r=QS(e),n=e.state.selection;return r&&!r.eq(n)?e.dispatch(e.state.tr.setSelection(r)):(e.markCursor||t)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}function wde(e,t){if(!e.dom.parentNode)return;let r=e.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(t),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),s=document.createRange();s.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(s),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),e.focus()},50)}const R0=Us&&Il<15||zf&&xfe<604;Ns.copy=Ts.cut=(e,t)=>{let r=t,n=e.state.selection,s=r.type=="cut";if(n.empty)return;let a=R0?null:r.clipboardData,i=n.content(),{dom:o,text:c}=tN(e,i);a?(r.preventDefault(),a.clearData(),a.setData("text/html",o.innerHTML),a.setData("text/plain",c)):wde(e,o),s&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function _de(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function Ede(e,t){if(!e.dom.parentNode)return;let r=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let s=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),r?O0(e,n.value,null,s,t):O0(e,n.textContent,n.innerHTML,s,t)},50)}function O0(e,t,r,n,s){let a=eP(e,t,r,n,e.state.selection.$from);if(e.someProp("handlePaste",c=>c(e,s,a||it.empty)))return!0;if(!a)return!1;let i=_de(a),o=i?e.state.tr.replaceSelectionWith(i,n):e.state.tr.replaceSelection(a);return e.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function uP(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let r=e.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}Ts.paste=(e,t)=>{let r=t;if(e.composing&&!wo)return;let n=R0?null:r.clipboardData,s=e.input.shiftKey&&e.input.lastKeyCode!=45;n&&O0(e,uP(n),n.getData("text/html"),s,r)?r.preventDefault():Ede(e,r)};class fP{constructor(t,r,n){this.slice=t,this.move=r,this.node=n}}const Sde=Ma?"altKey":"ctrlKey";function dP(e,t){let r=e.someProp("dragCopies",n=>!n(t));return r??!t[Sde]}Ns.dragstart=(e,t)=>{let r=t,n=e.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let s=e.state.selection,a=s.empty?null:e.posAtCoords(U1(r)),i;if(!(a&&a.pos>=s.from&&a.pos<=(s instanceof xt?s.to-1:s.to))){if(n&&n.mightDrag)i=xt.create(e.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let p=e.docView.nearestDesc(r.target,!0);p&&p.node.type.spec.draggable&&p!=e.docView&&(i=xt.create(e.state.doc,p.posBefore))}}let o=(i||e.state.selection).content(),{dom:c,text:f,slice:h}=tN(e,o);(!r.dataTransfer.files.length||!Yn||PF>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(R0?"Text":"text/html",c.innerHTML),r.dataTransfer.effectAllowed="copyMove",R0||r.dataTransfer.setData("text/plain",f),e.dragging=new fP(h,dP(e,r),i)};Ns.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)};Ts.dragover=Ts.dragenter=(e,t)=>t.preventDefault();Ts.drop=(e,t)=>{try{Nde(e,t,e.dragging)}finally{e.dragging=null}};function Nde(e,t,r){if(!t.dataTransfer)return;let n=e.posAtCoords(U1(t));if(!n)return;let s=e.state.doc.resolve(n.pos),a=r&&r.slice;a?e.someProp("transformPasted",g=>{a=g(a,e,!1)}):a=eP(e,uP(t.dataTransfer),R0?null:t.dataTransfer.getData("text/html"),!1,s);let i=!!(r&&dP(e,t));if(e.someProp("handleDrop",g=>g(e,t,a||it.empty,i))){t.preventDefault();return}if(!a)return;t.preventDefault();let o=a?xF(e.state.doc,s.pos,a):s.pos;o==null&&(o=s.pos);let c=e.state.tr;if(i){let{node:g}=r;g?g.replace(c):c.deleteSelection()}let f=c.mapping.map(o),h=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,p=c.doc;if(h?c.replaceRangeWith(f,f,a.content.firstChild):c.replaceRange(f,f,a),c.doc.eq(p))return;let x=c.doc.resolve(f);if(h&&xt.isSelectable(a.content.firstChild)&&x.nodeAfter&&x.nodeAfter.sameMarkup(a.content.firstChild))c.setSelection(new xt(x));else{let g=c.mapping.map(o);c.mapping.maps[c.mapping.maps.length-1].forEach((v,y,w,_)=>g=_),c.setSelection(eN(e,x,c.doc.resolve(g)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))}Ns.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Ro(e)},20))};Ns.blur=(e,t)=>{let r=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),r.relatedTarget&&e.dom.contains(r.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};Ns.beforeinput=(e,t)=>{if(Yn&&wo&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:n}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=n||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",a=>a(e,Ec(8,"Backspace")))))return;let{$cursor:s}=e.state.selection;s&&s.pos>0&&e.dispatch(e.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let e in Ts)Ns[e]=Ts[e];function j0(e,t){if(e==t)return!0;for(let r in e)if(e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0}class vg{constructor(t,r){this.toDOM=t,this.spec=r||zc,this.side=this.spec.side||0}map(t,r,n,s){let{pos:a,deleted:i}=t.mapResult(r.from+s,this.side<0?-1:1);return i?null:new ws(a-n,a-n,this)}valid(){return!0}eq(t){return this==t||t instanceof vg&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&j0(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Fl{constructor(t,r){this.attrs=t,this.spec=r||zc}map(t,r,n,s){let a=t.map(r.from+s,this.spec.inclusiveStart?-1:1)-n,i=t.map(r.to+s,this.spec.inclusiveEnd?1:-1)-n;return a>=i?null:new ws(a,i,this)}valid(t,r){return r.from<r.to}eq(t){return this==t||t instanceof Fl&&j0(this.attrs,t.attrs)&&j0(this.spec,t.spec)}static is(t){return t.type instanceof Fl}destroy(){}}class aN{constructor(t,r){this.attrs=t,this.spec=r||zc}map(t,r,n,s){let a=t.mapResult(r.from+s,1);if(a.deleted)return null;let i=t.mapResult(r.to+s,-1);return i.deleted||i.pos<=a.pos?null:new ws(a.pos-n,i.pos-n,this)}valid(t,r){let{index:n,offset:s}=t.content.findIndex(r.from),a;return s==r.from&&!(a=t.child(n)).isText&&s+a.nodeSize==r.to}eq(t){return this==t||t instanceof aN&&j0(this.attrs,t.attrs)&&j0(this.spec,t.spec)}destroy(){}}class ws{constructor(t,r,n){this.from=t,this.to=r,this.type=n}copy(t,r){return new ws(t,r,this.type)}eq(t,r=0){return this.type.eq(t.type)&&this.from+r==t.from&&this.to+r==t.to}map(t,r,n){return this.type.map(t,this,r,n)}static widget(t,r,n){return new ws(t,t,new vg(r,n))}static inline(t,r,n,s){return new ws(t,r,new Fl(n,s))}static node(t,r,n,s){return new ws(t,r,new aN(n,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Fl}get widget(){return this.type instanceof vg}}const uf=[],zc={};class jr{constructor(t,r){this.local=t.length?t:uf,this.children=r.length?r:uf}static create(t,r){return r.length?bg(r,t,0,zc):ss}find(t,r,n){let s=[];return this.findInner(t??0,r??1e9,s,0,n),s}findInner(t,r,n,s,a){for(let i=0;i<this.local.length;i++){let o=this.local[i];o.from<=r&&o.to>=t&&(!a||a(o.spec))&&n.push(o.copy(o.from+s,o.to+s))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<r&&this.children[i+1]>t){let o=this.children[i]+1;this.children[i+2].findInner(t-o,r-o,n,s+o,a)}}map(t,r,n){return this==ss||t.maps.length==0?this:this.mapInner(t,r,0,0,n||zc)}mapInner(t,r,n,s,a){let i;for(let o=0;o<this.local.length;o++){let c=this.local[o].map(t,n,s);c&&c.type.valid(r,c)?(i||(i=[])).push(c):a.onRemove&&a.onRemove(this.local[o].spec)}return this.children.length?Tde(this.children,i||[],t,r,n,s,a):i?new jr(i.sort(Hc),uf):ss}add(t,r){return r.length?this==ss?jr.create(t,r):this.addInner(t,r,0):this}addInner(t,r,n){let s,a=0;t.forEach((o,c)=>{let f=c+n,h;if(h=pP(r,o,f)){for(s||(s=this.children.slice());a<s.length&&s[a]<c;)a+=3;s[a]==c?s[a+2]=s[a+2].addInner(o,h,f+1):s.splice(a,0,c,c+o.nodeSize,bg(h,o,f+1,zc)),a+=3}});let i=hP(a?mP(r):r,-n);for(let o=0;o<i.length;o++)i[o].type.valid(t,i[o])||i.splice(o--,1);return new jr(i.length?this.local.concat(i).sort(Hc):this.local,s||this.children)}remove(t){return t.length==0||this==ss?this:this.removeInner(t,0)}removeInner(t,r){let n=this.children,s=this.local;for(let a=0;a<n.length;a+=3){let i,o=n[a]+r,c=n[a+1]+r;for(let h=0,p;h<t.length;h++)(p=t[h])&&p.from>o&&p.to<c&&(t[h]=null,(i||(i=[])).push(p));if(!i)continue;n==this.children&&(n=this.children.slice());let f=n[a+2].removeInner(i,o+1);f!=ss?n[a+2]=f:(n.splice(a,3),a-=3)}if(s.length){for(let a=0,i;a<t.length;a++)if(i=t[a])for(let o=0;o<s.length;o++)s[o].eq(i,r)&&(s==this.local&&(s=this.local.slice()),s.splice(o--,1))}return n==this.children&&s==this.local?this:s.length||n.length?new jr(s,n):ss}forChild(t,r){if(this==ss)return this;if(r.isLeaf)return jr.empty;let n,s;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(n=this.children[o+2]);break}let a=t+1,i=a+r.content.size;for(let o=0;o<this.local.length;o++){let c=this.local[o];if(c.from<i&&c.to>a&&c.type instanceof Fl){let f=Math.max(a,c.from)-a,h=Math.min(i,c.to)-a;f<h&&(s||(s=[])).push(c.copy(f,h))}}if(s){let o=new jr(s.sort(Hc),uf);return n?new El([o,n]):o}return n||ss}eq(t){if(this==t)return!0;if(!(t instanceof jr)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(t.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=t.children[r]||this.children[r+1]!=t.children[r+1]||!this.children[r+2].eq(t.children[r+2]))return!1;return!0}locals(t){return iN(this.localsInner(t))}localsInner(t){if(this==ss)return uf;if(t.inlineContent||!this.local.some(Fl.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Fl||r.push(this.local[n]);return r}forEachSet(t){t(this)}}jr.empty=new jr([],[]);jr.removeOverlap=iN;const ss=jr.empty;class El{constructor(t){this.members=t}map(t,r){const n=this.members.map(s=>s.map(t,r,zc));return El.from(n)}forChild(t,r){if(r.isLeaf)return jr.empty;let n=[];for(let s=0;s<this.members.length;s++){let a=this.members[s].forChild(t,r);a!=ss&&(a instanceof El?n=n.concat(a.members):n.push(a))}return El.from(n)}eq(t){if(!(t instanceof El)||t.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(t.members[r]))return!1;return!0}locals(t){let r,n=!0;for(let s=0;s<this.members.length;s++){let a=this.members[s].localsInner(t);if(a.length)if(!r)r=a;else{n&&(r=r.slice(),n=!1);for(let i=0;i<a.length;i++)r.push(a[i])}}return r?iN(n?r:r.sort(Hc)):uf}static from(t){switch(t.length){case 0:return ss;case 1:return t[0];default:return new El(t.every(r=>r instanceof jr)?t:t.reduce((r,n)=>r.concat(n instanceof jr?n:n.members),[]))}}forEachSet(t){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(t)}}function Tde(e,t,r,n,s,a,i){let o=e.slice();for(let f=0,h=a;f<r.maps.length;f++){let p=0;r.maps[f].forEach((x,g,v,y)=>{let w=y-v-(g-x);for(let _=0;_<o.length;_+=3){let S=o[_+1];if(S<0||x>S+h-p)continue;let E=o[_]+h-p;g>=E?o[_+1]=x<=E?-2:-1:x>=h&&w&&(o[_]+=w,o[_+1]+=w)}p+=w}),h=r.maps[f].map(h,-1)}let c=!1;for(let f=0;f<o.length;f+=3)if(o[f+1]<0){if(o[f+1]==-2){c=!0,o[f+1]=-1;continue}let h=r.map(e[f]+a),p=h-s;if(p<0||p>=n.content.size){c=!0;continue}let x=r.map(e[f+1]+a,-1),g=x-s,{index:v,offset:y}=n.content.findIndex(p),w=n.maybeChild(v);if(w&&y==p&&y+w.nodeSize==g){let _=o[f+2].mapInner(r,w,h+1,e[f]+a+1,i);_!=ss?(o[f]=p,o[f+1]=g,o[f+2]=_):(o[f+1]=-2,c=!0)}else c=!0}if(c){let f=kde(o,e,t,r,s,a,i),h=bg(f,n,0,i);t=h.local;for(let p=0;p<o.length;p+=3)o[p+1]<0&&(o.splice(p,3),p-=3);for(let p=0,x=0;p<h.children.length;p+=3){let g=h.children[p];for(;x<o.length&&o[x]<g;)x+=3;o.splice(x,0,h.children[p],h.children[p+1],h.children[p+2])}}return new jr(t.sort(Hc),o)}function hP(e,t){if(!t||!e.length)return e;let r=[];for(let n=0;n<e.length;n++){let s=e[n];r.push(new ws(s.from+t,s.to+t,s.type))}return r}function kde(e,t,r,n,s,a,i){function o(c,f){for(let h=0;h<c.local.length;h++){let p=c.local[h].map(n,s,f);p?r.push(p):i.onRemove&&i.onRemove(c.local[h].spec)}for(let h=0;h<c.children.length;h+=3)o(c.children[h+2],c.children[h]+f+1)}for(let c=0;c<e.length;c+=3)e[c+1]==-1&&o(e[c+2],t[c]+a+1);return r}function pP(e,t,r){if(t.isLeaf)return null;let n=r+t.nodeSize,s=null;for(let a=0,i;a<e.length;a++)(i=e[a])&&i.from>r&&i.to<n&&((s||(s=[])).push(i),e[a]=null);return s}function mP(e){let t=[];for(let r=0;r<e.length;r++)e[r]!=null&&t.push(e[r]);return t}function bg(e,t,r,n){let s=[],a=!1;t.forEach((o,c)=>{let f=pP(e,o,c+r);if(f){a=!0;let h=bg(f,o,r+c+1,n);h!=ss&&s.push(c,c+o.nodeSize,h)}});let i=hP(a?mP(e):e,-r).sort(Hc);for(let o=0;o<i.length;o++)i[o].type.valid(t,i[o])||(n.onRemove&&n.onRemove(i[o].spec),i.splice(o--,1));return i.length||s.length?new jr(i,s):ss}function Hc(e,t){return e.from-t.from||e.to-t.to}function iN(e){let t=e;for(let r=0;r<t.length-1;r++){let n=t[r];if(n.from!=n.to)for(let s=r+1;s<t.length;s++){let a=t[s];if(a.from==n.from){a.to!=n.to&&(t==e&&(t=e.slice()),t[s]=a.copy(a.from,n.to),CR(t,s+1,a.copy(n.to,a.to)));continue}else{a.from<n.to&&(t==e&&(t=e.slice()),t[r]=n.copy(n.from,a.from),CR(t,s,n.copy(a.from,n.to)));break}}}return t}function CR(e,t,r){for(;t<e.length&&Hc(r,e[t])>0;)t++;e.splice(t,0,r)}function tw(e){let t=[];return e.someProp("decorations",r=>{let n=r(e.state);n&&n!=ss&&t.push(n)}),e.cursorWrapper&&t.push(jr.create(e.state.doc,[e.cursorWrapper.deco])),El.from(t)}const Ade={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Cde=Us&&Il<=11;class Rde{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class Ode{constructor(t,r){this.view=t,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Rde,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let s=0;s<n.length;s++)this.queue.push(n[s]);Us&&Il<=11&&n.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():hs&&t.composing&&n.some(s=>s.type=="childList"&&s.target.nodeName=="TR")?(t.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),Cde&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Ade)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let r=0;r<t.length;r++)this.queue.push(t[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(wR(this.view)){if(this.suppressingSelectionUpdates)return Ro(this.view);if(Us&&Il<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&su(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let r=new Set,n;for(let a=t.focusNode;a;a=Uf(a))r.add(a);for(let a=t.anchorNode;a;a=Uf(a))if(r.has(a)){n=a;break}let s=n&&this.view.docView.nearestDesc(n);if(s&&s.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=t.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&wR(t)&&!this.ignoreSelectionChange(n),a=-1,i=-1,o=!1,c=[];if(t.editable)for(let h=0;h<r.length;h++){let p=this.registerMutation(r[h],c);p&&(a=a<0?p.from:Math.min(p.from,a),i=i<0?p.to:Math.max(p.to,i),p.typeOver&&(o=!0))}if(c.some(h=>h.nodeName=="BR")&&(t.input.lastKeyCode==8||t.input.lastKeyCode==46)){for(let h of c)if(h.nodeName=="BR"&&h.parentNode){let p=h.nextSibling;p&&p.nodeType==1&&p.contentEditable=="false"&&h.parentNode.removeChild(h)}}else if(Ba&&c.length){let h=c.filter(p=>p.nodeName=="BR");if(h.length==2){let[p,x]=h;p.parentNode&&p.parentNode.parentNode==x.parentNode?x.remove():p.remove()}else{let{focusNode:p}=this.currentSelection;for(let x of h){let g=x.parentNode;g&&g.nodeName=="LI"&&(!p||Ide(t,p)!=g)&&x.remove()}}}let f=null;a<0&&s&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&L1(n)&&(f=QS(t))&&f.eq(It.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Ro(t),this.currentSelection.set(n),t.scrollToSelection()):(a>-1||s)&&(a>-1&&(t.docView.markDirty(a,i),jde(t)),t.input.badSafariComposition&&(t.input.badSafariComposition=!1,Mde(t,c)),this.handleDOMChange(a,i,o,c),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||Ro(t),this.currentSelection.set(n))}registerMutation(t,r){if(r.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(n==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!n||n.ignoreMutation(t))return null;if(t.type=="childList"){for(let h=0;h<t.addedNodes.length;h++){let p=t.addedNodes[h];r.push(p),p.nodeType==3&&(this.lastChangedTextNode=p)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let s=t.previousSibling,a=t.nextSibling;if(Us&&Il<=11&&t.addedNodes.length)for(let h=0;h<t.addedNodes.length;h++){let{previousSibling:p,nextSibling:x}=t.addedNodes[h];(!p||Array.prototype.indexOf.call(t.addedNodes,p)<0)&&(s=p),(!x||Array.prototype.indexOf.call(t.addedNodes,x)<0)&&(a=x)}let i=s&&s.parentNode==t.target?Wn(s)+1:0,o=n.localPosFromDOM(t.target,i,-1),c=a&&a.parentNode==t.target?Wn(a):t.target.childNodes.length,f=n.localPosFromDOM(t.target,c,1);return{from:o,to:f}}else return t.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let RR=new WeakMap,OR=!1;function jde(e){if(!RR.has(e)&&(RR.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=Ba,OR)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),OR=!0}}function jR(e,t){let r=t.startContainer,n=t.startOffset,s=t.endContainer,a=t.endOffset,i=e.domAtPos(e.state.selection.anchor);return su(i.node,i.offset,s,a)&&([r,n,s,a]=[s,a,r,n]),{anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:a}}function Dde(e,t){if(t.getComposedRanges){let s=t.getComposedRanges(e.root)[0];if(s)return jR(e,s)}let r;function n(s){s.preventDefault(),s.stopImmediatePropagation(),r=s.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0),r?jR(e,r):null}function Ide(e,t){for(let r=t.parentNode;r&&r!=e.dom;r=r.parentNode){let n=e.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function Mde(e,t){var r;let{focusNode:n,focusOffset:s}=e.domSelectionRange();for(let a of t)if(((r=a.parentNode)===null||r===void 0?void 0:r.nodeName)=="TR"){let i=a.nextSibling;for(;i&&i.nodeName!="TD"&&i.nodeName!="TH";)i=i.nextSibling;if(i){let o=i;for(;;){let c=o.firstChild;if(!c||c.nodeType!=1||c.contentEditable=="false"||/^(BR|IMG)$/.test(c.nodeName))break;o=c}o.insertBefore(a,o.firstChild),n==a&&e.domSelection().collapse(a,s)}else a.parentNode.removeChild(a)}}function Fde(e,t,r){let{node:n,fromOffset:s,toOffset:a,from:i,to:o}=e.docView.parseRange(t,r),c=e.domSelectionRange(),f,h=c.anchorNode;if(h&&e.dom.contains(h.nodeType==1?h:h.parentNode)&&(f=[{node:h,offset:c.anchorOffset}],L1(c)||f.push({node:c.focusNode,offset:c.focusOffset})),Yn&&e.input.lastKeyCode===8)for(let w=a;w>s;w--){let _=n.childNodes[w-1],S=_.pmViewDesc;if(_.nodeName=="BR"&&!S){a=w;break}if(!S||S.size)break}let p=e.state.doc,x=e.someProp("domParser")||Dl.fromSchema(e.state.schema),g=p.resolve(i),v=null,y=x.parse(n,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:s,to:a,preserveWhitespace:g.parent.type.whitespace=="pre"?"full":!0,findPositions:f,ruleFromNode:Pde,context:g});if(f&&f[0].pos!=null){let w=f[0].pos,_=f[1]&&f[1].pos;_==null&&(_=w),v={anchor:w+i,head:_+i}}return{doc:y,sel:v,from:i,to:o}}function Pde(e){let t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(hs&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(e.parentNode.lastChild==e||hs&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Lde=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Bde(e,t,r,n,s){let a=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let O=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,z=QS(e,O);if(z&&!e.state.selection.eq(z)){if(Yn&&wo&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",J=>J(e,Ec(13,"Enter"))))return;let j=e.state.tr.setSelection(z);O=="pointer"?j.setMeta("pointer",!0):O=="key"&&j.scrollIntoView(),a&&j.setMeta("composition",a),e.dispatch(j)}return}let i=e.state.doc.resolve(t),o=i.sharedDepth(r);t=i.before(o+1),r=e.state.doc.resolve(r).after(o+1);let c=e.state.selection,f=Fde(e,t,r),h=e.state.doc,p=h.slice(f.from,f.to),x,g;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(x=e.state.selection.to,g="end"):(x=e.state.selection.from,g="start"),e.input.lastKeyCode=null;let v=Hde(p.content,f.doc.content,f.from,x,g);if(v&&e.input.domChangeCount++,(zf&&e.input.lastIOSEnter>Date.now()-225||wo)&&s.some(O=>O.nodeType==1&&!Lde.test(O.nodeName))&&(!v||v.endA>=v.endB)&&e.someProp("handleKeyDown",O=>O(e,Ec(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!v)if(n&&c instanceof St&&!c.empty&&c.$head.sameParent(c.$anchor)&&!e.composing&&!(f.sel&&f.sel.anchor!=f.sel.head))v={start:c.from,endA:c.to,endB:c.to};else{if(f.sel){let O=DR(e,e.state.doc,f.sel);if(O&&!O.eq(e.state.selection)){let z=e.state.tr.setSelection(O);a&&z.setMeta("composition",a),e.dispatch(z)}}return}e.state.selection.from<e.state.selection.to&&v.start==v.endB&&e.state.selection instanceof St&&(v.start>e.state.selection.from&&v.start<=e.state.selection.from+2&&e.state.selection.from>=f.from?v.start=e.state.selection.from:v.endA<e.state.selection.to&&v.endA>=e.state.selection.to-2&&e.state.selection.to<=f.to&&(v.endB+=e.state.selection.to-v.endA,v.endA=e.state.selection.to)),Us&&Il<=11&&v.endB==v.start+1&&v.endA==v.start&&v.start>f.from&&f.doc.textBetween(v.start-f.from-1,v.start-f.from+1)==" "&&(v.start--,v.endA--,v.endB--);let y=f.doc.resolveNoCache(v.start-f.from),w=f.doc.resolveNoCache(v.endB-f.from),_=h.resolve(v.start),S=y.sameParent(w)&&y.parent.inlineContent&&_.end()>=v.endA;if((zf&&e.input.lastIOSEnter>Date.now()-225&&(!S||s.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!S&&y.pos<f.doc.content.size&&(!y.sameParent(w)||!y.parent.inlineContent)&&y.pos<w.pos&&!/\S/.test(f.doc.textBetween(y.pos,w.pos,"","")))&&e.someProp("handleKeyDown",O=>O(e,Ec(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>v.start&&zde(h,v.start,v.endA,y,w)&&e.someProp("handleKeyDown",O=>O(e,Ec(8,"Backspace")))){wo&&Yn&&e.domObserver.suppressSelectionUpdates();return}Yn&&v.endB==v.start&&(e.input.lastChromeDelete=Date.now()),wo&&!S&&y.start()!=w.start()&&w.parentOffset==0&&y.depth==w.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==v.endA&&(v.endB-=2,w=f.doc.resolveNoCache(v.endB-f.from),setTimeout(()=>{e.someProp("handleKeyDown",function(O){return O(e,Ec(13,"Enter"))})},20));let E=v.start,T=v.endA,k=O=>{let z=O||e.state.tr.replace(E,T,f.doc.slice(v.start-f.from,v.endB-f.from));if(f.sel){let j=DR(e,z.doc,f.sel);j&&!(Yn&&e.composing&&j.empty&&(v.start!=v.endB||e.input.lastChromeDelete<Date.now()-100)&&(j.head==E||j.head==z.mapping.map(T)-1)||Us&&j.empty&&j.head==E)&&z.setSelection(j)}return a&&z.setMeta("composition",a),z.scrollIntoView()},D;if(S)if(y.pos==w.pos){Us&&Il<=11&&y.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ro(e),20));let O=k(e.state.tr.delete(E,T)),z=h.resolve(v.start).marksAcross(h.resolve(v.endA));z&&O.ensureMarks(z),e.dispatch(O)}else if(v.endA==v.endB&&(D=Ude(y.parent.content.cut(y.parentOffset,w.parentOffset),_.parent.content.cut(_.parentOffset,v.endA-_.start())))){let O=k(e.state.tr);D.type=="add"?O.addMark(E,T,D.mark):O.removeMark(E,T,D.mark),e.dispatch(O)}else if(y.parent.child(y.index()).isText&&y.index()==w.index()-(w.textOffset?0:1)){let O=y.parent.textBetween(y.parentOffset,w.parentOffset),z=()=>k(e.state.tr.insertText(O,E,T));e.someProp("handleTextInput",j=>j(e,E,T,O,z))||e.dispatch(z())}else e.dispatch(k());else e.dispatch(k())}function DR(e,t,r){return Math.max(r.anchor,r.head)>t.content.size?null:eN(e,t.resolve(r.anchor),t.resolve(r.head))}function Ude(e,t){let r=e.firstChild.marks,n=t.firstChild.marks,s=r,a=n,i,o,c;for(let h=0;h<n.length;h++)s=n[h].removeFromSet(s);for(let h=0;h<r.length;h++)a=r[h].removeFromSet(a);if(s.length==1&&a.length==0)o=s[0],i="add",c=h=>h.mark(o.addToSet(h.marks));else if(s.length==0&&a.length==1)o=a[0],i="remove",c=h=>h.mark(o.removeFromSet(h.marks));else return null;let f=[];for(let h=0;h<t.childCount;h++)f.push(c(t.child(h)));if(Ke.from(f).eq(e))return{mark:o,type:i}}function zde(e,t,r,n,s){if(r-t<=s.pos-n.pos||rw(n,!0,!1)<s.pos)return!1;let a=e.resolve(t);if(!n.parent.isTextblock){let o=a.nodeAfter;return o!=null&&r==t+o.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let i=e.resolve(rw(a,!0,!0));return!i.parent.isTextblock||i.pos>r||rw(i,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(i.parent.content)}function rw(e,t,r){let n=e.depth,s=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,s++,t=!1;if(r){let a=e.node(n).maybeChild(e.indexAfter(n));for(;a&&!a.isLeaf;)a=a.firstChild,s++}return s}function Hde(e,t,r,n,s){let a=e.findDiffStart(t,r);if(a==null)return null;let{a:i,b:o}=e.findDiffEnd(t,r+e.size,r+t.size);if(s=="end"){let c=Math.max(0,a-Math.min(i,o));n-=i+c-a}if(i<a&&e.size<t.size){let c=n<=a&&n>=i?a-n:0;a-=c,a&&a<t.size&&IR(t.textBetween(a-1,a+1))&&(a+=c?1:-1),o=a+(o-i),i=a}else if(o<a){let c=n<=a&&n>=o?a-n:0;a-=c,a&&a<e.size&&IR(e.textBetween(a-1,a+1))&&(a+=c?1:-1),i=a+(i-o),o=a}return{start:a,endA:i,endB:o}}function IR(e){if(e.length!=2)return!1;let t=e.charCodeAt(0),r=e.charCodeAt(1);return t>=56320&&t<=57343&&r>=55296&&r<=56319}class xP{constructor(t,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new sde,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(BR),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=PR(this),FR(this),this.nodeViews=LR(this),this.docView=mR(this.state.doc,MR(this),tw(this),this.dom,this),this.domObserver=new Ode(this,(n,s,a,i)=>Bde(this,n,s,a,i)),this.domObserver.start(),ade(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let r in t)this._props[r]=t[r];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&tE(this);let r=this._props;this._props=t,t.plugins&&(t.plugins.forEach(BR),this.directPlugins=t.plugins),this.updateStateInner(t.state,r)}setProps(t){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in t)r[n]=t[n];this.update(r)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,r){var n;let s=this.state,a=!1,i=!1;t.storedMarks&&this.composing&&(cP(this),i=!0),this.state=t;let o=s.plugins!=t.plugins||this._props.plugins!=r.plugins;if(o||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let g=LR(this);qde(g,this.nodeViews)&&(this.nodeViews=g,a=!0)}(o||r.handleDOMEvents!=this._props.handleDOMEvents)&&tE(this),this.editable=PR(this),FR(this);let c=tw(this),f=MR(this),h=s.plugins!=t.plugins&&!s.doc.eq(t.doc)?"reset":t.scrollToSelection>s.scrollToSelection?"to selection":"preserve",p=a||!this.docView.matchesNode(t.doc,f,c);(p||!t.selection.eq(s.selection))&&(i=!0);let x=h=="preserve"&&i&&this.dom.style.overflowAnchor==null&&vfe(this);if(i){this.domObserver.stop();let g=p&&(Us||Yn)&&!this.composing&&!s.selection.empty&&!t.selection.empty&&Vde(s.selection,t.selection);if(p){let v=Yn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=vde(this)),(a||!this.docView.update(t.doc,f,c,this))&&(this.docView.updateOuterDeco(f),this.docView.destroy(),this.docView=mR(t.doc,f,c,this.dom,this)),v&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(g=!0)}g||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Vfe(this))?Ro(this,g):(JF(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((n=this.dragging)===null||n===void 0)&&n.node&&!s.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,s),h=="reset"?this.dom.scrollTop=0:h=="to selection"?this.scrollToSelection():x&&bfe(x)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof xt){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&cR(this,r.getBoundingClientRect(),t)}else cR(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,t)}}updateDraggedNode(t,r){let n=t.node,s=-1;if(this.state.doc.nodeAt(n.from)==n.node)s=n.from;else{let a=n.from+(this.state.doc.content.size-r.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==n.node&&(s=a)}this.dragging=new fP(t.slice,t.move,s<0?void 0:xt.create(this.state.doc,s))}someProp(t,r){let n=this._props&&this._props[t],s;if(n!=null&&(s=r?r(n):n))return s;for(let i=0;i<this.directPlugins.length;i++){let o=this.directPlugins[i].props[t];if(o!=null&&(s=r?r(o):o))return s}let a=this.state.plugins;if(a)for(let i=0;i<a.length;i++){let o=a[i].props[t];if(o!=null&&(s=r?r(o):o))return s}}hasFocus(){if(Us){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&wfe(this.dom),Ro(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return t||document}updateRoot(){this._root=null}posAtCoords(t){return Tfe(this,t)}coordsAtPos(t,r=1){return VF(this,t,r)}domAtPos(t,r=0){return this.docView.domFromPos(t,r)}nodeDOM(t){let r=this.docView.descAt(t);return r?r.nodeDOM:null}posAtDOM(t,r,n=-1){let s=this.docView.posFromDOM(t,r,n);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(t,r){return Ofe(this,r||this.state,t)}pasteHTML(t,r){return O0(this,"",t,!1,r||new ClipboardEvent("paste"))}pasteText(t,r){return O0(this,t,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(t){return tN(this,t)}destroy(){this.docView&&(ide(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],tw(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,cfe())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return lde(this,t)}domSelectionRange(){let t=this.domSelection();return t?hs&&this.root.nodeType===11&&pfe(this.dom.ownerDocument)==this.dom&&Dde(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}xP.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};function MR(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(e.state)),r)for(let n in r)n=="class"?t.class+=" "+r[n]:n=="style"?t.style=(t.style?t.style+";":"")+r[n]:!t[n]&&n!="contenteditable"&&n!="nodeName"&&(t[n]=String(r[n]))}),t.translate||(t.translate="no"),[ws.node(0,e.state.doc.content.size,t)]}function FR(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:ws.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function PR(e){return!e.someProp("editable",t=>t(e.state)===!1)}function Vde(e,t){let r=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(r)!=t.$anchor.start(r)}function LR(e){let t=Object.create(null);function r(n){for(let s in n)Object.prototype.hasOwnProperty.call(t,s)||(t[s]=n[s])}return e.someProp("nodeViews",r),e.someProp("markViews",r),t}function qde(e,t){let r=0,n=0;for(let s in e){if(e[s]!=t[s])return!0;r++}for(let s in t)n++;return r!=n}function BR(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Wl={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},wg={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Wde=typeof navigator<"u"&&/Mac/.test(navigator.platform),$de=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var $n=0;$n<10;$n++)Wl[48+$n]=Wl[96+$n]=String($n);for(var $n=1;$n<=24;$n++)Wl[$n+111]="F"+$n;for(var $n=65;$n<=90;$n++)Wl[$n]=String.fromCharCode($n+32),wg[$n]=String.fromCharCode($n);for(var nw in Wl)wg.hasOwnProperty(nw)||(wg[nw]=Wl[nw]);function Gde(e){var t=Wde&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||$de&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",r=!t&&e.key||(e.shiftKey?wg:Wl)[e.keyCode]||e.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const Kde=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Xde=typeof navigator<"u"&&/Win/.test(navigator.platform);function Yde(e){let t=e.split(/-(?!$)/),r=t[t.length-1];r=="Space"&&(r=" ");let n,s,a,i;for(let o=0;o<t.length-1;o++){let c=t[o];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))Kde?i=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(r="Alt-"+r),s&&(r="Ctrl-"+r),i&&(r="Meta-"+r),a&&(r="Shift-"+r),r}function Jde(e){let t=Object.create(null);for(let r in e)t[Yde(r)]=e[r];return t}function sw(e,t,r=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),r&&t.shiftKey&&(e="Shift-"+e),e}function Zde(e){return new Fr({props:{handleKeyDown:gP(e)}})}function gP(e){let t=Jde(e);return function(r,n){let s=Gde(n),a,i=t[sw(s,n)];if(i&&i(r.state,r.dispatch,r))return!0;if(s.length==1&&s!=" "){if(n.shiftKey){let o=t[sw(s,n,!1)];if(o&&o(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(Xde&&n.ctrlKey&&n.altKey)&&(a=Wl[n.keyCode])&&a!=s){let o=t[sw(a,n)];if(o&&o(r.state,r.dispatch,r))return!0}}return!1}}var Qde=Object.defineProperty,oN=(e,t)=>{for(var r in t)Qde(e,r,{get:t[r],enumerable:!0})};function z1(e){const{state:t,transaction:r}=e;let{selection:n}=r,{doc:s}=r,{storedMarks:a}=r;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return a},get selection(){return n},get doc(){return s},get tr(){return n=r.selection,s=r.doc,a=r.storedMarks,r}}}var H1=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:n}=t,{tr:s}=r,a=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([i,o])=>[i,(...f)=>{const h=o(...f)(a);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(s),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:n,state:s}=this,{view:a}=n,i=[],o=!!e,c=e||s.tr,f=()=>(!o&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(c),i.every(p=>p===!0)),h={...Object.fromEntries(Object.entries(r).map(([p,x])=>[p,(...v)=>{const y=this.buildProps(c,t),w=x(...v)(y);return i.push(w),h}])),run:f};return h}createCan(e){const{rawCommands:t,state:r}=this,n=!1,s=e||r.tr,a=this.buildProps(s,n);return{...Object.fromEntries(Object.entries(t).map(([o,c])=>[o,(...f)=>c(...f)({...a,dispatch:void 0})])),chain:()=>this.createChain(s,n)}}buildProps(e,t=!0){const{rawCommands:r,editor:n,state:s}=this,{view:a}=n,i={tr:e,editor:n,view:a,state:z1({state:s,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([o,c])=>[o,(...f)=>c(...f)(i)]))}};return i}},yP={};oN(yP,{blur:()=>ehe,clearContent:()=>the,clearNodes:()=>rhe,command:()=>nhe,createParagraphNear:()=>she,cut:()=>ahe,deleteCurrentNode:()=>ihe,deleteNode:()=>ohe,deleteRange:()=>lhe,deleteSelection:()=>che,enter:()=>uhe,exitCode:()=>fhe,extendMarkRange:()=>dhe,first:()=>hhe,focus:()=>mhe,forEach:()=>xhe,insertContent:()=>ghe,insertContentAt:()=>bhe,joinBackward:()=>Ehe,joinDown:()=>_he,joinForward:()=>She,joinItemBackward:()=>Nhe,joinItemForward:()=>The,joinTextblockBackward:()=>khe,joinTextblockForward:()=>Ahe,joinUp:()=>whe,keyboardShortcut:()=>Rhe,lift:()=>Ohe,liftEmptyBlock:()=>jhe,liftListItem:()=>Dhe,newlineInCode:()=>Ihe,resetAttributes:()=>Mhe,scrollIntoView:()=>Fhe,selectAll:()=>Phe,selectNodeBackward:()=>Lhe,selectNodeForward:()=>Bhe,selectParentNode:()=>Uhe,selectTextblockEnd:()=>zhe,selectTextblockStart:()=>Hhe,setContent:()=>Vhe,setMark:()=>c0e,setMeta:()=>u0e,setNode:()=>f0e,setNodeSelection:()=>d0e,setTextDirection:()=>h0e,setTextSelection:()=>p0e,sinkListItem:()=>m0e,splitBlock:()=>x0e,splitListItem:()=>g0e,toggleList:()=>y0e,toggleMark:()=>v0e,toggleNode:()=>b0e,toggleWrap:()=>w0e,undoInputRule:()=>_0e,unsetAllMarks:()=>E0e,unsetMark:()=>S0e,unsetTextDirection:()=>N0e,updateAttributes:()=>T0e,wrapIn:()=>k0e,wrapInList:()=>A0e});var ehe=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var r;e.isDestroyed||(t.dom.blur(),(r=window==null?void 0:window.getSelection())==null||r.removeAllRanges())}),!0),the=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),rhe=()=>({state:e,tr:t,dispatch:r})=>{const{selection:n}=t,{ranges:s}=n;return r&&s.forEach(({$from:a,$to:i})=>{e.doc.nodesBetween(a.pos,i.pos,(o,c)=>{if(o.type.isText)return;const{doc:f,mapping:h}=t,p=f.resolve(h.map(c)),x=f.resolve(h.map(c+o.nodeSize)),g=p.blockRange(x);if(!g)return;const v=yd(g);if(o.type.isTextblock){const{defaultType:y}=p.parent.contentMatchAt(p.index());t.setNodeMarkup(g.start,y)}(v||v===0)&&t.lift(g,v)})}),!0},nhe=e=>t=>e(t),she=()=>({state:e,dispatch:t})=>jF(e,t),ahe=(e,t)=>({editor:r,tr:n})=>{const{state:s}=r,a=s.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);const i=n.mapping.map(t);return n.insert(i,a.content),n.setSelection(new St(n.doc.resolve(Math.max(i-1,0)))),!0},ihe=()=>({tr:e,dispatch:t})=>{const{selection:r}=e,n=r.$anchor.node();if(n.content.size>0)return!1;const s=e.selection.$anchor;for(let a=s.depth;a>0;a-=1)if(s.node(a).type===n.type){if(t){const o=s.before(a),c=s.after(a);e.delete(o,c).scrollIntoView()}return!0}return!1};function gn(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var ohe=e=>({tr:t,state:r,dispatch:n})=>{const s=gn(e,r.schema),a=t.selection.$anchor;for(let i=a.depth;i>0;i-=1)if(a.node(i).type===s){if(n){const c=a.before(i),f=a.after(i);t.delete(c,f).scrollIntoView()}return!0}return!1},lhe=e=>({tr:t,dispatch:r})=>{const{from:n,to:s}=e;return r&&t.delete(n,s),!0},che=()=>({state:e,dispatch:t})=>GS(e,t),uhe=()=>({commands:e})=>e.keyboardShortcut("Enter"),fhe=()=>({state:e,dispatch:t})=>Kue(e,t);function lN(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function _g(e,t,r={strict:!0}){const n=Object.keys(t);return n.length?n.every(s=>r.strict?t[s]===e[s]:lN(t[s])?t[s].test(e[s]):t[s]===e[s]):!0}function vP(e,t,r={}){return e.find(n=>n.type===t&&_g(Object.fromEntries(Object.keys(r).map(s=>[s,n.attrs[s]])),r))}function UR(e,t,r={}){return!!vP(e,t,r)}function cN(e,t,r){var n;if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if((!s.node||!s.node.marks.some(h=>h.type===t))&&(s=e.parent.childBefore(e.parentOffset)),!s.node||!s.node.marks.some(h=>h.type===t)||(r=r||((n=s.node.marks[0])==null?void 0:n.attrs),!vP([...s.node.marks],t,r)))return;let i=s.index,o=e.start()+s.offset,c=i+1,f=o+s.node.nodeSize;for(;i>0&&UR([...e.parent.child(i-1).marks],t,r);)i-=1,o-=e.parent.child(i).nodeSize;for(;c<e.parent.childCount&&UR([...e.parent.child(c).marks],t,r);)f+=e.parent.child(c).nodeSize,c+=1;return{from:o,to:f}}function zo(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var dhe=(e,t={})=>({tr:r,state:n,dispatch:s})=>{const a=zo(e,n.schema),{doc:i,selection:o}=r,{$from:c,from:f,to:h}=o;if(s){const p=cN(c,a,t);if(p&&p.from<=f&&p.to>=h){const x=St.create(i,p.from,p.to);r.setSelection(x)}}return!0},hhe=e=>t=>{const r=typeof e=="function"?e(t):e;for(let n=0;n<r.length;n+=1)if(r[n](t))return!0;return!1};function bP(e){return e instanceof St}function Cc(e=0,t=0,r=0){return Math.min(Math.max(e,t),r)}function wP(e,t=null){if(!t)return null;const r=It.atStart(e),n=It.atEnd(e);if(t==="start"||t===!0)return r;if(t==="end")return n;const s=r.from,a=n.to;return t==="all"?St.create(e,Cc(0,s,a),Cc(e.content.size,s,a)):St.create(e,Cc(t,s,a),Cc(t,s,a))}function zR(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Eg(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function phe(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var mhe=(e=null,t={})=>({editor:r,view:n,tr:s,dispatch:a})=>{t={scrollIntoView:!0,...t};const i=()=>{(Eg()||zR())&&n.dom.focus(),phe()&&!Eg()&&!zR()&&n.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{r.isDestroyed||(n.focus(),t!=null&&t.scrollIntoView&&r.commands.scrollIntoView())})};try{if(n.hasFocus()&&e===null||e===!1)return!0}catch{return!1}if(a&&e===null&&!bP(r.state.selection))return i(),!0;const o=wP(s.doc,e)||r.state.selection,c=r.state.selection.eq(o);return a&&(c||s.setSelection(o),c&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},xhe=(e,t)=>r=>e.every((n,s)=>t(n,{...r,index:s})),ghe=(e,t)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},e,t),_P=e=>{const t=e.childNodes;for(let r=t.length-1;r>=0;r-=1){const n=t[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):n.nodeType===1&&_P(n)}return e};function ex(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${e}</body>`,r=new window.DOMParser().parseFromString(t,"text/html").body;return _P(r)}function D0(e,t,r){if(e instanceof oi||e instanceof Ke)return e;r={slice:!0,parseOptions:{},...r};const n=typeof e=="object"&&e!==null,s=typeof e=="string";if(n)try{if(Array.isArray(e)&&e.length>0)return Ke.fromArray(e.map(o=>t.nodeFromJSON(o)));const i=t.nodeFromJSON(e);return r.errorOnInvalidContent&&i.check(),i}catch(a){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",a),D0("",t,r)}if(s){if(r.errorOnInvalidContent){let i=!1,o="";const c=new aF({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:f=>(i=!0,o=typeof f=="string"?f:f.outerHTML,null)}]}})});if(r.slice?Dl.fromSchema(c).parseSlice(ex(e),r.parseOptions):Dl.fromSchema(c).parse(ex(e),r.parseOptions),r.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const a=Dl.fromSchema(t);return r.slice?a.parseSlice(ex(e),r.parseOptions).content:a.parse(ex(e),r.parseOptions)}return D0("",t,r)}function yhe(e,t,r){const n=e.steps.length-1;if(n<t)return;const s=e.steps[n];if(!(s instanceof On||s instanceof Mn))return;const a=e.mapping.maps[n];let i=0;a.forEach((o,c,f,h)=>{i===0&&(i=h)}),e.setSelection(It.near(e.doc.resolve(i),r))}var vhe=e=>!("type"in e),bhe=(e,t,r)=>({tr:n,dispatch:s,editor:a})=>{var i;if(s){r={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let o;const c=w=>{a.emit("contentError",{editor:a,error:w,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},f={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{D0(t,a.schema,{parseOptions:f,errorOnInvalidContent:!0})}catch(w){c(w)}try{o=D0(t,a.schema,{parseOptions:f,errorOnInvalidContent:(i=r.errorOnInvalidContent)!=null?i:a.options.enableContentCheck})}catch(w){return c(w),!1}let{from:h,to:p}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},x=!0,g=!0;if((vhe(o)?o:[o]).forEach(w=>{w.check(),x=x?w.isText&&w.marks.length===0:!1,g=g?w.isBlock:!1}),h===p&&g){const{parent:w}=n.doc.resolve(h);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(h-=1,p+=1)}let y;if(x){if(Array.isArray(t))y=t.map(w=>w.text||"").join("");else if(t instanceof Ke){let w="";t.forEach(_=>{_.text&&(w+=_.text)}),y=w}else typeof t=="object"&&t&&t.text?y=t.text:y=t;n.insertText(y,h,p)}else{y=o;const w=n.doc.resolve(h),_=w.node(),S=w.parentOffset===0,E=_.isText||_.isTextblock,T=_.content.size>0;S&&E&&T&&(h=Math.max(0,h-1)),n.replaceWith(h,p,y)}r.updateSelection&&yhe(n,n.steps.length-1,-1),r.applyInputRules&&n.setMeta("applyInputRules",{from:h,text:y}),r.applyPasteRules&&n.setMeta("applyPasteRules",{from:h,text:y})}return!0},whe=()=>({state:e,dispatch:t})=>Wue(e,t),_he=()=>({state:e,dispatch:t})=>$ue(e,t),Ehe=()=>({state:e,dispatch:t})=>NF(e,t),She=()=>({state:e,dispatch:t})=>CF(e,t),Nhe=()=>({state:e,dispatch:t,tr:r})=>{try{const n=M1(e.doc,e.selection.$from.pos,-1);return n==null?!1:(r.join(n,2),t&&t(r),!0)}catch{return!1}},The=()=>({state:e,dispatch:t,tr:r})=>{try{const n=M1(e.doc,e.selection.$from.pos,1);return n==null?!1:(r.join(n,2),t&&t(r),!0)}catch{return!1}},khe=()=>({state:e,dispatch:t})=>Vue(e,t),Ahe=()=>({state:e,dispatch:t})=>que(e,t);function EP(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Che(e){const t=e.split(/-(?!$)/);let r=t[t.length-1];r==="Space"&&(r=" ");let n,s,a,i;for(let o=0;o<t.length-1;o+=1){const c=t[o];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))Eg()||EP()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return n&&(r=`Alt-${r}`),s&&(r=`Ctrl-${r}`),i&&(r=`Meta-${r}`),a&&(r=`Shift-${r}`),r}var Rhe=e=>({editor:t,view:r,tr:n,dispatch:s})=>{const a=Che(e).split(/-(?!$)/),i=a.find(f=>!["Alt","Ctrl","Meta","Shift"].includes(f)),o=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),c=t.captureTransaction(()=>{r.someProp("handleKeyDown",f=>f(r,o))});return c==null||c.steps.forEach(f=>{const h=f.map(n.mapping);h&&s&&n.maybeStep(h)}),!0};function $l(e,t,r={}){const{from:n,to:s,empty:a}=e.selection,i=t?gn(t,e.schema):null,o=[];e.doc.nodesBetween(n,s,(p,x)=>{if(p.isText)return;const g=Math.max(n,x),v=Math.min(s,x+p.nodeSize);o.push({node:p,from:g,to:v})});const c=s-n,f=o.filter(p=>i?i.name===p.node.type.name:!0).filter(p=>_g(p.node.attrs,r,{strict:!1}));return a?!!f.length:f.reduce((p,x)=>p+x.to-x.from,0)>=c}var Ohe=(e,t={})=>({state:r,dispatch:n})=>{const s=gn(e,r.schema);return $l(r,s,t)?Gue(r,n):!1},jhe=()=>({state:e,dispatch:t})=>DF(e,t),Dhe=e=>({state:t,dispatch:r})=>{const n=gn(e,t.schema);return afe(n)(t,r)},Ihe=()=>({state:e,dispatch:t})=>OF(e,t);function V1(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function HR(e,t){const r=typeof t=="string"?[t]:t;return Object.keys(e).reduce((n,s)=>(r.includes(s)||(n[s]=e[s]),n),{})}var Mhe=(e,t)=>({tr:r,state:n,dispatch:s})=>{let a=null,i=null;const o=V1(typeof e=="string"?e:e.name,n.schema);if(!o)return!1;o==="node"&&(a=gn(e,n.schema)),o==="mark"&&(i=zo(e,n.schema));let c=!1;return r.selection.ranges.forEach(f=>{n.doc.nodesBetween(f.$from.pos,f.$to.pos,(h,p)=>{a&&a===h.type&&(c=!0,s&&r.setNodeMarkup(p,void 0,HR(h.attrs,t))),i&&h.marks.length&&h.marks.forEach(x=>{i===x.type&&(c=!0,s&&r.addMark(p,p+h.nodeSize,i.create(HR(x.attrs,t))))})})}),c},Fhe=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),Phe=()=>({tr:e,dispatch:t})=>{if(t){const r=new oa(e.doc);e.setSelection(r)}return!0},Lhe=()=>({state:e,dispatch:t})=>kF(e,t),Bhe=()=>({state:e,dispatch:t})=>RF(e,t),Uhe=()=>({state:e,dispatch:t})=>Jue(e,t),zhe=()=>({state:e,dispatch:t})=>efe(e,t),Hhe=()=>({state:e,dispatch:t})=>Que(e,t);function rE(e,t,r={},n={}){return D0(e,t,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}var Vhe=(e,{errorOnInvalidContent:t,emitUpdate:r=!0,parseOptions:n={}}={})=>({editor:s,tr:a,dispatch:i,commands:o})=>{const{doc:c}=a;if(n.preserveWhitespace!=="full"){const f=rE(e,s.schema,n,{errorOnInvalidContent:t??s.options.enableContentCheck});return i&&a.replaceWith(0,c.content.size,f).setMeta("preventUpdate",!r),!0}return i&&a.setMeta("preventUpdate",!r),o.insertContentAt({from:0,to:c.content.size},e,{parseOptions:n,errorOnInvalidContent:t??s.options.enableContentCheck})};function SP(e,t){const r=zo(t,e.schema),{from:n,to:s,empty:a}=e.selection,i=[];a?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,s,c=>{i.push(...c.marks)});const o=i.find(c=>c.type.name===r.name);return o?{...o.attrs}:{}}function NP(e,t){const r=new wF(e);return t.forEach(n=>{n.steps.forEach(s=>{r.step(s)})}),r}function qhe(e){for(let t=0;t<e.edgeCount;t+=1){const{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function Whe(e,t,r){const n=[];return e.nodesBetween(t.from,t.to,(s,a)=>{r(s)&&n.push({node:s,pos:a})}),n}function $he(e,t){for(let r=e.depth;r>0;r-=1){const n=e.node(r);if(t(n))return{pos:r>0?e.before(r):0,start:e.start(r),depth:r,node:n}}}function q1(e){return t=>$he(t.$from,e)}function ht(e,t,r){return e.config[t]===void 0&&e.parent?ht(e.parent,t,r):typeof e.config[t]=="function"?e.config[t].bind({...r,parent:e.parent?ht(e.parent,t,r):null}):e.config[t]}function uN(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},n=ht(t,"addExtensions",r);return n?[t,...uN(n())]:t}).flat(10)}function fN(e,t){const r=xu.fromSchema(t).serializeFragment(e),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(r),s.innerHTML}function TP(e){return typeof e=="function"}function rr(e,t=void 0,...r){return TP(e)?t?e.bind(t)(...r):e(...r):e}function Ghe(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Hf(e){const t=e.filter(s=>s.type==="extension"),r=e.filter(s=>s.type==="node"),n=e.filter(s=>s.type==="mark");return{baseExtensions:t,nodeExtensions:r,markExtensions:n}}function kP(e){const t=[],{nodeExtensions:r,markExtensions:n}=Hf(e),s=[...r,...n],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(i=>{const o={name:i.name,options:i.options,storage:i.storage,extensions:s},c=ht(i,"addGlobalAttributes",o);if(!c)return;c().forEach(h=>{h.types.forEach(p=>{Object.entries(h.attributes).forEach(([x,g])=>{t.push({type:p,name:x,attribute:{...a,...g}})})})})}),s.forEach(i=>{const o={name:i.name,options:i.options,storage:i.storage},c=ht(i,"addAttributes",o);if(!c)return;const f=c();Object.entries(f).forEach(([h,p])=>{const x={...a,...p};typeof(x==null?void 0:x.default)=="function"&&(x.default=x.default()),x!=null&&x.isRequired&&(x==null?void 0:x.default)===void 0&&delete x.default,t.push({type:i.name,name:h,attribute:x})})}),t}function yn(...e){return e.filter(t=>!!t).reduce((t,r)=>{const n={...t};return Object.entries(r).forEach(([s,a])=>{if(!n[s]){n[s]=a;return}if(s==="class"){const o=a?String(a).split(" "):[],c=n[s]?n[s].split(" "):[],f=o.filter(h=>!c.includes(h));n[s]=[...c,...f].join(" ")}else if(s==="style"){const o=a?a.split(";").map(h=>h.trim()).filter(Boolean):[],c=n[s]?n[s].split(";").map(h=>h.trim()).filter(Boolean):[],f=new Map;c.forEach(h=>{const[p,x]=h.split(":").map(g=>g.trim());f.set(p,x)}),o.forEach(h=>{const[p,x]=h.split(":").map(g=>g.trim());f.set(p,x)}),n[s]=Array.from(f.entries()).map(([h,p])=>`${h}: ${p}`).join("; ")}else n[s]=a}),n},{})}function I0(e,t){return t.filter(r=>r.type===e.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(e.attrs)||{}:{[r.name]:e.attrs[r.name]}).reduce((r,n)=>yn(r,n),{})}function Khe(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function VR(e,t){return"style"in e?e:{...e,getAttrs:r=>{const n=e.getAttrs?e.getAttrs(r):e.attrs;if(n===!1)return!1;const s=t.reduce((a,i)=>{const o=i.attribute.parseHTML?i.attribute.parseHTML(r):Khe(r.getAttribute(i.name));return o==null?a:{...a,[i.name]:o}},{});return{...n,...s}}}}function qR(e){return Object.fromEntries(Object.entries(e).filter(([t,r])=>t==="attrs"&&Ghe(r)?!1:r!=null))}function WR(e){var t,r;const n={};return!((t=e==null?void 0:e.attribute)!=null&&t.isRequired)&&"default"in((e==null?void 0:e.attribute)||{})&&(n.default=e.attribute.default),((r=e==null?void 0:e.attribute)==null?void 0:r.validate)!==void 0&&(n.validate=e.attribute.validate),[e.name,n]}function Xhe(e,t){var r;const n=kP(e),{nodeExtensions:s,markExtensions:a}=Hf(e),i=(r=s.find(f=>ht(f,"topNode")))==null?void 0:r.name,o=Object.fromEntries(s.map(f=>{const h=n.filter(_=>_.type===f.name),p={name:f.name,options:f.options,storage:f.storage,editor:t},x=e.reduce((_,S)=>{const E=ht(S,"extendNodeSchema",p);return{..._,...E?E(f):{}}},{}),g=qR({...x,content:rr(ht(f,"content",p)),marks:rr(ht(f,"marks",p)),group:rr(ht(f,"group",p)),inline:rr(ht(f,"inline",p)),atom:rr(ht(f,"atom",p)),selectable:rr(ht(f,"selectable",p)),draggable:rr(ht(f,"draggable",p)),code:rr(ht(f,"code",p)),whitespace:rr(ht(f,"whitespace",p)),linebreakReplacement:rr(ht(f,"linebreakReplacement",p)),defining:rr(ht(f,"defining",p)),isolating:rr(ht(f,"isolating",p)),attrs:Object.fromEntries(h.map(WR))}),v=rr(ht(f,"parseHTML",p));v&&(g.parseDOM=v.map(_=>VR(_,h)));const y=ht(f,"renderHTML",p);y&&(g.toDOM=_=>y({node:_,HTMLAttributes:I0(_,h)}));const w=ht(f,"renderText",p);return w&&(g.toText=w),[f.name,g]})),c=Object.fromEntries(a.map(f=>{const h=n.filter(w=>w.type===f.name),p={name:f.name,options:f.options,storage:f.storage,editor:t},x=e.reduce((w,_)=>{const S=ht(_,"extendMarkSchema",p);return{...w,...S?S(f):{}}},{}),g=qR({...x,inclusive:rr(ht(f,"inclusive",p)),excludes:rr(ht(f,"excludes",p)),group:rr(ht(f,"group",p)),spanning:rr(ht(f,"spanning",p)),code:rr(ht(f,"code",p)),attrs:Object.fromEntries(h.map(WR))}),v=rr(ht(f,"parseHTML",p));v&&(g.parseDOM=v.map(w=>VR(w,h)));const y=ht(f,"renderHTML",p);return y&&(g.toDOM=w=>y({mark:w,HTMLAttributes:I0(w,h)})),[f.name,g]}));return new aF({topNode:i,nodes:o,marks:c})}function Yhe(e){const t=e.filter((r,n)=>e.indexOf(r)!==n);return Array.from(new Set(t))}function Sg(e){return e.sort((r,n)=>{const s=ht(r,"priority")||100,a=ht(n,"priority")||100;return s>a?-1:s<a?1:0})}function AP(e){const t=Sg(uN(e)),r=Yhe(t.map(n=>n.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),t}function CP(e,t,r){const{from:n,to:s}=t,{blockSeparator:a=`

`,textSerializers:i={}}=r||{};let o="";return e.nodesBetween(n,s,(c,f,h,p)=>{var x;c.isBlock&&f>n&&(o+=a);const g=i==null?void 0:i[c.type.name];if(g)return h&&(o+=g({node:c,pos:f,parent:h,index:p,range:t})),!1;c.isText&&(o+=(x=c==null?void 0:c.text)==null?void 0:x.slice(Math.max(n,f)-f,s-f))}),o}function Jhe(e,t){const r={from:0,to:e.content.size};return CP(e,r,t)}function RP(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,r])=>[t,r.spec.toText]))}function Zhe(e,t){const r=gn(t,e.schema),{from:n,to:s}=e.selection,a=[];e.doc.nodesBetween(n,s,o=>{a.push(o)});const i=a.reverse().find(o=>o.type.name===r.name);return i?{...i.attrs}:{}}function OP(e,t){const r=V1(typeof t=="string"?t:t.name,e.schema);return r==="node"?Zhe(e,t):r==="mark"?SP(e,t):{}}function Qhe(e,t=JSON.stringify){const r={};return e.filter(n=>{const s=t(n);return Object.prototype.hasOwnProperty.call(r,s)?!1:r[s]=!0})}function e0e(e){const t=Qhe(e);return t.length===1?t:t.filter((r,n)=>!t.filter((a,i)=>i!==n).some(a=>r.oldRange.from>=a.oldRange.from&&r.oldRange.to<=a.oldRange.to&&r.newRange.from>=a.newRange.from&&r.newRange.to<=a.newRange.to))}function jP(e){const{mapping:t,steps:r}=e,n=[];return t.maps.forEach((s,a)=>{const i=[];if(s.ranges.length)s.forEach((o,c)=>{i.push({from:o,to:c})});else{const{from:o,to:c}=r[a];if(o===void 0||c===void 0)return;i.push({from:o,to:c})}i.forEach(({from:o,to:c})=>{const f=t.slice(a).map(o,-1),h=t.slice(a).map(c),p=t.invert().map(f,-1),x=t.invert().map(h);n.push({oldRange:{from:p,to:x},newRange:{from:f,to:h}})})}),e0e(n)}function dN(e,t,r){const n=[];return e===t?r.resolve(e).marks().forEach(s=>{const a=r.resolve(e),i=cN(a,s.type);i&&n.push({mark:s,...i})}):r.nodesBetween(e,t,(s,a)=>{!s||(s==null?void 0:s.nodeSize)===void 0||n.push(...s.marks.map(i=>({from:a,to:a+s.nodeSize,mark:i})))}),n}var t0e=(e,t,r,n=20)=>{const s=e.doc.resolve(r);let a=n,i=null;for(;a>0&&i===null;){const o=s.node(a);(o==null?void 0:o.type.name)===t?i=o:a-=1}return[i,a]};function tx(e,t){return t.nodes[e]||t.marks[e]||null}function Mx(e,t,r){return Object.fromEntries(Object.entries(r).filter(([n])=>{const s=e.find(a=>a.type===t&&a.name===n);return s?s.attribute.keepOnSplit:!1}))}var r0e=(e,t=500)=>{let r="";const n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,(s,a,i,o)=>{var c,f;const h=((f=(c=s.type.spec).toText)==null?void 0:f.call(c,{node:s,pos:a,parent:i,index:o}))||s.textContent||"%leaf%";r+=s.isAtom&&!s.isText?h:h.slice(0,Math.max(0,n-a))}),r};function nE(e,t,r={}){const{empty:n,ranges:s}=e.selection,a=t?zo(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter(p=>a?a.name===p.type.name:!0).find(p=>_g(p.attrs,r,{strict:!1}));let i=0;const o=[];if(s.forEach(({$from:p,$to:x})=>{const g=p.pos,v=x.pos;e.doc.nodesBetween(g,v,(y,w)=>{if(!y.isText&&!y.marks.length)return;const _=Math.max(g,w),S=Math.min(v,w+y.nodeSize),E=S-_;i+=E,o.push(...y.marks.map(T=>({mark:T,from:_,to:S})))})}),i===0)return!1;const c=o.filter(p=>a?a.name===p.mark.type.name:!0).filter(p=>_g(p.mark.attrs,r,{strict:!1})).reduce((p,x)=>p+x.to-x.from,0),f=o.filter(p=>a?p.mark.type!==a&&p.mark.type.excludes(a):!0).reduce((p,x)=>p+x.to-x.from,0);return(c>0?c+f:c)>=i}function n0e(e,t,r={}){if(!t)return $l(e,null,r)||nE(e,null,r);const n=V1(t,e.schema);return n==="node"?$l(e,t,r):n==="mark"?nE(e,t,r):!1}var s0e=(e,t)=>{const{$from:r,$to:n,$anchor:s}=e.selection;if(t){const a=q1(o=>o.type.name===t)(e.selection);if(!a)return!1;const i=e.doc.resolve(a.pos+1);return s.pos+1===i.end()}return!(n.parentOffset<n.parent.nodeSize-2||r.pos!==n.pos)},a0e=e=>{const{$from:t,$to:r}=e.selection;return!(t.parentOffset>0||t.pos!==r.pos)};function $R(e,t){return Array.isArray(t)?t.some(r=>(typeof r=="string"?r:r.name)===e.name):t}function GR(e,t){const{nodeExtensions:r}=Hf(t),n=r.find(i=>i.name===e);if(!n)return!1;const s={name:n.name,options:n.options,storage:n.storage},a=rr(ht(n,"group",s));return typeof a!="string"?!1:a.split(" ").includes("list")}function W1(e,{checkChildren:t=!0,ignoreWhitespace:r=!1}={}){var n;if(r){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((n=e.text)!=null?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let s=!0;return e.content.forEach(a=>{s!==!1&&(W1(a,{ignoreWhitespace:r,checkChildren:t})||(s=!1))}),s}return!1}function DP(e){return e instanceof xt}var IP=class MP{constructor(t){this.position=t}static fromJSON(t){return new MP(t.position)}toJSON(){return{position:this.position}}};function i0e(e,t){const r=t.mapping.mapResult(e.position);return{position:new IP(r.pos),mapResult:r}}function o0e(e){return new IP(e)}function l0e(e,t,r){var n;const{selection:s}=t;let a=null;if(bP(s)&&(a=s.$cursor),a){const o=(n=e.storedMarks)!=null?n:a.marks();return a.parent.type.allowsMarkType(r)&&(!!r.isInSet(o)||!o.some(f=>f.type.excludes(r)))}const{ranges:i}=s;return i.some(({$from:o,$to:c})=>{let f=o.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(r):!1;return e.doc.nodesBetween(o.pos,c.pos,(h,p,x)=>{if(f)return!1;if(h.isInline){const g=!x||x.type.allowsMarkType(r),v=!!r.isInSet(h.marks)||!h.marks.some(y=>y.type.excludes(r));f=g&&v}return!f}),f})}var c0e=(e,t={})=>({tr:r,state:n,dispatch:s})=>{const{selection:a}=r,{empty:i,ranges:o}=a,c=zo(e,n.schema);if(s)if(i){const f=SP(n,c);r.addStoredMark(c.create({...f,...t}))}else o.forEach(f=>{const h=f.$from.pos,p=f.$to.pos;n.doc.nodesBetween(h,p,(x,g)=>{const v=Math.max(g,h),y=Math.min(g+x.nodeSize,p);x.marks.find(_=>_.type===c)?x.marks.forEach(_=>{c===_.type&&r.addMark(v,y,c.create({..._.attrs,...t}))}):r.addMark(v,y,c.create(t))})});return l0e(n,r,c)},u0e=(e,t)=>({tr:r})=>(r.setMeta(e,t),!0),f0e=(e,t={})=>({state:r,dispatch:n,chain:s})=>{const a=gn(e,r.schema);let i;return r.selection.$anchor.sameParent(r.selection.$head)&&(i=r.selection.$anchor.parent.attrs),a.isTextblock?s().command(({commands:o})=>iR(a,{...i,...t})(r)?!0:o.clearNodes()).command(({state:o})=>iR(a,{...i,...t})(o,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},d0e=e=>({tr:t,dispatch:r})=>{if(r){const{doc:n}=t,s=Cc(e,0,n.content.size),a=xt.create(n,s);t.setSelection(a)}return!0},h0e=(e,t)=>({tr:r,state:n,dispatch:s})=>{const{selection:a}=n;let i,o;return typeof t=="number"?(i=t,o=t):t&&"from"in t&&"to"in t?(i=t.from,o=t.to):(i=a.from,o=a.to),s&&r.doc.nodesBetween(i,o,(c,f)=>{c.isText||r.setNodeMarkup(f,void 0,{...c.attrs,dir:e})}),!0},p0e=e=>({tr:t,dispatch:r})=>{if(r){const{doc:n}=t,{from:s,to:a}=typeof e=="number"?{from:e,to:e}:e,i=St.atStart(n).from,o=St.atEnd(n).to,c=Cc(s,i,o),f=Cc(a,i,o),h=St.create(n,c,f);t.setSelection(h)}return!0},m0e=e=>({state:t,dispatch:r})=>{const n=gn(e,t.schema);return lfe(n)(t,r)};function KR(e,t){const r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(r){const n=r.filter(s=>t==null?void 0:t.includes(s.type.name));e.tr.ensureMarks(n)}}var x0e=({keepMarks:e=!0}={})=>({tr:t,state:r,dispatch:n,editor:s})=>{const{selection:a,doc:i}=t,{$from:o,$to:c}=a,f=s.extensionManager.attributes,h=Mx(f,o.node().type.name,o.node().attrs);if(a instanceof xt&&a.node.isBlock)return!o.parentOffset||!Co(i,o.pos)?!1:(n&&(e&&KR(r,s.extensionManager.splittableMarks),t.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;const p=c.parentOffset===c.parent.content.size,x=o.depth===0?void 0:qhe(o.node(-1).contentMatchAt(o.indexAfter(-1)));let g=p&&x?[{type:x,attrs:h}]:void 0,v=Co(t.doc,t.mapping.map(o.pos),1,g);if(!g&&!v&&Co(t.doc,t.mapping.map(o.pos),1,x?[{type:x}]:void 0)&&(v=!0,g=x?[{type:x,attrs:h}]:void 0),n){if(v&&(a instanceof St&&t.deleteSelection(),t.split(t.mapping.map(o.pos),1,g),x&&!p&&!o.parentOffset&&o.parent.type!==x)){const y=t.mapping.map(o.before()),w=t.doc.resolve(y);o.node(-1).canReplaceWith(w.index(),w.index()+1,x)&&t.setNodeMarkup(t.mapping.map(o.before()),x)}e&&KR(r,s.extensionManager.splittableMarks),t.scrollIntoView()}return v},g0e=(e,t={})=>({tr:r,state:n,dispatch:s,editor:a})=>{var i;const o=gn(e,n.schema),{$from:c,$to:f}=n.selection,h=n.selection.node;if(h&&h.isBlock||c.depth<2||!c.sameParent(f))return!1;const p=c.node(-1);if(p.type!==o)return!1;const x=a.extensionManager.attributes;if(c.parent.content.size===0&&c.node(-1).childCount===c.indexAfter(-1)){if(c.depth===2||c.node(-3).type!==o||c.index(-2)!==c.node(-2).childCount-1)return!1;if(s){let _=Ke.empty;const S=c.index(-1)?1:c.index(-2)?2:3;for(let z=c.depth-S;z>=c.depth-3;z-=1)_=Ke.from(c.node(z).copy(_));const E=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,T={...Mx(x,c.node().type.name,c.node().attrs),...t},k=((i=o.contentMatch.defaultType)==null?void 0:i.createAndFill(T))||void 0;_=_.append(Ke.from(o.createAndFill(null,k)||void 0));const D=c.before(c.depth-(S-1));r.replace(D,c.after(-E),new it(_,4-S,0));let O=-1;r.doc.nodesBetween(D,r.doc.content.size,(z,j)=>{if(O>-1)return!1;z.isTextblock&&z.content.size===0&&(O=j+1)}),O>-1&&r.setSelection(St.near(r.doc.resolve(O))),r.scrollIntoView()}return!0}const g=f.pos===c.end()?p.contentMatchAt(0).defaultType:null,v={...Mx(x,p.type.name,p.attrs),...t},y={...Mx(x,c.node().type.name,c.node().attrs),...t};r.delete(c.pos,f.pos);const w=g?[{type:o,attrs:v},{type:g,attrs:y}]:[{type:o,attrs:v}];if(!Co(r.doc,c.pos,2))return!1;if(s){const{selection:_,storedMarks:S}=n,{splittableMarks:E}=a.extensionManager,T=S||_.$to.parentOffset&&_.$from.marks();if(r.split(c.pos,2,w).scrollIntoView(),!T||!s)return!0;const k=T.filter(D=>E.includes(D.type.name));r.ensureMarks(k)}return!0},aw=(e,t)=>{const r=q1(i=>i.type===t)(e.selection);if(!r)return!0;const n=e.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(n===void 0)return!0;const s=e.doc.nodeAt(n);return r.node.type===(s==null?void 0:s.type)&&Yl(e.doc,r.pos)&&e.join(r.pos),!0},iw=(e,t)=>{const r=q1(i=>i.type===t)(e.selection);if(!r)return!0;const n=e.doc.resolve(r.start).after(r.depth);if(n===void 0)return!0;const s=e.doc.nodeAt(n);return r.node.type===(s==null?void 0:s.type)&&Yl(e.doc,n)&&e.join(n),!0},y0e=(e,t,r,n={})=>({editor:s,tr:a,state:i,dispatch:o,chain:c,commands:f,can:h})=>{const{extensions:p,splittableMarks:x}=s.extensionManager,g=gn(e,i.schema),v=gn(t,i.schema),{selection:y,storedMarks:w}=i,{$from:_,$to:S}=y,E=_.blockRange(S),T=w||y.$to.parentOffset&&y.$from.marks();if(!E)return!1;const k=q1(D=>GR(D.type.name,p))(y);if(E.depth>=1&&k&&E.depth-k.depth<=1){if(k.node.type===g)return f.liftListItem(v);if(GR(k.node.type.name,p)&&g.validContent(k.node.content)&&o)return c().command(()=>(a.setNodeMarkup(k.pos,g),!0)).command(()=>aw(a,g)).command(()=>iw(a,g)).run()}return!r||!T||!o?c().command(()=>h().wrapInList(g,n)?!0:f.clearNodes()).wrapInList(g,n).command(()=>aw(a,g)).command(()=>iw(a,g)).run():c().command(()=>{const D=h().wrapInList(g,n),O=T.filter(z=>x.includes(z.type.name));return a.ensureMarks(O),D?!0:f.clearNodes()}).wrapInList(g,n).command(()=>aw(a,g)).command(()=>iw(a,g)).run()},v0e=(e,t={},r={})=>({state:n,commands:s})=>{const{extendEmptyMarkRange:a=!1}=r,i=zo(e,n.schema);return nE(n,i,t)?s.unsetMark(i,{extendEmptyMarkRange:a}):s.setMark(i,t)},b0e=(e,t,r={})=>({state:n,commands:s})=>{const a=gn(e,n.schema),i=gn(t,n.schema),o=$l(n,a,r);let c;return n.selection.$anchor.sameParent(n.selection.$head)&&(c=n.selection.$anchor.parent.attrs),o?s.setNode(i,c):s.setNode(a,{...c,...r})},w0e=(e,t={})=>({state:r,commands:n})=>{const s=gn(e,r.schema);return $l(r,s,t)?n.lift(s):n.wrapIn(s,t)},_0e=()=>({state:e,dispatch:t})=>{const r=e.plugins;for(let n=0;n<r.length;n+=1){const s=r[n];let a;if(s.spec.isInputRules&&(a=s.getState(e))){if(t){const i=e.tr,o=a.transform;for(let c=o.steps.length-1;c>=0;c-=1)i.step(o.steps[c].invert(o.docs[c]));if(a.text){const c=i.doc.resolve(a.from).marks();i.replaceWith(a.from,a.to,e.schema.text(a.text,c))}else i.delete(a.from,a.to)}return!0}}return!1},E0e=()=>({tr:e,dispatch:t})=>{const{selection:r}=e,{empty:n,ranges:s}=r;return n||t&&s.forEach(a=>{e.removeMark(a.$from.pos,a.$to.pos)}),!0},S0e=(e,t={})=>({tr:r,state:n,dispatch:s})=>{var a;const{extendEmptyMarkRange:i=!1}=t,{selection:o}=r,c=zo(e,n.schema),{$from:f,empty:h,ranges:p}=o;if(!s)return!0;if(h&&i){let{from:x,to:g}=o;const v=(a=f.marks().find(w=>w.type===c))==null?void 0:a.attrs,y=cN(f,c,v);y&&(x=y.from,g=y.to),r.removeMark(x,g,c)}else p.forEach(x=>{r.removeMark(x.$from.pos,x.$to.pos,c)});return r.removeStoredMark(c),!0},N0e=e=>({tr:t,state:r,dispatch:n})=>{const{selection:s}=r;let a,i;return typeof e=="number"?(a=e,i=e):e&&"from"in e&&"to"in e?(a=e.from,i=e.to):(a=s.from,i=s.to),n&&t.doc.nodesBetween(a,i,(o,c)=>{if(o.isText)return;const f={...o.attrs};delete f.dir,t.setNodeMarkup(c,void 0,f)}),!0},T0e=(e,t={})=>({tr:r,state:n,dispatch:s})=>{let a=null,i=null;const o=V1(typeof e=="string"?e:e.name,n.schema);if(!o)return!1;o==="node"&&(a=gn(e,n.schema)),o==="mark"&&(i=zo(e,n.schema));let c=!1;return r.selection.ranges.forEach(f=>{const h=f.$from.pos,p=f.$to.pos;let x,g,v,y;r.selection.empty?n.doc.nodesBetween(h,p,(w,_)=>{a&&a===w.type&&(c=!0,v=Math.max(_,h),y=Math.min(_+w.nodeSize,p),x=_,g=w)}):n.doc.nodesBetween(h,p,(w,_)=>{_<h&&a&&a===w.type&&(c=!0,v=Math.max(_,h),y=Math.min(_+w.nodeSize,p),x=_,g=w),_>=h&&_<=p&&(a&&a===w.type&&(c=!0,s&&r.setNodeMarkup(_,void 0,{...w.attrs,...t})),i&&w.marks.length&&w.marks.forEach(S=>{if(i===S.type&&(c=!0,s)){const E=Math.max(_,h),T=Math.min(_+w.nodeSize,p);r.addMark(E,T,i.create({...S.attrs,...t}))}}))}),g&&(x!==void 0&&s&&r.setNodeMarkup(x,void 0,{...g.attrs,...t}),i&&g.marks.length&&g.marks.forEach(w=>{i===w.type&&s&&r.addMark(v,y,i.create({...w.attrs,...t}))}))}),c},k0e=(e,t={})=>({state:r,dispatch:n})=>{const s=gn(e,r.schema);return tfe(s,t)(r,n)},A0e=(e,t={})=>({state:r,dispatch:n})=>{const s=gn(e,r.schema);return rfe(s,t)(r,n)},C0e=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(n=>n.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(n=>n!==t):delete this.callbacks[e]),this}once(e,t){const r=(...n)=>{this.off(e,r),t.apply(this,n)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}},$1=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=(t=e.undoable)!=null?t:!0}},R0e=(e,t)=>{if(lN(t))return t.exec(e);const r=t(e);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=e,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function rx(e){var t;const{editor:r,from:n,to:s,text:a,rules:i,plugin:o}=e,{view:c}=r;if(c.composing)return!1;const f=c.state.doc.resolve(n);if(f.parent.type.spec.code||(t=f.nodeBefore||f.nodeAfter)!=null&&t.marks.find(x=>x.type.spec.code))return!1;let h=!1;const p=r0e(f)+a;return i.forEach(x=>{if(h)return;const g=R0e(p,x.find);if(!g)return;const v=c.state.tr,y=z1({state:c.state,transaction:v}),w={from:n-(g[0].length-a.length),to:s},{commands:_,chain:S,can:E}=new H1({editor:r,state:y});x.handler({state:y,range:w,match:g,commands:_,chain:S,can:E})===null||!v.steps.length||(x.undoable&&v.setMeta(o,{transform:v,from:n,to:s,text:a}),c.dispatch(v),h=!0)}),h}function O0e(e){const{editor:t,rules:r}=e,n=new Fr({state:{init(){return null},apply(s,a,i){const o=s.getMeta(n);if(o)return o;const c=s.getMeta("applyInputRules");return!!c&&setTimeout(()=>{let{text:h}=c;typeof h=="string"?h=h:h=fN(Ke.from(h),i.schema);const{from:p}=c,x=p+h.length;rx({editor:t,from:p,to:x,text:h,rules:r,plugin:n})}),s.selectionSet||s.docChanged?null:a}},props:{handleTextInput(s,a,i,o){return rx({editor:t,from:a,to:i,text:o,rules:r,plugin:n})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:a}=s.state.selection;a&&rx({editor:t,from:a.pos,to:a.pos,text:"",rules:r,plugin:n})}),!1)},handleKeyDown(s,a){if(a.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?rx({editor:t,from:i.pos,to:i.pos,text:`
`,rules:r,plugin:n}):!1}},isInputRules:!0});return n}function j0e(e){return Object.prototype.toString.call(e).slice(8,-1)}function nx(e){return j0e(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function FP(e,t){const r={...e};return nx(e)&&nx(t)&&Object.keys(t).forEach(n=>{nx(t[n])&&nx(e[n])?r[n]=FP(e[n],t[n]):r[n]=t[n]}),r}var hN=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...e},this.name=this.config.name}get options(){return{...rr(ht(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...rr(ht(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(e={}){const t=this.extend({...this.config,addOptions:()=>FP(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new this.constructor({...this.config,...e});return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},gu=class PP extends hN{constructor(){super(...arguments),this.type="mark"}static create(t={}){const r=typeof t=="function"?t():t;return new PP(r)}static handleExit({editor:t,mark:r}){const{tr:n}=t.state,s=t.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(f=>(f==null?void 0:f.type.name)===r.name))return!1;const c=i.find(f=>(f==null?void 0:f.type.name)===r.name);return c&&n.removeStoredMark(c),n.insertText(" ",s.pos),t.view.dispatch(n),!0}return!1}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}};function D0e(e){return typeof e=="number"}var I0e=class{constructor(e){this.find=e.find,this.handler=e.handler}},M0e=(e,t,r)=>{if(lN(t))return[...e.matchAll(t)];const n=t(e,r);return n?n.map(s=>{const a=[s.text];return a.index=s.index,a.input=e,a.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(s.replaceWith)),a}):[]};function F0e(e){const{editor:t,state:r,from:n,to:s,rule:a,pasteEvent:i,dropEvent:o}=e,{commands:c,chain:f,can:h}=new H1({editor:t,state:r}),p=[];return r.doc.nodesBetween(n,s,(g,v)=>{var y,w,_,S,E;if((w=(y=g.type)==null?void 0:y.spec)!=null&&w.code||!(g.isText||g.isTextblock||g.isInline))return;const T=(E=(S=(_=g.content)==null?void 0:_.size)!=null?S:g.nodeSize)!=null?E:0,k=Math.max(n,v),D=Math.min(s,v+T);if(k>=D)return;const O=g.isText?g.text||"":g.textBetween(k-v,D-v,void 0,"");M0e(O,a.find,i).forEach(j=>{if(j.index===void 0)return;const J=k+j.index+1,ae=J+j[0].length,F={from:r.tr.mapping.map(J),to:r.tr.mapping.map(ae)},X=a.handler({state:r,range:F,match:j,commands:c,chain:f,can:h,pasteEvent:i,dropEvent:o});p.push(X)})}),p.every(g=>g!==null)}var sx=null,P0e=e=>{var t;const r=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=r.clipboardData)==null||t.setData("text/html",e),r};function L0e(e){const{editor:t,rules:r}=e;let n=null,s=!1,a=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}const c=({state:h,from:p,to:x,rule:g,pasteEvt:v})=>{const y=h.tr,w=z1({state:h,transaction:y});if(!(!F0e({editor:t,state:w,from:Math.max(p-1,0),to:x.b-1,rule:g,pasteEvent:v,dropEvent:o})||!y.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,y}};return r.map(h=>new Fr({view(p){const x=v=>{var y;n=(y=p.dom.parentElement)!=null&&y.contains(v.target)?p.dom.parentElement:null,n&&(sx=t)},g=()=>{sx&&(sx=null)};return window.addEventListener("dragstart",x),window.addEventListener("dragend",g),{destroy(){window.removeEventListener("dragstart",x),window.removeEventListener("dragend",g)}}},props:{handleDOMEvents:{drop:(p,x)=>{if(a=n===p.dom.parentElement,o=x,!a){const g=sx;g!=null&&g.isEditable&&setTimeout(()=>{const v=g.state.selection;v&&g.commands.deleteRange({from:v.from,to:v.to})},10)}return!1},paste:(p,x)=>{var g;const v=(g=x.clipboardData)==null?void 0:g.getData("text/html");return i=x,s=!!(v!=null&&v.includes("data-pm-slice")),!1}}},appendTransaction:(p,x,g)=>{const v=p[0],y=v.getMeta("uiEvent")==="paste"&&!s,w=v.getMeta("uiEvent")==="drop"&&!a,_=v.getMeta("applyPasteRules"),S=!!_;if(!y&&!w&&!S)return;if(S){let{text:k}=_;typeof k=="string"?k=k:k=fN(Ke.from(k),g.schema);const{from:D}=_,O=D+k.length,z=P0e(k);return c({rule:h,state:g,from:D,to:{b:O},pasteEvt:z})}const E=x.doc.content.findDiffStart(g.doc.content),T=x.doc.content.findDiffEnd(g.doc.content);if(!(!D0e(E)||!T||E===T.b))return c({rule:h,state:g,from:E,to:T,pasteEvt:i})}}))}var G1=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=e,this.extensions=AP(e),this.schema=Xhe(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:tx(t.name,this.schema)},n=ht(t,"addCommands",r);return n?{...e,...n()}:e},{})}get plugins(){const{editor:e}=this;return Sg([...this.extensions].reverse()).flatMap(n=>{const s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:tx(n.name,this.schema)},a=[],i=ht(n,"addKeyboardShortcuts",s);let o={};if(n.type==="mark"&&ht(n,"exitable",s)&&(o.ArrowRight=()=>gu.handleExit({editor:e,mark:n})),i){const x=Object.fromEntries(Object.entries(i()).map(([g,v])=>[g,()=>v({editor:e})]));o={...o,...x}}const c=Zde(o);a.push(c);const f=ht(n,"addInputRules",s);if($R(n,e.options.enableInputRules)&&f){const x=f();if(x&&x.length){const g=O0e({editor:e,rules:x}),v=Array.isArray(g)?g:[g];a.push(...v)}}const h=ht(n,"addPasteRules",s);if($R(n,e.options.enablePasteRules)&&h){const x=h();if(x&&x.length){const g=L0e({editor:e,rules:x});a.push(...g)}}const p=ht(n,"addProseMirrorPlugins",s);if(p){const x=p();a.push(...x)}return a})}get attributes(){return kP(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Hf(this.extensions);return Object.fromEntries(t.filter(r=>!!ht(r,"addNodeView")).map(r=>{const n=this.attributes.filter(c=>c.type===r.name),s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:gn(r.name,this.schema)},a=ht(r,"addNodeView",s);if(!a)return[];const i=a();if(!i)return[];const o=(c,f,h,p,x)=>{const g=I0(c,n);return i({node:c,view:f,getPos:h,decorations:p,innerDecorations:x,editor:e,extension:r,HTMLAttributes:g})};return[r.name,o]}))}dispatchTransaction(e){const{editor:t}=this;return Sg([...this.extensions].reverse()).reduceRight((n,s)=>{const a={name:s.name,options:s.options,storage:this.editor.extensionStorage[s.name],editor:t,type:tx(s.name,this.schema)},i=ht(s,"dispatchTransaction",a);return i?o=>{i.call(a,{transaction:o,next:n})}:n},e)}get markViews(){const{editor:e}=this,{markExtensions:t}=Hf(this.extensions);return Object.fromEntries(t.filter(r=>!!ht(r,"addMarkView")).map(r=>{const n=this.attributes.filter(o=>o.type===r.name),s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:zo(r.name,this.schema)},a=ht(r,"addMarkView",s);if(!a)return[];const i=(o,c,f)=>{const h=I0(o,n);return a()({mark:o,view:c,inline:f,editor:e,extension:r,HTMLAttributes:h,updateAttributes:p=>{Z0e(o,e,p)}})};return[r.name,i]}))}setupExtensions(){const e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(t=>[t.name,t.storage])),e.forEach(t=>{var r;const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:tx(t.name,this.schema)};t.type==="mark"&&((r=rr(ht(t,"keepOnSplit",n)))==null||r)&&this.splittableMarks.push(t.name);const s=ht(t,"onBeforeCreate",n),a=ht(t,"onCreate",n),i=ht(t,"onUpdate",n),o=ht(t,"onSelectionUpdate",n),c=ht(t,"onTransaction",n),f=ht(t,"onFocus",n),h=ht(t,"onBlur",n),p=ht(t,"onDestroy",n);s&&this.editor.on("beforeCreate",s),a&&this.editor.on("create",a),i&&this.editor.on("update",i),o&&this.editor.on("selectionUpdate",o),c&&this.editor.on("transaction",c),f&&this.editor.on("focus",f),h&&this.editor.on("blur",h),p&&this.editor.on("destroy",p)})}};G1.resolve=AP;G1.sort=Sg;G1.flatten=uN;var B0e={};oN(B0e,{ClipboardTextSerializer:()=>BP,Commands:()=>UP,Delete:()=>zP,Drop:()=>HP,Editable:()=>VP,FocusEvents:()=>WP,Keymap:()=>$P,Paste:()=>GP,Tabindex:()=>KP,TextDirection:()=>XP,focusEventsPluginKey:()=>qP});var en=class LP extends hN{constructor(){super(...arguments),this.type="extension"}static create(t={}){const r=typeof t=="function"?t():t;return new LP(r)}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}},BP=en.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Fr({key:new Sn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:r}=e,{doc:n,selection:s}=t,{ranges:a}=s,i=Math.min(...a.map(h=>h.$from.pos)),o=Math.max(...a.map(h=>h.$to.pos)),c=RP(r);return CP(n,{from:i,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}}),UP=en.create({name:"commands",addCommands(){return{...yP}}}),zP=en.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var r,n,s;const a=()=>{var i,o,c,f;if((f=(c=(o=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:o.filterTransaction)==null?void 0:c.call(o,e))!=null?f:e.getMeta("y-sync$"))return;const h=NP(e.before,[e,...t]);jP(h).forEach(g=>{h.mapping.mapResult(g.oldRange.from).deletedAfter&&h.mapping.mapResult(g.oldRange.to).deletedBefore&&h.before.nodesBetween(g.oldRange.from,g.oldRange.to,(v,y)=>{const w=y+v.nodeSize-2,_=g.oldRange.from<=y&&w<=g.oldRange.to;this.editor.emit("delete",{type:"node",node:v,from:y,to:w,newFrom:h.mapping.map(y),newTo:h.mapping.map(w),deletedRange:g.oldRange,newRange:g.newRange,partial:!_,editor:this.editor,transaction:e,combinedTransform:h})})});const x=h.mapping;h.steps.forEach((g,v)=>{var y,w;if(g instanceof si){const _=x.slice(v).map(g.from,-1),S=x.slice(v).map(g.to),E=x.invert().map(_,-1),T=x.invert().map(S),k=(y=h.doc.nodeAt(_-1))==null?void 0:y.marks.some(O=>O.eq(g.mark)),D=(w=h.doc.nodeAt(S))==null?void 0:w.marks.some(O=>O.eq(g.mark));this.editor.emit("delete",{type:"mark",mark:g.mark,from:g.from,to:g.to,deletedRange:{from:E,to:T},newRange:{from:_,to:S},partial:!!(D||k),editor:this.editor,transaction:e,combinedTransform:h})}})};(s=(n=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:n.async)==null||s?setTimeout(a,0):a()}}),HP=en.create({name:"drop",addProseMirrorPlugins(){return[new Fr({key:new Sn("tiptapDrop"),props:{handleDrop:(e,t,r,n)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:r,moved:n})}}})]}}),VP=en.create({name:"editable",addProseMirrorPlugins(){return[new Fr({key:new Sn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),qP=new Sn("focusEvents"),WP=en.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new Fr({key:qP,props:{handleDOMEvents:{focus:(t,r)=>{e.isFocused=!0;const n=e.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,r)=>{e.isFocused=!1;const n=e.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),$P=en.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:o})=>{const{selection:c,doc:f}=o,{empty:h,$anchor:p}=c,{pos:x,parent:g}=p,v=p.parent.isTextblock&&x>0?o.doc.resolve(x-1):p,y=v.parent.type.spec.isolating,w=p.pos-p.parentOffset,_=y&&v.parent.childCount===1?w===p.pos:It.atStart(f).from===x;return!h||!g.type.isTextblock||g.textContent.length||!_||_&&p.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},s={...n},a={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Eg()||EP()?a:s},addProseMirrorPlugins(){return[new Fr({key:new Sn("clearDocument"),appendTransaction:(e,t,r)=>{if(e.some(y=>y.getMeta("composition")))return;const n=e.some(y=>y.docChanged)&&!t.doc.eq(r.doc),s=e.some(y=>y.getMeta("preventClearDocument"));if(!n||s)return;const{empty:a,from:i,to:o}=t.selection,c=It.atStart(t.doc).from,f=It.atEnd(t.doc).to;if(a||!(i===c&&o===f)||!W1(r.doc))return;const x=r.tr,g=z1({state:r,transaction:x}),{commands:v}=new H1({editor:this.editor,state:g});if(v.clearNodes(),!!x.steps.length)return x}})]}}),GP=en.create({name:"paste",addProseMirrorPlugins(){return[new Fr({key:new Sn("tiptapPaste"),props:{handlePaste:(e,t,r)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:r})}}})]}}),KP=en.create({name:"tabindex",addProseMirrorPlugins(){return[new Fr({key:new Sn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),XP=en.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:e}=Hf(this.extensions);return[{types:e.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{const r=t.getAttribute("dir");return r&&(r==="ltr"||r==="rtl"||r==="auto")?r:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new Fr({key:new Sn("textDirection"),props:{attributes:()=>{const e=this.options.direction;return e?{dir:e}:{}}}})]}}),U0e=class Fh{constructor(t,r,n=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=r,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let r=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}r=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:r,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),r=this.resolvedPos.doc.resolve(t);return new Fh(r,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new Fh(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new Fh(t,this.editor)}get children(){const t=[];return this.node.content.forEach((r,n)=>{const s=r.isBlock&&!r.isTextblock,a=r.isAtom&&!r.isText,i=r.isInline,o=this.pos+n+(a?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const c=this.resolvedPos.doc.resolve(o);if(!s&&!i&&c.depth<=this.depth)return;const f=new Fh(c,this.editor,s,s||i?r:null);s&&(f.actualDepth=this.depth+1),t.push(f)}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,r={}){let n=null,s=this.parent;for(;s&&!n;){if(s.node.type.name===t)if(Object.keys(r).length>0){const a=s.node.attrs,i=Object.keys(r);for(let o=0;o<i.length;o+=1){const c=i[o];if(a[c]!==r[c])break}}else n=s;s=s.parent}return n}querySelector(t,r={}){return this.querySelectorAll(t,r,!0)[0]||null}querySelectorAll(t,r={},n=!1){let s=[];if(!this.children||this.children.length===0)return s;const a=Object.keys(r);return this.children.forEach(i=>{n&&s.length>0||(i.node.type.name===t&&a.every(c=>r[c]===i.node.attrs[c])&&s.push(i),!(n&&s.length>0)&&(s=s.concat(i.querySelectorAll(t,r,n))))}),s}setAttribute(t){const{tr:r}=this.editor.state;r.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(r)}},z0e=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function H0e(e,t,r){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute("data-tiptap-style",""),s.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(s),s}var V0e=class extends C0e{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:i0e,createMappablePosition:o0e},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:s,moved:a})=>this.options.onDrop(n,s,a)),this.on("paste",({event:n,slice:s})=>this.options.onPaste(n,s)),this.on("delete",this.options.onDelete);const t=this.createDoc(),r=wP(t,this.options.autofocus);this.editorState=mf.create({doc:t,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;e!=null&&e.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=H0e(z0e,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){const r=TP(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(s=>{const a=typeof s=="string"?`${s}$`:s.key;r=r.filter(i=>!i.key.startsWith(a))}),t.length===r.length)return;const n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[VP,BP.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:t.blockSeparator}),UP,WP,$P,KP,HP,GP,zP,XP.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new G1(n,this)}createCommandManager(){this.commandManager=new H1({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=rE(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),e=rE(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){const{editorProps:t,enableExtensionDispatchTransaction:r}=this.options,n=t.dispatchTransaction||this.dispatchTransaction.bind(this),s=r?this.extensionManager.dispatchTransaction(n):n;this.editorView=new xP(e,{...t,attributes:{role:"textbox",...t==null?void 0:t.attributes},dispatchTransaction:s,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(f=>{var h;return(h=this.capturedTransaction)==null?void 0:h.step(f)});return}const{state:t,transactions:r}=this.state.applyTransaction(e),n=!this.state.selection.eq(t.selection),s=r.includes(e),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!s)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:r.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=r.findLast(f=>f.getMeta("focus")||f.getMeta("blur")),o=i==null?void 0:i.getMeta("focus"),c=i==null?void 0:i.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:i}),c&&this.emit("blur",{editor:this,event:c.event,transaction:i}),!(e.getMeta("preventUpdate")||!r.some(f=>f.docChanged)||a.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:r.slice(1)})}getAttributes(e){return OP(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,n=typeof e=="string"?t:e;return n0e(this.state,r,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return fN(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return Jhe(this.state.doc,{blockSeparator:t,textSerializers:{...RP(this.schema),...r}})}get isEmpty(){return W1(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return(t=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?t:!0}$node(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new U0e(t,this)}get $doc(){return this.$pos(0)}};function Vf(e){return new $1({find:e.find,handler:({state:t,range:r,match:n})=>{const s=rr(e.getAttributes,void 0,n);if(s===!1||s===null)return null;const{tr:a}=t,i=n[n.length-1],o=n[0];if(i){const c=o.search(/\S/),f=r.from+o.indexOf(i),h=f+i.length;if(dN(r.from,r.to,t.doc).filter(g=>g.mark.type.excluded.find(y=>y===e.type&&y!==g.mark.type)).filter(g=>g.to>f).length)return null;h<r.to&&a.delete(h,r.to),f>r.from&&a.delete(r.from+c,f);const x=r.from+c+i.length;a.addMark(r.from+c,x,e.type.create(s||{})),a.removeStoredMark(e.type)}},undoable:e.undoable})}function q0e(e){return new $1({find:e.find,handler:({state:t,range:r,match:n})=>{const s=rr(e.getAttributes,void 0,n)||{},{tr:a}=t,i=r.from;let o=r.to;const c=e.type.create(s);if(n[1]){const f=n[0].lastIndexOf(n[1]);let h=i+f;h>o?h=o:o=h+n[1].length;const p=n[0][n[0].length-1];a.insertText(p,i+n[0].length-1),a.replaceWith(h,o,c)}else if(n[0]){const f=e.type.isInline?i:i-1;a.insert(f,e.type.create(s)).delete(a.mapping.map(i),a.mapping.map(o))}a.scrollIntoView()},undoable:e.undoable})}function sE(e){return new $1({find:e.find,handler:({state:t,range:r,match:n})=>{const s=t.doc.resolve(r.from),a=rr(e.getAttributes,void 0,n)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;t.tr.delete(r.from,r.to).setBlockType(r.from,r.from,e.type,a)},undoable:e.undoable})}function qf(e){return new $1({find:e.find,handler:({state:t,range:r,match:n,chain:s})=>{const a=rr(e.getAttributes,void 0,n)||{},i=t.tr.delete(r.from,r.to),c=i.doc.resolve(r.from).blockRange(),f=c&&WS(c,e.type,a);if(!f)return null;if(i.wrap(c,f),e.keepMarks&&e.editor){const{selection:p,storedMarks:x}=t,{splittableMarks:g}=e.editor.extensionManager,v=x||p.$to.parentOffset&&p.$from.marks();if(v){const y=v.filter(w=>g.includes(w.type.name));i.ensureMarks(y)}}if(e.keepAttributes){const p=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(p,a).run()}const h=i.doc.resolve(r.from-1).nodeBefore;h&&h.type===e.type&&Yl(i.doc,r.from-1)&&(!e.joinPredicate||e.joinPredicate(n,h))&&i.join(r.from-1)},undoable:e.undoable})}function W0e(e,t){const{selection:r}=e,{$from:n}=r;if(r instanceof xt){const a=n.index();return n.parent.canReplaceWith(a,a+1,t)}let s=n.depth;for(;s>=0;){const a=n.index(s);if(n.node(s).contentMatchAt(a).matchType(t))return!0;s-=1}return!1}var $0e={};oN($0e,{createAtomBlockMarkdownSpec:()=>G0e,createBlockMarkdownSpec:()=>K0e,createInlineMarkdownSpec:()=>J0e,parseAttributes:()=>pN,parseIndentedBlocks:()=>aE,renderNestedMarkdownContent:()=>xN,serializeAttributes:()=>mN});function pN(e){if(!(e!=null&&e.trim()))return{};const t={},r=[],n=e.replace(/["']([^"']*)["']/g,f=>(r.push(f),`__QUOTED_${r.length-1}__`)),s=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const f=s.map(h=>h.trim().slice(1));t.class=f.join(" ")}const a=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);a&&(t.id=a[1]);const i=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(i)).forEach(([,f,h])=>{var p;const x=parseInt(((p=h.match(/__QUOTED_(\d+)__/))==null?void 0:p[1])||"0",10),g=r[x];g&&(t[f]=g.slice(1,-1))});const c=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return c&&c.split(/\s+/).filter(Boolean).forEach(h=>{h.match(/^[a-zA-Z][\w-]*$/)&&(t[h]=!0)}),t}function mN(e){if(!e||Object.keys(e).length===0)return"";const t=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(n=>t.push(`.${n}`)),e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([r,n])=>{r==="class"||r==="id"||(n===!0?t.push(r):n!==!1&&n!=null&&t.push(`${r}="${String(n)}"`))}),t.join(" ")}function G0e(e){const{nodeName:t,name:r,parseAttributes:n=pN,serializeAttributes:s=mN,defaultAttributes:a={},requiredAttributes:i=[],allowedAttributes:o}=e,c=r||t,f=h=>{if(!o)return h;const p={};return o.forEach(x=>{x in h&&(p[x]=h[x])}),p};return{parseMarkdown:(h,p)=>{const x={...a,...h.attributes};return p.createNode(t,x,[])},markdownTokenizer:{name:t,level:"block",start(h){var p;const x=new RegExp(`^:::${c}(?:\\s|$)`,"m"),g=(p=h.match(x))==null?void 0:p.index;return g!==void 0?g:-1},tokenize(h,p,x){const g=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),v=h.match(g);if(!v)return;const y=v[1]||"",w=n(y);if(!i.find(S=>!(S in w)))return{type:t,raw:v[0],attributes:w}}},renderMarkdown:h=>{const p=f(h.attrs||{}),x=s(p),g=x?` {${x}}`:"";return`:::${c}${g} :::`}}}function K0e(e){const{nodeName:t,name:r,getContent:n,parseAttributes:s=pN,serializeAttributes:a=mN,defaultAttributes:i={},content:o="block",allowedAttributes:c}=e,f=r||t,h=p=>{if(!c)return p;const x={};return c.forEach(g=>{g in p&&(x[g]=p[g])}),x};return{parseMarkdown:(p,x)=>{let g;if(n){const y=n(p);g=typeof y=="string"?[{type:"text",text:y}]:y}else o==="block"?g=x.parseChildren(p.tokens||[]):g=x.parseInline(p.tokens||[]);const v={...i,...p.attributes};return x.createNode(t,v,g)},markdownTokenizer:{name:t,level:"block",start(p){var x;const g=new RegExp(`^:::${f}`,"m"),v=(x=p.match(g))==null?void 0:x.index;return v!==void 0?v:-1},tokenize(p,x,g){var v;const y=new RegExp(`^:::${f}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),w=p.match(y);if(!w)return;const[_,S=""]=w,E=s(S);let T=1;const k=_.length;let D="";const O=/^:::([\w-]*)(\s.*)?/gm,z=p.slice(k);for(O.lastIndex=0;;){const j=O.exec(z);if(j===null)break;const J=j.index,ae=j[1];if(!((v=j[2])!=null&&v.endsWith(":::"))){if(ae)T+=1;else if(T-=1,T===0){const F=z.slice(0,J);D=F.trim();const X=p.slice(0,k+J+j[0].length);let P=[];if(D)if(o==="block")for(P=g.blockTokens(F),P.forEach(le=>{le.text&&(!le.tokens||le.tokens.length===0)&&(le.tokens=g.inlineTokens(le.text))});P.length>0;){const le=P[P.length-1];if(le.type==="paragraph"&&(!le.text||le.text.trim()===""))P.pop();else break}else P=g.inlineTokens(D);return{type:t,raw:X,attributes:E,content:D,tokens:P}}}}}},renderMarkdown:(p,x)=>{const g=h(p.attrs||{}),v=a(g),y=v?` {${v}}`:"",w=x.renderChildren(p.content||[],`

`);return`:::${f}${y}

${w}

:::`}}}function X0e(e){if(!e.trim())return{};const t={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(e);for(;n!==null;){const[,s,a,i]=n;t[s]=a||i,n=r.exec(e)}return t}function Y0e(e){return Object.entries(e).filter(([,t])=>t!=null).map(([t,r])=>`${t}="${r}"`).join(" ")}function J0e(e){const{nodeName:t,name:r,getContent:n,parseAttributes:s=X0e,serializeAttributes:a=Y0e,defaultAttributes:i={},selfClosing:o=!1,allowedAttributes:c}=e,f=r||t,h=x=>{if(!c)return x;const g={};return c.forEach(v=>{const y=typeof v=="string"?v:v.name,w=typeof v=="string"?void 0:v.skipIfDefault;if(y in x){const _=x[y];if(w!==void 0&&_===w)return;g[y]=_}}),g},p=f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(x,g)=>{const v={...i,...x.attributes};if(o)return g.createNode(t,v);const y=n?n(x):x.content||"";return y?g.createNode(t,v,[g.createTextNode(y)]):g.createNode(t,v,[])},markdownTokenizer:{name:t,level:"inline",start(x){const g=o?new RegExp(`\\[${p}\\s*[^\\]]*\\]`):new RegExp(`\\[${p}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${p}\\]`),v=x.match(g),y=v==null?void 0:v.index;return y!==void 0?y:-1},tokenize(x,g,v){const y=o?new RegExp(`^\\[${p}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${p}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${p}\\]`),w=x.match(y);if(!w)return;let _="",S="";if(o){const[,T]=w;S=T}else{const[,T,k]=w;S=T,_=k||""}const E=s(S.trim());return{type:t,raw:w[0],content:_.trim(),attributes:E}}},renderMarkdown:x=>{let g="";n?g=n(x):x.content&&x.content.length>0&&(g=x.content.filter(_=>_.type==="text").map(_=>_.text).join(""));const v=h(x.attrs||{}),y=a(v),w=y?` ${y}`:"";return o?`[${f}${w}]`:`[${f}${w}]${g}[/${f}]`}}}function aE(e,t,r){var n,s,a,i;const o=e.split(`
`),c=[];let f="",h=0;const p=t.baseIndentSize||2;for(;h<o.length;){const x=o[h],g=x.match(t.itemPattern);if(!g){if(c.length>0)break;if(x.trim()===""){h+=1,f=`${f}${x}
`;continue}else return}const v=t.extractItemData(g),{indentLevel:y,mainContent:w}=v;f=`${f}${x}
`;const _=[w];for(h+=1;h<o.length;){const k=o[h];if(k.trim()===""){const O=o.slice(h+1).findIndex(J=>J.trim()!=="");if(O===-1)break;if((((s=(n=o[h+1+O].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:s.length)||0)>y){_.push(k),f=`${f}${k}
`,h+=1;continue}else break}if((((i=(a=k.match(/^(\s*)/))==null?void 0:a[1])==null?void 0:i.length)||0)>y)_.push(k),f=`${f}${k}
`,h+=1;else break}let S;const E=_.slice(1);if(E.length>0){const k=E.map(D=>D.slice(y+p)).join(`
`);k.trim()&&(t.customNestedParser?S=t.customNestedParser(k):S=r.blockTokens(k))}const T=t.createToken(v,S);c.push(T)}if(c.length!==0)return{items:c,raw:f}}function xN(e,t,r,n){if(!e||!Array.isArray(e.content))return"";const s=typeof r=="function"?r(n):r,[a,...i]=e.content,o=t.renderChildren([a]),c=[`${s}${o}`];return i&&i.length>0&&i.forEach(f=>{const h=t.renderChildren([f]);if(h){const p=h.split(`
`).map(x=>x?t.indent(x):"").join(`
`);c.push(p)}}),c.join(`
`)}function Z0e(e,t,r={}){const{state:n}=t,{doc:s,tr:a}=n,i=e;s.descendants((o,c)=>{const f=a.mapping.map(c),h=a.mapping.map(c)+o.nodeSize;let p=null;if(o.marks.forEach(g=>{if(g!==i)return!1;p=g}),!p)return;let x=!1;if(Object.keys(r).forEach(g=>{r[g]!==p.attrs[g]&&(x=!0)}),x){const g=e.type.create({...e.attrs,...r});a.removeMark(f,h,e.type),a.addMark(f,h,g)}}),a.docChanged&&t.view.dispatch(a)}var da=class YP extends hN{constructor(){super(...arguments),this.type="node"}static create(t={}){const r=typeof t=="function"?t():t;return new YP(r)}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}};function iu(e){return new I0e({find:e.find,handler:({state:t,range:r,match:n,pasteEvent:s})=>{const a=rr(e.getAttributes,void 0,n,s);if(a===!1||a===null)return null;const{tr:i}=t,o=n[n.length-1],c=n[0];let f=r.to;if(o){const h=c.search(/\S/),p=r.from+c.indexOf(o),x=p+o.length;if(dN(r.from,r.to,t.doc).filter(v=>v.mark.type.excluded.find(w=>w===e.type&&w!==v.mark.type)).filter(v=>v.to>p).length)return null;x<r.to&&i.delete(x,r.to),p>r.from&&i.delete(r.from+h,p),f=r.from+h+o.length,i.addMark(r.from+h,f,e.type.create(a||{})),i.removeStoredMark(e.type)}}})}const{getOwnPropertyNames:Q0e,getOwnPropertySymbols:epe}=Object,{hasOwnProperty:tpe}=Object.prototype;function ow(e,t){return function(n,s,a){return e(n,s,a)&&t(n,s,a)}}function ax(e){return function(r,n,s){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,s);const{cache:a}=s,i=a.get(r),o=a.get(n);if(i&&o)return i===n&&o===r;a.set(r,n),a.set(n,r);const c=e(r,n,s);return a.delete(r),a.delete(n),c}}function rpe(e){return e!=null?e[Symbol.toStringTag]:void 0}function XR(e){return Q0e(e).concat(epe(e))}const npe=Object.hasOwn||((e,t)=>tpe.call(e,t));function yu(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const spe="__v",ape="__o",ipe="_owner",{getOwnPropertyDescriptor:YR,keys:JR}=Object;function ope(e,t){return e.byteLength===t.byteLength&&Ng(new Uint8Array(e),new Uint8Array(t))}function lpe(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function cpe(e,t){return e.byteLength===t.byteLength&&Ng(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function upe(e,t){return yu(e.getTime(),t.getTime())}function fpe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function dpe(e,t){return e===t}function ZR(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const s=new Array(n),a=e.entries();let i,o,c=0;for(;(i=a.next())&&!i.done;){const f=t.entries();let h=!1,p=0;for(;(o=f.next())&&!o.done;){if(s[p]){p++;continue}const x=i.value,g=o.value;if(r.equals(x[0],g[0],c,p,e,t,r)&&r.equals(x[1],g[1],x[0],g[0],e,t,r)){h=s[p]=!0;break}p++}if(!h)return!1;c++}return!0}const hpe=yu;function ppe(e,t,r){const n=JR(e);let s=n.length;if(JR(t).length!==s)return!1;for(;s-- >0;)if(!JP(e,t,r,n[s]))return!1;return!0}function yh(e,t,r){const n=XR(e);let s=n.length;if(XR(t).length!==s)return!1;let a,i,o;for(;s-- >0;)if(a=n[s],!JP(e,t,r,a)||(i=YR(e,a),o=YR(t,a),(i||o)&&(!i||!o||i.configurable!==o.configurable||i.enumerable!==o.enumerable||i.writable!==o.writable)))return!1;return!0}function mpe(e,t){return yu(e.valueOf(),t.valueOf())}function xpe(e,t){return e.source===t.source&&e.flags===t.flags}function QR(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const s=new Array(n),a=e.values();let i,o;for(;(i=a.next())&&!i.done;){const c=t.values();let f=!1,h=0;for(;(o=c.next())&&!o.done;){if(!s[h]&&r.equals(i.value,o.value,i.value,o.value,e,t,r)){f=s[h]=!0;break}h++}if(!f)return!1}return!0}function Ng(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function gpe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function JP(e,t,r,n){return(n===ipe||n===ape||n===spe)&&(e.$$typeof||t.$$typeof)?!0:npe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const ype="[object ArrayBuffer]",vpe="[object Arguments]",bpe="[object Boolean]",wpe="[object DataView]",_pe="[object Date]",Epe="[object Error]",Spe="[object Map]",Npe="[object Number]",Tpe="[object Object]",kpe="[object RegExp]",Ape="[object Set]",Cpe="[object String]",Rpe={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},Ope="[object URL]",jpe=Object.prototype.toString;function Dpe({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:s,areFunctionsEqual:a,areMapsEqual:i,areNumbersEqual:o,areObjectsEqual:c,arePrimitiveWrappersEqual:f,areRegExpsEqual:h,areSetsEqual:p,areTypedArraysEqual:x,areUrlsEqual:g,unknownTagComparators:v}){return function(w,_,S){if(w===_)return!0;if(w==null||_==null)return!1;const E=typeof w;if(E!==typeof _)return!1;if(E!=="object")return E==="number"?o(w,_,S):E==="function"?a(w,_,S):!1;const T=w.constructor;if(T!==_.constructor)return!1;if(T===Object)return c(w,_,S);if(Array.isArray(w))return t(w,_,S);if(T===Date)return n(w,_,S);if(T===RegExp)return h(w,_,S);if(T===Map)return i(w,_,S);if(T===Set)return p(w,_,S);const k=jpe.call(w);if(k===_pe)return n(w,_,S);if(k===kpe)return h(w,_,S);if(k===Spe)return i(w,_,S);if(k===Ape)return p(w,_,S);if(k===Tpe)return typeof w.then!="function"&&typeof _.then!="function"&&c(w,_,S);if(k===Ope)return g(w,_,S);if(k===Epe)return s(w,_,S);if(k===vpe)return c(w,_,S);if(Rpe[k])return x(w,_,S);if(k===ype)return e(w,_,S);if(k===wpe)return r(w,_,S);if(k===bpe||k===Npe||k===Cpe)return f(w,_,S);if(v){let D=v[k];if(!D){const O=rpe(w);O&&(D=v[O])}if(D)return D(w,_,S)}return!1}}function Ipe({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:ope,areArraysEqual:r?yh:lpe,areDataViewsEqual:cpe,areDatesEqual:upe,areErrorsEqual:fpe,areFunctionsEqual:dpe,areMapsEqual:r?ow(ZR,yh):ZR,areNumbersEqual:hpe,areObjectsEqual:r?yh:ppe,arePrimitiveWrappersEqual:mpe,areRegExpsEqual:xpe,areSetsEqual:r?ow(QR,yh):QR,areTypedArraysEqual:r?ow(Ng,yh):Ng,areUrlsEqual:gpe,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const s=ax(n.areArraysEqual),a=ax(n.areMapsEqual),i=ax(n.areObjectsEqual),o=ax(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:s,areMapsEqual:a,areObjectsEqual:i,areSetsEqual:o})}return n}function Mpe(e){return function(t,r,n,s,a,i,o){return e(t,r,o)}}function Fpe({circular:e,comparator:t,createState:r,equals:n,strict:s}){if(r)return function(o,c){const{cache:f=e?new WeakMap:void 0,meta:h}=r();return t(o,c,{cache:f,equals:n,meta:h,strict:s})};if(e)return function(o,c){return t(o,c,{cache:new WeakMap,equals:n,meta:void 0,strict:s})};const a={cache:void 0,equals:n,meta:void 0,strict:s};return function(o,c){return t(o,c,a)}}const Ppe=Zl();Zl({strict:!0});Zl({circular:!0});Zl({circular:!0,strict:!0});Zl({createInternalComparator:()=>yu});Zl({strict:!0,createInternalComparator:()=>yu});Zl({circular:!0,createInternalComparator:()=>yu});Zl({circular:!0,createInternalComparator:()=>yu,strict:!0});function Zl(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:s=!1}=e,a=Ipe(e),i=Dpe(a),o=r?r(i):Mpe(i);return Fpe({circular:t,comparator:i,createState:n,equals:o,strict:s})}var lw={exports:{}},cw={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e6;function Lpe(){if(e6)return cw;e6=1;var e=P0(),t=HM();function r(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var n=typeof Object.is=="function"?Object.is:r,s=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,c=e.useDebugValue;return cw.useSyncExternalStoreWithSelector=function(f,h,p,x,g){var v=a(null);if(v.current===null){var y={hasValue:!1,value:null};v.current=y}else y=v.current;v=o(function(){function _(D){if(!S){if(S=!0,E=D,D=x(D),g!==void 0&&y.hasValue){var O=y.value;if(g(O,D))return T=O}return T=D}if(O=T,n(E,D))return O;var z=x(D);return g!==void 0&&g(O,z)?(E=D,O):(E=D,T=z)}var S=!1,E,T,k=p===void 0?null:p;return[function(){return _(h())},k===null?void 0:function(){return _(k())}]},[h,p,x,g]);var w=s(f,v[0],v[1]);return i(function(){y.hasValue=!0,y.value=w},[w]),c(w),w},cw}var t6;function Bpe(){return t6||(t6=1,lw.exports=Lpe()),lw.exports}var Upe=Bpe(),zpe=(...e)=>t=>{e.forEach(r=>{typeof r=="function"?r(t):r&&(r.current=t)})},Hpe=({contentComponent:e})=>{const t=VM.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return d.jsx(d.Fragment,{children:Object.values(t)})};function Vpe(){const e=new Set;let t={};return{subscribe(r){return e.add(r),()=>{e.delete(r)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(r,n){t={...t,[r]:V8.createPortal(n.reactElement,n.element,r)},e.forEach(s=>s())},removeRenderer(r){const n={...t};delete n[r],t=n,e.forEach(s=>s())}}}var qpe=class extends We.Component{constructor(e){var t;super(e),this.editorContentRef=We.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((t=e.editor)!=null&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var e;const t=this.props.editor;if(t&&!t.isDestroyed&&((e=t.view.dom)!=null&&e.parentNode)){if(t.contentComponent)return;const r=this.editorContentRef.current;r.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:r}),t.contentComponent=Vpe(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var e;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!((e=t.view.dom)!=null&&e.parentNode))return;const r=document.createElement("div");r.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:r})}catch{}}}render(){const{editor:e,innerRef:t,...r}=this.props;return d.jsxs(d.Fragment,{children:[d.jsx("div",{ref:zpe(t,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&d.jsx(Hpe,{contentComponent:e.contentComponent})]})}},Wpe=ne.forwardRef((e,t)=>{const r=We.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[e.editor]);return We.createElement(qpe,{key:r,innerRef:t,...e})}),ZP=We.memo(Wpe),$pe=typeof window<"u"?ne.useLayoutEffect:ne.useEffect,Gpe=class{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(n=>n())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}};function Kpe(e){var t;const[r]=ne.useState(()=>new Gpe(e.editor)),n=Upe.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,e.selector,(t=e.equalityFn)!=null?t:Ppe);return $pe(()=>r.watch(e.editor),[e.editor,r]),ne.useDebugValue(n),n}var Xpe=!1,iE=typeof window>"u",Ype=iE||!!(typeof window<"u"&&window.next),Jpe=class QP{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(r=>r())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?iE||Ype?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const t={...this.options.current,onBeforeCreate:(...n)=>{var s,a;return(a=(s=this.options.current).onBeforeCreate)==null?void 0:a.call(s,...n)},onBlur:(...n)=>{var s,a;return(a=(s=this.options.current).onBlur)==null?void 0:a.call(s,...n)},onCreate:(...n)=>{var s,a;return(a=(s=this.options.current).onCreate)==null?void 0:a.call(s,...n)},onDestroy:(...n)=>{var s,a;return(a=(s=this.options.current).onDestroy)==null?void 0:a.call(s,...n)},onFocus:(...n)=>{var s,a;return(a=(s=this.options.current).onFocus)==null?void 0:a.call(s,...n)},onSelectionUpdate:(...n)=>{var s,a;return(a=(s=this.options.current).onSelectionUpdate)==null?void 0:a.call(s,...n)},onTransaction:(...n)=>{var s,a;return(a=(s=this.options.current).onTransaction)==null?void 0:a.call(s,...n)},onUpdate:(...n)=>{var s,a;return(a=(s=this.options.current).onUpdate)==null?void 0:a.call(s,...n)},onContentError:(...n)=>{var s,a;return(a=(s=this.options.current).onContentError)==null?void 0:a.call(s,...n)},onDrop:(...n)=>{var s,a;return(a=(s=this.options.current).onDrop)==null?void 0:a.call(s,...n)},onPaste:(...n)=>{var s,a;return(a=(s=this.options.current).onPaste)==null?void 0:a.call(s,...n)},onDelete:(...n)=>{var s,a;return(a=(s=this.options.current).onDelete)==null?void 0:a.call(s,...n)}};return new V0e(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}static compareOptions(t,r){return Object.keys(t).every(n=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)?!0:n==="extensions"&&t.extensions&&r.extensions?t.extensions.length!==r.extensions.length?!1:t.extensions.every((s,a)=>{var i;return s===((i=r.extensions)==null?void 0:i[a])}):t[n]===r[n])}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?QP.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((n,s)=>n===t[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,r=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){r&&r.setOptions(this.options.current);return}r&&!r.isDestroyed&&(r.destroy(),this.instanceId===t&&this.setEditor(null))},1)}};function Zpe(e={},t=[]){const r=ne.useRef(e);r.current=e;const[n]=ne.useState(()=>new Jpe(r)),s=VM.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return ne.useDebugValue(s),ne.useEffect(n.onRender(t)),Kpe({editor:s,selector:({transactionNumber:a})=>e.shouldRerenderOnTransaction===!1||e.shouldRerenderOnTransaction===void 0?null:e.immediatelyRender&&a===0?0:a+1}),s}var eL=ne.createContext({editor:null});eL.Consumer;var Qpe=ne.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),eme=()=>ne.useContext(Qpe);We.forwardRef((e,t)=>{const{onDragStart:r}=eme(),n=e.as||"div";return d.jsx(n,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...e.style}})});We.createContext({markViewContentRef:()=>{}});var gN=ne.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});gN.displayName="TiptapContext";var tme=()=>ne.useContext(gN);function tL({editor:e,instance:t,children:r}){const n=e??t;if(!n)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const s=ne.useMemo(()=>({editor:n}),[n]),a=ne.useMemo(()=>({editor:n}),[n]);return d.jsx(eL.Provider,{value:a,children:d.jsx(gN.Provider,{value:s,children:r})})}tL.displayName="Tiptap";function rL({...e}){const{editor:t}=tme();return d.jsx(ZP,{editor:t,...e})}rL.displayName="Tiptap.Content";Object.assign(tL,{Content:rL});var Tg=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);const{children:r,...n}=t??{};if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,r]},rme=/^\s*>\s$/,nme=da.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return Tg("blockquote",{...yn(this.options.HTMLAttributes,e),children:Tg("slot",{})})},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";const r=">",n=[];return e.content.forEach(s=>{const o=t.renderChildren([s]).split(`
`).map(c=>c.trim()===""?r:`${r} ${c}`);n.push(o.join(`
`))}),n.join(`
${r}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[qf({find:rme,type:this.type})]}}),sme=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,ame=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,ime=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,ome=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,lme=gu.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return Tg("strong",{...yn(this.options.HTMLAttributes,e),children:Tg("slot",{})})},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Vf({find:sme,type:this.type}),Vf({find:ime,type:this.type})]},addPasteRules(){return[iu({find:ame,type:this.type}),iu({find:ome,type:this.type})]}}),cme=/(^|[^`])`([^`]+)`(?!`)$/,ume=/(^|[^`])`([^`]+)`(?!`)/g,fme=gu.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Vf({find:cme,type:this.type})]},addPasteRules(){return[iu({find:ume,type:this.type})]}}),uw=4,dme=/^```([a-z]+)?[\s\n]$/,hme=/^~~~([a-z]+)?[\s\n]$/,pme=da.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:uw,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:r}=this.options;if(!r)return null;const a=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(i=>i.startsWith(r)).map(i=>i.replace(r,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",yn(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var r;return((r=e.raw)==null?void 0:r.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var r;let n="";const s=((r=e.attrs)==null?void 0:r.language)||"";return e.content?n=[`\`\`\`${s}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${s}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,r=t.pos===1;return!e||t.parent.type.name!==this.name?!1:r||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:uw,{state:n}=e,{selection:s}=n,{$from:a,empty:i}=s;if(a.parent.type!==this.type)return!1;const o=" ".repeat(r);return i?e.commands.insertContent(o):e.commands.command(({tr:c})=>{const{from:f,to:h}=s,g=n.doc.textBetween(f,h,`
`,`
`).split(`
`).map(v=>o+v).join(`
`);return c.replaceWith(f,h,n.schema.text(g)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:uw,{state:n}=e,{selection:s}=n,{$from:a,empty:i}=s;return a.parent.type!==this.type?!1:i?e.commands.command(({tr:o})=>{var c;const{pos:f}=a,h=a.start(),p=a.end(),g=n.doc.textBetween(h,p,`
`,`
`).split(`
`);let v=0,y=0;const w=f-h;for(let D=0;D<g.length;D+=1){if(y+g[D].length>=w){v=D;break}y+=g[D].length+1}const S=((c=g[v].match(/^ */))==null?void 0:c[0])||"",E=Math.min(S.length,r);if(E===0)return!0;let T=h;for(let D=0;D<v;D+=1)T+=g[D].length+1;return o.delete(T,T+E),f-T<=E&&o.setSelection(St.create(o.doc,T)),!0}):e.commands.command(({tr:o})=>{const{from:c,to:f}=s,x=n.doc.textBetween(c,f,`
`,`
`).split(`
`).map(g=>{var v;const y=((v=g.match(/^ */))==null?void 0:v[0])||"",w=Math.min(y.length,r);return g.slice(w)}).join(`
`);return o.replaceWith(c,f,n.schema.text(x)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:r}=t,{$from:n,empty:s}=r;if(!s||n.parent.type!==this.type)return!1;const a=n.parentOffset===n.parent.nodeSize-2,i=n.parent.textContent.endsWith(`

`);return!a||!i?!1:e.chain().command(({tr:o})=>(o.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:r,doc:n}=t,{$from:s,empty:a}=r;if(!a||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const o=s.after();return o===void 0?!1:n.nodeAt(o)?e.commands.command(({tr:f})=>(f.setSelection(It.near(n.resolve(o))),!0)):e.commands.exitCode()}}},addInputRules(){return[sE({find:dme,type:this.type,getAttributes:e=>({language:e[1]})}),sE({find:hme,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Fr({key:new Sn("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const r=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),s=n?JSON.parse(n):void 0,a=s==null?void 0:s.mode;if(!r||!a)return!1;const{tr:i,schema:o}=e.state,c=o.text(r.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:a},c)),i.selection.$from.parent.type!==this.type&&i.setSelection(St.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),mme=da.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`

`):""}),xme=da.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",yn(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:r,editor:n})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:s,storedMarks:a}=r;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:o}=n.extensionManager,c=a||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:f,dispatch:h})=>{if(h&&c&&i){const p=c.filter(x=>o.includes(x.type.name));f.ensureMarks(p)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),gme=da.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,yn(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var r;const n=(r=e.attrs)!=null&&r.level?parseInt(e.attrs.level,10):1,s="#".repeat(n);return e.content?`${s} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>sE({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),yme=da.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",yn(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!W0e(t,t.schema.nodes[this.name]))return!1;const{selection:r}=t,{$to:n}=r,s=e();return DP(r)?s.insertContentAt(n.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:a,tr:i,dispatch:o})=>{if(o){const{$to:c}=i.selection,f=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?i.setSelection(St.create(i.doc,c.pos+1)):c.nodeAfter.isBlock?i.setSelection(xt.create(i.doc,c.pos)):i.setSelection(St.create(i.doc,c.pos));else{const h=a.schema.nodes[this.options.nextNodeType]||c.parent.type.contentMatch.defaultType,p=h==null?void 0:h.create();p&&(i.insert(f,p),i.setSelection(St.create(i.doc,f+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[q0e({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),vme=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,bme=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,wme=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,_me=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Eme=gu.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",yn(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Vf({find:vme,type:this.type}),Vf({find:wme,type:this.type})]},addPasteRules(){return[iu({find:bme,type:this.type}),iu({find:_me,type:this.type})]}});const Sme="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Nme="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",oE="numeric",lE="ascii",cE="alpha",Qh="asciinumeric",Ph="alphanumeric",uE="domain",nL="emoji",Tme="scheme",kme="slashscheme",fw="whitespace";function Ame(e,t){return e in t||(t[e]=[]),t[e]}function Rc(e,t,r){t[oE]&&(t[Qh]=!0,t[Ph]=!0),t[lE]&&(t[Qh]=!0,t[cE]=!0),t[Qh]&&(t[Ph]=!0),t[cE]&&(t[Ph]=!0),t[Ph]&&(t[uE]=!0),t[nL]&&(t[uE]=!0);for(const n in t){const s=Ame(n,r);s.indexOf(e)<0&&s.push(e)}}function Cme(e,t){const r={};for(const n in t)t[n].indexOf(e)>=0&&(r[n]=!0);return r}function Fs(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}Fs.groups={};Fs.prototype={accepts(){return!!this.t},go(e){const t=this,r=t.j[e];if(r)return r;for(let n=0;n<t.jr.length;n++){const s=t.jr[n][0],a=t.jr[n][1];if(a&&s.test(e))return a}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,r,n){for(let s=0;s<e.length;s++)this.tt(e[s],t,r,n)},tr(e,t,r,n){n=n||Fs.groups;let s;return t&&t.j?s=t:(s=new Fs(t),r&&n&&Rc(t,r,n)),this.jr.push([e,s]),s},ts(e,t,r,n){let s=this;const a=e.length;if(!a)return s;for(let i=0;i<a-1;i++)s=s.tt(e[i]);return s.tt(e[a-1],t,r,n)},tt(e,t,r,n){n=n||Fs.groups;const s=this;if(t&&t.j)return s.j[e]=t,t;const a=t;let i,o=s.go(e);if(o?(i=new Fs,Object.assign(i.j,o.j),i.jr.push.apply(i.jr,o.jr),i.jd=o.jd,i.t=o.t):i=new Fs,a){if(n)if(i.t&&typeof i.t=="string"){const c=Object.assign(Cme(i.t,n),r);Rc(a,c,n)}else r&&Rc(a,r,n);i.t=a}return s.j[e]=i,i}};const jt=(e,t,r,n,s)=>e.ta(t,r,n,s),Br=(e,t,r,n,s)=>e.tr(t,r,n,s),r6=(e,t,r,n,s)=>e.ts(t,r,n,s),Je=(e,t,r,n,s)=>e.tt(t,r,n,s),mo="WORD",fE="UWORD",sL="ASCIINUMERICAL",aL="ALPHANUMERICAL",M0="LOCALHOST",dE="TLD",hE="UTLD",Fx="SCHEME",ff="SLASH_SCHEME",yN="NUM",pE="WS",vN="NL",e0="OPENBRACE",t0="CLOSEBRACE",kg="OPENBRACKET",Ag="CLOSEBRACKET",Cg="OPENPAREN",Rg="CLOSEPAREN",Og="OPENANGLEBRACKET",jg="CLOSEANGLEBRACKET",Dg="FULLWIDTHLEFTPAREN",Ig="FULLWIDTHRIGHTPAREN",Mg="LEFTCORNERBRACKET",Fg="RIGHTCORNERBRACKET",Pg="LEFTWHITECORNERBRACKET",Lg="RIGHTWHITECORNERBRACKET",Bg="FULLWIDTHLESSTHAN",Ug="FULLWIDTHGREATERTHAN",zg="AMPERSAND",Hg="APOSTROPHE",Vg="ASTERISK",bl="AT",qg="BACKSLASH",Wg="BACKTICK",$g="CARET",Sl="COLON",bN="COMMA",Gg="DOLLAR",Ri="DOT",Kg="EQUALS",wN="EXCLAMATION",Ra="HYPHEN",r0="PERCENT",Xg="PIPE",Yg="PLUS",Jg="POUND",n0="QUERY",_N="QUOTE",iL="FULLWIDTHMIDDLEDOT",EN="SEMI",Oi="SLASH",s0="TILDE",Zg="UNDERSCORE",oL="EMOJI",Qg="SYM";var lL=Object.freeze({__proto__:null,ALPHANUMERICAL:aL,AMPERSAND:zg,APOSTROPHE:Hg,ASCIINUMERICAL:sL,ASTERISK:Vg,AT:bl,BACKSLASH:qg,BACKTICK:Wg,CARET:$g,CLOSEANGLEBRACKET:jg,CLOSEBRACE:t0,CLOSEBRACKET:Ag,CLOSEPAREN:Rg,COLON:Sl,COMMA:bN,DOLLAR:Gg,DOT:Ri,EMOJI:oL,EQUALS:Kg,EXCLAMATION:wN,FULLWIDTHGREATERTHAN:Ug,FULLWIDTHLEFTPAREN:Dg,FULLWIDTHLESSTHAN:Bg,FULLWIDTHMIDDLEDOT:iL,FULLWIDTHRIGHTPAREN:Ig,HYPHEN:Ra,LEFTCORNERBRACKET:Mg,LEFTWHITECORNERBRACKET:Pg,LOCALHOST:M0,NL:vN,NUM:yN,OPENANGLEBRACKET:Og,OPENBRACE:e0,OPENBRACKET:kg,OPENPAREN:Cg,PERCENT:r0,PIPE:Xg,PLUS:Yg,POUND:Jg,QUERY:n0,QUOTE:_N,RIGHTCORNERBRACKET:Fg,RIGHTWHITECORNERBRACKET:Lg,SCHEME:Fx,SEMI:EN,SLASH:Oi,SLASH_SCHEME:ff,SYM:Qg,TILDE:s0,TLD:dE,UNDERSCORE:Zg,UTLD:hE,UWORD:fE,WORD:mo,WS:pE});const uo=/[a-z]/,vh=new RegExp("\\p{L}","u"),dw=new RegExp("\\p{Emoji}","u"),fo=/\d/,hw=/\s/,n6="\r",pw=`
`,Rme="",Ome="",mw="";let ix=null,ox=null;function jme(e=[]){const t={};Fs.groups=t;const r=new Fs;ix==null&&(ix=s6(Sme)),ox==null&&(ox=s6(Nme)),Je(r,"'",Hg),Je(r,"{",e0),Je(r,"}",t0),Je(r,"[",kg),Je(r,"]",Ag),Je(r,"(",Cg),Je(r,")",Rg),Je(r,"<",Og),Je(r,">",jg),Je(r,"",Dg),Je(r,"",Ig),Je(r,"",Mg),Je(r,"",Fg),Je(r,"",Pg),Je(r,"",Lg),Je(r,"",Bg),Je(r,"",Ug),Je(r,"&",zg),Je(r,"*",Vg),Je(r,"@",bl),Je(r,"`",Wg),Je(r,"^",$g),Je(r,":",Sl),Je(r,",",bN),Je(r,"$",Gg),Je(r,".",Ri),Je(r,"=",Kg),Je(r,"!",wN),Je(r,"-",Ra),Je(r,"%",r0),Je(r,"|",Xg),Je(r,"+",Yg),Je(r,"#",Jg),Je(r,"?",n0),Je(r,'"',_N),Je(r,"/",Oi),Je(r,";",EN),Je(r,"~",s0),Je(r,"_",Zg),Je(r,"\\",qg),Je(r,"",iL);const n=Br(r,fo,yN,{[oE]:!0});Br(n,fo,n);const s=Br(n,uo,sL,{[Qh]:!0}),a=Br(n,vh,aL,{[Ph]:!0}),i=Br(r,uo,mo,{[lE]:!0});Br(i,fo,s),Br(i,uo,i),Br(s,fo,s),Br(s,uo,s);const o=Br(r,vh,fE,{[cE]:!0});Br(o,uo),Br(o,fo,a),Br(o,vh,o),Br(a,fo,a),Br(a,uo),Br(a,vh,a);const c=Je(r,pw,vN,{[fw]:!0}),f=Je(r,n6,pE,{[fw]:!0}),h=Br(r,hw,pE,{[fw]:!0});Je(r,mw,h),Je(f,pw,c),Je(f,mw,h),Br(f,hw,h),Je(h,n6),Je(h,pw),Br(h,hw,h),Je(h,mw,h);const p=Br(r,dw,oL,{[nL]:!0});Je(p,"#"),Br(p,dw,p),Je(p,Rme,p);const x=Je(p,Ome);Je(x,"#"),Br(x,dw,p);const g=[[uo,i],[fo,s]],v=[[uo,null],[vh,o],[fo,a]];for(let y=0;y<ix.length;y++)xl(r,ix[y],dE,mo,g);for(let y=0;y<ox.length;y++)xl(r,ox[y],hE,fE,v);Rc(dE,{tld:!0,ascii:!0},t),Rc(hE,{utld:!0,alpha:!0},t),xl(r,"file",Fx,mo,g),xl(r,"mailto",Fx,mo,g),xl(r,"http",ff,mo,g),xl(r,"https",ff,mo,g),xl(r,"ftp",ff,mo,g),xl(r,"ftps",ff,mo,g),Rc(Fx,{scheme:!0,ascii:!0},t),Rc(ff,{slashscheme:!0,ascii:!0},t),e=e.sort((y,w)=>y[0]>w[0]?1:-1);for(let y=0;y<e.length;y++){const w=e[y][0],S=e[y][1]?{[Tme]:!0}:{[kme]:!0};w.indexOf("-")>=0?S[uE]=!0:uo.test(w)?fo.test(w)?S[Qh]=!0:S[lE]=!0:S[oE]=!0,r6(r,w,w,S)}return r6(r,"localhost",M0,{ascii:!0}),r.jd=new Fs(Qg),{start:r,tokens:Object.assign({groups:t},lL)}}function cL(e,t){const r=Dme(t.replace(/[A-Z]/g,o=>o.toLowerCase())),n=r.length,s=[];let a=0,i=0;for(;i<n;){let o=e,c=null,f=0,h=null,p=-1,x=-1;for(;i<n&&(c=o.go(r[i]));)o=c,o.accepts()?(p=0,x=0,h=o):p>=0&&(p+=r[i].length,x++),f+=r[i].length,a+=r[i].length,i++;a-=p,i-=x,f-=p,s.push({t:h.t,v:t.slice(a-f,a),s:a-f,e:a})}return s}function Dme(e){const t=[],r=e.length;let n=0;for(;n<r;){let s=e.charCodeAt(n),a,i=s<55296||s>56319||n+1===r||(a=e.charCodeAt(n+1))<56320||a>57343?e[n]:e.slice(n,n+2);t.push(i),n+=i.length}return t}function xl(e,t,r,n,s){let a;const i=t.length;for(let o=0;o<i-1;o++){const c=t[o];e.j[c]?a=e.j[c]:(a=new Fs(n),a.jr=s.slice(),e.j[c]=a),e=a}return a=new Fs(r),a.jr=s.slice(),e.j[t[i-1]]=a,a}function s6(e){const t=[],r=[];let n=0,s="0123456789";for(;n<e.length;){let a=0;for(;s.indexOf(e[n+a])>=0;)a++;if(a>0){t.push(r.join(""));for(let i=parseInt(e.substring(n,n+a),10);i>0;i--)r.pop();n+=a}else r.push(e[n]),n++}return t}const F0={defaultProtocol:"http",events:null,format:a6,formatHref:a6,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function SN(e,t=null){let r=Object.assign({},F0);e&&(r=Object.assign(r,e instanceof SN?e.o:e));const n=r.ignoreTags,s=[];for(let a=0;a<n.length;a++)s.push(n[a].toUpperCase());this.o=r,t&&(this.defaultRender=t),this.ignoreTags=s}SN.prototype={o:F0,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,t,r){const n=t!=null;let s=this.o[e];return s&&(typeof s=="object"?(s=r.t in s?s[r.t]:F0[e],typeof s=="function"&&n&&(s=s(t,r))):typeof s=="function"&&n&&(s=s(t,r.t,r)),s)},getObj(e,t,r){let n=this.o[e];return typeof n=="function"&&t!=null&&(n=n(t,r.t,r)),n},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function a6(e){return e}function uL(e,t){this.t="token",this.v=e,this.tk=t}uL.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),r=e.get("truncate",t,this),n=e.get("format",t,this);return r&&n.length>r?n.substring(0,r)+"":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=F0.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,r=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",r,this),s=e.get("tagName",r,t),a=this.toFormattedString(e),i={},o=e.get("className",r,t),c=e.get("target",r,t),f=e.get("rel",r,t),h=e.getObj("attributes",r,t),p=e.getObj("events",r,t);return i.href=n,o&&(i.class=o),c&&(i.target=c),f&&(i.rel=f),h&&Object.assign(i,h),{tagName:s,attributes:i,content:a,eventListeners:p}}};function K1(e,t){class r extends uL{constructor(s,a){super(s,a),this.t=e}}for(const n in t)r.prototype[n]=t[n];return r.t=e,r}const i6=K1("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),o6=K1("text"),Ime=K1("nl"),lx=K1("url",{isLink:!0,toHref(e=F0.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==M0&&e[1].t===Sl}}),Na=e=>new Fs(e);function Mme({groups:e}){const t=e.domain.concat([zg,Vg,bl,qg,Wg,$g,Gg,Kg,Ra,yN,r0,Xg,Yg,Jg,Oi,Qg,s0,Zg]),r=[Hg,Sl,bN,Ri,wN,r0,n0,_N,EN,Og,jg,e0,t0,Ag,kg,Cg,Rg,Dg,Ig,Mg,Fg,Pg,Lg,Bg,Ug],n=[zg,Hg,Vg,qg,Wg,$g,Gg,Kg,Ra,e0,t0,r0,Xg,Yg,Jg,n0,Oi,Qg,s0,Zg],s=Na(),a=Je(s,s0);jt(a,n,a),jt(a,e.domain,a);const i=Na(),o=Na(),c=Na();jt(s,e.domain,i),jt(s,e.scheme,o),jt(s,e.slashscheme,c),jt(i,n,a),jt(i,e.domain,i);const f=Je(i,bl);Je(a,bl,f),Je(o,bl,f),Je(c,bl,f);const h=Je(a,Ri);jt(h,n,a),jt(h,e.domain,a);const p=Na();jt(f,e.domain,p),jt(p,e.domain,p);const x=Je(p,Ri);jt(x,e.domain,p);const g=Na(i6);jt(x,e.tld,g),jt(x,e.utld,g),Je(f,M0,g);const v=Je(p,Ra);Je(v,Ra,v),jt(v,e.domain,p),jt(g,e.domain,p),Je(g,Ri,x),Je(g,Ra,v);const y=Je(g,Sl);jt(y,e.numeric,i6);const w=Je(i,Ra),_=Je(i,Ri);Je(w,Ra,w),jt(w,e.domain,i),jt(_,n,a),jt(_,e.domain,i);const S=Na(lx);jt(_,e.tld,S),jt(_,e.utld,S),jt(S,e.domain,i),jt(S,n,a),Je(S,Ri,_),Je(S,Ra,w),Je(S,bl,f);const E=Je(S,Sl),T=Na(lx);jt(E,e.numeric,T);const k=Na(lx),D=Na();jt(k,t,k),jt(k,r,D),jt(D,t,k),jt(D,r,D),Je(S,Oi,k),Je(T,Oi,k);const O=Je(o,Sl),z=Je(c,Sl),j=Je(z,Oi),J=Je(j,Oi);jt(o,e.domain,i),Je(o,Ri,_),Je(o,Ra,w),jt(c,e.domain,i),Je(c,Ri,_),Je(c,Ra,w),jt(O,e.domain,k),Je(O,Oi,k),Je(O,n0,k),jt(J,e.domain,k),jt(J,t,k),Je(J,Oi,k);const ae=[[e0,t0],[kg,Ag],[Cg,Rg],[Og,jg],[Dg,Ig],[Mg,Fg],[Pg,Lg],[Bg,Ug]];for(let F=0;F<ae.length;F++){const[X,P]=ae[F],le=Je(k,X);Je(D,X,le),Je(le,P,k);const ee=Na(lx);jt(le,t,ee);const te=Na();jt(le,r),jt(ee,t,ee),jt(ee,r,te),jt(te,t,ee),jt(te,r,te),Je(ee,P,k),Je(te,P,k)}return Je(s,M0,S),Je(s,vN,Ime),{start:s,tokens:lL}}function Fme(e,t,r){let n=r.length,s=0,a=[],i=[];for(;s<n;){let o=e,c=null,f=null,h=0,p=null,x=-1;for(;s<n&&!(c=o.go(r[s].t));)i.push(r[s++]);for(;s<n&&(f=c||o.go(r[s].t));)c=null,o=f,o.accepts()?(x=0,p=o):x>=0&&x++,s++,h++;if(x<0)s-=h,s<n&&(i.push(r[s]),s++);else{i.length>0&&(a.push(xw(o6,t,i)),i=[]),s-=x,h-=x;const g=p.t,v=r.slice(s-h,s);a.push(xw(g,t,v))}}return i.length>0&&a.push(xw(o6,t,i)),a}function xw(e,t,r){const n=r[0].s,s=r[r.length-1].e,a=t.slice(n,s);return new e(a,r)}const Pme=typeof console<"u"&&console&&console.warn||(()=>{}),Lme="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Er={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Bme(){return Fs.groups={},Er.scanner=null,Er.parser=null,Er.tokenQueue=[],Er.pluginQueue=[],Er.customSchemes=[],Er.initialized=!1,Er}function l6(e,t=!1){if(Er.initialized&&Pme(`linkifyjs: already initialized - will not register custom scheme "${e}" ${Lme}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Er.customSchemes.push([e,t])}function Ume(){Er.scanner=jme(Er.customSchemes);for(let e=0;e<Er.tokenQueue.length;e++)Er.tokenQueue[e][1]({scanner:Er.scanner});Er.parser=Mme(Er.scanner.tokens);for(let e=0;e<Er.pluginQueue.length;e++)Er.pluginQueue[e][1]({scanner:Er.scanner,parser:Er.parser});return Er.initialized=!0,Er}function NN(e){return Er.initialized||Ume(),Fme(Er.parser.start,e,cL(Er.scanner.start,e))}NN.scan=cL;function fL(e,t=null,r=null){if(t&&typeof t=="object"){if(r)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);r=t,t=null}const n=new SN(r),s=NN(e),a=[];for(let i=0;i<s.length;i++){const o=s[i];o.isLink&&(!t||o.t===t)&&n.check(o)&&a.push(o.toFormattedObject(n))}return a}var TN="[\0- -\u2029]",zme=new RegExp(TN),Hme=new RegExp(`${TN}$`),Vme=new RegExp(TN,"g");function qme(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function Wme(e){return new Fr({key:new Sn("autolink"),appendTransaction:(t,r,n)=>{const s=t.some(f=>f.docChanged)&&!r.doc.eq(n.doc),a=t.some(f=>f.getMeta("preventAutolink"));if(!s||a)return;const{tr:i}=n,o=NP(r.doc,[...t]);if(jP(o).forEach(({newRange:f})=>{const h=Whe(n.doc,f,g=>g.isTextblock);let p,x;if(h.length>1)p=h[0],x=n.doc.textBetween(p.pos,p.pos+p.node.nodeSize,void 0," ");else if(h.length){const g=n.doc.textBetween(f.from,f.to," "," ");if(!Hme.test(g))return;p=h[0],x=n.doc.textBetween(p.pos,f.to,void 0," ")}if(p&&x){const g=x.split(zme).filter(Boolean);if(g.length<=0)return!1;const v=g[g.length-1],y=p.pos+x.lastIndexOf(v);if(!v)return!1;const w=NN(v).map(_=>_.toObject(e.defaultProtocol));if(!qme(w))return!1;w.filter(_=>_.isLink).map(_=>({..._,from:y+_.start+1,to:y+_.end+1})).filter(_=>n.schema.marks.code?!n.doc.rangeHasMark(_.from,_.to,n.schema.marks.code):!0).filter(_=>e.validate(_.value)).filter(_=>e.shouldAutoLink(_.value)).forEach(_=>{dN(_.from,_.to,n.doc).some(S=>S.mark.type===e.type)||i.addMark(_.from,_.to,e.type.create({href:_.href}))})}}),!!i.steps.length)return i}})}function $me(e){return new Fr({key:new Sn("handleClickLink"),props:{handleClick:(t,r,n)=>{var s,a;if(n.button!==0||!t.editable)return!1;let i=null;if(n.target instanceof HTMLAnchorElement)i=n.target;else{const c=n.target;if(!c)return!1;const f=e.editor.view.dom;i=c.closest("a"),i&&!f.contains(i)&&(i=null)}if(!i)return!1;let o=!1;if(e.enableClickSelection&&(o=e.editor.commands.extendMarkRange(e.type.name)),e.openOnClick){const c=OP(t.state,e.type.name),f=(s=i.href)!=null?s:c.href,h=(a=i.target)!=null?a:c.target;f&&(window.open(f,h),o=!0)}return o}}})}function Gme(e){return new Fr({key:new Sn("handlePasteLink"),props:{handlePaste:(t,r,n)=>{const{shouldAutoLink:s}=e,{state:a}=t,{selection:i}=a,{empty:o}=i;if(o)return!1;let c="";n.content.forEach(h=>{c+=h.textContent});const f=fL(c,{defaultProtocol:e.defaultProtocol}).find(h=>h.isLink&&h.value===c);return!c||!f||s!==void 0&&!s(f.value)?!1:e.editor.commands.setMark(e.type,{href:f.href})}}})}function yc(e,t){const r=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(n=>{const s=typeof n=="string"?n:n.scheme;s&&r.push(s)}),!e||e.replace(Vme,"").match(new RegExp(`^(?:(?:${r.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var dL=gu.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){l6(e);return}l6(e.scheme,e.optionalSlashes)})},onDestroy(){Bme()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!yc(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>{const t=/^[a-z][a-z0-9+.-]*:\/\//i.test(e),r=/^[a-z][a-z0-9+.-]*:/i.test(e);if(t||r&&!e.includes("@"))return!0;const s=(e.includes("@")?e.split("@").pop():e).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(s)||!/\./.test(s))}}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:r=>!!yc(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!yc(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",yn(this.options.HTMLAttributes,e),0]:["a",yn(this.options.HTMLAttributes,{...e,href:""}),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var r,n,s,a;const i=(n=(r=e.attrs)==null?void 0:r.href)!=null?n:"",o=(a=(s=e.attrs)==null?void 0:s.title)!=null?a:"",c=t.renderChildren(e);return o?`[${c}](${i} "${o}")`:`[${c}](${i})`},addCommands(){return{setLink:e=>({chain:t})=>{const{href:r}=e;return this.options.isAllowedUri(r,{defaultValidate:n=>!!yc(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{const{href:r}=e||{};return r&&!this.options.isAllowedUri(r,{defaultValidate:n=>!!yc(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[iu({find:e=>{const t=[];if(e){const{protocols:r,defaultProtocol:n}=this.options,s=fL(e).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:i=>!!yc(i,r),protocols:r,defaultProtocol:n}));s.length&&s.forEach(a=>{this.options.shouldAutoLink(a.value)&&t.push({text:a.value,data:{href:a.href},index:a.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:r}=this.options;return this.options.autolink&&e.push(Wme({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:s=>!!yc(s,t),protocols:t,defaultProtocol:r}),shouldAutoLink:this.options.shouldAutoLink})),e.push($me({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(Gme({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),Kme=dL,Xme=Object.defineProperty,Yme=(e,t)=>{for(var r in t)Xme(e,r,{get:t[r],enumerable:!0})},Jme="listItem",c6="textStyle",u6=/^\s*([-+*])\s$/,hL=da.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Jme,this.editor.getAttributes(c6)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=qf({find:u6,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=qf({find:u6,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(c6),editor:this.editor})),[e]}}),pL=da.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if(e.type!=="list_item")return[];let r=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(s=>s.type==="paragraph"))r=t.parseChildren(e.tokens);else{const s=e.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(r=[{type:"paragraph",content:t.parseInline(s.tokens)}],e.tokens.length>1){const i=e.tokens.slice(1),o=t.parseChildren(i);r.push(...o)}}else r=t.parseChildren(e.tokens)}return r.length===0&&(r=[{type:"paragraph",content:[]}]),{type:"listItem",content:r}},renderMarkdown:(e,t,r)=>xN(e,t,n=>{var s,a;return n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${(((a=(s=n.meta)==null?void 0:s.parentAttrs)==null?void 0:a.start)||1)+n.index}. `:"- "},r),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Zme={};Yme(Zme,{findListItemPos:()=>fp,getNextListDepth:()=>kN,handleBackspace:()=>mE,handleDelete:()=>xE,hasListBefore:()=>mL,hasListItemAfter:()=>Qme,hasListItemBefore:()=>xL,listItemHasSubList:()=>gL,nextListIsDeeper:()=>yL,nextListIsHigher:()=>vL});var fp=(e,t)=>{const{$from:r}=t.selection,n=gn(e,t.schema);let s=null,a=r.depth,i=r.pos,o=null;for(;a>0&&o===null;)s=r.node(a),s.type===n?o=a:(a-=1,i-=1);return o===null?null:{$pos:t.doc.resolve(i),depth:o}},kN=(e,t)=>{const r=fp(e,t);if(!r)return!1;const[,n]=t0e(t,e,r.$pos.pos+4);return n},mL=(e,t,r)=>{const{$anchor:n}=e.selection,s=Math.max(0,n.pos-2),a=e.doc.resolve(s).node();return!(!a||!r.includes(a.type.name))},xL=(e,t)=>{var r;const{$anchor:n}=t.selection,s=t.doc.resolve(n.pos-2);return!(s.index()===0||((r=s.nodeBefore)==null?void 0:r.type.name)!==e)},gL=(e,t,r)=>{if(!r)return!1;const n=gn(e,t.schema);let s=!1;return r.descendants(a=>{a.type===n&&(s=!0)}),s},mE=(e,t,r)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!$l(e.state,t)&&mL(e.state,t,r)){const{$anchor:o}=e.state.selection,c=e.state.doc.resolve(o.before()-1),f=[];c.node().descendants((x,g)=>{x.type.name===t&&f.push({node:x,pos:g})});const h=f.at(-1);if(!h)return!1;const p=e.state.doc.resolve(c.start()+h.pos+1);return e.chain().cut({from:o.start()-1,to:o.end()+1},p.end()).joinForward().run()}if(!$l(e.state,t)||!a0e(e.state))return!1;const n=fp(t,e.state);if(!n)return!1;const a=e.state.doc.resolve(n.$pos.pos-2).node(n.depth),i=gL(t,e.state,a);return xL(t,e.state)&&!i?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},yL=(e,t)=>{const r=kN(e,t),n=fp(e,t);return!n||!r?!1:r>n.depth},vL=(e,t)=>{const r=kN(e,t),n=fp(e,t);return!n||!r?!1:r<n.depth},xE=(e,t)=>{if(!$l(e.state,t)||!s0e(e.state,t))return!1;const{selection:r}=e.state,{$from:n,$to:s}=r;return!r.empty&&n.sameParent(s)?!1:yL(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():vL(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},Qme=(e,t)=>{var r;const{$anchor:n}=t.selection,s=t.doc.resolve(n.pos-n.parentOffset-2);return!(s.index()===s.parent.childCount-1||((r=s.nodeAfter)==null?void 0:r.type.name)!==e)},bL=en.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r})=>{e.state.schema.nodes[r]!==void 0&&xE(e,r)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r})=>{e.state.schema.nodes[r]!==void 0&&xE(e,r)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{e.state.schema.nodes[r]!==void 0&&mE(e,r,n)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{e.state.schema.nodes[r]!==void 0&&mE(e,r,n)&&(t=!0)}),t}}}}),f6=/^(\s*)(\d+)\.\s+(.*)$/,exe=/^\s/;function txe(e){const t=[];let r=0,n=0;for(;r<e.length;){const s=e[r],a=s.match(f6);if(!a)break;const[,i,o,c]=a,f=i.length;let h=c,p=r+1;const x=[s];for(;p<e.length;){const g=e[p];if(g.match(f6))break;if(g.trim()==="")x.push(g),h+=`
`,p+=1;else if(g.match(exe))x.push(g),h+=`
${g.slice(f+2)}`,p+=1;else break}t.push({indent:f,number:parseInt(o,10),content:h.trim(),raw:x.join(`
`)}),n=p,r=p}return[t,n]}function wL(e,t,r){var n;const s=[];let a=0;for(;a<e.length;){const i=e[a];if(i.indent===t){const o=i.content.split(`
`),c=((n=o[0])==null?void 0:n.trim())||"",f=[];c&&f.push({type:"paragraph",raw:c,tokens:r.inlineTokens(c)});const h=o.slice(1).join(`
`).trim();if(h){const g=r.blockTokens(h);f.push(...g)}let p=a+1;const x=[];for(;p<e.length&&e[p].indent>t;)x.push(e[p]),p+=1;if(x.length>0){const g=Math.min(...x.map(y=>y.indent)),v=wL(x,g,r);f.push({type:"list",ordered:!0,start:x[0].number,items:v,raw:x.map(y=>y.raw).join(`
`)})}s.push({type:"list_item",raw:i.raw,tokens:f}),a=p}else a+=1}return s}function rxe(e,t){return e.map(r=>{if(r.type!=="list_item")return t.parseChildren([r])[0];const n=[];return r.tokens&&r.tokens.length>0&&r.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")n.push(...t.parseChildren([s]));else if(s.type==="text"&&s.tokens){const a=t.parseChildren([s]);n.push({type:"paragraph",content:a})}else{const a=t.parseChildren([s]);a.length>0&&n.push(...a)}}),{type:"listItem",content:n}})}var nxe="listItem",d6="textStyle",h6=/^(\d+)\.\s$/,_L=da.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...r}=e;return t===1?["ol",yn(this.options.HTMLAttributes,r),0]:["ol",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if(e.type!=="list"||!e.ordered)return[];const r=e.start||1,n=e.items?rxe(e.items,t):[];return r!==1?{type:"orderedList",attrs:{start:r},content:n}:{type:"orderedList",content:n}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{const t=e.match(/^(\s*)(\d+)\.\s+/),r=t==null?void 0:t.index;return r!==void 0?r:-1},tokenize:(e,t,r)=>{var n;const s=e.split(`
`),[a,i]=txe(s);if(a.length===0)return;const o=wL(a,0,r);return o.length===0?void 0:{type:"list",ordered:!0,start:((n=a[0])==null?void 0:n.number)||1,items:o,raw:s.slice(0,i).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(nxe,this.editor.getAttributes(d6)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=qf({find:h6,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=qf({find:h6,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(d6)}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1],editor:this.editor})),[e]}}),sxe=/^\s*(\[([( |x])?\])\s$/,axe=da.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",yn(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{const r=[];if(e.tokens&&e.tokens.length>0?r.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?r.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):r.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){const n=t.parseChildren(e.nestedTokens);r.push(...n)}return t.createNode("taskItem",{checked:e.checked||!1},r)},renderMarkdown:(e,t)=>{var r;const s=`- [${(r=e.attrs)!=null&&r.checked?"x":" "}] `;return xN(e,t,s)},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...e,Tab:()=>this.editor.commands.sinkListItem(this.name)}:e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:r,editor:n})=>{const s=document.createElement("li"),a=document.createElement("label"),i=document.createElement("span"),o=document.createElement("input"),c=document.createElement("div"),f=p=>{var x,g;o.ariaLabel=((g=(x=this.options.a11y)==null?void 0:x.checkboxLabel)==null?void 0:g.call(x,p,o.checked))||`Task item checkbox for ${p.textContent||"empty task item"}`};f(e),a.contentEditable="false",o.type="checkbox",o.addEventListener("mousedown",p=>p.preventDefault()),o.addEventListener("change",p=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){o.checked=!o.checked;return}const{checked:x}=p.target;n.isEditable&&typeof r=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:g})=>{const v=r();if(typeof v!="number")return!1;const y=g.doc.nodeAt(v);return g.setNodeMarkup(v,void 0,{...y==null?void 0:y.attrs,checked:x}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,x)||(o.checked=!o.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([p,x])=>{s.setAttribute(p,x)}),s.dataset.checked=e.attrs.checked,o.checked=e.attrs.checked,a.append(o,i),s.append(a,c),Object.entries(t).forEach(([p,x])=>{s.setAttribute(p,x)});let h=new Set(Object.keys(t));return{dom:s,contentDOM:c,update:p=>{if(p.type!==this.type)return!1;s.dataset.checked=p.attrs.checked,o.checked=p.attrs.checked,f(p);const x=n.extensionManager.attributes,g=I0(p,x),v=new Set(Object.keys(g)),y=this.options.HTMLAttributes;return h.forEach(w=>{v.has(w)||(w in y?s.setAttribute(w,y[w]):s.removeAttribute(w))}),Object.entries(g).forEach(([w,_])=>{_==null?w in y?s.setAttribute(w,y[w]):s.removeAttribute(w):s.setAttribute(w,_)}),h=v,!0}}}},addInputRules(){return[qf({find:sxe,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),ixe=da.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",yn(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;const r=(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return r!==void 0?r:-1},tokenize(e,t,r){const n=a=>{const i=aE(a,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,c)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:r.inlineTokens(o.mainContent),nestedTokens:c}),customNestedParser:n},r);return i?[{type:"taskList",raw:i.raw,items:i.items}]:r.blockTokens(a)},s=aE(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,i)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:r.inlineTokens(a.mainContent),nestedTokens:i}),customNestedParser:n},r);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});en.create({name:"listKit",addExtensions(){const e=[];return this.options.bulletList!==!1&&e.push(hL.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(pL.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(bL.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(_L.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(axe.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(ixe.configure(this.options.taskList)),e}});var p6="&nbsp;",oxe="",lxe=da.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",yn(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{const r=e.tokens||[];if(r.length===1&&r[0].type==="image")return t.parseChildren([r[0]]);const n=t.parseInline(r);return n.length===1&&n[0].type==="text"&&(n[0].text===p6||n[0].text===oxe)?t.createNode("paragraph",void 0,[]):t.createNode("paragraph",void 0,n)},renderMarkdown:(e,t)=>{if(!e)return"";const r=Array.isArray(e.content)?e.content:[];return r.length===0?p6:t.renderChildren(r)},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),cxe=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,uxe=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,fxe=gu.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",yn(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Vf({find:cxe,type:this.type})]},addPasteRules(){return[iu({find:uxe,type:this.type})]}}),dxe=da.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),EL=gu.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",yn(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown(e,t){return`++${t.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,t,r){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!s)return;const a=s[2].trim();return{type:"underline",raw:s[0],text:a,tokens:r.inlineTokens(a)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),hxe=EL;function pxe(e={}){return new Fr({view(t){return new mxe(t,e)}})}class mxe{constructor(t,r){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let a=i=>{this[s](i)};return t.dom.addEventListener(s,a),{name:s,handler:a}})}destroy(){this.handlers.forEach(({name:t,handler:r})=>this.editorView.dom.removeEventListener(t,r))}update(t,r){this.cursorPos!=null&&r.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),r=!t.parent.inlineContent,n,s=this.editorView.dom,a=s.getBoundingClientRect(),i=a.width/s.offsetWidth,o=a.height/s.offsetHeight;if(r){let p=t.nodeBefore,x=t.nodeAfter;if(p||x){let g=this.editorView.nodeDOM(this.cursorPos-(p?p.nodeSize:0));if(g){let v=g.getBoundingClientRect(),y=p?v.bottom:v.top;p&&x&&(y=(y+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*o;n={left:v.left,right:v.right,top:y-w,bottom:y+w}}}}if(!n){let p=this.editorView.coordsAtPos(this.cursorPos),x=this.width/2*i;n={left:p.left-x,right:p.left+x,top:p.top,bottom:p.bottom}}let c=this.editorView.dom.offsetParent;this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let f,h;if(!c||c==document.body&&getComputedStyle(c).position=="static")f=-pageXOffset,h=-pageYOffset;else{let p=c.getBoundingClientRect(),x=p.width/c.offsetWidth,g=p.height/c.offsetHeight;f=p.left-c.scrollLeft*x,h=p.top-c.scrollTop*g}this.element.style.left=(n.left-f)/i+"px",this.element.style.top=(n.top-h)/o+"px",this.element.style.width=(n.right-n.left)/i+"px",this.element.style.height=(n.bottom-n.top)/o+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),s=n&&n.type.spec.disableDropCursor,a=typeof s=="function"?s(this.editorView,r,t):s;if(r&&!a){let i=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=xF(this.editorView.state.doc,i,this.editorView.dragging.slice);o!=null&&(i=o)}this.setCursor(i),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}class Vr extends It{constructor(t){super(t,t)}map(t,r){let n=t.resolve(r.map(this.head));return Vr.valid(n)?new Vr(n):It.near(n)}content(){return it.empty}eq(t){return t instanceof Vr&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Vr(t.resolve(r.pos))}getBookmark(){return new AN(this.anchor)}static valid(t){let r=t.parent;if(r.isTextblock||!xxe(t)||!gxe(t))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let s=r.contentMatchAt(t.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(t,r,n=!1){e:for(;;){if(!n&&Vr.valid(t))return t;let s=t.pos,a=null;for(let i=t.depth;;i--){let o=t.node(i);if(r>0?t.indexAfter(i)<o.childCount:t.index(i)>0){a=o.child(r>0?t.indexAfter(i):t.index(i)-1);break}else if(i==0)return null;s+=r;let c=t.doc.resolve(s);if(Vr.valid(c))return c}for(;;){let i=r>0?a.firstChild:a.lastChild;if(!i){if(a.isAtom&&!a.isText&&!xt.isSelectable(a)){t=t.doc.resolve(s+a.nodeSize*r),n=!1;continue e}break}a=i,s+=r;let o=t.doc.resolve(s);if(Vr.valid(o))return o}return null}}}Vr.prototype.visible=!1;Vr.findFrom=Vr.findGapCursorFrom;It.jsonID("gapcursor",Vr);class AN{constructor(t){this.pos=t}map(t){return new AN(t.map(this.pos))}resolve(t){let r=t.resolve(this.pos);return Vr.valid(r)?new Vr(r):It.near(r)}}function SL(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function xxe(e){for(let t=e.depth;t>=0;t--){let r=e.index(t),n=e.node(t);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let s=n.child(r-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||SL(s.type))return!0;if(s.inlineContent)return!1}}return!0}function gxe(e){for(let t=e.depth;t>=0;t--){let r=e.indexAfter(t),n=e.node(t);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let s=n.child(r);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||SL(s.type))return!0;if(s.inlineContent)return!1}}return!0}function yxe(){return new Fr({props:{decorations:_xe,createSelectionBetween(e,t,r){return t.pos==r.pos&&Vr.valid(r)?new Vr(r):null},handleClick:bxe,handleKeyDown:vxe,handleDOMEvents:{beforeinput:wxe}}})}const vxe=gP({ArrowLeft:cx("horiz",-1),ArrowRight:cx("horiz",1),ArrowUp:cx("vert",-1),ArrowDown:cx("vert",1)});function cx(e,t){const r=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(n,s,a){let i=n.selection,o=t>0?i.$to:i.$from,c=i.empty;if(i instanceof St){if(!a.endOfTextblock(r)||o.depth==0)return!1;c=!1,o=n.doc.resolve(t>0?o.after():o.before())}let f=Vr.findGapCursorFrom(o,t,c);return f?(s&&s(n.tr.setSelection(new Vr(f))),!0):!1}}function bxe(e,t,r){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!Vr.valid(n))return!1;let s=e.posAtCoords({left:r.clientX,top:r.clientY});return s&&s.inside>-1&&xt.isSelectable(e.state.doc.nodeAt(s.inside))?!1:(e.dispatch(e.state.tr.setSelection(new Vr(n))),!0)}function wxe(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof Vr))return!1;let{$from:r}=e.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let s=Ke.empty;for(let i=n.length-1;i>=0;i--)s=Ke.from(n[i].createAndFill(null,s));let a=e.state.tr.replace(r.pos,r.pos,new it(s,0,0));return a.setSelection(St.near(a.doc.resolve(r.pos+1))),e.dispatch(a),!1}function _xe(e){if(!(e.selection instanceof Vr))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",jr.create(e.doc,[ws.widget(e.selection.head,t,{key:"gapcursor"})])}var e1=200,Fn=function(){};Fn.prototype.append=function(t){return t.length?(t=Fn.from(t),!this.length&&t||t.length<e1&&this.leafAppend(t)||this.length<e1&&t.leafPrepend(this)||this.appendInner(t)):this};Fn.prototype.prepend=function(t){return t.length?Fn.from(t).append(this):this};Fn.prototype.appendInner=function(t){return new Exe(this,t)};Fn.prototype.slice=function(t,r){return t===void 0&&(t=0),r===void 0&&(r=this.length),t>=r?Fn.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,r))};Fn.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};Fn.prototype.forEach=function(t,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(t,r,n,0):this.forEachInvertedInner(t,r,n,0)};Fn.prototype.map=function(t,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var s=[];return this.forEach(function(a,i){return s.push(t(a,i))},r,n),s};Fn.from=function(t){return t instanceof Fn?t:t&&t.length?new NL(t):Fn.empty};var NL=(function(e){function t(n){e.call(this),this.values=n}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(s,a){return s==0&&a==this.length?this:new t(this.values.slice(s,a))},t.prototype.getInner=function(s){return this.values[s]},t.prototype.forEachInner=function(s,a,i,o){for(var c=a;c<i;c++)if(s(this.values[c],o+c)===!1)return!1},t.prototype.forEachInvertedInner=function(s,a,i,o){for(var c=a-1;c>=i;c--)if(s(this.values[c],o+c)===!1)return!1},t.prototype.leafAppend=function(s){if(this.length+s.length<=e1)return new t(this.values.concat(s.flatten()))},t.prototype.leafPrepend=function(s){if(this.length+s.length<=e1)return new t(s.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(t.prototype,r),t})(Fn);Fn.empty=new NL([]);var Exe=(function(e){function t(r,n){e.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},t.prototype.forEachInner=function(n,s,a,i){var o=this.left.length;if(s<o&&this.left.forEachInner(n,s,Math.min(a,o),i)===!1||a>o&&this.right.forEachInner(n,Math.max(s-o,0),Math.min(this.length,a)-o,i+o)===!1)return!1},t.prototype.forEachInvertedInner=function(n,s,a,i){var o=this.left.length;if(s>o&&this.right.forEachInvertedInner(n,s-o,Math.max(a,o)-o,i+o)===!1||a<o&&this.left.forEachInvertedInner(n,Math.min(s,o),a,i)===!1)return!1},t.prototype.sliceInner=function(n,s){if(n==0&&s==this.length)return this;var a=this.left.length;return s<=a?this.left.slice(n,s):n>=a?this.right.slice(n-a,s-a):this.left.slice(n,a).append(this.right.slice(0,s-a))},t.prototype.leafAppend=function(n){var s=this.right.leafAppend(n);if(s)return new t(this.left,s)},t.prototype.leafPrepend=function(n){var s=this.left.leafPrepend(n);if(s)return new t(s,this.right)},t.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new t(this.left,new t(this.right,n)):new t(this,n)},t})(Fn);const Sxe=500;class ei{constructor(t,r){this.items=t,this.eventCount=r}popEvent(t,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let s,a;r&&(s=this.remapping(n,this.items.length),a=s.maps.length);let i=t.tr,o,c,f=[],h=[];return this.items.forEach((p,x)=>{if(!p.step){s||(s=this.remapping(n,x+1),a=s.maps.length),a--,h.push(p);return}if(s){h.push(new gl(p.map));let g=p.step.map(s.slice(a)),v;g&&i.maybeStep(g).doc&&(v=i.mapping.maps[i.mapping.maps.length-1],f.push(new gl(v,void 0,void 0,f.length+h.length))),a--,v&&s.appendMap(v,a)}else i.maybeStep(p.step);if(p.selection)return o=s?p.selection.map(s.slice(a)):p.selection,c=new ei(this.items.slice(0,n).append(h.reverse().concat(f)),this.eventCount-1),!1},this.items.length,0),{remaining:c,transform:i,selection:o}}addTransform(t,r,n,s){let a=[],i=this.eventCount,o=this.items,c=!s&&o.length?o.get(o.length-1):null;for(let h=0;h<t.steps.length;h++){let p=t.steps[h].invert(t.docs[h]),x=new gl(t.mapping.maps[h],p,r),g;(g=c&&c.merge(x))&&(x=g,h?a.pop():o=o.slice(0,o.length-1)),a.push(x),r&&(i++,r=void 0),s||(c=x)}let f=i-n.depth;return f>Txe&&(o=Nxe(o,f),i-=f),new ei(o.append(a),i)}remapping(t,r){let n=new A0;return this.items.forEach((s,a)=>{let i=s.mirrorOffset!=null&&a-s.mirrorOffset>=t?n.maps.length-s.mirrorOffset:void 0;n.appendMap(s.map,i)},t,r),n}addMaps(t){return this.eventCount==0?this:new ei(this.items.append(t.map(r=>new gl(r))),this.eventCount)}rebased(t,r){if(!this.eventCount)return this;let n=[],s=Math.max(0,this.items.length-r),a=t.mapping,i=t.steps.length,o=this.eventCount;this.items.forEach(x=>{x.selection&&o--},s);let c=r;this.items.forEach(x=>{let g=a.getMirror(--c);if(g==null)return;i=Math.min(i,g);let v=a.maps[g];if(x.step){let y=t.steps[g].invert(t.docs[g]),w=x.selection&&x.selection.map(a.slice(c+1,g));w&&o++,n.push(new gl(v,y,w))}else n.push(new gl(v))},s);let f=[];for(let x=r;x<i;x++)f.push(new gl(a.maps[x]));let h=this.items.slice(0,s).append(f).append(n),p=new ei(h,o);return p.emptyItemCount()>Sxe&&(p=p.compress(this.items.length-n.length)),p}emptyItemCount(){let t=0;return this.items.forEach(r=>{r.step||t++}),t}compress(t=this.items.length){let r=this.remapping(0,t),n=r.maps.length,s=[],a=0;return this.items.forEach((i,o)=>{if(o>=t)s.push(i),i.selection&&a++;else if(i.step){let c=i.step.map(r.slice(n)),f=c&&c.getMap();if(n--,f&&r.appendMap(f,n),c){let h=i.selection&&i.selection.map(r.slice(n));h&&a++;let p=new gl(f.invert(),c,h),x,g=s.length-1;(x=s.length&&s[g].merge(p))?s[g]=x:s.push(p)}}else i.map&&n--},this.items.length,0),new ei(Fn.from(s.reverse()),a)}}ei.empty=new ei(Fn.empty,0);function Nxe(e,t){let r;return e.forEach((n,s)=>{if(n.selection&&t--==0)return r=s,!1}),e.slice(r)}let gl=class TL{constructor(t,r,n,s){this.map=t,this.step=r,this.selection=n,this.mirrorOffset=s}merge(t){if(this.step&&t.step&&!t.selection){let r=t.step.merge(this.step);if(r)return new TL(r.getMap().invert(),r,this.selection)}}};class wl{constructor(t,r,n,s,a){this.done=t,this.undone=r,this.prevRanges=n,this.prevTime=s,this.prevComposition=a}}const Txe=20;function kxe(e,t,r,n){let s=r.getMeta(Vc),a;if(s)return s.historyState;r.getMeta(Rxe)&&(e=new wl(e.done,e.undone,null,0,-1));let i=r.getMeta("appendedTransaction");if(r.steps.length==0)return e;if(i&&i.getMeta(Vc))return i.getMeta(Vc).redo?new wl(e.done.addTransform(r,void 0,n,Px(t)),e.undone,m6(r.mapping.maps),e.prevTime,e.prevComposition):new wl(e.done,e.undone.addTransform(r,void 0,n,Px(t)),null,e.prevTime,e.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(i&&i.getMeta("addToHistory")===!1)){let o=r.getMeta("composition"),c=e.prevTime==0||!i&&e.prevComposition!=o&&(e.prevTime<(r.time||0)-n.newGroupDelay||!Axe(r,e.prevRanges)),f=i?gw(e.prevRanges,r.mapping):m6(r.mapping.maps);return new wl(e.done.addTransform(r,c?t.selection.getBookmark():void 0,n,Px(t)),ei.empty,f,r.time,o??e.prevComposition)}else return(a=r.getMeta("rebased"))?new wl(e.done.rebased(r,a),e.undone.rebased(r,a),gw(e.prevRanges,r.mapping),e.prevTime,e.prevComposition):new wl(e.done.addMaps(r.mapping.maps),e.undone.addMaps(r.mapping.maps),gw(e.prevRanges,r.mapping),e.prevTime,e.prevComposition)}function Axe(e,t){if(!t)return!1;if(!e.docChanged)return!0;let r=!1;return e.mapping.maps[0].forEach((n,s)=>{for(let a=0;a<t.length;a+=2)n<=t[a+1]&&s>=t[a]&&(r=!0)}),r}function m6(e){let t=[];for(let r=e.length-1;r>=0&&t.length==0;r--)e[r].forEach((n,s,a,i)=>t.push(a,i));return t}function gw(e,t){if(!e)return null;let r=[];for(let n=0;n<e.length;n+=2){let s=t.map(e[n],1),a=t.map(e[n+1],-1);s<=a&&r.push(s,a)}return r}function Cxe(e,t,r){let n=Px(t),s=Vc.get(t).spec.config,a=(r?e.undone:e.done).popEvent(t,n);if(!a)return null;let i=a.selection.resolve(a.transform.doc),o=(r?e.done:e.undone).addTransform(a.transform,t.selection.getBookmark(),s,n),c=new wl(r?o:a.remaining,r?a.remaining:o,null,0,-1);return a.transform.setSelection(i).setMeta(Vc,{redo:r,historyState:c})}let yw=!1,x6=null;function Px(e){let t=e.plugins;if(x6!=t){yw=!1,x6=t;for(let r=0;r<t.length;r++)if(t[r].spec.historyPreserveItems){yw=!0;break}}return yw}const Vc=new Sn("history"),Rxe=new Sn("closeHistory");function Oxe(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new Fr({key:Vc,state:{init(){return new wl(ei.empty,ei.empty,null,0,-1)},apply(t,r,n){return kxe(r,n,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,r){let n=r.inputType,s=n=="historyUndo"?AL:n=="historyRedo"?CL:null;return!s||!t.editable?!1:(r.preventDefault(),s(t.state,t.dispatch))}}}})}function kL(e,t){return(r,n)=>{let s=Vc.getState(r);if(!s||(e?s.undone:s.done).eventCount==0)return!1;if(n){let a=Cxe(s,r,e);a&&n(t?a.scrollIntoView():a)}return!0}}const AL=kL(!1,!0),CL=kL(!0,!0);en.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc;if(((e==null?void 0:e.mode)||this.options.mode)==="textSize"){const n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc,r=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let e=!1;return[new Fr({key:new Sn("characterCount"),appendTransaction:(t,r,n)=>{if(e)return;const s=this.options.limit;if(s==null||s===0){e=!0;return}const a=this.storage.characters({node:n.doc});if(a>s){const i=a-s,o=0,c=i;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const f=n.tr.deleteRange(o,c);return e=!0,f}e=!0},filterTransaction:(t,r)=>{const n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;const s=this.storage.characters({node:r.doc}),a=this.storage.characters({node:t.doc});if(a<=n||s>n&&a>n&&a<=s)return!0;if(s>n&&a>n&&a>s||!t.getMeta("paste"))return!1;const o=t.selection.$head.pos,c=a-n,f=o-c,h=o;return t.deleteRange(f,h),!(this.storage.characters({node:t.doc})>n)}})]}});var jxe=en.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[pxe(this.options)]}});en.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Fr({key:new Sn("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:s}=t,a=[];if(!r||!n)return jr.create(e,[]);let i=0;this.options.mode==="deepest"&&e.descendants((c,f)=>{if(c.isText)return;if(!(s>=f&&s<=f+c.nodeSize-1))return!1;i+=1});let o=0;return e.descendants((c,f)=>{if(c.isText||!(s>=f&&s<=f+c.nodeSize-1))return!1;if(o+=1,this.options.mode==="deepest"&&i-o>0||this.options.mode==="shallowest"&&o>1)return this.options.mode==="deepest";a.push(ws.node(f,f+c.nodeSize,{class:this.options.className}))}),jr.create(e,a)}}})]}});var Dxe=en.create({name:"gapCursor",addProseMirrorPlugins(){return[yxe()]},extendNodeSchema(e){var t;const r={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=rr(ht(e,"allowGapCursor",r)))!=null?t:null}}}),g6="placeholder";function Ixe(e){return e.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}en.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:g6,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const e=this.options.dataAttribute?`data-${Ixe(this.options.dataAttribute)}`:`data-${g6}`;return[new Fr({key:new Sn("placeholder"),props:{decorations:({doc:t,selection:r})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=r,a=[];if(!n)return null;const i=this.editor.isEmpty;return t.descendants((o,c)=>{const f=s>=c&&s<=c+o.nodeSize,h=!o.isLeaf&&W1(o);if((f||!this.options.showOnlyCurrent)&&h){const p=[this.options.emptyNodeClass];i&&p.push(this.options.emptyEditorClass);const x=ws.node(c,c+o.nodeSize,{class:p.join(" "),[e]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:c,hasAnchor:f}):this.options.placeholder});a.push(x)}return this.options.includeChildren}),jr.create(t,a)}}})]}});en.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new Fr({key:new Sn("selection"),props:{decorations(r){return r.selection.empty||e.isFocused||!e.isEditable||DP(r.selection)||e.view.dragging?null:jr.create(r.doc,[ws.inline(r.selection.from,r.selection.to,{class:t.className})])}}})]}});function y6({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||(t==null?void 0:t.type)===e}var Mxe=en.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;const t=new Sn(this.name),r=this.options.node||((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(r).includes(s.name));return[new Fr({key:t,appendTransaction:(s,a,i)=>{const{doc:o,tr:c,schema:f}=i,h=t.getState(i),p=o.content.size,x=f.nodes[r];if(h)return c.insert(p,x.create())},state:{init:(s,a)=>{const i=a.tr.doc.lastChild;return!y6({node:i,types:n})},apply:(s,a)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return a;const i=s.doc.lastChild;return!y6({node:i,types:n})}}})]}}),Fxe=en.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>AL(e,t),redo:()=>({state:e,dispatch:t})=>CL(e,t)}},addProseMirrorPlugins(){return[Oxe(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Pxe=en.create({name:"starterKit",addExtensions(){var e,t,r,n;const s=[];return this.options.bold!==!1&&s.push(lme.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(nme.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(hL.configure(this.options.bulletList)),this.options.code!==!1&&s.push(fme.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(pme.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(mme.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(jxe.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(Dxe.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(xme.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(gme.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(Fxe.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(yme.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(Eme.configure(this.options.italic)),this.options.listItem!==!1&&s.push(pL.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(bL.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&s.push(dL.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&s.push(_L.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(lxe.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(fxe.configure(this.options.strike)),this.options.text!==!1&&s.push(dxe.configure(this.options.text)),this.options.underline!==!1&&s.push(EL.configure((r=this.options)==null?void 0:r.underline)),this.options.trailingNode!==!1&&s.push(Mxe.configure((n=this.options)==null?void 0:n.trailingNode)),s}}),Lxe=Pxe;const Bxe=({editor:e})=>{if(!e)return null;const t=r=>`
    p-2 rounded-lg transition-all
    ${r?"bg-blue-100 text-blue-600 shadow-inner":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}
  `;return d.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 bg-white border-b border-slate-200 sticky top-0 z-10 transition-shadow duration-300",children:[d.jsx("button",{onClick:()=>e.chain().focus().toggleBold().run(),className:t(e.isActive("bold")),title:"Bold",children:d.jsx(AK,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().toggleItalic().run(),className:t(e.isActive("italic")),title:"Italic",children:d.jsx(vX,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().toggleUnderline().run(),className:t(e.isActive("underline")),title:"Underline",children:d.jsx(dY,{size:18})}),d.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),d.jsx("button",{onClick:()=>e.chain().focus().toggleHeading({level:1}).run(),className:t(e.isActive("heading",{level:1})),title:"Heading 1",children:d.jsx(uX,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().toggleHeading({level:2}).run(),className:t(e.isActive("heading",{level:2})),title:"Heading 2",children:d.jsx(dX,{size:18})}),d.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),d.jsx("button",{onClick:()=>e.chain().focus().toggleBulletList().run(),className:t(e.isActive("bulletList")),title:"Bullet List",children:d.jsx(kX,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().toggleOrderedList().run(),className:t(e.isActive("orderedList")),title:"Ordered List",children:d.jsx(NX,{size:18})}),d.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),d.jsx("button",{onClick:()=>e.chain().focus().undo().run(),disabled:!e.can().undo(),className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100 disabled:opacity-30",title:"Undo",children:d.jsx(KX,{size:18})}),d.jsx("button",{onClick:()=>e.chain().focus().redo().run(),disabled:!e.can().redo(),className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100 disabled:opacity-30",title:"Redo",children:d.jsx(YX,{size:18})})]})},Uxe=({content:e,onChange:t,editable:r=!0})=>{const n=Zpe({extensions:[Lxe,hxe,Kme.configure({openOnClick:!1})],content:e,editable:r,onUpdate:({editor:s})=>{t(s.getJSON(),s.getHTML())},editorProps:{attributes:{class:"prose prose-slate max-w-none focus:outline-none min-h-[700px] p-16 text-slate-800 leading-normal tiptap-editor",style:"font-family: 'Times New Roman', serif; font-size: 11pt;"}}});return We.useEffect(()=>{n&&n.setEditable(r)},[n,r]),d.jsxs("div",{className:"w-full overflow-hidden transition-shadow duration-300",children:[d.jsx("style",{children:`
                .tiptap-editor p {
                    margin-top: 0 !important;
                    margin-bottom: 1.25em !important;
                    line-height: 1.6 !important;
                }
                .tiptap-editor ul {
                    list-style-type: disc !important;
                    margin-bottom: 1.25em !important;
                    padding-left: 1.5em !important;
                }
                .tiptap-editor ol {
                    list-style-type: lower-alpha !important;
                    margin-bottom: 1.25em !important;
                    padding-left: 1.5em !important;
                }
                .tiptap-editor li p {
                    margin-bottom: 0.5em !important;
                }
                .tiptap-editor h1 { margin-bottom: 0.5em !important; }
                .tiptap-editor h2 { margin-bottom: 0.5em !important; }
                `}),r&&d.jsx(Bxe,{editor:n}),d.jsx("div",{className:"p-4 bg-white min-h-200 flex justify-center overflow-y-auto",children:d.jsx("div",{className:"bg-white border  border-slate-200 shadow-md w-full max-w-212.5 min-h-275 animate-fade-in ring-1 ring-slate-900/5",children:d.jsx(ZP,{editor:n})})})]})};var zxe=Object.defineProperty,Hxe=Object.defineProperties,Vxe=Object.getOwnPropertyDescriptors,v6=Object.getOwnPropertySymbols,qxe=Object.prototype.hasOwnProperty,Wxe=Object.prototype.propertyIsEnumerable,gE=(e,t,r)=>t in e?zxe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Dt=(e,t)=>{for(var r in t||(t={}))qxe.call(t,r)&&gE(e,r,t[r]);if(v6)for(var r of v6(t))Wxe.call(t,r)&&gE(e,r,t[r]);return e},Mo=(e,t)=>Hxe(e,Vxe(t)),Pe=(e,t,r)=>gE(e,typeof t!="symbol"?t+"":t,r),$xe=(e,t,r)=>new Promise((n,s)=>{var a=c=>{try{o(r.next(c))}catch(f){s(f)}},i=c=>{try{o(r.throw(c))}catch(f){s(f)}},o=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,i);o((r=r.apply(e,t)).next())});class t1{constructor(t){Pe(this,"rootKey"),this.rootKey=t}}const Gxe=Object.seal({});class Be extends t1{constructor(t){super(t),Pe(this,"root"),this.root=new Array}prepForXml(t){var r;t.stack.push(this);const n=this.root.map(s=>s instanceof t1?s.prepForXml(t):s).filter(s=>s!==void 0);return t.stack.pop(),{[this.rootKey]:n.length?n.length===1&&((r=n[0])!=null&&r._attr)?n[0]:n:Gxe}}addChildElement(t){return this.root.push(t),this}}class X1 extends Be{prepForXml(t){const r=super.prepForXml(t);if(r&&(typeof r[this.rootKey]!="object"||Object.keys(r[this.rootKey]).length))return r}}class ut extends t1{constructor(t){super("_attr"),Pe(this,"xmlKeys"),this.root=t}prepForXml(t){const r={};return Object.entries(this.root).forEach(([n,s])=>{if(s!==void 0){const a=this.xmlKeys&&this.xmlKeys[n]||n;r[a]=s}}),{_attr:r}}}class dp extends t1{constructor(t){super("_attr"),this.root=t}prepForXml(t){return{_attr:Object.values(this.root).filter(({value:n})=>n!==void 0).reduce((n,{key:s,value:a})=>Mo(Dt({},n),{[s]:a}),{})}}}class tn extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Fi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function CN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var vw={},ux={exports:{}},b6;function RN(){if(b6)return ux.exports;b6=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(k,D,O){return Function.prototype.apply.call(k,D,O)},r;e&&typeof e.ownKeys=="function"?r=e.ownKeys:Object.getOwnPropertySymbols?r=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:r=function(k){return Object.getOwnPropertyNames(k)};function n(T){console&&console.warn&&console.warn(T)}var s=Number.isNaN||function(k){return k!==k};function a(){a.init.call(this)}ux.exports=a,ux.exports.once=_,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var i=10;function o(T){if(typeof T!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof T)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(T){if(typeof T!="number"||T<0||s(T))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+T+".");i=T}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function c(T){return T._maxListeners===void 0?a.defaultMaxListeners:T._maxListeners}a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(k){for(var D=[],O=1;O<arguments.length;O++)D.push(arguments[O]);var z=k==="error",j=this._events;if(j!==void 0)z=z&&j.error===void 0;else if(!z)return!1;if(z){var J;if(D.length>0&&(J=D[0]),J instanceof Error)throw J;var ae=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw ae.context=J,ae}var F=j[k];if(F===void 0)return!1;if(typeof F=="function")t(F,this,D);else for(var X=F.length,P=v(F,X),O=0;O<X;++O)t(P[O],this,D);return!0};function f(T,k,D,O){var z,j,J;if(o(D),j=T._events,j===void 0?(j=T._events=Object.create(null),T._eventsCount=0):(j.newListener!==void 0&&(T.emit("newListener",k,D.listener?D.listener:D),j=T._events),J=j[k]),J===void 0)J=j[k]=D,++T._eventsCount;else if(typeof J=="function"?J=j[k]=O?[D,J]:[J,D]:O?J.unshift(D):J.push(D),z=c(T),z>0&&J.length>z&&!J.warned){J.warned=!0;var ae=new Error("Possible EventEmitter memory leak detected. "+J.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");ae.name="MaxListenersExceededWarning",ae.emitter=T,ae.type=k,ae.count=J.length,n(ae)}return T}a.prototype.addListener=function(k,D){return f(this,k,D,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(k,D){return f(this,k,D,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(T,k,D){var O={fired:!1,wrapFn:void 0,target:T,type:k,listener:D},z=h.bind(O);return z.listener=D,O.wrapFn=z,z}a.prototype.once=function(k,D){return o(D),this.on(k,p(this,k,D)),this},a.prototype.prependOnceListener=function(k,D){return o(D),this.prependListener(k,p(this,k,D)),this},a.prototype.removeListener=function(k,D){var O,z,j,J,ae;if(o(D),z=this._events,z===void 0)return this;if(O=z[k],O===void 0)return this;if(O===D||O.listener===D)--this._eventsCount===0?this._events=Object.create(null):(delete z[k],z.removeListener&&this.emit("removeListener",k,O.listener||D));else if(typeof O!="function"){for(j=-1,J=O.length-1;J>=0;J--)if(O[J]===D||O[J].listener===D){ae=O[J].listener,j=J;break}if(j<0)return this;j===0?O.shift():y(O,j),O.length===1&&(z[k]=O[0]),z.removeListener!==void 0&&this.emit("removeListener",k,ae||D)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(k){var D,O,z;if(O=this._events,O===void 0)return this;if(O.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):O[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete O[k]),this;if(arguments.length===0){var j=Object.keys(O),J;for(z=0;z<j.length;++z)J=j[z],J!=="removeListener"&&this.removeAllListeners(J);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(D=O[k],typeof D=="function")this.removeListener(k,D);else if(D!==void 0)for(z=D.length-1;z>=0;z--)this.removeListener(k,D[z]);return this};function x(T,k,D){var O=T._events;if(O===void 0)return[];var z=O[k];return z===void 0?[]:typeof z=="function"?D?[z.listener||z]:[z]:D?w(z):v(z,z.length)}a.prototype.listeners=function(k){return x(this,k,!0)},a.prototype.rawListeners=function(k){return x(this,k,!1)},a.listenerCount=function(T,k){return typeof T.listenerCount=="function"?T.listenerCount(k):g.call(T,k)},a.prototype.listenerCount=g;function g(T){var k=this._events;if(k!==void 0){var D=k[T];if(typeof D=="function")return 1;if(D!==void 0)return D.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function v(T,k){for(var D=new Array(k),O=0;O<k;++O)D[O]=T[O];return D}function y(T,k){for(;k+1<T.length;k++)T[k]=T[k+1];T.pop()}function w(T){for(var k=new Array(T.length),D=0;D<k.length;++D)k[D]=T[D].listener||T[D];return k}function _(T,k){return new Promise(function(D,O){function z(J){T.removeListener(k,j),O(J)}function j(){typeof T.removeListener=="function"&&T.removeListener("error",z),D([].slice.call(arguments))}E(T,k,j,{once:!0}),k!=="error"&&S(T,z,{once:!0})})}function S(T,k,D){typeof T.on=="function"&&E(T,"error",k,D)}function E(T,k,D,O){if(typeof T.on=="function")O.once?T.once(k,D):T.on(k,D);else if(typeof T.addEventListener=="function")T.addEventListener(k,function z(j){O.once&&T.removeEventListener(k,z),D(j)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof T)}return ux.exports}var fx={exports:{}},w6;function Ql(){return w6||(w6=1,typeof Object.create=="function"?fx.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:fx.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}}),fx.exports}function Kxe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var RL={exports:{}},rn=RL.exports={},ji,Di;function yE(){throw new Error("setTimeout has not been defined")}function vE(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?ji=setTimeout:ji=yE}catch{ji=yE}try{typeof clearTimeout=="function"?Di=clearTimeout:Di=vE}catch{Di=vE}})();function OL(e){if(ji===setTimeout)return setTimeout(e,0);if((ji===yE||!ji)&&setTimeout)return ji=setTimeout,setTimeout(e,0);try{return ji(e,0)}catch{try{return ji.call(null,e,0)}catch{return ji.call(this,e,0)}}}function Xxe(e){if(Di===clearTimeout)return clearTimeout(e);if((Di===vE||!Di)&&clearTimeout)return Di=clearTimeout,clearTimeout(e);try{return Di(e)}catch{try{return Di.call(null,e)}catch{return Di.call(this,e)}}}var _o=[],_f=!1,Oc,Lx=-1;function Yxe(){!_f||!Oc||(_f=!1,Oc.length?_o=Oc.concat(_o):Lx=-1,_o.length&&jL())}function jL(){if(!_f){var e=OL(Yxe);_f=!0;for(var t=_o.length;t;){for(Oc=_o,_o=[];++Lx<t;)Oc&&Oc[Lx].run();Lx=-1,t=_o.length}Oc=null,_f=!1,Xxe(e)}}rn.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];_o.push(new DL(e,t)),_o.length===1&&!_f&&OL(jL)};function DL(e,t){this.fun=e,this.array=t}DL.prototype.run=function(){this.fun.apply(null,this.array)};rn.title="browser";rn.browser=!0;rn.env={};rn.argv=[];rn.version="";rn.versions={};function Ho(){}rn.on=Ho;rn.addListener=Ho;rn.once=Ho;rn.off=Ho;rn.removeListener=Ho;rn.removeAllListeners=Ho;rn.emit=Ho;rn.prependListener=Ho;rn.prependOnceListener=Ho;rn.listeners=function(e){return[]};rn.binding=function(e){throw new Error("process.binding is not supported")};rn.cwd=function(){return"/"};rn.chdir=function(e){throw new Error("process.chdir is not supported")};rn.umask=function(){return 0};var Jxe=RL.exports;const Mt=Kxe(Jxe);var bw,_6;function IL(){return _6||(_6=1,bw=RN().EventEmitter),bw}var ww={},bh={},E6;function Zxe(){if(E6)return bh;E6=1,bh.byteLength=o,bh.toByteArray=f,bh.fromByteArray=x;for(var e=[],t=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=n.length;s<a;++s)e[s]=n[s],t[n.charCodeAt(s)]=s;t[45]=62,t[95]=63;function i(g){var v=g.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=g.indexOf("=");y===-1&&(y=v);var w=y===v?0:4-y%4;return[y,w]}function o(g){var v=i(g),y=v[0],w=v[1];return(y+w)*3/4-w}function c(g,v,y){return(v+y)*3/4-y}function f(g){var v,y=i(g),w=y[0],_=y[1],S=new r(c(g,w,_)),E=0,T=_>0?w-4:w,k;for(k=0;k<T;k+=4)v=t[g.charCodeAt(k)]<<18|t[g.charCodeAt(k+1)]<<12|t[g.charCodeAt(k+2)]<<6|t[g.charCodeAt(k+3)],S[E++]=v>>16&255,S[E++]=v>>8&255,S[E++]=v&255;return _===2&&(v=t[g.charCodeAt(k)]<<2|t[g.charCodeAt(k+1)]>>4,S[E++]=v&255),_===1&&(v=t[g.charCodeAt(k)]<<10|t[g.charCodeAt(k+1)]<<4|t[g.charCodeAt(k+2)]>>2,S[E++]=v>>8&255,S[E++]=v&255),S}function h(g){return e[g>>18&63]+e[g>>12&63]+e[g>>6&63]+e[g&63]}function p(g,v,y){for(var w,_=[],S=v;S<y;S+=3)w=(g[S]<<16&16711680)+(g[S+1]<<8&65280)+(g[S+2]&255),_.push(h(w));return _.join("")}function x(g){for(var v,y=g.length,w=y%3,_=[],S=16383,E=0,T=y-w;E<T;E+=S)_.push(p(g,E,E+S>T?T:E+S));return w===1?(v=g[y-1],_.push(e[v>>2]+e[v<<4&63]+"==")):w===2&&(v=(g[y-2]<<8)+g[y-1],_.push(e[v>>10]+e[v>>4&63]+e[v<<2&63]+"=")),_.join("")}return bh}var dx={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var S6;function Qxe(){return S6||(S6=1,dx.read=function(e,t,r,n,s){var a,i,o=s*8-n-1,c=(1<<o)-1,f=c>>1,h=-7,p=r?s-1:0,x=r?-1:1,g=e[t+p];for(p+=x,a=g&(1<<-h)-1,g>>=-h,h+=o;h>0;a=a*256+e[t+p],p+=x,h-=8);for(i=a&(1<<-h)-1,a>>=-h,h+=n;h>0;i=i*256+e[t+p],p+=x,h-=8);if(a===0)a=1-f;else{if(a===c)return i?NaN:(g?-1:1)*(1/0);i=i+Math.pow(2,n),a=a-f}return(g?-1:1)*i*Math.pow(2,a-n)},dx.write=function(e,t,r,n,s,a){var i,o,c,f=a*8-s-1,h=(1<<f)-1,p=h>>1,x=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:a-1,v=n?1:-1,y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,i=h):(i=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-i))<1&&(i--,c*=2),i+p>=1?t+=x/c:t+=x*Math.pow(2,1-p),t*c>=2&&(i++,c/=2),i+p>=h?(o=0,i=h):i+p>=1?(o=(t*c-1)*Math.pow(2,s),i=i+p):(o=t*Math.pow(2,p-1)*Math.pow(2,s),i=0));s>=8;e[r+g]=o&255,g+=v,o/=256,s-=8);for(i=i<<s|o,f+=s;f>0;e[r+g]=i&255,g+=v,i/=256,f-=8);e[r+g-v]|=y*128}),dx}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var N6;function Y1(){return N6||(N6=1,(function(e){var t=Zxe(),r=Qxe(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=S,e.INSPECT_MAX_BYTES=50;var s=2147483647;e.kMaxLength=s,o.TYPED_ARRAY_SUPPORT=a(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{var V=new Uint8Array(1),C={foo:function(){return 42}};return Object.setPrototypeOf(C,Uint8Array.prototype),Object.setPrototypeOf(V,C),V.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function i(V){if(V>s)throw new RangeError('The value "'+V+'" is invalid for option "size"');var C=new Uint8Array(V);return Object.setPrototypeOf(C,o.prototype),C}function o(V,C,A){if(typeof V=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(V)}return c(V,C,A)}o.poolSize=8192;function c(V,C,A){if(typeof V=="string")return x(V,C);if(ArrayBuffer.isView(V))return v(V);if(V==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V);if(we(V,ArrayBuffer)||V&&we(V.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(we(V,SharedArrayBuffer)||V&&we(V.buffer,SharedArrayBuffer)))return y(V,C,A);if(typeof V=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var H=V.valueOf&&V.valueOf();if(H!=null&&H!==V)return o.from(H,C,A);var ue=w(V);if(ue)return ue;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof V[Symbol.toPrimitive]=="function")return o.from(V[Symbol.toPrimitive]("string"),C,A);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V)}o.from=function(V,C,A){return c(V,C,A)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function f(V){if(typeof V!="number")throw new TypeError('"size" argument must be of type number');if(V<0)throw new RangeError('The value "'+V+'" is invalid for option "size"')}function h(V,C,A){return f(V),V<=0?i(V):C!==void 0?typeof A=="string"?i(V).fill(C,A):i(V).fill(C):i(V)}o.alloc=function(V,C,A){return h(V,C,A)};function p(V){return f(V),i(V<0?0:_(V)|0)}o.allocUnsafe=function(V){return p(V)},o.allocUnsafeSlow=function(V){return p(V)};function x(V,C){if((typeof C!="string"||C==="")&&(C="utf8"),!o.isEncoding(C))throw new TypeError("Unknown encoding: "+C);var A=E(V,C)|0,H=i(A),ue=H.write(V,C);return ue!==A&&(H=H.slice(0,ue)),H}function g(V){for(var C=V.length<0?0:_(V.length)|0,A=i(C),H=0;H<C;H+=1)A[H]=V[H]&255;return A}function v(V){if(we(V,Uint8Array)){var C=new Uint8Array(V);return y(C.buffer,C.byteOffset,C.byteLength)}return g(V)}function y(V,C,A){if(C<0||V.byteLength<C)throw new RangeError('"offset" is outside of buffer bounds');if(V.byteLength<C+(A||0))throw new RangeError('"length" is outside of buffer bounds');var H;return C===void 0&&A===void 0?H=new Uint8Array(V):A===void 0?H=new Uint8Array(V,C):H=new Uint8Array(V,C,A),Object.setPrototypeOf(H,o.prototype),H}function w(V){if(o.isBuffer(V)){var C=_(V.length)|0,A=i(C);return A.length===0||V.copy(A,0,0,C),A}if(V.length!==void 0)return typeof V.length!="number"||B(V.length)?i(0):g(V);if(V.type==="Buffer"&&Array.isArray(V.data))return g(V.data)}function _(V){if(V>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return V|0}function S(V){return+V!=V&&(V=0),o.alloc(+V)}o.isBuffer=function(C){return C!=null&&C._isBuffer===!0&&C!==o.prototype},o.compare=function(C,A){if(we(C,Uint8Array)&&(C=o.from(C,C.offset,C.byteLength)),we(A,Uint8Array)&&(A=o.from(A,A.offset,A.byteLength)),!o.isBuffer(C)||!o.isBuffer(A))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(C===A)return 0;for(var H=C.length,ue=A.length,ye=0,he=Math.min(H,ue);ye<he;++ye)if(C[ye]!==A[ye]){H=C[ye],ue=A[ye];break}return H<ue?-1:ue<H?1:0},o.isEncoding=function(C){switch(String(C).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(C,A){if(!Array.isArray(C))throw new TypeError('"list" argument must be an Array of Buffers');if(C.length===0)return o.alloc(0);var H;if(A===void 0)for(A=0,H=0;H<C.length;++H)A+=C[H].length;var ue=o.allocUnsafe(A),ye=0;for(H=0;H<C.length;++H){var he=C[H];if(we(he,Uint8Array))ye+he.length>ue.length?o.from(he).copy(ue,ye):Uint8Array.prototype.set.call(ue,he,ye);else if(o.isBuffer(he))he.copy(ue,ye);else throw new TypeError('"list" argument must be an Array of Buffers');ye+=he.length}return ue};function E(V,C){if(o.isBuffer(V))return V.length;if(ArrayBuffer.isView(V)||we(V,ArrayBuffer))return V.byteLength;if(typeof V!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof V);var A=V.length,H=arguments.length>2&&arguments[2]===!0;if(!H&&A===0)return 0;for(var ue=!1;;)switch(C){case"ascii":case"latin1":case"binary":return A;case"utf8":case"utf-8":return I(V).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A*2;case"hex":return A>>>1;case"base64":return Y(V).length;default:if(ue)return H?-1:I(V).length;C=(""+C).toLowerCase(),ue=!0}}o.byteLength=E;function T(V,C,A){var H=!1;if((C===void 0||C<0)&&(C=0),C>this.length||((A===void 0||A>this.length)&&(A=this.length),A<=0)||(A>>>=0,C>>>=0,A<=C))return"";for(V||(V="utf8");;)switch(V){case"hex":return ie(this,C,A);case"utf8":case"utf-8":return P(this,C,A);case"ascii":return te(this,C,A);case"latin1":case"binary":return me(this,C,A);case"base64":return X(this,C,A);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ee(this,C,A);default:if(H)throw new TypeError("Unknown encoding: "+V);V=(V+"").toLowerCase(),H=!0}}o.prototype._isBuffer=!0;function k(V,C,A){var H=V[C];V[C]=V[A],V[A]=H}o.prototype.swap16=function(){var C=this.length;if(C%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var A=0;A<C;A+=2)k(this,A,A+1);return this},o.prototype.swap32=function(){var C=this.length;if(C%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var A=0;A<C;A+=4)k(this,A,A+3),k(this,A+1,A+2);return this},o.prototype.swap64=function(){var C=this.length;if(C%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var A=0;A<C;A+=8)k(this,A,A+7),k(this,A+1,A+6),k(this,A+2,A+5),k(this,A+3,A+4);return this},o.prototype.toString=function(){var C=this.length;return C===0?"":arguments.length===0?P(this,0,C):T.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(C){if(!o.isBuffer(C))throw new TypeError("Argument must be a Buffer");return this===C?!0:o.compare(this,C)===0},o.prototype.inspect=function(){var C="",A=e.INSPECT_MAX_BYTES;return C=this.toString("hex",0,A).replace(/(.{2})/g,"$1 ").trim(),this.length>A&&(C+=" ... "),"<Buffer "+C+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(C,A,H,ue,ye){if(we(C,Uint8Array)&&(C=o.from(C,C.offset,C.byteLength)),!o.isBuffer(C))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof C);if(A===void 0&&(A=0),H===void 0&&(H=C?C.length:0),ue===void 0&&(ue=0),ye===void 0&&(ye=this.length),A<0||H>C.length||ue<0||ye>this.length)throw new RangeError("out of range index");if(ue>=ye&&A>=H)return 0;if(ue>=ye)return-1;if(A>=H)return 1;if(A>>>=0,H>>>=0,ue>>>=0,ye>>>=0,this===C)return 0;for(var he=ye-ue,ke=H-A,De=Math.min(he,ke),Fe=this.slice(ue,ye),$e=C.slice(A,H),rt=0;rt<De;++rt)if(Fe[rt]!==$e[rt]){he=Fe[rt],ke=$e[rt];break}return he<ke?-1:ke<he?1:0};function D(V,C,A,H,ue){if(V.length===0)return-1;if(typeof A=="string"?(H=A,A=0):A>2147483647?A=2147483647:A<-2147483648&&(A=-2147483648),A=+A,B(A)&&(A=ue?0:V.length-1),A<0&&(A=V.length+A),A>=V.length){if(ue)return-1;A=V.length-1}else if(A<0)if(ue)A=0;else return-1;if(typeof C=="string"&&(C=o.from(C,H)),o.isBuffer(C))return C.length===0?-1:O(V,C,A,H,ue);if(typeof C=="number")return C=C&255,typeof Uint8Array.prototype.indexOf=="function"?ue?Uint8Array.prototype.indexOf.call(V,C,A):Uint8Array.prototype.lastIndexOf.call(V,C,A):O(V,[C],A,H,ue);throw new TypeError("val must be string, number or Buffer")}function O(V,C,A,H,ue){var ye=1,he=V.length,ke=C.length;if(H!==void 0&&(H=String(H).toLowerCase(),H==="ucs2"||H==="ucs-2"||H==="utf16le"||H==="utf-16le")){if(V.length<2||C.length<2)return-1;ye=2,he/=2,ke/=2,A/=2}function De(qt,dt){return ye===1?qt[dt]:qt.readUInt16BE(dt*ye)}var Fe;if(ue){var $e=-1;for(Fe=A;Fe<he;Fe++)if(De(V,Fe)===De(C,$e===-1?0:Fe-$e)){if($e===-1&&($e=Fe),Fe-$e+1===ke)return $e*ye}else $e!==-1&&(Fe-=Fe-$e),$e=-1}else for(A+ke>he&&(A=he-ke),Fe=A;Fe>=0;Fe--){for(var rt=!0,at=0;at<ke;at++)if(De(V,Fe+at)!==De(C,at)){rt=!1;break}if(rt)return Fe}return-1}o.prototype.includes=function(C,A,H){return this.indexOf(C,A,H)!==-1},o.prototype.indexOf=function(C,A,H){return D(this,C,A,H,!0)},o.prototype.lastIndexOf=function(C,A,H){return D(this,C,A,H,!1)};function z(V,C,A,H){A=Number(A)||0;var ue=V.length-A;H?(H=Number(H),H>ue&&(H=ue)):H=ue;var ye=C.length;H>ye/2&&(H=ye/2);for(var he=0;he<H;++he){var ke=parseInt(C.substr(he*2,2),16);if(B(ke))return he;V[A+he]=ke}return he}function j(V,C,A,H){return U(I(C,V.length-A),V,A,H)}function J(V,C,A,H){return U(se(C),V,A,H)}function ae(V,C,A,H){return U(Y(C),V,A,H)}function F(V,C,A,H){return U(Q(C,V.length-A),V,A,H)}o.prototype.write=function(C,A,H,ue){if(A===void 0)ue="utf8",H=this.length,A=0;else if(H===void 0&&typeof A=="string")ue=A,H=this.length,A=0;else if(isFinite(A))A=A>>>0,isFinite(H)?(H=H>>>0,ue===void 0&&(ue="utf8")):(ue=H,H=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ye=this.length-A;if((H===void 0||H>ye)&&(H=ye),C.length>0&&(H<0||A<0)||A>this.length)throw new RangeError("Attempt to write outside buffer bounds");ue||(ue="utf8");for(var he=!1;;)switch(ue){case"hex":return z(this,C,A,H);case"utf8":case"utf-8":return j(this,C,A,H);case"ascii":case"latin1":case"binary":return J(this,C,A,H);case"base64":return ae(this,C,A,H);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,C,A,H);default:if(he)throw new TypeError("Unknown encoding: "+ue);ue=(""+ue).toLowerCase(),he=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function X(V,C,A){return C===0&&A===V.length?t.fromByteArray(V):t.fromByteArray(V.slice(C,A))}function P(V,C,A){A=Math.min(V.length,A);for(var H=[],ue=C;ue<A;){var ye=V[ue],he=null,ke=ye>239?4:ye>223?3:ye>191?2:1;if(ue+ke<=A){var De,Fe,$e,rt;switch(ke){case 1:ye<128&&(he=ye);break;case 2:De=V[ue+1],(De&192)===128&&(rt=(ye&31)<<6|De&63,rt>127&&(he=rt));break;case 3:De=V[ue+1],Fe=V[ue+2],(De&192)===128&&(Fe&192)===128&&(rt=(ye&15)<<12|(De&63)<<6|Fe&63,rt>2047&&(rt<55296||rt>57343)&&(he=rt));break;case 4:De=V[ue+1],Fe=V[ue+2],$e=V[ue+3],(De&192)===128&&(Fe&192)===128&&($e&192)===128&&(rt=(ye&15)<<18|(De&63)<<12|(Fe&63)<<6|$e&63,rt>65535&&rt<1114112&&(he=rt))}}he===null?(he=65533,ke=1):he>65535&&(he-=65536,H.push(he>>>10&1023|55296),he=56320|he&1023),H.push(he),ue+=ke}return ee(H)}var le=4096;function ee(V){var C=V.length;if(C<=le)return String.fromCharCode.apply(String,V);for(var A="",H=0;H<C;)A+=String.fromCharCode.apply(String,V.slice(H,H+=le));return A}function te(V,C,A){var H="";A=Math.min(V.length,A);for(var ue=C;ue<A;++ue)H+=String.fromCharCode(V[ue]&127);return H}function me(V,C,A){var H="";A=Math.min(V.length,A);for(var ue=C;ue<A;++ue)H+=String.fromCharCode(V[ue]);return H}function ie(V,C,A){var H=V.length;(!C||C<0)&&(C=0),(!A||A<0||A>H)&&(A=H);for(var ue="",ye=C;ye<A;++ye)ue+=be[V[ye]];return ue}function Ee(V,C,A){for(var H=V.slice(C,A),ue="",ye=0;ye<H.length-1;ye+=2)ue+=String.fromCharCode(H[ye]+H[ye+1]*256);return ue}o.prototype.slice=function(C,A){var H=this.length;C=~~C,A=A===void 0?H:~~A,C<0?(C+=H,C<0&&(C=0)):C>H&&(C=H),A<0?(A+=H,A<0&&(A=0)):A>H&&(A=H),A<C&&(A=C);var ue=this.subarray(C,A);return Object.setPrototypeOf(ue,o.prototype),ue};function K(V,C,A){if(V%1!==0||V<0)throw new RangeError("offset is not uint");if(V+C>A)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(C,A,H){C=C>>>0,A=A>>>0,H||K(C,A,this.length);for(var ue=this[C],ye=1,he=0;++he<A&&(ye*=256);)ue+=this[C+he]*ye;return ue},o.prototype.readUintBE=o.prototype.readUIntBE=function(C,A,H){C=C>>>0,A=A>>>0,H||K(C,A,this.length);for(var ue=this[C+--A],ye=1;A>0&&(ye*=256);)ue+=this[C+--A]*ye;return ue},o.prototype.readUint8=o.prototype.readUInt8=function(C,A){return C=C>>>0,A||K(C,1,this.length),this[C]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(C,A){return C=C>>>0,A||K(C,2,this.length),this[C]|this[C+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(C,A){return C=C>>>0,A||K(C,2,this.length),this[C]<<8|this[C+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(C,A){return C=C>>>0,A||K(C,4,this.length),(this[C]|this[C+1]<<8|this[C+2]<<16)+this[C+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(C,A){return C=C>>>0,A||K(C,4,this.length),this[C]*16777216+(this[C+1]<<16|this[C+2]<<8|this[C+3])},o.prototype.readIntLE=function(C,A,H){C=C>>>0,A=A>>>0,H||K(C,A,this.length);for(var ue=this[C],ye=1,he=0;++he<A&&(ye*=256);)ue+=this[C+he]*ye;return ye*=128,ue>=ye&&(ue-=Math.pow(2,8*A)),ue},o.prototype.readIntBE=function(C,A,H){C=C>>>0,A=A>>>0,H||K(C,A,this.length);for(var ue=A,ye=1,he=this[C+--ue];ue>0&&(ye*=256);)he+=this[C+--ue]*ye;return ye*=128,he>=ye&&(he-=Math.pow(2,8*A)),he},o.prototype.readInt8=function(C,A){return C=C>>>0,A||K(C,1,this.length),this[C]&128?(255-this[C]+1)*-1:this[C]},o.prototype.readInt16LE=function(C,A){C=C>>>0,A||K(C,2,this.length);var H=this[C]|this[C+1]<<8;return H&32768?H|4294901760:H},o.prototype.readInt16BE=function(C,A){C=C>>>0,A||K(C,2,this.length);var H=this[C+1]|this[C]<<8;return H&32768?H|4294901760:H},o.prototype.readInt32LE=function(C,A){return C=C>>>0,A||K(C,4,this.length),this[C]|this[C+1]<<8|this[C+2]<<16|this[C+3]<<24},o.prototype.readInt32BE=function(C,A){return C=C>>>0,A||K(C,4,this.length),this[C]<<24|this[C+1]<<16|this[C+2]<<8|this[C+3]},o.prototype.readFloatLE=function(C,A){return C=C>>>0,A||K(C,4,this.length),r.read(this,C,!0,23,4)},o.prototype.readFloatBE=function(C,A){return C=C>>>0,A||K(C,4,this.length),r.read(this,C,!1,23,4)},o.prototype.readDoubleLE=function(C,A){return C=C>>>0,A||K(C,8,this.length),r.read(this,C,!0,52,8)},o.prototype.readDoubleBE=function(C,A){return C=C>>>0,A||K(C,8,this.length),r.read(this,C,!1,52,8)};function M(V,C,A,H,ue,ye){if(!o.isBuffer(V))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>ue||C<ye)throw new RangeError('"value" argument is out of bounds');if(A+H>V.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(C,A,H,ue){if(C=+C,A=A>>>0,H=H>>>0,!ue){var ye=Math.pow(2,8*H)-1;M(this,C,A,H,ye,0)}var he=1,ke=0;for(this[A]=C&255;++ke<H&&(he*=256);)this[A+ke]=C/he&255;return A+H},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(C,A,H,ue){if(C=+C,A=A>>>0,H=H>>>0,!ue){var ye=Math.pow(2,8*H)-1;M(this,C,A,H,ye,0)}var he=H-1,ke=1;for(this[A+he]=C&255;--he>=0&&(ke*=256);)this[A+he]=C/ke&255;return A+H},o.prototype.writeUint8=o.prototype.writeUInt8=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,1,255,0),this[A]=C&255,A+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,2,65535,0),this[A]=C&255,this[A+1]=C>>>8,A+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,2,65535,0),this[A]=C>>>8,this[A+1]=C&255,A+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,4,4294967295,0),this[A+3]=C>>>24,this[A+2]=C>>>16,this[A+1]=C>>>8,this[A]=C&255,A+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,4,4294967295,0),this[A]=C>>>24,this[A+1]=C>>>16,this[A+2]=C>>>8,this[A+3]=C&255,A+4},o.prototype.writeIntLE=function(C,A,H,ue){if(C=+C,A=A>>>0,!ue){var ye=Math.pow(2,8*H-1);M(this,C,A,H,ye-1,-ye)}var he=0,ke=1,De=0;for(this[A]=C&255;++he<H&&(ke*=256);)C<0&&De===0&&this[A+he-1]!==0&&(De=1),this[A+he]=(C/ke>>0)-De&255;return A+H},o.prototype.writeIntBE=function(C,A,H,ue){if(C=+C,A=A>>>0,!ue){var ye=Math.pow(2,8*H-1);M(this,C,A,H,ye-1,-ye)}var he=H-1,ke=1,De=0;for(this[A+he]=C&255;--he>=0&&(ke*=256);)C<0&&De===0&&this[A+he+1]!==0&&(De=1),this[A+he]=(C/ke>>0)-De&255;return A+H},o.prototype.writeInt8=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,1,127,-128),C<0&&(C=255+C+1),this[A]=C&255,A+1},o.prototype.writeInt16LE=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,2,32767,-32768),this[A]=C&255,this[A+1]=C>>>8,A+2},o.prototype.writeInt16BE=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,2,32767,-32768),this[A]=C>>>8,this[A+1]=C&255,A+2},o.prototype.writeInt32LE=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,4,2147483647,-2147483648),this[A]=C&255,this[A+1]=C>>>8,this[A+2]=C>>>16,this[A+3]=C>>>24,A+4},o.prototype.writeInt32BE=function(C,A,H){return C=+C,A=A>>>0,H||M(this,C,A,4,2147483647,-2147483648),C<0&&(C=4294967295+C+1),this[A]=C>>>24,this[A+1]=C>>>16,this[A+2]=C>>>8,this[A+3]=C&255,A+4};function q(V,C,A,H,ue,ye){if(A+H>V.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("Index out of range")}function G(V,C,A,H,ue){return C=+C,A=A>>>0,ue||q(V,C,A,4),r.write(V,C,A,H,23,4),A+4}o.prototype.writeFloatLE=function(C,A,H){return G(this,C,A,!0,H)},o.prototype.writeFloatBE=function(C,A,H){return G(this,C,A,!1,H)};function Z(V,C,A,H,ue){return C=+C,A=A>>>0,ue||q(V,C,A,8),r.write(V,C,A,H,52,8),A+8}o.prototype.writeDoubleLE=function(C,A,H){return Z(this,C,A,!0,H)},o.prototype.writeDoubleBE=function(C,A,H){return Z(this,C,A,!1,H)},o.prototype.copy=function(C,A,H,ue){if(!o.isBuffer(C))throw new TypeError("argument should be a Buffer");if(H||(H=0),!ue&&ue!==0&&(ue=this.length),A>=C.length&&(A=C.length),A||(A=0),ue>0&&ue<H&&(ue=H),ue===H||C.length===0||this.length===0)return 0;if(A<0)throw new RangeError("targetStart out of bounds");if(H<0||H>=this.length)throw new RangeError("Index out of range");if(ue<0)throw new RangeError("sourceEnd out of bounds");ue>this.length&&(ue=this.length),C.length-A<ue-H&&(ue=C.length-A+H);var ye=ue-H;return this===C&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(A,H,ue):Uint8Array.prototype.set.call(C,this.subarray(H,ue),A),ye},o.prototype.fill=function(C,A,H,ue){if(typeof C=="string"){if(typeof A=="string"?(ue=A,A=0,H=this.length):typeof H=="string"&&(ue=H,H=this.length),ue!==void 0&&typeof ue!="string")throw new TypeError("encoding must be a string");if(typeof ue=="string"&&!o.isEncoding(ue))throw new TypeError("Unknown encoding: "+ue);if(C.length===1){var ye=C.charCodeAt(0);(ue==="utf8"&&ye<128||ue==="latin1")&&(C=ye)}}else typeof C=="number"?C=C&255:typeof C=="boolean"&&(C=Number(C));if(A<0||this.length<A||this.length<H)throw new RangeError("Out of range index");if(H<=A)return this;A=A>>>0,H=H===void 0?this.length:H>>>0,C||(C=0);var he;if(typeof C=="number")for(he=A;he<H;++he)this[he]=C;else{var ke=o.isBuffer(C)?C:o.from(C,ue),De=ke.length;if(De===0)throw new TypeError('The value "'+C+'" is invalid for argument "value"');for(he=0;he<H-A;++he)this[he+A]=ke[he%De]}return this};var re=/[^+/0-9A-Za-z-_]/g;function L(V){if(V=V.split("=")[0],V=V.trim().replace(re,""),V.length<2)return"";for(;V.length%4!==0;)V=V+"=";return V}function I(V,C){C=C||1/0;for(var A,H=V.length,ue=null,ye=[],he=0;he<H;++he){if(A=V.charCodeAt(he),A>55295&&A<57344){if(!ue){if(A>56319){(C-=3)>-1&&ye.push(239,191,189);continue}else if(he+1===H){(C-=3)>-1&&ye.push(239,191,189);continue}ue=A;continue}if(A<56320){(C-=3)>-1&&ye.push(239,191,189),ue=A;continue}A=(ue-55296<<10|A-56320)+65536}else ue&&(C-=3)>-1&&ye.push(239,191,189);if(ue=null,A<128){if((C-=1)<0)break;ye.push(A)}else if(A<2048){if((C-=2)<0)break;ye.push(A>>6|192,A&63|128)}else if(A<65536){if((C-=3)<0)break;ye.push(A>>12|224,A>>6&63|128,A&63|128)}else if(A<1114112){if((C-=4)<0)break;ye.push(A>>18|240,A>>12&63|128,A>>6&63|128,A&63|128)}else throw new Error("Invalid code point")}return ye}function se(V){for(var C=[],A=0;A<V.length;++A)C.push(V.charCodeAt(A)&255);return C}function Q(V,C){for(var A,H,ue,ye=[],he=0;he<V.length&&!((C-=2)<0);++he)A=V.charCodeAt(he),H=A>>8,ue=A%256,ye.push(ue),ye.push(H);return ye}function Y(V){return t.toByteArray(L(V))}function U(V,C,A,H){for(var ue=0;ue<H&&!(ue+A>=C.length||ue>=V.length);++ue)C[ue+A]=V[ue];return ue}function we(V,C){return V instanceof C||V!=null&&V.constructor!=null&&V.constructor.name!=null&&V.constructor.name===C.name}function B(V){return V!==V}var be=(function(){for(var V="0123456789abcdef",C=new Array(256),A=0;A<16;++A)for(var H=A*16,ue=0;ue<16;++ue)C[H+ue]=V[A]+V[ue];return C})()})(ww)),ww}var _w={},Ew={},Sw,T6;function ML(){return T6||(T6=1,Sw=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;t[r]=s;for(var a in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,r);if(o.value!==s||o.enumerable!==!0)return!1}return!0}),Sw}var Nw,k6;function ON(){if(k6)return Nw;k6=1;var e=ML();return Nw=function(){return e()&&!!Symbol.toStringTag},Nw}var Tw,A6;function FL(){return A6||(A6=1,Tw=Object),Tw}var kw,C6;function ege(){return C6||(C6=1,kw=Error),kw}var Aw,R6;function tge(){return R6||(R6=1,Aw=EvalError),Aw}var Cw,O6;function rge(){return O6||(O6=1,Cw=RangeError),Cw}var Rw,j6;function nge(){return j6||(j6=1,Rw=ReferenceError),Rw}var Ow,D6;function PL(){return D6||(D6=1,Ow=SyntaxError),Ow}var jw,I6;function hp(){return I6||(I6=1,jw=TypeError),jw}var Dw,M6;function sge(){return M6||(M6=1,Dw=URIError),Dw}var Iw,F6;function age(){return F6||(F6=1,Iw=Math.abs),Iw}var Mw,P6;function ige(){return P6||(P6=1,Mw=Math.floor),Mw}var Fw,L6;function oge(){return L6||(L6=1,Fw=Math.max),Fw}var Pw,B6;function lge(){return B6||(B6=1,Pw=Math.min),Pw}var Lw,U6;function cge(){return U6||(U6=1,Lw=Math.pow),Lw}var Bw,z6;function uge(){return z6||(z6=1,Bw=Math.round),Bw}var Uw,H6;function fge(){return H6||(H6=1,Uw=Number.isNaN||function(t){return t!==t}),Uw}var zw,V6;function dge(){if(V6)return zw;V6=1;var e=fge();return zw=function(r){return e(r)||r===0?r:r<0?-1:1},zw}var Hw,q6;function hge(){return q6||(q6=1,Hw=Object.getOwnPropertyDescriptor),Hw}var Vw,W6;function pp(){if(W6)return Vw;W6=1;var e=hge();if(e)try{e([],"length")}catch{e=null}return Vw=e,Vw}var qw,$6;function J1(){if($6)return qw;$6=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return qw=e,qw}var Ww,G6;function pge(){if(G6)return Ww;G6=1;var e=typeof Symbol<"u"&&Symbol,t=ML();return Ww=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},Ww}var $w,K6;function LL(){return K6||(K6=1,$w=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),$w}var Gw,X6;function BL(){if(X6)return Gw;X6=1;var e=FL();return Gw=e.getPrototypeOf||null,Gw}var Kw,Y6;function mge(){if(Y6)return Kw;Y6=1;var e="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,r=Math.max,n="[object Function]",s=function(c,f){for(var h=[],p=0;p<c.length;p+=1)h[p]=c[p];for(var x=0;x<f.length;x+=1)h[x+c.length]=f[x];return h},a=function(c,f){for(var h=[],p=f,x=0;p<c.length;p+=1,x+=1)h[x]=c[p];return h},i=function(o,c){for(var f="",h=0;h<o.length;h+=1)f+=o[h],h+1<o.length&&(f+=c);return f};return Kw=function(c){var f=this;if(typeof f!="function"||t.apply(f)!==n)throw new TypeError(e+f);for(var h=a(arguments,1),p,x=function(){if(this instanceof p){var _=f.apply(this,s(h,arguments));return Object(_)===_?_:this}return f.apply(c,s(h,arguments))},g=r(0,f.length-h.length),v=[],y=0;y<g;y++)v[y]="$"+y;if(p=Function("binder","return function ("+i(v,",")+"){ return binder.apply(this,arguments); }")(x),f.prototype){var w=function(){};w.prototype=f.prototype,p.prototype=new w,w.prototype=null}return p},Kw}var Xw,J6;function mp(){if(J6)return Xw;J6=1;var e=mge();return Xw=Function.prototype.bind||e,Xw}var Yw,Z6;function jN(){return Z6||(Z6=1,Yw=Function.prototype.call),Yw}var Jw,Q6;function UL(){return Q6||(Q6=1,Jw=Function.prototype.apply),Jw}var Zw,eO;function xge(){return eO||(eO=1,Zw=typeof Reflect<"u"&&Reflect&&Reflect.apply),Zw}var Qw,tO;function gge(){if(tO)return Qw;tO=1;var e=mp(),t=UL(),r=jN(),n=xge();return Qw=n||e.call(r,t),Qw}var e2,rO;function yge(){if(rO)return e2;rO=1;var e=mp(),t=hp(),r=jN(),n=gge();return e2=function(a){if(a.length<1||typeof a[0]!="function")throw new t("a function is required");return n(e,r,a)},e2}var t2,nO;function vge(){if(nO)return t2;nO=1;var e=yge(),t=pp(),r;try{r=[].__proto__===Array.prototype}catch(i){if(!i||typeof i!="object"||!("code"in i)||i.code!=="ERR_PROTO_ACCESS")throw i}var n=!!r&&t&&t(Object.prototype,"__proto__"),s=Object,a=s.getPrototypeOf;return t2=n&&typeof n.get=="function"?e([n.get]):typeof a=="function"?(function(o){return a(o==null?o:s(o))}):!1,t2}var r2,sO;function bge(){if(sO)return r2;sO=1;var e=LL(),t=BL(),r=vge();return r2=e?function(s){return e(s)}:t?function(s){if(!s||typeof s!="object"&&typeof s!="function")throw new TypeError("getProto: not an object");return t(s)}:r?function(s){return r(s)}:null,r2}var n2,aO;function wge(){if(aO)return n2;aO=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=mp();return n2=r.call(e,t),n2}var s2,iO;function DN(){if(iO)return s2;iO=1;var e,t=FL(),r=ege(),n=tge(),s=rge(),a=nge(),i=PL(),o=hp(),c=sge(),f=age(),h=ige(),p=oge(),x=lge(),g=cge(),v=uge(),y=dge(),w=Function,_=function(se){try{return w('"use strict"; return ('+se+").constructor;")()}catch{}},S=pp(),E=J1(),T=function(){throw new o},k=S?(function(){try{return arguments.callee,T}catch{try{return S(arguments,"callee").get}catch{return T}}})():T,D=pge()(),O=bge(),z=BL(),j=LL(),J=UL(),ae=jN(),F={},X=typeof Uint8Array>"u"||!O?e:O(Uint8Array),P={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":D&&O?O([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":F,"%AsyncGenerator%":F,"%AsyncGeneratorFunction%":F,"%AsyncIteratorPrototype%":F,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":w,"%GeneratorFunction%":F,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":D&&O?O(O([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!D||!O?e:O(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":S,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":s,"%ReferenceError%":a,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!D||!O?e:O(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":D&&O?O(""[Symbol.iterator]()):e,"%Symbol%":D?Symbol:e,"%SyntaxError%":i,"%ThrowTypeError%":k,"%TypedArray%":X,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":c,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":ae,"%Function.prototype.apply%":J,"%Object.defineProperty%":E,"%Object.getPrototypeOf%":z,"%Math.abs%":f,"%Math.floor%":h,"%Math.max%":p,"%Math.min%":x,"%Math.pow%":g,"%Math.round%":v,"%Math.sign%":y,"%Reflect.getPrototypeOf%":j};if(O)try{null.error}catch(se){var le=O(O(se));P["%Error.prototype%"]=le}var ee=function se(Q){var Y;if(Q==="%AsyncFunction%")Y=_("async function () {}");else if(Q==="%GeneratorFunction%")Y=_("function* () {}");else if(Q==="%AsyncGeneratorFunction%")Y=_("async function* () {}");else if(Q==="%AsyncGenerator%"){var U=se("%AsyncGeneratorFunction%");U&&(Y=U.prototype)}else if(Q==="%AsyncIteratorPrototype%"){var we=se("%AsyncGenerator%");we&&O&&(Y=O(we.prototype))}return P[Q]=Y,Y},te={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},me=mp(),ie=wge(),Ee=me.call(ae,Array.prototype.concat),K=me.call(J,Array.prototype.splice),M=me.call(ae,String.prototype.replace),q=me.call(ae,String.prototype.slice),G=me.call(ae,RegExp.prototype.exec),Z=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,re=/\\(\\)?/g,L=function(Q){var Y=q(Q,0,1),U=q(Q,-1);if(Y==="%"&&U!=="%")throw new i("invalid intrinsic syntax, expected closing `%`");if(U==="%"&&Y!=="%")throw new i("invalid intrinsic syntax, expected opening `%`");var we=[];return M(Q,Z,function(B,be,V,C){we[we.length]=V?M(C,re,"$1"):be||B}),we},I=function(Q,Y){var U=Q,we;if(ie(te,U)&&(we=te[U],U="%"+we[0]+"%"),ie(P,U)){var B=P[U];if(B===F&&(B=ee(U)),typeof B>"u"&&!Y)throw new o("intrinsic "+Q+" exists, but is not available. Please file an issue!");return{alias:we,name:U,value:B}}throw new i("intrinsic "+Q+" does not exist!")};return s2=function(Q,Y){if(typeof Q!="string"||Q.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Y!="boolean")throw new o('"allowMissing" argument must be a boolean');if(G(/^%?[^%]*%?$/,Q)===null)throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var U=L(Q),we=U.length>0?U[0]:"",B=I("%"+we+"%",Y),be=B.name,V=B.value,C=!1,A=B.alias;A&&(we=A[0],K(U,Ee([0,1],A)));for(var H=1,ue=!0;H<U.length;H+=1){var ye=U[H],he=q(ye,0,1),ke=q(ye,-1);if((he==='"'||he==="'"||he==="`"||ke==='"'||ke==="'"||ke==="`")&&he!==ke)throw new i("property names with quotes must have matching quotes");if((ye==="constructor"||!ue)&&(C=!0),we+="."+ye,be="%"+we+"%",ie(P,be))V=P[be];else if(V!=null){if(!(ye in V)){if(!Y)throw new o("base intrinsic for "+Q+" exists, but the property is not available.");return}if(S&&H+1>=U.length){var De=S(V,ye);ue=!!De,ue&&"get"in De&&!("originalValue"in De.get)?V=De.get:V=V[ye]}else ue=ie(V,ye),V=V[ye];ue&&!C&&(P[be]=V)}}return V},s2}var a2={exports:{}},i2,oO;function _ge(){if(oO)return i2;oO=1;var e=J1(),t=PL(),r=hp(),n=pp();return i2=function(a,i,o){if(!a||typeof a!="object"&&typeof a!="function")throw new r("`obj` must be an object or a function`");if(typeof i!="string"&&typeof i!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,f=arguments.length>4?arguments[4]:null,h=arguments.length>5?arguments[5]:null,p=arguments.length>6?arguments[6]:!1,x=!!n&&n(a,i);if(e)e(a,i,{configurable:h===null&&x?x.configurable:!h,enumerable:c===null&&x?x.enumerable:!c,value:o,writable:f===null&&x?x.writable:!f});else if(p||!c&&!f&&!h)a[i]=o;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},i2}var o2,lO;function Ege(){if(lO)return o2;lO=1;var e=J1(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},o2=t,o2}var l2,cO;function Sge(){if(cO)return l2;cO=1;var e=DN(),t=_ge(),r=Ege()(),n=pp(),s=hp(),a=e("%Math.floor%");return l2=function(o,c){if(typeof o!="function")throw new s("`fn` is not a function");if(typeof c!="number"||c<0||c>4294967295||a(c)!==c)throw new s("`length` must be a positive 32-bit integer");var f=arguments.length>2&&!!arguments[2],h=!0,p=!0;if("length"in o&&n){var x=n(o,"length");x&&!x.configurable&&(h=!1),x&&!x.writable&&(p=!1)}return(h||p||!f)&&(r?t(o,"length",c,!0,!0):t(o,"length",c)),o},l2}var uO;function zL(){return uO||(uO=1,(function(e){var t=mp(),r=DN(),n=Sge(),s=hp(),a=r("%Function.prototype.apply%"),i=r("%Function.prototype.call%"),o=r("%Reflect.apply%",!0)||t.call(i,a),c=J1(),f=r("%Math.max%");e.exports=function(x){if(typeof x!="function")throw new s("a function is required");var g=o(t,i,arguments);return n(g,1+f(0,x.length-(arguments.length-1)),!0)};var h=function(){return o(t,a,arguments)};c?c(e.exports,"apply",{value:h}):e.exports.apply=h})(a2)),a2.exports}var c2,fO;function HL(){if(fO)return c2;fO=1;var e=DN(),t=zL(),r=t(e("String.prototype.indexOf"));return c2=function(s,a){var i=e(s,!!a);return typeof i=="function"&&r(s,".prototype.")>-1?t(i):i},c2}var u2,dO;function Nge(){if(dO)return u2;dO=1;var e=ON()(),t=HL(),r=t("Object.prototype.toString"),n=function(o){return e&&o&&typeof o=="object"&&Symbol.toStringTag in o?!1:r(o)==="[object Arguments]"},s=function(o){return n(o)?!0:o!==null&&typeof o=="object"&&typeof o.length=="number"&&o.length>=0&&r(o)!=="[object Array]"&&r(o.callee)==="[object Function]"},a=(function(){return n(arguments)})();return n.isLegacyArguments=s,u2=a?n:s,u2}var f2,hO;function Tge(){if(hO)return f2;hO=1;var e=Object.prototype.toString,t=Function.prototype.toString,r=/^\s*(?:function)?\*/,n=ON()(),s=Object.getPrototypeOf,a=function(){if(!n)return!1;try{return Function("return function*() {}")()}catch{}},i;return f2=function(c){if(typeof c!="function")return!1;if(r.test(t.call(c)))return!0;if(!n){var f=e.call(c);return f==="[object GeneratorFunction]"}if(!s)return!1;if(typeof i>"u"){var h=a();i=h?s(h):!1}return s(c)===i},f2}var d2,pO;function kge(){if(pO)return d2;pO=1;var e=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,n;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw n}}),n={},t(function(){throw 42},null,r)}catch(S){S!==n&&(t=null)}else t=null;var s=/^\s*class\b/,a=function(E){try{var T=e.call(E);return s.test(T)}catch{return!1}},i=function(E){try{return a(E)?!1:(e.call(E),!0)}catch{return!1}},o=Object.prototype.toString,c="[object Object]",f="[object Function]",h="[object GeneratorFunction]",p="[object HTMLAllCollection]",x="[object HTML document.all class]",g="[object HTMLCollection]",v=typeof Symbol=="function"&&!!Symbol.toStringTag,y=!(0 in[,]),w=function(){return!1};if(typeof document=="object"){var _=document.all;o.call(_)===o.call(document.all)&&(w=function(E){if((y||!E)&&(typeof E>"u"||typeof E=="object"))try{var T=o.call(E);return(T===p||T===x||T===g||T===c)&&E("")==null}catch{}return!1})}return d2=t?function(E){if(w(E))return!0;if(!E||typeof E!="function"&&typeof E!="object")return!1;try{t(E,null,r)}catch(T){if(T!==n)return!1}return!a(E)&&i(E)}:function(E){if(w(E))return!0;if(!E||typeof E!="function"&&typeof E!="object")return!1;if(v)return i(E);if(a(E))return!1;var T=o.call(E);return T!==f&&T!==h&&!/^\[object HTML/.test(T)?!1:i(E)},d2}var h2,mO;function Age(){if(mO)return h2;mO=1;var e=kge(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty,n=function(c,f,h){for(var p=0,x=c.length;p<x;p++)r.call(c,p)&&(h==null?f(c[p],p,c):f.call(h,c[p],p,c))},s=function(c,f,h){for(var p=0,x=c.length;p<x;p++)h==null?f(c.charAt(p),p,c):f.call(h,c.charAt(p),p,c)},a=function(c,f,h){for(var p in c)r.call(c,p)&&(h==null?f(c[p],p,c):f.call(h,c[p],p,c))},i=function(c,f,h){if(!e(f))throw new TypeError("iterator must be a function");var p;arguments.length>=3&&(p=h),t.call(c)==="[object Array]"?n(c,f,p):typeof c=="string"?s(c,f,p):a(c,f,p)};return h2=i,h2}var p2,xO;function Cge(){return xO||(xO=1,p2=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),p2}var m2,gO;function Rge(){if(gO)return m2;gO=1;var e=Cge(),t=typeof globalThis>"u"?Fi:globalThis;return m2=function(){for(var n=[],s=0;s<e.length;s++)typeof t[e[s]]=="function"&&(n[n.length]=e[s]);return n},m2}var x2,yO;function VL(){if(yO)return x2;yO=1;var e=Age(),t=Rge(),r=zL(),n=HL(),s=pp(),a=n("Object.prototype.toString"),i=ON()(),o=typeof globalThis>"u"?Fi:globalThis,c=t(),f=n("String.prototype.slice"),h=Object.getPrototypeOf,p=n("Array.prototype.indexOf",!0)||function(w,_){for(var S=0;S<w.length;S+=1)if(w[S]===_)return S;return-1},x={__proto__:null};i&&s&&h?e(c,function(y){var w=new o[y];if(Symbol.toStringTag in w){var _=h(w),S=s(_,Symbol.toStringTag);if(!S){var E=h(_);S=s(E,Symbol.toStringTag)}x["$"+y]=r(S.get)}}):e(c,function(y){var w=new o[y],_=w.slice||w.set;_&&(x["$"+y]=r(_))});var g=function(w){var _=!1;return e(x,function(S,E){if(!_)try{"$"+S(w)===E&&(_=f(E,1))}catch{}}),_},v=function(w){var _=!1;return e(x,function(S,E){if(!_)try{S(w),_=f(E,1)}catch{}}),_};return x2=function(w){if(!w||typeof w!="object")return!1;if(!i){var _=f(a(w),8,-1);return p(c,_)>-1?_:_!=="Object"?!1:v(w)}return s?g(w):null},x2}var g2,vO;function Oge(){if(vO)return g2;vO=1;var e=VL();return g2=function(r){return!!e(r)},g2}var bO;function jge(){return bO||(bO=1,(function(e){var t=Nge(),r=Tge(),n=VL(),s=Oge();function a(H){return H.call.bind(H)}var i=typeof BigInt<"u",o=typeof Symbol<"u",c=a(Object.prototype.toString),f=a(Number.prototype.valueOf),h=a(String.prototype.valueOf),p=a(Boolean.prototype.valueOf);if(i)var x=a(BigInt.prototype.valueOf);if(o)var g=a(Symbol.prototype.valueOf);function v(H,ue){if(typeof H!="object")return!1;try{return ue(H),!0}catch{return!1}}e.isArgumentsObject=t,e.isGeneratorFunction=r,e.isTypedArray=s;function y(H){return typeof Promise<"u"&&H instanceof Promise||H!==null&&typeof H=="object"&&typeof H.then=="function"&&typeof H.catch=="function"}e.isPromise=y;function w(H){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(H):s(H)||q(H)}e.isArrayBufferView=w;function _(H){return n(H)==="Uint8Array"}e.isUint8Array=_;function S(H){return n(H)==="Uint8ClampedArray"}e.isUint8ClampedArray=S;function E(H){return n(H)==="Uint16Array"}e.isUint16Array=E;function T(H){return n(H)==="Uint32Array"}e.isUint32Array=T;function k(H){return n(H)==="Int8Array"}e.isInt8Array=k;function D(H){return n(H)==="Int16Array"}e.isInt16Array=D;function O(H){return n(H)==="Int32Array"}e.isInt32Array=O;function z(H){return n(H)==="Float32Array"}e.isFloat32Array=z;function j(H){return n(H)==="Float64Array"}e.isFloat64Array=j;function J(H){return n(H)==="BigInt64Array"}e.isBigInt64Array=J;function ae(H){return n(H)==="BigUint64Array"}e.isBigUint64Array=ae;function F(H){return c(H)==="[object Map]"}F.working=typeof Map<"u"&&F(new Map);function X(H){return typeof Map>"u"?!1:F.working?F(H):H instanceof Map}e.isMap=X;function P(H){return c(H)==="[object Set]"}P.working=typeof Set<"u"&&P(new Set);function le(H){return typeof Set>"u"?!1:P.working?P(H):H instanceof Set}e.isSet=le;function ee(H){return c(H)==="[object WeakMap]"}ee.working=typeof WeakMap<"u"&&ee(new WeakMap);function te(H){return typeof WeakMap>"u"?!1:ee.working?ee(H):H instanceof WeakMap}e.isWeakMap=te;function me(H){return c(H)==="[object WeakSet]"}me.working=typeof WeakSet<"u"&&me(new WeakSet);function ie(H){return me(H)}e.isWeakSet=ie;function Ee(H){return c(H)==="[object ArrayBuffer]"}Ee.working=typeof ArrayBuffer<"u"&&Ee(new ArrayBuffer);function K(H){return typeof ArrayBuffer>"u"?!1:Ee.working?Ee(H):H instanceof ArrayBuffer}e.isArrayBuffer=K;function M(H){return c(H)==="[object DataView]"}M.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&M(new DataView(new ArrayBuffer(1),0,1));function q(H){return typeof DataView>"u"?!1:M.working?M(H):H instanceof DataView}e.isDataView=q;var G=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Z(H){return c(H)==="[object SharedArrayBuffer]"}function re(H){return typeof G>"u"?!1:(typeof Z.working>"u"&&(Z.working=Z(new G)),Z.working?Z(H):H instanceof G)}e.isSharedArrayBuffer=re;function L(H){return c(H)==="[object AsyncFunction]"}e.isAsyncFunction=L;function I(H){return c(H)==="[object Map Iterator]"}e.isMapIterator=I;function se(H){return c(H)==="[object Set Iterator]"}e.isSetIterator=se;function Q(H){return c(H)==="[object Generator]"}e.isGeneratorObject=Q;function Y(H){return c(H)==="[object WebAssembly.Module]"}e.isWebAssemblyCompiledModule=Y;function U(H){return v(H,f)}e.isNumberObject=U;function we(H){return v(H,h)}e.isStringObject=we;function B(H){return v(H,p)}e.isBooleanObject=B;function be(H){return i&&v(H,x)}e.isBigIntObject=be;function V(H){return o&&v(H,g)}e.isSymbolObject=V;function C(H){return U(H)||we(H)||B(H)||be(H)||V(H)}e.isBoxedPrimitive=C;function A(H){return typeof Uint8Array<"u"&&(K(H)||re(H))}e.isAnyArrayBuffer=A,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(H){Object.defineProperty(e,H,{enumerable:!1,value:function(){throw new Error(H+" is not supported in userland")}})})})(Ew)),Ew}var y2,wO;function Dge(){return wO||(wO=1,y2=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),y2}var _O;function qL(){return _O||(_O=1,(function(e){var t=Object.getOwnPropertyDescriptors||function(q){for(var G=Object.keys(q),Z={},re=0;re<G.length;re++)Z[G[re]]=Object.getOwnPropertyDescriptor(q,G[re]);return Z},r=/%[sdj%]/g;e.format=function(M){if(!k(M)){for(var q=[],G=0;G<arguments.length;G++)q.push(i(arguments[G]));return q.join(" ")}for(var G=1,Z=arguments,re=Z.length,L=String(M).replace(r,function(se){if(se==="%%")return"%";if(G>=re)return se;switch(se){case"%s":return String(Z[G++]);case"%d":return Number(Z[G++]);case"%j":try{return JSON.stringify(Z[G++])}catch{return"[Circular]"}default:return se}}),I=Z[G];G<re;I=Z[++G])S(I)||!j(I)?L+=" "+I:L+=" "+i(I);return L},e.deprecate=function(M,q){if(typeof Mt<"u"&&Mt.noDeprecation===!0)return M;if(typeof Mt>"u")return function(){return e.deprecate(M,q).apply(this,arguments)};var G=!1;function Z(){if(!G){if(Mt.throwDeprecation)throw new Error(q);Mt.traceDeprecation?console.trace(q):console.error(q),G=!0}return M.apply(this,arguments)}return Z};var n={},s=/^$/;if(Mt.env.NODE_DEBUG){var a=Mt.env.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+a+"$","i")}e.debuglog=function(M){if(M=M.toUpperCase(),!n[M])if(s.test(M)){var q=Mt.pid;n[M]=function(){var G=e.format.apply(e,arguments);console.error("%s %d: %s",M,q,G)}}else n[M]=function(){};return n[M]};function i(M,q){var G={seen:[],stylize:c};return arguments.length>=3&&(G.depth=arguments[2]),arguments.length>=4&&(G.colors=arguments[3]),_(q)?G.showHidden=q:q&&e._extend(G,q),O(G.showHidden)&&(G.showHidden=!1),O(G.depth)&&(G.depth=2),O(G.colors)&&(G.colors=!1),O(G.customInspect)&&(G.customInspect=!0),G.colors&&(G.stylize=o),h(G,M,G.depth)}e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function o(M,q){var G=i.styles[q];return G?"\x1B["+i.colors[G][0]+"m"+M+"\x1B["+i.colors[G][1]+"m":M}function c(M,q){return M}function f(M){var q={};return M.forEach(function(G,Z){q[G]=!0}),q}function h(M,q,G){if(M.customInspect&&q&&F(q.inspect)&&q.inspect!==e.inspect&&!(q.constructor&&q.constructor.prototype===q)){var Z=q.inspect(G,M);return k(Z)||(Z=h(M,Z,G)),Z}var re=p(M,q);if(re)return re;var L=Object.keys(q),I=f(L);if(M.showHidden&&(L=Object.getOwnPropertyNames(q)),ae(q)&&(L.indexOf("message")>=0||L.indexOf("description")>=0))return x(q);if(L.length===0){if(F(q)){var se=q.name?": "+q.name:"";return M.stylize("[Function"+se+"]","special")}if(z(q))return M.stylize(RegExp.prototype.toString.call(q),"regexp");if(J(q))return M.stylize(Date.prototype.toString.call(q),"date");if(ae(q))return x(q)}var Q="",Y=!1,U=["{","}"];if(w(q)&&(Y=!0,U=["[","]"]),F(q)){var we=q.name?": "+q.name:"";Q=" [Function"+we+"]"}if(z(q)&&(Q=" "+RegExp.prototype.toString.call(q)),J(q)&&(Q=" "+Date.prototype.toUTCString.call(q)),ae(q)&&(Q=" "+x(q)),L.length===0&&(!Y||q.length==0))return U[0]+Q+U[1];if(G<0)return z(q)?M.stylize(RegExp.prototype.toString.call(q),"regexp"):M.stylize("[Object]","special");M.seen.push(q);var B;return Y?B=g(M,q,G,I,L):B=L.map(function(be){return v(M,q,G,I,be,Y)}),M.seen.pop(),y(B,Q,U)}function p(M,q){if(O(q))return M.stylize("undefined","undefined");if(k(q)){var G="'"+JSON.stringify(q).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return M.stylize(G,"string")}if(T(q))return M.stylize(""+q,"number");if(_(q))return M.stylize(""+q,"boolean");if(S(q))return M.stylize("null","null")}function x(M){return"["+Error.prototype.toString.call(M)+"]"}function g(M,q,G,Z,re){for(var L=[],I=0,se=q.length;I<se;++I)me(q,String(I))?L.push(v(M,q,G,Z,String(I),!0)):L.push("");return re.forEach(function(Q){Q.match(/^\d+$/)||L.push(v(M,q,G,Z,Q,!0))}),L}function v(M,q,G,Z,re,L){var I,se,Q;if(Q=Object.getOwnPropertyDescriptor(q,re)||{value:q[re]},Q.get?Q.set?se=M.stylize("[Getter/Setter]","special"):se=M.stylize("[Getter]","special"):Q.set&&(se=M.stylize("[Setter]","special")),me(Z,re)||(I="["+re+"]"),se||(M.seen.indexOf(Q.value)<0?(S(G)?se=h(M,Q.value,null):se=h(M,Q.value,G-1),se.indexOf(`
`)>-1&&(L?se=se.split(`
`).map(function(Y){return"  "+Y}).join(`
`).slice(2):se=`
`+se.split(`
`).map(function(Y){return"   "+Y}).join(`
`))):se=M.stylize("[Circular]","special")),O(I)){if(L&&re.match(/^\d+$/))return se;I=JSON.stringify(""+re),I.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(I=I.slice(1,-1),I=M.stylize(I,"name")):(I=I.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),I=M.stylize(I,"string"))}return I+": "+se}function y(M,q,G){var Z=M.reduce(function(re,L){return L.indexOf(`
`)>=0,re+L.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Z>60?G[0]+(q===""?"":q+`
 `)+" "+M.join(`,
  `)+" "+G[1]:G[0]+q+" "+M.join(", ")+" "+G[1]}e.types=jge();function w(M){return Array.isArray(M)}e.isArray=w;function _(M){return typeof M=="boolean"}e.isBoolean=_;function S(M){return M===null}e.isNull=S;function E(M){return M==null}e.isNullOrUndefined=E;function T(M){return typeof M=="number"}e.isNumber=T;function k(M){return typeof M=="string"}e.isString=k;function D(M){return typeof M=="symbol"}e.isSymbol=D;function O(M){return M===void 0}e.isUndefined=O;function z(M){return j(M)&&P(M)==="[object RegExp]"}e.isRegExp=z,e.types.isRegExp=z;function j(M){return typeof M=="object"&&M!==null}e.isObject=j;function J(M){return j(M)&&P(M)==="[object Date]"}e.isDate=J,e.types.isDate=J;function ae(M){return j(M)&&(P(M)==="[object Error]"||M instanceof Error)}e.isError=ae,e.types.isNativeError=ae;function F(M){return typeof M=="function"}e.isFunction=F;function X(M){return M===null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||typeof M=="symbol"||typeof M>"u"}e.isPrimitive=X,e.isBuffer=Dge();function P(M){return Object.prototype.toString.call(M)}function le(M){return M<10?"0"+M.toString(10):M.toString(10)}var ee=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function te(){var M=new Date,q=[le(M.getHours()),le(M.getMinutes()),le(M.getSeconds())].join(":");return[M.getDate(),ee[M.getMonth()],q].join(" ")}e.log=function(){console.log("%s - %s",te(),e.format.apply(e,arguments))},e.inherits=Ql(),e._extend=function(M,q){if(!q||!j(q))return M;for(var G=Object.keys(q),Z=G.length;Z--;)M[G[Z]]=q[G[Z]];return M};function me(M,q){return Object.prototype.hasOwnProperty.call(M,q)}var ie=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;e.promisify=function(q){if(typeof q!="function")throw new TypeError('The "original" argument must be of type Function');if(ie&&q[ie]){var G=q[ie];if(typeof G!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(G,ie,{value:G,enumerable:!1,writable:!1,configurable:!0}),G}function G(){for(var Z,re,L=new Promise(function(Q,Y){Z=Q,re=Y}),I=[],se=0;se<arguments.length;se++)I.push(arguments[se]);I.push(function(Q,Y){Q?re(Q):Z(Y)});try{q.apply(this,I)}catch(Q){re(Q)}return L}return Object.setPrototypeOf(G,Object.getPrototypeOf(q)),ie&&Object.defineProperty(G,ie,{value:G,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(G,t(q))},e.promisify.custom=ie;function Ee(M,q){if(!M){var G=new Error("Promise was rejected with a falsy value");G.reason=M,M=G}return q(M)}function K(M){if(typeof M!="function")throw new TypeError('The "original" argument must be of type Function');function q(){for(var G=[],Z=0;Z<arguments.length;Z++)G.push(arguments[Z]);var re=G.pop();if(typeof re!="function")throw new TypeError("The last argument must be of type Function");var L=this,I=function(){return re.apply(L,arguments)};M.apply(this,G).then(function(se){Mt.nextTick(I.bind(null,null,se))},function(se){Mt.nextTick(Ee.bind(null,se,I))})}return Object.setPrototypeOf(q,Object.getPrototypeOf(M)),Object.defineProperties(q,t(M)),q}e.callbackify=K})(_w)),_w}var v2,EO;function Ige(){if(EO)return v2;EO=1;function e(x,g){var v=Object.keys(x);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(x);g&&(y=y.filter(function(w){return Object.getOwnPropertyDescriptor(x,w).enumerable})),v.push.apply(v,y)}return v}function t(x){for(var g=1;g<arguments.length;g++){var v=arguments[g]!=null?arguments[g]:{};g%2?e(Object(v),!0).forEach(function(y){r(x,y,v[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(v)):e(Object(v)).forEach(function(y){Object.defineProperty(x,y,Object.getOwnPropertyDescriptor(v,y))})}return x}function r(x,g,v){return g in x?Object.defineProperty(x,g,{value:v,enumerable:!0,configurable:!0,writable:!0}):x[g]=v,x}function n(x,g){if(!(x instanceof g))throw new TypeError("Cannot call a class as a function")}function s(x,g){for(var v=0;v<g.length;v++){var y=g[v];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}function a(x,g,v){return g&&s(x.prototype,g),x}var i=Y1(),o=i.Buffer,c=qL(),f=c.inspect,h=f&&f.custom||"inspect";function p(x,g,v){o.prototype.copy.call(x,g,v)}return v2=(function(){function x(){n(this,x),this.head=null,this.tail=null,this.length=0}return a(x,[{key:"push",value:function(v){var y={data:v,next:null};this.length>0?this.tail.next=y:this.head=y,this.tail=y,++this.length}},{key:"unshift",value:function(v){var y={data:v,next:this.head};this.length===0&&(this.tail=y),this.head=y,++this.length}},{key:"shift",value:function(){if(this.length!==0){var v=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,v}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(v){if(this.length===0)return"";for(var y=this.head,w=""+y.data;y=y.next;)w+=v+y.data;return w}},{key:"concat",value:function(v){if(this.length===0)return o.alloc(0);for(var y=o.allocUnsafe(v>>>0),w=this.head,_=0;w;)p(w.data,y,_),_+=w.data.length,w=w.next;return y}},{key:"consume",value:function(v,y){var w;return v<this.head.data.length?(w=this.head.data.slice(0,v),this.head.data=this.head.data.slice(v)):v===this.head.data.length?w=this.shift():w=y?this._getString(v):this._getBuffer(v),w}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(v){var y=this.head,w=1,_=y.data;for(v-=_.length;y=y.next;){var S=y.data,E=v>S.length?S.length:v;if(E===S.length?_+=S:_+=S.slice(0,v),v-=E,v===0){E===S.length?(++w,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=S.slice(E));break}++w}return this.length-=w,_}},{key:"_getBuffer",value:function(v){var y=o.allocUnsafe(v),w=this.head,_=1;for(w.data.copy(y),v-=w.data.length;w=w.next;){var S=w.data,E=v>S.length?S.length:v;if(S.copy(y,y.length-v,0,E),v-=E,v===0){E===S.length?(++_,w.next?this.head=w.next:this.head=this.tail=null):(this.head=w,w.data=S.slice(E));break}++_}return this.length-=_,y}},{key:h,value:function(v,y){return f(this,t({},y,{depth:0,customInspect:!1}))}}]),x})(),v2}var b2,SO;function WL(){if(SO)return b2;SO=1;function e(i,o){var c=this,f=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return f||h?(o?o(i):i&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Mt.nextTick(s,this,i)):Mt.nextTick(s,this,i)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,function(p){!o&&p?c._writableState?c._writableState.errorEmitted?Mt.nextTick(r,c):(c._writableState.errorEmitted=!0,Mt.nextTick(t,c,p)):Mt.nextTick(t,c,p):o?(Mt.nextTick(r,c),o(p)):Mt.nextTick(r,c)}),this)}function t(i,o){s(i,o),r(i)}function r(i){i._writableState&&!i._writableState.emitClose||i._readableState&&!i._readableState.emitClose||i.emit("close")}function n(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function s(i,o){i.emit("error",o)}function a(i,o){var c=i._readableState,f=i._writableState;c&&c.autoDestroy||f&&f.autoDestroy?i.destroy(o):i.emit("error",o)}return b2={destroy:e,undestroy:n,errorOrDestroy:a},b2}var w2={},NO;function vd(){if(NO)return w2;NO=1;function e(o,c){o.prototype=Object.create(c.prototype),o.prototype.constructor=o,o.__proto__=c}var t={};function r(o,c,f){f||(f=Error);function h(x,g,v){return typeof c=="string"?c:c(x,g,v)}var p=(function(x){e(g,x);function g(v,y,w){return x.call(this,h(v,y,w))||this}return g})(f);p.prototype.name=f.name,p.prototype.code=o,t[o]=p}function n(o,c){if(Array.isArray(o)){var f=o.length;return o=o.map(function(h){return String(h)}),f>2?"one of ".concat(c," ").concat(o.slice(0,f-1).join(", "),", or ")+o[f-1]:f===2?"one of ".concat(c," ").concat(o[0]," or ").concat(o[1]):"of ".concat(c," ").concat(o[0])}else return"of ".concat(c," ").concat(String(o))}function s(o,c,f){return o.substr(0,c.length)===c}function a(o,c,f){return(f===void 0||f>o.length)&&(f=o.length),o.substring(f-c.length,f)===c}function i(o,c,f){return typeof f!="number"&&(f=0),f+c.length>o.length?!1:o.indexOf(c,f)!==-1}return r("ERR_INVALID_OPT_VALUE",function(o,c){return'The value "'+c+'" is invalid for option "'+o+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(o,c,f){var h;typeof c=="string"&&s(c,"not ")?(h="must not be",c=c.replace(/^not /,"")):h="must be";var p;if(a(o," argument"))p="The ".concat(o," ").concat(h," ").concat(n(c,"type"));else{var x=i(o,".")?"property":"argument";p='The "'.concat(o,'" ').concat(x," ").concat(h," ").concat(n(c,"type"))}return p+=". Received type ".concat(typeof f),p},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(o){return"The "+o+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(o){return"Cannot call "+o+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(o){return"Unknown encoding: "+o},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),w2.codes=t,w2}var _2,TO;function $L(){if(TO)return _2;TO=1;var e=vd().codes.ERR_INVALID_OPT_VALUE;function t(n,s,a){return n.highWaterMark!=null?n.highWaterMark:s?n[a]:null}function r(n,s,a,i){var o=t(s,i,a);if(o!=null){if(!(isFinite(o)&&Math.floor(o)===o)||o<0){var c=i?a:"highWaterMark";throw new e(c,o)}return Math.floor(o)}return n.objectMode?16:16*1024}return _2={getHighWaterMark:r},_2}var E2,kO;function Mge(){if(kO)return E2;kO=1,E2=e;function e(r,n){if(t("noDeprecation"))return r;var s=!1;function a(){if(!s){if(t("throwDeprecation"))throw new Error(n);t("traceDeprecation")?console.trace(n):console.warn(n),s=!0}return r.apply(this,arguments)}return a}function t(r){try{if(!Fi.localStorage)return!1}catch{return!1}var n=Fi.localStorage[r];return n==null?!1:String(n).toLowerCase()==="true"}return E2}var S2,AO;function GL(){if(AO)return S2;AO=1,S2=z;function e(re){var L=this;this.next=null,this.entry=null,this.finish=function(){Z(L,re)}}var t;z.WritableState=D;var r={deprecate:Mge()},n=IL(),s=Y1().Buffer,a=Fi.Uint8Array||function(){};function i(re){return s.from(re)}function o(re){return s.isBuffer(re)||re instanceof a}var c=WL(),f=$L(),h=f.getHighWaterMark,p=vd().codes,x=p.ERR_INVALID_ARG_TYPE,g=p.ERR_METHOD_NOT_IMPLEMENTED,v=p.ERR_MULTIPLE_CALLBACK,y=p.ERR_STREAM_CANNOT_PIPE,w=p.ERR_STREAM_DESTROYED,_=p.ERR_STREAM_NULL_VALUES,S=p.ERR_STREAM_WRITE_AFTER_END,E=p.ERR_UNKNOWN_ENCODING,T=c.errorOrDestroy;Ql()(z,n);function k(){}function D(re,L,I){t=t||Wf(),re=re||{},typeof I!="boolean"&&(I=L instanceof t),this.objectMode=!!re.objectMode,I&&(this.objectMode=this.objectMode||!!re.writableObjectMode),this.highWaterMark=h(this,re,"writableHighWaterMark",I),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var se=re.decodeStrings===!1;this.decodeStrings=!se,this.defaultEncoding=re.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Q){ee(L,Q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=re.emitClose!==!1,this.autoDestroy=!!re.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}D.prototype.getBuffer=function(){for(var L=this.bufferedRequest,I=[];L;)I.push(L),L=L.next;return I},(function(){try{Object.defineProperty(D.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var O;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(z,Symbol.hasInstance,{value:function(L){return O.call(this,L)?!0:this!==z?!1:L&&L._writableState instanceof D}})):O=function(L){return L instanceof this};function z(re){t=t||Wf();var L=this instanceof t;if(!L&&!O.call(z,this))return new z(re);this._writableState=new D(re,this,L),this.writable=!0,re&&(typeof re.write=="function"&&(this._write=re.write),typeof re.writev=="function"&&(this._writev=re.writev),typeof re.destroy=="function"&&(this._destroy=re.destroy),typeof re.final=="function"&&(this._final=re.final)),n.call(this)}z.prototype.pipe=function(){T(this,new y)};function j(re,L){var I=new S;T(re,I),Mt.nextTick(L,I)}function J(re,L,I,se){var Q;return I===null?Q=new _:typeof I!="string"&&!L.objectMode&&(Q=new x("chunk",["string","Buffer"],I)),Q?(T(re,Q),Mt.nextTick(se,Q),!1):!0}z.prototype.write=function(re,L,I){var se=this._writableState,Q=!1,Y=!se.objectMode&&o(re);return Y&&!s.isBuffer(re)&&(re=i(re)),typeof L=="function"&&(I=L,L=null),Y?L="buffer":L||(L=se.defaultEncoding),typeof I!="function"&&(I=k),se.ending?j(this,I):(Y||J(this,se,re,I))&&(se.pendingcb++,Q=F(this,se,Y,re,L,I)),Q},z.prototype.cork=function(){this._writableState.corked++},z.prototype.uncork=function(){var re=this._writableState;re.corked&&(re.corked--,!re.writing&&!re.corked&&!re.bufferProcessing&&re.bufferedRequest&&ie(this,re))},z.prototype.setDefaultEncoding=function(L){if(typeof L=="string"&&(L=L.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((L+"").toLowerCase())>-1))throw new E(L);return this._writableState.defaultEncoding=L,this},Object.defineProperty(z.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ae(re,L,I){return!re.objectMode&&re.decodeStrings!==!1&&typeof L=="string"&&(L=s.from(L,I)),L}Object.defineProperty(z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function F(re,L,I,se,Q,Y){if(!I){var U=ae(L,se,Q);se!==U&&(I=!0,Q="buffer",se=U)}var we=L.objectMode?1:se.length;L.length+=we;var B=L.length<L.highWaterMark;if(B||(L.needDrain=!0),L.writing||L.corked){var be=L.lastBufferedRequest;L.lastBufferedRequest={chunk:se,encoding:Q,isBuf:I,callback:Y,next:null},be?be.next=L.lastBufferedRequest:L.bufferedRequest=L.lastBufferedRequest,L.bufferedRequestCount+=1}else X(re,L,!1,we,se,Q,Y);return B}function X(re,L,I,se,Q,Y,U){L.writelen=se,L.writecb=U,L.writing=!0,L.sync=!0,L.destroyed?L.onwrite(new w("write")):I?re._writev(Q,L.onwrite):re._write(Q,Y,L.onwrite),L.sync=!1}function P(re,L,I,se,Q){--L.pendingcb,I?(Mt.nextTick(Q,se),Mt.nextTick(q,re,L),re._writableState.errorEmitted=!0,T(re,se)):(Q(se),re._writableState.errorEmitted=!0,T(re,se),q(re,L))}function le(re){re.writing=!1,re.writecb=null,re.length-=re.writelen,re.writelen=0}function ee(re,L){var I=re._writableState,se=I.sync,Q=I.writecb;if(typeof Q!="function")throw new v;if(le(I),L)P(re,I,se,L,Q);else{var Y=Ee(I)||re.destroyed;!Y&&!I.corked&&!I.bufferProcessing&&I.bufferedRequest&&ie(re,I),se?Mt.nextTick(te,re,I,Y,Q):te(re,I,Y,Q)}}function te(re,L,I,se){I||me(re,L),L.pendingcb--,se(),q(re,L)}function me(re,L){L.length===0&&L.needDrain&&(L.needDrain=!1,re.emit("drain"))}function ie(re,L){L.bufferProcessing=!0;var I=L.bufferedRequest;if(re._writev&&I&&I.next){var se=L.bufferedRequestCount,Q=new Array(se),Y=L.corkedRequestsFree;Y.entry=I;for(var U=0,we=!0;I;)Q[U]=I,I.isBuf||(we=!1),I=I.next,U+=1;Q.allBuffers=we,X(re,L,!0,L.length,Q,"",Y.finish),L.pendingcb++,L.lastBufferedRequest=null,Y.next?(L.corkedRequestsFree=Y.next,Y.next=null):L.corkedRequestsFree=new e(L),L.bufferedRequestCount=0}else{for(;I;){var B=I.chunk,be=I.encoding,V=I.callback,C=L.objectMode?1:B.length;if(X(re,L,!1,C,B,be,V),I=I.next,L.bufferedRequestCount--,L.writing)break}I===null&&(L.lastBufferedRequest=null)}L.bufferedRequest=I,L.bufferProcessing=!1}z.prototype._write=function(re,L,I){I(new g("_write()"))},z.prototype._writev=null,z.prototype.end=function(re,L,I){var se=this._writableState;return typeof re=="function"?(I=re,re=null,L=null):typeof L=="function"&&(I=L,L=null),re!=null&&this.write(re,L),se.corked&&(se.corked=1,this.uncork()),se.ending||G(this,se,I),this},Object.defineProperty(z.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Ee(re){return re.ending&&re.length===0&&re.bufferedRequest===null&&!re.finished&&!re.writing}function K(re,L){re._final(function(I){L.pendingcb--,I&&T(re,I),L.prefinished=!0,re.emit("prefinish"),q(re,L)})}function M(re,L){!L.prefinished&&!L.finalCalled&&(typeof re._final=="function"&&!L.destroyed?(L.pendingcb++,L.finalCalled=!0,Mt.nextTick(K,re,L)):(L.prefinished=!0,re.emit("prefinish")))}function q(re,L){var I=Ee(L);if(I&&(M(re,L),L.pendingcb===0&&(L.finished=!0,re.emit("finish"),L.autoDestroy))){var se=re._readableState;(!se||se.autoDestroy&&se.endEmitted)&&re.destroy()}return I}function G(re,L,I){L.ending=!0,q(re,L),I&&(L.finished?Mt.nextTick(I):re.once("finish",I)),L.ended=!0,re.writable=!1}function Z(re,L,I){var se=re.entry;for(re.entry=null;se;){var Q=se.callback;L.pendingcb--,Q(I),se=se.next}L.corkedRequestsFree.next=re}return Object.defineProperty(z.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(L){this._writableState&&(this._writableState.destroyed=L)}}),z.prototype.destroy=c.destroy,z.prototype._undestroy=c.undestroy,z.prototype._destroy=function(re,L){L(re)},S2}var N2,CO;function Wf(){if(CO)return N2;CO=1;var e=Object.keys||function(f){var h=[];for(var p in f)h.push(p);return h};N2=i;var t=KL(),r=GL();Ql()(i,t);for(var n=e(r.prototype),s=0;s<n.length;s++){var a=n[s];i.prototype[a]||(i.prototype[a]=r.prototype[a])}function i(f){if(!(this instanceof i))return new i(f);t.call(this,f),r.call(this,f),this.allowHalfOpen=!0,f&&(f.readable===!1&&(this.readable=!1),f.writable===!1&&(this.writable=!1),f.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o)))}Object.defineProperty(i.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(i.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(i.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function o(){this._writableState.ended||Mt.nextTick(c,this)}function c(f){f.end()}return Object.defineProperty(i.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(h){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=h,this._writableState.destroyed=h)}}),N2}var T2={},hx={exports:{}},RO;function Fge(){return RO||(RO=1,(function(e,t){var r=Y1(),n=r.Buffer;function s(i,o){for(var c in i)o[c]=i[c]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(s(r,t),t.Buffer=a);function a(i,o,c){return n(i,o,c)}s(n,a),a.from=function(i,o,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return n(i,o,c)},a.alloc=function(i,o,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var f=n(i);return o!==void 0?typeof c=="string"?f.fill(o,c):f.fill(o):f.fill(0),f},a.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n(i)},a.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(i)}})(hx,hx.exports)),hx.exports}var OO;function bE(){if(OO)return T2;OO=1;var e=Fge().Buffer,t=e.isEncoding||function(_){switch(_=""+_,_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(_){if(!_)return"utf8";for(var S;;)switch(_){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return _;default:if(S)return;_=(""+_).toLowerCase(),S=!0}}function n(_){var S=r(_);if(typeof S!="string"&&(e.isEncoding===t||!t(_)))throw new Error("Unknown encoding: "+_);return S||_}T2.StringDecoder=s;function s(_){this.encoding=n(_);var S;switch(this.encoding){case"utf16le":this.text=p,this.end=x,S=4;break;case"utf8":this.fillLast=c,S=4;break;case"base64":this.text=g,this.end=v,S=3;break;default:this.write=y,this.end=w;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(S)}s.prototype.write=function(_){if(_.length===0)return"";var S,E;if(this.lastNeed){if(S=this.fillLast(_),S===void 0)return"";E=this.lastNeed,this.lastNeed=0}else E=0;return E<_.length?S?S+this.text(_,E):this.text(_,E):S||""},s.prototype.end=h,s.prototype.text=f,s.prototype.fillLast=function(_){if(this.lastNeed<=_.length)return _.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,this.lastTotal-this.lastNeed,0,_.length),this.lastNeed-=_.length};function a(_){return _<=127?0:_>>5===6?2:_>>4===14?3:_>>3===30?4:_>>6===2?-1:-2}function i(_,S,E){var T=S.length-1;if(T<E)return 0;var k=a(S[T]);return k>=0?(k>0&&(_.lastNeed=k-1),k):--T<E||k===-2?0:(k=a(S[T]),k>=0?(k>0&&(_.lastNeed=k-2),k):--T<E||k===-2?0:(k=a(S[T]),k>=0?(k>0&&(k===2?k=0:_.lastNeed=k-3),k):0))}function o(_,S,E){if((S[0]&192)!==128)return _.lastNeed=0,"";if(_.lastNeed>1&&S.length>1){if((S[1]&192)!==128)return _.lastNeed=1,"";if(_.lastNeed>2&&S.length>2&&(S[2]&192)!==128)return _.lastNeed=2,""}}function c(_){var S=this.lastTotal-this.lastNeed,E=o(this,_);if(E!==void 0)return E;if(this.lastNeed<=_.length)return _.copy(this.lastChar,S,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,S,0,_.length),this.lastNeed-=_.length}function f(_,S){var E=i(this,_,S);if(!this.lastNeed)return _.toString("utf8",S);this.lastTotal=E;var T=_.length-(E-this.lastNeed);return _.copy(this.lastChar,0,T),_.toString("utf8",S,T)}function h(_){var S=_&&_.length?this.write(_):"";return this.lastNeed?S+"":S}function p(_,S){if((_.length-S)%2===0){var E=_.toString("utf16le",S);if(E){var T=E.charCodeAt(E.length-1);if(T>=55296&&T<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1],E.slice(0,-1)}return E}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=_[_.length-1],_.toString("utf16le",S,_.length-1)}function x(_){var S=_&&_.length?this.write(_):"";if(this.lastNeed){var E=this.lastTotal-this.lastNeed;return S+this.lastChar.toString("utf16le",0,E)}return S}function g(_,S){var E=(_.length-S)%3;return E===0?_.toString("base64",S):(this.lastNeed=3-E,this.lastTotal=3,E===1?this.lastChar[0]=_[_.length-1]:(this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1]),_.toString("base64",S,_.length-E))}function v(_){var S=_&&_.length?this.write(_):"";return this.lastNeed?S+this.lastChar.toString("base64",0,3-this.lastNeed):S}function y(_){return _.toString(this.encoding)}function w(_){return _&&_.length?this.write(_):""}return T2}var k2,jO;function IN(){if(jO)return k2;jO=1;var e=vd().codes.ERR_STREAM_PREMATURE_CLOSE;function t(a){var i=!1;return function(){if(!i){i=!0;for(var o=arguments.length,c=new Array(o),f=0;f<o;f++)c[f]=arguments[f];a.apply(this,c)}}}function r(){}function n(a){return a.setHeader&&typeof a.abort=="function"}function s(a,i,o){if(typeof i=="function")return s(a,null,i);i||(i={}),o=t(o||r);var c=i.readable||i.readable!==!1&&a.readable,f=i.writable||i.writable!==!1&&a.writable,h=function(){a.writable||x()},p=a._writableState&&a._writableState.finished,x=function(){f=!1,p=!0,c||o.call(a)},g=a._readableState&&a._readableState.endEmitted,v=function(){c=!1,g=!0,f||o.call(a)},y=function(E){o.call(a,E)},w=function(){var E;if(c&&!g)return(!a._readableState||!a._readableState.ended)&&(E=new e),o.call(a,E);if(f&&!p)return(!a._writableState||!a._writableState.ended)&&(E=new e),o.call(a,E)},_=function(){a.req.on("finish",x)};return n(a)?(a.on("complete",x),a.on("abort",w),a.req?_():a.on("request",_)):f&&!a._writableState&&(a.on("end",h),a.on("close",h)),a.on("end",v),a.on("finish",x),i.error!==!1&&a.on("error",y),a.on("close",w),function(){a.removeListener("complete",x),a.removeListener("abort",w),a.removeListener("request",_),a.req&&a.req.removeListener("finish",x),a.removeListener("end",h),a.removeListener("close",h),a.removeListener("finish",x),a.removeListener("end",v),a.removeListener("error",y),a.removeListener("close",w)}}return k2=s,k2}var A2,DO;function Pge(){if(DO)return A2;DO=1;var e;function t(_,S,E){return S in _?Object.defineProperty(_,S,{value:E,enumerable:!0,configurable:!0,writable:!0}):_[S]=E,_}var r=IN(),n=Symbol("lastResolve"),s=Symbol("lastReject"),a=Symbol("error"),i=Symbol("ended"),o=Symbol("lastPromise"),c=Symbol("handlePromise"),f=Symbol("stream");function h(_,S){return{value:_,done:S}}function p(_){var S=_[n];if(S!==null){var E=_[f].read();E!==null&&(_[o]=null,_[n]=null,_[s]=null,S(h(E,!1)))}}function x(_){Mt.nextTick(p,_)}function g(_,S){return function(E,T){_.then(function(){if(S[i]){E(h(void 0,!0));return}S[c](E,T)},T)}}var v=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((e={get stream(){return this[f]},next:function(){var S=this,E=this[a];if(E!==null)return Promise.reject(E);if(this[i])return Promise.resolve(h(void 0,!0));if(this[f].destroyed)return new Promise(function(O,z){Mt.nextTick(function(){S[a]?z(S[a]):O(h(void 0,!0))})});var T=this[o],k;if(T)k=new Promise(g(T,this));else{var D=this[f].read();if(D!==null)return Promise.resolve(h(D,!1));k=new Promise(this[c])}return this[o]=k,k}},t(e,Symbol.asyncIterator,function(){return this}),t(e,"return",function(){var S=this;return new Promise(function(E,T){S[f].destroy(null,function(k){if(k){T(k);return}E(h(void 0,!0))})})}),e),v),w=function(S){var E,T=Object.create(y,(E={},t(E,f,{value:S,writable:!0}),t(E,n,{value:null,writable:!0}),t(E,s,{value:null,writable:!0}),t(E,a,{value:null,writable:!0}),t(E,i,{value:S._readableState.endEmitted,writable:!0}),t(E,c,{value:function(D,O){var z=T[f].read();z?(T[o]=null,T[n]=null,T[s]=null,D(h(z,!1))):(T[n]=D,T[s]=O)},writable:!0}),E));return T[o]=null,r(S,function(k){if(k&&k.code!=="ERR_STREAM_PREMATURE_CLOSE"){var D=T[s];D!==null&&(T[o]=null,T[n]=null,T[s]=null,D(k)),T[a]=k;return}var O=T[n];O!==null&&(T[o]=null,T[n]=null,T[s]=null,O(h(void 0,!0))),T[i]=!0}),S.on("readable",x.bind(null,T)),T};return A2=w,A2}var C2,IO;function Lge(){return IO||(IO=1,C2=function(){throw new Error("Readable.from is not available in the browser")}),C2}var R2,MO;function KL(){if(MO)return R2;MO=1,R2=j;var e;j.ReadableState=z,RN().EventEmitter;var t=function(U,we){return U.listeners(we).length},r=IL(),n=Y1().Buffer,s=Fi.Uint8Array||function(){};function a(Y){return n.from(Y)}function i(Y){return n.isBuffer(Y)||Y instanceof s}var o=qL(),c;o&&o.debuglog?c=o.debuglog("stream"):c=function(){};var f=Ige(),h=WL(),p=$L(),x=p.getHighWaterMark,g=vd().codes,v=g.ERR_INVALID_ARG_TYPE,y=g.ERR_STREAM_PUSH_AFTER_EOF,w=g.ERR_METHOD_NOT_IMPLEMENTED,_=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,S,E,T;Ql()(j,r);var k=h.errorOrDestroy,D=["error","close","destroy","pause","resume"];function O(Y,U,we){if(typeof Y.prependListener=="function")return Y.prependListener(U,we);!Y._events||!Y._events[U]?Y.on(U,we):Array.isArray(Y._events[U])?Y._events[U].unshift(we):Y._events[U]=[we,Y._events[U]]}function z(Y,U,we){e=e||Wf(),Y=Y||{},typeof we!="boolean"&&(we=U instanceof e),this.objectMode=!!Y.objectMode,we&&(this.objectMode=this.objectMode||!!Y.readableObjectMode),this.highWaterMark=x(this,Y,"readableHighWaterMark",we),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Y.emitClose!==!1,this.autoDestroy=!!Y.autoDestroy,this.destroyed=!1,this.defaultEncoding=Y.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Y.encoding&&(S||(S=bE().StringDecoder),this.decoder=new S(Y.encoding),this.encoding=Y.encoding)}function j(Y){if(e=e||Wf(),!(this instanceof j))return new j(Y);var U=this instanceof e;this._readableState=new z(Y,this,U),this.readable=!0,Y&&(typeof Y.read=="function"&&(this._read=Y.read),typeof Y.destroy=="function"&&(this._destroy=Y.destroy)),r.call(this)}Object.defineProperty(j.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(U){this._readableState&&(this._readableState.destroyed=U)}}),j.prototype.destroy=h.destroy,j.prototype._undestroy=h.undestroy,j.prototype._destroy=function(Y,U){U(Y)},j.prototype.push=function(Y,U){var we=this._readableState,B;return we.objectMode?B=!0:typeof Y=="string"&&(U=U||we.defaultEncoding,U!==we.encoding&&(Y=n.from(Y,U),U=""),B=!0),J(this,Y,U,!1,B)},j.prototype.unshift=function(Y){return J(this,Y,null,!0,!1)};function J(Y,U,we,B,be){c("readableAddChunk",U);var V=Y._readableState;if(U===null)V.reading=!1,ee(Y,V);else{var C;if(be||(C=F(V,U)),C)k(Y,C);else if(V.objectMode||U&&U.length>0)if(typeof U!="string"&&!V.objectMode&&Object.getPrototypeOf(U)!==n.prototype&&(U=a(U)),B)V.endEmitted?k(Y,new _):ae(Y,V,U,!0);else if(V.ended)k(Y,new y);else{if(V.destroyed)return!1;V.reading=!1,V.decoder&&!we?(U=V.decoder.write(U),V.objectMode||U.length!==0?ae(Y,V,U,!1):ie(Y,V)):ae(Y,V,U,!1)}else B||(V.reading=!1,ie(Y,V))}return!V.ended&&(V.length<V.highWaterMark||V.length===0)}function ae(Y,U,we,B){U.flowing&&U.length===0&&!U.sync?(U.awaitDrain=0,Y.emit("data",we)):(U.length+=U.objectMode?1:we.length,B?U.buffer.unshift(we):U.buffer.push(we),U.needReadable&&te(Y)),ie(Y,U)}function F(Y,U){var we;return!i(U)&&typeof U!="string"&&U!==void 0&&!Y.objectMode&&(we=new v("chunk",["string","Buffer","Uint8Array"],U)),we}j.prototype.isPaused=function(){return this._readableState.flowing===!1},j.prototype.setEncoding=function(Y){S||(S=bE().StringDecoder);var U=new S(Y);this._readableState.decoder=U,this._readableState.encoding=this._readableState.decoder.encoding;for(var we=this._readableState.buffer.head,B="";we!==null;)B+=U.write(we.data),we=we.next;return this._readableState.buffer.clear(),B!==""&&this._readableState.buffer.push(B),this._readableState.length=B.length,this};var X=1073741824;function P(Y){return Y>=X?Y=X:(Y--,Y|=Y>>>1,Y|=Y>>>2,Y|=Y>>>4,Y|=Y>>>8,Y|=Y>>>16,Y++),Y}function le(Y,U){return Y<=0||U.length===0&&U.ended?0:U.objectMode?1:Y!==Y?U.flowing&&U.length?U.buffer.head.data.length:U.length:(Y>U.highWaterMark&&(U.highWaterMark=P(Y)),Y<=U.length?Y:U.ended?U.length:(U.needReadable=!0,0))}j.prototype.read=function(Y){c("read",Y),Y=parseInt(Y,10);var U=this._readableState,we=Y;if(Y!==0&&(U.emittedReadable=!1),Y===0&&U.needReadable&&((U.highWaterMark!==0?U.length>=U.highWaterMark:U.length>0)||U.ended))return c("read: emitReadable",U.length,U.ended),U.length===0&&U.ended?I(this):te(this),null;if(Y=le(Y,U),Y===0&&U.ended)return U.length===0&&I(this),null;var B=U.needReadable;c("need readable",B),(U.length===0||U.length-Y<U.highWaterMark)&&(B=!0,c("length less than watermark",B)),U.ended||U.reading?(B=!1,c("reading or ended",B)):B&&(c("do read"),U.reading=!0,U.sync=!0,U.length===0&&(U.needReadable=!0),this._read(U.highWaterMark),U.sync=!1,U.reading||(Y=le(we,U)));var be;return Y>0?be=L(Y,U):be=null,be===null?(U.needReadable=U.length<=U.highWaterMark,Y=0):(U.length-=Y,U.awaitDrain=0),U.length===0&&(U.ended||(U.needReadable=!0),we!==Y&&U.ended&&I(this)),be!==null&&this.emit("data",be),be};function ee(Y,U){if(c("onEofChunk"),!U.ended){if(U.decoder){var we=U.decoder.end();we&&we.length&&(U.buffer.push(we),U.length+=U.objectMode?1:we.length)}U.ended=!0,U.sync?te(Y):(U.needReadable=!1,U.emittedReadable||(U.emittedReadable=!0,me(Y)))}}function te(Y){var U=Y._readableState;c("emitReadable",U.needReadable,U.emittedReadable),U.needReadable=!1,U.emittedReadable||(c("emitReadable",U.flowing),U.emittedReadable=!0,Mt.nextTick(me,Y))}function me(Y){var U=Y._readableState;c("emitReadable_",U.destroyed,U.length,U.ended),!U.destroyed&&(U.length||U.ended)&&(Y.emit("readable"),U.emittedReadable=!1),U.needReadable=!U.flowing&&!U.ended&&U.length<=U.highWaterMark,re(Y)}function ie(Y,U){U.readingMore||(U.readingMore=!0,Mt.nextTick(Ee,Y,U))}function Ee(Y,U){for(;!U.reading&&!U.ended&&(U.length<U.highWaterMark||U.flowing&&U.length===0);){var we=U.length;if(c("maybeReadMore read 0"),Y.read(0),we===U.length)break}U.readingMore=!1}j.prototype._read=function(Y){k(this,new w("_read()"))},j.prototype.pipe=function(Y,U){var we=this,B=this._readableState;switch(B.pipesCount){case 0:B.pipes=Y;break;case 1:B.pipes=[B.pipes,Y];break;default:B.pipes.push(Y);break}B.pipesCount+=1,c("pipe count=%d opts=%j",B.pipesCount,U);var be=(!U||U.end!==!1)&&Y!==Mt.stdout&&Y!==Mt.stderr,V=be?A:$e;B.endEmitted?Mt.nextTick(V):we.once("end",V),Y.on("unpipe",C);function C(rt,at){c("onunpipe"),rt===we&&at&&at.hasUnpiped===!1&&(at.hasUnpiped=!0,ye())}function A(){c("onend"),Y.end()}var H=K(we);Y.on("drain",H);var ue=!1;function ye(){c("cleanup"),Y.removeListener("close",De),Y.removeListener("finish",Fe),Y.removeListener("drain",H),Y.removeListener("error",ke),Y.removeListener("unpipe",C),we.removeListener("end",A),we.removeListener("end",$e),we.removeListener("data",he),ue=!0,B.awaitDrain&&(!Y._writableState||Y._writableState.needDrain)&&H()}we.on("data",he);function he(rt){c("ondata");var at=Y.write(rt);c("dest.write",at),at===!1&&((B.pipesCount===1&&B.pipes===Y||B.pipesCount>1&&Q(B.pipes,Y)!==-1)&&!ue&&(c("false write response, pause",B.awaitDrain),B.awaitDrain++),we.pause())}function ke(rt){c("onerror",rt),$e(),Y.removeListener("error",ke),t(Y,"error")===0&&k(Y,rt)}O(Y,"error",ke);function De(){Y.removeListener("finish",Fe),$e()}Y.once("close",De);function Fe(){c("onfinish"),Y.removeListener("close",De),$e()}Y.once("finish",Fe);function $e(){c("unpipe"),we.unpipe(Y)}return Y.emit("pipe",we),B.flowing||(c("pipe resume"),we.resume()),Y};function K(Y){return function(){var we=Y._readableState;c("pipeOnDrain",we.awaitDrain),we.awaitDrain&&we.awaitDrain--,we.awaitDrain===0&&t(Y,"data")&&(we.flowing=!0,re(Y))}}j.prototype.unpipe=function(Y){var U=this._readableState,we={hasUnpiped:!1};if(U.pipesCount===0)return this;if(U.pipesCount===1)return Y&&Y!==U.pipes?this:(Y||(Y=U.pipes),U.pipes=null,U.pipesCount=0,U.flowing=!1,Y&&Y.emit("unpipe",this,we),this);if(!Y){var B=U.pipes,be=U.pipesCount;U.pipes=null,U.pipesCount=0,U.flowing=!1;for(var V=0;V<be;V++)B[V].emit("unpipe",this,{hasUnpiped:!1});return this}var C=Q(U.pipes,Y);return C===-1?this:(U.pipes.splice(C,1),U.pipesCount-=1,U.pipesCount===1&&(U.pipes=U.pipes[0]),Y.emit("unpipe",this,we),this)},j.prototype.on=function(Y,U){var we=r.prototype.on.call(this,Y,U),B=this._readableState;return Y==="data"?(B.readableListening=this.listenerCount("readable")>0,B.flowing!==!1&&this.resume()):Y==="readable"&&!B.endEmitted&&!B.readableListening&&(B.readableListening=B.needReadable=!0,B.flowing=!1,B.emittedReadable=!1,c("on readable",B.length,B.reading),B.length?te(this):B.reading||Mt.nextTick(q,this)),we},j.prototype.addListener=j.prototype.on,j.prototype.removeListener=function(Y,U){var we=r.prototype.removeListener.call(this,Y,U);return Y==="readable"&&Mt.nextTick(M,this),we},j.prototype.removeAllListeners=function(Y){var U=r.prototype.removeAllListeners.apply(this,arguments);return(Y==="readable"||Y===void 0)&&Mt.nextTick(M,this),U};function M(Y){var U=Y._readableState;U.readableListening=Y.listenerCount("readable")>0,U.resumeScheduled&&!U.paused?U.flowing=!0:Y.listenerCount("data")>0&&Y.resume()}function q(Y){c("readable nexttick read 0"),Y.read(0)}j.prototype.resume=function(){var Y=this._readableState;return Y.flowing||(c("resume"),Y.flowing=!Y.readableListening,G(this,Y)),Y.paused=!1,this};function G(Y,U){U.resumeScheduled||(U.resumeScheduled=!0,Mt.nextTick(Z,Y,U))}function Z(Y,U){c("resume",U.reading),U.reading||Y.read(0),U.resumeScheduled=!1,Y.emit("resume"),re(Y),U.flowing&&!U.reading&&Y.read(0)}j.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function re(Y){var U=Y._readableState;for(c("flow",U.flowing);U.flowing&&Y.read()!==null;);}j.prototype.wrap=function(Y){var U=this,we=this._readableState,B=!1;Y.on("end",function(){if(c("wrapped end"),we.decoder&&!we.ended){var C=we.decoder.end();C&&C.length&&U.push(C)}U.push(null)}),Y.on("data",function(C){if(c("wrapped data"),we.decoder&&(C=we.decoder.write(C)),!(we.objectMode&&C==null)&&!(!we.objectMode&&(!C||!C.length))){var A=U.push(C);A||(B=!0,Y.pause())}});for(var be in Y)this[be]===void 0&&typeof Y[be]=="function"&&(this[be]=(function(A){return function(){return Y[A].apply(Y,arguments)}})(be));for(var V=0;V<D.length;V++)Y.on(D[V],this.emit.bind(this,D[V]));return this._read=function(C){c("wrapped _read",C),B&&(B=!1,Y.resume())},this},typeof Symbol=="function"&&(j.prototype[Symbol.asyncIterator]=function(){return E===void 0&&(E=Pge()),E(this)}),Object.defineProperty(j.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(j.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(j.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(U){this._readableState&&(this._readableState.flowing=U)}}),j._fromList=L,Object.defineProperty(j.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function L(Y,U){if(U.length===0)return null;var we;return U.objectMode?we=U.buffer.shift():!Y||Y>=U.length?(U.decoder?we=U.buffer.join(""):U.buffer.length===1?we=U.buffer.first():we=U.buffer.concat(U.length),U.buffer.clear()):we=U.buffer.consume(Y,U.decoder),we}function I(Y){var U=Y._readableState;c("endReadable",U.endEmitted),U.endEmitted||(U.ended=!0,Mt.nextTick(se,U,Y))}function se(Y,U){if(c("endReadableNT",Y.endEmitted,Y.length),!Y.endEmitted&&Y.length===0&&(Y.endEmitted=!0,U.readable=!1,U.emit("end"),Y.autoDestroy)){var we=U._writableState;(!we||we.autoDestroy&&we.finished)&&U.destroy()}}typeof Symbol=="function"&&(j.from=function(Y,U){return T===void 0&&(T=Lge()),T(j,Y,U)});function Q(Y,U){for(var we=0,B=Y.length;we<B;we++)if(Y[we]===U)return we;return-1}return R2}var O2,FO;function XL(){if(FO)return O2;FO=1,O2=o;var e=vd().codes,t=e.ERR_METHOD_NOT_IMPLEMENTED,r=e.ERR_MULTIPLE_CALLBACK,n=e.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=e.ERR_TRANSFORM_WITH_LENGTH_0,a=Wf();Ql()(o,a);function i(h,p){var x=this._transformState;x.transforming=!1;var g=x.writecb;if(g===null)return this.emit("error",new r);x.writechunk=null,x.writecb=null,p!=null&&this.push(p),g(h);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function o(h){if(!(this instanceof o))return new o(h);a.call(this,h),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",c)}function c(){var h=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(p,x){f(h,p,x)}):f(this,null,null)}o.prototype.push=function(h,p){return this._transformState.needTransform=!1,a.prototype.push.call(this,h,p)},o.prototype._transform=function(h,p,x){x(new t("_transform()"))},o.prototype._write=function(h,p,x){var g=this._transformState;if(g.writecb=x,g.writechunk=h,g.writeencoding=p,!g.transforming){var v=this._readableState;(g.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},o.prototype._read=function(h){var p=this._transformState;p.writechunk!==null&&!p.transforming?(p.transforming=!0,this._transform(p.writechunk,p.writeencoding,p.afterTransform)):p.needTransform=!0},o.prototype._destroy=function(h,p){a.prototype._destroy.call(this,h,function(x){p(x)})};function f(h,p,x){if(p)return h.emit("error",p);if(x!=null&&h.push(x),h._writableState.length)throw new s;if(h._transformState.transforming)throw new n;return h.push(null)}return O2}var j2,PO;function Bge(){if(PO)return j2;PO=1,j2=t;var e=XL();Ql()(t,e);function t(r){if(!(this instanceof t))return new t(r);e.call(this,r)}return t.prototype._transform=function(r,n,s){s(null,r)},j2}var D2,LO;function Uge(){if(LO)return D2;LO=1;var e;function t(x){var g=!1;return function(){g||(g=!0,x.apply(void 0,arguments))}}var r=vd().codes,n=r.ERR_MISSING_ARGS,s=r.ERR_STREAM_DESTROYED;function a(x){if(x)throw x}function i(x){return x.setHeader&&typeof x.abort=="function"}function o(x,g,v,y){y=t(y);var w=!1;x.on("close",function(){w=!0}),e===void 0&&(e=IN()),e(x,{readable:g,writable:v},function(S){if(S)return y(S);w=!0,y()});var _=!1;return function(S){if(!w&&!_){if(_=!0,i(x))return x.abort();if(typeof x.destroy=="function")return x.destroy();y(S||new s("pipe"))}}}function c(x){x()}function f(x,g){return x.pipe(g)}function h(x){return!x.length||typeof x[x.length-1]!="function"?a:x.pop()}function p(){for(var x=arguments.length,g=new Array(x),v=0;v<x;v++)g[v]=arguments[v];var y=h(g);if(Array.isArray(g[0])&&(g=g[0]),g.length<2)throw new n("streams");var w,_=g.map(function(S,E){var T=E<g.length-1,k=E>0;return o(S,T,k,function(D){w||(w=D),D&&_.forEach(c),!T&&(_.forEach(c),y(w))})});return g.reduce(f)}return D2=p,D2}var I2,BO;function MN(){if(BO)return I2;BO=1,I2=r;var e=RN().EventEmitter,t=Ql();t(r,e),r.Readable=KL(),r.Writable=GL(),r.Duplex=Wf(),r.Transform=XL(),r.PassThrough=Bge(),r.finished=IN(),r.pipeline=Uge(),r.Stream=r;function r(){e.call(this)}return r.prototype.pipe=function(n,s){var a=this;function i(g){n.writable&&n.write(g)===!1&&a.pause&&a.pause()}a.on("data",i);function o(){a.readable&&a.resume&&a.resume()}n.on("drain",o),!n._isStdio&&(!s||s.end!==!1)&&(a.on("end",f),a.on("close",h));var c=!1;function f(){c||(c=!0,n.end())}function h(){c||(c=!0,typeof n.destroy=="function"&&n.destroy())}function p(g){if(x(),e.listenerCount(this,"error")===0)throw g}a.on("error",p),n.on("error",p);function x(){a.removeListener("data",i),n.removeListener("drain",o),a.removeListener("end",f),a.removeListener("close",h),a.removeListener("error",p),n.removeListener("error",p),a.removeListener("end",x),a.removeListener("close",x),n.removeListener("close",x)}return a.on("end",x),a.on("close",x),n.on("close",x),n.emit("pipe",a),n},I2}var UO;function zge(){return UO||(UO=1,(function(e){(function(t){t.parser=function(L,I){return new n(L,I)},t.SAXParser=n,t.SAXStream=h,t.createStream=f,t.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(L,I){if(!(this instanceof n))return new n(L,I);var se=this;a(se),se.q=se.c="",se.bufferCheckPosition=t.MAX_BUFFER_LENGTH,se.opt=I||{},se.opt.lowercase=se.opt.lowercase||se.opt.lowercasetags,se.looseCase=se.opt.lowercase?"toLowerCase":"toUpperCase",se.tags=[],se.closed=se.closedRoot=se.sawRoot=!1,se.tag=se.error=null,se.strict=!!L,se.noscript=!!(L||se.opt.noscript),se.state=j.BEGIN,se.strictEntities=se.opt.strictEntities,se.ENTITIES=se.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),se.attribList=[],se.opt.xmlns&&(se.ns=Object.create(y)),se.trackPosition=se.opt.position!==!1,se.trackPosition&&(se.position=se.line=se.column=0),ae(se,"onready")}Object.create||(Object.create=function(L){function I(){}I.prototype=L;var se=new I;return se}),Object.keys||(Object.keys=function(L){var I=[];for(var se in L)L.hasOwnProperty(se)&&I.push(se);return I});function s(L){for(var I=Math.max(t.MAX_BUFFER_LENGTH,10),se=0,Q=0,Y=r.length;Q<Y;Q++){var U=L[r[Q]].length;if(U>I)switch(r[Q]){case"textNode":X(L);break;case"cdata":F(L,"oncdata",L.cdata),L.cdata="";break;case"script":F(L,"onscript",L.script),L.script="";break;default:le(L,"Max buffer length exceeded: "+r[Q])}se=Math.max(se,U)}var we=t.MAX_BUFFER_LENGTH-se;L.bufferCheckPosition=we+L.position}function a(L){for(var I=0,se=r.length;I<se;I++)L[r[I]]=""}function i(L){X(L),L.cdata!==""&&(F(L,"oncdata",L.cdata),L.cdata=""),L.script!==""&&(F(L,"onscript",L.script),L.script="")}n.prototype={end:function(){ee(this)},write:re,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){i(this)}};var o;try{o=MN().Stream}catch{o=function(){}}var c=t.EVENTS.filter(function(L){return L!=="error"&&L!=="end"});function f(L,I){return new h(L,I)}function h(L,I){if(!(this instanceof h))return new h(L,I);o.apply(this),this._parser=new n(L,I),this.writable=!0,this.readable=!0;var se=this;this._parser.onend=function(){se.emit("end")},this._parser.onerror=function(Q){se.emit("error",Q),se._parser.error=null},this._decoder=null,c.forEach(function(Q){Object.defineProperty(se,"on"+Q,{get:function(){return se._parser["on"+Q]},set:function(Y){if(!Y)return se.removeAllListeners(Q),se._parser["on"+Q]=Y,Y;se.on(Q,Y)},enumerable:!0,configurable:!1})})}h.prototype=Object.create(o.prototype,{constructor:{value:h}}),h.prototype.write=function(L){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(L)){if(!this._decoder){var I=bE().StringDecoder;this._decoder=new I("utf8")}L=this._decoder.write(L)}return this._parser.write(L.toString()),this.emit("data",L),!0},h.prototype.end=function(L){return L&&L.length&&this.write(L),this._parser.end(),!0},h.prototype.on=function(L,I){var se=this;return!se._parser["on"+L]&&c.indexOf(L)!==-1&&(se._parser["on"+L]=function(){var Q=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);Q.splice(0,0,L),se.emit.apply(se,Q)}),o.prototype.on.call(se,L,I)};var p="[CDATA[",x="DOCTYPE",g="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/2000/xmlns/",y={xml:g,xmlns:v},w=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,S=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,E=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function T(L){return L===" "||L===`
`||L==="\r"||L==="	"}function k(L){return L==='"'||L==="'"}function D(L){return L===">"||T(L)}function O(L,I){return L.test(I)}function z(L,I){return!O(L,I)}var j=0;t.STATE={BEGIN:j++,BEGIN_WHITESPACE:j++,TEXT:j++,TEXT_ENTITY:j++,OPEN_WAKA:j++,SGML_DECL:j++,SGML_DECL_QUOTED:j++,DOCTYPE:j++,DOCTYPE_QUOTED:j++,DOCTYPE_DTD:j++,DOCTYPE_DTD_QUOTED:j++,COMMENT_STARTING:j++,COMMENT:j++,COMMENT_ENDING:j++,COMMENT_ENDED:j++,CDATA:j++,CDATA_ENDING:j++,CDATA_ENDING_2:j++,PROC_INST:j++,PROC_INST_BODY:j++,PROC_INST_ENDING:j++,OPEN_TAG:j++,OPEN_TAG_SLASH:j++,ATTRIB:j++,ATTRIB_NAME:j++,ATTRIB_NAME_SAW_WHITE:j++,ATTRIB_VALUE:j++,ATTRIB_VALUE_QUOTED:j++,ATTRIB_VALUE_CLOSED:j++,ATTRIB_VALUE_UNQUOTED:j++,ATTRIB_VALUE_ENTITY_Q:j++,ATTRIB_VALUE_ENTITY_U:j++,CLOSE_TAG:j++,CLOSE_TAG_SAW_WHITE:j++,SCRIPT:j++,SCRIPT_ENDING:j++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(L){var I=t.ENTITIES[L],se=typeof I=="number"?String.fromCharCode(I):I;t.ENTITIES[L]=se});for(var J in t.STATE)t.STATE[t.STATE[J]]=J;j=t.STATE;function ae(L,I,se){L[I]&&L[I](se)}function F(L,I,se){L.textNode&&X(L),ae(L,I,se)}function X(L){L.textNode=P(L.opt,L.textNode),L.textNode&&ae(L,"ontext",L.textNode),L.textNode=""}function P(L,I){return L.trim&&(I=I.trim()),L.normalize&&(I=I.replace(/\s+/g," ")),I}function le(L,I){return X(L),L.trackPosition&&(I+=`
Line: `+L.line+`
Column: `+L.column+`
Char: `+L.c),I=new Error(I),L.error=I,ae(L,"onerror",I),L}function ee(L){return L.sawRoot&&!L.closedRoot&&te(L,"Unclosed root tag"),L.state!==j.BEGIN&&L.state!==j.BEGIN_WHITESPACE&&L.state!==j.TEXT&&le(L,"Unexpected end"),X(L),L.c="",L.closed=!0,ae(L,"onend"),n.call(L,L.strict,L.opt),L}function te(L,I){if(typeof L!="object"||!(L instanceof n))throw new Error("bad call to strictFail");L.strict&&le(L,I)}function me(L){L.strict||(L.tagName=L.tagName[L.looseCase]());var I=L.tags[L.tags.length-1]||L,se=L.tag={name:L.tagName,attributes:{}};L.opt.xmlns&&(se.ns=I.ns),L.attribList.length=0,F(L,"onopentagstart",se)}function ie(L,I){var se=L.indexOf(":"),Q=se<0?["",L]:L.split(":"),Y=Q[0],U=Q[1];return I&&L==="xmlns"&&(Y="xmlns",U=""),{prefix:Y,local:U}}function Ee(L){if(L.strict||(L.attribName=L.attribName[L.looseCase]()),L.attribList.indexOf(L.attribName)!==-1||L.tag.attributes.hasOwnProperty(L.attribName)){L.attribName=L.attribValue="";return}if(L.opt.xmlns){var I=ie(L.attribName,!0),se=I.prefix,Q=I.local;if(se==="xmlns")if(Q==="xml"&&L.attribValue!==g)te(L,"xml: prefix must be bound to "+g+`
Actual: `+L.attribValue);else if(Q==="xmlns"&&L.attribValue!==v)te(L,"xmlns: prefix must be bound to "+v+`
Actual: `+L.attribValue);else{var Y=L.tag,U=L.tags[L.tags.length-1]||L;Y.ns===U.ns&&(Y.ns=Object.create(U.ns)),Y.ns[Q]=L.attribValue}L.attribList.push([L.attribName,L.attribValue])}else L.tag.attributes[L.attribName]=L.attribValue,F(L,"onattribute",{name:L.attribName,value:L.attribValue});L.attribName=L.attribValue=""}function K(L,I){if(L.opt.xmlns){var se=L.tag,Q=ie(L.tagName);se.prefix=Q.prefix,se.local=Q.local,se.uri=se.ns[Q.prefix]||"",se.prefix&&!se.uri&&(te(L,"Unbound namespace prefix: "+JSON.stringify(L.tagName)),se.uri=Q.prefix);var Y=L.tags[L.tags.length-1]||L;se.ns&&Y.ns!==se.ns&&Object.keys(se.ns).forEach(function(he){F(L,"onopennamespace",{prefix:he,uri:se.ns[he]})});for(var U=0,we=L.attribList.length;U<we;U++){var B=L.attribList[U],be=B[0],V=B[1],C=ie(be,!0),A=C.prefix,H=C.local,ue=A===""?"":se.ns[A]||"",ye={name:be,value:V,prefix:A,local:H,uri:ue};A&&A!=="xmlns"&&!ue&&(te(L,"Unbound namespace prefix: "+JSON.stringify(A)),ye.uri=A),L.tag.attributes[be]=ye,F(L,"onattribute",ye)}L.attribList.length=0}L.tag.isSelfClosing=!!I,L.sawRoot=!0,L.tags.push(L.tag),F(L,"onopentag",L.tag),I||(!L.noscript&&L.tagName.toLowerCase()==="script"?L.state=j.SCRIPT:L.state=j.TEXT,L.tag=null,L.tagName=""),L.attribName=L.attribValue="",L.attribList.length=0}function M(L){if(!L.tagName){te(L,"Weird empty close tag."),L.textNode+="</>",L.state=j.TEXT;return}if(L.script){if(L.tagName!=="script"){L.script+="</"+L.tagName+">",L.tagName="",L.state=j.SCRIPT;return}F(L,"onscript",L.script),L.script=""}var I=L.tags.length,se=L.tagName;L.strict||(se=se[L.looseCase]());for(var Q=se;I--;){var Y=L.tags[I];if(Y.name!==Q)te(L,"Unexpected close tag");else break}if(I<0){te(L,"Unmatched closing tag: "+L.tagName),L.textNode+="</"+L.tagName+">",L.state=j.TEXT;return}L.tagName=se;for(var U=L.tags.length;U-- >I;){var we=L.tag=L.tags.pop();L.tagName=L.tag.name,F(L,"onclosetag",L.tagName);var B={};for(var be in we.ns)B[be]=we.ns[be];var V=L.tags[L.tags.length-1]||L;L.opt.xmlns&&we.ns!==V.ns&&Object.keys(we.ns).forEach(function(C){var A=we.ns[C];F(L,"onclosenamespace",{prefix:C,uri:A})})}I===0&&(L.closedRoot=!0),L.tagName=L.attribValue=L.attribName="",L.attribList.length=0,L.state=j.TEXT}function q(L){var I=L.entity,se=I.toLowerCase(),Q,Y="";return L.ENTITIES[I]?L.ENTITIES[I]:L.ENTITIES[se]?L.ENTITIES[se]:(I=se,I.charAt(0)==="#"&&(I.charAt(1)==="x"?(I=I.slice(2),Q=parseInt(I,16),Y=Q.toString(16)):(I=I.slice(1),Q=parseInt(I,10),Y=Q.toString(10))),I=I.replace(/^0+/,""),isNaN(Q)||Y.toLowerCase()!==I?(te(L,"Invalid character entity"),"&"+L.entity+";"):String.fromCodePoint(Q))}function G(L,I){I==="<"?(L.state=j.OPEN_WAKA,L.startTagPosition=L.position):T(I)||(te(L,"Non-whitespace before first tag."),L.textNode=I,L.state=j.TEXT)}function Z(L,I){var se="";return I<L.length&&(se=L.charAt(I)),se}function re(L){var I=this;if(this.error)throw this.error;if(I.closed)return le(I,"Cannot write after close. Assign an onready handler.");if(L===null)return ee(I);typeof L=="object"&&(L=L.toString());for(var se=0,Q="";Q=Z(L,se++),I.c=Q,!!Q;)switch(I.trackPosition&&(I.position++,Q===`
`?(I.line++,I.column=0):I.column++),I.state){case j.BEGIN:if(I.state=j.BEGIN_WHITESPACE,Q==="\uFEFF")continue;G(I,Q);continue;case j.BEGIN_WHITESPACE:G(I,Q);continue;case j.TEXT:if(I.sawRoot&&!I.closedRoot){for(var Y=se-1;Q&&Q!=="<"&&Q!=="&";)Q=Z(L,se++),Q&&I.trackPosition&&(I.position++,Q===`
`?(I.line++,I.column=0):I.column++);I.textNode+=L.substring(Y,se-1)}Q==="<"&&!(I.sawRoot&&I.closedRoot&&!I.strict)?(I.state=j.OPEN_WAKA,I.startTagPosition=I.position):(!T(Q)&&(!I.sawRoot||I.closedRoot)&&te(I,"Text data outside of root node."),Q==="&"?I.state=j.TEXT_ENTITY:I.textNode+=Q);continue;case j.SCRIPT:Q==="<"?I.state=j.SCRIPT_ENDING:I.script+=Q;continue;case j.SCRIPT_ENDING:Q==="/"?I.state=j.CLOSE_TAG:(I.script+="<"+Q,I.state=j.SCRIPT);continue;case j.OPEN_WAKA:if(Q==="!")I.state=j.SGML_DECL,I.sgmlDecl="";else if(!T(Q))if(O(w,Q))I.state=j.OPEN_TAG,I.tagName=Q;else if(Q==="/")I.state=j.CLOSE_TAG,I.tagName="";else if(Q==="?")I.state=j.PROC_INST,I.procInstName=I.procInstBody="";else{if(te(I,"Unencoded <"),I.startTagPosition+1<I.position){var U=I.position-I.startTagPosition;Q=new Array(U).join(" ")+Q}I.textNode+="<"+Q,I.state=j.TEXT}continue;case j.SGML_DECL:(I.sgmlDecl+Q).toUpperCase()===p?(F(I,"onopencdata"),I.state=j.CDATA,I.sgmlDecl="",I.cdata=""):I.sgmlDecl+Q==="--"?(I.state=j.COMMENT,I.comment="",I.sgmlDecl=""):(I.sgmlDecl+Q).toUpperCase()===x?(I.state=j.DOCTYPE,(I.doctype||I.sawRoot)&&te(I,"Inappropriately located doctype declaration"),I.doctype="",I.sgmlDecl=""):Q===">"?(F(I,"onsgmldeclaration",I.sgmlDecl),I.sgmlDecl="",I.state=j.TEXT):(k(Q)&&(I.state=j.SGML_DECL_QUOTED),I.sgmlDecl+=Q);continue;case j.SGML_DECL_QUOTED:Q===I.q&&(I.state=j.SGML_DECL,I.q=""),I.sgmlDecl+=Q;continue;case j.DOCTYPE:Q===">"?(I.state=j.TEXT,F(I,"ondoctype",I.doctype),I.doctype=!0):(I.doctype+=Q,Q==="["?I.state=j.DOCTYPE_DTD:k(Q)&&(I.state=j.DOCTYPE_QUOTED,I.q=Q));continue;case j.DOCTYPE_QUOTED:I.doctype+=Q,Q===I.q&&(I.q="",I.state=j.DOCTYPE);continue;case j.DOCTYPE_DTD:I.doctype+=Q,Q==="]"?I.state=j.DOCTYPE:k(Q)&&(I.state=j.DOCTYPE_DTD_QUOTED,I.q=Q);continue;case j.DOCTYPE_DTD_QUOTED:I.doctype+=Q,Q===I.q&&(I.state=j.DOCTYPE_DTD,I.q="");continue;case j.COMMENT:Q==="-"?I.state=j.COMMENT_ENDING:I.comment+=Q;continue;case j.COMMENT_ENDING:Q==="-"?(I.state=j.COMMENT_ENDED,I.comment=P(I.opt,I.comment),I.comment&&F(I,"oncomment",I.comment),I.comment=""):(I.comment+="-"+Q,I.state=j.COMMENT);continue;case j.COMMENT_ENDED:Q!==">"?(te(I,"Malformed comment"),I.comment+="--"+Q,I.state=j.COMMENT):I.state=j.TEXT;continue;case j.CDATA:Q==="]"?I.state=j.CDATA_ENDING:I.cdata+=Q;continue;case j.CDATA_ENDING:Q==="]"?I.state=j.CDATA_ENDING_2:(I.cdata+="]"+Q,I.state=j.CDATA);continue;case j.CDATA_ENDING_2:Q===">"?(I.cdata&&F(I,"oncdata",I.cdata),F(I,"onclosecdata"),I.cdata="",I.state=j.TEXT):Q==="]"?I.cdata+="]":(I.cdata+="]]"+Q,I.state=j.CDATA);continue;case j.PROC_INST:Q==="?"?I.state=j.PROC_INST_ENDING:T(Q)?I.state=j.PROC_INST_BODY:I.procInstName+=Q;continue;case j.PROC_INST_BODY:if(!I.procInstBody&&T(Q))continue;Q==="?"?I.state=j.PROC_INST_ENDING:I.procInstBody+=Q;continue;case j.PROC_INST_ENDING:Q===">"?(F(I,"onprocessinginstruction",{name:I.procInstName,body:I.procInstBody}),I.procInstName=I.procInstBody="",I.state=j.TEXT):(I.procInstBody+="?"+Q,I.state=j.PROC_INST_BODY);continue;case j.OPEN_TAG:O(_,Q)?I.tagName+=Q:(me(I),Q===">"?K(I):Q==="/"?I.state=j.OPEN_TAG_SLASH:(T(Q)||te(I,"Invalid character in tag name"),I.state=j.ATTRIB));continue;case j.OPEN_TAG_SLASH:Q===">"?(K(I,!0),M(I)):(te(I,"Forward-slash in opening tag not followed by >"),I.state=j.ATTRIB);continue;case j.ATTRIB:if(T(Q))continue;Q===">"?K(I):Q==="/"?I.state=j.OPEN_TAG_SLASH:O(w,Q)?(I.attribName=Q,I.attribValue="",I.state=j.ATTRIB_NAME):te(I,"Invalid attribute name");continue;case j.ATTRIB_NAME:Q==="="?I.state=j.ATTRIB_VALUE:Q===">"?(te(I,"Attribute without value"),I.attribValue=I.attribName,Ee(I),K(I)):T(Q)?I.state=j.ATTRIB_NAME_SAW_WHITE:O(_,Q)?I.attribName+=Q:te(I,"Invalid attribute name");continue;case j.ATTRIB_NAME_SAW_WHITE:if(Q==="=")I.state=j.ATTRIB_VALUE;else{if(T(Q))continue;te(I,"Attribute without value"),I.tag.attributes[I.attribName]="",I.attribValue="",F(I,"onattribute",{name:I.attribName,value:""}),I.attribName="",Q===">"?K(I):O(w,Q)?(I.attribName=Q,I.state=j.ATTRIB_NAME):(te(I,"Invalid attribute name"),I.state=j.ATTRIB)}continue;case j.ATTRIB_VALUE:if(T(Q))continue;k(Q)?(I.q=Q,I.state=j.ATTRIB_VALUE_QUOTED):(te(I,"Unquoted attribute value"),I.state=j.ATTRIB_VALUE_UNQUOTED,I.attribValue=Q);continue;case j.ATTRIB_VALUE_QUOTED:if(Q!==I.q){Q==="&"?I.state=j.ATTRIB_VALUE_ENTITY_Q:I.attribValue+=Q;continue}Ee(I),I.q="",I.state=j.ATTRIB_VALUE_CLOSED;continue;case j.ATTRIB_VALUE_CLOSED:T(Q)?I.state=j.ATTRIB:Q===">"?K(I):Q==="/"?I.state=j.OPEN_TAG_SLASH:O(w,Q)?(te(I,"No whitespace between attributes"),I.attribName=Q,I.attribValue="",I.state=j.ATTRIB_NAME):te(I,"Invalid attribute name");continue;case j.ATTRIB_VALUE_UNQUOTED:if(!D(Q)){Q==="&"?I.state=j.ATTRIB_VALUE_ENTITY_U:I.attribValue+=Q;continue}Ee(I),Q===">"?K(I):I.state=j.ATTRIB;continue;case j.CLOSE_TAG:if(I.tagName)Q===">"?M(I):O(_,Q)?I.tagName+=Q:I.script?(I.script+="</"+I.tagName,I.tagName="",I.state=j.SCRIPT):(T(Q)||te(I,"Invalid tagname in closing tag"),I.state=j.CLOSE_TAG_SAW_WHITE);else{if(T(Q))continue;z(w,Q)?I.script?(I.script+="</"+Q,I.state=j.SCRIPT):te(I,"Invalid tagname in closing tag."):I.tagName=Q}continue;case j.CLOSE_TAG_SAW_WHITE:if(T(Q))continue;Q===">"?M(I):te(I,"Invalid characters in closing tag");continue;case j.TEXT_ENTITY:case j.ATTRIB_VALUE_ENTITY_Q:case j.ATTRIB_VALUE_ENTITY_U:var we,B;switch(I.state){case j.TEXT_ENTITY:we=j.TEXT,B="textNode";break;case j.ATTRIB_VALUE_ENTITY_Q:we=j.ATTRIB_VALUE_QUOTED,B="attribValue";break;case j.ATTRIB_VALUE_ENTITY_U:we=j.ATTRIB_VALUE_UNQUOTED,B="attribValue";break}Q===";"?(I[B]+=q(I),I.entity="",I.state=we):O(I.entity.length?E:S,Q)?I.entity+=Q:(te(I,"Invalid character in entity name"),I[B]+="&"+I.entity+Q,I.entity="",I.state=we);continue;default:throw new Error(I,"Unknown state: "+I.state)}return I.position>=I.bufferCheckPosition&&s(I),I}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||(function(){var L=String.fromCharCode,I=Math.floor,se=function(){var Q=16384,Y=[],U,we,B=-1,be=arguments.length;if(!be)return"";for(var V="";++B<be;){var C=Number(arguments[B]);if(!isFinite(C)||C<0||C>1114111||I(C)!==C)throw RangeError("Invalid code point: "+C);C<=65535?Y.push(C):(C-=65536,U=(C>>10)+55296,we=C%1024+56320,Y.push(U,we)),(B+1===be||Y.length>Q)&&(V+=L.apply(null,Y),Y.length=0)}return V};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:se,configurable:!0,writable:!0}):String.fromCodePoint=se})()})(e)})(vw)),vw}var M2,zO;function FN(){return zO||(zO=1,M2={isArray:function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)==="[object Array]"}}),M2}var F2,HO;function PN(){if(HO)return F2;HO=1;var e=FN().isArray;return F2={copyOptions:function(t){var r,n={};for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n},ensureFlagExists:function(t,r){(!(t in r)||typeof r[t]!="boolean")&&(r[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||typeof t.spaces!="number"&&typeof t.spaces!="string")&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){(!("alwaysArray"in t)||typeof t.alwaysArray!="boolean"&&!e(t.alwaysArray))&&(t.alwaysArray=!1)},ensureKeyExists:function(t,r){(!(t+"Key"in r)||typeof r[t+"Key"]!="string")&&(r[t+"Key"]=r.compact?"_"+t:t)},checkFnExists:function(t,r){return t+"Fn"in r}},F2}var P2,VO;function YL(){if(VO)return P2;VO=1;var e=zge(),t=PN(),r=FN().isArray,n,s;function a(_){return n=t.copyOptions(_),t.ensureFlagExists("ignoreDeclaration",n),t.ensureFlagExists("ignoreInstruction",n),t.ensureFlagExists("ignoreAttributes",n),t.ensureFlagExists("ignoreText",n),t.ensureFlagExists("ignoreComment",n),t.ensureFlagExists("ignoreCdata",n),t.ensureFlagExists("ignoreDoctype",n),t.ensureFlagExists("compact",n),t.ensureFlagExists("alwaysChildren",n),t.ensureFlagExists("addParent",n),t.ensureFlagExists("trim",n),t.ensureFlagExists("nativeType",n),t.ensureFlagExists("nativeTypeAttributes",n),t.ensureFlagExists("sanitize",n),t.ensureFlagExists("instructionHasAttributes",n),t.ensureFlagExists("captureSpacesBetweenElements",n),t.ensureAlwaysArrayExists(n),t.ensureKeyExists("declaration",n),t.ensureKeyExists("instruction",n),t.ensureKeyExists("attributes",n),t.ensureKeyExists("text",n),t.ensureKeyExists("comment",n),t.ensureKeyExists("cdata",n),t.ensureKeyExists("doctype",n),t.ensureKeyExists("type",n),t.ensureKeyExists("name",n),t.ensureKeyExists("elements",n),t.ensureKeyExists("parent",n),t.checkFnExists("doctype",n),t.checkFnExists("instruction",n),t.checkFnExists("cdata",n),t.checkFnExists("comment",n),t.checkFnExists("text",n),t.checkFnExists("instructionName",n),t.checkFnExists("elementName",n),t.checkFnExists("attributeName",n),t.checkFnExists("attributeValue",n),t.checkFnExists("attributes",n),n}function i(_){var S=Number(_);if(!isNaN(S))return S;var E=_.toLowerCase();return E==="true"?!0:E==="false"?!1:_}function o(_,S){var E;if(n.compact){if(!s[n[_+"Key"]]&&(r(n.alwaysArray)?n.alwaysArray.indexOf(n[_+"Key"])!==-1:n.alwaysArray)&&(s[n[_+"Key"]]=[]),s[n[_+"Key"]]&&!r(s[n[_+"Key"]])&&(s[n[_+"Key"]]=[s[n[_+"Key"]]]),_+"Fn"in n&&typeof S=="string"&&(S=n[_+"Fn"](S,s)),_==="instruction"&&("instructionFn"in n||"instructionNameFn"in n)){for(E in S)if(S.hasOwnProperty(E))if("instructionFn"in n)S[E]=n.instructionFn(S[E],E,s);else{var T=S[E];delete S[E],S[n.instructionNameFn(E,T,s)]=T}}r(s[n[_+"Key"]])?s[n[_+"Key"]].push(S):s[n[_+"Key"]]=S}else{s[n.elementsKey]||(s[n.elementsKey]=[]);var k={};if(k[n.typeKey]=_,_==="instruction"){for(E in S)if(S.hasOwnProperty(E))break;k[n.nameKey]="instructionNameFn"in n?n.instructionNameFn(E,S,s):E,n.instructionHasAttributes?(k[n.attributesKey]=S[E][n.attributesKey],"instructionFn"in n&&(k[n.attributesKey]=n.instructionFn(k[n.attributesKey],E,s))):("instructionFn"in n&&(S[E]=n.instructionFn(S[E],E,s)),k[n.instructionKey]=S[E])}else _+"Fn"in n&&(S=n[_+"Fn"](S,s)),k[n[_+"Key"]]=S;n.addParent&&(k[n.parentKey]=s),s[n.elementsKey].push(k)}}function c(_){if("attributesFn"in n&&_&&(_=n.attributesFn(_,s)),(n.trim||"attributeValueFn"in n||"attributeNameFn"in n||n.nativeTypeAttributes)&&_){var S;for(S in _)if(_.hasOwnProperty(S)&&(n.trim&&(_[S]=_[S].trim()),n.nativeTypeAttributes&&(_[S]=i(_[S])),"attributeValueFn"in n&&(_[S]=n.attributeValueFn(_[S],S,s)),"attributeNameFn"in n)){var E=_[S];delete _[S],_[n.attributeNameFn(S,_[S],s)]=E}}return _}function f(_){var S={};if(_.body&&(_.name.toLowerCase()==="xml"||n.instructionHasAttributes)){for(var E=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,T;(T=E.exec(_.body))!==null;)S[T[1]]=T[2]||T[3]||T[4];S=c(S)}if(_.name.toLowerCase()==="xml"){if(n.ignoreDeclaration)return;s[n.declarationKey]={},Object.keys(S).length&&(s[n.declarationKey][n.attributesKey]=S),n.addParent&&(s[n.declarationKey][n.parentKey]=s)}else{if(n.ignoreInstruction)return;n.trim&&(_.body=_.body.trim());var k={};n.instructionHasAttributes&&Object.keys(S).length?(k[_.name]={},k[_.name][n.attributesKey]=S):k[_.name]=_.body,o("instruction",k)}}function h(_,S){var E;if(typeof _=="object"&&(S=_.attributes,_=_.name),S=c(S),"elementNameFn"in n&&(_=n.elementNameFn(_,s)),n.compact){if(E={},!n.ignoreAttributes&&S&&Object.keys(S).length){E[n.attributesKey]={};var T;for(T in S)S.hasOwnProperty(T)&&(E[n.attributesKey][T]=S[T])}!(_ in s)&&(r(n.alwaysArray)?n.alwaysArray.indexOf(_)!==-1:n.alwaysArray)&&(s[_]=[]),s[_]&&!r(s[_])&&(s[_]=[s[_]]),r(s[_])?s[_].push(E):s[_]=E}else s[n.elementsKey]||(s[n.elementsKey]=[]),E={},E[n.typeKey]="element",E[n.nameKey]=_,!n.ignoreAttributes&&S&&Object.keys(S).length&&(E[n.attributesKey]=S),n.alwaysChildren&&(E[n.elementsKey]=[]),s[n.elementsKey].push(E);E[n.parentKey]=s,s=E}function p(_){n.ignoreText||!_.trim()&&!n.captureSpacesBetweenElements||(n.trim&&(_=_.trim()),n.nativeType&&(_=i(_)),n.sanitize&&(_=_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),o("text",_))}function x(_){n.ignoreComment||(n.trim&&(_=_.trim()),o("comment",_))}function g(_){var S=s[n.parentKey];n.addParent||delete s[n.parentKey],s=S}function v(_){n.ignoreCdata||(n.trim&&(_=_.trim()),o("cdata",_))}function y(_){n.ignoreDoctype||(_=_.replace(/^ /,""),n.trim&&(_=_.trim()),o("doctype",_))}function w(_){_.note=_}return P2=function(_,S){var E=e.parser(!0,{}),T={};if(s=T,n=a(S),E.opt={strictEntities:!0},E.onopentag=h,E.ontext=p,E.oncomment=x,E.onclosetag=g,E.onerror=w,E.oncdata=v,E.ondoctype=y,E.onprocessinginstruction=f,E.write(_).close(),T[n.elementsKey]){var k=T[n.elementsKey];delete T[n.elementsKey],T[n.elementsKey]=k,delete T.text}return T},P2}var L2,qO;function Hge(){if(qO)return L2;qO=1;var e=PN(),t=YL();function r(n){var s=e.copyOptions(n);return e.ensureSpacesExists(s),s}return L2=function(n,s){var a,i,o,c;return a=r(s),i=t(n,a),c="compact"in a&&a.compact?"_parent":"parent","addParent"in a&&a.addParent?o=JSON.stringify(i,function(f,h){return f===c?"_":h},a.spaces):o=JSON.stringify(i,null,a.spaces),o.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},L2}var B2,WO;function JL(){if(WO)return B2;WO=1;var e=PN(),t=FN().isArray,r,n;function s(E){var T=e.copyOptions(E);return e.ensureFlagExists("ignoreDeclaration",T),e.ensureFlagExists("ignoreInstruction",T),e.ensureFlagExists("ignoreAttributes",T),e.ensureFlagExists("ignoreText",T),e.ensureFlagExists("ignoreComment",T),e.ensureFlagExists("ignoreCdata",T),e.ensureFlagExists("ignoreDoctype",T),e.ensureFlagExists("compact",T),e.ensureFlagExists("indentText",T),e.ensureFlagExists("indentCdata",T),e.ensureFlagExists("indentAttributes",T),e.ensureFlagExists("indentInstruction",T),e.ensureFlagExists("fullTagEmptyElement",T),e.ensureFlagExists("noQuotesForNativeAttributes",T),e.ensureSpacesExists(T),typeof T.spaces=="number"&&(T.spaces=Array(T.spaces+1).join(" ")),e.ensureKeyExists("declaration",T),e.ensureKeyExists("instruction",T),e.ensureKeyExists("attributes",T),e.ensureKeyExists("text",T),e.ensureKeyExists("comment",T),e.ensureKeyExists("cdata",T),e.ensureKeyExists("doctype",T),e.ensureKeyExists("type",T),e.ensureKeyExists("name",T),e.ensureKeyExists("elements",T),e.checkFnExists("doctype",T),e.checkFnExists("instruction",T),e.checkFnExists("cdata",T),e.checkFnExists("comment",T),e.checkFnExists("text",T),e.checkFnExists("instructionName",T),e.checkFnExists("elementName",T),e.checkFnExists("attributeName",T),e.checkFnExists("attributeValue",T),e.checkFnExists("attributes",T),e.checkFnExists("fullTagEmptyElement",T),T}function a(E,T,k){return(!k&&E.spaces?`
`:"")+Array(T+1).join(E.spaces)}function i(E,T,k){if(T.ignoreAttributes)return"";"attributesFn"in T&&(E=T.attributesFn(E,n,r));var D,O,z,j,J=[];for(D in E)E.hasOwnProperty(D)&&E[D]!==null&&E[D]!==void 0&&(j=T.noQuotesForNativeAttributes&&typeof E[D]!="string"?"":'"',O=""+E[D],O=O.replace(/"/g,"&quot;"),z="attributeNameFn"in T?T.attributeNameFn(D,O,n,r):D,J.push(T.spaces&&T.indentAttributes?a(T,k+1,!1):" "),J.push(z+"="+j+("attributeValueFn"in T?T.attributeValueFn(O,D,n,r):O)+j));return E&&Object.keys(E).length&&T.spaces&&T.indentAttributes&&J.push(a(T,k,!1)),J.join("")}function o(E,T,k){return r=E,n="xml",T.ignoreDeclaration?"":"<?xml"+i(E[T.attributesKey],T,k)+"?>"}function c(E,T,k){if(T.ignoreInstruction)return"";var D;for(D in E)if(E.hasOwnProperty(D))break;var O="instructionNameFn"in T?T.instructionNameFn(D,E[D],n,r):D;if(typeof E[D]=="object")return r=E,n=O,"<?"+O+i(E[D][T.attributesKey],T,k)+"?>";var z=E[D]?E[D]:"";return"instructionFn"in T&&(z=T.instructionFn(z,D,n,r)),"<?"+O+(z?" "+z:"")+"?>"}function f(E,T){return T.ignoreComment?"":"<!--"+("commentFn"in T?T.commentFn(E,n,r):E)+"-->"}function h(E,T){return T.ignoreCdata?"":"<![CDATA["+("cdataFn"in T?T.cdataFn(E,n,r):E.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function p(E,T){return T.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in T?T.doctypeFn(E,n,r):E)+">"}function x(E,T){return T.ignoreText?"":(E=""+E,E=E.replace(/&amp;/g,"&"),E=E.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in T?T.textFn(E,n,r):E)}function g(E,T){var k;if(E.elements&&E.elements.length)for(k=0;k<E.elements.length;++k)switch(E.elements[k][T.typeKey]){case"text":if(T.indentText)return!0;break;case"cdata":if(T.indentCdata)return!0;break;case"instruction":if(T.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function v(E,T,k){r=E,n=E.name;var D=[],O="elementNameFn"in T?T.elementNameFn(E.name,E):E.name;D.push("<"+O),E[T.attributesKey]&&D.push(i(E[T.attributesKey],T,k));var z=E[T.elementsKey]&&E[T.elementsKey].length||E[T.attributesKey]&&E[T.attributesKey]["xml:space"]==="preserve";return z||("fullTagEmptyElementFn"in T?z=T.fullTagEmptyElementFn(E.name,E):z=T.fullTagEmptyElement),z?(D.push(">"),E[T.elementsKey]&&E[T.elementsKey].length&&(D.push(y(E[T.elementsKey],T,k+1)),r=E,n=E.name),D.push(T.spaces&&g(E,T)?`
`+Array(k+1).join(T.spaces):""),D.push("</"+O+">")):D.push("/>"),D.join("")}function y(E,T,k,D){return E.reduce(function(O,z){var j=a(T,k,D&&!O);switch(z.type){case"element":return O+j+v(z,T,k);case"comment":return O+j+f(z[T.commentKey],T);case"doctype":return O+j+p(z[T.doctypeKey],T);case"cdata":return O+(T.indentCdata?j:"")+h(z[T.cdataKey],T);case"text":return O+(T.indentText?j:"")+x(z[T.textKey],T);case"instruction":var J={};return J[z[T.nameKey]]=z[T.attributesKey]?z:z[T.instructionKey],O+(T.indentInstruction?j:"")+c(J,T,k)}},"")}function w(E,T,k){var D;for(D in E)if(E.hasOwnProperty(D))switch(D){case T.parentKey:case T.attributesKey:break;case T.textKey:if(T.indentText||k)return!0;break;case T.cdataKey:if(T.indentCdata||k)return!0;break;case T.instructionKey:if(T.indentInstruction||k)return!0;break;case T.doctypeKey:case T.commentKey:return!0;default:return!0}return!1}function _(E,T,k,D,O){r=E,n=T;var z="elementNameFn"in k?k.elementNameFn(T,E):T;if(typeof E>"u"||E===null||E==="")return"fullTagEmptyElementFn"in k&&k.fullTagEmptyElementFn(T,E)||k.fullTagEmptyElement?"<"+z+"></"+z+">":"<"+z+"/>";var j=[];if(T){if(j.push("<"+z),typeof E!="object")return j.push(">"+x(E,k)+"</"+z+">"),j.join("");E[k.attributesKey]&&j.push(i(E[k.attributesKey],k,D));var J=w(E,k,!0)||E[k.attributesKey]&&E[k.attributesKey]["xml:space"]==="preserve";if(J||("fullTagEmptyElementFn"in k?J=k.fullTagEmptyElementFn(T,E):J=k.fullTagEmptyElement),J)j.push(">");else return j.push("/>"),j.join("")}return j.push(S(E,k,D+1,!1)),r=E,n=T,T&&j.push((O?a(k,D,!1):"")+"</"+z+">"),j.join("")}function S(E,T,k,D){var O,z,j,J=[];for(z in E)if(E.hasOwnProperty(z))for(j=t(E[z])?E[z]:[E[z]],O=0;O<j.length;++O){switch(z){case T.declarationKey:J.push(o(j[O],T,k));break;case T.instructionKey:J.push((T.indentInstruction?a(T,k,D):"")+c(j[O],T,k));break;case T.attributesKey:case T.parentKey:break;case T.textKey:J.push((T.indentText?a(T,k,D):"")+x(j[O],T));break;case T.cdataKey:J.push((T.indentCdata?a(T,k,D):"")+h(j[O],T));break;case T.doctypeKey:J.push(a(T,k,D)+p(j[O],T));break;case T.commentKey:J.push(a(T,k,D)+f(j[O],T));break;default:J.push(a(T,k,D)+_(j[O],z,T,k,w(j[O],T)))}D=D&&!J.length}return J.join("")}return B2=function(E,T){T=s(T);var k=[];return r=E,n="_root_",T.compact?k.push(S(E,T,0,!0)):(E[T.declarationKey]&&k.push(o(E[T.declarationKey],T,0)),E[T.elementsKey]&&E[T.elementsKey].length&&k.push(y(E[T.elementsKey],T,0,!k.length))),k.join("")},B2}var U2,$O;function Vge(){if($O)return U2;$O=1;var e=JL();return U2=function(t,r){t instanceof Buffer&&(t=t.toString());var n=null;if(typeof t=="string")try{n=JSON.parse(t)}catch{throw new Error("The JSON structure is invalid")}else n=t;return e(n,r)},U2}var z2,GO;function qge(){if(GO)return z2;GO=1;var e=YL(),t=Hge(),r=JL(),n=Vge();return z2={xml2js:e,xml2json:t,js2xml:r,json2xml:n},z2}var ZL=qge();const LN=e=>{switch(e.type){case void 0:case"element":const t=new $ge(e.name,e.attributes),r=e.elements||[];for(const n of r){const s=LN(n);s!==void 0&&t.push(s)}return t;case"text":return e.text;default:return}};class Wge extends ut{}class $ge extends Be{static fromXmlString(t){const r=ZL.xml2js(t,{compact:!1});return LN(r)}constructor(t,r){super(t),r&&this.root.push(new Wge(r))}push(t){this.root.push(t)}}class Gge extends Be{constructor(t){super(""),this._attr=t}prepForXml(t){return{_attr:this._attr}}}class QL extends Be{constructor(t,r){super(t),r&&(this.root=r.root)}}const Vs=e=>{if(isNaN(e))throw new Error(`Invalid value '${e}' specified. Must be an integer.`);return Math.floor(e)},Z1=e=>{const t=Vs(e);if(t<0)throw new Error(`Invalid value '${e}' specified. Must be a positive integer.`);return t},eB=(e,t)=>{const r=t*2;if(e.length!==r||isNaN(+`0x${e}`))throw new Error(`Invalid hex value '${e}'. Expected ${r} digit hex value`);return e},KO=e=>eB(e,1),tB=e=>{const t=e.slice(-2),r=e.substring(0,e.length-2);return`${Number(r)}${t}`},rB=e=>{const t=tB(e);if(parseFloat(t)<0)throw new Error(`Invalid value '${t}' specified. Expected a positive number.`);return t},$f=e=>{if(e==="auto")return e;const t=e.charAt(0)==="#"?e.substring(1):e;return eB(t,3)},jc=e=>typeof e=="string"?tB(e):Vs(e),Kge=e=>typeof e=="string"?rB(e):Z1(e),ti=e=>typeof e=="string"?rB(e):Z1(e),Xge=Z1,Yge=Z1,Jge=e=>e.toISOString();class Ge extends Be{constructor(t,r=!0){super(t),r!==!0&&this.root.push(new tn({val:r}))}}class H2 extends Be{constructor(t,r){super(t),this.root.push(new tn({val:Kge(r)}))}}class Ef extends Be{constructor(t,r){super(t),this.root.push(new tn({val:r}))}}const wh=(e,t)=>new ar({name:e,attributes:{value:{key:"w:val",value:t}}});class a0 extends Be{constructor(t,r){super(t),this.root.push(new tn({val:r}))}}class vc extends Be{constructor(t,r){super(t),this.root.push(r)}}class ar extends Be{constructor({name:t,attributes:r,children:n}){super(t),r&&this.root.push(new dp(r)),n&&this.root.push(...n)}}const ja={START:"start",CENTER:"center",END:"end",BOTH:"both",MEDIUM_KASHIDA:"mediumKashida",DISTRIBUTE:"distribute",NUM_TAB:"numTab",HIGH_KASHIDA:"highKashida",LOW_KASHIDA:"lowKashida",THAI_DISTRIBUTE:"thaiDistribute",LEFT:"left",RIGHT:"right",JUSTIFIED:"both"};class Zge extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class Qge extends Be{constructor(t){super("w:jc"),this.root.push(new Zge({val:t}))}}class zr extends Be{constructor(t,{color:r,size:n,space:s,style:a}){super(t),this.root.push(new e1e({style:a,color:r===void 0?void 0:$f(r),size:n===void 0?void 0:Xge(n),space:s===void 0?void 0:Yge(s)}))}}class e1e extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const BN={SINGLE:"single",NONE:"none"};class t1e extends X1{constructor(t){super("w:pBdr"),t.top&&this.root.push(new zr("w:top",t.top)),t.bottom&&this.root.push(new zr("w:bottom",t.bottom)),t.left&&this.root.push(new zr("w:left",t.left)),t.right&&this.root.push(new zr("w:right",t.right))}}class r1e extends Be{constructor(){super("w:pBdr");const t=new zr("w:bottom",{color:"auto",space:1,style:BN.SINGLE,size:6});this.root.push(t)}}class n1e extends Be{constructor({start:t,end:r,left:n,right:s,hanging:a,firstLine:i}){super("w:ind"),this.root.push(new dp({start:{key:"w:start",value:t===void 0?void 0:jc(t)},end:{key:"w:end",value:r===void 0?void 0:jc(r)},left:{key:"w:left",value:n===void 0?void 0:jc(n)},right:{key:"w:right",value:s===void 0?void 0:jc(s)},hanging:{key:"w:hanging",value:a===void 0?void 0:ti(a)},firstLine:{key:"w:firstLine",value:i===void 0?void 0:ti(i)}}))}}let s1e=class extends Be{constructor(){super("w:br")}};const UN={BEGIN:"begin",END:"end",SEPARATE:"separate"};class zN extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class px extends Be{constructor(t){super("w:fldChar"),this.root.push(new zN({type:UN.BEGIN,dirty:t}))}}class mx extends Be{constructor(t){super("w:fldChar"),this.root.push(new zN({type:UN.SEPARATE,dirty:t}))}}class xx extends Be{constructor(t){super("w:fldChar"),this.root.push(new zN({type:UN.END,dirty:t}))}}const Gf={DEFAULT:"default",PRESERVE:"preserve"};class Kf extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{space:"xml:space"})}}class a1e extends Be{constructor(){super("w:instrText"),this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push("PAGE")}}class i1e extends Be{constructor(){super("w:instrText"),this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push("NUMPAGES")}}class o1e extends Be{constructor(){super("w:instrText"),this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push("SECTIONPAGES")}}class l1e extends Be{constructor(){super("w:instrText"),this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push("SECTION")}}class c1e extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class nB extends Be{constructor({fill:t,color:r,type:n}){super("w:shd"),this.root.push(new c1e({fill:t===void 0?void 0:$f(t),color:r===void 0?void 0:$f(r),type:n}))}}class u1e extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const f1e={DOT:"dot"};class d1e extends Be{constructor(t){super("w:em"),this.root.push(new tn({val:t}))}}class h1e extends d1e{constructor(t=f1e.DOT){super(t)}}class p1e extends Be{constructor(t){super("w:spacing"),this.root.push(new tn({val:jc(t)}))}}class m1e extends Be{constructor(t){super("w:color"),this.root.push(new tn({val:$f(t)}))}}class x1e extends Be{constructor(t){super("w:highlight"),this.root.push(new tn({val:t}))}}class g1e extends Be{constructor(t){super("w:highlightCs"),this.root.push(new tn({val:t}))}}const y1e=e=>new ar({name:"w:lang",attributes:{value:{key:"w:val",value:e.value},eastAsia:{key:"w:eastAsia",value:e.eastAsia},bidirectional:{key:"w:bidi",value:e.bidirectional}}});class XO extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class V2 extends Be{constructor(t,r){if(super("w:rFonts"),typeof t=="string"){const n=t;this.root.push(new XO({ascii:n,cs:n,eastAsia:n,hAnsi:n,hint:r}))}else{const n=t;this.root.push(new XO(n))}}}let sB=class extends Be{constructor(t){super("w:vertAlign"),this.root.push(new tn({val:t}))}};class v1e extends sB{constructor(){super("superscript")}}class b1e extends sB{constructor(){super("subscript")}}const aB={SINGLE:"single"};class w1e extends Be{constructor(t=aB.SINGLE,r){super("w:u"),this.root.push(new tn({val:t,color:r===void 0?void 0:$f(r)}))}}class vu extends X1{constructor(t){var r,n;if(super("w:rPr"),!t)return;t.style&&this.push(new Ef("w:rStyle",t.style)),t.font&&(typeof t.font=="string"?this.push(new V2(t.font)):"name"in t.font?this.push(new V2(t.font.name,t.font.hint)):this.push(new V2(t.font))),t.bold!==void 0&&this.push(new Ge("w:b",t.bold)),(t.boldComplexScript===void 0&&t.bold!==void 0||t.boldComplexScript)&&this.push(new Ge("w:bCs",(r=t.boldComplexScript)!=null?r:t.bold)),t.italics!==void 0&&this.push(new Ge("w:i",t.italics)),(t.italicsComplexScript===void 0&&t.italics!==void 0||t.italicsComplexScript)&&this.push(new Ge("w:iCs",(n=t.italicsComplexScript)!=null?n:t.italics)),t.smallCaps!==void 0?this.push(new Ge("w:smallCaps",t.smallCaps)):t.allCaps!==void 0&&this.push(new Ge("w:caps",t.allCaps)),t.strike!==void 0&&this.push(new Ge("w:strike",t.strike)),t.doubleStrike!==void 0&&this.push(new Ge("w:dstrike",t.doubleStrike)),t.emboss!==void 0&&this.push(new Ge("w:emboss",t.emboss)),t.imprint!==void 0&&this.push(new Ge("w:imprint",t.imprint)),t.noProof!==void 0&&this.push(new Ge("w:noProof",t.noProof)),t.snapToGrid!==void 0&&this.push(new Ge("w:snapToGrid",t.snapToGrid)),t.vanish&&this.push(new Ge("w:vanish",t.vanish)),t.color&&this.push(new m1e(t.color)),t.characterSpacing&&this.push(new p1e(t.characterSpacing)),t.scale!==void 0&&this.push(new a0("w:w",t.scale)),t.kern&&this.push(new H2("w:kern",t.kern)),t.position&&this.push(new Ef("w:position",t.position)),t.size!==void 0&&this.push(new H2("w:sz",t.size));const s=t.sizeComplexScript===void 0||t.sizeComplexScript===!0?t.size:t.sizeComplexScript;s&&this.push(new H2("w:szCs",s)),t.highlight&&this.push(new x1e(t.highlight));const a=t.highlightComplexScript===void 0||t.highlightComplexScript===!0?t.highlight:t.highlightComplexScript;a&&this.push(new g1e(a)),t.underline&&this.push(new w1e(t.underline.type,t.underline.color)),t.effect&&this.push(new Ef("w:effect",t.effect)),t.border&&this.push(new zr("w:bdr",t.border)),t.shading&&this.push(new nB(t.shading)),t.subScript&&this.push(new b1e),t.superScript&&this.push(new v1e),t.rightToLeft!==void 0&&this.push(new Ge("w:rtl",t.rightToLeft)),t.emphasisMark&&this.push(new h1e(t.emphasisMark.type)),t.language&&this.push(y1e(t.language)),t.specVanish&&this.push(new Ge("w:specVanish",t.vanish)),t.math&&this.push(new Ge("w:oMath",t.math)),t.revision&&this.push(new _1e(t.revision))}push(t){this.root.push(t)}}class _1e extends Be{constructor(t){super("w:rPrChange"),this.root.push(new u1e({id:t.id,author:t.author,date:t.date})),this.addChildElement(new vu(t))}}class YO extends Be{constructor(t){var r;super("w:t"),typeof t=="string"?(this.root.push(new Kf({space:Gf.PRESERVE})),this.root.push(t)):(this.root.push(new Kf({space:(r=t.space)!=null?r:Gf.DEFAULT})),this.root.push(t.text))}}const gx={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class xp extends Be{constructor(t){if(super("w:r"),Pe(this,"properties"),this.properties=new vu(t),this.root.push(this.properties),t.break)for(let r=0;r<t.break;r++)this.root.push(new s1e);if(t.children)for(const r of t.children){if(typeof r=="string"){switch(r){case gx.CURRENT:this.root.push(new px),this.root.push(new a1e),this.root.push(new mx),this.root.push(new xx);break;case gx.TOTAL_PAGES:this.root.push(new px),this.root.push(new i1e),this.root.push(new mx),this.root.push(new xx);break;case gx.TOTAL_PAGES_IN_SECTION:this.root.push(new px),this.root.push(new o1e),this.root.push(new mx),this.root.push(new xx);break;case gx.CURRENT_SECTION:this.root.push(new px),this.root.push(new l1e),this.root.push(new mx),this.root.push(new xx);break;default:this.root.push(new YO(r));break}continue}this.root.push(r)}else t.text!==void 0&&this.root.push(new YO(t.text))}}class Sc extends xp{constructor(t){super(typeof t=="string"?{text:t}:t)}}var q2={},fr={},W2,JO;function gp(){if(JO)return W2;JO=1,W2=e;function e(t,r){if(!t)throw new Error(r||"Assertion failed")}return e.equal=function(r,n,s){if(r!=n)throw new Error(s||"Assertion failed: "+r+" != "+n)},W2}var ZO;function Vi(){if(ZO)return fr;ZO=1;var e=gp(),t=Ql();fr.inherits=t;function r(F,X){return(F.charCodeAt(X)&64512)!==55296||X<0||X+1>=F.length?!1:(F.charCodeAt(X+1)&64512)===56320}function n(F,X){if(Array.isArray(F))return F.slice();if(!F)return[];var P=[];if(typeof F=="string")if(X){if(X==="hex")for(F=F.replace(/[^a-z0-9]+/ig,""),F.length%2!==0&&(F="0"+F),ee=0;ee<F.length;ee+=2)P.push(parseInt(F[ee]+F[ee+1],16))}else for(var le=0,ee=0;ee<F.length;ee++){var te=F.charCodeAt(ee);te<128?P[le++]=te:te<2048?(P[le++]=te>>6|192,P[le++]=te&63|128):r(F,ee)?(te=65536+((te&1023)<<10)+(F.charCodeAt(++ee)&1023),P[le++]=te>>18|240,P[le++]=te>>12&63|128,P[le++]=te>>6&63|128,P[le++]=te&63|128):(P[le++]=te>>12|224,P[le++]=te>>6&63|128,P[le++]=te&63|128)}else for(ee=0;ee<F.length;ee++)P[ee]=F[ee]|0;return P}fr.toArray=n;function s(F){for(var X="",P=0;P<F.length;P++)X+=o(F[P].toString(16));return X}fr.toHex=s;function a(F){var X=F>>>24|F>>>8&65280|F<<8&16711680|(F&255)<<24;return X>>>0}fr.htonl=a;function i(F,X){for(var P="",le=0;le<F.length;le++){var ee=F[le];X==="little"&&(ee=a(ee)),P+=c(ee.toString(16))}return P}fr.toHex32=i;function o(F){return F.length===1?"0"+F:F}fr.zero2=o;function c(F){return F.length===7?"0"+F:F.length===6?"00"+F:F.length===5?"000"+F:F.length===4?"0000"+F:F.length===3?"00000"+F:F.length===2?"000000"+F:F.length===1?"0000000"+F:F}fr.zero8=c;function f(F,X,P,le){var ee=P-X;e(ee%4===0);for(var te=new Array(ee/4),me=0,ie=X;me<te.length;me++,ie+=4){var Ee;le==="big"?Ee=F[ie]<<24|F[ie+1]<<16|F[ie+2]<<8|F[ie+3]:Ee=F[ie+3]<<24|F[ie+2]<<16|F[ie+1]<<8|F[ie],te[me]=Ee>>>0}return te}fr.join32=f;function h(F,X){for(var P=new Array(F.length*4),le=0,ee=0;le<F.length;le++,ee+=4){var te=F[le];X==="big"?(P[ee]=te>>>24,P[ee+1]=te>>>16&255,P[ee+2]=te>>>8&255,P[ee+3]=te&255):(P[ee+3]=te>>>24,P[ee+2]=te>>>16&255,P[ee+1]=te>>>8&255,P[ee]=te&255)}return P}fr.split32=h;function p(F,X){return F>>>X|F<<32-X}fr.rotr32=p;function x(F,X){return F<<X|F>>>32-X}fr.rotl32=x;function g(F,X){return F+X>>>0}fr.sum32=g;function v(F,X,P){return F+X+P>>>0}fr.sum32_3=v;function y(F,X,P,le){return F+X+P+le>>>0}fr.sum32_4=y;function w(F,X,P,le,ee){return F+X+P+le+ee>>>0}fr.sum32_5=w;function _(F,X,P,le){var ee=F[X],te=F[X+1],me=le+te>>>0,ie=(me<le?1:0)+P+ee;F[X]=ie>>>0,F[X+1]=me}fr.sum64=_;function S(F,X,P,le){var ee=X+le>>>0,te=(ee<X?1:0)+F+P;return te>>>0}fr.sum64_hi=S;function E(F,X,P,le){var ee=X+le;return ee>>>0}fr.sum64_lo=E;function T(F,X,P,le,ee,te,me,ie){var Ee=0,K=X;K=K+le>>>0,Ee+=K<X?1:0,K=K+te>>>0,Ee+=K<te?1:0,K=K+ie>>>0,Ee+=K<ie?1:0;var M=F+P+ee+me+Ee;return M>>>0}fr.sum64_4_hi=T;function k(F,X,P,le,ee,te,me,ie){var Ee=X+le+te+ie;return Ee>>>0}fr.sum64_4_lo=k;function D(F,X,P,le,ee,te,me,ie,Ee,K){var M=0,q=X;q=q+le>>>0,M+=q<X?1:0,q=q+te>>>0,M+=q<te?1:0,q=q+ie>>>0,M+=q<ie?1:0,q=q+K>>>0,M+=q<K?1:0;var G=F+P+ee+me+Ee+M;return G>>>0}fr.sum64_5_hi=D;function O(F,X,P,le,ee,te,me,ie,Ee,K){var M=X+le+te+ie+K;return M>>>0}fr.sum64_5_lo=O;function z(F,X,P){var le=X<<32-P|F>>>P;return le>>>0}fr.rotr64_hi=z;function j(F,X,P){var le=F<<32-P|X>>>P;return le>>>0}fr.rotr64_lo=j;function J(F,X,P){return F>>>P}fr.shr64_hi=J;function ae(F,X,P){var le=F<<32-P|X>>>P;return le>>>0}return fr.shr64_lo=ae,fr}var $2={},QO;function yp(){if(QO)return $2;QO=1;var e=Vi(),t=gp();function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return $2.BlockHash=r,r.prototype.update=function(s,a){if(s=e.toArray(s,a),this.pending?this.pending=this.pending.concat(s):this.pending=s,this.pendingTotal+=s.length,this.pending.length>=this._delta8){s=this.pending;var i=s.length%this._delta8;this.pending=s.slice(s.length-i,s.length),this.pending.length===0&&(this.pending=null),s=e.join32(s,0,s.length-i,this.endian);for(var o=0;o<s.length;o+=this._delta32)this._update(s,o,o+this._delta32)}return this},r.prototype.digest=function(s){return this.update(this._pad()),t(this.pending===null),this._digest(s)},r.prototype._pad=function(){var s=this.pendingTotal,a=this._delta8,i=a-(s+this.padLength)%a,o=new Array(i+this.padLength);o[0]=128;for(var c=1;c<i;c++)o[c]=0;if(s<<=3,this.endian==="big"){for(var f=8;f<this.padLength;f++)o[c++]=0;o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=s>>>24&255,o[c++]=s>>>16&255,o[c++]=s>>>8&255,o[c++]=s&255}else for(o[c++]=s&255,o[c++]=s>>>8&255,o[c++]=s>>>16&255,o[c++]=s>>>24&255,o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=0,f=8;f<this.padLength;f++)o[c++]=0;return o},$2}var bc={},ki={},ej;function iB(){if(ej)return ki;ej=1;var e=Vi(),t=e.rotr32;function r(h,p,x,g){if(h===0)return n(p,x,g);if(h===1||h===3)return a(p,x,g);if(h===2)return s(p,x,g)}ki.ft_1=r;function n(h,p,x){return h&p^~h&x}ki.ch32=n;function s(h,p,x){return h&p^h&x^p&x}ki.maj32=s;function a(h,p,x){return h^p^x}ki.p32=a;function i(h){return t(h,2)^t(h,13)^t(h,22)}ki.s0_256=i;function o(h){return t(h,6)^t(h,11)^t(h,25)}ki.s1_256=o;function c(h){return t(h,7)^t(h,18)^h>>>3}ki.g0_256=c;function f(h){return t(h,17)^t(h,19)^h>>>10}return ki.g1_256=f,ki}var G2,tj;function E1e(){if(tj)return G2;tj=1;var e=Vi(),t=yp(),r=iB(),n=e.rotl32,s=e.sum32,a=e.sum32_5,i=r.ft_1,o=t.BlockHash,c=[1518500249,1859775393,2400959708,3395469782];function f(){if(!(this instanceof f))return new f;o.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return e.inherits(f,o),G2=f,f.blockSize=512,f.outSize=160,f.hmacStrength=80,f.padLength=64,f.prototype._update=function(p,x){for(var g=this.W,v=0;v<16;v++)g[v]=p[x+v];for(;v<g.length;v++)g[v]=n(g[v-3]^g[v-8]^g[v-14]^g[v-16],1);var y=this.h[0],w=this.h[1],_=this.h[2],S=this.h[3],E=this.h[4];for(v=0;v<g.length;v++){var T=~~(v/20),k=a(n(y,5),i(T,w,_,S),E,g[v],c[T]);E=S,S=_,_=n(w,30),w=y,y=k}this.h[0]=s(this.h[0],y),this.h[1]=s(this.h[1],w),this.h[2]=s(this.h[2],_),this.h[3]=s(this.h[3],S),this.h[4]=s(this.h[4],E)},f.prototype._digest=function(p){return p==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},G2}var K2,rj;function oB(){if(rj)return K2;rj=1;var e=Vi(),t=yp(),r=iB(),n=gp(),s=e.sum32,a=e.sum32_4,i=e.sum32_5,o=r.ch32,c=r.maj32,f=r.s0_256,h=r.s1_256,p=r.g0_256,x=r.g1_256,g=t.BlockHash,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y(){if(!(this instanceof y))return new y;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=v,this.W=new Array(64)}return e.inherits(y,g),K2=y,y.blockSize=512,y.outSize=256,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(_,S){for(var E=this.W,T=0;T<16;T++)E[T]=_[S+T];for(;T<E.length;T++)E[T]=a(x(E[T-2]),E[T-7],p(E[T-15]),E[T-16]);var k=this.h[0],D=this.h[1],O=this.h[2],z=this.h[3],j=this.h[4],J=this.h[5],ae=this.h[6],F=this.h[7];for(n(this.k.length===E.length),T=0;T<E.length;T++){var X=i(F,h(j),o(j,J,ae),this.k[T],E[T]),P=s(f(k),c(k,D,O));F=ae,ae=J,J=j,j=s(z,X),z=O,O=D,D=k,k=s(X,P)}this.h[0]=s(this.h[0],k),this.h[1]=s(this.h[1],D),this.h[2]=s(this.h[2],O),this.h[3]=s(this.h[3],z),this.h[4]=s(this.h[4],j),this.h[5]=s(this.h[5],J),this.h[6]=s(this.h[6],ae),this.h[7]=s(this.h[7],F)},y.prototype._digest=function(_){return _==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},K2}var X2,nj;function S1e(){if(nj)return X2;nj=1;var e=Vi(),t=oB();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return e.inherits(r,t),X2=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(s){return s==="hex"?e.toHex32(this.h.slice(0,7),"big"):e.split32(this.h.slice(0,7),"big")},X2}var Y2,sj;function lB(){if(sj)return Y2;sj=1;var e=Vi(),t=yp(),r=gp(),n=e.rotr64_hi,s=e.rotr64_lo,a=e.shr64_hi,i=e.shr64_lo,o=e.sum64,c=e.sum64_hi,f=e.sum64_lo,h=e.sum64_4_hi,p=e.sum64_4_lo,x=e.sum64_5_hi,g=e.sum64_5_lo,v=t.BlockHash,y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function w(){if(!(this instanceof w))return new w;v.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=y,this.W=new Array(160)}e.inherits(w,v),Y2=w,w.blockSize=1024,w.outSize=512,w.hmacStrength=192,w.padLength=128,w.prototype._prepareBlock=function(P,le){for(var ee=this.W,te=0;te<32;te++)ee[te]=P[le+te];for(;te<ee.length;te+=2){var me=ae(ee[te-4],ee[te-3]),ie=F(ee[te-4],ee[te-3]),Ee=ee[te-14],K=ee[te-13],M=j(ee[te-30],ee[te-29]),q=J(ee[te-30],ee[te-29]),G=ee[te-32],Z=ee[te-31];ee[te]=h(me,ie,Ee,K,M,q,G,Z),ee[te+1]=p(me,ie,Ee,K,M,q,G,Z)}},w.prototype._update=function(P,le){this._prepareBlock(P,le);var ee=this.W,te=this.h[0],me=this.h[1],ie=this.h[2],Ee=this.h[3],K=this.h[4],M=this.h[5],q=this.h[6],G=this.h[7],Z=this.h[8],re=this.h[9],L=this.h[10],I=this.h[11],se=this.h[12],Q=this.h[13],Y=this.h[14],U=this.h[15];r(this.k.length===ee.length);for(var we=0;we<ee.length;we+=2){var B=Y,be=U,V=O(Z,re),C=z(Z,re),A=_(Z,re,L,I,se),H=S(Z,re,L,I,se,Q),ue=this.k[we],ye=this.k[we+1],he=ee[we],ke=ee[we+1],De=x(B,be,V,C,A,H,ue,ye,he,ke),Fe=g(B,be,V,C,A,H,ue,ye,he,ke);B=k(te,me),be=D(te,me),V=E(te,me,ie,Ee,K),C=T(te,me,ie,Ee,K,M);var $e=c(B,be,V,C),rt=f(B,be,V,C);Y=se,U=Q,se=L,Q=I,L=Z,I=re,Z=c(q,G,De,Fe),re=f(G,G,De,Fe),q=K,G=M,K=ie,M=Ee,ie=te,Ee=me,te=c(De,Fe,$e,rt),me=f(De,Fe,$e,rt)}o(this.h,0,te,me),o(this.h,2,ie,Ee),o(this.h,4,K,M),o(this.h,6,q,G),o(this.h,8,Z,re),o(this.h,10,L,I),o(this.h,12,se,Q),o(this.h,14,Y,U)},w.prototype._digest=function(P){return P==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")};function _(X,P,le,ee,te){var me=X&le^~X&te;return me<0&&(me+=4294967296),me}function S(X,P,le,ee,te,me){var ie=P&ee^~P&me;return ie<0&&(ie+=4294967296),ie}function E(X,P,le,ee,te){var me=X&le^X&te^le&te;return me<0&&(me+=4294967296),me}function T(X,P,le,ee,te,me){var ie=P&ee^P&me^ee&me;return ie<0&&(ie+=4294967296),ie}function k(X,P){var le=n(X,P,28),ee=n(P,X,2),te=n(P,X,7),me=le^ee^te;return me<0&&(me+=4294967296),me}function D(X,P){var le=s(X,P,28),ee=s(P,X,2),te=s(P,X,7),me=le^ee^te;return me<0&&(me+=4294967296),me}function O(X,P){var le=n(X,P,14),ee=n(X,P,18),te=n(P,X,9),me=le^ee^te;return me<0&&(me+=4294967296),me}function z(X,P){var le=s(X,P,14),ee=s(X,P,18),te=s(P,X,9),me=le^ee^te;return me<0&&(me+=4294967296),me}function j(X,P){var le=n(X,P,1),ee=n(X,P,8),te=a(X,P,7),me=le^ee^te;return me<0&&(me+=4294967296),me}function J(X,P){var le=s(X,P,1),ee=s(X,P,8),te=i(X,P,7),me=le^ee^te;return me<0&&(me+=4294967296),me}function ae(X,P){var le=n(X,P,19),ee=n(P,X,29),te=a(X,P,6),me=le^ee^te;return me<0&&(me+=4294967296),me}function F(X,P){var le=s(X,P,19),ee=s(P,X,29),te=i(X,P,6),me=le^ee^te;return me<0&&(me+=4294967296),me}return Y2}var J2,aj;function N1e(){if(aj)return J2;aj=1;var e=Vi(),t=lB();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return e.inherits(r,t),J2=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(s){return s==="hex"?e.toHex32(this.h.slice(0,12),"big"):e.split32(this.h.slice(0,12),"big")},J2}var ij;function T1e(){return ij||(ij=1,bc.sha1=E1e(),bc.sha224=S1e(),bc.sha256=oB(),bc.sha384=N1e(),bc.sha512=lB()),bc}var Z2={},oj;function k1e(){if(oj)return Z2;oj=1;var e=Vi(),t=yp(),r=e.rotl32,n=e.sum32,s=e.sum32_3,a=e.sum32_4,i=t.BlockHash;function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}e.inherits(o,i),Z2.ripemd160=o,o.blockSize=512,o.outSize=160,o.hmacStrength=192,o.padLength=64,o.prototype._update=function(w,_){for(var S=this.h[0],E=this.h[1],T=this.h[2],k=this.h[3],D=this.h[4],O=S,z=E,j=T,J=k,ae=D,F=0;F<80;F++){var X=n(r(a(S,c(F,E,T,k),w[p[F]+_],f(F)),g[F]),D);S=D,D=k,k=r(T,10),T=E,E=X,X=n(r(a(O,c(79-F,z,j,J),w[x[F]+_],h(F)),v[F]),ae),O=ae,ae=J,J=r(j,10),j=z,z=X}X=s(this.h[1],T,J),this.h[1]=s(this.h[2],k,ae),this.h[2]=s(this.h[3],D,O),this.h[3]=s(this.h[4],S,z),this.h[4]=s(this.h[0],E,j),this.h[0]=X},o.prototype._digest=function(w){return w==="hex"?e.toHex32(this.h,"little"):e.split32(this.h,"little")};function c(y,w,_,S){return y<=15?w^_^S:y<=31?w&_|~w&S:y<=47?(w|~_)^S:y<=63?w&S|_&~S:w^(_|~S)}function f(y){return y<=15?0:y<=31?1518500249:y<=47?1859775393:y<=63?2400959708:2840853838}function h(y){return y<=15?1352829926:y<=31?1548603684:y<=47?1836072691:y<=63?2053994217:0}var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],x=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],v=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return Z2}var Q2,lj;function A1e(){if(lj)return Q2;lj=1;var e=Vi(),t=gp();function r(n,s,a){if(!(this instanceof r))return new r(n,s,a);this.Hash=n,this.blockSize=n.blockSize/8,this.outSize=n.outSize/8,this.inner=null,this.outer=null,this._init(e.toArray(s,a))}return Q2=r,r.prototype._init=function(s){s.length>this.blockSize&&(s=new this.Hash().update(s).digest()),t(s.length<=this.blockSize);for(var a=s.length;a<this.blockSize;a++)s.push(0);for(a=0;a<s.length;a++)s[a]^=54;for(this.inner=new this.Hash().update(s),a=0;a<s.length;a++)s[a]^=106;this.outer=new this.Hash().update(s)},r.prototype.update=function(s,a){return this.inner.update(s,a),this},r.prototype.digest=function(s){return this.outer.update(this.inner.digest()),this.outer.digest(s)},Q2}var cj;function C1e(){return cj||(cj=1,(function(e){var t=e;t.utils=Vi(),t.common=yp(),t.sha=T1e(),t.ripemd=k1e(),t.hmac=A1e(),t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(q2)),q2}var R1e=C1e();const O1e=CN(R1e);let j1e="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",D1e=(e,t=21)=>(r=t)=>{let n="",s=r|0;for(;s--;)n+=e[Math.random()*e.length|0];return n},I1e=(e=21)=>{let t="",r=e|0;for(;r--;)t+=j1e[Math.random()*64|0];return t};const Qa=e=>Math.floor(e*72*20),Q1=(e=0)=>{let t=e;return()=>++t},M1e=()=>Q1(),F1e=()=>Q1(1),P1e=()=>Q1(),L1e=()=>Q1(),B1e=()=>I1e().toLowerCase(),uj=e=>O1e.sha1().update(e instanceof ArrayBuffer?new Uint8Array(e):e).digest("hex"),_h=e=>D1e("1234567890abcdef",e)(),U1e=()=>`${_h(8)}-${_h(4)}-${_h(4)}-${_h(4)}-${_h(12)}`,z1e={PAGE:"page"},H1e={PAGE:"page"},V1e=()=>new ar({name:"wp:simplePos",attributes:{x:{key:"x",value:0},y:{key:"y",value:0}}}),cB=e=>new ar({name:"wp:align",children:[e]}),uB=e=>new ar({name:"wp:posOffset",children:[e.toString()]}),q1e=({relative:e,align:t,offset:r})=>new ar({name:"wp:positionH",attributes:{relativeFrom:{key:"relativeFrom",value:e??z1e.PAGE}},children:[(()=>{if(t)return cB(t);if(r!==void 0)return uB(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]}),W1e=({relative:e,align:t,offset:r})=>new ar({name:"wp:positionV",attributes:{relativeFrom:{key:"relativeFrom",value:e??H1e.PAGE}},children:[(()=>{if(t)return cB(t);if(r!==void 0)return uB(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]});class $1e extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{uri:"uri"})}}const G1e=e=>new ar({name:"asvg:svgBlip",attributes:{asvg:{key:"xmlns:asvg",value:"http://schemas.microsoft.com/office/drawing/2016/SVG/main"},embed:{key:"r:embed",value:`rId{${e.fileName}}`}}}),K1e=e=>new ar({name:"a:ext",attributes:{uri:{key:"uri",value:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"}},children:[G1e(e)]}),X1e=e=>new ar({name:"a:extLst",children:[K1e(e)]}),Y1e=e=>new ar({name:"a:blip",attributes:{embed:{key:"r:embed",value:`rId{${e.type==="svg"?e.fallback.fileName:e.fileName}}`},cstate:{key:"cstate",value:"none"}},children:e.type==="svg"?[X1e(e)]:[]});class J1e extends Be{constructor(){super("a:srcRect")}}class Z1e extends Be{constructor(){super("a:fillRect")}}class Q1e extends Be{constructor(){super("a:stretch"),this.root.push(new Z1e)}}class eye extends Be{constructor(t){super("pic:blipFill"),this.root.push(Y1e(t)),this.root.push(new J1e),this.root.push(new Q1e)}}class tye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"})}}class rye extends Be{constructor(){super("a:picLocks"),this.root.push(new tye({noChangeAspect:1,noChangeArrowheads:1}))}}class nye extends Be{constructor(){super("pic:cNvPicPr"),this.root.push(new rye)}}const fB=(e,t)=>new ar({name:"a:hlinkClick",attributes:Mo(Dt({},t?{xmlns:{key:"xmlns:a",value:"http://schemas.openxmlformats.org/drawingml/2006/main"}}:{}),{id:{key:"r:id",value:`rId${e}`}})});class sye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"id",name:"name",descr:"descr"})}}class aye extends Be{constructor(){super("pic:cNvPr"),this.root.push(new sye({id:0,name:"",descr:""}))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const n=t.stack[r];if(n instanceof HN){this.root.push(fB(n.linkId,!1));break}}return super.prepForXml(t)}}class iye extends Be{constructor(){super("pic:nvPicPr"),this.root.push(new aye),this.root.push(new nye)}}class oye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns:pic"})}}class lye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{cx:"cx",cy:"cy"})}}class cye extends Be{constructor(t,r){super("a:ext"),Pe(this,"attributes"),this.attributes=new lye({cx:t,cy:r}),this.root.push(this.attributes)}}class uye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{x:"x",y:"y"})}}class fye extends Be{constructor(){super("a:off"),this.root.push(new uye({x:0,y:0}))}}class dye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"})}}class hye extends Be{constructor(t){var r,n;super("a:xfrm"),Pe(this,"extents"),this.root.push(new dye({flipVertical:(r=t.flip)==null?void 0:r.vertical,flipHorizontal:(n=t.flip)==null?void 0:n.horizontal,rotation:t.rotation})),this.extents=new cye(t.emus.x,t.emus.y),this.root.push(new fye),this.root.push(this.extents)}}const dB=()=>new ar({name:"a:noFill"}),pye=e=>new ar({name:"a:srgbClr",attributes:{value:{key:"val",value:e.value}}}),mye=e=>new ar({name:"a:schemeClr",attributes:{value:{key:"val",value:e.value}}}),fj=e=>new ar({name:"a:solidFill",children:[e.type==="rgb"?pye(e):mye(e)]}),xye=e=>new ar({name:"a:ln",attributes:{width:{key:"w",value:e.width},cap:{key:"cap",value:e.cap},compoundLine:{key:"cmpd",value:e.compoundLine},align:{key:"algn",value:e.align}},children:[e.type==="noFill"?dB():e.solidFillType==="rgb"?fj({type:"rgb",value:e.value}):fj({type:"scheme",value:e.value})]});class gye extends Be{constructor(){super("a:avLst")}}class yye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{prst:"prst"})}}class vye extends Be{constructor(){super("a:prstGeom"),this.root.push(new yye({prst:"rect"})),this.root.push(new gye)}}class bye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{bwMode:"bwMode"})}}class wye extends Be{constructor({outline:t,transform:r}){super("pic:spPr"),Pe(this,"form"),this.root.push(new bye({bwMode:"auto"})),this.form=new hye(r),this.root.push(this.form),this.root.push(new vye),t&&(this.root.push(dB()),this.root.push(xye(t)))}}class _ye extends Be{constructor({mediaData:t,transform:r,outline:n}){super("pic:pic"),this.root.push(new oye({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new iye),this.root.push(new eye(t)),this.root.push(new wye({transform:r,outline:n}))}}class Eye extends Be{constructor({mediaData:t,transform:r,outline:n}){super("a:graphicData"),Pe(this,"pic"),this.root.push(new $1e({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new _ye({mediaData:t,transform:r,outline:n}),this.root.push(this.pic)}}class Sye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{a:"xmlns:a"})}}class hB extends Be{constructor({mediaData:t,transform:r,outline:n}){super("a:graphic"),Pe(this,"data"),this.root.push(new Sye({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new Eye({mediaData:t,transform:r,outline:n}),this.root.push(this.data)}}const yx={NONE:0,SQUARE:1,TIGHT:2,TOP_AND_BOTTOM:3},Nye={BOTH_SIDES:"bothSides"};class dj extends Be{constructor(){super("wp:wrapNone")}}class Tye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"})}}class kye extends Be{constructor(t,r={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new Tye({wrapText:t.side||Nye.BOTH_SIDES,distT:r.top,distB:r.bottom,distL:r.left,distR:r.right}))}}class Aye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class Cye extends Be{constructor(t={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new Aye({distT:t.top,distB:t.bottom}))}}class Rye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class Oye extends Be{constructor(t={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new Rye({distT:t.top,distB:t.bottom}))}}class pB extends Be{constructor({name:t,description:r,title:n}={name:"",description:"",title:""}){super("wp:docPr"),Pe(this,"docPropertiesUniqueNumericId",P1e());const s={id:{key:"id",value:this.docPropertiesUniqueNumericId()},name:{key:"name",value:t}};r!=null&&(s.description={key:"descr",value:r}),n!=null&&(s.title={key:"title",value:n}),this.root.push(new dp(s))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const n=t.stack[r];if(n instanceof HN){this.root.push(fB(n.linkId,!0));break}}return super.prepForXml(t)}}const mB=({top:e,right:t,bottom:r,left:n})=>new ar({name:"wp:effectExtent",attributes:{top:{key:"t",value:e},right:{key:"r",value:t},bottom:{key:"b",value:r},left:{key:"l",value:n}}}),xB=({x:e,y:t})=>new ar({name:"wp:extent",attributes:{x:{key:"cx",value:e},y:{key:"cy",value:t}}});class jye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"})}}class Dye extends Be{constructor(){super("a:graphicFrameLocks"),this.root.push(new jye({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}}const gB=()=>new ar({name:"wp:cNvGraphicFramePr",children:[new Dye]});class Iye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"})}}class Mye extends Be{constructor({mediaData:t,transform:r,drawingOptions:n}){super("wp:anchor");const s=Dt({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},n.floating);if(this.root.push(new Iye({distT:s.margins&&s.margins.top||0,distB:s.margins&&s.margins.bottom||0,distL:s.margins&&s.margins.left||0,distR:s.margins&&s.margins.right||0,simplePos:"0",allowOverlap:s.allowOverlap===!0?"1":"0",behindDoc:s.behindDocument===!0?"1":"0",locked:s.lockAnchor===!0?"1":"0",layoutInCell:s.layoutInCell===!0?"1":"0",relativeHeight:s.zIndex?s.zIndex:r.emus.y})),this.root.push(V1e()),this.root.push(q1e(s.horizontalPosition)),this.root.push(W1e(s.verticalPosition)),this.root.push(xB({x:r.emus.x,y:r.emus.y})),this.root.push(mB({top:0,right:0,bottom:0,left:0})),n.floating!==void 0&&n.floating.wrap!==void 0)switch(n.floating.wrap.type){case yx.SQUARE:this.root.push(new kye(n.floating.wrap,n.floating.margins));break;case yx.TIGHT:this.root.push(new Cye(n.floating.margins));break;case yx.TOP_AND_BOTTOM:this.root.push(new Oye(n.floating.margins));break;case yx.NONE:default:this.root.push(new dj)}else this.root.push(new dj);this.root.push(new pB(n.docProperties)),this.root.push(gB()),this.root.push(new hB({mediaData:t,transform:r,outline:n.outline}))}}const Fye=({mediaData:e,transform:t,docProperties:r,outline:n})=>{var s,a,i,o;return new ar({name:"wp:inline",attributes:{distanceTop:{key:"distT",value:0},distanceBottom:{key:"distB",value:0},distanceLeft:{key:"distL",value:0},distanceRight:{key:"distR",value:0}},children:[xB({x:t.emus.x,y:t.emus.y}),mB(n?{top:((s=n.width)!=null?s:9525)*2,right:((a=n.width)!=null?a:9525)*2,bottom:((i=n.width)!=null?i:9525)*2,left:((o=n.width)!=null?o:9525)*2}:{top:0,right:0,bottom:0,left:0}),new pB(r),gB(),new hB({mediaData:e,transform:t,outline:n})]})};class Pye extends Be{constructor(t,r={}){super("w:drawing"),r.floating?this.root.push(new Mye({mediaData:t,transform:t.transformation,drawingOptions:r})):this.root.push(Fye({mediaData:t,transform:t.transformation,docProperties:r.docProperties,outline:r.outline}))}}const Lye=e=>{if(typeof atob=="function"){const t=";base64,",r=e.indexOf(t),n=r===-1?0:r+t.length;return new Uint8Array(atob(e.substring(n)).split("").map(s=>s.charCodeAt(0)))}else{const t=require("buffer");return new t.Buffer(e,"base64")}},Bye=e=>typeof e=="string"?Lye(e):e,e_=(e,t)=>({data:Bye(e.data),fileName:t,transformation:{pixels:{x:Math.round(e.transformation.width),y:Math.round(e.transformation.height)},emus:{x:Math.round(e.transformation.width*9525),y:Math.round(e.transformation.height*9525)},flip:e.transformation.flip,rotation:e.transformation.rotation?e.transformation.rotation*6e4:void 0}});class Uye extends xp{constructor(t){super({}),Pe(this,"imageData");const n=`${uj(t.data)}.${t.type}`;this.imageData=t.type==="svg"?Mo(Dt({type:t.type},e_(t,n)),{fallback:Dt({type:t.fallback.type},e_(Mo(Dt({},t.fallback),{transformation:t.transformation}),`${uj(t.fallback.data)}.${t.fallback.type}`))}):Dt({type:t.type},e_(t,n));const s=new Pye(this.imageData,{floating:t.floating,docProperties:t.altText,outline:t.outline});this.root.push(s)}prepForXml(t){return t.file.Media.addImage(this.imageData.fileName,this.imageData),this.imageData.type==="svg"&&t.file.Media.addImage(this.imageData.fallback.fileName,this.imageData.fallback),super.prepForXml(t)}}class zye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns"})}}class Hye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const Vye={EXTERNAL:"External"};class qye extends Be{constructor(t,r,n,s){super("Relationship"),this.root.push(new Hye({id:t,type:r,target:n,targetMode:s}))}}class bu extends Be{constructor(){super("Relationships"),this.root.push(new zye({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(t,r,n,s){const a=new qye(`rId${t}`,r,n,s);return this.root.push(a),a}get RelationshipCount(){return this.root.length-1}}class Wye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class $ye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class Gye extends Be{constructor({id:t,initials:r,author:n,date:s=new Date,children:a}){super("w:comment"),this.root.push(new Wye({id:t,initials:r,author:n,date:s.toISOString()}));for(const i of a)this.root.push(i)}}class Kye extends Be{constructor({children:t}){super("w:comments"),Pe(this,"relationships"),this.root.push(new $ye({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const r of t)this.root.push(new Gye(r));this.relationships=new bu}get Relationships(){return this.relationships}}class Xye extends Be{constructor(){super("w:pageBreakBefore")}}const wE={AUTO:"auto"};class Yye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule",beforeAutoSpacing:"w:beforeAutospacing",afterAutoSpacing:"w:afterAutospacing"})}}class Jye extends Be{constructor(t){super("w:spacing"),this.root.push(new Yye(t))}}let vx=class extends Be{constructor(t){super("w:pStyle"),this.root.push(new tn({val:t}))}};class Zye extends Be{constructor(t){super("w:tabs");for(const r of t)this.root.push(new eve(r))}}const hj={LEFT:"left",RIGHT:"right"};class Qye extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class eve extends Be{constructor({type:t,position:r,leader:n}){super("w:tab"),this.root.push(new Qye({val:t,pos:r,leader:n}))}}class t_ extends Be{constructor(t,r){super("w:numPr"),this.root.push(new tve(r)),this.root.push(new rve(t))}}class tve extends Be{constructor(t){if(super("w:ilvl"),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new tn({val:t}))}}class rve extends Be{constructor(t){super("w:numId"),this.root.push(new tn({val:typeof t=="string"?`{${t}}`:t}))}}class nve extends Be{constructor(){super(...arguments),Pe(this,"fileChild",Symbol())}}class sve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class HN extends Be{constructor(t,r,n){super("w:hyperlink"),Pe(this,"linkId"),this.linkId=r;const s={history:1,anchor:n||void 0,id:n?void 0:`rId${this.linkId}`},a=new sve(s);this.root.push(a),t.forEach(i=>{this.root.push(i)})}}class ave extends Be{constructor(t){super("w:externalHyperlink"),this.options=t}}class ive extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class ove extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{id:"w:id"})}}class lve{constructor(t){Pe(this,"bookmarkUniqueNumericId",L1e()),Pe(this,"start"),Pe(this,"children"),Pe(this,"end");const r=this.bookmarkUniqueNumericId();this.start=new cve(t.id,r),this.children=t.children,this.end=new uve(r)}}class cve extends Be{constructor(t,r){super("w:bookmarkStart");const n=new ive({name:t,id:r});this.root.push(n)}}class uve extends Be{constructor(t){super("w:bookmarkEnd");const r=new ove({id:t});this.root.push(r)}}class fve extends Be{constructor(t){super("w:outlineLvl"),this.level=t,this.root.push(new tn({val:t}))}}const dve={TOP:"top",CENTER:"center",BOTTOM:"bottom"};Mo(Dt({},dve),{BOTH:"both"});class hve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{verticalAlign:"w:val"})}}class pve extends Be{constructor(t){super("w:vAlign"),this.root.push(new hve({verticalAlign:t}))}}class mve extends Be{constructor({space:t,count:r,separate:n,equalWidth:s,children:a}){super("w:cols"),this.root.push(new dp({space:{key:"w:space",value:t===void 0?void 0:ti(t)},count:{key:"w:num",value:r===void 0?void 0:Vs(r)},separate:{key:"w:sep",value:n},equalWidth:{key:"w:equalWidth",value:s}})),!s&&a&&a.forEach(i=>this.addChildElement(i))}}const xve=({type:e,linePitch:t,charSpace:r})=>new ar({name:"w:docGrid",attributes:{type:{key:"w:type",value:e},linePitch:{key:"w:linePitch",value:Vs(t)},charSpace:{key:"w:charSpace",value:r?Vs(r):void 0}}}),Sf={DEFAULT:"default",FIRST:"first",EVEN:"even"};class gve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const pj={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class r_ extends Be{constructor(t,r){super(t),this.root.push(new gve({type:r.type||Sf.DEFAULT,id:`rId${r.id}`}))}}const yve=({countBy:e,start:t,restart:r,distance:n})=>new ar({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:e===void 0?void 0:Vs(e)},start:{key:"w:start",value:t===void 0?void 0:Vs(t)},restart:{key:"w:restart",value:r},distance:{key:"w:distance",value:n===void 0?void 0:ti(n)}}});class mj extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class vve extends X1{constructor(t){if(super("w:pgBorders"),!t)return this;t.pageBorders?this.root.push(new mj({display:t.pageBorders.display,offsetFrom:t.pageBorders.offsetFrom,zOrder:t.pageBorders.zOrder})):this.root.push(new mj({})),t.pageBorderTop&&this.root.push(new zr("w:top",t.pageBorderTop)),t.pageBorderLeft&&this.root.push(new zr("w:left",t.pageBorderLeft)),t.pageBorderBottom&&this.root.push(new zr("w:bottom",t.pageBorderBottom)),t.pageBorderRight&&this.root.push(new zr("w:right",t.pageBorderRight))}}class bve extends Be{constructor(t,r,n,s,a,i,o){super("w:pgMar"),this.root.push(new dp({top:{key:"w:top",value:jc(t)},right:{key:"w:right",value:ti(r)},bottom:{key:"w:bottom",value:jc(n)},left:{key:"w:left",value:ti(s)},header:{key:"w:header",value:ti(a)},footer:{key:"w:footer",value:ti(i)},gutter:{key:"w:gutter",value:ti(o)}}))}}class wve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class _ve extends Be{constructor({start:t,formatType:r,separator:n}){super("w:pgNumType"),this.root.push(new wve({start:t===void 0?void 0:Vs(t),formatType:r,separator:n}))}}const _E={PORTRAIT:"portrait",LANDSCAPE:"landscape"},Eve=({width:e,height:t,orientation:r,code:n})=>{const s=ti(e),a=ti(t);return new ar({name:"w:pgSz",attributes:{width:{key:"w:w",value:r===_E.LANDSCAPE?a:s},height:{key:"w:h",value:r===_E.LANDSCAPE?s:a},orientation:{key:"w:orient",value:r},code:{key:"w:code",value:n}}})};class Sve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class Nve extends Be{constructor(t){super("w:textDirection"),this.root.push(new Sve({val:t}))}}class Tve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class kve extends Be{constructor(t){super("w:type"),this.root.push(new Tve({val:t}))}}const wc={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},n_={WIDTH:11906,HEIGHT:16838,ORIENTATION:_E.PORTRAIT};class Ave extends Be{constructor({page:{size:{width:t=n_.WIDTH,height:r=n_.HEIGHT,orientation:n=n_.ORIENTATION}={},margin:{top:s=wc.TOP,right:a=wc.RIGHT,bottom:i=wc.BOTTOM,left:o=wc.LEFT,header:c=wc.HEADER,footer:f=wc.FOOTER,gutter:h=wc.GUTTER}={},pageNumbers:p={},borders:x,textDirection:g}={},grid:{linePitch:v=360,charSpace:y,type:w}={},headerWrapperGroup:_={},footerWrapperGroup:S={},lineNumbers:E,titlePage:T,verticalAlign:k,column:D,type:O}={}){super("w:sectPr"),this.addHeaderFooterGroup(pj.HEADER,_),this.addHeaderFooterGroup(pj.FOOTER,S),O&&this.root.push(new kve(O)),this.root.push(Eve({width:t,height:r,orientation:n})),this.root.push(new bve(s,a,i,o,c,f,h)),x&&this.root.push(new vve(x)),E&&this.root.push(yve(E)),this.root.push(new _ve(p)),D&&this.root.push(new mve(D)),k&&this.root.push(new pve(k)),T!==void 0&&this.root.push(new Ge("w:titlePg",T)),g&&this.root.push(new Nve(g)),this.root.push(xve({linePitch:v,charSpace:y,type:w}))}addHeaderFooterGroup(t,r){r.default&&this.root.push(new r_(t,{type:Sf.DEFAULT,id:r.default.View.ReferenceId})),r.first&&this.root.push(new r_(t,{type:Sf.FIRST,id:r.first.View.ReferenceId})),r.even&&this.root.push(new r_(t,{type:Sf.EVEN,id:r.even.View.ReferenceId}))}}class Cve extends Be{constructor(){super("w:body"),Pe(this,"sections",[])}addSection(t){const r=this.sections.pop();this.root.push(this.createSectionParagraph(r)),this.sections.push(new Ave(t))}prepForXml(t){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(t)}push(t){this.root.push(t)}createSectionParagraph(t){const r=new Dc({}),n=new Xf({});return n.push(t),r.addChildElement(n),r}}const xj={wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"};class ey extends ut{constructor(t,r){super(Dt({Ignorable:r},Object.fromEntries(t.map(n=>[n,xj[n]])))),Pe(this,"xmlKeys",Dt({Ignorable:"mc:Ignorable"},Object.fromEntries(Object.keys(xj).map(n=>[n,`xmlns:${n}`]))))}}class Rve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class Ove extends Be{constructor(t){super("w:background"),this.root.push(new Rve({color:t.color===void 0?void 0:$f(t.color),themeColor:t.themeColor,themeShade:t.themeShade===void 0?void 0:KO(t.themeShade),themeTint:t.themeTint===void 0?void 0:KO(t.themeTint)}))}}class jve extends Be{constructor(t){super("w:document"),Pe(this,"body"),this.root.push(new ey(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps","cx","cx1","cx2","cx3","cx4","cx5","cx6","cx7","cx8","aink","am3d","w16cex","w16cid","w16","w16sdtdh","w16se"],"w14 w15 wp14")),this.body=new Cve,t.background&&this.root.push(new Ove(t.background)),this.root.push(this.body)}add(t){return this.body.push(t),this}get Body(){return this.body}}class yB{constructor(t){Pe(this,"document"),Pe(this,"relationships"),this.document=new jve(t),this.relationships=new bu}get View(){return this.document}get Relationships(){return this.relationships}}class Dve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class Ive extends Be{constructor(){super("w:wordWrap"),this.root.push(new Dve({val:0}))}}const Mve=e=>{var t,r;return new ar({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:e.anchorLock},dropCap:{key:"w:dropCap",value:e.dropCap},width:{key:"w:w",value:e.width},height:{key:"w:h",value:e.height},x:{key:"w:x",value:e.position?e.position.x:void 0},y:{key:"w:y",value:e.position?e.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:e.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:e.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(t=e.space)==null?void 0:t.horizontal},spaceVertical:{key:"w:vSpace",value:(r=e.space)==null?void 0:r.vertical},rule:{key:"w:hRule",value:e.rule},alignmentX:{key:"w:xAlign",value:e.alignment?e.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:e.alignment?e.alignment.y:void 0},lines:{key:"w:lines",value:e.lines},wrap:{key:"w:wrap",value:e.wrap}}})};class Xf extends X1{constructor(t){var r,n;if(super("w:pPr"),Pe(this,"numberingReferences",[]),!t)return this;t.heading&&this.push(new vx(t.heading)),t.bullet&&this.push(new vx("ListParagraph")),t.numbering&&!t.style&&!t.heading&&(t.numbering.custom||this.push(new vx("ListParagraph"))),t.style&&this.push(new vx(t.style)),t.keepNext!==void 0&&this.push(new Ge("w:keepNext",t.keepNext)),t.keepLines!==void 0&&this.push(new Ge("w:keepLines",t.keepLines)),t.pageBreakBefore&&this.push(new Xye),t.frame&&this.push(Mve(t.frame)),t.widowControl!==void 0&&this.push(new Ge("w:widowControl",t.widowControl)),t.bullet&&this.push(new t_(1,t.bullet.level)),t.numbering?(this.numberingReferences.push({reference:t.numbering.reference,instance:(r=t.numbering.instance)!=null?r:0}),this.push(new t_(`${t.numbering.reference}-${(n=t.numbering.instance)!=null?n:0}`,t.numbering.level))):t.numbering===!1&&this.push(new t_(0,0)),t.border&&this.push(new t1e(t.border)),t.thematicBreak&&this.push(new r1e),t.shading&&this.push(new nB(t.shading)),t.wordWrap&&this.push(new Ive),t.overflowPunctuation&&this.push(new Ge("w:overflowPunct",t.overflowPunctuation));const s=[...t.rightTabStop!==void 0?[{type:hj.RIGHT,position:t.rightTabStop}]:[],...t.tabStops?t.tabStops:[],...t.leftTabStop!==void 0?[{type:hj.LEFT,position:t.leftTabStop}]:[]];s.length>0&&this.push(new Zye(s)),t.bidirectional!==void 0&&this.push(new Ge("w:bidi",t.bidirectional)),t.spacing&&this.push(new Jye(t.spacing)),t.indent&&this.push(new n1e(t.indent)),t.contextualSpacing!==void 0&&this.push(new Ge("w:contextualSpacing",t.contextualSpacing)),t.alignment&&this.push(new Qge(t.alignment)),t.outlineLevel!==void 0&&this.push(new fve(t.outlineLevel)),t.suppressLineNumbers!==void 0&&this.push(new Ge("w:suppressLineNumbers",t.suppressLineNumbers)),t.autoSpaceEastAsianText!==void 0&&this.push(new Ge("w:autoSpaceDN",t.autoSpaceEastAsianText)),t.run&&this.push(new vu(t.run))}push(t){this.root.push(t)}prepForXml(t){if(t.viewWrapper instanceof yB)for(const r of this.numberingReferences)t.file.Numbering.createConcreteNumberingInstance(r.reference,r.instance);return super.prepForXml(t)}}class Dc extends nve{constructor(t){if(super("w:p"),Pe(this,"properties"),typeof t=="string")return this.properties=new Xf({}),this.root.push(this.properties),this.root.push(new Sc(t)),this;if(this.properties=new Xf(t),this.root.push(this.properties),t.text&&this.root.push(new Sc(t.text)),t.children)for(const r of t.children){if(r instanceof lve){this.root.push(r.start);for(const n of r.children)this.root.push(n);this.root.push(r.end);continue}this.root.push(r)}}prepForXml(t){for(const r of this.root)if(r instanceof ave){const n=this.root.indexOf(r),s=new HN(r.options.children,B1e());t.viewWrapper.Relationships.createRelationship(s.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",r.options.link,Vye.EXTERNAL),this.root[n]=s}return super.prepForXml(t)}addRunToFront(t){return this.root.splice(1,0,t),this}}const af={style:BN.NONE,size:0,color:"auto"},of={style:BN.SINGLE,size:4,color:"auto"};class Fve extends Be{constructor(t){super("w:tblBorders"),t.top?this.root.push(new zr("w:top",t.top)):this.root.push(new zr("w:top",of)),t.left?this.root.push(new zr("w:left",t.left)):this.root.push(new zr("w:left",of)),t.bottom?this.root.push(new zr("w:bottom",t.bottom)):this.root.push(new zr("w:bottom",of)),t.right?this.root.push(new zr("w:right",t.right)):this.root.push(new zr("w:right",of)),t.insideHorizontal?this.root.push(new zr("w:insideH",t.insideHorizontal)):this.root.push(new zr("w:insideH",of)),t.insideVertical?this.root.push(new zr("w:insideV",t.insideVertical)):this.root.push(new zr("w:insideV",of))}}Pe(Fve,"NONE",{top:af,bottom:af,left:af,right:af,insideHorizontal:af,insideVertical:af});class Pve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class Lve extends Be{constructor(){super("Properties"),this.root.push(new Pve({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class Bve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns"})}}class Uve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class ho extends Be{constructor(t,r){super("Default"),this.root.push(new Uve({contentType:t,extension:r}))}}class zve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class Ta extends Be{constructor(t,r){super("Override"),this.root.push(new zve({contentType:t,partName:r}))}}class Hve extends Be{constructor(){super("Types"),this.root.push(new Bve({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new ho("image/png","png")),this.root.push(new ho("image/jpeg","jpeg")),this.root.push(new ho("image/jpeg","jpg")),this.root.push(new ho("image/bmp","bmp")),this.root.push(new ho("image/gif","gif")),this.root.push(new ho("image/svg+xml","svg")),this.root.push(new ho("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new ho("application/xml","xml")),this.root.push(new ho("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new Ta("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(t){this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${t}.xml`))}addHeader(t){this.root.push(new Ta("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${t}.xml`))}}class Vve extends Be{constructor(t){super("cp:coreProperties"),this.root.push(new ey(["cp","dc","dcterms","dcmitype","xsi"])),t.title&&this.root.push(new vc("dc:title",t.title)),t.subject&&this.root.push(new vc("dc:subject",t.subject)),t.creator&&this.root.push(new vc("dc:creator",t.creator)),t.keywords&&this.root.push(new vc("cp:keywords",t.keywords)),t.description&&this.root.push(new vc("dc:description",t.description)),t.lastModifiedBy&&this.root.push(new vc("cp:lastModifiedBy",t.lastModifiedBy)),t.revision&&this.root.push(new vc("cp:revision",String(t.revision))),this.root.push(new gj("dcterms:created")),this.root.push(new gj("dcterms:modified"))}}class qve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"xsi:type"})}}class gj extends Be{constructor(t){super(t),this.root.push(new qve({type:"dcterms:W3CDTF"})),this.root.push(Jge(new Date))}}class Wve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class $ve extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class Gve extends Be{constructor(t,r){super("property"),this.root.push(new $ve({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t.toString(),name:r.name})),this.root.push(new Kve(r.value))}}class Kve extends Be{constructor(t){super("vt:lpwstr"),this.root.push(t)}}class Xve extends Be{constructor(t){super("Properties"),Pe(this,"nextId"),Pe(this,"properties",[]),this.root.push(new Wve({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const r of t)this.addCustomProperty(r)}prepForXml(t){return this.properties.forEach(r=>this.root.push(r)),super.prepForXml(t)}addCustomProperty(t){this.properties.push(new Gve(this.nextId++,t))}}const bx=({id:e,fontKey:t,subsetted:r},n)=>new ar({name:n,attributes:Dt({id:{key:"r:id",value:e}},t?{fontKey:{key:"w:fontKey",value:`{${t}}`}}:{}),children:[...r?[new Ge("w:subsetted",r)]:[]]}),Yve=({name:e,altName:t,panose1:r,charset:n,family:s,notTrueType:a,pitch:i,sig:o,embedRegular:c,embedBold:f,embedItalic:h,embedBoldItalic:p})=>new ar({name:"w:font",attributes:{name:{key:"w:name",value:e}},children:[...t?[wh("w:altName",t)]:[],...r?[wh("w:panose1",r)]:[],...n?[wh("w:charset",n)]:[],wh("w:family",s),...a?[new Ge("w:notTrueType",a)]:[],wh("w:pitch",i),...o?[new ar({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:o.usb0},usb1:{key:"w:usb1",value:o.usb1},usb2:{key:"w:usb2",value:o.usb2},usb3:{key:"w:usb3",value:o.usb3},csb0:{key:"w:csb0",value:o.csb0},csb1:{key:"w:csb1",value:o.csb1}}})]:[],...c?[bx(c,"w:embedRegular")]:[],...f?[bx(f,"w:embedBold")]:[],...h?[bx(h,"w:embedItalic")]:[],...p?[bx(p,"w:embedBoldItalic")]:[]]}),Jve=({name:e,index:t,fontKey:r,characterSet:n})=>Yve({name:e,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:n,family:"auto",pitch:"variable",embedRegular:{fontKey:r,id:`rId${t}`}}),Zve=e=>new ar({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:e.map((t,r)=>Jve({name:t.name,index:r+1,fontKey:t.fontKey}))});class Qve{constructor(t){Pe(this,"fontTable"),Pe(this,"relationships"),Pe(this,"fontOptionsWithKey",[]),this.options=t,this.fontOptionsWithKey=t.map(r=>Mo(Dt({},r),{fontKey:U1e()})),this.fontTable=Zve(this.fontOptionsWithKey),this.relationships=new bu;for(let r=0;r<t.length;r++)this.relationships.createRelationship(r+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${t[r].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class ebe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let tbe=class extends QL{constructor(t,r){super("w:ftr",r),Pe(this,"refId"),this.refId=t,r||this.root.push(new ebe({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class rbe{constructor(t,r,n){Pe(this,"footer"),Pe(this,"relationships"),this.media=t,this.footer=new tbe(r,n),this.relationships=new bu}add(t){this.footer.add(t)}addChildElement(t){this.footer.addChildElement(t)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class nbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class sbe extends Be{constructor(){super("w:footnoteRef")}}class abe extends xp{constructor(){super({style:"FootnoteReference"}),this.root.push(new sbe)}}const yj={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class s_ extends Be{constructor(t){super("w:footnote"),this.root.push(new nbe({type:t.type,id:t.id}));for(let r=0;r<t.children.length;r++){const n=t.children[r];r===0&&n.addRunToFront(new abe),this.root.push(n)}}}class ibe extends Be{constructor(){super("w:continuationSeparator")}}class obe extends xp{constructor(){super({}),this.root.push(new ibe)}}class lbe extends Be{constructor(){super("w:separator")}}class cbe extends xp{constructor(){super({}),this.root.push(new lbe)}}class ube extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class fbe extends Be{constructor(){super("w:footnotes"),this.root.push(new ube({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new s_({id:-1,type:yj.SEPERATOR,children:[new Dc({spacing:{after:0,line:240,lineRule:wE.AUTO},children:[new cbe]})]});this.root.push(t);const r=new s_({id:0,type:yj.CONTINUATION_SEPERATOR,children:[new Dc({spacing:{after:0,line:240,lineRule:wE.AUTO},children:[new obe]})]});this.root.push(r)}createFootNote(t,r){const n=new s_({id:t,children:r});this.root.push(n)}}class dbe{constructor(){Pe(this,"footnotess"),Pe(this,"relationships"),this.footnotess=new fbe,this.relationships=new bu}get View(){return this.footnotess}get Relationships(){return this.relationships}}class hbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let pbe=class extends QL{constructor(t,r){super("w:hdr",r),Pe(this,"refId"),this.refId=t,r||this.root.push(new hbe({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class mbe{constructor(t,r,n){Pe(this,"header"),Pe(this,"relationships"),this.media=t,this.header=new pbe(r,n),this.relationships=new bu}add(t){return this.header.add(t),this}addChildElement(t){this.header.addChildElement(t)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class xbe{constructor(){Pe(this,"map"),this.map=new Map}addImage(t,r){this.map.set(t,r)}get Array(){return Array.from(this.map.values())}}const po={BULLET:"bullet"};class gbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class ybe extends Be{constructor(t){super("w:numFmt"),this.root.push(new tn({val:t}))}}class vbe extends Be{constructor(t){super("w:lvlText"),this.root.push(new tn({val:t}))}}class bbe extends Be{constructor(t){super("w:lvlJc"),this.root.push(new tn({val:t}))}}class wbe extends Be{constructor(t){super("w:suff"),this.root.push(new tn({val:t}))}}class _be extends Be{constructor(){super("w:isLgl")}}class Ebe extends Be{constructor({level:t,format:r,text:n,alignment:s=ja.START,start:a=1,style:i,suffix:o,isLegalNumberingStyle:c}){if(super("w:lvl"),Pe(this,"paragraphProperties"),Pe(this,"runProperties"),this.root.push(new a0("w:start",Vs(a))),r&&this.root.push(new ybe(r)),o&&this.root.push(new wbe(o)),c&&this.root.push(new _be),n&&this.root.push(new vbe(n)),this.root.push(new bbe(s)),this.paragraphProperties=new Xf(i&&i.paragraph),this.runProperties=new vu(i&&i.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new gbe({ilvl:Vs(t),tentative:1}))}}class Sbe extends Ebe{}class Nbe extends Be{constructor(t){super("w:multiLevelType"),this.root.push(new tn({val:t}))}}class Tbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class vj extends Be{constructor(t,r){super("w:abstractNum"),Pe(this,"id"),this.root.push(new Tbe({abstractNumId:Vs(t),restartNumberingAfterBreak:0})),this.root.push(new Nbe("hybridMultilevel")),this.id=t;for(const n of r)this.root.push(new Sbe(n))}}class kbe extends Be{constructor(t){super("w:abstractNumId"),this.root.push(new tn({val:t}))}}class Abe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{numId:"w:numId"})}}class bj extends Be{constructor(t){if(super("w:num"),Pe(this,"numId"),Pe(this,"reference"),Pe(this,"instance"),this.numId=t.numId,this.reference=t.reference,this.instance=t.instance,this.root.push(new Abe({numId:Vs(t.numId)})),this.root.push(new kbe(Vs(t.abstractNumId))),t.overrideLevels&&t.overrideLevels.length)for(const r of t.overrideLevels)this.root.push(new Rbe(r.num,r.start))}}class Cbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{ilvl:"w:ilvl"})}}class Rbe extends Be{constructor(t,r){super("w:lvlOverride"),this.root.push(new Cbe({ilvl:t})),r!==void 0&&this.root.push(new jbe(r))}}class Obe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class jbe extends Be{constructor(t){super("w:startOverride"),this.root.push(new Obe({val:t}))}}class Dbe extends Be{constructor(t){super("w:numbering"),Pe(this,"abstractNumberingMap",new Map),Pe(this,"concreteNumberingMap",new Map),Pe(this,"referenceConfigMap",new Map),Pe(this,"abstractNumUniqueNumericId",M1e()),Pe(this,"concreteNumUniqueNumericId",F1e()),this.root.push(new ey(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps"],"w14 w15 wp14"));const r=new vj(this.abstractNumUniqueNumericId(),[{level:0,format:po.BULLET,text:"",alignment:ja.LEFT,style:{paragraph:{indent:{left:Qa(.5),hanging:Qa(.25)}}}},{level:1,format:po.BULLET,text:"",alignment:ja.LEFT,style:{paragraph:{indent:{left:Qa(1),hanging:Qa(.25)}}}},{level:2,format:po.BULLET,text:"",alignment:ja.LEFT,style:{paragraph:{indent:{left:2160,hanging:Qa(.25)}}}},{level:3,format:po.BULLET,text:"",alignment:ja.LEFT,style:{paragraph:{indent:{left:2880,hanging:Qa(.25)}}}},{level:4,format:po.BULLET,text:"",alignment:ja.LEFT,style:{paragraph:{indent:{left:3600,hanging:Qa(.25)}}}},{level:5,format:po.BULLET,text:"",alignment:ja.LEFT,style:{paragraph:{indent:{left:4320,hanging:Qa(.25)}}}},{level:6,format:po.BULLET,text:"",alignment:ja.LEFT,style:{paragraph:{indent:{left:5040,hanging:Qa(.25)}}}},{level:7,format:po.BULLET,text:"",alignment:ja.LEFT,style:{paragraph:{indent:{left:5760,hanging:Qa(.25)}}}},{level:8,format:po.BULLET,text:"",alignment:ja.LEFT,style:{paragraph:{indent:{left:6480,hanging:Qa(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new bj({numId:1,abstractNumId:r.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",r);for(const n of t.config)this.abstractNumberingMap.set(n.reference,new vj(this.abstractNumUniqueNumericId(),n.levels)),this.referenceConfigMap.set(n.reference,n.levels)}prepForXml(t){for(const r of this.abstractNumberingMap.values())this.root.push(r);for(const r of this.concreteNumberingMap.values())this.root.push(r);return super.prepForXml(t)}createConcreteNumberingInstance(t,r){const n=this.abstractNumberingMap.get(t);if(!n)return;const s=`${t}-${r}`;if(this.concreteNumberingMap.has(s))return;const a=this.referenceConfigMap.get(t),i=a&&a[0].start,o={numId:this.concreteNumUniqueNumericId(),abstractNumId:n.id,reference:t,instance:r,overrideLevels:[i&&Number.isInteger(i)?{num:0,start:i}:{num:0,start:1}]};this.concreteNumberingMap.set(s,new bj(o))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class Ibe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class Mbe extends Be{constructor(t){super("w:compatSetting"),this.root.push(new Ibe({version:t,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class Fbe extends Be{constructor(t){super("w:compat"),t.version&&this.root.push(new Mbe(t.version)),t.useSingleBorderforContiguousCells&&this.root.push(new Ge("w:useSingleBorderforContiguousCells",t.useSingleBorderforContiguousCells)),t.wordPerfectJustification&&this.root.push(new Ge("w:wpJustification",t.wordPerfectJustification)),t.noTabStopForHangingIndent&&this.root.push(new Ge("w:noTabHangInd",t.noTabStopForHangingIndent)),t.noLeading&&this.root.push(new Ge("w:noLeading",t.noLeading)),t.spaceForUnderline&&this.root.push(new Ge("w:spaceForUL",t.spaceForUnderline)),t.noColumnBalance&&this.root.push(new Ge("w:noColumnBalance",t.noColumnBalance)),t.balanceSingleByteDoubleByteWidth&&this.root.push(new Ge("w:balanceSingleByteDoubleByteWidth",t.balanceSingleByteDoubleByteWidth)),t.noExtraLineSpacing&&this.root.push(new Ge("w:noExtraLineSpacing",t.noExtraLineSpacing)),t.doNotLeaveBackslashAlone&&this.root.push(new Ge("w:doNotLeaveBackslashAlone",t.doNotLeaveBackslashAlone)),t.underlineTrailingSpaces&&this.root.push(new Ge("w:ulTrailSpace",t.underlineTrailingSpaces)),t.doNotExpandShiftReturn&&this.root.push(new Ge("w:doNotExpandShiftReturn",t.doNotExpandShiftReturn)),t.spacingInWholePoints&&this.root.push(new Ge("w:spacingInWholePoints",t.spacingInWholePoints)),t.lineWrapLikeWord6&&this.root.push(new Ge("w:lineWrapLikeWord6",t.lineWrapLikeWord6)),t.printBodyTextBeforeHeader&&this.root.push(new Ge("w:printBodyTextBeforeHeader",t.printBodyTextBeforeHeader)),t.printColorsBlack&&this.root.push(new Ge("w:printColBlack",t.printColorsBlack)),t.spaceWidth&&this.root.push(new Ge("w:wpSpaceWidth",t.spaceWidth)),t.showBreaksInFrames&&this.root.push(new Ge("w:showBreaksInFrames",t.showBreaksInFrames)),t.subFontBySize&&this.root.push(new Ge("w:subFontBySize",t.subFontBySize)),t.suppressBottomSpacing&&this.root.push(new Ge("w:suppressBottomSpacing",t.suppressBottomSpacing)),t.suppressTopSpacing&&this.root.push(new Ge("w:suppressTopSpacing",t.suppressTopSpacing)),t.suppressSpacingAtTopOfPage&&this.root.push(new Ge("w:suppressSpacingAtTopOfPage",t.suppressSpacingAtTopOfPage)),t.suppressTopSpacingWP&&this.root.push(new Ge("w:suppressTopSpacingWP",t.suppressTopSpacingWP)),t.suppressSpBfAfterPgBrk&&this.root.push(new Ge("w:suppressSpBfAfterPgBrk",t.suppressSpBfAfterPgBrk)),t.swapBordersFacingPages&&this.root.push(new Ge("w:swapBordersFacingPages",t.swapBordersFacingPages)),t.convertMailMergeEsc&&this.root.push(new Ge("w:convMailMergeEsc",t.convertMailMergeEsc)),t.truncateFontHeightsLikeWP6&&this.root.push(new Ge("w:truncateFontHeightsLikeWP6",t.truncateFontHeightsLikeWP6)),t.macWordSmallCaps&&this.root.push(new Ge("w:mwSmallCaps",t.macWordSmallCaps)),t.usePrinterMetrics&&this.root.push(new Ge("w:usePrinterMetrics",t.usePrinterMetrics)),t.doNotSuppressParagraphBorders&&this.root.push(new Ge("w:doNotSuppressParagraphBorders",t.doNotSuppressParagraphBorders)),t.wrapTrailSpaces&&this.root.push(new Ge("w:wrapTrailSpaces",t.wrapTrailSpaces)),t.footnoteLayoutLikeWW8&&this.root.push(new Ge("w:footnoteLayoutLikeWW8",t.footnoteLayoutLikeWW8)),t.shapeLayoutLikeWW8&&this.root.push(new Ge("w:shapeLayoutLikeWW8",t.shapeLayoutLikeWW8)),t.alignTablesRowByRow&&this.root.push(new Ge("w:alignTablesRowByRow",t.alignTablesRowByRow)),t.forgetLastTabAlignment&&this.root.push(new Ge("w:forgetLastTabAlignment",t.forgetLastTabAlignment)),t.adjustLineHeightInTable&&this.root.push(new Ge("w:adjustLineHeightInTable",t.adjustLineHeightInTable)),t.autoSpaceLikeWord95&&this.root.push(new Ge("w:autoSpaceLikeWord95",t.autoSpaceLikeWord95)),t.noSpaceRaiseLower&&this.root.push(new Ge("w:noSpaceRaiseLower",t.noSpaceRaiseLower)),t.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new Ge("w:doNotUseHTMLParagraphAutoSpacing",t.doNotUseHTMLParagraphAutoSpacing)),t.layoutRawTableWidth&&this.root.push(new Ge("w:layoutRawTableWidth",t.layoutRawTableWidth)),t.layoutTableRowsApart&&this.root.push(new Ge("w:layoutTableRowsApart",t.layoutTableRowsApart)),t.useWord97LineBreakRules&&this.root.push(new Ge("w:useWord97LineBreakRules",t.useWord97LineBreakRules)),t.doNotBreakWrappedTables&&this.root.push(new Ge("w:doNotBreakWrappedTables",t.doNotBreakWrappedTables)),t.doNotSnapToGridInCell&&this.root.push(new Ge("w:doNotSnapToGridInCell",t.doNotSnapToGridInCell)),t.selectFieldWithFirstOrLastCharacter&&this.root.push(new Ge("w:selectFldWithFirstOrLastChar",t.selectFieldWithFirstOrLastCharacter)),t.applyBreakingRules&&this.root.push(new Ge("w:applyBreakingRules",t.applyBreakingRules)),t.doNotWrapTextWithPunctuation&&this.root.push(new Ge("w:doNotWrapTextWithPunct",t.doNotWrapTextWithPunctuation)),t.doNotUseEastAsianBreakRules&&this.root.push(new Ge("w:doNotUseEastAsianBreakRules",t.doNotUseEastAsianBreakRules)),t.useWord2002TableStyleRules&&this.root.push(new Ge("w:useWord2002TableStyleRules",t.useWord2002TableStyleRules)),t.growAutofit&&this.root.push(new Ge("w:growAutofit",t.growAutofit)),t.useFELayout&&this.root.push(new Ge("w:useFELayout",t.useFELayout)),t.useNormalStyleForList&&this.root.push(new Ge("w:useNormalStyleForList",t.useNormalStyleForList)),t.doNotUseIndentAsNumberingTabStop&&this.root.push(new Ge("w:doNotUseIndentAsNumberingTabStop",t.doNotUseIndentAsNumberingTabStop)),t.useAlternateEastAsianLineBreakRules&&this.root.push(new Ge("w:useAltKinsokuLineBreakRules",t.useAlternateEastAsianLineBreakRules)),t.allowSpaceOfSameStyleInTable&&this.root.push(new Ge("w:allowSpaceOfSameStyleInTable",t.allowSpaceOfSameStyleInTable)),t.doNotSuppressIndentation&&this.root.push(new Ge("w:doNotSuppressIndentation",t.doNotSuppressIndentation)),t.doNotAutofitConstrainedTables&&this.root.push(new Ge("w:doNotAutofitConstrainedTables",t.doNotAutofitConstrainedTables)),t.autofitToFirstFixedWidthCell&&this.root.push(new Ge("w:autofitToFirstFixedWidthCell",t.autofitToFirstFixedWidthCell)),t.underlineTabInNumberingList&&this.root.push(new Ge("w:underlineTabInNumList",t.underlineTabInNumberingList)),t.displayHangulFixedWidth&&this.root.push(new Ge("w:displayHangulFixedWidth",t.displayHangulFixedWidth)),t.splitPgBreakAndParaMark&&this.root.push(new Ge("w:splitPgBreakAndParaMark",t.splitPgBreakAndParaMark)),t.doNotVerticallyAlignCellWithSp&&this.root.push(new Ge("w:doNotVertAlignCellWithSp",t.doNotVerticallyAlignCellWithSp)),t.doNotBreakConstrainedForcedTable&&this.root.push(new Ge("w:doNotBreakConstrainedForcedTable",t.doNotBreakConstrainedForcedTable)),t.ignoreVerticalAlignmentInTextboxes&&this.root.push(new Ge("w:doNotVertAlignInTxbx",t.ignoreVerticalAlignmentInTextboxes)),t.useAnsiKerningPairs&&this.root.push(new Ge("w:useAnsiKerningPairs",t.useAnsiKerningPairs)),t.cachedColumnBalance&&this.root.push(new Ge("w:cachedColBalance",t.cachedColumnBalance))}}class Pbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class Lbe extends Be{constructor(t){var r,n,s,a,i,o,c,f;super("w:settings"),this.root.push(new Pbe({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new Ge("w:displayBackgroundShape",!0)),t.trackRevisions!==void 0&&this.root.push(new Ge("w:trackRevisions",t.trackRevisions)),t.evenAndOddHeaders!==void 0&&this.root.push(new Ge("w:evenAndOddHeaders",t.evenAndOddHeaders)),t.updateFields!==void 0&&this.root.push(new Ge("w:updateFields",t.updateFields)),t.defaultTabStop!==void 0&&this.root.push(new a0("w:defaultTabStop",t.defaultTabStop)),((r=t.hyphenation)==null?void 0:r.autoHyphenation)!==void 0&&this.root.push(new Ge("w:autoHyphenation",t.hyphenation.autoHyphenation)),((n=t.hyphenation)==null?void 0:n.hyphenationZone)!==void 0&&this.root.push(new a0("w:hyphenationZone",t.hyphenation.hyphenationZone)),((s=t.hyphenation)==null?void 0:s.consecutiveHyphenLimit)!==void 0&&this.root.push(new a0("w:consecutiveHyphenLimit",t.hyphenation.consecutiveHyphenLimit)),((a=t.hyphenation)==null?void 0:a.doNotHyphenateCaps)!==void 0&&this.root.push(new Ge("w:doNotHyphenateCaps",t.hyphenation.doNotHyphenateCaps)),this.root.push(new Fbe(Mo(Dt({},(i=t.compatibility)!=null?i:{}),{version:(f=(c=(o=t.compatibility)==null?void 0:o.version)!=null?c:t.compatibilityModeVersion)!=null?f:15})))}}class vB extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{val:"w:val"})}}class Bbe extends Be{constructor(t){super("w:name"),this.root.push(new vB({val:t}))}}class Ube extends Be{constructor(t){super("w:uiPriority"),this.root.push(new vB({val:Vs(t)}))}}class zbe extends ut{constructor(){super(...arguments),Pe(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class bB extends Be{constructor(t,r){super("w:style"),this.root.push(new zbe(t)),r.name&&this.root.push(new Bbe(r.name)),r.basedOn&&this.root.push(new Ef("w:basedOn",r.basedOn)),r.next&&this.root.push(new Ef("w:next",r.next)),r.link&&this.root.push(new Ef("w:link",r.link)),r.uiPriority!==void 0&&this.root.push(new Ube(r.uiPriority)),r.semiHidden!==void 0&&this.root.push(new Ge("w:semiHidden",r.semiHidden)),r.unhideWhenUsed!==void 0&&this.root.push(new Ge("w:unhideWhenUsed",r.unhideWhenUsed)),r.quickFormat!==void 0&&this.root.push(new Ge("w:qFormat",r.quickFormat))}}class ty extends bB{constructor(t){super({type:"paragraph",styleId:t.id},t),Pe(this,"paragraphProperties"),Pe(this,"runProperties"),this.paragraphProperties=new Xf(t.paragraph),this.runProperties=new vu(t.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class ry extends bB{constructor(t){super({type:"character",styleId:t.id},Dt({uiPriority:99,unhideWhenUsed:!0},t)),Pe(this,"runProperties"),this.runProperties=new vu(t.run),this.root.push(this.runProperties)}}class ec extends ty{constructor(t){super(Dt({basedOn:"Normal",next:"Normal",quickFormat:!0},t))}}class Hbe extends ec{constructor(t){super(Dt({id:"Title",name:"Title"},t))}}class Vbe extends ec{constructor(t){super(Dt({id:"Heading1",name:"Heading 1"},t))}}class qbe extends ec{constructor(t){super(Dt({id:"Heading2",name:"Heading 2"},t))}}class Wbe extends ec{constructor(t){super(Dt({id:"Heading3",name:"Heading 3"},t))}}class $be extends ec{constructor(t){super(Dt({id:"Heading4",name:"Heading 4"},t))}}class Gbe extends ec{constructor(t){super(Dt({id:"Heading5",name:"Heading 5"},t))}}class Kbe extends ec{constructor(t){super(Dt({id:"Heading6",name:"Heading 6"},t))}}class Xbe extends ec{constructor(t){super(Dt({id:"Strong",name:"Strong"},t))}}class Ybe extends ty{constructor(t){super(Dt({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},t))}}class Jbe extends ty{constructor(t){super(Dt({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:wE.AUTO}},run:{size:20}},t))}}class Zbe extends ry{constructor(t){super(Dt({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},t))}}class Qbe extends ry{constructor(t){super(Dt({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},t))}}class ewe extends ry{constructor(t){super(Dt({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:aB.SINGLE}}},t))}}class EE extends Be{constructor(t){if(super("w:styles"),t.initialStyles&&this.root.push(t.initialStyles),t.importedStyles)for(const r of t.importedStyles)this.root.push(r);if(t.paragraphStyles)for(const r of t.paragraphStyles)this.root.push(new ty(r));if(t.characterStyles)for(const r of t.characterStyles)this.root.push(new ry(r))}}class twe extends Be{constructor(t){super("w:pPrDefault"),this.root.push(new Xf(t))}}class rwe extends Be{constructor(t){super("w:rPrDefault"),this.root.push(new vu(t))}}class nwe extends Be{constructor(t){super("w:docDefaults"),Pe(this,"runPropertiesDefaults"),Pe(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new rwe(t.run),this.paragraphPropertiesDefaults=new twe(t.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class swe{newInstance(t){const r=ZL.xml2js(t,{compact:!1});let n;for(const i of r.elements||[])i.name==="w:styles"&&(n=i);if(n===void 0)throw new Error("can not find styles element");const s=n.elements||[];return new EE({initialStyles:new Gge(n.attributes),importedStyles:s.map(i=>LN(i))})}}class wj{newInstance(t={}){var r;return{initialStyles:new ey(["mc","r","w","w14","w15"],"w14 w15"),importedStyles:[new nwe((r=t.document)!=null?r:{}),new Hbe(Dt({run:{size:56}},t.title)),new Vbe(Dt({run:{color:"2E74B5",size:32}},t.heading1)),new qbe(Dt({run:{color:"2E74B5",size:26}},t.heading2)),new Wbe(Dt({run:{color:"1F4D78",size:24}},t.heading3)),new $be(Dt({run:{color:"2E74B5",italics:!0}},t.heading4)),new Gbe(Dt({run:{color:"2E74B5"}},t.heading5)),new Kbe(Dt({run:{color:"1F4D78"}},t.heading6)),new Xbe(Dt({run:{bold:!0}},t.strong)),new Ybe(t.listParagraph||{}),new ewe(t.hyperlink||{}),new Zbe(t.footnoteReference||{}),new Jbe(t.footnoteText||{}),new Qbe(t.footnoteTextChar||{})]}}}let awe=class{constructor(t){Pe(this,"currentRelationshipId",1),Pe(this,"documentWrapper"),Pe(this,"headers",[]),Pe(this,"footers",[]),Pe(this,"coreProperties"),Pe(this,"numbering"),Pe(this,"media"),Pe(this,"fileRelationships"),Pe(this,"footnotesWrapper"),Pe(this,"settings"),Pe(this,"contentTypes"),Pe(this,"customProperties"),Pe(this,"appProperties"),Pe(this,"styles"),Pe(this,"comments"),Pe(this,"fontWrapper");var r,n,s,a,i,o,c,f,h,p,x,g;if(this.coreProperties=new Vve(Mo(Dt({},t),{creator:(r=t.creator)!=null?r:"Un-named",revision:(n=t.revision)!=null?n:1,lastModifiedBy:(s=t.lastModifiedBy)!=null?s:"Un-named"})),this.numbering=new Dbe(t.numbering?t.numbering:{config:[]}),this.comments=new Kye((a=t.comments)!=null?a:{children:[]}),this.fileRelationships=new bu,this.customProperties=new Xve((i=t.customProperties)!=null?i:[]),this.appProperties=new Lve,this.footnotesWrapper=new dbe,this.contentTypes=new Hve,this.documentWrapper=new yB({background:t.background}),this.settings=new Lbe({compatibilityModeVersion:t.compatabilityModeVersion,compatibility:t.compatibility,evenAndOddHeaders:!!t.evenAndOddHeaderAndFooters,trackRevisions:(o=t.features)==null?void 0:o.trackRevisions,updateFields:(c=t.features)==null?void 0:c.updateFields,defaultTabStop:t.defaultTabStop,hyphenation:{autoHyphenation:(f=t.hyphenation)==null?void 0:f.autoHyphenation,hyphenationZone:(h=t.hyphenation)==null?void 0:h.hyphenationZone,consecutiveHyphenLimit:(p=t.hyphenation)==null?void 0:p.consecutiveHyphenLimit,doNotHyphenateCaps:(x=t.hyphenation)==null?void 0:x.doNotHyphenateCaps}}),this.media=new xbe,t.externalStyles!==void 0){const v=new swe;this.styles=v.newInstance(t.externalStyles)}else if(t.styles){const y=new wj().newInstance(t.styles.default);this.styles=new EE(Dt(Dt({},y),t.styles))}else{const v=new wj;this.styles=new EE(v.newInstance())}this.addDefaultRelationships();for(const v of t.sections)this.addSection(v);if(t.footnotes)for(const v in t.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(v),t.footnotes[v].children);this.fontWrapper=new Qve((g=t.fonts)!=null?g:[])}addSection({headers:t={},footers:r={},children:n,properties:s}){this.documentWrapper.View.Body.addSection(Mo(Dt({},s),{headerWrapperGroup:{default:t.default?this.createHeader(t.default):void 0,first:t.first?this.createHeader(t.first):void 0,even:t.even?this.createHeader(t.even):void 0},footerWrapperGroup:{default:r.default?this.createFooter(r.default):void 0,first:r.first?this.createFooter(r.first):void 0,even:r.even?this.createFooter(r.even):void 0}}));for(const a of n)this.documentWrapper.View.add(a)}createHeader(t){const r=new mbe(this.media,this.currentRelationshipId++);for(const n of t.options.children)r.add(n);return this.addHeaderToDocument(r),r}createFooter(t){const r=new rbe(this.media,this.currentRelationshipId++);for(const n of t.options.children)r.add(n);return this.addFooterToDocument(r),r}addHeaderToDocument(t,r=Sf.DEFAULT){this.headers.push({header:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(t,r=Sf.DEFAULT){this.footers.push({footer:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(t=>t.header)}get Footers(){return this.footers.map(t=>t.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}};var iwe=MN();function wx(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var a_={exports:{}},_j;function owe(){return _j||(_j=1,(function(e,t){(function(r){e.exports=r()})(function(){return(function r(n,s,a){function i(f,h){if(!s[f]){if(!n[f]){var p=typeof wx=="function"&&wx;if(!h&&p)return p(f,!0);if(o)return o(f,!0);var x=new Error("Cannot find module '"+f+"'");throw x.code="MODULE_NOT_FOUND",x}var g=s[f]={exports:{}};n[f][0].call(g.exports,function(v){var y=n[f][1][v];return i(y||v)},g,g.exports,r,n,s,a)}return s[f].exports}for(var o=typeof wx=="function"&&wx,c=0;c<a.length;c++)i(a[c]);return i})({1:[function(r,n,s){var a=r("./utils"),i=r("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(c){for(var f,h,p,x,g,v,y,w=[],_=0,S=c.length,E=S,T=a.getTypeOf(c)!=="string";_<c.length;)E=S-_,p=T?(f=c[_++],h=_<S?c[_++]:0,_<S?c[_++]:0):(f=c.charCodeAt(_++),h=_<S?c.charCodeAt(_++):0,_<S?c.charCodeAt(_++):0),x=f>>2,g=(3&f)<<4|h>>4,v=1<E?(15&h)<<2|p>>6:64,y=2<E?63&p:64,w.push(o.charAt(x)+o.charAt(g)+o.charAt(v)+o.charAt(y));return w.join("")},s.decode=function(c){var f,h,p,x,g,v,y=0,w=0,_="data:";if(c.substr(0,_.length)===_)throw new Error("Invalid base64 input, it looks like a data url.");var S,E=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===o.charAt(64)&&E--,c.charAt(c.length-2)===o.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=i.uint8array?new Uint8Array(0|E):new Array(0|E);y<c.length;)f=o.indexOf(c.charAt(y++))<<2|(x=o.indexOf(c.charAt(y++)))>>4,h=(15&x)<<4|(g=o.indexOf(c.charAt(y++)))>>2,p=(3&g)<<6|(v=o.indexOf(c.charAt(y++))),S[w++]=f,g!==64&&(S[w++]=h),v!==64&&(S[w++]=p);return S}},{"./support":30,"./utils":32}],2:[function(r,n,s){var a=r("./external"),i=r("./stream/DataWorker"),o=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function f(h,p,x,g,v){this.compressedSize=h,this.uncompressedSize=p,this.crc32=x,this.compression=g,this.compressedContent=v}f.prototype={getContentWorker:function(){var h=new i(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),p=this;return h.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new i(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(h,p,x){return h.pipe(new o).pipe(new c("uncompressedSize")).pipe(p.compressWorker(x)).pipe(new c("compressedSize")).withStreamInfo("compression",p)},n.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,s){var a=r("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},s.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,s){var a=r("./utils"),i=(function(){for(var o,c=[],f=0;f<256;f++){o=f;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;c[f]=o}return c})();n.exports=function(o,c){return o!==void 0&&o.length?a.getTypeOf(o)!=="string"?(function(f,h,p,x){var g=i,v=x+p;f^=-1;for(var y=x;y<v;y++)f=f>>>8^g[255&(f^h[y])];return-1^f})(0|c,o,o.length,0):(function(f,h,p,x){var g=i,v=x+p;f^=-1;for(var y=x;y<v;y++)f=f>>>8^g[255&(f^h.charCodeAt(y))];return-1^f})(0|c,o,o.length,0):0}},{"./utils":32}],5:[function(r,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(r,n,s){var a=null;a=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:a}},{lie:37}],7:[function(r,n,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=r("pako"),o=r("./utils"),c=r("./stream/GenericWorker"),f=a?"uint8array":"array";function h(p,x){c.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=x,this.meta={}}s.magic="\b\0",o.inherits(h,c),h.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(f,p.data),!1)},h.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(x){p.push({data:x,meta:p.meta})}},s.compressWorker=function(p){return new h("Deflate",p)},s.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,s){function a(g,v){var y,w="";for(y=0;y<v;y++)w+=String.fromCharCode(255&g),g>>>=8;return w}function i(g,v,y,w,_,S){var E,T,k=g.file,D=g.compression,O=S!==f.utf8encode,z=o.transformTo("string",S(k.name)),j=o.transformTo("string",f.utf8encode(k.name)),J=k.comment,ae=o.transformTo("string",S(J)),F=o.transformTo("string",f.utf8encode(J)),X=j.length!==k.name.length,P=F.length!==J.length,le="",ee="",te="",me=k.dir,ie=k.date,Ee={crc32:0,compressedSize:0,uncompressedSize:0};v&&!y||(Ee.crc32=g.crc32,Ee.compressedSize=g.compressedSize,Ee.uncompressedSize=g.uncompressedSize);var K=0;v&&(K|=8),O||!X&&!P||(K|=2048);var M=0,q=0;me&&(M|=16),_==="UNIX"?(q=798,M|=(function(Z,re){var L=Z;return Z||(L=re?16893:33204),(65535&L)<<16})(k.unixPermissions,me)):(q=20,M|=(function(Z){return 63&(Z||0)})(k.dosPermissions)),E=ie.getUTCHours(),E<<=6,E|=ie.getUTCMinutes(),E<<=5,E|=ie.getUTCSeconds()/2,T=ie.getUTCFullYear()-1980,T<<=4,T|=ie.getUTCMonth()+1,T<<=5,T|=ie.getUTCDate(),X&&(ee=a(1,1)+a(h(z),4)+j,le+="up"+a(ee.length,2)+ee),P&&(te=a(1,1)+a(h(ae),4)+F,le+="uc"+a(te.length,2)+te);var G="";return G+=`
\0`,G+=a(K,2),G+=D.magic,G+=a(E,2),G+=a(T,2),G+=a(Ee.crc32,4),G+=a(Ee.compressedSize,4),G+=a(Ee.uncompressedSize,4),G+=a(z.length,2),G+=a(le.length,2),{fileRecord:p.LOCAL_FILE_HEADER+G+z+le,dirRecord:p.CENTRAL_FILE_HEADER+a(q,2)+G+a(ae.length,2)+"\0\0\0\0"+a(M,4)+a(w,4)+z+le+ae}}var o=r("../utils"),c=r("../stream/GenericWorker"),f=r("../utf8"),h=r("../crc32"),p=r("../signature");function x(g,v,y,w){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=y,this.encodeFileName=w,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(x,c),x.prototype.push=function(g){var v=g.meta.percent||0,y=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,c.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:y?(v+100*(y-w-1))/y:100}}))},x.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var v=this.streamFiles&&!g.file.dir;if(v){var y=i(g,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(g){this.accumulate=!1;var v=this.streamFiles&&!g.file.dir,y=i(g,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),v)this.push({data:(function(w){return p.DATA_DESCRIPTOR+a(w.crc32,4)+a(w.compressedSize,4)+a(w.uncompressedSize,4)})(g),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var g=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var y=this.bytesWritten-g,w=(function(_,S,E,T,k){var D=o.transformTo("string",k(T));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(_,2)+a(_,2)+a(S,4)+a(E,4)+a(D.length,2)+D})(this.dirRecords.length,y,g,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(g){this._sources.push(g);var v=this;return g.on("data",function(y){v.processChunk(y)}),g.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),g.on("error",function(y){v.error(y)}),this},x.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},x.prototype.error=function(g){var v=this._sources;if(!c.prototype.error.call(this,g))return!1;for(var y=0;y<v.length;y++)try{v[y].error(g)}catch{}return!0},x.prototype.lock=function(){c.prototype.lock.call(this);for(var g=this._sources,v=0;v<g.length;v++)g[v].lock()},n.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,s){var a=r("../compressions"),i=r("./ZipFileWorker");s.generateWorker=function(o,c,f){var h=new i(c.streamFiles,f,c.platform,c.encodeFileName),p=0;try{o.forEach(function(x,g){p++;var v=(function(S,E){var T=S||E,k=a[T];if(!k)throw new Error(T+" is not a valid compression method !");return k})(g.options.compression,c.compression),y=g.options.compressionOptions||c.compressionOptions||{},w=g.dir,_=g.date;g._compressWorker(v,y).withStreamInfo("file",{name:x,dir:w,date:_,comment:g.comment||"",unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions}).pipe(h)}),h.entriesCount=p}catch(x){h.error(x)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,s){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new a;for(var o in this)typeof this[o]!="function"&&(i[o]=this[o]);return i}}(a.prototype=r("./object")).loadAsync=r("./load"),a.support=r("./support"),a.defaults=r("./defaults"),a.version="3.10.1",a.loadAsync=function(i,o){return new a().loadAsync(i,o)},a.external=r("./external"),n.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,s){var a=r("./utils"),i=r("./external"),o=r("./utf8"),c=r("./zipEntries"),f=r("./stream/Crc32Probe"),h=r("./nodejsUtils");function p(x){return new i.Promise(function(g,v){var y=x.decompressed.getContentWorker().pipe(new f);y.on("error",function(w){v(w)}).on("end",function(){y.streamInfo.crc32!==x.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}n.exports=function(x,g){var v=this;return g=a.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),h.isNode&&h.isStream(x)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",x,!0,g.optimizedBinaryString,g.base64).then(function(y){var w=new c(g);return w.load(y),w}).then(function(y){var w=[i.Promise.resolve(y)],_=y.files;if(g.checkCRC32)for(var S=0;S<_.length;S++)w.push(p(_[S]));return i.Promise.all(w)}).then(function(y){for(var w=y.shift(),_=w.files,S=0;S<_.length;S++){var E=_[S],T=E.fileNameStr,k=a.resolve(E.fileNameStr);v.file(k,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:g.createFolders}),E.dir||(v.file(k).unsafeOriginalName=T)}return w.zipComment.length&&(v.comment=w.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,s){var a=r("../utils"),i=r("../stream/GenericWorker");function o(c,f){i.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(f)}a.inherits(o,i),o.prototype._bindStream=function(c){var f=this;(this._stream=c).pause(),c.on("data",function(h){f.push({data:h,meta:{percent:0}})}).on("error",function(h){f.isPaused?this.generatedError=h:f.error(h)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,s){var a=r("readable-stream").Readable;function i(o,c,f){a.call(this,c),this._helper=o;var h=this;o.on("data",function(p,x){h.push(p)||h._helper.pause(),f&&f(x)}).on("error",function(p){h.emit("error",p)}).on("end",function(){h.push(null)})}r("../utils").inherits(i,a),i.prototype._read=function(){this._helper.resume()},n.exports=i},{"../utils":32,"readable-stream":16}],14:[function(r,n,s){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,i);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,i)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var i=new Buffer(a);return i.fill(0),i},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(r,n,s){function a(k,D,O){var z,j=o.getTypeOf(D),J=o.extend(O||{},h);J.date=J.date||new Date,J.compression!==null&&(J.compression=J.compression.toUpperCase()),typeof J.unixPermissions=="string"&&(J.unixPermissions=parseInt(J.unixPermissions,8)),J.unixPermissions&&16384&J.unixPermissions&&(J.dir=!0),J.dosPermissions&&16&J.dosPermissions&&(J.dir=!0),J.dir&&(k=_(k)),J.createFolders&&(z=w(k))&&S.call(this,z,!0);var ae=j==="string"&&J.binary===!1&&J.base64===!1;O&&O.binary!==void 0||(J.binary=!ae),(D instanceof p&&D.uncompressedSize===0||J.dir||!D||D.length===0)&&(J.base64=!1,J.binary=!0,D="",J.compression="STORE",j="string");var F=null;F=D instanceof p||D instanceof c?D:v.isNode&&v.isStream(D)?new y(k,D):o.prepareContent(k,D,J.binary,J.optimizedBinaryString,J.base64);var X=new x(k,F,J);this.files[k]=X}var i=r("./utf8"),o=r("./utils"),c=r("./stream/GenericWorker"),f=r("./stream/StreamHelper"),h=r("./defaults"),p=r("./compressedObject"),x=r("./zipObject"),g=r("./generate"),v=r("./nodejsUtils"),y=r("./nodejs/NodejsStreamInputAdapter"),w=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var D=k.lastIndexOf("/");return 0<D?k.substring(0,D):""},_=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},S=function(k,D){return D=D!==void 0?D:h.createFolders,k=_(k),this.files[k]||a.call(this,k,null,{dir:!0,createFolders:D}),this.files[k]};function E(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var D,O,z;for(D in this.files)z=this.files[D],(O=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&k(O,z)},filter:function(k){var D=[];return this.forEach(function(O,z){k(O,z)&&D.push(z)}),D},file:function(k,D,O){if(arguments.length!==1)return k=this.root+k,a.call(this,k,D,O),this;if(E(k)){var z=k;return this.filter(function(J,ae){return!ae.dir&&z.test(J)})}var j=this.files[this.root+k];return j&&!j.dir?j:null},folder:function(k){if(!k)return this;if(E(k))return this.filter(function(j,J){return J.dir&&k.test(j)});var D=this.root+k,O=S.call(this,D),z=this.clone();return z.root=O.name,z},remove:function(k){k=this.root+k;var D=this.files[k];if(D||(k.slice(-1)!=="/"&&(k+="/"),D=this.files[k]),D&&!D.dir)delete this.files[k];else for(var O=this.filter(function(j,J){return J.name.slice(0,k.length)===k}),z=0;z<O.length;z++)delete this.files[O[z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var D,O={};try{if((O=o.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");o.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var z=O.comment||this.comment||"";D=g.generateWorker(this,O,z)}catch(j){(D=new c("error")).error(j)}return new f(D,O.type||"string",O.mimeType)},generateAsync:function(k,D){return this.generateInternalStream(k).accumulate(D)},generateNodeStream:function(k,D){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(D)}};n.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,s){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,s){var a=r("./DataReader");function i(o){a.call(this,o);for(var c=0;c<this.data.length;c++)o[c]=255&o[c]}r("../utils").inherits(i,a),i.prototype.byteAt=function(o){return this.data[this.zero+o]},i.prototype.lastIndexOfSignature=function(o){for(var c=o.charCodeAt(0),f=o.charCodeAt(1),h=o.charCodeAt(2),p=o.charCodeAt(3),x=this.length-4;0<=x;--x)if(this.data[x]===c&&this.data[x+1]===f&&this.data[x+2]===h&&this.data[x+3]===p)return x-this.zero;return-1},i.prototype.readAndCheckSignature=function(o){var c=o.charCodeAt(0),f=o.charCodeAt(1),h=o.charCodeAt(2),p=o.charCodeAt(3),x=this.readData(4);return c===x[0]&&f===x[1]&&h===x[2]&&p===x[3]},i.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=i},{"../utils":32,"./DataReader":18}],18:[function(r,n,s){var a=r("../utils");function i(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var c,f=0;for(this.checkOffset(o),c=this.index+o-1;c>=this.index;c--)f=(f<<8)+this.byteAt(c);return this.index+=o,f},readString:function(o){return a.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=i},{"../utils":32}],19:[function(r,n,s){var a=r("./Uint8ArrayReader");function i(o){a.call(this,o)}r("../utils").inherits(i,a),i.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,s){var a=r("./DataReader");function i(o){a.call(this,o)}r("../utils").inherits(i,a),i.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},i.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},i.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},i.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=i},{"../utils":32,"./DataReader":18}],21:[function(r,n,s){var a=r("./ArrayReader");function i(o){a.call(this,o)}r("../utils").inherits(i,a),i.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,s){var a=r("../utils"),i=r("../support"),o=r("./ArrayReader"),c=r("./StringReader"),f=r("./NodeBufferReader"),h=r("./Uint8ArrayReader");n.exports=function(p){var x=a.getTypeOf(p);return a.checkSupport(x),x!=="string"||i.uint8array?x==="nodebuffer"?new f(p):i.uint8array?new h(a.transformTo("uint8array",p)):new o(a.transformTo("array",p)):new c(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,s){var a=r("./GenericWorker"),i=r("../utils");function o(c){a.call(this,"ConvertWorker to "+c),this.destType=c}i.inherits(o,a),o.prototype.processChunk=function(c){this.push({data:i.transformTo(this.destType,c.data),meta:c.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,s){var a=r("./GenericWorker"),i=r("../crc32");function o(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(o,a),o.prototype.processChunk=function(c){this.streamInfo.crc32=i(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,s){var a=r("../utils"),i=r("./GenericWorker");function o(c){i.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}a.inherits(o,i),o.prototype.processChunk=function(c){if(c){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+c.data.length}i.prototype.processChunk.call(this,c)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,s){var a=r("../utils"),i=r("./GenericWorker");function o(c){i.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(h){f.dataIsReady=!0,f.data=h,f.max=h&&h.length||0,f.type=a.getTypeOf(h),f.isPaused||f._tickAndRepeat()},function(h){f.error(h)})}a.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,f);break;case"uint8array":c=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":c=this.data.slice(this.index,f)}return this.index=f,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,s){function a(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,o){return this._listeners[i].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,o){if(this._listeners[i])for(var c=0;c<this._listeners[i].length;c++)this._listeners[i][c].call(this,o)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var o=this;return i.on("data",function(c){o.processChunk(c)}),i.on("end",function(){o.end()}),i.on("error",function(c){o.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,o){return this.extraStreamInfo[i]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},n.exports=a},{}],29:[function(r,n,s){var a=r("../utils"),i=r("./ConvertWorker"),o=r("./GenericWorker"),c=r("../base64"),f=r("../support"),h=r("../external"),p=null;if(f.nodestream)try{p=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function x(v,y){return new h.Promise(function(w,_){var S=[],E=v._internalType,T=v._outputType,k=v._mimeType;v.on("data",function(D,O){S.push(D),y&&y(O)}).on("error",function(D){S=[],_(D)}).on("end",function(){try{var D=(function(O,z,j){switch(O){case"blob":return a.newBlob(a.transformTo("arraybuffer",z),j);case"base64":return c.encode(z);default:return a.transformTo(O,z)}})(T,(function(O,z){var j,J=0,ae=null,F=0;for(j=0;j<z.length;j++)F+=z[j].length;switch(O){case"string":return z.join("");case"array":return Array.prototype.concat.apply([],z);case"uint8array":for(ae=new Uint8Array(F),j=0;j<z.length;j++)ae.set(z[j],J),J+=z[j].length;return ae;case"nodebuffer":return Buffer.concat(z);default:throw new Error("concat : unsupported type '"+O+"'")}})(E,S),k);w(D)}catch(O){_(O)}S=[]}).resume()})}function g(v,y,w){var _=y;switch(y){case"blob":case"arraybuffer":_="uint8array";break;case"base64":_="string"}try{this._internalType=_,this._outputType=y,this._mimeType=w,a.checkSupport(_),this._worker=v.pipe(new i(_)),v.lock()}catch(S){this._worker=new o("error"),this._worker.error(S)}}g.prototype={accumulate:function(v){return x(this,v)},on:function(v,y){var w=this;return v==="data"?this._worker.on(v,function(_){y.call(w,_.data,_.meta)}):this._worker.on(v,function(){a.delay(y,arguments,w)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},v)}},n.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var a=new ArrayBuffer(0);try{s.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(a),s.blob=i.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!r("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,s){for(var a=r("./utils"),i=r("./support"),o=r("./nodejsUtils"),c=r("./stream/GenericWorker"),f=new Array(256),h=0;h<256;h++)f[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;f[254]=f[254]=1;function p(){c.call(this,"utf-8 decode"),this.leftOver=null}function x(){c.call(this,"utf-8 encode")}s.utf8encode=function(g){return i.nodebuffer?o.newBufferFrom(g,"utf-8"):(function(v){var y,w,_,S,E,T=v.length,k=0;for(S=0;S<T;S++)(64512&(w=v.charCodeAt(S)))==55296&&S+1<T&&(64512&(_=v.charCodeAt(S+1)))==56320&&(w=65536+(w-55296<<10)+(_-56320),S++),k+=w<128?1:w<2048?2:w<65536?3:4;for(y=i.uint8array?new Uint8Array(k):new Array(k),S=E=0;E<k;S++)(64512&(w=v.charCodeAt(S)))==55296&&S+1<T&&(64512&(_=v.charCodeAt(S+1)))==56320&&(w=65536+(w-55296<<10)+(_-56320),S++),w<128?y[E++]=w:(w<2048?y[E++]=192|w>>>6:(w<65536?y[E++]=224|w>>>12:(y[E++]=240|w>>>18,y[E++]=128|w>>>12&63),y[E++]=128|w>>>6&63),y[E++]=128|63&w);return y})(g)},s.utf8decode=function(g){return i.nodebuffer?a.transformTo("nodebuffer",g).toString("utf-8"):(function(v){var y,w,_,S,E=v.length,T=new Array(2*E);for(y=w=0;y<E;)if((_=v[y++])<128)T[w++]=_;else if(4<(S=f[_]))T[w++]=65533,y+=S-1;else{for(_&=S===2?31:S===3?15:7;1<S&&y<E;)_=_<<6|63&v[y++],S--;1<S?T[w++]=65533:_<65536?T[w++]=_:(_-=65536,T[w++]=55296|_>>10&1023,T[w++]=56320|1023&_)}return T.length!==w&&(T.subarray?T=T.subarray(0,w):T.length=w),a.applyFromCharCode(T)})(g=a.transformTo(i.uint8array?"uint8array":"array",g))},a.inherits(p,c),p.prototype.processChunk=function(g){var v=a.transformTo(i.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var y=v;(v=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),v.set(y,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var w=(function(S,E){var T;for((E=E||S.length)>S.length&&(E=S.length),T=E-1;0<=T&&(192&S[T])==128;)T--;return T<0||T===0?E:T+f[S[T]]>E?T:E})(v),_=v;w!==v.length&&(i.uint8array?(_=v.subarray(0,w),this.leftOver=v.subarray(w,v.length)):(_=v.slice(0,w),this.leftOver=v.slice(w,v.length))),this.push({data:s.utf8decode(_),meta:g.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=p,a.inherits(x,c),x.prototype.processChunk=function(g){this.push({data:s.utf8encode(g.data),meta:g.meta})},s.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,s){var a=r("./support"),i=r("./base64"),o=r("./nodejsUtils"),c=r("./external");function f(y){return y}function h(y,w){for(var _=0;_<y.length;++_)w[_]=255&y.charCodeAt(_);return w}r("setimmediate"),s.newBlob=function(y,w){s.checkSupport("blob");try{return new Blob([y],{type:w})}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return _.append(y),_.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(y,w,_){var S=[],E=0,T=y.length;if(T<=_)return String.fromCharCode.apply(null,y);for(;E<T;)w==="array"||w==="nodebuffer"?S.push(String.fromCharCode.apply(null,y.slice(E,Math.min(E+_,T)))):S.push(String.fromCharCode.apply(null,y.subarray(E,Math.min(E+_,T)))),E+=_;return S.join("")},stringifyByChar:function(y){for(var w="",_=0;_<y.length;_++)w+=String.fromCharCode(y[_]);return w},applyCanBeUsed:{uint8array:(function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function x(y){var w=65536,_=s.getTypeOf(y),S=!0;if(_==="uint8array"?S=p.applyCanBeUsed.uint8array:_==="nodebuffer"&&(S=p.applyCanBeUsed.nodebuffer),S)for(;1<w;)try{return p.stringifyByChunk(y,_,w)}catch{w=Math.floor(w/2)}return p.stringifyByChar(y)}function g(y,w){for(var _=0;_<y.length;_++)w[_]=y[_];return w}s.applyFromCharCode=x;var v={};v.string={string:f,array:function(y){return h(y,new Array(y.length))},arraybuffer:function(y){return v.string.uint8array(y).buffer},uint8array:function(y){return h(y,new Uint8Array(y.length))},nodebuffer:function(y){return h(y,o.allocBuffer(y.length))}},v.array={string:x,array:f,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(y)}},v.arraybuffer={string:function(y){return x(new Uint8Array(y))},array:function(y){return g(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:f,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(new Uint8Array(y))}},v.uint8array={string:x,array:function(y){return g(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:f,nodebuffer:function(y){return o.newBufferFrom(y)}},v.nodebuffer={string:x,array:function(y){return g(y,new Array(y.length))},arraybuffer:function(y){return v.nodebuffer.uint8array(y).buffer},uint8array:function(y){return g(y,new Uint8Array(y.length))},nodebuffer:f},s.transformTo=function(y,w){if(w=w||"",!y)return w;s.checkSupport(y);var _=s.getTypeOf(w);return v[_][y](w)},s.resolve=function(y){for(var w=y.split("/"),_=[],S=0;S<w.length;S++){var E=w[S];E==="."||E===""&&S!==0&&S!==w.length-1||(E===".."?_.pop():_.push(E))}return _.join("/")},s.getTypeOf=function(y){return typeof y=="string"?"string":Object.prototype.toString.call(y)==="[object Array]"?"array":a.nodebuffer&&o.isBuffer(y)?"nodebuffer":a.uint8array&&y instanceof Uint8Array?"uint8array":a.arraybuffer&&y instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(y){if(!a[y.toLowerCase()])throw new Error(y+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(y){var w,_,S="";for(_=0;_<(y||"").length;_++)S+="\\x"+((w=y.charCodeAt(_))<16?"0":"")+w.toString(16).toUpperCase();return S},s.delay=function(y,w,_){setImmediate(function(){y.apply(_||null,w||[])})},s.inherits=function(y,w){function _(){}_.prototype=w.prototype,y.prototype=new _},s.extend=function(){var y,w,_={};for(y=0;y<arguments.length;y++)for(w in arguments[y])Object.prototype.hasOwnProperty.call(arguments[y],w)&&_[w]===void 0&&(_[w]=arguments[y][w]);return _},s.prepareContent=function(y,w,_,S,E){return c.Promise.resolve(w).then(function(T){return a.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1)&&typeof FileReader<"u"?new c.Promise(function(k,D){var O=new FileReader;O.onload=function(z){k(z.target.result)},O.onerror=function(z){D(z.target.error)},O.readAsArrayBuffer(T)}):T}).then(function(T){var k=s.getTypeOf(T);return k?(k==="arraybuffer"?T=s.transformTo("uint8array",T):k==="string"&&(E?T=i.decode(T):_&&S!==!0&&(T=(function(D){return h(D,a.uint8array?new Uint8Array(D.length):new Array(D.length))})(T))),T):c.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,s){var a=r("./reader/readerFor"),i=r("./utils"),o=r("./signature"),c=r("./zipEntry"),f=r("./support");function h(p){this.files=[],this.loadOptions=p}h.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var x=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(x)+", expected "+i.pretty(p)+")")}},isSignature:function(p,x){var g=this.reader.index;this.reader.setIndex(p);var v=this.reader.readString(4)===x;return this.reader.setIndex(g),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),x=f.uint8array?"uint8array":"array",g=i.transformTo(x,p);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,x,g,v=this.zip64EndOfCentralSize-44;0<v;)p=this.reader.readInt(2),x=this.reader.readInt(4),g=this.reader.readData(x),this.zip64ExtensibleData[p]={id:p,length:x,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,x;for(p=0;p<this.files.length;p++)x=this.files[p],this.reader.setIndex(x.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),x.readLocalPart(this.reader),x.handleUTF8(),x.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(p=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var x=p;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);var v=x-g;if(0<v)this.isSignature(x,o.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(p){this.reader=a(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,s){var a=r("./reader/readerFor"),i=r("./utils"),o=r("./compressedObject"),c=r("./crc32"),f=r("./utf8"),h=r("./compressions"),p=r("./support");function x(g,v){this.options=g,this.loadOptions=v}x.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(g){var v,y;if(g.skip(22),this.fileNameLength=g.readInt(2),y=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=(function(w){for(var _ in h)if(Object.prototype.hasOwnProperty.call(h,_)&&h[_].magic===w)return h[_];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,v,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var v=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(v),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),g==0&&(this.dosPermissions=63&this.externalFileAttributes),g==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=a(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var v,y,w,_=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<_;)v=g.readInt(2),y=g.readInt(2),w=g.readData(y),this.extraFields[v]={id:v,length:y,value:w};g.setIndex(_)},handleUTF8:function(){var g=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var y=i.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var _=i.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(_)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var v=a(g.value);return v.readInt(1)!==1||c(this.fileName)!==v.readInt(4)?null:f.utf8decode(v.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var v=a(g.value);return v.readInt(1)!==1||c(this.fileComment)!==v.readInt(4)?null:f.utf8decode(v.readData(g.length-5))}return null}},n.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,s){function a(v,y,w){this.name=v,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=y,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var i=r("./stream/StreamHelper"),o=r("./stream/DataWorker"),c=r("./utf8"),f=r("./compressedObject"),h=r("./stream/GenericWorker");a.prototype={internalStream:function(v){var y=null,w="string";try{if(!v)throw new Error("No output type specified.");var _=(w=v.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),y=this._decompressWorker();var S=!this._dataBinary;S&&!_&&(y=y.pipe(new c.Utf8EncodeWorker)),!S&&_&&(y=y.pipe(new c.Utf8DecodeWorker))}catch(E){(y=new h("error")).error(E)}return new i(y,w,"")},async:function(v,y){return this.internalStream(v).accumulate(y)},nodeStream:function(v,y){return this.internalStream(v||"nodebuffer").toNodejsStream(y)},_compressWorker:function(v,y){if(this._data instanceof f&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new c.Utf8EncodeWorker)),f.createWorkerFrom(w,v,y)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof h?this._data:new o(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],x=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<p.length;g++)a.prototype[p[g]]=x;n.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,s){(function(a){var i,o,c=a.MutationObserver||a.WebKitMutationObserver;if(c){var f=0,h=new c(v),p=a.document.createTextNode("");h.observe(p,{characterData:!0}),i=function(){p.data=f=++f%2}}else if(a.setImmediate||a.MessageChannel===void 0)i="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var y=a.document.createElement("script");y.onreadystatechange=function(){v(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},a.document.documentElement.appendChild(y)}:function(){setTimeout(v,0)};else{var x=new a.MessageChannel;x.port1.onmessage=v,i=function(){x.port2.postMessage(0)}}var g=[];function v(){var y,w;o=!0;for(var _=g.length;_;){for(w=g,g=[],y=-1;++y<_;)w[y]();_=g.length}o=!1}n.exports=function(y){g.push(y)!==1||o||i()}}).call(this,typeof Fi<"u"?Fi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,s){var a=r("immediate");function i(){}var o={},c=["REJECTED"],f=["FULFILLED"],h=["PENDING"];function p(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,_!==i&&y(this,_)}function x(_,S,E){this.promise=_,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function g(_,S,E){a(function(){var T;try{T=S(E)}catch(k){return o.reject(_,k)}T===_?o.reject(_,new TypeError("Cannot resolve promise with itself")):o.resolve(_,T)})}function v(_){var S=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof S=="function")return function(){S.apply(_,arguments)}}function y(_,S){var E=!1;function T(O){E||(E=!0,o.reject(_,O))}function k(O){E||(E=!0,o.resolve(_,O))}var D=w(function(){S(k,T)});D.status==="error"&&T(D.value)}function w(_,S){var E={};try{E.value=_(S),E.status="success"}catch(T){E.status="error",E.value=T}return E}(n.exports=p).prototype.finally=function(_){if(typeof _!="function")return this;var S=this.constructor;return this.then(function(E){return S.resolve(_()).then(function(){return E})},function(E){return S.resolve(_()).then(function(){throw E})})},p.prototype.catch=function(_){return this.then(null,_)},p.prototype.then=function(_,S){if(typeof _!="function"&&this.state===f||typeof S!="function"&&this.state===c)return this;var E=new this.constructor(i);return this.state!==h?g(E,this.state===f?_:S,this.outcome):this.queue.push(new x(E,_,S)),E},x.prototype.callFulfilled=function(_){o.resolve(this.promise,_)},x.prototype.otherCallFulfilled=function(_){g(this.promise,this.onFulfilled,_)},x.prototype.callRejected=function(_){o.reject(this.promise,_)},x.prototype.otherCallRejected=function(_){g(this.promise,this.onRejected,_)},o.resolve=function(_,S){var E=w(v,S);if(E.status==="error")return o.reject(_,E.value);var T=E.value;if(T)y(_,T);else{_.state=f,_.outcome=S;for(var k=-1,D=_.queue.length;++k<D;)_.queue[k].callFulfilled(S)}return _},o.reject=function(_,S){_.state=c,_.outcome=S;for(var E=-1,T=_.queue.length;++E<T;)_.queue[E].callRejected(S);return _},p.resolve=function(_){return _ instanceof this?_:o.resolve(new this(i),_)},p.reject=function(_){var S=new this(i);return o.reject(S,_)},p.all=function(_){var S=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=_.length,T=!1;if(!E)return this.resolve([]);for(var k=new Array(E),D=0,O=-1,z=new this(i);++O<E;)j(_[O],O);return z;function j(J,ae){S.resolve(J).then(function(F){k[ae]=F,++D!==E||T||(T=!0,o.resolve(z,k))},function(F){T||(T=!0,o.reject(z,F))})}},p.race=function(_){var S=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=_.length,T=!1;if(!E)return this.resolve([]);for(var k=-1,D=new this(i);++k<E;)O=_[k],S.resolve(O).then(function(z){T||(T=!0,o.resolve(D,z))},function(z){T||(T=!0,o.reject(D,z))});var O;return D}},{immediate:36}],38:[function(r,n,s){var a={};(0,r("./lib/utils/common").assign)(a,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,s){var a=r("./zlib/deflate"),i=r("./utils/common"),o=r("./utils/strings"),c=r("./zlib/messages"),f=r("./zlib/zstream"),h=Object.prototype.toString,p=0,x=-1,g=0,v=8;function y(_){if(!(this instanceof y))return new y(_);this.options=i.assign({level:x,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},_||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var E=a.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(E!==p)throw new Error(c[E]);if(S.header&&a.deflateSetHeader(this.strm,S.header),S.dictionary){var T;if(T=typeof S.dictionary=="string"?o.string2buf(S.dictionary):h.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(E=a.deflateSetDictionary(this.strm,T))!==p)throw new Error(c[E]);this._dict_set=!0}}function w(_,S){var E=new y(S);if(E.push(_,!0),E.err)throw E.msg||c[E.err];return E.result}y.prototype.push=function(_,S){var E,T,k=this.strm,D=this.options.chunkSize;if(this.ended)return!1;T=S===~~S?S:S===!0?4:0,typeof _=="string"?k.input=o.string2buf(_):h.call(_)==="[object ArrayBuffer]"?k.input=new Uint8Array(_):k.input=_,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new i.Buf8(D),k.next_out=0,k.avail_out=D),(E=a.deflate(k,T))!==1&&E!==p)return this.onEnd(E),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||T!==4&&T!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(i.shrinkBuf(k.output,k.next_out))):this.onData(i.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&E!==1);return T===4?(E=a.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===p):T!==2||(this.onEnd(p),!(k.avail_out=0))},y.prototype.onData=function(_){this.chunks.push(_)},y.prototype.onEnd=function(_){_===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},s.Deflate=y,s.deflate=w,s.deflateRaw=function(_,S){return(S=S||{}).raw=!0,w(_,S)},s.gzip=function(_,S){return(S=S||{}).gzip=!0,w(_,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,s){var a=r("./zlib/inflate"),i=r("./utils/common"),o=r("./utils/strings"),c=r("./zlib/constants"),f=r("./zlib/messages"),h=r("./zlib/zstream"),p=r("./zlib/gzheader"),x=Object.prototype.toString;function g(y){if(!(this instanceof g))return new g(y);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},y||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||y&&y.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&(15&w.windowBits)==0&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var _=a.inflateInit2(this.strm,w.windowBits);if(_!==c.Z_OK)throw new Error(f[_]);this.header=new p,a.inflateGetHeader(this.strm,this.header)}function v(y,w){var _=new g(w);if(_.push(y,!0),_.err)throw _.msg||f[_.err];return _.result}g.prototype.push=function(y,w){var _,S,E,T,k,D,O=this.strm,z=this.options.chunkSize,j=this.options.dictionary,J=!1;if(this.ended)return!1;S=w===~~w?w:w===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof y=="string"?O.input=o.binstring2buf(y):x.call(y)==="[object ArrayBuffer]"?O.input=new Uint8Array(y):O.input=y,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new i.Buf8(z),O.next_out=0,O.avail_out=z),(_=a.inflate(O,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&j&&(D=typeof j=="string"?o.string2buf(j):x.call(j)==="[object ArrayBuffer]"?new Uint8Array(j):j,_=a.inflateSetDictionary(this.strm,D)),_===c.Z_BUF_ERROR&&J===!0&&(_=c.Z_OK,J=!1),_!==c.Z_STREAM_END&&_!==c.Z_OK)return this.onEnd(_),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&_!==c.Z_STREAM_END&&(O.avail_in!==0||S!==c.Z_FINISH&&S!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=o.utf8border(O.output,O.next_out),T=O.next_out-E,k=o.buf2string(O.output,E),O.next_out=T,O.avail_out=z-T,T&&i.arraySet(O.output,O.output,E,T,0),this.onData(k)):this.onData(i.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(J=!0)}while((0<O.avail_in||O.avail_out===0)&&_!==c.Z_STREAM_END);return _===c.Z_STREAM_END&&(S=c.Z_FINISH),S===c.Z_FINISH?(_=a.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===c.Z_OK):S!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(O.avail_out=0))},g.prototype.onData=function(y){this.chunks.push(y)},g.prototype.onEnd=function(y){y===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},s.Inflate=g,s.inflate=v,s.inflateRaw=function(y,w){return(w=w||{}).raw=!0,v(y,w)},s.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(c){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var h=f.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var p in h)h.hasOwnProperty(p)&&(c[p]=h[p])}}return c},s.shrinkBuf=function(c,f){return c.length===f?c:c.subarray?c.subarray(0,f):(c.length=f,c)};var i={arraySet:function(c,f,h,p,x){if(f.subarray&&c.subarray)c.set(f.subarray(h,h+p),x);else for(var g=0;g<p;g++)c[x+g]=f[h+g]},flattenChunks:function(c){var f,h,p,x,g,v;for(f=p=0,h=c.length;f<h;f++)p+=c[f].length;for(v=new Uint8Array(p),f=x=0,h=c.length;f<h;f++)g=c[f],v.set(g,x),x+=g.length;return v}},o={arraySet:function(c,f,h,p,x){for(var g=0;g<p;g++)c[x+g]=f[h+g]},flattenChunks:function(c){return[].concat.apply([],c)}};s.setTyped=function(c){c?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,i)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(a)},{}],42:[function(r,n,s){var a=r("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var c=new a.Buf8(256),f=0;f<256;f++)c[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function h(p,x){if(x<65537&&(p.subarray&&o||!p.subarray&&i))return String.fromCharCode.apply(null,a.shrinkBuf(p,x));for(var g="",v=0;v<x;v++)g+=String.fromCharCode(p[v]);return g}c[254]=c[254]=1,s.string2buf=function(p){var x,g,v,y,w,_=p.length,S=0;for(y=0;y<_;y++)(64512&(g=p.charCodeAt(y)))==55296&&y+1<_&&(64512&(v=p.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),y++),S+=g<128?1:g<2048?2:g<65536?3:4;for(x=new a.Buf8(S),y=w=0;w<S;y++)(64512&(g=p.charCodeAt(y)))==55296&&y+1<_&&(64512&(v=p.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),y++),g<128?x[w++]=g:(g<2048?x[w++]=192|g>>>6:(g<65536?x[w++]=224|g>>>12:(x[w++]=240|g>>>18,x[w++]=128|g>>>12&63),x[w++]=128|g>>>6&63),x[w++]=128|63&g);return x},s.buf2binstring=function(p){return h(p,p.length)},s.binstring2buf=function(p){for(var x=new a.Buf8(p.length),g=0,v=x.length;g<v;g++)x[g]=p.charCodeAt(g);return x},s.buf2string=function(p,x){var g,v,y,w,_=x||p.length,S=new Array(2*_);for(g=v=0;g<_;)if((y=p[g++])<128)S[v++]=y;else if(4<(w=c[y]))S[v++]=65533,g+=w-1;else{for(y&=w===2?31:w===3?15:7;1<w&&g<_;)y=y<<6|63&p[g++],w--;1<w?S[v++]=65533:y<65536?S[v++]=y:(y-=65536,S[v++]=55296|y>>10&1023,S[v++]=56320|1023&y)}return h(S,v)},s.utf8border=function(p,x){var g;for((x=x||p.length)>p.length&&(x=p.length),g=x-1;0<=g&&(192&p[g])==128;)g--;return g<0||g===0?x:g+c[p[g]]>x?g:x}},{"./common":41}],43:[function(r,n,s){n.exports=function(a,i,o,c){for(var f=65535&a|0,h=a>>>16&65535|0,p=0;o!==0;){for(o-=p=2e3<o?2e3:o;h=h+(f=f+i[c++]|0)|0,--p;);f%=65521,h%=65521}return f|h<<16|0}},{}],44:[function(r,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,s){var a=(function(){for(var i,o=[],c=0;c<256;c++){i=c;for(var f=0;f<8;f++)i=1&i?3988292384^i>>>1:i>>>1;o[c]=i}return o})();n.exports=function(i,o,c,f){var h=a,p=f+c;i^=-1;for(var x=f;x<p;x++)i=i>>>8^h[255&(i^o[x])];return-1^i}},{}],46:[function(r,n,s){var a,i=r("../utils/common"),o=r("./trees"),c=r("./adler32"),f=r("./crc32"),h=r("./messages"),p=0,x=4,g=0,v=-2,y=-1,w=4,_=2,S=8,E=9,T=286,k=30,D=19,O=2*T+1,z=15,j=3,J=258,ae=J+j+1,F=42,X=113,P=1,le=2,ee=3,te=4;function me(B,be){return B.msg=h[be],be}function ie(B){return(B<<1)-(4<B?9:0)}function Ee(B){for(var be=B.length;0<=--be;)B[be]=0}function K(B){var be=B.state,V=be.pending;V>B.avail_out&&(V=B.avail_out),V!==0&&(i.arraySet(B.output,be.pending_buf,be.pending_out,V,B.next_out),B.next_out+=V,be.pending_out+=V,B.total_out+=V,B.avail_out-=V,be.pending-=V,be.pending===0&&(be.pending_out=0))}function M(B,be){o._tr_flush_block(B,0<=B.block_start?B.block_start:-1,B.strstart-B.block_start,be),B.block_start=B.strstart,K(B.strm)}function q(B,be){B.pending_buf[B.pending++]=be}function G(B,be){B.pending_buf[B.pending++]=be>>>8&255,B.pending_buf[B.pending++]=255&be}function Z(B,be){var V,C,A=B.max_chain_length,H=B.strstart,ue=B.prev_length,ye=B.nice_match,he=B.strstart>B.w_size-ae?B.strstart-(B.w_size-ae):0,ke=B.window,De=B.w_mask,Fe=B.prev,$e=B.strstart+J,rt=ke[H+ue-1],at=ke[H+ue];B.prev_length>=B.good_match&&(A>>=2),ye>B.lookahead&&(ye=B.lookahead);do if(ke[(V=be)+ue]===at&&ke[V+ue-1]===rt&&ke[V]===ke[H]&&ke[++V]===ke[H+1]){H+=2,V++;do;while(ke[++H]===ke[++V]&&ke[++H]===ke[++V]&&ke[++H]===ke[++V]&&ke[++H]===ke[++V]&&ke[++H]===ke[++V]&&ke[++H]===ke[++V]&&ke[++H]===ke[++V]&&ke[++H]===ke[++V]&&H<$e);if(C=J-($e-H),H=$e-J,ue<C){if(B.match_start=be,ye<=(ue=C))break;rt=ke[H+ue-1],at=ke[H+ue]}}while((be=Fe[be&De])>he&&--A!=0);return ue<=B.lookahead?ue:B.lookahead}function re(B){var be,V,C,A,H,ue,ye,he,ke,De,Fe=B.w_size;do{if(A=B.window_size-B.lookahead-B.strstart,B.strstart>=Fe+(Fe-ae)){for(i.arraySet(B.window,B.window,Fe,Fe,0),B.match_start-=Fe,B.strstart-=Fe,B.block_start-=Fe,be=V=B.hash_size;C=B.head[--be],B.head[be]=Fe<=C?C-Fe:0,--V;);for(be=V=Fe;C=B.prev[--be],B.prev[be]=Fe<=C?C-Fe:0,--V;);A+=Fe}if(B.strm.avail_in===0)break;if(ue=B.strm,ye=B.window,he=B.strstart+B.lookahead,ke=A,De=void 0,De=ue.avail_in,ke<De&&(De=ke),V=De===0?0:(ue.avail_in-=De,i.arraySet(ye,ue.input,ue.next_in,De,he),ue.state.wrap===1?ue.adler=c(ue.adler,ye,De,he):ue.state.wrap===2&&(ue.adler=f(ue.adler,ye,De,he)),ue.next_in+=De,ue.total_in+=De,De),B.lookahead+=V,B.lookahead+B.insert>=j)for(H=B.strstart-B.insert,B.ins_h=B.window[H],B.ins_h=(B.ins_h<<B.hash_shift^B.window[H+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[H+j-1])&B.hash_mask,B.prev[H&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=H,H++,B.insert--,!(B.lookahead+B.insert<j)););}while(B.lookahead<ae&&B.strm.avail_in!==0)}function L(B,be){for(var V,C;;){if(B.lookahead<ae){if(re(B),B.lookahead<ae&&be===p)return P;if(B.lookahead===0)break}if(V=0,B.lookahead>=j&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+j-1])&B.hash_mask,V=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),V!==0&&B.strstart-V<=B.w_size-ae&&(B.match_length=Z(B,V)),B.match_length>=j)if(C=o._tr_tally(B,B.strstart-B.match_start,B.match_length-j),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=j){for(B.match_length--;B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+j-1])&B.hash_mask,V=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart,--B.match_length!=0;);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else C=o._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(C&&(M(B,!1),B.strm.avail_out===0))return P}return B.insert=B.strstart<j-1?B.strstart:j-1,be===x?(M(B,!0),B.strm.avail_out===0?ee:te):B.last_lit&&(M(B,!1),B.strm.avail_out===0)?P:le}function I(B,be){for(var V,C,A;;){if(B.lookahead<ae){if(re(B),B.lookahead<ae&&be===p)return P;if(B.lookahead===0)break}if(V=0,B.lookahead>=j&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+j-1])&B.hash_mask,V=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=j-1,V!==0&&B.prev_length<B.max_lazy_match&&B.strstart-V<=B.w_size-ae&&(B.match_length=Z(B,V),B.match_length<=5&&(B.strategy===1||B.match_length===j&&4096<B.strstart-B.match_start)&&(B.match_length=j-1)),B.prev_length>=j&&B.match_length<=B.prev_length){for(A=B.strstart+B.lookahead-j,C=o._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-j),B.lookahead-=B.prev_length-1,B.prev_length-=2;++B.strstart<=A&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+j-1])&B.hash_mask,V=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),--B.prev_length!=0;);if(B.match_available=0,B.match_length=j-1,B.strstart++,C&&(M(B,!1),B.strm.avail_out===0))return P}else if(B.match_available){if((C=o._tr_tally(B,0,B.window[B.strstart-1]))&&M(B,!1),B.strstart++,B.lookahead--,B.strm.avail_out===0)return P}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(C=o._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<j-1?B.strstart:j-1,be===x?(M(B,!0),B.strm.avail_out===0?ee:te):B.last_lit&&(M(B,!1),B.strm.avail_out===0)?P:le}function se(B,be,V,C,A){this.good_length=B,this.max_lazy=be,this.nice_length=V,this.max_chain=C,this.func=A}function Q(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*O),this.dyn_dtree=new i.Buf16(2*(2*k+1)),this.bl_tree=new i.Buf16(2*(2*D+1)),Ee(this.dyn_ltree),Ee(this.dyn_dtree),Ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(z+1),this.heap=new i.Buf16(2*T+1),Ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*T+1),Ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Y(B){var be;return B&&B.state?(B.total_in=B.total_out=0,B.data_type=_,(be=B.state).pending=0,be.pending_out=0,be.wrap<0&&(be.wrap=-be.wrap),be.status=be.wrap?F:X,B.adler=be.wrap===2?0:1,be.last_flush=p,o._tr_init(be),g):me(B,v)}function U(B){var be=Y(B);return be===g&&(function(V){V.window_size=2*V.w_size,Ee(V.head),V.max_lazy_match=a[V.level].max_lazy,V.good_match=a[V.level].good_length,V.nice_match=a[V.level].nice_length,V.max_chain_length=a[V.level].max_chain,V.strstart=0,V.block_start=0,V.lookahead=0,V.insert=0,V.match_length=V.prev_length=j-1,V.match_available=0,V.ins_h=0})(B.state),be}function we(B,be,V,C,A,H){if(!B)return v;var ue=1;if(be===y&&(be=6),C<0?(ue=0,C=-C):15<C&&(ue=2,C-=16),A<1||E<A||V!==S||C<8||15<C||be<0||9<be||H<0||w<H)return me(B,v);C===8&&(C=9);var ye=new Q;return(B.state=ye).strm=B,ye.wrap=ue,ye.gzhead=null,ye.w_bits=C,ye.w_size=1<<ye.w_bits,ye.w_mask=ye.w_size-1,ye.hash_bits=A+7,ye.hash_size=1<<ye.hash_bits,ye.hash_mask=ye.hash_size-1,ye.hash_shift=~~((ye.hash_bits+j-1)/j),ye.window=new i.Buf8(2*ye.w_size),ye.head=new i.Buf16(ye.hash_size),ye.prev=new i.Buf16(ye.w_size),ye.lit_bufsize=1<<A+6,ye.pending_buf_size=4*ye.lit_bufsize,ye.pending_buf=new i.Buf8(ye.pending_buf_size),ye.d_buf=1*ye.lit_bufsize,ye.l_buf=3*ye.lit_bufsize,ye.level=be,ye.strategy=H,ye.method=V,U(B)}a=[new se(0,0,0,0,function(B,be){var V=65535;for(V>B.pending_buf_size-5&&(V=B.pending_buf_size-5);;){if(B.lookahead<=1){if(re(B),B.lookahead===0&&be===p)return P;if(B.lookahead===0)break}B.strstart+=B.lookahead,B.lookahead=0;var C=B.block_start+V;if((B.strstart===0||B.strstart>=C)&&(B.lookahead=B.strstart-C,B.strstart=C,M(B,!1),B.strm.avail_out===0)||B.strstart-B.block_start>=B.w_size-ae&&(M(B,!1),B.strm.avail_out===0))return P}return B.insert=0,be===x?(M(B,!0),B.strm.avail_out===0?ee:te):(B.strstart>B.block_start&&(M(B,!1),B.strm.avail_out),P)}),new se(4,4,8,4,L),new se(4,5,16,8,L),new se(4,6,32,32,L),new se(4,4,16,16,I),new se(8,16,32,32,I),new se(8,16,128,128,I),new se(8,32,128,256,I),new se(32,128,258,1024,I),new se(32,258,258,4096,I)],s.deflateInit=function(B,be){return we(B,be,S,15,8,0)},s.deflateInit2=we,s.deflateReset=U,s.deflateResetKeep=Y,s.deflateSetHeader=function(B,be){return B&&B.state?B.state.wrap!==2?v:(B.state.gzhead=be,g):v},s.deflate=function(B,be){var V,C,A,H;if(!B||!B.state||5<be||be<0)return B?me(B,v):v;if(C=B.state,!B.output||!B.input&&B.avail_in!==0||C.status===666&&be!==x)return me(B,B.avail_out===0?-5:v);if(C.strm=B,V=C.last_flush,C.last_flush=be,C.status===F)if(C.wrap===2)B.adler=0,q(C,31),q(C,139),q(C,8),C.gzhead?(q(C,(C.gzhead.text?1:0)+(C.gzhead.hcrc?2:0)+(C.gzhead.extra?4:0)+(C.gzhead.name?8:0)+(C.gzhead.comment?16:0)),q(C,255&C.gzhead.time),q(C,C.gzhead.time>>8&255),q(C,C.gzhead.time>>16&255),q(C,C.gzhead.time>>24&255),q(C,C.level===9?2:2<=C.strategy||C.level<2?4:0),q(C,255&C.gzhead.os),C.gzhead.extra&&C.gzhead.extra.length&&(q(C,255&C.gzhead.extra.length),q(C,C.gzhead.extra.length>>8&255)),C.gzhead.hcrc&&(B.adler=f(B.adler,C.pending_buf,C.pending,0)),C.gzindex=0,C.status=69):(q(C,0),q(C,0),q(C,0),q(C,0),q(C,0),q(C,C.level===9?2:2<=C.strategy||C.level<2?4:0),q(C,3),C.status=X);else{var ue=S+(C.w_bits-8<<4)<<8;ue|=(2<=C.strategy||C.level<2?0:C.level<6?1:C.level===6?2:3)<<6,C.strstart!==0&&(ue|=32),ue+=31-ue%31,C.status=X,G(C,ue),C.strstart!==0&&(G(C,B.adler>>>16),G(C,65535&B.adler)),B.adler=1}if(C.status===69)if(C.gzhead.extra){for(A=C.pending;C.gzindex<(65535&C.gzhead.extra.length)&&(C.pending!==C.pending_buf_size||(C.gzhead.hcrc&&C.pending>A&&(B.adler=f(B.adler,C.pending_buf,C.pending-A,A)),K(B),A=C.pending,C.pending!==C.pending_buf_size));)q(C,255&C.gzhead.extra[C.gzindex]),C.gzindex++;C.gzhead.hcrc&&C.pending>A&&(B.adler=f(B.adler,C.pending_buf,C.pending-A,A)),C.gzindex===C.gzhead.extra.length&&(C.gzindex=0,C.status=73)}else C.status=73;if(C.status===73)if(C.gzhead.name){A=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>A&&(B.adler=f(B.adler,C.pending_buf,C.pending-A,A)),K(B),A=C.pending,C.pending===C.pending_buf_size)){H=1;break}H=C.gzindex<C.gzhead.name.length?255&C.gzhead.name.charCodeAt(C.gzindex++):0,q(C,H)}while(H!==0);C.gzhead.hcrc&&C.pending>A&&(B.adler=f(B.adler,C.pending_buf,C.pending-A,A)),H===0&&(C.gzindex=0,C.status=91)}else C.status=91;if(C.status===91)if(C.gzhead.comment){A=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>A&&(B.adler=f(B.adler,C.pending_buf,C.pending-A,A)),K(B),A=C.pending,C.pending===C.pending_buf_size)){H=1;break}H=C.gzindex<C.gzhead.comment.length?255&C.gzhead.comment.charCodeAt(C.gzindex++):0,q(C,H)}while(H!==0);C.gzhead.hcrc&&C.pending>A&&(B.adler=f(B.adler,C.pending_buf,C.pending-A,A)),H===0&&(C.status=103)}else C.status=103;if(C.status===103&&(C.gzhead.hcrc?(C.pending+2>C.pending_buf_size&&K(B),C.pending+2<=C.pending_buf_size&&(q(C,255&B.adler),q(C,B.adler>>8&255),B.adler=0,C.status=X)):C.status=X),C.pending!==0){if(K(B),B.avail_out===0)return C.last_flush=-1,g}else if(B.avail_in===0&&ie(be)<=ie(V)&&be!==x)return me(B,-5);if(C.status===666&&B.avail_in!==0)return me(B,-5);if(B.avail_in!==0||C.lookahead!==0||be!==p&&C.status!==666){var ye=C.strategy===2?(function(he,ke){for(var De;;){if(he.lookahead===0&&(re(he),he.lookahead===0)){if(ke===p)return P;break}if(he.match_length=0,De=o._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++,De&&(M(he,!1),he.strm.avail_out===0))return P}return he.insert=0,ke===x?(M(he,!0),he.strm.avail_out===0?ee:te):he.last_lit&&(M(he,!1),he.strm.avail_out===0)?P:le})(C,be):C.strategy===3?(function(he,ke){for(var De,Fe,$e,rt,at=he.window;;){if(he.lookahead<=J){if(re(he),he.lookahead<=J&&ke===p)return P;if(he.lookahead===0)break}if(he.match_length=0,he.lookahead>=j&&0<he.strstart&&(Fe=at[$e=he.strstart-1])===at[++$e]&&Fe===at[++$e]&&Fe===at[++$e]){rt=he.strstart+J;do;while(Fe===at[++$e]&&Fe===at[++$e]&&Fe===at[++$e]&&Fe===at[++$e]&&Fe===at[++$e]&&Fe===at[++$e]&&Fe===at[++$e]&&Fe===at[++$e]&&$e<rt);he.match_length=J-(rt-$e),he.match_length>he.lookahead&&(he.match_length=he.lookahead)}if(he.match_length>=j?(De=o._tr_tally(he,1,he.match_length-j),he.lookahead-=he.match_length,he.strstart+=he.match_length,he.match_length=0):(De=o._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++),De&&(M(he,!1),he.strm.avail_out===0))return P}return he.insert=0,ke===x?(M(he,!0),he.strm.avail_out===0?ee:te):he.last_lit&&(M(he,!1),he.strm.avail_out===0)?P:le})(C,be):a[C.level].func(C,be);if(ye!==ee&&ye!==te||(C.status=666),ye===P||ye===ee)return B.avail_out===0&&(C.last_flush=-1),g;if(ye===le&&(be===1?o._tr_align(C):be!==5&&(o._tr_stored_block(C,0,0,!1),be===3&&(Ee(C.head),C.lookahead===0&&(C.strstart=0,C.block_start=0,C.insert=0))),K(B),B.avail_out===0))return C.last_flush=-1,g}return be!==x?g:C.wrap<=0?1:(C.wrap===2?(q(C,255&B.adler),q(C,B.adler>>8&255),q(C,B.adler>>16&255),q(C,B.adler>>24&255),q(C,255&B.total_in),q(C,B.total_in>>8&255),q(C,B.total_in>>16&255),q(C,B.total_in>>24&255)):(G(C,B.adler>>>16),G(C,65535&B.adler)),K(B),0<C.wrap&&(C.wrap=-C.wrap),C.pending!==0?g:1)},s.deflateEnd=function(B){var be;return B&&B.state?(be=B.state.status)!==F&&be!==69&&be!==73&&be!==91&&be!==103&&be!==X&&be!==666?me(B,v):(B.state=null,be===X?me(B,-3):g):v},s.deflateSetDictionary=function(B,be){var V,C,A,H,ue,ye,he,ke,De=be.length;if(!B||!B.state||(H=(V=B.state).wrap)===2||H===1&&V.status!==F||V.lookahead)return v;for(H===1&&(B.adler=c(B.adler,be,De,0)),V.wrap=0,De>=V.w_size&&(H===0&&(Ee(V.head),V.strstart=0,V.block_start=0,V.insert=0),ke=new i.Buf8(V.w_size),i.arraySet(ke,be,De-V.w_size,V.w_size,0),be=ke,De=V.w_size),ue=B.avail_in,ye=B.next_in,he=B.input,B.avail_in=De,B.next_in=0,B.input=be,re(V);V.lookahead>=j;){for(C=V.strstart,A=V.lookahead-(j-1);V.ins_h=(V.ins_h<<V.hash_shift^V.window[C+j-1])&V.hash_mask,V.prev[C&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=C,C++,--A;);V.strstart=C,V.lookahead=j-1,re(V)}return V.strstart+=V.lookahead,V.block_start=V.strstart,V.insert=V.lookahead,V.lookahead=0,V.match_length=V.prev_length=j-1,V.match_available=0,B.next_in=ye,B.input=he,B.avail_in=ue,V.wrap=H,g},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,s){n.exports=function(a,i){var o,c,f,h,p,x,g,v,y,w,_,S,E,T,k,D,O,z,j,J,ae,F,X,P,le;o=a.state,c=a.next_in,P=a.input,f=c+(a.avail_in-5),h=a.next_out,le=a.output,p=h-(i-a.avail_out),x=h+(a.avail_out-257),g=o.dmax,v=o.wsize,y=o.whave,w=o.wnext,_=o.window,S=o.hold,E=o.bits,T=o.lencode,k=o.distcode,D=(1<<o.lenbits)-1,O=(1<<o.distbits)-1;e:do{E<15&&(S+=P[c++]<<E,E+=8,S+=P[c++]<<E,E+=8),z=T[S&D];t:for(;;){if(S>>>=j=z>>>24,E-=j,(j=z>>>16&255)===0)le[h++]=65535&z;else{if(!(16&j)){if((64&j)==0){z=T[(65535&z)+(S&(1<<j)-1)];continue t}if(32&j){o.mode=12;break e}a.msg="invalid literal/length code",o.mode=30;break e}J=65535&z,(j&=15)&&(E<j&&(S+=P[c++]<<E,E+=8),J+=S&(1<<j)-1,S>>>=j,E-=j),E<15&&(S+=P[c++]<<E,E+=8,S+=P[c++]<<E,E+=8),z=k[S&O];r:for(;;){if(S>>>=j=z>>>24,E-=j,!(16&(j=z>>>16&255))){if((64&j)==0){z=k[(65535&z)+(S&(1<<j)-1)];continue r}a.msg="invalid distance code",o.mode=30;break e}if(ae=65535&z,E<(j&=15)&&(S+=P[c++]<<E,(E+=8)<j&&(S+=P[c++]<<E,E+=8)),g<(ae+=S&(1<<j)-1)){a.msg="invalid distance too far back",o.mode=30;break e}if(S>>>=j,E-=j,(j=h-p)<ae){if(y<(j=ae-j)&&o.sane){a.msg="invalid distance too far back",o.mode=30;break e}if(X=_,(F=0)===w){if(F+=v-j,j<J){for(J-=j;le[h++]=_[F++],--j;);F=h-ae,X=le}}else if(w<j){if(F+=v+w-j,(j-=w)<J){for(J-=j;le[h++]=_[F++],--j;);if(F=0,w<J){for(J-=j=w;le[h++]=_[F++],--j;);F=h-ae,X=le}}}else if(F+=w-j,j<J){for(J-=j;le[h++]=_[F++],--j;);F=h-ae,X=le}for(;2<J;)le[h++]=X[F++],le[h++]=X[F++],le[h++]=X[F++],J-=3;J&&(le[h++]=X[F++],1<J&&(le[h++]=X[F++]))}else{for(F=h-ae;le[h++]=le[F++],le[h++]=le[F++],le[h++]=le[F++],2<(J-=3););J&&(le[h++]=le[F++],1<J&&(le[h++]=le[F++]))}break}}break}}while(c<f&&h<x);c-=J=E>>3,S&=(1<<(E-=J<<3))-1,a.next_in=c,a.next_out=h,a.avail_in=c<f?f-c+5:5-(c-f),a.avail_out=h<x?x-h+257:257-(h-x),o.hold=S,o.bits=E}},{}],49:[function(r,n,s){var a=r("../utils/common"),i=r("./adler32"),o=r("./crc32"),c=r("./inffast"),f=r("./inftrees"),h=1,p=2,x=0,g=-2,v=1,y=852,w=592;function _(F){return(F>>>24&255)+(F>>>8&65280)+((65280&F)<<8)+((255&F)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(F){var X;return F&&F.state?(X=F.state,F.total_in=F.total_out=X.total=0,F.msg="",X.wrap&&(F.adler=1&X.wrap),X.mode=v,X.last=0,X.havedict=0,X.dmax=32768,X.head=null,X.hold=0,X.bits=0,X.lencode=X.lendyn=new a.Buf32(y),X.distcode=X.distdyn=new a.Buf32(w),X.sane=1,X.back=-1,x):g}function T(F){var X;return F&&F.state?((X=F.state).wsize=0,X.whave=0,X.wnext=0,E(F)):g}function k(F,X){var P,le;return F&&F.state?(le=F.state,X<0?(P=0,X=-X):(P=1+(X>>4),X<48&&(X&=15)),X&&(X<8||15<X)?g:(le.window!==null&&le.wbits!==X&&(le.window=null),le.wrap=P,le.wbits=X,T(F))):g}function D(F,X){var P,le;return F?(le=new S,(F.state=le).window=null,(P=k(F,X))!==x&&(F.state=null),P):g}var O,z,j=!0;function J(F){if(j){var X;for(O=new a.Buf32(512),z=new a.Buf32(32),X=0;X<144;)F.lens[X++]=8;for(;X<256;)F.lens[X++]=9;for(;X<280;)F.lens[X++]=7;for(;X<288;)F.lens[X++]=8;for(f(h,F.lens,0,288,O,0,F.work,{bits:9}),X=0;X<32;)F.lens[X++]=5;f(p,F.lens,0,32,z,0,F.work,{bits:5}),j=!1}F.lencode=O,F.lenbits=9,F.distcode=z,F.distbits=5}function ae(F,X,P,le){var ee,te=F.state;return te.window===null&&(te.wsize=1<<te.wbits,te.wnext=0,te.whave=0,te.window=new a.Buf8(te.wsize)),le>=te.wsize?(a.arraySet(te.window,X,P-te.wsize,te.wsize,0),te.wnext=0,te.whave=te.wsize):(le<(ee=te.wsize-te.wnext)&&(ee=le),a.arraySet(te.window,X,P-le,ee,te.wnext),(le-=ee)?(a.arraySet(te.window,X,P-le,le,0),te.wnext=le,te.whave=te.wsize):(te.wnext+=ee,te.wnext===te.wsize&&(te.wnext=0),te.whave<te.wsize&&(te.whave+=ee))),0}s.inflateReset=T,s.inflateReset2=k,s.inflateResetKeep=E,s.inflateInit=function(F){return D(F,15)},s.inflateInit2=D,s.inflate=function(F,X){var P,le,ee,te,me,ie,Ee,K,M,q,G,Z,re,L,I,se,Q,Y,U,we,B,be,V,C,A=0,H=new a.Buf8(4),ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return g;(P=F.state).mode===12&&(P.mode=13),me=F.next_out,ee=F.output,Ee=F.avail_out,te=F.next_in,le=F.input,ie=F.avail_in,K=P.hold,M=P.bits,q=ie,G=Ee,be=x;e:for(;;)switch(P.mode){case v:if(P.wrap===0){P.mode=13;break}for(;M<16;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if(2&P.wrap&&K===35615){H[P.check=0]=255&K,H[1]=K>>>8&255,P.check=o(P.check,H,2,0),M=K=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&K)<<8)+(K>>8))%31){F.msg="incorrect header check",P.mode=30;break}if((15&K)!=8){F.msg="unknown compression method",P.mode=30;break}if(M-=4,B=8+(15&(K>>>=4)),P.wbits===0)P.wbits=B;else if(B>P.wbits){F.msg="invalid window size",P.mode=30;break}P.dmax=1<<B,F.adler=P.check=1,P.mode=512&K?10:12,M=K=0;break;case 2:for(;M<16;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if(P.flags=K,(255&P.flags)!=8){F.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){F.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=K>>8&1),512&P.flags&&(H[0]=255&K,H[1]=K>>>8&255,P.check=o(P.check,H,2,0)),M=K=0,P.mode=3;case 3:for(;M<32;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}P.head&&(P.head.time=K),512&P.flags&&(H[0]=255&K,H[1]=K>>>8&255,H[2]=K>>>16&255,H[3]=K>>>24&255,P.check=o(P.check,H,4,0)),M=K=0,P.mode=4;case 4:for(;M<16;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}P.head&&(P.head.xflags=255&K,P.head.os=K>>8),512&P.flags&&(H[0]=255&K,H[1]=K>>>8&255,P.check=o(P.check,H,2,0)),M=K=0,P.mode=5;case 5:if(1024&P.flags){for(;M<16;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}P.length=K,P.head&&(P.head.extra_len=K),512&P.flags&&(H[0]=255&K,H[1]=K>>>8&255,P.check=o(P.check,H,2,0)),M=K=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(ie<(Z=P.length)&&(Z=ie),Z&&(P.head&&(B=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),a.arraySet(P.head.extra,le,te,Z,B)),512&P.flags&&(P.check=o(P.check,le,Z,te)),ie-=Z,te+=Z,P.length-=Z),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(ie===0)break e;for(Z=0;B=le[te+Z++],P.head&&B&&P.length<65536&&(P.head.name+=String.fromCharCode(B)),B&&Z<ie;);if(512&P.flags&&(P.check=o(P.check,le,Z,te)),ie-=Z,te+=Z,B)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(ie===0)break e;for(Z=0;B=le[te+Z++],P.head&&B&&P.length<65536&&(P.head.comment+=String.fromCharCode(B)),B&&Z<ie;);if(512&P.flags&&(P.check=o(P.check,le,Z,te)),ie-=Z,te+=Z,B)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;M<16;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if(K!==(65535&P.check)){F.msg="header crc mismatch",P.mode=30;break}M=K=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),F.adler=P.check=0,P.mode=12;break;case 10:for(;M<32;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}F.adler=P.check=_(K),M=K=0,P.mode=11;case 11:if(P.havedict===0)return F.next_out=me,F.avail_out=Ee,F.next_in=te,F.avail_in=ie,P.hold=K,P.bits=M,2;F.adler=P.check=1,P.mode=12;case 12:if(X===5||X===6)break e;case 13:if(P.last){K>>>=7&M,M-=7&M,P.mode=27;break}for(;M<3;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}switch(P.last=1&K,M-=1,3&(K>>>=1)){case 0:P.mode=14;break;case 1:if(J(P),P.mode=20,X!==6)break;K>>>=2,M-=2;break e;case 2:P.mode=17;break;case 3:F.msg="invalid block type",P.mode=30}K>>>=2,M-=2;break;case 14:for(K>>>=7&M,M-=7&M;M<32;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if((65535&K)!=(K>>>16^65535)){F.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&K,M=K=0,P.mode=15,X===6)break e;case 15:P.mode=16;case 16:if(Z=P.length){if(ie<Z&&(Z=ie),Ee<Z&&(Z=Ee),Z===0)break e;a.arraySet(ee,le,te,Z,me),ie-=Z,te+=Z,Ee-=Z,me+=Z,P.length-=Z;break}P.mode=12;break;case 17:for(;M<14;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if(P.nlen=257+(31&K),K>>>=5,M-=5,P.ndist=1+(31&K),K>>>=5,M-=5,P.ncode=4+(15&K),K>>>=4,M-=4,286<P.nlen||30<P.ndist){F.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;M<3;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}P.lens[ue[P.have++]]=7&K,K>>>=3,M-=3}for(;P.have<19;)P.lens[ue[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,V={bits:P.lenbits},be=f(0,P.lens,0,19,P.lencode,0,P.work,V),P.lenbits=V.bits,be){F.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;se=(A=P.lencode[K&(1<<P.lenbits)-1])>>>16&255,Q=65535&A,!((I=A>>>24)<=M);){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if(Q<16)K>>>=I,M-=I,P.lens[P.have++]=Q;else{if(Q===16){for(C=I+2;M<C;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if(K>>>=I,M-=I,P.have===0){F.msg="invalid bit length repeat",P.mode=30;break}B=P.lens[P.have-1],Z=3+(3&K),K>>>=2,M-=2}else if(Q===17){for(C=I+3;M<C;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}M-=I,B=0,Z=3+(7&(K>>>=I)),K>>>=3,M-=3}else{for(C=I+7;M<C;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}M-=I,B=0,Z=11+(127&(K>>>=I)),K>>>=7,M-=7}if(P.have+Z>P.nlen+P.ndist){F.msg="invalid bit length repeat",P.mode=30;break}for(;Z--;)P.lens[P.have++]=B}}if(P.mode===30)break;if(P.lens[256]===0){F.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,V={bits:P.lenbits},be=f(h,P.lens,0,P.nlen,P.lencode,0,P.work,V),P.lenbits=V.bits,be){F.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,V={bits:P.distbits},be=f(p,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,V),P.distbits=V.bits,be){F.msg="invalid distances set",P.mode=30;break}if(P.mode=20,X===6)break e;case 20:P.mode=21;case 21:if(6<=ie&&258<=Ee){F.next_out=me,F.avail_out=Ee,F.next_in=te,F.avail_in=ie,P.hold=K,P.bits=M,c(F,G),me=F.next_out,ee=F.output,Ee=F.avail_out,te=F.next_in,le=F.input,ie=F.avail_in,K=P.hold,M=P.bits,P.mode===12&&(P.back=-1);break}for(P.back=0;se=(A=P.lencode[K&(1<<P.lenbits)-1])>>>16&255,Q=65535&A,!((I=A>>>24)<=M);){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if(se&&(240&se)==0){for(Y=I,U=se,we=Q;se=(A=P.lencode[we+((K&(1<<Y+U)-1)>>Y)])>>>16&255,Q=65535&A,!(Y+(I=A>>>24)<=M);){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}K>>>=Y,M-=Y,P.back+=Y}if(K>>>=I,M-=I,P.back+=I,P.length=Q,se===0){P.mode=26;break}if(32&se){P.back=-1,P.mode=12;break}if(64&se){F.msg="invalid literal/length code",P.mode=30;break}P.extra=15&se,P.mode=22;case 22:if(P.extra){for(C=P.extra;M<C;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}P.length+=K&(1<<P.extra)-1,K>>>=P.extra,M-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;se=(A=P.distcode[K&(1<<P.distbits)-1])>>>16&255,Q=65535&A,!((I=A>>>24)<=M);){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if((240&se)==0){for(Y=I,U=se,we=Q;se=(A=P.distcode[we+((K&(1<<Y+U)-1)>>Y)])>>>16&255,Q=65535&A,!(Y+(I=A>>>24)<=M);){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}K>>>=Y,M-=Y,P.back+=Y}if(K>>>=I,M-=I,P.back+=I,64&se){F.msg="invalid distance code",P.mode=30;break}P.offset=Q,P.extra=15&se,P.mode=24;case 24:if(P.extra){for(C=P.extra;M<C;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}P.offset+=K&(1<<P.extra)-1,K>>>=P.extra,M-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){F.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(Ee===0)break e;if(Z=G-Ee,P.offset>Z){if((Z=P.offset-Z)>P.whave&&P.sane){F.msg="invalid distance too far back",P.mode=30;break}re=Z>P.wnext?(Z-=P.wnext,P.wsize-Z):P.wnext-Z,Z>P.length&&(Z=P.length),L=P.window}else L=ee,re=me-P.offset,Z=P.length;for(Ee<Z&&(Z=Ee),Ee-=Z,P.length-=Z;ee[me++]=L[re++],--Z;);P.length===0&&(P.mode=21);break;case 26:if(Ee===0)break e;ee[me++]=P.length,Ee--,P.mode=21;break;case 27:if(P.wrap){for(;M<32;){if(ie===0)break e;ie--,K|=le[te++]<<M,M+=8}if(G-=Ee,F.total_out+=G,P.total+=G,G&&(F.adler=P.check=P.flags?o(P.check,ee,G,me-G):i(P.check,ee,G,me-G)),G=Ee,(P.flags?K:_(K))!==P.check){F.msg="incorrect data check",P.mode=30;break}M=K=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;M<32;){if(ie===0)break e;ie--,K+=le[te++]<<M,M+=8}if(K!==(4294967295&P.total)){F.msg="incorrect length check",P.mode=30;break}M=K=0}P.mode=29;case 29:be=1;break e;case 30:be=-3;break e;case 31:return-4;case 32:default:return g}return F.next_out=me,F.avail_out=Ee,F.next_in=te,F.avail_in=ie,P.hold=K,P.bits=M,(P.wsize||G!==F.avail_out&&P.mode<30&&(P.mode<27||X!==4))&&ae(F,F.output,F.next_out,G-F.avail_out)?(P.mode=31,-4):(q-=F.avail_in,G-=F.avail_out,F.total_in+=q,F.total_out+=G,P.total+=G,P.wrap&&G&&(F.adler=P.check=P.flags?o(P.check,ee,G,F.next_out-G):i(P.check,ee,G,F.next_out-G)),F.data_type=P.bits+(P.last?64:0)+(P.mode===12?128:0)+(P.mode===20||P.mode===15?256:0),(q==0&&G===0||X===4)&&be===x&&(be=-5),be)},s.inflateEnd=function(F){if(!F||!F.state)return g;var X=F.state;return X.window&&(X.window=null),F.state=null,x},s.inflateGetHeader=function(F,X){var P;return F&&F.state?(2&(P=F.state).wrap)==0?g:((P.head=X).done=!1,x):g},s.inflateSetDictionary=function(F,X){var P,le=X.length;return F&&F.state?(P=F.state).wrap!==0&&P.mode!==11?g:P.mode===11&&i(1,X,le,0)!==P.check?-3:ae(F,X,le,le)?(P.mode=31,-4):(P.havedict=1,x):g},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,s){var a=r("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(h,p,x,g,v,y,w,_){var S,E,T,k,D,O,z,j,J,ae=_.bits,F=0,X=0,P=0,le=0,ee=0,te=0,me=0,ie=0,Ee=0,K=0,M=null,q=0,G=new a.Buf16(16),Z=new a.Buf16(16),re=null,L=0;for(F=0;F<=15;F++)G[F]=0;for(X=0;X<g;X++)G[p[x+X]]++;for(ee=ae,le=15;1<=le&&G[le]===0;le--);if(le<ee&&(ee=le),le===0)return v[y++]=20971520,v[y++]=20971520,_.bits=1,0;for(P=1;P<le&&G[P]===0;P++);for(ee<P&&(ee=P),F=ie=1;F<=15;F++)if(ie<<=1,(ie-=G[F])<0)return-1;if(0<ie&&(h===0||le!==1))return-1;for(Z[1]=0,F=1;F<15;F++)Z[F+1]=Z[F]+G[F];for(X=0;X<g;X++)p[x+X]!==0&&(w[Z[p[x+X]]++]=X);if(O=h===0?(M=re=w,19):h===1?(M=i,q-=257,re=o,L-=257,256):(M=c,re=f,-1),F=P,D=y,me=X=K=0,T=-1,k=(Ee=1<<(te=ee))-1,h===1&&852<Ee||h===2&&592<Ee)return 1;for(;;){for(z=F-me,J=w[X]<O?(j=0,w[X]):w[X]>O?(j=re[L+w[X]],M[q+w[X]]):(j=96,0),S=1<<F-me,P=E=1<<te;v[D+(K>>me)+(E-=S)]=z<<24|j<<16|J|0,E!==0;);for(S=1<<F-1;K&S;)S>>=1;if(S!==0?(K&=S-1,K+=S):K=0,X++,--G[F]==0){if(F===le)break;F=p[x+w[X]]}if(ee<F&&(K&k)!==T){for(me===0&&(me=ee),D+=P,ie=1<<(te=F-me);te+me<le&&!((ie-=G[te+me])<=0);)te++,ie<<=1;if(Ee+=1<<te,h===1&&852<Ee||h===2&&592<Ee)return 1;v[T=K&k]=ee<<24|te<<16|D-y|0}}return K!==0&&(v[D+K]=F-me<<24|64<<16|0),_.bits=ee,0}},{"../utils/common":41}],51:[function(r,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,s){var a=r("../utils/common"),i=0,o=1;function c(A){for(var H=A.length;0<=--H;)A[H]=0}var f=0,h=29,p=256,x=p+1+h,g=30,v=19,y=2*x+1,w=15,_=16,S=7,E=256,T=16,k=17,D=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=new Array(2*(x+2));c(ae);var F=new Array(2*g);c(F);var X=new Array(512);c(X);var P=new Array(256);c(P);var le=new Array(h);c(le);var ee,te,me,ie=new Array(g);function Ee(A,H,ue,ye,he){this.static_tree=A,this.extra_bits=H,this.extra_base=ue,this.elems=ye,this.max_length=he,this.has_stree=A&&A.length}function K(A,H){this.dyn_tree=A,this.max_code=0,this.stat_desc=H}function M(A){return A<256?X[A]:X[256+(A>>>7)]}function q(A,H){A.pending_buf[A.pending++]=255&H,A.pending_buf[A.pending++]=H>>>8&255}function G(A,H,ue){A.bi_valid>_-ue?(A.bi_buf|=H<<A.bi_valid&65535,q(A,A.bi_buf),A.bi_buf=H>>_-A.bi_valid,A.bi_valid+=ue-_):(A.bi_buf|=H<<A.bi_valid&65535,A.bi_valid+=ue)}function Z(A,H,ue){G(A,ue[2*H],ue[2*H+1])}function re(A,H){for(var ue=0;ue|=1&A,A>>>=1,ue<<=1,0<--H;);return ue>>>1}function L(A,H,ue){var ye,he,ke=new Array(w+1),De=0;for(ye=1;ye<=w;ye++)ke[ye]=De=De+ue[ye-1]<<1;for(he=0;he<=H;he++){var Fe=A[2*he+1];Fe!==0&&(A[2*he]=re(ke[Fe]++,Fe))}}function I(A){var H;for(H=0;H<x;H++)A.dyn_ltree[2*H]=0;for(H=0;H<g;H++)A.dyn_dtree[2*H]=0;for(H=0;H<v;H++)A.bl_tree[2*H]=0;A.dyn_ltree[2*E]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function se(A){8<A.bi_valid?q(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function Q(A,H,ue,ye){var he=2*H,ke=2*ue;return A[he]<A[ke]||A[he]===A[ke]&&ye[H]<=ye[ue]}function Y(A,H,ue){for(var ye=A.heap[ue],he=ue<<1;he<=A.heap_len&&(he<A.heap_len&&Q(H,A.heap[he+1],A.heap[he],A.depth)&&he++,!Q(H,ye,A.heap[he],A.depth));)A.heap[ue]=A.heap[he],ue=he,he<<=1;A.heap[ue]=ye}function U(A,H,ue){var ye,he,ke,De,Fe=0;if(A.last_lit!==0)for(;ye=A.pending_buf[A.d_buf+2*Fe]<<8|A.pending_buf[A.d_buf+2*Fe+1],he=A.pending_buf[A.l_buf+Fe],Fe++,ye===0?Z(A,he,H):(Z(A,(ke=P[he])+p+1,H),(De=O[ke])!==0&&G(A,he-=le[ke],De),Z(A,ke=M(--ye),ue),(De=z[ke])!==0&&G(A,ye-=ie[ke],De)),Fe<A.last_lit;);Z(A,E,H)}function we(A,H){var ue,ye,he,ke=H.dyn_tree,De=H.stat_desc.static_tree,Fe=H.stat_desc.has_stree,$e=H.stat_desc.elems,rt=-1;for(A.heap_len=0,A.heap_max=y,ue=0;ue<$e;ue++)ke[2*ue]!==0?(A.heap[++A.heap_len]=rt=ue,A.depth[ue]=0):ke[2*ue+1]=0;for(;A.heap_len<2;)ke[2*(he=A.heap[++A.heap_len]=rt<2?++rt:0)]=1,A.depth[he]=0,A.opt_len--,Fe&&(A.static_len-=De[2*he+1]);for(H.max_code=rt,ue=A.heap_len>>1;1<=ue;ue--)Y(A,ke,ue);for(he=$e;ue=A.heap[1],A.heap[1]=A.heap[A.heap_len--],Y(A,ke,1),ye=A.heap[1],A.heap[--A.heap_max]=ue,A.heap[--A.heap_max]=ye,ke[2*he]=ke[2*ue]+ke[2*ye],A.depth[he]=(A.depth[ue]>=A.depth[ye]?A.depth[ue]:A.depth[ye])+1,ke[2*ue+1]=ke[2*ye+1]=he,A.heap[1]=he++,Y(A,ke,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1],(function(at,qt){var dt,Bt,hr,vt,ir,Nn,or=qt.dyn_tree,Vo=qt.max_code,pi=qt.stat_desc.static_tree,xs=qt.stat_desc.has_stree,Ga=qt.stat_desc.extra_bits,Ka=qt.stat_desc.extra_base,gs=qt.stat_desc.max_length,nn=0;for(vt=0;vt<=w;vt++)at.bl_count[vt]=0;for(or[2*at.heap[at.heap_max]+1]=0,dt=at.heap_max+1;dt<y;dt++)gs<(vt=or[2*or[2*(Bt=at.heap[dt])+1]+1]+1)&&(vt=gs,nn++),or[2*Bt+1]=vt,Vo<Bt||(at.bl_count[vt]++,ir=0,Ka<=Bt&&(ir=Ga[Bt-Ka]),Nn=or[2*Bt],at.opt_len+=Nn*(vt+ir),xs&&(at.static_len+=Nn*(pi[2*Bt+1]+ir)));if(nn!==0){do{for(vt=gs-1;at.bl_count[vt]===0;)vt--;at.bl_count[vt]--,at.bl_count[vt+1]+=2,at.bl_count[gs]--,nn-=2}while(0<nn);for(vt=gs;vt!==0;vt--)for(Bt=at.bl_count[vt];Bt!==0;)Vo<(hr=at.heap[--dt])||(or[2*hr+1]!==vt&&(at.opt_len+=(vt-or[2*hr+1])*or[2*hr],or[2*hr+1]=vt),Bt--)}})(A,H),L(ke,rt,A.bl_count)}function B(A,H,ue){var ye,he,ke=-1,De=H[1],Fe=0,$e=7,rt=4;for(De===0&&($e=138,rt=3),H[2*(ue+1)+1]=65535,ye=0;ye<=ue;ye++)he=De,De=H[2*(ye+1)+1],++Fe<$e&&he===De||(Fe<rt?A.bl_tree[2*he]+=Fe:he!==0?(he!==ke&&A.bl_tree[2*he]++,A.bl_tree[2*T]++):Fe<=10?A.bl_tree[2*k]++:A.bl_tree[2*D]++,ke=he,rt=(Fe=0)===De?($e=138,3):he===De?($e=6,3):($e=7,4))}function be(A,H,ue){var ye,he,ke=-1,De=H[1],Fe=0,$e=7,rt=4;for(De===0&&($e=138,rt=3),ye=0;ye<=ue;ye++)if(he=De,De=H[2*(ye+1)+1],!(++Fe<$e&&he===De)){if(Fe<rt)for(;Z(A,he,A.bl_tree),--Fe!=0;);else he!==0?(he!==ke&&(Z(A,he,A.bl_tree),Fe--),Z(A,T,A.bl_tree),G(A,Fe-3,2)):Fe<=10?(Z(A,k,A.bl_tree),G(A,Fe-3,3)):(Z(A,D,A.bl_tree),G(A,Fe-11,7));ke=he,rt=(Fe=0)===De?($e=138,3):he===De?($e=6,3):($e=7,4)}}c(ie);var V=!1;function C(A,H,ue,ye){G(A,(f<<1)+(ye?1:0),3),(function(he,ke,De,Fe){se(he),q(he,De),q(he,~De),a.arraySet(he.pending_buf,he.window,ke,De,he.pending),he.pending+=De})(A,H,ue)}s._tr_init=function(A){V||((function(){var H,ue,ye,he,ke,De=new Array(w+1);for(he=ye=0;he<h-1;he++)for(le[he]=ye,H=0;H<1<<O[he];H++)P[ye++]=he;for(P[ye-1]=he,he=ke=0;he<16;he++)for(ie[he]=ke,H=0;H<1<<z[he];H++)X[ke++]=he;for(ke>>=7;he<g;he++)for(ie[he]=ke<<7,H=0;H<1<<z[he]-7;H++)X[256+ke++]=he;for(ue=0;ue<=w;ue++)De[ue]=0;for(H=0;H<=143;)ae[2*H+1]=8,H++,De[8]++;for(;H<=255;)ae[2*H+1]=9,H++,De[9]++;for(;H<=279;)ae[2*H+1]=7,H++,De[7]++;for(;H<=287;)ae[2*H+1]=8,H++,De[8]++;for(L(ae,x+1,De),H=0;H<g;H++)F[2*H+1]=5,F[2*H]=re(H,5);ee=new Ee(ae,O,p+1,x,w),te=new Ee(F,z,0,g,w),me=new Ee(new Array(0),j,0,v,S)})(),V=!0),A.l_desc=new K(A.dyn_ltree,ee),A.d_desc=new K(A.dyn_dtree,te),A.bl_desc=new K(A.bl_tree,me),A.bi_buf=0,A.bi_valid=0,I(A)},s._tr_stored_block=C,s._tr_flush_block=function(A,H,ue,ye){var he,ke,De=0;0<A.level?(A.strm.data_type===2&&(A.strm.data_type=(function(Fe){var $e,rt=4093624447;for($e=0;$e<=31;$e++,rt>>>=1)if(1&rt&&Fe.dyn_ltree[2*$e]!==0)return i;if(Fe.dyn_ltree[18]!==0||Fe.dyn_ltree[20]!==0||Fe.dyn_ltree[26]!==0)return o;for($e=32;$e<p;$e++)if(Fe.dyn_ltree[2*$e]!==0)return o;return i})(A)),we(A,A.l_desc),we(A,A.d_desc),De=(function(Fe){var $e;for(B(Fe,Fe.dyn_ltree,Fe.l_desc.max_code),B(Fe,Fe.dyn_dtree,Fe.d_desc.max_code),we(Fe,Fe.bl_desc),$e=v-1;3<=$e&&Fe.bl_tree[2*J[$e]+1]===0;$e--);return Fe.opt_len+=3*($e+1)+5+5+4,$e})(A),he=A.opt_len+3+7>>>3,(ke=A.static_len+3+7>>>3)<=he&&(he=ke)):he=ke=ue+5,ue+4<=he&&H!==-1?C(A,H,ue,ye):A.strategy===4||ke===he?(G(A,2+(ye?1:0),3),U(A,ae,F)):(G(A,4+(ye?1:0),3),(function(Fe,$e,rt,at){var qt;for(G(Fe,$e-257,5),G(Fe,rt-1,5),G(Fe,at-4,4),qt=0;qt<at;qt++)G(Fe,Fe.bl_tree[2*J[qt]+1],3);be(Fe,Fe.dyn_ltree,$e-1),be(Fe,Fe.dyn_dtree,rt-1)})(A,A.l_desc.max_code+1,A.d_desc.max_code+1,De+1),U(A,A.dyn_ltree,A.dyn_dtree)),I(A),ye&&se(A)},s._tr_tally=function(A,H,ue){return A.pending_buf[A.d_buf+2*A.last_lit]=H>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&H,A.pending_buf[A.l_buf+A.last_lit]=255&ue,A.last_lit++,H===0?A.dyn_ltree[2*ue]++:(A.matches++,H--,A.dyn_ltree[2*(P[ue]+p+1)]++,A.dyn_dtree[2*M(H)]++),A.last_lit===A.lit_bufsize-1},s._tr_align=function(A){G(A,2,3),Z(A,E,ae),(function(H){H.bi_valid===16?(q(H,H.bi_buf),H.bi_buf=0,H.bi_valid=0):8<=H.bi_valid&&(H.pending_buf[H.pending++]=255&H.bi_buf,H.bi_buf>>=8,H.bi_valid-=8)})(A)}},{"../utils/common":41}],53:[function(r,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,s){(function(a){(function(i,o){if(!i.setImmediate){var c,f,h,p,x=1,g={},v=!1,y=i.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(i);w=w&&w.setTimeout?w:i,c={}.toString.call(i.process)==="[object process]"?function(T){Mt.nextTick(function(){S(T)})}:(function(){if(i.postMessage&&!i.importScripts){var T=!0,k=i.onmessage;return i.onmessage=function(){T=!1},i.postMessage("","*"),i.onmessage=k,T}})()?(p="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",E,!1):i.attachEvent("onmessage",E),function(T){i.postMessage(p+T,"*")}):i.MessageChannel?((h=new MessageChannel).port1.onmessage=function(T){S(T.data)},function(T){h.port2.postMessage(T)}):y&&"onreadystatechange"in y.createElement("script")?(f=y.documentElement,function(T){var k=y.createElement("script");k.onreadystatechange=function(){S(T),k.onreadystatechange=null,f.removeChild(k),k=null},f.appendChild(k)}):function(T){setTimeout(S,0,T)},w.setImmediate=function(T){typeof T!="function"&&(T=new Function(""+T));for(var k=new Array(arguments.length-1),D=0;D<k.length;D++)k[D]=arguments[D+1];var O={callback:T,args:k};return g[x]=O,c(x),x++},w.clearImmediate=_}function _(T){delete g[T]}function S(T){if(v)setTimeout(S,0,T);else{var k=g[T];if(k){v=!0;try{(function(D){var O=D.callback,z=D.args;switch(z.length){case 0:O();break;case 1:O(z[0]);break;case 2:O(z[0],z[1]);break;case 3:O(z[0],z[1],z[2]);break;default:O.apply(o,z)}})(k)}finally{_(T),v=!1}}}}function E(T){T.source===i&&typeof T.data=="string"&&T.data.indexOf(p)===0&&S(+T.data.slice(p.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof Fi<"u"?Fi:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(a_)),a_.exports}var lwe=owe();const cwe=CN(lwe);var Eh={exports:{}},i_,Ej;function uwe(){if(Ej)return i_;Ej=1;var e={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function t(r){return r&&r.replace?r.replace(/([&"<>'])/g,function(n,s){return e[s]}):r}return i_=t,i_}var Sj;function fwe(){if(Sj)return Eh.exports;Sj=1;var e=uwe(),t=MN().Stream,r="    ";function n(f,h){typeof h!="object"&&(h={indent:h});var p=h.stream?new t:null,x="",g=!1,v=h.indent?h.indent===!0?r:h.indent:"",y=!0;function w(k){y?Mt.nextTick(k):k()}function _(k,D){if(D!==void 0&&(x+=D),k&&!g&&(p=p||new t,g=!0),k&&g){var O=x;w(function(){p.emit("data",O)}),x=""}}function S(k,D){o(_,i(k,v,v?1:0),D)}function E(){if(p){var k=x;w(function(){p.emit("data",k),p.emit("end"),p.readable=!1,p.emit("close")})}}function T(k){var D=k.encoding||"UTF-8",O={version:"1.0",encoding:D};k.standalone&&(O.standalone=k.standalone),S({"?xml":{_attr:O}}),x=x.replace("/>","?>")}return w(function(){y=!1}),h.declaration&&T(h.declaration),f&&f.forEach?f.forEach(function(k,D){var O;D+1===f.length&&(O=E),S(k,O)}):S(f,E),p?(p.readable=!0,p):x}function s(){var f=Array.prototype.slice.call(arguments),h={_elem:i(f)};return h.push=function(p){if(!this.append)throw new Error("not assigned to a parent!");var x=this,g=this._elem.indent;o(this.append,i(p,g,this._elem.icount+(g?1:0)),function(){x.append(!0)})},h.close=function(p){p!==void 0&&this.push(p),this.end&&this.end()},h}function a(f,h){return new Array(h||0).join(f||"")}function i(f,h,p){p=p||0;var x=a(h,p),g,v=f,y=!1;if(typeof f=="object"){var w=Object.keys(f);if(g=w[0],v=f[g],v&&v._elem)return v._elem.name=g,v._elem.icount=p,v._elem.indent=h,v._elem.indents=x,v._elem.interrupt=v,v._elem}var _=[],S=[],E;function T(k){var D=Object.keys(k);D.forEach(function(O){_.push(c(O,k[O]))})}switch(typeof v){case"object":if(v===null)break;v._attr&&T(v._attr),v._cdata&&S.push(("<![CDATA["+v._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),v.forEach&&(E=!1,S.push(""),v.forEach(function(k){if(typeof k=="object"){var D=Object.keys(k)[0];D=="_attr"?T(k._attr):S.push(i(k,h,p+1))}else S.pop(),E=!0,S.push(e(k))}),E||S.push(""));break;default:S.push(e(v))}return{name:g,interrupt:y,attributes:_,content:S,icount:p,indents:x,indent:h}}function o(f,h,p){if(typeof h!="object")return f(!1,h);var x=h.interrupt?1:h.content.length;function g(){for(;h.content.length;){var y=h.content.shift();if(y!==void 0){if(v(y))return;o(f,y)}}f(!1,(x>1?h.indents:"")+(h.name?"</"+h.name+">":"")+(h.indent&&!p?`
`:"")),p&&p()}function v(y){return y.interrupt?(y.interrupt.append=f,y.interrupt.end=g,y.interrupt=!1,f(!0),!0):!1}if(f(!1,h.indents+(h.name?"<"+h.name:"")+(h.attributes.length?" "+h.attributes.join(" "):"")+(x?h.name?">":"":h.name?"/>":"")+(h.indent&&x>1?`
`:"")),!x)return f(!1,h.indent?`
`:"");v(h)||g()}function c(f,h){return f+'="'+e(h)+'"'}return Eh.exports=n,Eh.exports.element=Eh.exports.Element=s,Eh.exports}var dwe=fwe();const Ur=CN(dwe),Sh=0,o_=32,hwe=32,pwe=(e,t)=>{const r=t.replace(/-/g,"");if(r.length!==hwe)throw new Error(`Error: Cannot extract GUID from font filename: ${t}`);const s=r.replace(/(..)/g,"$1 ").trim().split(" ").map(c=>parseInt(c,16));s.reverse();const i=e.slice(Sh,o_).map((c,f)=>c^s[f%s.length]),o=new Uint8Array(Sh+i.length+Math.max(0,e.length-o_));return o.set(e.slice(0,Sh)),o.set(i,Sh),o.set(e.slice(o_),Sh+i.length),o};class mwe{format(t,r={stack:[]}){const n=t.prepForXml(r);if(n)return n;throw Error("XMLComponent did not format correctly")}}class xwe{replace(t,r,n){let s=t;return r.forEach((a,i)=>{s=s.replace(new RegExp(`{${a.fileName}}`,"g"),(n+i).toString())}),s}getMediaData(t,r){return r.Array.filter(n=>t.search(`{${n.fileName}}`)>0)}}class gwe{replace(t,r){let n=t;for(const s of r)n=n.replace(new RegExp(`{${s.reference}-${s.instance}}`,"g"),s.numId.toString());return n}}class ywe{constructor(){Pe(this,"formatter"),Pe(this,"imageReplacer"),Pe(this,"numberingReplacer"),this.formatter=new mwe,this.imageReplacer=new xwe,this.numberingReplacer=new gwe}compile(t,r,n=[]){const s=new cwe,a=this.xmlifyFile(t,r),i=new Map(Object.entries(a));for(const[,o]of i)if(Array.isArray(o))for(const c of o)s.file(c.path,c.data);else s.file(o.path,o.data);for(const o of n)s.file(o.path,o.data);for(const o of t.Media.Array)o.type!=="svg"?s.file(`word/media/${o.fileName}`,o.data):(s.file(`word/media/${o.fileName}`,o.data),s.file(`word/media/${o.fallback.fileName}`,o.fallback.data));for(const{data:o,name:c,fontKey:f}of t.FontTable.fontOptionsWithKey){const[h]=c.split(".");s.file(`word/fonts/${h}.odttf`,pwe(o,f))}return s}xmlifyFile(t,r){const n=t.Document.Relationships.RelationshipCount+1,s=Ur(this.formatter.format(t.Document.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),a=t.Comments.Relationships.RelationshipCount+1,i=Ur(this.formatter.format(t.Comments,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=this.imageReplacer.getMediaData(s,t.Media),c=this.imageReplacer.getMediaData(i,t.Media);return{Relationships:{data:(o.forEach((f,h)=>{t.Document.Relationships.createRelationship(n+h,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${f.fileName}`)}),t.Document.Relationships.createRelationship(t.Document.Relationships.RelationshipCount+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable","fontTable.xml"),Ur(this.formatter.format(t.Document.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const f=this.imageReplacer.replace(s,o,n);return this.numberingReplacer.replace(f,t.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const f=Ur(this.formatter.format(t.Styles,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(f,t.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:Ur(this.formatter.format(t.CoreProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:Ur(this.formatter.format(t.Numbering,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:Ur(this.formatter.format(t.FileRelationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:t.Headers.map((f,h)=>{const p=Ur(this.formatter.format(f.View,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(p,t.Media).forEach((g,v)=>{f.Relationships.createRelationship(v,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${g.fileName}`)}),{data:Ur(this.formatter.format(f.Relationships,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${h+1}.xml.rels`}}),FooterRelationships:t.Footers.map((f,h)=>{const p=Ur(this.formatter.format(f.View,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(p,t.Media).forEach((g,v)=>{f.Relationships.createRelationship(v,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${g.fileName}`)}),{data:Ur(this.formatter.format(f.Relationships,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${h+1}.xml.rels`}}),Headers:t.Headers.map((f,h)=>{const p=Ur(this.formatter.format(f.View,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),x=this.imageReplacer.getMediaData(p,t.Media),g=this.imageReplacer.replace(p,x,0);return{data:this.numberingReplacer.replace(g,t.Numbering.ConcreteNumbering),path:`word/header${h+1}.xml`}}),Footers:t.Footers.map((f,h)=>{const p=Ur(this.formatter.format(f.View,{viewWrapper:f,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),x=this.imageReplacer.getMediaData(p,t.Media),g=this.imageReplacer.replace(p,x,0);return{data:this.numberingReplacer.replace(g,t.Numbering.ConcreteNumbering),path:`word/footer${h+1}.xml`}}),ContentTypes:{data:Ur(this.formatter.format(t.ContentTypes,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:Ur(this.formatter.format(t.CustomProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:Ur(this.formatter.format(t.AppProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:Ur(this.formatter.format(t.FootNotes.View,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:Ur(this.formatter.format(t.FootNotes.Relationships,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:Ur(this.formatter.format(t.Settings,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:(()=>{const f=this.imageReplacer.replace(i,c,a);return this.numberingReplacer.replace(f,t.Numbering.ConcreteNumbering)})(),path:"word/comments.xml"},CommentsRelationships:{data:(c.forEach((f,h)=>{t.Comments.Relationships.createRelationship(a+h,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${f.fileName}`)}),Ur(this.formatter.format(t.Comments.Relationships,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/comments.xml.rels"},FontTable:{data:Ur(this.formatter.format(t.FontTable.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:Ur(this.formatter.format(t.FontTable.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const vwe={WITH_2_BLANKS:"  "},Nj=e=>e===!0?vwe.WITH_2_BLANKS:e===!1?void 0:e,wB=class df{static pack(t,r,n){return $xe(this,arguments,function*(s,a,i,o=[]){return this.compiler.compile(s,Nj(i),o).generateAsync({type:a,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toString(t,r,n=[]){return df.pack(t,"string",r,n)}static toBuffer(t,r,n=[]){return df.pack(t,"nodebuffer",r,n)}static toBase64String(t,r,n=[]){return df.pack(t,"base64",r,n)}static toBlob(t,r,n=[]){return df.pack(t,"blob",r,n)}static toArrayBuffer(t,r,n=[]){return df.pack(t,"arraybuffer",r,n)}static toStream(t,r,n=[]){const s=new iwe.Stream;return this.compiler.compile(t,Nj(r),n).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(i=>{s.emit("data",i),s.emit("end")}),s}};Pe(wB,"compiler",new ywe);let bwe=wB;var Bx={exports:{}},wwe=Bx.exports,Tj;function _we(){return Tj||(Tj=1,(function(e,t){(function(r,n){n()})(wwe,function(){function r(f,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}function n(f,h,p){var x=new XMLHttpRequest;x.open("GET",f),x.responseType="blob",x.onload=function(){c(x.response,h,p)},x.onerror=function(){console.error("could not download file")},x.send()}function s(f){var h=new XMLHttpRequest;h.open("HEAD",f,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function a(f){try{f.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),f.dispatchEvent(h)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Rm=="object"&&Rm.global===Rm?Rm:void 0,o=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(f,h,p){var x=i.URL||i.webkitURL,g=document.createElement("a");h=h||f.name||"download",g.download=h,g.rel="noopener",typeof f=="string"?(g.href=f,g.origin===location.origin?a(g):s(g.href)?n(f,h,p):a(g,g.target="_blank")):(g.href=x.createObjectURL(f),setTimeout(function(){x.revokeObjectURL(g.href)},4e4),setTimeout(function(){a(g)},0))}:"msSaveOrOpenBlob"in navigator?function(f,h,p){if(h=h||f.name||"download",typeof f!="string")navigator.msSaveOrOpenBlob(r(f,p),h);else if(s(f))n(f,h,p);else{var x=document.createElement("a");x.href=f,x.target="_blank",setTimeout(function(){a(x)})}}:function(f,h,p,x){if(x=x||open("","_blank"),x&&(x.document.title=x.document.body.innerText="downloading..."),typeof f=="string")return n(f,h,p);var g=f.type==="application/octet-stream",v=/constructor/i.test(i.HTMLElement)||i.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||g&&v||o)&&typeof FileReader<"u"){var w=new FileReader;w.onloadend=function(){var E=w.result;E=y?E:E.replace(/^data:[^;]*;/,"data:attachment/file;"),x?x.location.href=E:location=E,x=null},w.readAsDataURL(f)}else{var _=i.URL||i.webkitURL,S=_.createObjectURL(f);x?x.location=S:location.href=S,x=null,setTimeout(function(){_.revokeObjectURL(S)},4e4)}});i.saveAs=c.saveAs=c,e.exports=c})})(Bx)),Bx.exports}var Ewe=_we();const Swe=async(e,t)=>{var i;const r=[];try{const c=await(await fetch(t.logoUrl)).arrayBuffer();r.push(new Dc({children:[new Uye({data:c,transformation:{width:120,height:60}})],alignment:ja.RIGHT}))}catch(o){console.error("Failed to load logo for DOCX",o)}const n=o=>{var c;if(o.type==="paragraph"){const f=(o.content||[]).map(h=>{var p,x,g;return h.type==="text"?new Sc({text:h.text,bold:(p=h.marks)==null?void 0:p.some(v=>v.type==="bold"),italics:(x=h.marks)==null?void 0:x.some(v=>v.type==="italic"),underline:(g=h.marks)!=null&&g.some(v=>v.type==="underline")?{}:void 0,font:"Times New Roman",size:24}):h.type==="hardBreak"?new Sc({break:1}):null}).filter(Boolean);r.push(new Dc({children:f,spacing:{after:240,line:360}}))}else if(o.type==="bulletList"||o.type==="orderedList")(c=o.content)==null||c.forEach(f=>{var h;f.type==="listItem"&&((h=f.content)==null||h.forEach(p=>{if(p.type==="paragraph"){const x=(p.content||[]).map(g=>{var v,y,w;return g.type==="text"?new Sc({text:g.text,bold:(v=g.marks)==null?void 0:v.some(_=>_.type==="bold"),italics:(y=g.marks)==null?void 0:y.some(_=>_.type==="italic"),underline:(w=g.marks)!=null&&w.some(_=>_.type==="underline")?{}:void 0,font:"Times New Roman",size:24}):g.type==="hardBreak"?new Sc({break:1}):null}).filter(Boolean);r.push(new Dc({children:x,bullet:o.type==="bulletList"?{level:0}:void 0,numbering:o.type==="orderedList"?{reference:"primary-numbering",level:0}:void 0,spacing:{after:120,line:360}}))}}))});else if(o.type==="heading"){const f=(o.content||[]).map(h=>h.type==="text"?new Sc({text:h.text,bold:!0,font:"Times New Roman",size:32-o.attrs.level*2}):null).filter(Boolean);r.push(new Dc({children:f,spacing:{before:240,after:120}}))}};(i=e.content)==null||i.forEach(n);const s=new awe({numbering:{config:[{reference:"primary-numbering",levels:[{level:0,format:"lowerLetter",text:"%1)",alignment:ja.LEFT}]}]},sections:[{children:r}]}),a=await bwe.toBlob(s);Ewe.saveAs(a,`${t.fileName}.docx`)},Nwe=()=>{const{documentConfig:e,formData:t,setCurrentStep:r,validationErrors:n,resetWorkflow:s}=HS(),a=ne.useRef(null),[i,o]=ne.useState(!1),[c,f]=ne.useState(!1),[h,p]=ne.useState(!1),[x,g]=ne.useState(!1),[v,y]=ne.useState(!1),[w,_]=ne.useState(null),[S,E]=ne.useState(""),[T,k]=ne.useState(!1),[D,O]=ne.useState(!1);We.useEffect(()=>{const F=setTimeout(()=>{a.current&&(E(a.current.innerHTML),k(!0))},100);return()=>clearTimeout(F)},[]);const z={bg:"#f5f7f9",fg:"#1b2531",muted:"#627383",border:"#d9e0e8",destructive:"#df3a3a",secondaryBg:"#f8fafc"};if(!e)return null;const j=n.length===0,J=async()=>{if(w){p(!0);try{await Swe(w,{logoUrl:"/logo.png",fileName:e.name}),y(!0)}catch(F){console.error("Download failed",F)}finally{p(!1)}}},ae=()=>{v?g(!0):J()};return d.jsxs("div",{className:"min-h-screen p-6 lg:p-10 animate-fade-in",style:{backgroundColor:z.bg},children:[d.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10 animate-slide-up",children:d.jsxs("div",{className:"space-y-1",children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight",style:{color:z.fg},children:"Document Preview"}),d.jsx("p",{className:"font-medium",style:{color:z.muted},children:"Review the generated content and field values before final export."})]})}),!j&&d.jsxs("div",{className:"flex items-center gap-4 p-4 mb-8 rounded-2xl border animate-slide-up",style:{backgroundColor:`${z.destructive}0D`,borderColor:`${z.destructive}40`},children:[d.jsx("div",{className:"p-2 rounded-xl bg-white shadow-sm",children:d.jsx(pD,{className:"w-5 h-5",style:{color:z.destructive},strokeWidth:2.5})}),d.jsx("span",{className:"text-sm font-bold",style:{color:z.fg},children:"Warning: Some required fields are missing or invalid. Please fix them before generating."})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start",children:[d.jsxs("div",{className:"lg:col-span-2 bg-white  shadow-sm border border-transparent overflow-hidden animate-slide-up",children:[d.jsx("div",{className:"px-6 py-5.5 border-b",style:{backgroundColor:z.secondaryBg,borderColor:z.border},children:d.jsx("h3",{className:"text-sm font-black uppercase tracking-widest",style:{color:z.muted},children:"Field Summary"})}),d.jsx("div",{className:"p-6 max-h-288.75 overflow-y-auto",children:d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.fields.map(F=>d.jsxs("div",{className:"group",children:[d.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest mb-1",style:{color:z.muted},children:F.label}),d.jsx("p",{className:"text-sm font-bold truncate",style:{color:z.fg},children:t[F.id]||d.jsx("span",{className:"opacity-30",children:""})}),d.jsx("div",{className:"h-px w-full mt-3",style:{backgroundColor:z.bg}})]},F.id))})})]}),d.jsxs("div",{className:"lg:col-span-3 bg-white shadow-sm border border-transparent overflow-hidden animate-slide-up",children:[d.jsxs("div",{className:"px-8 py-3 border-b flex items-center justify-between gap-3",style:{backgroundColor:z.secondaryBg,borderColor:z.border},children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Ul,{className:"w-5 h-5 text-[#3399cc]"}),d.jsx("h3",{className:"text-sm font-black uppercase tracking-widest",style:{color:z.muted},children:"Preview"})]}),d.jsx("button",{onClick:()=>O(!D),className:`flex items-center gap-2 px-5 py-2.5 rounded-xl transition-all active:scale-95 font-bold text-sm shadow-sm
            ${D?"btn-primary":"bg-white text-slate-600 border border-slate-300 hover:bg-slate-50 hover:text-slate-900"}`,children:D?d.jsxs(d.Fragment,{children:[d.jsx(la,{className:"w-4 h-4"}),"Done"]}):d.jsxs(d.Fragment,{children:[d.jsx(UX,{className:"w-4 h-4"}),"Edit"]})})]}),d.jsxs("div",{className:"p-0 relative",children:[!T&&d.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/50 backdrop-blur-sm",children:d.jsxs("div",{className:"flex flex-col items-center gap-3",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#24548f]"}),d.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Preparing Editor..."})]})}),d.jsx("div",{ref:a,className:"hidden",children:d.jsx($ce,{documentId:e.id,data:{...t,submissionDate:new Date().toLocaleDateString("en-US"),gsaOfficeCityStateZip:`${t.gsaOfficeCity||""}, ${t.gsaOfficeState||""}, ${t.gsaOfficeZip||""}`}})}),T&&S&&d.jsx(Uxe,{content:S,onChange:F=>_(F),editable:D})]})]})]}),d.jsxs("div",{className:"mt-10 flex items-center justify-between pb-10 animate-slide-up",children:[d.jsxs("button",{onClick:()=>r("form-entry"),className:"flex items-center gap-2 px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-600 text-sm font-bold transition-all hover:bg-slate-50 active:scale-95 shadow-sm hover:text-slate-900",children:[d.jsx(Jn,{className:"w-4 h-4",strokeWidth:3}),"Back to Form"]}),d.jsx("button",{onClick:()=>c?ae():o(!0),disabled:h||D,className:"btn-primary",children:h?"Processing...":d.jsxs(d.Fragment,{children:[d.jsx(Gx,{className:"w-4 h-4",strokeWidth:3}),"Download Cover Letter"]})})]}),i&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 ",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6 space-y-5 animate-in fade-in zoom-in",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(la,{className:"w-5 h-5 text-[#3399cc]"}),d.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Ready to generate ?"})]}),d.jsx("p",{className:"text-sm text-slate-600",children:"Please ensure all field values are accurate. This will finalize the formatting and download the document."}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[d.jsx("button",{className:"px-4 py-2 rounded-xl text-sm font-semibold text-slate-600 hover:bg-slate-100 transition-colors",onClick:()=>o(!1),children:"Cancel"}),d.jsx("button",{className:"px-4 py-2 rounded-xl text-sm font-semibold bg-[#3399cc] text-white hover:bg-[#287ab0] transition-colors",onClick:async()=>{o(!1),f(!0),await J()},children:"Confirm & Download"})]})]})}),x&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 ",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6 space-y-5 animate-in fade-in zoom-in",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Gx,{className:"w-6 h-6 text-amber-500"}),d.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Download Again?"})]}),d.jsx("p",{className:"text-sm text-slate-600",children:"You have already downloaded this document recently. Would you like to download a new copy?"}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[d.jsx("button",{className:"px-4 py-2 rounded-xl text-sm font-semibold text-slate-600 hover:bg-slate-100 transition-colors",onClick:()=>g(!1),children:"Cancel"}),d.jsx("button",{className:"px-4 py-2 rounded-xl text-sm font-semibold bg-amber-500 text-white hover:bg-amber-600 transition-colors",onClick:()=>{g(!1),J()},children:"Yes, Download Again"})]})]})})]})},Twe=()=>{const{currentStep:e,selectedDocumentType:t,loadDocumentConfig:r,setCurrentStep:n,analysisSummary:s}=HS(),{selectedJobId:a}=mu(),i=a?String(a):null;ne.useEffect(()=>{!t&&jx.length>0&&(r(jx[0].id,i||void 0),n("form-entry"))},[t,r,i,n]);const o=h=>{r(h,i||void 0),n("form-entry")},f=!i||!t||!s?null:{"add-product":Number(s.products_added||0),"delete-product":Number(s.products_deleted||0),"price-increase":Number(s.price_increased||0),"price-decrease":Number(s.price_decreased||0),"description-change":Number(s.description_changed||0)}[t]===0?`No ${{"add-product":"additions","delete-product":"deletions","price-increase":"price increases","price-decrease":"price decreases","description-change":"description changes"}[t]||"modifications"} were detected in the analysis for this document type.`:null;return e==="preview"?d.jsx(Nwe,{}):d.jsx("div",{className:"min-h-screen bg-slate-50/50 p-6 lg:p-10 space-y-8 animate-fade-in",children:d.jsxs("div",{className:"mx-auto  space-y-10",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:"Generate Documents"}),d.jsx("p",{className:"text-slate-500 font-medium",children:"Select a document type to pre-fill and generate"})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:jx.map(h=>{const p={"add-product":Number((s==null?void 0:s.products_added)||0),"delete-product":Number((s==null?void 0:s.products_deleted)||0),"price-increase":Number((s==null?void 0:s.price_increased)||0),"price-decrease":Number((s==null?void 0:s.price_decreased)||0),"description-change":Number((s==null?void 0:s.description_changed)||0)};return d.jsx(Lce,{config:h,isSelected:t===h.id,onSelect:()=>o(h.id),count:s?p[h.id]??0:void 0,variant:"horizontal"},h.id)})}),d.jsx("div",{className:"pt-2",children:e==="load-config"?d.jsxs("div",{className:"py-20 text-center bg-white rounded-3xl border border-slate-200",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin m-auto text-[#24548f]"}),d.jsx("p",{className:"mt-4 text-slate-500 font-medium",children:"Loading configuration..."})]}):f?d.jsxs("div",{className:"py-24 text-center bg-white rounded-3xl border border-slate-200 shadow-sm animate-fade-in",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No Modifications Found"}),d.jsx("p",{className:"text-slate-500 font-medium max-w-md m-auto px-6 whitespace-pre-line",children:f})]}):d.jsx(Bce,{})})]})})};function kwe({onDownloadHistory:e}){return d.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-12 mx-auto",children:d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:"Analysis History"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:"View and manage all past price list analyses"})]})})}function Awe({searchQuery:e,setSearchQuery:t,clientFilter:r,setClientFilter:n,statusFilter:s,setStatusFilter:a,dateFrom:i,setDateFrom:o,dateTo:c,setDateTo:f,clientOptions:h,onClearFilters:p}){return d.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-slate-200",children:[d.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(iX,{className:"w-4 h-4 text-[#3399cc]"}),d.jsx("h2",{className:"text-sm font-bold text-slate-800",children:"Filters"})]}),d.jsx("button",{onClick:p,className:"text-sm font-semibold text-[#3399cc] hover:underline",children:"Clear all"})]}),d.jsx("div",{className:"p-6",children:d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Search"}),d.jsxs("div",{className:"relative",children:[d.jsx(Po,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsx("input",{value:e,onChange:x=>t(x.target.value),placeholder:"Search by ID, client, or contract...",className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium"})]})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Client"}),d.jsxs("div",{className:"relative",children:[d.jsx(Xn,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsxs("select",{value:r,onChange:x=>n(x.target.value),className:"w-full text-slate-500 appearance-none pl-11 pr-10 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium",children:[d.jsx("option",{value:"All",children:"All Clients"}),h.map(x=>d.jsx("option",{value:x,children:x},x))]}),d.jsx(u0,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Status"}),d.jsxs("div",{className:"relative",children:[d.jsx(la,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),d.jsxs("select",{value:s,onChange:x=>a(x.target.value),className:"w-full text-slate-500 appearance-none pl-11 pr-10 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium",children:[d.jsx("option",{value:"All",children:"All Status"}),d.jsx("option",{value:"pending",children:"Pending"}),d.jsx("option",{value:"approved",children:"Approved"}),d.jsx("option",{value:"rejected",children:"Rejected"})]}),d.jsx(u0,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Date Range"}),d.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[d.jsx("div",{className:"relative flex-1",children:d.jsx("input",{type:"date",value:i?i.toISOString().split("T")[0]:"",onChange:x=>o(x.target.value?new Date(x.target.value):void 0),className:"w-full text-slate-500 px-4 pr-3 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium"})}),d.jsx("div",{className:"relative flex-1",children:d.jsx("input",{type:"date",value:c?c.toISOString().split("T")[0]:"",onChange:x=>f(x.target.value?new Date(x.target.value):void 0),className:"w-full text-slate-500 px-4 pr-3 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-4 focus:ring-[#3399cc]/10 focus:border-[#3399cc] outline-none transition-all text-sm font-medium"})})]})]})]})})]})}function kj({summary:e,hasModifications:t}){return d.jsxs("div",{className:"flex items-center gap-2 text-xs flex-wrap",children:[e.additions>0&&d.jsxs("span",{className:"flex items-center gap-1 text-emerald-600 font-bold",children:[d.jsx(fd,{className:"w-3 h-3"}),e.additions]}),e.deletions>0&&d.jsxs("span",{className:"flex items-center gap-1 text-red-500 font-bold",children:[d.jsx(ZE,{className:"w-3 h-3"}),e.deletions]}),e.priceIncreases>0&&d.jsxs("span",{className:"flex items-center gap-1 text-amber-600 font-bold",children:[d.jsx(Kc,{className:"w-3 h-3"}),e.priceIncreases]}),e.priceDecreases>0&&d.jsxs("span",{className:"flex items-center gap-1 text-cyan-600 font-bold",children:[d.jsx(dd,{className:"w-3 h-3"}),e.priceDecreases]}),e.descriptionChanges>0&&d.jsxs("span",{className:"flex items-center gap-1 text-blue-600 font-bold",children:[d.jsx(ou,{className:"w-3 h-3"}),e.descriptionChanges]}),!t&&d.jsx("span",{className:"text-slate-400 text-xs italic",children:"No modifications"})]})}function Aj({item:e,updatingId:t,onUpdateStatus:r,onClose:n}){const s=Qn(),{setSelectedJobId:a}=mu(),i=o=>{s("/documents")};return d.jsxs("div",{className:"absolute right-12 top-4 w-48 bg-white border border-slate-200 rounded-xl shadow-xl z-50 py-2 animate-in fade-in zoom-in duration-100",onClick:o=>o.stopPropagation(),children:[d.jsxs("button",{onClick:o=>{o.stopPropagation(),a(e.job_id),s("/analyses/details")},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-slate-700 hover:bg-slate-50 transition-colors font-medium",children:[d.jsx(No,{className:"w-4 h-4 text-slate-400"}),"View Details"]}),d.jsxs("button",{onClick:o=>{o.stopPropagation(),i(e.job_id)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-slate-700 hover:bg-slate-50 transition-colors font-medium",children:[d.jsx(Ul,{className:"w-4 h-4 text-slate-400"}),"Generate Docs"]}),lu(e.status)==="pending"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"my-1 border-t border-slate-100"}),d.jsxs("button",{onClick:o=>{o.stopPropagation(),r(e.job_id,"approve"),n()},disabled:t===e.job_id,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-emerald-600 hover:bg-emerald-50 transition-colors font-semibold disabled:opacity-50",children:[t===e.job_id?d.jsx(Ar,{className:"w-4 h-4 animate-spin"}):d.jsx(la,{className:"w-4 h-4"}),"Approve Analysis"]}),d.jsxs("button",{onClick:o=>{o.stopPropagation(),r(e.job_id,"reject"),n()},disabled:t===e.job_id,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-rose-600 hover:bg-rose-50 transition-colors font-semibold disabled:opacity-50",children:[t===e.job_id?d.jsx(Ar,{className:"w-4 h-4 animate-spin"}):d.jsx(Rf,{className:"w-4 h-4"}),"Reject Analysis"]})]})]})}function Cj({currentPage:e,setCurrentPage:t,totalItems:r,itemsPerPage:n,startIndex:s}){const a=Math.ceil(r/n);return d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:s+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(s+n,r)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:r})," ","analyses"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:e===1,onClick:()=>t(e-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Jn,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:(()=>{const i=[];for(let c=1;c<=a;c++)c===1||c===a||c>=e-1&&c<=e+1?i.push(c):i[i.length-1]!=="..."&&i.push("...");return i.map((c,f)=>d.jsx(We.Fragment,{children:c==="..."?d.jsx("span",{className:"px-2 text-slate-400 font-medium",children:"..."}):d.jsx("button",{onClick:()=>t(Number(c)),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
                      ${e===c?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:c})},f))})()}),d.jsx("button",{disabled:e===a,onClick:()=>t(e+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})}const Rj=e=>e?new Date(e).toLocaleTimeString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}):"",Cwe=e=>{const t={additions:0,deletions:0,priceIncreases:0,priceDecreases:0,descriptionChanges:0};return e&&(t.additions=e.NEW_PRODUCT||0,t.deletions=e.REMOVED_PRODUCT||0,t.priceIncreases=e.PRICE_INCREASE||0,t.priceDecreases=e.PRICE_DECREASE||0,t.descriptionChanges=e.DESCRIPTION_CHANGE||0),t},Oj=e=>{const t=lu(e);if(t==="unknown")return d.jsx("span",{className:`${Df} bg-slate-100 text-slate-700 border-slate-200`,children:"Unknown"});const{label:r,styles:n,icon:s}=Q0[t];return d.jsxs("span",{className:`${Df} ${n}`,children:[d.jsx(s,{className:"w-3 h-3 stroke-[2.5px]"}),d.jsx("span",{className:"hidden sm:inline",children:r})]})};function Rwe({analysisHistory:e,loading:t,currentPage:r,setCurrentPage:n,itemsPerPage:s,sortConfig:a,onSort:i,statusFilter:o,clientFilter:c,searchQuery:f,dateFrom:h,dateTo:p,updatingId:x,onUpdateStatus:g}){const v=Qn(),{setSelectedJobId:y}=mu(),[w,_]=ne.useState(null);ne.useEffect(()=>{const D=()=>_(null);return window.addEventListener("click",D),()=>window.removeEventListener("click",D)},[]);const S=[...e].filter(D=>{var P,le,ee,te;const O=f.toLowerCase(),z=!O||((P=D.job_id)==null?void 0:P.toString().includes(O))||((le=D.client)==null?void 0:le.toLowerCase().includes(O))||((ee=D.user)==null?void 0:ee.toLowerCase().includes(O))||((te=D.contract_number)==null?void 0:te.toLowerCase().includes(O)),j=c==="All"||D.client===c,J=o==="All"||lu(D.status)===o,ae=new Date(D.created_time).getTime(),F=!h||ae>=new Date(h).getTime(),X=!p||ae<=new Date(p).getTime();return z&&j&&J&&F&&X}).sort((D,O)=>{if(a.key==="date"){const z=new Date(D.created_time).getTime(),j=new Date(O.created_time).getTime();return a.direction==="asc"?z-j:j-z}return 0}),E=S.length,T=(r-1)*s,k=S.slice(T,T+s);return d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200",children:[d.jsxs("div",{className:"hidden lg:block",children:[d.jsx("div",{className:"",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Analysis ID"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Client"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Modifications"}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider cursor-pointer select-none",onClick:()=>i("date"),children:d.jsxs("div",{className:"flex items-center gap-1",children:["Date & Time",a.key==="date"&&(a.direction==="asc"?d.jsx(TK,{className:"w-3 h-3 stroke-[2.5px] text-slate-400"}):d.jsx(_K,{className:"w-3 h-3 text-slate-400"}))]})}),d.jsx("th",{className:"text-left px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Analyzed By"}),d.jsx("th",{className:"text-right px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{children:t?d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading Analysis History..."})]})})}):k.length===0?d.jsx("tr",{children:d.jsxs("td",{colSpan:7,className:"p-12 text-center",children:[d.jsx(Ul,{className:"w-12 h-12 mx-auto text-slate-300 mb-4"}),d.jsx("p",{className:"text-lg font-bold text-slate-500 mb-2",children:"No analyses found"}),d.jsx("p",{className:"text-slate-500",children:"Try adjusting your filters"})]})}):k.map(D=>{const O=D.summary.additions>0||D.summary.deletions>0||D.summary.priceIncreases>0||D.summary.priceDecreases>0||D.summary.descriptionChanges>0;return d.jsxs("tr",{onClick:()=>{y(D.job_id),v("/analyses/details")},className:"cursor-pointer group border-b border-slate-50 hover:bg-slate-50/50 transition-colors",children:[d.jsx("td",{className:"p-4",children:d.jsxs("span",{className:"font-bold text-slate-800 text-sm group-hover:text-[#38A1DB] transition-colors",children:["ANAL-JOB-",D.job_id]})}),d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-blue-600/10",children:d.jsx(Xn,{className:"h-4 w-4 text-[#24578f]"})}),d.jsxs("div",{className:"leading-tight",children:[d.jsx("span",{className:"block font-semibold text-slate-800",children:D.client||""}),d.jsxs("span",{className:"text-xs font-medium text-slate-500",children:["(",D.contract_number||"No Contract",")"]})]})]})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"text-slate-500 font-medium text-sm",children:Oj(D.status)})}),d.jsx("td",{className:"p-4",children:d.jsx(kj,{summary:D.summary,hasModifications:O})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[d.jsx(Do,{className:"w-3.5 h-3.5 text-slate-400"}),d.jsx("div",{className:"leading-tight",children:d.jsx("div",{className:"text-sm font-medium",children:Rj(D.created_time)})})]})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"px-2 text-slate-500 text-sm transition-colors",children:D.user})}),d.jsx("td",{className:"p-4 relative",children:d.jsxs("div",{className:"flex justify-end",children:[d.jsx("button",{onClick:z=>{z.stopPropagation(),_(w===D.job_id?null:D.job_id)},className:"p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-500",children:d.jsx(Bl,{className:"w-5 h-5"})}),w===D.job_id&&d.jsx(Aj,{item:D,updatingId:x,onUpdateStatus:g,onClose:()=>_(null)})]})})]},D.job_id)})})]})}),E>s&&d.jsx(Cj,{currentPage:r,setCurrentPage:n,totalItems:E,itemsPerPage:s,startIndex:T})]}),d.jsxs("div",{className:"block lg:hidden",children:[t?d.jsx("div",{className:"py-20 text-center",children:d.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin text-[#24578f]"}),d.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Loading Analysis History..."})]})}):k.length===0?d.jsxs("div",{className:"p-12 text-center",children:[d.jsx(Ul,{className:"w-12 h-12 mx-auto text-slate-300 mb-4"}),d.jsx("p",{className:"text-lg font-bold text-slate-500 mb-2",children:"No analyses found"}),d.jsx("p",{className:"text-slate-500",children:"Try adjusting your search query"})]}):d.jsx("div",{className:"divide-y divide-slate-100",children:k.map(D=>{const O=D.summary.additions>0||D.summary.deletions>0||D.summary.priceIncreases>0||D.summary.priceDecreases>0||D.summary.descriptionChanges>0;return d.jsxs("div",{onClick:()=>{y(D.job_id),v("/analyses/details")},className:"p-4 hover:bg-slate-50/50 transition-colors cursor-pointer",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"font-bold text-slate-800 text-sm mb-1",children:["ANAL-JOB-",D.job_id]}),d.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[d.jsx(Do,{className:"w-3 h-3"}),d.jsx("span",{children:Rj(D.created_time)})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[Oj(D.status),d.jsx("button",{onClick:z=>{z.stopPropagation(),_(w===D.job_id?null:D.job_id)},className:"p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-500",children:d.jsx(Bl,{className:"w-5 h-5"})}),w===D.job_id&&d.jsx(Aj,{item:D,updatingId:x,onUpdateStatus:g,onClose:()=>_(null)})]})]}),d.jsx("div",{className:"flex items-center gap-3 mb-3",children:d.jsxs("div",{className:"leading-tight min-w-0 flex-1",children:[d.jsx("div",{className:"font-semibold text-slate-800 truncate",children:D.client||""}),d.jsx("div",{className:"text-xs font-medium text-slate-500 truncate",children:D.contract_number||"No Contract"})]})}),d.jsx("div",{className:"mb-2",children:d.jsx(kj,{summary:D.summary,hasModifications:O})}),d.jsxs("div",{className:"text-xs text-slate-500",children:["Analyzed by ",d.jsx("span",{className:"font-medium text-slate-700",children:D.user})]})]},D.job_id)})}),E>s&&d.jsx("div",{className:"border-t border-slate-100",children:d.jsx(Cj,{currentPage:r,setCurrentPage:n,totalItems:E,itemsPerPage:s,startIndex:T})})]})]})}const Owe=async()=>(await Pt.get("/jobs")).data,jwe=async e=>(await Pt.post(`/jobs/${e}/status?action=approve`)).data,Dwe=async e=>(await Pt.post(`/jobs/${e}/status?action=reject`)).data;function Iwe(){var me,ie,Ee,K;const e=Qn(),[t,r]=ne.useState(""),[n,s]=ne.useState("All"),[a,i]=ne.useState("All"),[o,c]=ne.useState(void 0),[f,h]=ne.useState(void 0),[p,x]=ne.useState(1),g=10,[v,y]=ne.useState([]),[w,_]=ne.useState(null),[S,E]=ne.useState(!0),[T,k]=ne.useState({key:"date",direction:"desc"}),[D,O]=ne.useState({isOpen:!1,job:null,action:"approve"}),[z,j]=ne.useState([]),J=async()=>{try{const M=await Pt.get("clients/approved");j(M.data)}catch(M){console.error("Failed to fetch clients:",M)}},ae=z.map(M=>M.company_name),F=async()=>{try{E(!0);const q=(await Owe()).map(G=>({...G,summary:Cwe(G.action_summary)}));y(q)}catch(M){console.error("Failed to fetch analysis history:",M),Kn.error("Failed to load analysis history")}finally{E(!1)}};ne.useEffect(()=>{F(),J()},[]),ne.useEffect(()=>{x(1)},[t,a,o,f]);const X=(M,q)=>{const G=v.find(Z=>Z.job_id===M);G&&O({isOpen:!0,job:G,action:q})},P=async()=>{var Z,re;if(!D.job)return;const{job:M,action:q}=D,G=M.job_id;try{_(G),q==="approve"?await jwe(G):await Dwe(G),Kn.success(`Analysis ${q==="approve"?"approved":"rejected"} successfully`),y(L=>L.map(I=>I.job_id===G?{...I,status:q==="approve"?"approved":"rejected"}:I)),O({...D,isOpen:!1})}catch(L){console.error("Status update failed:",L),Kn.error(((re=(Z=L.response)==null?void 0:Z.data)==null?void 0:re.detail)||"Failed to update status")}finally{_(null)}},le=M=>{k(q=>q.key===M?{key:M,direction:q.direction==="asc"?"desc":"asc"}:{key:M,direction:"asc"})},ee=()=>{r(""),i("All"),s("All"),c(void 0),h(void 0)},te=()=>{e("/downloads")};return d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-4 md:p-6 lg:p-10 space-y-6 lg:space-y-10",children:[d.jsx(If,{isOpen:D.isOpen,onClose:()=>O({...D,isOpen:!1}),onConfirm:P,title:`Confirm ${D.action==="approve"?"Approval":"Rejection"}`,message:d.jsxs(d.Fragment,{children:["Are you sure you want to ",D.action," ",d.jsxs("span",{className:"font-bold text-slate-700",children:["ANAL-JOB-",(me=D.job)==null?void 0:me.job_id]}),"?"]}),details:[{label:"Client",value:((ie=D.job)==null?void 0:ie.client)||""},{label:"Contract",value:((Ee=D.job)==null?void 0:Ee.contract_number)||""}],warning:{message:D.action==="approve"?"This will approve the analysis and update the product catalog. This action cannot be undone.":"This will reject the analysis and the product catalog wont be updated. This action cannot be undone.",type:D.action==="approve"?"emerald":"rose"},variant:D.action==="approve"?"emerald":"rose",confirmText:D.action==="approve"?"Approve":"Reject",isSubmitting:w===((K=D.job)==null?void 0:K.job_id)}),d.jsx(kwe,{onDownloadHistory:te}),d.jsx(Awe,{searchQuery:t,setSearchQuery:r,clientFilter:a,setClientFilter:i,statusFilter:n,setStatusFilter:s,dateFrom:o,setDateFrom:c,dateTo:f,setDateTo:h,clientOptions:ae,onClearFilters:ee}),d.jsx(Rwe,{analysisHistory:v,loading:S,currentPage:p,setCurrentPage:x,itemsPerPage:g,sortConfig:T,onSort:le,statusFilter:n,clientFilter:a,searchQuery:t,dateFrom:o,dateTo:f,updatingId:w,onUpdateStatus:X})]})}const Qs=({className:e})=>d.jsx("div",{className:`animate-pulse bg-slate-200 rounded-md ${e}`});function Mwe(){var y;const e=Qn(),{user:t}=Ui(),{setSelectedJobId:r}=mu(),[n,s]=ne.useState([]),[a,i]=ne.useState([]),[o,c]=ne.useState(!0),f={bg:"#f5f7f9",fg:"#1b2531",primary:"#24548f",muted:"#627383",border:"#d9e0e8",success:"#33b17d",warning:"#f9ab20",destructive:"#df3a3a",secondaryBg:"#f8fafc"};ne.useEffect(()=>{h()},[]);const h=async()=>{try{c(!0);const[w,_]=await Promise.all([Pt.get("clients"),Pt.get("jobs")]);s(w.data),i(_.data)}catch(w){console.error("Error fetching data:",w)}finally{c(!1)}},x=(()=>{const w=n.length,_=a.filter(D=>D.status==="approved").length,S=a.filter(D=>D.status==="pending").length,E=a.filter(D=>D.status==="approved").length,T=a.length,k=T>0?(E/(T-S)*100).toFixed(1):"0.0";return{totalClients:w,completedJobs:_,pendingJobs:S,successRate:k}})(),g=[{label:"All Clients",value:x.totalClients.toString(),icon:Xn},{label:"Analyses Completed",value:x.completedJobs.toString(),icon:Kx},{label:"Pending Reviews",value:x.pendingJobs.toString(),icon:Do},{label:"Success Rate",value:`${x.successRate}%`,icon:Kc}],v=a.sort((w,_)=>new Date(_.created_time).getTime()-new Date(w.created_time).getTime()).slice(0,5).map(w=>{var _,S,E,T,k;return{id:w.job_id,client:w.client,contract:w.contract_number,status:w.status,add:((_=w.action_summary)==null?void 0:_.NEW_PRODUCT)||0,del:((S=w.action_summary)==null?void 0:S.REMOVED_PRODUCT)||0,incr:((E=w.action_summary)==null?void 0:E.PRICE_INCREASE)||0,decr:((T=w.action_summary)==null?void 0:T.PRICE_DECREASE)||0,desc:((k=w.action_summary)==null?void 0:k.DESCRIPTION_CHANGE)||0}});return d.jsxs("div",{className:"min-h-screen p-6 lg:p-10 animate-fade-in",style:{backgroundColor:f.bg},children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10 animate-slide-up",children:[d.jsx("div",{className:"space-y-1",children:o?d.jsxs(d.Fragment,{children:[d.jsx(Qs,{className:"h-9 w-48 mb-2"}),d.jsx(Qs,{className:"h-5 w-64"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("h1",{className:"text-3xl font-extrabold tracking-tight",style:{color:f.fg},children:["Welcome, ",((y=t==null?void 0:t.name)==null?void 0:y.split(" ")[0])||"Guest"]}),d.jsx("p",{className:"font-medium",style:{color:f.muted},children:"Overview of clients and recent analyses."})]})}),!o&&d.jsxs("button",{onClick:()=>e("/pricelist-analysis"),className:"btn-primary",children:[d.jsx(Kx,{className:"w-4 h-4"}),"New Analysis"]})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-slide-up",children:o?Array(4).fill(0).map((w,_)=>d.jsxs("div",{className:"bg-white p-6 rounded-2xl h-32 flex flex-col justify-between",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx(Qs,{className:"h-3 w-20"}),d.jsx(Qs,{className:"h-10 w-10 rounded-xl"})]}),d.jsx(Qs,{className:"h-8 w-12"})]},_)):g.map(w=>d.jsxs("div",{className:"bg-white p-6 flex flex-col justify-between rounded-2xl transition-all hover:shadow-lg ",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",style:{color:f.muted},children:w.label}),d.jsx("div",{className:"p-2.5 rounded-xl",style:{backgroundColor:f.secondaryBg},children:d.jsx(w.icon,{className:"w-5 h-5 text-[#24548f]",strokeWidth:2.5})})]}),d.jsx("div",{children:d.jsx("div",{className:"text-3xl font-black tracking-tighter mb-1",style:{color:f.fg},children:w.value})})]},w.label))}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start",children:[d.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-2xl animate-slide-up shadow-sm ",children:[d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-extrabold",style:{color:f.fg},children:"Recent Analyses"}),d.jsx("p",{className:"text-sm font-medium",style:{color:f.muted},children:"Latest price modifications tracked"})]}),!o&&d.jsx("button",{onClick:()=>e("/analyses"),className:"text-sm font-bold transition-colors",style:{color:f.muted},children:"View all"})]}),d.jsx("div",{className:"space-y-3",children:o?Array(5).fill(0).map((w,_)=>d.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl border border-transparent bg-slate-50/50",children:[d.jsx(Qs,{className:"w-12 h-12 rounded-xl shrink-0"}),d.jsxs("div",{className:"flex-1 space-y-2",children:[d.jsx(Qs,{className:"h-4 w-32"}),d.jsx(Qs,{className:"h-3 w-20"})]}),d.jsxs("div",{className:"hidden sm:flex gap-4",children:[d.jsx(Qs,{className:"h-8 w-8"}),d.jsx(Qs,{className:"h-8 w-8"}),d.jsx(Qs,{className:"h-8 w-8"})]}),d.jsx(Qs,{className:"h-6 w-20 rounded-full"})]},_)):d.jsxs(d.Fragment,{children:[v.map(w=>{const _=lu(w.status),S=_==="unknown"?null:Q0[_];return d.jsxs("div",{onClick:()=>{r(Number(w.id)),e("/analyses/details")},className:"group flex items-center gap-4 p-4 rounded-2xl border border-transparent hover:shadow-sm transition-all cursor-pointer",style:{backgroundColor:`${f.bg}80`},children:[d.jsx("div",{className:"w-12 h-12 rounded-xl bg-white border flex items-center justify-center shrink-0 shadow-sm group-hover:scale-105 transition-transform",style:{borderColor:f.border},children:d.jsx(Ul,{className:"w-5 h-5",style:{color:f.primary}})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:"font-bold truncate",style:{color:f.fg},children:w.client}),d.jsx("p",{className:"text-xs font-bold",style:{color:f.muted},children:w.contract})]}),d.jsxs("div",{className:"hidden sm:flex items-center gap-6 px-4",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:f.muted},children:"Add"}),d.jsxs("p",{className:"text-sm font-black",style:{color:f.success},children:["+",w.add]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:f.muted},children:"Del"}),d.jsxs("p",{className:"text-sm font-black",style:{color:f.destructive},children:["-",w.del]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:f.muted},children:"Incr"}),d.jsxs("p",{className:"flex items-center gap-1 text-amber-600 text-sm font-bold",children:[d.jsx(Kc,{className:"w-3 h-3"}),w.incr]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:f.muted},children:"Decr"}),d.jsxs("p",{className:"flex items-center gap-1 text-blue-600 text-sm font-bold",children:[d.jsx(dd,{className:"w-3 h-3"}),w.decr]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:f.muted},children:"Desc"}),d.jsxs("p",{className:"flex items-center gap-1 text-indigo-600 text-sm font-bold",children:[d.jsx(ou,{className:"w-3 h-3"}),w.desc]})]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("span",{className:`${Df} ${S?S.styles:"bg-slate-100 text-slate-700 border-slate-200"}`,children:[S&&d.jsx(S.icon,{className:"w-3 h-3 stroke-[2.5px]"}),d.jsx("span",{children:S?S.label:"Unknown"})]}),d.jsx(Mr,{className:"w-4 h-4",style:{color:f.border}})]})]},w.id)}),v.length===0&&d.jsx("p",{className:"text-center py-8",style:{color:f.muted},children:"No analyses found"})]})})]}),d.jsxs("div",{className:"space-y-8 animate-slide-in-right",children:[d.jsxs("div",{className:"rounded-4xl p-8 shadow-xl text-white",style:{backgroundColor:f.primary},children:[d.jsx("h2",{className:"text-xl font-bold mb-1",children:"Quick Actions"}),d.jsx("p",{className:"text-xs font-medium mb-6 opacity-70",children:"Perform common tasks"}),d.jsx("div",{className:"space-y-3",children:[{label:"Add Client",icon:mD,to:"/clients"},{label:"Upload Product Catalog",icon:jf,to:"/gsa-products/upload"},{label:"View Reports",icon:jK,to:"/analyses"}].map(w=>d.jsxs("button",{onClick:()=>e(w.to),className:"w-full flex items-center gap-3 p-4 rounded-xl transition-all group font-bold text-sm text-left border border-white/10 bg-white/10 hover:bg-white hover:text-slate-900",children:[d.jsx("div",{className:"p-1.5 rounded-lg bg-white/10",children:d.jsx(w.icon,{className:"w-4 h-4"})}),w.label]},w.label))})]}),d.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm ",children:[d.jsx("h3",{className:"text-xs font-black uppercase tracking-widest mb-6",style:{color:f.muted},children:"Clients Overview"}),d.jsx("div",{className:"space-y-5",children:[{label:"Active",key:"approved",color:f.success},{label:"Pending",key:"pending",color:f.warning},{label:"Rejected",key:"rejected",color:f.destructive}].map(w=>d.jsxs("div",{className:"flex items-center justify-between group",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:w.color}}),d.jsx("span",{className:"text-sm font-bold",style:{color:f.fg},children:w.label})]}),o?d.jsx(Qs,{className:"h-4 w-6"}):d.jsx("span",{className:"text-sm font-black",style:{color:f.fg},children:n.filter(_=>_.status===w.key).length})]},w.label))})]})]})]})]})}const fn=({className:e})=>d.jsx("div",{className:`animate-pulse bg-slate-200 rounded-md ${e}`});function Fwe(){var T;const e=Qn(),{user:t}=Ui(),{setSelectedJobId:r}=mu(),[n,s]=ne.useState([]),[a,i]=ne.useState([]),[o,c]=ne.useState([]),[f,h]=ne.useState(!0),[p,x]=ne.useState("users"),g={bg:"#f5f7f9",fg:"#1b2531",primary:"#24548f",muted:"#627383",border:"#d9e0e8",success:"#33b17d",destructive:"#df3a3a",secondaryBg:"#f8fafc"};ne.useEffect(()=>{v()},[]);const v=async()=>{try{h(!0);const[k,D,O]=await Promise.all([Pt.get("/users/all"),Pt.get("/clients"),Pt.get("/jobs")]);s(Array.isArray(k.data)?k.data:[]),i(Array.isArray(D.data)?D.data:[]),c(Array.isArray(O.data)?O.data:[])}catch(k){console.error("Error fetching dashboard data:",k)}finally{h(!1)}},y=n.filter(k=>!k.is_active&&!k.is_deleted).slice(0,2),w=a.filter(k=>k.status==="pending").slice(0,2),_=o.filter(k=>k.status==="pending").length;o.filter(k=>k.status==="approved").length;const S=[{label:"Pending User Requests",value:n.filter(k=>!k.is_active&&!k.is_deleted).length.toString(),icon:mD},{label:"Pending Client Reviews",value:a.filter(k=>k.status==="pending").length.toString(),icon:Xn},{label:"Pending Analyses",value:_.toString(),icon:Do},{label:"Active Clients",value:a.filter(k=>k.status==="approved").length.toString(),icon:la}],E=o.sort((k,D)=>new Date(D.created_time).getTime()-new Date(k.created_time).getTime()).slice(0,5).map(k=>{var D,O,z,j,J;return{id:k.job_id,client:k.client,contract:k.contract_number,status:k.status,add:((D=k.action_summary)==null?void 0:D.NEW_PRODUCT)||0,del:((O=k.action_summary)==null?void 0:O.REMOVED_PRODUCT)||0,incr:((z=k.action_summary)==null?void 0:z.PRICE_INCREASE)||0,decr:((j=k.action_summary)==null?void 0:j.PRICE_DECREASE)||0,desc:((J=k.action_summary)==null?void 0:J.DESCRIPTION_CHANGE)||0}});return d.jsxs("div",{className:"min-h-screen p-6 lg:p-10 animate-fade-in",style:{backgroundColor:g.bg},children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10 animate-slide-up",children:[d.jsx("div",{className:"space-y-1",children:f?d.jsxs(d.Fragment,{children:[d.jsx(fn,{className:"h-9 w-48 mb-2"}),d.jsx(fn,{className:"h-5 w-64"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("h1",{className:"text-3xl font-extrabold tracking-tight",style:{color:g.fg},children:["Welcome, ",((T=t==null?void 0:t.name)==null?void 0:T.split(" ")[0])||"Guest"]}),d.jsx("p",{className:"font-medium",style:{color:g.muted},children:"Overview of platform users and recent analyses."})]})}),!f&&d.jsxs("button",{onClick:()=>e("/pricelist-analysis"),className:"btn-primary",children:[d.jsx(Kx,{className:"w-4 h-4"}),"New Analysis"]})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-slide-up",children:f?Array(4).fill(0).map((k,D)=>d.jsxs("div",{className:"bg-white p-6 rounded-2xl h-32 flex flex-col justify-between",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx(fn,{className:"h-3 w-20"}),d.jsx(fn,{className:"h-10 w-10 rounded-xl"})]}),d.jsx(fn,{className:"h-8 w-12"})]},D)):S.map(k=>d.jsxs("div",{className:"bg-white p-6 flex flex-col justify-between rounded-2xl transition-all hover:shadow-lg ",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",style:{color:g.muted},children:k.label}),d.jsx("div",{className:"p-2.5 rounded-xl",style:{backgroundColor:g.secondaryBg},children:d.jsx(k.icon,{className:"w-5 h-5 text-[#24548f]",strokeWidth:2.5})})]}),d.jsx("div",{children:d.jsx("div",{className:"text-3xl font-black tracking-tighter mb-1",style:{color:g.fg},children:k.value})})]},k.label))}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start",children:[d.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-2xl animate-slide-up shadow-sm ",children:[d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-extrabold",style:{color:g.fg},children:"Recent Analyses"}),d.jsx("p",{className:"text-sm font-medium",style:{color:g.muted},children:"Latest price modifications tracked"})]}),!f&&d.jsx("button",{onClick:()=>e("/analyses"),className:"text-sm font-bold transition-colors",style:{color:g.muted},children:"View all"})]}),d.jsx("div",{className:"space-y-3",children:f?Array(5).fill(0).map((k,D)=>d.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl border border-transparent bg-slate-50/50",children:[d.jsx(fn,{className:"w-12 h-12 rounded-xl shrink-0"}),d.jsxs("div",{className:"flex-1 space-y-2",children:[d.jsx(fn,{className:"h-4 w-32"}),d.jsx(fn,{className:"h-3 w-20"})]}),d.jsxs("div",{className:"hidden sm:flex gap-4",children:[d.jsx(fn,{className:"h-8 w-8"}),d.jsx(fn,{className:"h-8 w-8"}),d.jsx(fn,{className:"h-8 w-8"})]}),d.jsx(fn,{className:"h-6 w-20 rounded-full"})]},D)):d.jsxs(d.Fragment,{children:[E.map(k=>{const D=lu(k.status),O=D==="unknown"?null:Q0[D];return d.jsxs("div",{onClick:()=>{r(Number(k.id)),e("/analyses/details")},className:"group flex items-center gap-4 p-4 rounded-2xl border border-transparent hover:shadow-sm transition-all cursor-pointer",style:{backgroundColor:`${g.bg}80`},children:[d.jsx("div",{className:"w-12 h-12 rounded-xl bg-white border flex items-center justify-center shrink-0 shadow-sm group-hover:scale-105 transition-transform",style:{borderColor:g.border},children:d.jsx(Ul,{className:"w-5 h-5",style:{color:g.primary}})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:"font-bold truncate",style:{color:g.fg},children:k.client}),d.jsx("p",{className:"text-xs font-bold",style:{color:g.muted},children:k.contract})]}),d.jsxs("div",{className:"hidden sm:flex items-center gap-6 px-4",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:g.muted},children:"Add"}),d.jsxs("p",{className:"text-sm font-black",style:{color:g.success},children:["+",k.add]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:g.muted},children:"Del"}),d.jsxs("p",{className:"text-sm font-black",style:{color:g.destructive},children:["-",k.del]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:g.muted},children:"Incr"}),d.jsxs("p",{className:"flex items-center gap-1 text-amber-600 text-sm font-bold",children:[d.jsx(Kc,{className:"w-3 h-3"}),k.incr]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:g.muted},children:"Decr"}),d.jsxs("p",{className:"flex items-center gap-1 text-blue-600 text-sm font-bold",children:[d.jsx(dd,{className:"w-3 h-3"}),k.decr]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-[9px] font-black uppercase",style:{color:g.muted},children:"Desc"}),d.jsxs("p",{className:"flex items-center gap-1 text-indigo-600 text-sm font-bold",children:[d.jsx(ou,{className:"w-3 h-3"}),k.desc]})]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("span",{className:`${Df} ${O?O.styles:"bg-slate-100 text-slate-700 border-slate-200"}`,children:[O&&d.jsx(O.icon,{className:"w-3 h-3 stroke-[2.5px]"}),d.jsx("span",{children:O?O.label:"Unknown"})]}),d.jsx(Mr,{className:"w-4 h-4",style:{color:g.border}})]})]},k.id)}),E.length===0&&d.jsx("p",{className:"text-center py-8",style:{color:g.muted},children:"No analyses found"})]})})]}),d.jsxs("div",{className:"space-y-8",children:[d.jsxs("div",{className:"rounded-4xl p-8 shadow-xl text-white",style:{backgroundColor:g.primary},children:[d.jsx("h2",{className:"text-xl font-bold mb-1",children:"Quick Actions"}),d.jsx("p",{className:"text-xs font-medium mb-6 opacity-70",children:"Perform common tasks"}),d.jsx("div",{className:"space-y-3",children:[{label:"Add Client",icon:Xn,to:"/clients"},{label:"Manage Contracts",icon:fD,to:"/contracts"},{label:"Upload Product Catalog",icon:jf,to:"/gsa-products/upload"}].map(k=>d.jsxs("button",{onClick:()=>e(k.to),className:"w-full flex items-center gap-3 p-4 rounded-xl transition-all group font-bold text-sm text-left border border-white/10 bg-white/10 hover:bg-white hover:text-slate-900",children:[d.jsx("div",{className:"p-1.5 rounded-lg bg-white/10",children:d.jsx(k.icon,{className:"w-4 h-4"})}),k.label]},k.label))})]}),d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[d.jsxs("div",{className:"flex border-b border-slate-50",children:[d.jsxs("button",{onClick:()=>x("users"),className:`flex-1 py-4 text-[10px] font-black uppercase tracking-widest transition-all relative ${p==="users"?"text-[#24548f]":"text-slate-400 hover:text-slate-600"}`,children:["User Approvals",!f&&y.length>0&&d.jsx("span",{className:"ml-2 bg-blue-50 text-[#24548f] px-1.5 py-0.5 rounded-md text-[9px]",children:y.length}),p==="users"&&d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#24548f]"})]}),d.jsxs("button",{onClick:()=>x("clients"),className:`flex-1 py-4 text-[10px] font-black uppercase tracking-widest transition-all relative ${p==="clients"?"text-emerald-600":"text-slate-400 hover:text-slate-600"}`,children:["Client Reviews",!f&&w.length>0&&d.jsx("span",{className:"ml-2 bg-emerald-50 text-emerald-600 px-1.5 py-0.5 rounded-md text-[9px]",children:w.length}),p==="clients"&&d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]})]}),d.jsx("div",{className:"p-6",children:f?d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(fn,{className:"w-8 h-8 rounded-lg"}),d.jsxs("div",{className:"space-y-1",children:[d.jsx(fn,{className:"h-3 w-24"}),d.jsx(fn,{className:"h-2 w-16"})]})]}),d.jsx(fn,{className:"w-4 h-4"})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(fn,{className:"w-8 h-8 rounded-lg"}),d.jsxs("div",{className:"space-y-1",children:[d.jsx(fn,{className:"h-3 w-20"}),d.jsx(fn,{className:"h-2 w-12"})]})]}),d.jsx(fn,{className:"w-4 h-4"})]})]}):p==="users"?d.jsxs("div",{className:"space-y-4 animate-fade-in",children:[y.map(k=>d.jsxs("div",{className:"flex items-center justify-between group",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-[10px] font-bold text-slate-500",children:k.name.charAt(0)}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-800",children:k.name}),d.jsx("p",{className:"text-[10px] text-slate-400",children:new Date(k.created_time).toLocaleDateString()})]})]}),d.jsx("button",{onClick:()=>e("/user-activation"),className:"p-1.5 hover:bg-blue-50 rounded-lg transition-colors text-[#24548f]",children:d.jsx(Mr,{className:"w-4 h-4"})})]},k.user_id)),y.length===0&&d.jsxs("div",{className:"flex flex-col items-center justify-center py-1.75 text-center",children:[d.jsx("div",{className:"w-10 h-10 bg-slate-50 rounded-full flex items-center justify-center mb-2",children:d.jsx(Xx,{className:"w-5 h-5 text-slate-300"})}),d.jsx("p",{className:"text-[11px] text-slate-400 italic",children:"No pending user requests"})]})]}):d.jsxs("div",{className:"space-y-4 animate-fade-in",children:[w.map(k=>d.jsxs("div",{className:"flex items-center justify-between group",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-50 flex items-center justify-center text-emerald-600",children:d.jsx(Xn,{className:"w-4 h-4"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-slate-800",children:k.company_name}),d.jsx("p",{className:"text-[10px] text-slate-400",children:"Review Required"})]})]}),d.jsx("button",{onClick:()=>e("/client-activation"),className:"p-1.5 hover:bg-emerald-50 rounded-lg transition-colors text-emerald-600",children:d.jsx(Mr,{className:"w-4 h-4"})})]},k.client_id)),w.length===0&&d.jsxs("div",{className:"flex flex-col items-center justify-center py-1.75 text-center",children:[d.jsx("div",{className:"w-10 h-10 bg-slate-50 rounded-full flex items-center justify-center mb-2",children:d.jsx(Xn,{className:"w-5 h-5 text-slate-300"})}),d.jsx("p",{className:"text-[11px] text-slate-400 italic",children:"No pending client reviews"})]})]})}),d.jsx("div",{className:"px-6 py-2.5 bg-slate-50/50 border-t border-slate-100",children:d.jsx("button",{onClick:()=>e(p==="users"?"/user-activation":"/client-activation"),className:"w-full text-center text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-[#24548f] transition-colors",children:"View All"})})]})]})]})]})}function Pwe(){const{user:e}=Ui();if(!e)return null;if(!e||!e.is_active||e.is_deleted)return d.jsx("div",{className:"p-10 text-center text-red-600 font-bold",children:"Access denied"});switch(e.role){case"admin":return d.jsx(Fwe,{});case"user":default:return d.jsx(Mwe,{})}}const Nh=7;function Lwe(){const{selectedJobId:e}=mu(),t=e,r=Qn(),[n,s]=ne.useState(!0),[a,i]=ne.useState(null),[o,c]=ne.useState("additions"),[f,h]=ne.useState(1);ne.useEffect(()=>{(async()=>{if(!t){s(!1);return}try{s(!0);const z=await Pt.get(`/jobs/${t}`);i(z.data)}finally{s(!1)}})()},[t]);const p=ne.useMemo(()=>{const O={additions:[],deletions:[],priceIncreases:[],priceDecreases:[],descriptionChanges:[]};if(!(a!=null&&a.modifications_actions))return O;for(const z of a.modifications_actions)switch(z.action_type){case"NEW_PRODUCT":O.additions.push(z);break;case"REMOVED_PRODUCT":O.deletions.push(z);break;case"PRICE_INCREASE":O.priceIncreases.push(z);break;case"PRICE_DECREASE":O.priceDecreases.push(z);break;case"DESCRIPTION_CHANGE":O.descriptionChanges.push(z);break}return O},[a]),x=p[o]||[],g=x.length,v=Math.ceil(g/Nh),y=(f-1)*Nh,w=x.slice(y,y+Nh),_=o==="descriptionChanges",S=o==="priceIncreases"||o==="priceDecreases",E=o==="additions"||o==="deletions";if(n)return d.jsxs("div",{className:"py-120 text-center",children:[d.jsx(Ar,{className:"w-8 h-8 animate-spin mx-auto text-[#24578f]"}),d.jsx("p",{className:"mt-4 text-slate-500",children:"Fetching modification details..."})]});if(!a)return d.jsx("div",{className:"py-20 text-center text-slate-500",children:"Analysis not found"});const T=[{id:"additions",label:"Additions",icon:fd,variant:"emerald",count:p.additions.length},{id:"deletions",label:"Deletions",icon:ZE,variant:"red",count:p.deletions.length},{id:"priceIncreases",label:"Increases",icon:Kc,variant:"amber",count:p.priceIncreases.length},{id:"priceDecreases",label:"Decreases",icon:dd,variant:"cyan",count:p.priceDecreases.length},{id:"descriptionChanges",label:"Descriptions",icon:ou,variant:"blue",count:p.descriptionChanges.length}],k=({label:O,value:z,icon:j,variant:J="blue"})=>{const F={emerald:{bg:"bg-emerald-50",text:"text-emerald-600",border:"border-emerald-100",iconBg:"bg-emerald-100/50"},red:{bg:"bg-red-50",text:"text-red-600",border:"border-red-100",iconBg:"bg-red-100/50"},amber:{bg:"bg-amber-50",text:"text-amber-600",border:"border-amber-100",iconBg:"bg-amber-100/50"},cyan:{bg:"bg-cyan-50",text:"text-[#3399cc]",border:"border-cyan-100",iconBg:"bg-cyan-100/50"},blue:{bg:"bg-blue-50",text:"text-blue-600",border:"border-blue-100",iconBg:"bg-blue-100/50"}}[J];return d.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 shadow-sm h-full hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`w-12 h-12 rounded-2xl ${F.iconBg} flex items-center justify-center ${F.text}`,children:We.cloneElement(j,{size:20})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-2xl font-bold text-slate-900 tabular-nums leading-none",children:z.toLocaleString()}),d.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mt-1.5",children:O})]})]})})},D=O=>{const z=[];if(O<=7){for(let ae=1;ae<=O;ae++)z.push(ae);return z}z.push(1),f>4&&z.push("...");const j=Math.max(2,f-1),J=Math.min(O-1,f+1);for(let ae=j;ae<=J;ae++)z.push(ae);return f<O-3&&z.push("..."),z.push(O),z};return d.jsxs("div",{className:"min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-slate-100 p-6 lg:p-10 space-y-10",children:[d.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-12 mx-auto",children:d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-800",children:t?"Analysis Details":"No Analysis Selected"}),d.jsx("p",{className:"text-slate-500 font-medium mt-1",children:t?`Review the analysis results of ANAL-JOB-${t}`:"Please select an analysis from the History page"})]})}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:T.map(O=>d.jsx(k,{label:O.label,value:O.count,icon:d.jsx(O.icon,{className:"w-4 h-4"}),variant:O.variant},O.id))}),d.jsxs("div",{className:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden",children:[d.jsxs("div",{className:"px-6 py-5 border-b border-slate-100 flex items-center justify-between gap-4",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Analysis Results"}),d.jsxs("button",{onClick:()=>BM(t,p),className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-slate-50 text-slate-700 text-sm font-bold border border-slate-200 hover:bg-slate-100 transition-all",children:[d.jsx(Gx,{size:16})," Export All"]})]}),d.jsx("div",{className:"px-6 pt-4",children:d.jsx("div",{className:"bg-slate-100/80 p-1 rounded-2xl flex items-center w-full ",children:T.map(O=>d.jsxs("button",{onClick:()=>{c(O.id),h(1)},className:`flex-1 flex items-center justify-center gap-2 py-2.5 rounded-xl text-sm font-bold transition-all
                         ${o===O.id?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[d.jsx(O.icon,{size:14,className:o===O.id?`text-${O.variant}-600`:""}),O.label]},O.id))})}),d.jsx("div",{className:"p-6",children:d.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden",children:d.jsxs("table",{className:"w-full text-sm table-fixed",children:[d.jsx("thead",{className:"bg-slate-50/50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Part Number"}),d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Product Name"}),_&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Old Description"}),d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"New Description"})]}),S&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"Old Price"}),d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"New Price"})]}),E&&d.jsxs(d.Fragment,{children:[d.jsx("th",{className:"text-left p-3 font-bold text-slate-700",children:"Description"}),d.jsx("th",{className:"text-right p-3 font-bold text-slate-700",children:"Price"})]})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-100",children:[w.map((O,z)=>d.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[d.jsx("td",{className:"p-3 font-mono text-xs text-slate-500",children:O.manufacturer_part_number||"N/A"}),d.jsx("td",{className:"p-3 font-medium text-slate-900",children:O.product_name||"Unknown Product"}),_&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-xs text-slate-400 truncate max-w-60",children:O.old_description||"-"}),d.jsx("td",{className:"p-3 text-xs text-slate-700",children:O.new_description||"-"})]}),S&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-right text-slate-400 tabular-nums",children:O.old_price?`$${Number(O.old_price).toLocaleString()}`:"-"}),d.jsx("td",{className:"p-3 text-right font-bold text-slate-900 tabular-nums",children:O.new_price?`$${Number(O.new_price).toLocaleString()}`:"-"})]}),E&&d.jsxs(d.Fragment,{children:[d.jsx("td",{className:"p-3 text-xs text-slate-700 truncate max-w-60",children:O.description||O.new_description||"-"}),d.jsx("td",{className:"p-3 text-right font-bold text-slate-900 tabular-nums",children:O.price??O.new_price?`$${Number(O.price??O.new_price).toLocaleString()}`:"-"})]})]},z)),x.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:4,className:"p-10 text-center text-slate-400 italic",children:"No modifications found for this category."})})]})]})})}),g>Nh&&d.jsxs("div",{className:"px-6 py-5 bg-white border-t border-slate-100 flex flex-col sm:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"text-sm text-slate-500 font-medium",children:["Showing"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:y+1})," ","to"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:Math.min(y+Nh,g)})," ","of"," ",d.jsx("span",{className:"text-slate-900 font-semibold",children:g})," ","results"]}),d.jsxs("div",{className:"flex items-center gap-1.5",children:[d.jsx("button",{disabled:f===1,onClick:()=>h(f-1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all mr-2",children:d.jsx(Jn,{size:18})}),d.jsx("div",{className:"flex items-center gap-1",children:D(v).map((O,z)=>O==="..."?d.jsx("span",{className:"min-w-9 h-9 flex items-center justify-center text-slate-400 font-bold",children:""},z):d.jsx("button",{onClick:()=>h(O),className:`min-w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all
        ${f===O?"bg-[#3399cc] text-white shadow-md shadow-[#3399cc]/30":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:O},z))}),d.jsx("button",{disabled:f===v,onClick:()=>h(f+1),className:"p-2 rounded-lg border border-slate-200 text-slate-400 hover:bg-slate-50 hover:text-slate-600 disabled:opacity-30 disabled:hover:bg-transparent transition-all ml-2",children:d.jsx(Mr,{size:18})})]})]})]})]}),d.jsxs("div",{className:"flex justify-between items-center pt-4",children:[d.jsxs("button",{onClick:()=>r(-1),className:"flex items-center gap-2 px-5 py-3 rounded-xl font-medium text-sm bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 transition-colors",children:[d.jsx(Jn,{className:"w-4 h-4"}),"Back"]}),d.jsxs("button",{onClick:()=>r("/documents"),className:"btn-primary",children:["Generate Documents ",d.jsx(c0,{className:"w-4 h-4"})]})]})]})}try{pK.configure(mK)}catch(e){console.warn("Amplify configuration failed.",e)}const Bwe=()=>{const{status:e,isActive:t}=Ui();if(e==="loading")return d.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#f5f7f9]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#24578f]"})});const r=e==="authenticated";return d.jsx(sK,{children:d.jsxs(IG,{children:[d.jsx(vr,{path:"/login",element:r?t?d.jsx(_l,{to:"/dashboard",replace:!0}):d.jsx(_l,{to:"/pending-approval",replace:!0}):d.jsx(kY,{})}),d.jsx(vr,{path:"/signup",element:d.jsx(RY,{})}),d.jsx(vr,{path:"/forgot-password",element:d.jsx(OY,{})}),d.jsx(vr,{path:"/pending-approval",element:r?t?d.jsx(_l,{to:"/dashboard",replace:!0}):d.jsx(LY,{}):d.jsx(_l,{to:"/login",replace:!0})}),d.jsx(vr,{element:d.jsx(kb,{isAuthenticated:r}),children:d.jsx(vr,{element:d.jsx(zY,{}),children:d.jsxs(vr,{element:d.jsx($Y,{}),children:[d.jsxs(vr,{element:d.jsx(Ece,{}),children:[d.jsx(vr,{path:"/dashboard",element:d.jsx(Pwe,{})}),d.jsx(vr,{path:"/settings",element:d.jsx(FY,{})}),d.jsxs(vr,{element:d.jsx(kb,{isAuthenticated:r,allowedRoles:[dn.USER,dn.ADMIN]}),children:[d.jsx(vr,{path:"/clients",element:d.jsx(ZY,{})}),d.jsx(vr,{path:"/clients/products",element:d.jsx(QY,{})}),d.jsx(vr,{path:"/contracts",element:d.jsx(dJ,{})}),d.jsx(vr,{path:"/gsa-products",element:d.jsx(_ce,{})}),d.jsx(vr,{path:"/gsa-products/upload",element:d.jsx(pce,{})}),d.jsx(vr,{path:"/pricelist-analysis",element:d.jsx(Oce,{})}),d.jsx(vr,{path:"/documents",element:d.jsx(Mce,{children:d.jsx(Twe,{})})}),d.jsx(vr,{path:"/analyses",element:d.jsx(Iwe,{})}),d.jsx(vr,{path:"/analyses/details",element:d.jsx(Lwe,{})})]})]}),d.jsxs(vr,{element:d.jsx(kb,{isAuthenticated:r,allowedRoles:[dn.ADMIN]}),children:[d.jsx(vr,{path:"/client-activation",element:d.jsx(tJ,{})}),d.jsx(vr,{path:"/user-activation",element:d.jsx(nJ,{})})]})]})})}),d.jsx(vr,{path:"/",element:d.jsx(_l,{to:r?t?"/dashboard":"/pending-approval":"/login",replace:!0})}),d.jsx(vr,{path:"*",element:d.jsx(PY,{})})]})})},Uwe=()=>d.jsxs(M$,{children:[d.jsx(I$,{position:"top-right",richColors:!0}),d.jsx(Bwe,{})]}),_B=document.getElementById("root");if(!_B)throw new Error("Could not find root element to mount to");const zwe=B7.createRoot(_B);zwe.render(d.jsx(We.StrictMode,{children:d.jsx(Uwe,{})}));
